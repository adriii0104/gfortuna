
/* /web/static/src/module_loader.js */
(function(){"use strict";class ModuleLoader{factories=new Map();jobs=new Set();failed=new Set();modules=new Map();bus=new EventTarget();checkErrorProm=null;define(name,deps,factory){if(typeof name!=="string"){throw new Error(`Invalid name definition: ${name} (should be a string)"`);}
if(!(deps instanceof Array)){throw new Error(`Dependencies should be defined by an array: ${deps}`);}
if(typeof factory!=="function"){throw new Error(`Factory should be defined by a function ${factory}`);}
if(!this.factories.has(name)){this.factories.set(name,{deps,fn:factory,ignoreMissingDeps:globalThis.__odooIgnoreMissingDependencies,});this.addJob(name);this.checkErrorProm||=Promise.resolve().then(()=>{this.checkAndReportErrors();this.checkErrorProm=null;});}}
addJob(name){this.jobs.add(name);this.startModules();}
findJob(){for(const job of this.jobs){if(this.factories.get(job).deps.every((dep)=>this.modules.has(dep))){return job;}}
return null;}
startModules(){let job;while((job=this.findJob())){this.startModule(job);}}
startModule(name){const require=(name)=>this.modules.get(name);this.jobs.delete(name);const factory=this.factories.get(name);let value=null;try{value=factory.fn(require);}catch(error){this.failed.add(name);throw new Error(`Error while loading "${name}":\n${error}`);}
this.modules.set(name,value);this.bus.dispatchEvent(new CustomEvent("module-started",{detail:{moduleName:name,module:value}}));}
findErrors(){const dependencyGraph=new Map();for(const job of this.jobs){dependencyGraph.set(job,this.factories.get(job).deps);}
function visitJobs(jobs,visited=new Set()){for(const job of jobs){const result=visitJob(job,visited);if(result){return result;}}
return null;}
function visitJob(job,visited){if(visited.has(job)){const jobs=Array.from(visited).concat([job]);const index=jobs.indexOf(job);return jobs.slice(index).map((j)=>`"${j}"`).join(" => ");}
const deps=dependencyGraph.get(job);return deps?visitJobs(deps,new Set(visited).add(job)):null;}
const missing=new Set();for(const job of this.jobs){const factory=this.factories.get(job);if(factory.ignoreMissingDeps){continue;}
for(const dep of factory.deps){if(!this.factories.has(dep)){missing.add(dep);}}}
return{failed:[...this.failed],cycle:visitJobs(this.jobs),missing:[...missing],unloaded:[...this.jobs].filter((j)=>!this.factories.get(j).ignoreMissingDeps),};}
async checkAndReportErrors(){const{failed,cycle,missing,unloaded}=this.findErrors();if(!failed.length&&!unloaded.length){return;}
function domReady(cb){if(document.readyState==="complete"){cb();}else{document.addEventListener("DOMContentLoaded",cb);}}
function list(heading,names){const frag=document.createDocumentFragment();if(!names||!names.length){return frag;}
frag.textContent=heading;const ul=document.createElement("ul");for(const el of names){const li=document.createElement("li");li.textContent=el;ul.append(li);}
frag.appendChild(ul);return frag;}
domReady(()=>{while(document.body.childNodes.length){document.body.childNodes[0].remove();}
const container=document.createElement("div");container.className="o_module_error position-fixed w-100 h-100 d-flex align-items-center flex-column bg-white overflow-auto modal";container.style.zIndex="10000";const alert=document.createElement("div");alert.className="alert alert-danger o_error_detail fw-bold m-auto";container.appendChild(alert);alert.appendChild(list("The following modules failed to load because of an error, you may find more information in the devtools console:",failed));alert.appendChild(list("The following modules could not be loaded because they form a dependency cycle:",cycle&&[cycle]));alert.appendChild(list("The following modules are needed by other modules but have not been defined, they may not be present in the correct asset bundle:",missing));alert.appendChild(list("The following modules could not be loaded because they have unmet dependencies, this is a secondary error which is likely caused by one of the above problems:",unloaded));document.body.appendChild(container);});}}
if(!globalThis.odoo){globalThis.odoo={};}
const odoo=globalThis.odoo;if(odoo.debug&&!new URLSearchParams(location.search).has("debug")){odoo.debug="";}
const loader=new ModuleLoader();odoo.define=loader.define.bind(loader);odoo.loader=loader;})();;

/* /point_of_sale/static/lib/sha1.js */
(function(_window){'use strict';var Sha1={};_window.Sha1=Sha1;Sha1.hash=function(msg){msg=msg.utf8Encode();var K=[0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xca62c1d6];msg+=String.fromCharCode(0x80);var l=msg.length/4+2;var N=Math.ceil(l/16);var M=new Array(N);for(var i=0;i<N;i++){M[i]=new Array(16);for(var j=0;j<16;j++){M[i][j]=(msg.charCodeAt(i*64+j*4)<<24)|(msg.charCodeAt(i*64+j*4+1)<<16)|(msg.charCodeAt(i*64+j*4+2)<<8)|(msg.charCodeAt(i*64+j*4+3));}}
M[N-1][14]=((msg.length-1)*8)/Math.pow(2,32);M[N-1][14]=Math.floor(M[N-1][14]);M[N-1][15]=((msg.length-1)*8)&0xffffffff;var H0=0x67452301;var H1=0xefcdab89;var H2=0x98badcfe;var H3=0x10325476;var H4=0xc3d2e1f0;var W=new Array(80);var a,b,c,d,e;for(var i=0;i<N;i++){for(var t=0;t<16;t++)W[t]=M[i][t];for(var t=16;t<80;t++)W[t]=Sha1.ROTL(W[t-3]^W[t-8]^W[t-14]^W[t-16],1);a=H0;b=H1;c=H2;d=H3;e=H4;for(var t=0;t<80;t++){var s=Math.floor(t/20);var T=(Sha1.ROTL(a,5)+Sha1.f(s,b,c,d)+e+K[s]+W[t])&0xffffffff;e=d;d=c;c=Sha1.ROTL(b,30);b=a;a=T;}
H0=(H0+a)&0xffffffff;H1=(H1+b)&0xffffffff;H2=(H2+c)&0xffffffff;H3=(H3+d)&0xffffffff;H4=(H4+e)&0xffffffff;}
return Sha1.toHexStr(H0)+Sha1.toHexStr(H1)+Sha1.toHexStr(H2)+
Sha1.toHexStr(H3)+Sha1.toHexStr(H4);};Sha1.f=function(s,x,y,z){switch(s){case 0:return(x&y)^(~x&z);case 1:return x^y^z;case 2:return(x&y)^(x&z)^(y&z);case 3:return x^y^z;}};Sha1.ROTL=function(x,n){return(x<<n)|(x>>>(32-n));};Sha1.toHexStr=function(n){var s="",v;for(var i=7;i>=0;i--){v=(n>>>(i*4))&0xf;s+=v.toString(16);}
return s;};if(typeof String.prototype.utf8Encode=='undefined'){String.prototype.utf8Encode=function(){return unescape(encodeURIComponent(this));};}
if(typeof String.prototype.utf8Decode=='undefined'){String.prototype.utf8Decode=function(){try{return decodeURIComponent(escape(this));}catch(e){return this;}};}
if(typeof module!='undefined'&&module.exports)module.exports=Sha1;if(typeof define=='function'&&define.amd)define([],function(){return Sha1;});})(window);

/* /point_of_sale/static/lib/waitfont.js */
(function(){function waitForWebfonts(fonts,callback){var loadedFonts=0;for(var i=0,l=fonts.length;i<l;++i){(function(font){var node=document.createElement('span');node.innerHTML='giItT1WQy@!-/#';node.style.position='absolute';node.style.left='-10000px';node.style.top='-10000px';node.style.fontSize='300px';node.style.fontFamily='sans-serif';node.style.fontVariant='normal';node.style.fontStyle='normal';node.style.fontWeight='normal';node.style.letterSpacing='0';document.body.appendChild(node);var width=node.offsetWidth;node.style.fontFamily=font;var interval;function checkFont(){if(node&&node.offsetWidth!=width){++loadedFonts;node.parentNode.removeChild(node);node=null;}
if(loadedFonts>=fonts.length){if(interval){clearInterval(interval);}
if(loadedFonts==fonts.length){callback();return true;}}};if(!checkFont()){interval=setInterval(checkFont,50);}})(fonts[i]);}}
window.waitForWebfonts=waitForWebfonts;})();;

/* /web/static/lib/luxon/luxon.js */
var luxon=(function(exports){'use strict';class LuxonError extends Error{}
class InvalidDateTimeError extends LuxonError{constructor(reason){super(`Invalid DateTime: ${reason.toMessage()}`);}}
class InvalidIntervalError extends LuxonError{constructor(reason){super(`Invalid Interval: ${reason.toMessage()}`);}}
class InvalidDurationError extends LuxonError{constructor(reason){super(`Invalid Duration: ${reason.toMessage()}`);}}
class ConflictingSpecificationError extends LuxonError{}
class InvalidUnitError extends LuxonError{constructor(unit){super(`Invalid unit ${unit}`);}}
class InvalidArgumentError extends LuxonError{}
class ZoneIsAbstractError extends LuxonError{constructor(){super("Zone is an abstract class");}}
const n="numeric",s="short",l="long";const DATE_SHORT={year:n,month:n,day:n,};const DATE_MED={year:n,month:s,day:n,};const DATE_MED_WITH_WEEKDAY={year:n,month:s,day:n,weekday:s,};const DATE_FULL={year:n,month:l,day:n,};const DATE_HUGE={year:n,month:l,day:n,weekday:l,};const TIME_SIMPLE={hour:n,minute:n,};const TIME_WITH_SECONDS={hour:n,minute:n,second:n,};const TIME_WITH_SHORT_OFFSET={hour:n,minute:n,second:n,timeZoneName:s,};const TIME_WITH_LONG_OFFSET={hour:n,minute:n,second:n,timeZoneName:l,};const TIME_24_SIMPLE={hour:n,minute:n,hourCycle:"h23",};const TIME_24_WITH_SECONDS={hour:n,minute:n,second:n,hourCycle:"h23",};const TIME_24_WITH_SHORT_OFFSET={hour:n,minute:n,second:n,hourCycle:"h23",timeZoneName:s,};const TIME_24_WITH_LONG_OFFSET={hour:n,minute:n,second:n,hourCycle:"h23",timeZoneName:l,};const DATETIME_SHORT={year:n,month:n,day:n,hour:n,minute:n,};const DATETIME_SHORT_WITH_SECONDS={year:n,month:n,day:n,hour:n,minute:n,second:n,};const DATETIME_MED={year:n,month:s,day:n,hour:n,minute:n,};const DATETIME_MED_WITH_SECONDS={year:n,month:s,day:n,hour:n,minute:n,second:n,};const DATETIME_MED_WITH_WEEKDAY={year:n,month:s,day:n,weekday:s,hour:n,minute:n,};const DATETIME_FULL={year:n,month:l,day:n,hour:n,minute:n,timeZoneName:s,};const DATETIME_FULL_WITH_SECONDS={year:n,month:l,day:n,hour:n,minute:n,second:n,timeZoneName:s,};const DATETIME_HUGE={year:n,month:l,day:n,weekday:l,hour:n,minute:n,timeZoneName:l,};const DATETIME_HUGE_WITH_SECONDS={year:n,month:l,day:n,weekday:l,hour:n,minute:n,second:n,timeZoneName:l,};class Zone{get type(){throw new ZoneIsAbstractError();}
get name(){throw new ZoneIsAbstractError();}
get ianaName(){return this.name;}
get isUniversal(){throw new ZoneIsAbstractError();}
offsetName(ts,opts){throw new ZoneIsAbstractError();}
formatOffset(ts,format){throw new ZoneIsAbstractError();}
offset(ts){throw new ZoneIsAbstractError();}
equals(otherZone){throw new ZoneIsAbstractError();}
get isValid(){throw new ZoneIsAbstractError();}}
let singleton$1=null;class SystemZone extends Zone{static get instance(){if(singleton$1===null){singleton$1=new SystemZone();}
return singleton$1;}
get type(){return"system";}
get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone;}
get isUniversal(){return false;}
offsetName(ts,{format,locale}){return parseZoneInfo(ts,format,locale);}
formatOffset(ts,format){return formatOffset(this.offset(ts),format);}
offset(ts){return-new Date(ts).getTimezoneOffset();}
equals(otherZone){return otherZone.type==="system";}
get isValid(){return true;}}
let dtfCache={};function makeDTF(zone){if(!dtfCache[zone]){dtfCache[zone]=new Intl.DateTimeFormat("en-US",{hour12:false,timeZone:zone,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short",});}
return dtfCache[zone];}
const typeToPos={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6,};function hackyOffset(dtf,date){const formatted=dtf.format(date).replace(/\u200E/g,""),parsed=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(formatted),[,fMonth,fDay,fYear,fadOrBc,fHour,fMinute,fSecond]=parsed;return[fYear,fMonth,fDay,fadOrBc,fHour,fMinute,fSecond];}
function partsOffset(dtf,date){const formatted=dtf.formatToParts(date);const filled=[];for(let i=0;i<formatted.length;i++){const{type,value}=formatted[i];const pos=typeToPos[type];if(type==="era"){filled[pos]=value;}else if(!isUndefined(pos)){filled[pos]=parseInt(value,10);}}
return filled;}
let ianaZoneCache={};class IANAZone extends Zone{static create(name){if(!ianaZoneCache[name]){ianaZoneCache[name]=new IANAZone(name);}
return ianaZoneCache[name];}
static resetCache(){ianaZoneCache={};dtfCache={};}
static isValidSpecifier(s){return this.isValidZone(s);}
static isValidZone(zone){if(!zone){return false;}
try{new Intl.DateTimeFormat("en-US",{timeZone:zone}).format();return true;}catch(e){return false;}}
constructor(name){super();this.zoneName=name;this.valid=IANAZone.isValidZone(name);}
get type(){return"iana";}
get name(){return this.zoneName;}
get isUniversal(){return false;}
offsetName(ts,{format,locale}){return parseZoneInfo(ts,format,locale,this.name);}
formatOffset(ts,format){return formatOffset(this.offset(ts),format);}
offset(ts){const date=new Date(ts);if(isNaN(date))return NaN;const dtf=makeDTF(this.name);let[year,month,day,adOrBc,hour,minute,second]=dtf.formatToParts?partsOffset(dtf,date):hackyOffset(dtf,date);if(adOrBc==="BC"){year=-Math.abs(year)+1;}
const adjustedHour=hour===24?0:hour;const asUTC=objToLocalTS({year,month,day,hour:adjustedHour,minute,second,millisecond:0,});let asTS=+date;const over=asTS%1000;asTS-=over>=0?over:1000+over;return(asUTC-asTS)/(60*1000);}
equals(otherZone){return otherZone.type==="iana"&&otherZone.name===this.name;}
get isValid(){return this.valid;}}
let intlLFCache={};function getCachedLF(locString,opts={}){const key=JSON.stringify([locString,opts]);let dtf=intlLFCache[key];if(!dtf){dtf=new Intl.ListFormat(locString,opts);intlLFCache[key]=dtf;}
return dtf;}
let intlDTCache={};function getCachedDTF(locString,opts={}){const key=JSON.stringify([locString,opts]);let dtf=intlDTCache[key];if(!dtf){dtf=new Intl.DateTimeFormat(locString,opts);intlDTCache[key]=dtf;}
return dtf;}
let intlNumCache={};function getCachedINF(locString,opts={}){const key=JSON.stringify([locString,opts]);let inf=intlNumCache[key];if(!inf){inf=new Intl.NumberFormat(locString,opts);intlNumCache[key]=inf;}
return inf;}
let intlRelCache={};function getCachedRTF(locString,opts={}){const{base,...cacheKeyOpts}=opts;const key=JSON.stringify([locString,cacheKeyOpts]);let inf=intlRelCache[key];if(!inf){inf=new Intl.RelativeTimeFormat(locString,opts);intlRelCache[key]=inf;}
return inf;}
let sysLocaleCache=null;function systemLocale(){if(sysLocaleCache){return sysLocaleCache;}else{sysLocaleCache=new Intl.DateTimeFormat().resolvedOptions().locale;return sysLocaleCache;}}
function parseLocaleString(localeStr){const xIndex=localeStr.indexOf("-x-");if(xIndex!==-1){localeStr=localeStr.substring(0,xIndex);}
const uIndex=localeStr.indexOf("-u-");if(uIndex===-1){return[localeStr];}else{let options;let selectedStr;try{options=getCachedDTF(localeStr).resolvedOptions();selectedStr=localeStr;}catch(e){const smaller=localeStr.substring(0,uIndex);options=getCachedDTF(smaller).resolvedOptions();selectedStr=smaller;}
const{numberingSystem,calendar}=options;return[selectedStr,numberingSystem,calendar];}}
function intlConfigString(localeStr,numberingSystem,outputCalendar){if(outputCalendar||numberingSystem){if(!localeStr.includes("-u-")){localeStr+="-u";}
if(outputCalendar){localeStr+=`-ca-${outputCalendar}`;}
if(numberingSystem){localeStr+=`-nu-${numberingSystem}`;}
return localeStr;}else{return localeStr;}}
function mapMonths(f){const ms=[];for(let i=1;i<=12;i++){const dt=DateTime.utc(2009,i,1);ms.push(f(dt));}
return ms;}
function mapWeekdays(f){const ms=[];for(let i=1;i<=7;i++){const dt=DateTime.utc(2016,11,13+i);ms.push(f(dt));}
return ms;}
function listStuff(loc,length,englishFn,intlFn){const mode=loc.listingMode();if(mode==="error"){return null;}else if(mode==="en"){return englishFn(length);}else{return intlFn(length);}}
function supportsFastNumbers(loc){if(loc.numberingSystem&&loc.numberingSystem!=="latn"){return false;}else{return(loc.numberingSystem==="latn"||!loc.locale||loc.locale.startsWith("en")||new Intl.DateTimeFormat(loc.intl).resolvedOptions().numberingSystem==="latn");}}
class PolyNumberFormatter{constructor(intl,forceSimple,opts){this.padTo=opts.padTo||0;this.floor=opts.floor||false;const{padTo,floor,...otherOpts}=opts;if(!forceSimple||Object.keys(otherOpts).length>0){const intlOpts={useGrouping:false,...opts};if(opts.padTo>0)intlOpts.minimumIntegerDigits=opts.padTo;this.inf=getCachedINF(intl,intlOpts);}}
format(i){if(this.inf){const fixed=this.floor?Math.floor(i):i;return this.inf.format(fixed);}else{const fixed=this.floor?Math.floor(i):roundTo(i,3);return padStart(fixed,this.padTo);}}}
class PolyDateFormatter{constructor(dt,intl,opts){this.opts=opts;this.originalZone=undefined;let z=undefined;if(this.opts.timeZone){this.dt=dt;}else if(dt.zone.type==="fixed"){const gmtOffset=-1*(dt.offset/60);const offsetZ=gmtOffset>=0?`Etc/GMT+${gmtOffset}`:`Etc/GMT${gmtOffset}`;if(dt.offset!==0&&IANAZone.create(offsetZ).valid){z=offsetZ;this.dt=dt;}else{z="UTC";this.dt=dt.offset===0?dt:dt.setZone("UTC").plus({minutes:dt.offset});this.originalZone=dt.zone;}}else if(dt.zone.type==="system"){this.dt=dt;}else if(dt.zone.type==="iana"){this.dt=dt;z=dt.zone.name;}else{z="UTC";this.dt=dt.setZone("UTC").plus({minutes:dt.offset});this.originalZone=dt.zone;}
const intlOpts={...this.opts};intlOpts.timeZone=intlOpts.timeZone||z;this.dtf=getCachedDTF(intl,intlOpts);}
format(){if(this.originalZone){return this.formatToParts().map(({value})=>value).join("");}
return this.dtf.format(this.dt.toJSDate());}
formatToParts(){const parts=this.dtf.formatToParts(this.dt.toJSDate());if(this.originalZone){return parts.map((part)=>{if(part.type==="timeZoneName"){const offsetName=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName,});return{...part,value:offsetName,};}else{return part;}});}
return parts;}
resolvedOptions(){return this.dtf.resolvedOptions();}}
class PolyRelFormatter{constructor(intl,isEnglish,opts){this.opts={style:"long",...opts};if(!isEnglish&&hasRelative()){this.rtf=getCachedRTF(intl,opts);}}
format(count,unit){if(this.rtf){return this.rtf.format(count,unit);}else{return formatRelativeTime(unit,count,this.opts.numeric,this.opts.style!=="long");}}
formatToParts(count,unit){if(this.rtf){return this.rtf.formatToParts(count,unit);}else{return[];}}}
class Locale{static fromOpts(opts){return Locale.create(opts.locale,opts.numberingSystem,opts.outputCalendar,opts.defaultToEN);}
static create(locale,numberingSystem,outputCalendar,defaultToEN=false){const specifiedLocale=locale||Settings.defaultLocale;const localeR=specifiedLocale||(defaultToEN?"en-US":systemLocale());const numberingSystemR=numberingSystem||Settings.defaultNumberingSystem;const outputCalendarR=outputCalendar||Settings.defaultOutputCalendar;return new Locale(localeR,numberingSystemR,outputCalendarR,specifiedLocale);}
static resetCache(){sysLocaleCache=null;intlDTCache={};intlNumCache={};intlRelCache={};}
static fromObject({locale,numberingSystem,outputCalendar}={}){return Locale.create(locale,numberingSystem,outputCalendar);}
constructor(locale,numbering,outputCalendar,specifiedLocale){const[parsedLocale,parsedNumberingSystem,parsedOutputCalendar]=parseLocaleString(locale);this.locale=parsedLocale;this.numberingSystem=numbering||parsedNumberingSystem||null;this.outputCalendar=outputCalendar||parsedOutputCalendar||null;this.intl=intlConfigString(this.locale,this.numberingSystem,this.outputCalendar);this.weekdaysCache={format:{},standalone:{}};this.monthsCache={format:{},standalone:{}};this.meridiemCache=null;this.eraCache={};this.specifiedLocale=specifiedLocale;this.fastNumbersCached=null;}
get fastNumbers(){if(this.fastNumbersCached==null){this.fastNumbersCached=supportsFastNumbers(this);}
return this.fastNumbersCached;}
listingMode(){const isActuallyEn=this.isEnglish();const hasNoWeirdness=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return isActuallyEn&&hasNoWeirdness?"en":"intl";}
clone(alts){if(!alts||Object.getOwnPropertyNames(alts).length===0){return this;}else{return Locale.create(alts.locale||this.specifiedLocale,alts.numberingSystem||this.numberingSystem,alts.outputCalendar||this.outputCalendar,alts.defaultToEN||false);}}
redefaultToEN(alts={}){return this.clone({...alts,defaultToEN:true});}
redefaultToSystem(alts={}){return this.clone({...alts,defaultToEN:false});}
months(length,format=false){return listStuff(this,length,months,()=>{const intl=format?{month:length,day:"numeric"}:{month:length},formatStr=format?"format":"standalone";if(!this.monthsCache[formatStr][length]){this.monthsCache[formatStr][length]=mapMonths((dt)=>this.extract(dt,intl,"month"));}
return this.monthsCache[formatStr][length];});}
weekdays(length,format=false){return listStuff(this,length,weekdays,()=>{const intl=format?{weekday:length,year:"numeric",month:"long",day:"numeric"}:{weekday:length},formatStr=format?"format":"standalone";if(!this.weekdaysCache[formatStr][length]){this.weekdaysCache[formatStr][length]=mapWeekdays((dt)=>this.extract(dt,intl,"weekday"));}
return this.weekdaysCache[formatStr][length];});}
meridiems(){return listStuff(this,undefined,()=>meridiems,()=>{if(!this.meridiemCache){const intl={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[DateTime.utc(2016,11,13,9),DateTime.utc(2016,11,13,19)].map((dt)=>this.extract(dt,intl,"dayperiod"));}
return this.meridiemCache;});}
eras(length){return listStuff(this,length,eras,()=>{const intl={era:length};if(!this.eraCache[length]){this.eraCache[length]=[DateTime.utc(-40,1,1),DateTime.utc(2017,1,1)].map((dt)=>this.extract(dt,intl,"era"));}
return this.eraCache[length];});}
extract(dt,intlOpts,field){const df=this.dtFormatter(dt,intlOpts),results=df.formatToParts(),matching=results.find((m)=>m.type.toLowerCase()===field);return matching?matching.value:null;}
numberFormatter(opts={}){return new PolyNumberFormatter(this.intl,opts.forceSimple||this.fastNumbers,opts);}
dtFormatter(dt,intlOpts={}){return new PolyDateFormatter(dt,this.intl,intlOpts);}
relFormatter(opts={}){return new PolyRelFormatter(this.intl,this.isEnglish(),opts);}
listFormatter(opts={}){return getCachedLF(this.intl,opts);}
isEnglish(){return(this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us"));}
equals(other){return(this.locale===other.locale&&this.numberingSystem===other.numberingSystem&&this.outputCalendar===other.outputCalendar);}}
let singleton=null;class FixedOffsetZone extends Zone{static get utcInstance(){if(singleton===null){singleton=new FixedOffsetZone(0);}
return singleton;}
static instance(offset){return offset===0?FixedOffsetZone.utcInstance:new FixedOffsetZone(offset);}
static parseSpecifier(s){if(s){const r=s.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r){return new FixedOffsetZone(signedOffset(r[1],r[2]));}}
return null;}
constructor(offset){super();this.fixed=offset;}
get type(){return"fixed";}
get name(){return this.fixed===0?"UTC":`UTC${formatOffset(this.fixed, "narrow")}`;}
get ianaName(){if(this.fixed===0){return"Etc/UTC";}else{return`Etc/GMT${formatOffset(-this.fixed, "narrow")}`;}}
offsetName(){return this.name;}
formatOffset(ts,format){return formatOffset(this.fixed,format);}
get isUniversal(){return true;}
offset(){return this.fixed;}
equals(otherZone){return otherZone.type==="fixed"&&otherZone.fixed===this.fixed;}
get isValid(){return true;}}
class InvalidZone extends Zone{constructor(zoneName){super();this.zoneName=zoneName;}
get type(){return"invalid";}
get name(){return this.zoneName;}
get isUniversal(){return false;}
offsetName(){return null;}
formatOffset(){return"";}
offset(){return NaN;}
equals(){return false;}
get isValid(){return false;}}
function normalizeZone(input,defaultZone){if(isUndefined(input)||input===null){return defaultZone;}else if(input instanceof Zone){return input;}else if(isString(input)){const lowered=input.toLowerCase();if(lowered==="default")return defaultZone;else if(lowered==="local"||lowered==="system")return SystemZone.instance;else if(lowered==="utc"||lowered==="gmt")return FixedOffsetZone.utcInstance;else return FixedOffsetZone.parseSpecifier(lowered)||IANAZone.create(input);}else if(isNumber(input)){return FixedOffsetZone.instance(input);}else if(typeof input==="object"&&"offset"in input&&typeof input.offset==="function"){return input;}else{return new InvalidZone(input);}}
let now=()=>Date.now(),defaultZone="system",defaultLocale=null,defaultNumberingSystem=null,defaultOutputCalendar=null,twoDigitCutoffYear=60,throwOnInvalid;class Settings{static get now(){return now;}
static set now(n){now=n;}
static set defaultZone(zone){defaultZone=zone;}
static get defaultZone(){return normalizeZone(defaultZone,SystemZone.instance);}
static get defaultLocale(){return defaultLocale;}
static set defaultLocale(locale){defaultLocale=locale;}
static get defaultNumberingSystem(){return defaultNumberingSystem;}
static set defaultNumberingSystem(numberingSystem){defaultNumberingSystem=numberingSystem;}
static get defaultOutputCalendar(){return defaultOutputCalendar;}
static set defaultOutputCalendar(outputCalendar){defaultOutputCalendar=outputCalendar;}
static get twoDigitCutoffYear(){return twoDigitCutoffYear;}
static set twoDigitCutoffYear(cutoffYear){twoDigitCutoffYear=cutoffYear%100;}
static get throwOnInvalid(){return throwOnInvalid;}
static set throwOnInvalid(t){throwOnInvalid=t;}
static resetCaches(){Locale.resetCache();IANAZone.resetCache();}}
function isUndefined(o){return typeof o==="undefined";}
function isNumber(o){return typeof o==="number";}
function isInteger(o){return typeof o==="number"&&o%1===0;}
function isString(o){return typeof o==="string";}
function isDate(o){return Object.prototype.toString.call(o)==="[object Date]";}
function hasRelative(){try{return typeof Intl!=="undefined"&&!!Intl.RelativeTimeFormat;}catch(e){return false;}}
function maybeArray(thing){return Array.isArray(thing)?thing:[thing];}
function bestBy(arr,by,compare){if(arr.length===0){return undefined;}
return arr.reduce((best,next)=>{const pair=[by(next),next];if(!best){return pair;}else if(compare(best[0],pair[0])===best[0]){return best;}else{return pair;}},null)[1];}
function pick(obj,keys){return keys.reduce((a,k)=>{a[k]=obj[k];return a;},{});}
function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop);}
function integerBetween(thing,bottom,top){return isInteger(thing)&&thing>=bottom&&thing<=top;}
function floorMod(x,n){return x-n*Math.floor(x/n);}
function padStart(input,n=2){const isNeg=input<0;let padded;if(isNeg){padded="-"+(""+-input).padStart(n,"0");}else{padded=(""+input).padStart(n,"0");}
return padded;}
function parseInteger(string){if(isUndefined(string)||string===null||string===""){return undefined;}else{return parseInt(string,10);}}
function parseFloating(string){if(isUndefined(string)||string===null||string===""){return undefined;}else{return parseFloat(string);}}
function parseMillis(fraction){if(isUndefined(fraction)||fraction===null||fraction===""){return undefined;}else{const f=parseFloat("0."+fraction)*1000;return Math.floor(f);}}
function roundTo(number,digits,towardZero=false){const factor=10**digits,rounder=towardZero?Math.trunc:Math.round;return rounder(number*factor)/factor;}
function isLeapYear(year){return year%4===0&&(year%100!==0||year%400===0);}
function daysInYear(year){return isLeapYear(year)?366:365;}
function daysInMonth(year,month){const modMonth=floorMod(month-1,12)+1,modYear=year+(month-modMonth)/12;if(modMonth===2){return isLeapYear(modYear)?29:28;}else{return[31,null,31,30,31,30,31,31,30,31,30,31][modMonth-1];}}
function objToLocalTS(obj){let d=Date.UTC(obj.year,obj.month-1,obj.day,obj.hour,obj.minute,obj.second,obj.millisecond);if(obj.year<100&&obj.year>=0){d=new Date(d);d.setUTCFullYear(obj.year,obj.month-1,obj.day);}
return+d;}
function weeksInWeekYear(weekYear){const p1=(weekYear+
Math.floor(weekYear/4)-
Math.floor(weekYear/100)+
Math.floor(weekYear/400))%7,last=weekYear-1,p2=(last+Math.floor(last/4)-Math.floor(last/100)+Math.floor(last/400))%7;return p1===4||p2===3?53:52;}
function untruncateYear(year){if(year>99){return year;}else return year>Settings.twoDigitCutoffYear?1900+year:2000+year;}
function parseZoneInfo(ts,offsetFormat,locale,timeZone=null){const date=new Date(ts),intlOpts={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",};if(timeZone){intlOpts.timeZone=timeZone;}
const modified={timeZoneName:offsetFormat,...intlOpts};const parsed=new Intl.DateTimeFormat(locale,modified).formatToParts(date).find((m)=>m.type.toLowerCase()==="timezonename");return parsed?parsed.value:null;}
function signedOffset(offHourStr,offMinuteStr){let offHour=parseInt(offHourStr,10);if(Number.isNaN(offHour)){offHour=0;}
const offMin=parseInt(offMinuteStr,10)||0,offMinSigned=offHour<0||Object.is(offHour,-0)?-offMin:offMin;return offHour*60+offMinSigned;}
function asNumber(value){const numericValue=Number(value);if(typeof value==="boolean"||value===""||Number.isNaN(numericValue))
throw new InvalidArgumentError(`Invalid unit value ${value}`);return numericValue;}
function normalizeObject(obj,normalizer){const normalized={};for(const u in obj){if(hasOwnProperty(obj,u)){const v=obj[u];if(v===undefined||v===null)continue;normalized[normalizer(u)]=asNumber(v);}}
return normalized;}
function formatOffset(offset,format){const hours=Math.trunc(Math.abs(offset/60)),minutes=Math.trunc(Math.abs(offset%60)),sign=offset>=0?"+":"-";switch(format){case"short":return`${sign}${padStart(hours, 2)}:${padStart(minutes, 2)}`;case"narrow":return`${sign}${hours}${minutes > 0 ? `:${minutes}` : ""}`;case"techie":return`${sign}${padStart(hours, 2)}${padStart(minutes, 2)}`;default:throw new RangeError(`Value format ${format} is out of range for property format`);}}
function timeObject(obj){return pick(obj,["hour","minute","second","millisecond"]);}
const monthsLong=["January","February","March","April","May","June","July","August","September","October","November","December",];const monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",];const monthsNarrow=["J","F","M","A","M","J","J","A","S","O","N","D"];function months(length){switch(length){case"narrow":return[...monthsNarrow];case"short":return[...monthsShort];case"long":return[...monthsLong];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null;}}
const weekdaysLong=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday",];const weekdaysShort=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];const weekdaysNarrow=["M","T","W","T","F","S","S"];function weekdays(length){switch(length){case"narrow":return[...weekdaysNarrow];case"short":return[...weekdaysShort];case"long":return[...weekdaysLong];case"numeric":return["1","2","3","4","5","6","7"];default:return null;}}
const meridiems=["AM","PM"];const erasLong=["Before Christ","Anno Domini"];const erasShort=["BC","AD"];const erasNarrow=["B","A"];function eras(length){switch(length){case"narrow":return[...erasNarrow];case"short":return[...erasShort];case"long":return[...erasLong];default:return null;}}
function meridiemForDateTime(dt){return meridiems[dt.hour<12?0:1];}
function weekdayForDateTime(dt,length){return weekdays(length)[dt.weekday-1];}
function monthForDateTime(dt,length){return months(length)[dt.month-1];}
function eraForDateTime(dt,length){return eras(length)[dt.year<0?0:1];}
function formatRelativeTime(unit,count,numeric="always",narrow=false){const units={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."],};const lastable=["hours","minutes","seconds"].indexOf(unit)===-1;if(numeric==="auto"&&lastable){const isDay=unit==="days";switch(count){case 1:return isDay?"tomorrow":`next ${units[unit][0]}`;case-1:return isDay?"yesterday":`last ${units[unit][0]}`;case 0:return isDay?"today":`this ${units[unit][0]}`;}}
const isInPast=Object.is(count,-0)||count<0,fmtValue=Math.abs(count),singular=fmtValue===1,lilUnits=units[unit],fmtUnit=narrow?singular?lilUnits[1]:lilUnits[2]||lilUnits[1]:singular?units[unit][0]:unit;return isInPast?`${fmtValue} ${fmtUnit} ago`:`in ${fmtValue} ${fmtUnit}`;}
function stringifyTokens(splits,tokenToString){let s="";for(const token of splits){if(token.literal){s+=token.val;}else{s+=tokenToString(token.val);}}
return s;}
const macroTokenToFormatOpts={D:DATE_SHORT,DD:DATE_MED,DDD:DATE_FULL,DDDD:DATE_HUGE,t:TIME_SIMPLE,tt:TIME_WITH_SECONDS,ttt:TIME_WITH_SHORT_OFFSET,tttt:TIME_WITH_LONG_OFFSET,T:TIME_24_SIMPLE,TT:TIME_24_WITH_SECONDS,TTT:TIME_24_WITH_SHORT_OFFSET,TTTT:TIME_24_WITH_LONG_OFFSET,f:DATETIME_SHORT,ff:DATETIME_MED,fff:DATETIME_FULL,ffff:DATETIME_HUGE,F:DATETIME_SHORT_WITH_SECONDS,FF:DATETIME_MED_WITH_SECONDS,FFF:DATETIME_FULL_WITH_SECONDS,FFFF:DATETIME_HUGE_WITH_SECONDS,};class Formatter{static create(locale,opts={}){return new Formatter(locale,opts);}
static parseFormat(fmt){let current=null,currentFull="",bracketed=false;const splits=[];for(let i=0;i<fmt.length;i++){const c=fmt.charAt(i);if(c==="'"){if(currentFull.length>0){splits.push({literal:bracketed||/^\s+$/.test(currentFull),val:currentFull});}
current=null;currentFull="";bracketed=!bracketed;}else if(bracketed){currentFull+=c;}else if(c===current){currentFull+=c;}else{if(currentFull.length>0){splits.push({literal:/^\s+$/.test(currentFull),val:currentFull});}
currentFull=c;current=c;}}
if(currentFull.length>0){splits.push({literal:bracketed||/^\s+$/.test(currentFull),val:currentFull});}
return splits;}
static macroTokenToFormatOpts(token){return macroTokenToFormatOpts[token];}
constructor(locale,formatOpts){this.opts=formatOpts;this.loc=locale;this.systemLoc=null;}
formatWithSystemDefault(dt,opts){if(this.systemLoc===null){this.systemLoc=this.loc.redefaultToSystem();}
const df=this.systemLoc.dtFormatter(dt,{...this.opts,...opts});return df.format();}
dtFormatter(dt,opts={}){return this.loc.dtFormatter(dt,{...this.opts,...opts});}
formatDateTime(dt,opts){return this.dtFormatter(dt,opts).format();}
formatDateTimeParts(dt,opts){return this.dtFormatter(dt,opts).formatToParts();}
formatInterval(interval,opts){const df=this.dtFormatter(interval.start,opts);return df.dtf.formatRange(interval.start.toJSDate(),interval.end.toJSDate());}
resolvedOptions(dt,opts){return this.dtFormatter(dt,opts).resolvedOptions();}
num(n,p=0){if(this.opts.forceSimple){return padStart(n,p);}
const opts={...this.opts};if(p>0){opts.padTo=p;}
return this.loc.numberFormatter(opts).format(n);}
formatDateTimeFromString(dt,fmt){const knownEnglish=this.loc.listingMode()==="en",useDateTimeFormatter=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",string=(opts,extract)=>this.loc.extract(dt,opts,extract),formatOffset=(opts)=>{if(dt.isOffsetFixed&&dt.offset===0&&opts.allowZ){return"Z";}
return dt.isValid?dt.zone.formatOffset(dt.ts,opts.format):"";},meridiem=()=>knownEnglish?meridiemForDateTime(dt):string({hour:"numeric",hourCycle:"h12"},"dayperiod"),month=(length,standalone)=>knownEnglish?monthForDateTime(dt,length):string(standalone?{month:length}:{month:length,day:"numeric"},"month"),weekday=(length,standalone)=>knownEnglish?weekdayForDateTime(dt,length):string(standalone?{weekday:length}:{weekday:length,month:"long",day:"numeric"},"weekday"),maybeMacro=(token)=>{const formatOpts=Formatter.macroTokenToFormatOpts(token);if(formatOpts){return this.formatWithSystemDefault(dt,formatOpts);}else{return token;}},era=(length)=>knownEnglish?eraForDateTime(dt,length):string({era:length},"era"),tokenToString=(token)=>{switch(token){case"S":return this.num(dt.millisecond);case"u":case"SSS":return this.num(dt.millisecond,3);case"s":return this.num(dt.second);case"ss":return this.num(dt.second,2);case"uu":return this.num(Math.floor(dt.millisecond/10),2);case"uuu":return this.num(Math.floor(dt.millisecond/100));case"m":return this.num(dt.minute);case"mm":return this.num(dt.minute,2);case"h":return this.num(dt.hour%12===0?12:dt.hour%12);case"hh":return this.num(dt.hour%12===0?12:dt.hour%12,2);case"H":return this.num(dt.hour);case"HH":return this.num(dt.hour,2);case"Z":return formatOffset({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return formatOffset({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return formatOffset({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return dt.zone.offsetName(dt.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return dt.zone.offsetName(dt.ts,{format:"long",locale:this.loc.locale});case"z":return dt.zoneName;case"a":return meridiem();case"d":return useDateTimeFormatter?string({day:"numeric"},"day"):this.num(dt.day);case"dd":return useDateTimeFormatter?string({day:"2-digit"},"day"):this.num(dt.day,2);case"c":return this.num(dt.weekday);case"ccc":return weekday("short",true);case"cccc":return weekday("long",true);case"ccccc":return weekday("narrow",true);case"E":return this.num(dt.weekday);case"EEE":return weekday("short",false);case"EEEE":return weekday("long",false);case"EEEEE":return weekday("narrow",false);case"L":return useDateTimeFormatter?string({month:"numeric",day:"numeric"},"month"):this.num(dt.month);case"LL":return useDateTimeFormatter?string({month:"2-digit",day:"numeric"},"month"):this.num(dt.month,2);case"LLL":return month("short",true);case"LLLL":return month("long",true);case"LLLLL":return month("narrow",true);case"M":return useDateTimeFormatter?string({month:"numeric"},"month"):this.num(dt.month);case"MM":return useDateTimeFormatter?string({month:"2-digit"},"month"):this.num(dt.month,2);case"MMM":return month("short",false);case"MMMM":return month("long",false);case"MMMMM":return month("narrow",false);case"y":return useDateTimeFormatter?string({year:"numeric"},"year"):this.num(dt.year);case"yy":return useDateTimeFormatter?string({year:"2-digit"},"year"):this.num(dt.year.toString().slice(-2),2);case"yyyy":return useDateTimeFormatter?string({year:"numeric"},"year"):this.num(dt.year,4);case"yyyyyy":return useDateTimeFormatter?string({year:"numeric"},"year"):this.num(dt.year,6);case"G":return era("short");case"GG":return era("long");case"GGGGG":return era("narrow");case"kk":return this.num(dt.weekYear.toString().slice(-2),2);case"kkkk":return this.num(dt.weekYear,4);case"W":return this.num(dt.weekNumber);case"WW":return this.num(dt.weekNumber,2);case"o":return this.num(dt.ordinal);case"ooo":return this.num(dt.ordinal,3);case"q":return this.num(dt.quarter);case"qq":return this.num(dt.quarter,2);case"X":return this.num(Math.floor(dt.ts/1000));case"x":return this.num(dt.ts);default:return maybeMacro(token);}};return stringifyTokens(Formatter.parseFormat(fmt),tokenToString);}
formatDurationFromString(dur,fmt){const tokenToField=(token)=>{switch(token[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null;}},tokenToString=(lildur)=>(token)=>{const mapped=tokenToField(token);if(mapped){return this.num(lildur.get(mapped),token.length);}else{return token;}},tokens=Formatter.parseFormat(fmt),realTokens=tokens.reduce((found,{literal,val})=>(literal?found:found.concat(val)),[]),collapsed=dur.shiftTo(...realTokens.map(tokenToField).filter((t)=>t));return stringifyTokens(tokens,tokenToString(collapsed));}}
class Invalid{constructor(reason,explanation){this.reason=reason;this.explanation=explanation;}
toMessage(){if(this.explanation){return`${this.reason}: ${this.explanation}`;}else{return this.reason;}}}
const ianaRegex=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function combineRegexes(...regexes){const full=regexes.reduce((f,r)=>f+r.source,"");return RegExp(`^${full}$`);}
function combineExtractors(...extractors){return(m)=>extractors.reduce(([mergedVals,mergedZone,cursor],ex)=>{const[val,zone,next]=ex(m,cursor);return[{...mergedVals,...val},zone||mergedZone,next];},[{},null,1]).slice(0,2);}
function parse(s,...patterns){if(s==null){return[null,null];}
for(const[regex,extractor]of patterns){const m=regex.exec(s);if(m){return extractor(m);}}
return[null,null];}
function simpleParse(...keys){return(match,cursor)=>{const ret={};let i;for(i=0;i<keys.length;i++){ret[keys[i]]=parseInteger(match[cursor+i]);}
return[ret,null,cursor+i];};}
const offsetRegex=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/;const isoExtendedZone=`(?:${offsetRegex.source}?(?:\\[(${ianaRegex.source})\\])?)?`;const isoTimeBaseRegex=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/;const isoTimeRegex=RegExp(`${isoTimeBaseRegex.source}${isoExtendedZone}`);const isoTimeExtensionRegex=RegExp(`(?:T${isoTimeRegex.source})?`);const isoYmdRegex=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/;const isoWeekRegex=/(\d{4})-?W(\d\d)(?:-?(\d))?/;const isoOrdinalRegex=/(\d{4})-?(\d{3})/;const extractISOWeekData=simpleParse("weekYear","weekNumber","weekDay");const extractISOOrdinalData=simpleParse("year","ordinal");const sqlYmdRegex=/(\d{4})-(\d\d)-(\d\d)/;const sqlTimeRegex=RegExp(`${isoTimeBaseRegex.source} ?(?:${offsetRegex.source}|(${ianaRegex.source}))?`);const sqlTimeExtensionRegex=RegExp(`(?: ${sqlTimeRegex.source})?`);function int(match,pos,fallback){const m=match[pos];return isUndefined(m)?fallback:parseInteger(m);}
function extractISOYmd(match,cursor){const item={year:int(match,cursor),month:int(match,cursor+1,1),day:int(match,cursor+2,1),};return[item,null,cursor+3];}
function extractISOTime(match,cursor){const item={hours:int(match,cursor,0),minutes:int(match,cursor+1,0),seconds:int(match,cursor+2,0),milliseconds:parseMillis(match[cursor+3]),};return[item,null,cursor+4];}
function extractISOOffset(match,cursor){const local=!match[cursor]&&!match[cursor+1],fullOffset=signedOffset(match[cursor+1],match[cursor+2]),zone=local?null:FixedOffsetZone.instance(fullOffset);return[{},zone,cursor+3];}
function extractIANAZone(match,cursor){const zone=match[cursor]?IANAZone.create(match[cursor]):null;return[{},zone,cursor+1];}
const isoTimeOnly=RegExp(`^T?${isoTimeBaseRegex.source}$`);const isoDuration=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function extractISODuration(match){const[s,yearStr,monthStr,weekStr,dayStr,hourStr,minuteStr,secondStr,millisecondsStr]=match;const hasNegativePrefix=s[0]==="-";const negativeSeconds=secondStr&&secondStr[0]==="-";const maybeNegate=(num,force=false)=>num!==undefined&&(force||(num&&hasNegativePrefix))?-num:num;return[{years:maybeNegate(parseFloating(yearStr)),months:maybeNegate(parseFloating(monthStr)),weeks:maybeNegate(parseFloating(weekStr)),days:maybeNegate(parseFloating(dayStr)),hours:maybeNegate(parseFloating(hourStr)),minutes:maybeNegate(parseFloating(minuteStr)),seconds:maybeNegate(parseFloating(secondStr),secondStr==="-0"),milliseconds:maybeNegate(parseMillis(millisecondsStr),negativeSeconds),},];}
const obsOffsets={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60,};function fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){const result={year:yearStr.length===2?untruncateYear(parseInteger(yearStr)):parseInteger(yearStr),month:monthsShort.indexOf(monthStr)+1,day:parseInteger(dayStr),hour:parseInteger(hourStr),minute:parseInteger(minuteStr),};if(secondStr)result.second=parseInteger(secondStr);if(weekdayStr){result.weekday=weekdayStr.length>3?weekdaysLong.indexOf(weekdayStr)+1:weekdaysShort.indexOf(weekdayStr)+1;}
return result;}
const rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function extractRFC2822(match){const[,weekdayStr,dayStr,monthStr,yearStr,hourStr,minuteStr,secondStr,obsOffset,milOffset,offHourStr,offMinuteStr,]=match,result=fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr);let offset;if(obsOffset){offset=obsOffsets[obsOffset];}else if(milOffset){offset=0;}else{offset=signedOffset(offHourStr,offMinuteStr);}
return[result,new FixedOffsetZone(offset)];}
function preprocessRFC2822(s){return s.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim();}
const rfc1123=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,rfc850=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,ascii=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function extractRFC1123Or850(match){const[,weekdayStr,dayStr,monthStr,yearStr,hourStr,minuteStr,secondStr]=match,result=fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr);return[result,FixedOffsetZone.utcInstance];}
function extractASCII(match){const[,weekdayStr,monthStr,dayStr,hourStr,minuteStr,secondStr,yearStr]=match,result=fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr);return[result,FixedOffsetZone.utcInstance];}
const isoYmdWithTimeExtensionRegex=combineRegexes(isoYmdRegex,isoTimeExtensionRegex);const isoWeekWithTimeExtensionRegex=combineRegexes(isoWeekRegex,isoTimeExtensionRegex);const isoOrdinalWithTimeExtensionRegex=combineRegexes(isoOrdinalRegex,isoTimeExtensionRegex);const isoTimeCombinedRegex=combineRegexes(isoTimeRegex);const extractISOYmdTimeAndOffset=combineExtractors(extractISOYmd,extractISOTime,extractISOOffset,extractIANAZone);const extractISOWeekTimeAndOffset=combineExtractors(extractISOWeekData,extractISOTime,extractISOOffset,extractIANAZone);const extractISOOrdinalDateAndTime=combineExtractors(extractISOOrdinalData,extractISOTime,extractISOOffset,extractIANAZone);const extractISOTimeAndOffset=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);function parseISODate(s){return parse(s,[isoYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[isoWeekWithTimeExtensionRegex,extractISOWeekTimeAndOffset],[isoOrdinalWithTimeExtensionRegex,extractISOOrdinalDateAndTime],[isoTimeCombinedRegex,extractISOTimeAndOffset]);}
function parseRFC2822Date(s){return parse(preprocessRFC2822(s),[rfc2822,extractRFC2822]);}
function parseHTTPDate(s){return parse(s,[rfc1123,extractRFC1123Or850],[rfc850,extractRFC1123Or850],[ascii,extractASCII]);}
function parseISODuration(s){return parse(s,[isoDuration,extractISODuration]);}
const extractISOTimeOnly=combineExtractors(extractISOTime);function parseISOTimeOnly(s){return parse(s,[isoTimeOnly,extractISOTimeOnly]);}
const sqlYmdWithTimeExtensionRegex=combineRegexes(sqlYmdRegex,sqlTimeExtensionRegex);const sqlTimeCombinedRegex=combineRegexes(sqlTimeRegex);const extractISOTimeOffsetAndIANAZone=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);function parseSQL(s){return parse(s,[sqlYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[sqlTimeCombinedRegex,extractISOTimeOffsetAndIANAZone]);}
const INVALID$2="Invalid Duration";const lowOrderMatrix={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1000,},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1000,},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1000},minutes:{seconds:60,milliseconds:60*1000},seconds:{milliseconds:1000},},casualMatrix={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1000,},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1000,},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1000,},...lowOrderMatrix,},daysInYearAccurate=146097.0/400,daysInMonthAccurate=146097.0/4800,accurateMatrix={years:{quarters:4,months:12,weeks:daysInYearAccurate/7,days:daysInYearAccurate,hours:daysInYearAccurate*24,minutes:daysInYearAccurate*24*60,seconds:daysInYearAccurate*24*60*60,milliseconds:daysInYearAccurate*24*60*60*1000,},quarters:{months:3,weeks:daysInYearAccurate/28,days:daysInYearAccurate/4,hours:(daysInYearAccurate*24)/4,minutes:(daysInYearAccurate*24*60)/4,seconds:(daysInYearAccurate*24*60*60)/4,milliseconds:(daysInYearAccurate*24*60*60*1000)/4,},months:{weeks:daysInMonthAccurate/7,days:daysInMonthAccurate,hours:daysInMonthAccurate*24,minutes:daysInMonthAccurate*24*60,seconds:daysInMonthAccurate*24*60*60,milliseconds:daysInMonthAccurate*24*60*60*1000,},...lowOrderMatrix,};const orderedUnits$1=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds",];const reverseUnits=orderedUnits$1.slice(0).reverse();function clone$1(dur,alts,clear=false){const conf={values:clear?alts.values:{...dur.values,...(alts.values||{})},loc:dur.loc.clone(alts.loc),conversionAccuracy:alts.conversionAccuracy||dur.conversionAccuracy,matrix:alts.matrix||dur.matrix,};return new Duration(conf);}
function durationToMillis(matrix,vals){let sum=vals.milliseconds??0;for(const unit of reverseUnits.slice(1)){if(vals[unit]){sum+=vals[unit]*matrix[unit]["milliseconds"];}}
return sum;}
function normalizeValues(matrix,vals){const factor=durationToMillis(matrix,vals)<0?-1:1;reverseUnits.reduce((previous,current)=>{if(!isUndefined(vals[current])){if(previous){const previousVal=vals[previous]*factor;const conv=matrix[current][previous];const rollUp=Math.floor(previousVal/conv);vals[current]+=rollUp*factor;vals[previous]-=rollUp*conv*factor;}
return current;}else{return previous;}},null);}
function removeZeroes(vals){const newVals={};for(const[key,value]of Object.entries(vals)){if(value!==0){newVals[key]=value;}}
return newVals;}
class Duration{constructor(config){const accurate=config.conversionAccuracy==="longterm"||false;let matrix=accurate?accurateMatrix:casualMatrix;if(config.matrix){matrix=config.matrix;}
this.values=config.values;this.loc=config.loc||Locale.create();this.conversionAccuracy=accurate?"longterm":"casual";this.invalid=config.invalid||null;this.matrix=matrix;this.isLuxonDuration=true;}
static fromMillis(count,opts){return Duration.fromObject({milliseconds:count},opts);}
static fromObject(obj,opts={}){if(obj==null||typeof obj!=="object"){throw new InvalidArgumentError(`Duration.fromObject: argument expected to be an object, got ${obj === null ? "null" : typeof obj
          }`);}
return new Duration({values:normalizeObject(obj,Duration.normalizeUnit),loc:Locale.fromObject(opts),conversionAccuracy:opts.conversionAccuracy,matrix:opts.matrix,});}
static fromDurationLike(durationLike){if(isNumber(durationLike)){return Duration.fromMillis(durationLike);}else if(Duration.isDuration(durationLike)){return durationLike;}else if(typeof durationLike==="object"){return Duration.fromObject(durationLike);}else{throw new InvalidArgumentError(`Unknown duration argument ${durationLike} of type ${typeof durationLike}`);}}
static fromISO(text,opts){const[parsed]=parseISODuration(text);if(parsed){return Duration.fromObject(parsed,opts);}else{return Duration.invalid("unparsable",`the input "${text}" can't be parsed as ISO 8601`);}}
static fromISOTime(text,opts){const[parsed]=parseISOTimeOnly(text);if(parsed){return Duration.fromObject(parsed,opts);}else{return Duration.invalid("unparsable",`the input "${text}" can't be parsed as ISO 8601`);}}
static invalid(reason,explanation=null){if(!reason){throw new InvalidArgumentError("need to specify a reason the Duration is invalid");}
const invalid=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid){throw new InvalidDurationError(invalid);}else{return new Duration({invalid});}}
static normalizeUnit(unit){const normalized={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds",}[unit?unit.toLowerCase():unit];if(!normalized)throw new InvalidUnitError(unit);return normalized;}
static isDuration(o){return(o&&o.isLuxonDuration)||false;}
get locale(){return this.isValid?this.loc.locale:null;}
get numberingSystem(){return this.isValid?this.loc.numberingSystem:null;}
toFormat(fmt,opts={}){const fmtOpts={...opts,floor:opts.round!==false&&opts.floor!==false,};return this.isValid?Formatter.create(this.loc,fmtOpts).formatDurationFromString(this,fmt):INVALID$2;}
toHuman(opts={}){if(!this.isValid)return INVALID$2;const l=orderedUnits$1.map((unit)=>{const val=this.values[unit];if(isUndefined(val)){return null;}
return this.loc.numberFormatter({style:"unit",unitDisplay:"long",...opts,unit:unit.slice(0,-1)}).format(val);}).filter((n)=>n);return this.loc.listFormatter({type:"conjunction",style:opts.listStyle||"narrow",...opts}).format(l);}
toObject(){if(!this.isValid)return{};return{...this.values};}
toISO(){if(!this.isValid)return null;let s="P";if(this.years!==0)s+=this.years+"Y";if(this.months!==0||this.quarters!==0)s+=this.months+this.quarters*3+"M";if(this.weeks!==0)s+=this.weeks+"W";if(this.days!==0)s+=this.days+"D";if(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)
s+="T";if(this.hours!==0)s+=this.hours+"H";if(this.minutes!==0)s+=this.minutes+"M";if(this.seconds!==0||this.milliseconds!==0)
s+=roundTo(this.seconds+this.milliseconds/1000,3)+"S";if(s==="P")s+="T0S";return s;}
toISOTime(opts={}){if(!this.isValid)return null;const millis=this.toMillis();if(millis<0||millis>=86400000)return null;opts={suppressMilliseconds:false,suppressSeconds:false,includePrefix:false,format:"extended",...opts,includeOffset:false,};const dateTime=DateTime.fromMillis(millis,{zone:"UTC"});return dateTime.toISOTime(opts);}
toJSON(){return this.toISO();}
toString(){return this.toISO();}
toMillis(){if(!this.isValid)return NaN;return durationToMillis(this.matrix,this.values);}
valueOf(){return this.toMillis();}
plus(duration){if(!this.isValid)return this;const dur=Duration.fromDurationLike(duration),result={};for(const k of orderedUnits$1){if(hasOwnProperty(dur.values,k)||hasOwnProperty(this.values,k)){result[k]=dur.get(k)+this.get(k);}}
return clone$1(this,{values:result},true);}
minus(duration){if(!this.isValid)return this;const dur=Duration.fromDurationLike(duration);return this.plus(dur.negate());}
mapUnits(fn){if(!this.isValid)return this;const result={};for(const k of Object.keys(this.values)){result[k]=asNumber(fn(this.values[k],k));}
return clone$1(this,{values:result},true);}
get(unit){return this[Duration.normalizeUnit(unit)];}
set(values){if(!this.isValid)return this;const mixed={...this.values,...normalizeObject(values,Duration.normalizeUnit)};return clone$1(this,{values:mixed});}
reconfigure({locale,numberingSystem,conversionAccuracy,matrix}={}){const loc=this.loc.clone({locale,numberingSystem});const opts={loc,matrix,conversionAccuracy};return clone$1(this,opts);}
as(unit){return this.isValid?this.shiftTo(unit).get(unit):NaN;}
normalize(){if(!this.isValid)return this;const vals=this.toObject();normalizeValues(this.matrix,vals);return clone$1(this,{values:vals},true);}
rescale(){if(!this.isValid)return this;const vals=removeZeroes(this.normalize().shiftToAll().toObject());return clone$1(this,{values:vals},true);}
shiftTo(...units){if(!this.isValid)return this;if(units.length===0){return this;}
units=units.map((u)=>Duration.normalizeUnit(u));const built={},accumulated={},vals=this.toObject();let lastUnit;for(const k of orderedUnits$1){if(units.indexOf(k)>=0){lastUnit=k;let own=0;for(const ak in accumulated){own+=this.matrix[ak][k]*accumulated[ak];accumulated[ak]=0;}
if(isNumber(vals[k])){own+=vals[k];}
const i=Math.trunc(own);built[k]=i;accumulated[k]=(own*1000-i*1000)/1000;}else if(isNumber(vals[k])){accumulated[k]=vals[k];}}
for(const key in accumulated){if(accumulated[key]!==0){built[lastUnit]+=key===lastUnit?accumulated[key]:accumulated[key]/this.matrix[lastUnit][key];}}
normalizeValues(this.matrix,built);return clone$1(this,{values:built},true);}
shiftToAll(){if(!this.isValid)return this;return this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds");}
negate(){if(!this.isValid)return this;const negated={};for(const k of Object.keys(this.values)){negated[k]=this.values[k]===0?0:-this.values[k];}
return clone$1(this,{values:negated},true);}
get years(){return this.isValid?this.values.years||0:NaN;}
get quarters(){return this.isValid?this.values.quarters||0:NaN;}
get months(){return this.isValid?this.values.months||0:NaN;}
get weeks(){return this.isValid?this.values.weeks||0:NaN;}
get days(){return this.isValid?this.values.days||0:NaN;}
get hours(){return this.isValid?this.values.hours||0:NaN;}
get minutes(){return this.isValid?this.values.minutes||0:NaN;}
get seconds(){return this.isValid?this.values.seconds||0:NaN;}
get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN;}
get isValid(){return this.invalid===null;}
get invalidReason(){return this.invalid?this.invalid.reason:null;}
get invalidExplanation(){return this.invalid?this.invalid.explanation:null;}
equals(other){if(!this.isValid||!other.isValid){return false;}
if(!this.loc.equals(other.loc)){return false;}
function eq(v1,v2){if(v1===undefined||v1===0)return v2===undefined||v2===0;return v1===v2;}
for(const u of orderedUnits$1){if(!eq(this.values[u],other.values[u])){return false;}}
return true;}}
const INVALID$1="Invalid Interval";function validateStartEnd(start,end){if(!start||!start.isValid){return Interval.invalid("missing or invalid start");}else if(!end||!end.isValid){return Interval.invalid("missing or invalid end");}else if(end<start){return Interval.invalid("end before start",`The end of an interval must be after its start, but you had start=${start.toISO()} and end=${end.toISO()}`);}else{return null;}}
class Interval{constructor(config){this.s=config.start;this.e=config.end;this.invalid=config.invalid||null;this.isLuxonInterval=true;}
static invalid(reason,explanation=null){if(!reason){throw new InvalidArgumentError("need to specify a reason the Interval is invalid");}
const invalid=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid){throw new InvalidIntervalError(invalid);}else{return new Interval({invalid});}}
static fromDateTimes(start,end){const builtStart=friendlyDateTime(start),builtEnd=friendlyDateTime(end);const validateError=validateStartEnd(builtStart,builtEnd);if(validateError==null){return new Interval({start:builtStart,end:builtEnd,});}else{return validateError;}}
static after(start,duration){const dur=Duration.fromDurationLike(duration),dt=friendlyDateTime(start);return Interval.fromDateTimes(dt,dt.plus(dur));}
static before(end,duration){const dur=Duration.fromDurationLike(duration),dt=friendlyDateTime(end);return Interval.fromDateTimes(dt.minus(dur),dt);}
static fromISO(text,opts){const[s,e]=(text||"").split("/",2);if(s&&e){let start,startIsValid;try{start=DateTime.fromISO(s,opts);startIsValid=start.isValid;}catch(e){startIsValid=false;}
let end,endIsValid;try{end=DateTime.fromISO(e,opts);endIsValid=end.isValid;}catch(e){endIsValid=false;}
if(startIsValid&&endIsValid){return Interval.fromDateTimes(start,end);}
if(startIsValid){const dur=Duration.fromISO(e,opts);if(dur.isValid){return Interval.after(start,dur);}}else if(endIsValid){const dur=Duration.fromISO(s,opts);if(dur.isValid){return Interval.before(end,dur);}}}
return Interval.invalid("unparsable",`the input "${text}" can't be parsed as ISO 8601`);}
static isInterval(o){return(o&&o.isLuxonInterval)||false;}
get start(){return this.isValid?this.s:null;}
get end(){return this.isValid?this.e:null;}
get isValid(){return this.invalidReason===null;}
get invalidReason(){return this.invalid?this.invalid.reason:null;}
get invalidExplanation(){return this.invalid?this.invalid.explanation:null;}
length(unit="milliseconds"){return this.isValid?this.toDuration(...[unit]).get(unit):NaN;}
count(unit="milliseconds"){if(!this.isValid)return NaN;const start=this.start.startOf(unit),end=this.end.startOf(unit);return Math.floor(end.diff(start,unit).get(unit))+(end.valueOf()!==this.end.valueOf());}
hasSame(unit){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,unit):false;}
isEmpty(){return this.s.valueOf()===this.e.valueOf();}
isAfter(dateTime){if(!this.isValid)return false;return this.s>dateTime;}
isBefore(dateTime){if(!this.isValid)return false;return this.e<=dateTime;}
contains(dateTime){if(!this.isValid)return false;return this.s<=dateTime&&this.e>dateTime;}
set({start,end}={}){if(!this.isValid)return this;return Interval.fromDateTimes(start||this.s,end||this.e);}
splitAt(...dateTimes){if(!this.isValid)return[];const sorted=dateTimes.map(friendlyDateTime).filter((d)=>this.contains(d)).sort(),results=[];let{s}=this,i=0;while(s<this.e){const added=sorted[i]||this.e,next=+added>+this.e?this.e:added;results.push(Interval.fromDateTimes(s,next));s=next;i+=1;}
return results;}
splitBy(duration){const dur=Duration.fromDurationLike(duration);if(!this.isValid||!dur.isValid||dur.as("milliseconds")===0){return[];}
let{s}=this,idx=1,next;const results=[];while(s<this.e){const added=this.start.plus(dur.mapUnits((x)=>x*idx));next=+added>+this.e?this.e:added;results.push(Interval.fromDateTimes(s,next));s=next;idx+=1;}
return results;}
divideEqually(numberOfParts){if(!this.isValid)return[];return this.splitBy(this.length()/numberOfParts).slice(0,numberOfParts);}
overlaps(other){return this.e>other.s&&this.s<other.e;}
abutsStart(other){if(!this.isValid)return false;return+this.e===+other.s;}
abutsEnd(other){if(!this.isValid)return false;return+other.e===+this.s;}
engulfs(other){if(!this.isValid)return false;return this.s<=other.s&&this.e>=other.e;}
equals(other){if(!this.isValid||!other.isValid){return false;}
return this.s.equals(other.s)&&this.e.equals(other.e);}
intersection(other){if(!this.isValid)return this;const s=this.s>other.s?this.s:other.s,e=this.e<other.e?this.e:other.e;if(s>=e){return null;}else{return Interval.fromDateTimes(s,e);}}
union(other){if(!this.isValid)return this;const s=this.s<other.s?this.s:other.s,e=this.e>other.e?this.e:other.e;return Interval.fromDateTimes(s,e);}
static merge(intervals){const[found,final]=intervals.sort((a,b)=>a.s-b.s).reduce(([sofar,current],item)=>{if(!current){return[sofar,item];}else if(current.overlaps(item)||current.abutsStart(item)){return[sofar,current.union(item)];}else{return[sofar.concat([current]),item];}},[[],null]);if(final){found.push(final);}
return found;}
static xor(intervals){let start=null,currentCount=0;const results=[],ends=intervals.map((i)=>[{time:i.s,type:"s"},{time:i.e,type:"e"},]),flattened=Array.prototype.concat(...ends),arr=flattened.sort((a,b)=>a.time-b.time);for(const i of arr){currentCount+=i.type==="s"?1:-1;if(currentCount===1){start=i.time;}else{if(start&&+start!==+i.time){results.push(Interval.fromDateTimes(start,i.time));}
start=null;}}
return Interval.merge(results);}
difference(...intervals){return Interval.xor([this].concat(intervals)).map((i)=>this.intersection(i)).filter((i)=>i&&!i.isEmpty());}
toString(){if(!this.isValid)return INVALID$1;return`[${this.s.toISO()}  ${this.e.toISO()})`;}
toLocaleString(formatOpts=DATE_SHORT,opts={}){return this.isValid?Formatter.create(this.s.loc.clone(opts),formatOpts).formatInterval(this):INVALID$1;}
toISO(opts){if(!this.isValid)return INVALID$1;return`${this.s.toISO(opts)}/${this.e.toISO(opts)}`;}
toISODate(){if(!this.isValid)return INVALID$1;return`${this.s.toISODate()}/${this.e.toISODate()}`;}
toISOTime(opts){if(!this.isValid)return INVALID$1;return`${this.s.toISOTime(opts)}/${this.e.toISOTime(opts)}`;}
toFormat(dateFormat,{separator="  "}={}){if(!this.isValid)return INVALID$1;return`${this.s.toFormat(dateFormat)}${separator}${this.e.toFormat(dateFormat)}`;}
toDuration(unit,opts){if(!this.isValid){return Duration.invalid(this.invalidReason);}
return this.e.diff(this.s,unit,opts);}
mapEndpoints(mapFn){return Interval.fromDateTimes(mapFn(this.s),mapFn(this.e));}}
class Info{static hasDST(zone=Settings.defaultZone){const proto=DateTime.now().setZone(zone).set({month:12});return!zone.isUniversal&&proto.offset!==proto.set({month:6}).offset;}
static isValidIANAZone(zone){return IANAZone.isValidZone(zone);}
static normalizeZone(input){return normalizeZone(input,Settings.defaultZone);}
static months(length="long",{locale=null,numberingSystem=null,locObj=null,outputCalendar="gregory"}={}){return(locObj||Locale.create(locale,numberingSystem,outputCalendar)).months(length);}
static monthsFormat(length="long",{locale=null,numberingSystem=null,locObj=null,outputCalendar="gregory"}={}){return(locObj||Locale.create(locale,numberingSystem,outputCalendar)).months(length,true);}
static weekdays(length="long",{locale=null,numberingSystem=null,locObj=null}={}){return(locObj||Locale.create(locale,numberingSystem,null)).weekdays(length);}
static weekdaysFormat(length="long",{locale=null,numberingSystem=null,locObj=null}={}){return(locObj||Locale.create(locale,numberingSystem,null)).weekdays(length,true);}
static meridiems({locale=null}={}){return Locale.create(locale).meridiems();}
static eras(length="short",{locale=null}={}){return Locale.create(locale,null,"gregory").eras(length);}
static features(){return{relative:hasRelative()};}}
function dayDiff(earlier,later){const utcDayStart=(dt)=>dt.toUTC(0,{keepLocalTime:true}).startOf("day").valueOf(),ms=utcDayStart(later)-utcDayStart(earlier);return Math.floor(Duration.fromMillis(ms).as("days"));}
function highOrderDiffs(cursor,later,units){const differs=[["years",(a,b)=>b.year-a.year],["quarters",(a,b)=>b.quarter-a.quarter+(b.year-a.year)*4],["months",(a,b)=>b.month-a.month+(b.year-a.year)*12],["weeks",(a,b)=>{const days=dayDiff(a,b);return(days-(days%7))/7;},],["days",dayDiff],];const results={};const earlier=cursor;let lowestOrder,highWater;for(const[unit,differ]of differs){if(units.indexOf(unit)>=0){lowestOrder=unit;results[unit]=differ(cursor,later);highWater=earlier.plus(results);if(highWater>later){results[unit]--;cursor=earlier.plus(results);if(cursor>later){highWater=cursor;results[unit]--;cursor=earlier.plus(results);}}else{cursor=highWater;}}}
return[cursor,results,highWater,lowestOrder];}
function diff(earlier,later,units,opts){let[cursor,results,highWater,lowestOrder]=highOrderDiffs(earlier,later,units);const remainingMillis=later-cursor;const lowerOrderUnits=units.filter((u)=>["hours","minutes","seconds","milliseconds"].indexOf(u)>=0);if(lowerOrderUnits.length===0){if(highWater<later){highWater=cursor.plus({[lowestOrder]:1});}
if(highWater!==cursor){results[lowestOrder]=(results[lowestOrder]||0)+remainingMillis/(highWater-cursor);}}
const duration=Duration.fromObject(results,opts);if(lowerOrderUnits.length>0){return Duration.fromMillis(remainingMillis,opts).shiftTo(...lowerOrderUnits).plus(duration);}else{return duration;}}
const numberingSystems={arab:"[\u0660-\u0669]",arabext:"[\u06F0-\u06F9]",bali:"[\u1B50-\u1B59]",beng:"[\u09E6-\u09EF]",deva:"[\u0966-\u096F]",fullwide:"[\uFF10-\uFF19]",gujr:"[\u0AE6-\u0AEF]",hanidec:"[|||||||||]",khmr:"[\u17E0-\u17E9]",knda:"[\u0CE6-\u0CEF]",laoo:"[\u0ED0-\u0ED9]",limb:"[\u1946-\u194F]",mlym:"[\u0D66-\u0D6F]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0B66-\u0B6F]",tamldec:"[\u0BE6-\u0BEF]",telu:"[\u0C66-\u0C6F]",thai:"[\u0E50-\u0E59]",tibt:"[\u0F20-\u0F29]",latn:"\\d",};const numberingSystemsUTF16={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881],};const hanidecChars=numberingSystems.hanidec.replace(/[\[|\]]/g,"").split("");function parseDigits(str){let value=parseInt(str,10);if(isNaN(value)){value="";for(let i=0;i<str.length;i++){const code=str.charCodeAt(i);if(str[i].search(numberingSystems.hanidec)!==-1){value+=hanidecChars.indexOf(str[i]);}else{for(const key in numberingSystemsUTF16){const[min,max]=numberingSystemsUTF16[key];if(code>=min&&code<=max){value+=code-min;}}}}
return parseInt(value,10);}else{return value;}}
function digitRegex({numberingSystem},append=""){return new RegExp(`${numberingSystems[numberingSystem || "latn"]}${append}`);}
const MISSING_FTP="missing Intl.DateTimeFormat.formatToParts support";function intUnit(regex,post=(i)=>i){return{regex,deser:([s])=>post(parseDigits(s))};}
const NBSP=String.fromCharCode(160);const spaceOrNBSP=`[ ${NBSP}]`;const spaceOrNBSPRegExp=new RegExp(spaceOrNBSP,"g");function fixListRegex(s){return s.replace(/\./g,"\\.?").replace(spaceOrNBSPRegExp,spaceOrNBSP);}
function stripInsensitivities(s){return s.replace(/\./g,"").replace(spaceOrNBSPRegExp," ").toLowerCase();}
function oneOf(strings,startIndex){if(strings===null){return null;}else{return{regex:RegExp(strings.map(fixListRegex).join("|")),deser:([s])=>strings.findIndex((i)=>stripInsensitivities(s)===stripInsensitivities(i))+startIndex,};}}
function offset(regex,groups){return{regex,deser:([,h,m])=>signedOffset(h,m),groups};}
function simple(regex){return{regex,deser:([s])=>s};}
function escapeToken(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");}
function unitForToken(token,loc){const one=digitRegex(loc),two=digitRegex(loc,"{2}"),three=digitRegex(loc,"{3}"),four=digitRegex(loc,"{4}"),six=digitRegex(loc,"{6}"),oneOrTwo=digitRegex(loc,"{1,2}"),oneToThree=digitRegex(loc,"{1,3}"),oneToSix=digitRegex(loc,"{1,6}"),oneToNine=digitRegex(loc,"{1,9}"),twoToFour=digitRegex(loc,"{2,4}"),fourToSix=digitRegex(loc,"{4,6}"),literal=(t)=>({regex:RegExp(escapeToken(t.val)),deser:([s])=>s,literal:true}),unitate=(t)=>{if(token.literal){return literal(t);}
switch(t.val){case"G":return oneOf(loc.eras("short"),0);case"GG":return oneOf(loc.eras("long"),0);case"y":return intUnit(oneToSix);case"yy":return intUnit(twoToFour,untruncateYear);case"yyyy":return intUnit(four);case"yyyyy":return intUnit(fourToSix);case"yyyyyy":return intUnit(six);case"M":return intUnit(oneOrTwo);case"MM":return intUnit(two);case"MMM":return oneOf(loc.months("short",true),1);case"MMMM":return oneOf(loc.months("long",true),1);case"L":return intUnit(oneOrTwo);case"LL":return intUnit(two);case"LLL":return oneOf(loc.months("short",false),1);case"LLLL":return oneOf(loc.months("long",false),1);case"d":return intUnit(oneOrTwo);case"dd":return intUnit(two);case"o":return intUnit(oneToThree);case"ooo":return intUnit(three);case"HH":return intUnit(two);case"H":return intUnit(oneOrTwo);case"hh":return intUnit(two);case"h":return intUnit(oneOrTwo);case"mm":return intUnit(two);case"m":return intUnit(oneOrTwo);case"q":return intUnit(oneOrTwo);case"qq":return intUnit(two);case"s":return intUnit(oneOrTwo);case"ss":return intUnit(two);case"S":return intUnit(oneToThree);case"SSS":return intUnit(three);case"u":return simple(oneToNine);case"uu":return simple(oneOrTwo);case"uuu":return intUnit(one);case"a":return oneOf(loc.meridiems(),0);case"kkkk":return intUnit(four);case"kk":return intUnit(twoToFour,untruncateYear);case"W":return intUnit(oneOrTwo);case"WW":return intUnit(two);case"E":case"c":return intUnit(one);case"EEE":return oneOf(loc.weekdays("short",false),1);case"EEEE":return oneOf(loc.weekdays("long",false),1);case"ccc":return oneOf(loc.weekdays("short",true),1);case"cccc":return oneOf(loc.weekdays("long",true),1);case"Z":case"ZZ":return offset(new RegExp(`([+-]${oneOrTwo.source})(?::(${two.source}))?`),2);case"ZZZ":return offset(new RegExp(`([+-]${oneOrTwo.source})(${two.source})?`),2);case"z":return simple(/[a-z_+-/]{1,256}?/i);case" ":return simple(/[^\S\n\r]/);default:return literal(t);}};const unit=unitate(token)||{invalidReason:MISSING_FTP,};unit.token=token;return unit;}
const partTypeStyleToTokenVal={year:{"2-digit":"yy",numeric:"yyyyy",},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM",},day:{numeric:"d","2-digit":"dd",},weekday:{short:"EEE",long:"EEEE",},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh",},hour24:{numeric:"H","2-digit":"HH",},minute:{numeric:"m","2-digit":"mm",},second:{numeric:"s","2-digit":"ss",},timeZoneName:{long:"ZZZZZ",short:"ZZZ",},};function tokenForPart(part,formatOpts,resolvedOpts){const{type,value}=part;if(type==="literal"){const isSpace=/^\s+$/.test(value);return{literal:!isSpace,val:isSpace?" ":value,};}
const style=formatOpts[type];let actualType=type;if(type==="hour"){if(formatOpts.hour12!=null){actualType=formatOpts.hour12?"hour12":"hour24";}else if(formatOpts.hourCycle!=null){if(formatOpts.hourCycle==="h11"||formatOpts.hourCycle==="h12"){actualType="hour12";}else{actualType="hour24";}}else{actualType=resolvedOpts.hour12?"hour12":"hour24";}}
let val=partTypeStyleToTokenVal[actualType];if(typeof val==="object"){val=val[style];}
if(val){return{literal:false,val,};}
return undefined;}
function buildRegex(units){const re=units.map((u)=>u.regex).reduce((f,r)=>`${f}(${r.source})`,"");return[`^${re}$`,units];}
function match(input,regex,handlers){const matches=input.match(regex);if(matches){const all={};let matchIndex=1;for(const i in handlers){if(hasOwnProperty(handlers,i)){const h=handlers[i],groups=h.groups?h.groups+1:1;if(!h.literal&&h.token){all[h.token.val[0]]=h.deser(matches.slice(matchIndex,matchIndex+groups));}
matchIndex+=groups;}}
return[matches,all];}else{return[matches,{}];}}
function dateTimeFromMatches(matches){const toField=(token)=>{switch(token){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null;}};let zone=null;let specificOffset;if(!isUndefined(matches.z)){zone=IANAZone.create(matches.z);}
if(!isUndefined(matches.Z)){if(!zone){zone=new FixedOffsetZone(matches.Z);}
specificOffset=matches.Z;}
if(!isUndefined(matches.q)){matches.M=(matches.q-1)*3+1;}
if(!isUndefined(matches.h)){if(matches.h<12&&matches.a===1){matches.h+=12;}else if(matches.h===12&&matches.a===0){matches.h=0;}}
if(matches.G===0&&matches.y){matches.y=-matches.y;}
if(!isUndefined(matches.u)){matches.S=parseMillis(matches.u);}
const vals=Object.keys(matches).reduce((r,k)=>{const f=toField(k);if(f){r[f]=matches[k];}
return r;},{});return[vals,zone,specificOffset];}
let dummyDateTimeCache=null;function getDummyDateTime(){if(!dummyDateTimeCache){dummyDateTimeCache=DateTime.fromMillis(1555555555555);}
return dummyDateTimeCache;}
function maybeExpandMacroToken(token,locale){if(token.literal){return token;}
const formatOpts=Formatter.macroTokenToFormatOpts(token.val);const tokens=formatOptsToTokens(formatOpts,locale);if(tokens==null||tokens.includes(undefined)){return token;}
return tokens;}
function expandMacroTokens(tokens,locale){return Array.prototype.concat(...tokens.map((t)=>maybeExpandMacroToken(t,locale)));}
function explainFromTokens(locale,input,format){const tokens=expandMacroTokens(Formatter.parseFormat(format),locale),units=tokens.map((t)=>unitForToken(t,locale)),disqualifyingUnit=units.find((t)=>t.invalidReason);if(disqualifyingUnit){return{input,tokens,invalidReason:disqualifyingUnit.invalidReason};}else{const[regexString,handlers]=buildRegex(units),regex=RegExp(regexString,"i"),[rawMatches,matches]=match(input,regex,handlers),[result,zone,specificOffset]=matches?dateTimeFromMatches(matches):[null,null,undefined];if(hasOwnProperty(matches,"a")&&hasOwnProperty(matches,"H")){throw new ConflictingSpecificationError("Can't include meridiem when specifying 24-hour format");}
return{input,tokens,regex,rawMatches,matches,result,zone,specificOffset};}}
function parseFromTokens(locale,input,format){const{result,zone,specificOffset,invalidReason}=explainFromTokens(locale,input,format);return[result,zone,specificOffset,invalidReason];}
function formatOptsToTokens(formatOpts,locale){if(!formatOpts){return null;}
const formatter=Formatter.create(locale,formatOpts);const df=formatter.dtFormatter(getDummyDateTime());const parts=df.formatToParts();const resolvedOpts=df.resolvedOptions();return parts.map((p)=>tokenForPart(p,formatOpts,resolvedOpts));}
const nonLeapLadder=[0,31,59,90,120,151,181,212,243,273,304,334],leapLadder=[0,31,60,91,121,152,182,213,244,274,305,335];function unitOutOfRange(unit,value){return new Invalid("unit out of range",`you specified ${value} (of type ${typeof value}) as a ${unit}, which is invalid`);}
function dayOfWeek(year,month,day){const d=new Date(Date.UTC(year,month-1,day));if(year<100&&year>=0){d.setUTCFullYear(d.getUTCFullYear()-1900);}
const js=d.getUTCDay();return js===0?7:js;}
function computeOrdinal(year,month,day){return day+(isLeapYear(year)?leapLadder:nonLeapLadder)[month-1];}
function uncomputeOrdinal(year,ordinal){const table=isLeapYear(year)?leapLadder:nonLeapLadder,month0=table.findIndex((i)=>i<ordinal),day=ordinal-table[month0];return{month:month0+1,day};}
function gregorianToWeek(gregObj){const{year,month,day}=gregObj,ordinal=computeOrdinal(year,month,day),weekday=dayOfWeek(year,month,day);let weekNumber=Math.floor((ordinal-weekday+10)/7),weekYear;if(weekNumber<1){weekYear=year-1;weekNumber=weeksInWeekYear(weekYear);}else if(weekNumber>weeksInWeekYear(year)){weekYear=year+1;weekNumber=1;}else{weekYear=year;}
return{weekYear,weekNumber,weekday,...timeObject(gregObj)};}
function weekToGregorian(weekData){const{weekYear,weekNumber,weekday}=weekData,weekdayOfJan4=dayOfWeek(weekYear,1,4),yearInDays=daysInYear(weekYear);let ordinal=weekNumber*7+weekday-weekdayOfJan4-3,year;if(ordinal<1){year=weekYear-1;ordinal+=daysInYear(year);}else if(ordinal>yearInDays){year=weekYear+1;ordinal-=daysInYear(weekYear);}else{year=weekYear;}
const{month,day}=uncomputeOrdinal(year,ordinal);return{year,month,day,...timeObject(weekData)};}
function gregorianToOrdinal(gregData){const{year,month,day}=gregData;const ordinal=computeOrdinal(year,month,day);return{year,ordinal,...timeObject(gregData)};}
function ordinalToGregorian(ordinalData){const{year,ordinal}=ordinalData;const{month,day}=uncomputeOrdinal(year,ordinal);return{year,month,day,...timeObject(ordinalData)};}
function hasInvalidWeekData(obj){const validYear=isInteger(obj.weekYear),validWeek=integerBetween(obj.weekNumber,1,weeksInWeekYear(obj.weekYear)),validWeekday=integerBetween(obj.weekday,1,7);if(!validYear){return unitOutOfRange("weekYear",obj.weekYear);}else if(!validWeek){return unitOutOfRange("week",obj.week);}else if(!validWeekday){return unitOutOfRange("weekday",obj.weekday);}else return false;}
function hasInvalidOrdinalData(obj){const validYear=isInteger(obj.year),validOrdinal=integerBetween(obj.ordinal,1,daysInYear(obj.year));if(!validYear){return unitOutOfRange("year",obj.year);}else if(!validOrdinal){return unitOutOfRange("ordinal",obj.ordinal);}else return false;}
function hasInvalidGregorianData(obj){const validYear=isInteger(obj.year),validMonth=integerBetween(obj.month,1,12),validDay=integerBetween(obj.day,1,daysInMonth(obj.year,obj.month));if(!validYear){return unitOutOfRange("year",obj.year);}else if(!validMonth){return unitOutOfRange("month",obj.month);}else if(!validDay){return unitOutOfRange("day",obj.day);}else return false;}
function hasInvalidTimeData(obj){const{hour,minute,second,millisecond}=obj;const validHour=integerBetween(hour,0,23)||(hour===24&&minute===0&&second===0&&millisecond===0),validMinute=integerBetween(minute,0,59),validSecond=integerBetween(second,0,59),validMillisecond=integerBetween(millisecond,0,999);if(!validHour){return unitOutOfRange("hour",hour);}else if(!validMinute){return unitOutOfRange("minute",minute);}else if(!validSecond){return unitOutOfRange("second",second);}else if(!validMillisecond){return unitOutOfRange("millisecond",millisecond);}else return false;}
const INVALID="Invalid DateTime";const MAX_DATE=8.64e15;function unsupportedZone(zone){return new Invalid("unsupported zone",`the zone "${zone.name}" is not supported`);}
function possiblyCachedWeekData(dt){if(dt.weekData===null){dt.weekData=gregorianToWeek(dt.c);}
return dt.weekData;}
function clone(inst,alts){const current={ts:inst.ts,zone:inst.zone,c:inst.c,o:inst.o,loc:inst.loc,invalid:inst.invalid,};return new DateTime({...current,...alts,old:current});}
function fixOffset(localTS,o,tz){let utcGuess=localTS-o*60*1000;const o2=tz.offset(utcGuess);if(o===o2){return[utcGuess,o];}
utcGuess-=(o2-o)*60*1000;const o3=tz.offset(utcGuess);if(o2===o3){return[utcGuess,o2];}
return[localTS-Math.min(o2,o3)*60*1000,Math.max(o2,o3)];}
function tsToObj(ts,offset){ts+=offset*60*1000;const d=new Date(ts);return{year:d.getUTCFullYear(),month:d.getUTCMonth()+1,day:d.getUTCDate(),hour:d.getUTCHours(),minute:d.getUTCMinutes(),second:d.getUTCSeconds(),millisecond:d.getUTCMilliseconds(),};}
function objToTS(obj,offset,zone){return fixOffset(objToLocalTS(obj),offset,zone);}
function adjustTime(inst,dur){const oPre=inst.o,year=inst.c.year+Math.trunc(dur.years),month=inst.c.month+Math.trunc(dur.months)+Math.trunc(dur.quarters)*3,c={...inst.c,year,month,day:Math.min(inst.c.day,daysInMonth(year,month))+
Math.trunc(dur.days)+
Math.trunc(dur.weeks)*7,},millisToAdd=Duration.fromObject({years:dur.years-Math.trunc(dur.years),quarters:dur.quarters-Math.trunc(dur.quarters),months:dur.months-Math.trunc(dur.months),weeks:dur.weeks-Math.trunc(dur.weeks),days:dur.days-Math.trunc(dur.days),hours:dur.hours,minutes:dur.minutes,seconds:dur.seconds,milliseconds:dur.milliseconds,}).as("milliseconds"),localTS=objToLocalTS(c);let[ts,o]=fixOffset(localTS,oPre,inst.zone);if(millisToAdd!==0){ts+=millisToAdd;o=inst.zone.offset(ts);}
return{ts,o};}
function parseDataToDateTime(parsed,parsedZone,opts,format,text,specificOffset){const{setZone,zone}=opts;if((parsed&&Object.keys(parsed).length!==0)||parsedZone){const interpretationZone=parsedZone||zone,inst=DateTime.fromObject(parsed,{...opts,zone:interpretationZone,specificOffset,});return setZone?inst:inst.setZone(zone);}else{return DateTime.invalid(new Invalid("unparsable",`the input "${text}" can't be parsed as ${format}`));}}
function toTechFormat(dt,format,allowZ=true){return dt.isValid?Formatter.create(Locale.create("en-US"),{allowZ,forceSimple:true,}).formatDateTimeFromString(dt,format):null;}
function toISODate(o,extended){const longFormat=o.c.year>9999||o.c.year<0;let c="";if(longFormat&&o.c.year>=0)c+="+";c+=padStart(o.c.year,longFormat?6:4);if(extended){c+="-";c+=padStart(o.c.month);c+="-";c+=padStart(o.c.day);}else{c+=padStart(o.c.month);c+=padStart(o.c.day);}
return c;}
function toISOTime(o,extended,suppressSeconds,suppressMilliseconds,includeOffset,extendedZone){let c=padStart(o.c.hour);if(extended){c+=":";c+=padStart(o.c.minute);if(o.c.millisecond!==0||o.c.second!==0||!suppressSeconds){c+=":";}}else{c+=padStart(o.c.minute);}
if(o.c.millisecond!==0||o.c.second!==0||!suppressSeconds){c+=padStart(o.c.second);if(o.c.millisecond!==0||!suppressMilliseconds){c+=".";c+=padStart(o.c.millisecond,3);}}
if(includeOffset){if(o.isOffsetFixed&&o.offset===0&&!extendedZone){c+="Z";}else if(o.o<0){c+="-";c+=padStart(Math.trunc(-o.o/60));c+=":";c+=padStart(Math.trunc(-o.o%60));}else{c+="+";c+=padStart(Math.trunc(o.o/60));c+=":";c+=padStart(Math.trunc(o.o%60));}}
if(extendedZone){c+="["+o.zone.ianaName+"]";}
return c;}
const defaultUnitValues={month:1,day:1,hour:0,minute:0,second:0,millisecond:0,},defaultWeekUnitValues={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0,},defaultOrdinalUnitValues={ordinal:1,hour:0,minute:0,second:0,millisecond:0,};const orderedUnits=["year","month","day","hour","minute","second","millisecond"],orderedWeekUnits=["weekYear","weekNumber","weekday","hour","minute","second","millisecond",],orderedOrdinalUnits=["year","ordinal","hour","minute","second","millisecond"];function normalizeUnit(unit){const normalized={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal",}[unit.toLowerCase()];if(!normalized)throw new InvalidUnitError(unit);return normalized;}
function quickDT(obj,opts){const zone=normalizeZone(opts.zone,Settings.defaultZone),loc=Locale.fromObject(opts),tsNow=Settings.now();let ts,o;if(!isUndefined(obj.year)){for(const u of orderedUnits){if(isUndefined(obj[u])){obj[u]=defaultUnitValues[u];}}
const invalid=hasInvalidGregorianData(obj)||hasInvalidTimeData(obj);if(invalid){return DateTime.invalid(invalid);}
const offsetProvis=zone.offset(tsNow);[ts,o]=objToTS(obj,offsetProvis,zone);}else{ts=tsNow;}
return new DateTime({ts,zone,loc,o});}
function diffRelative(start,end,opts){const round=isUndefined(opts.round)?true:opts.round,format=(c,unit)=>{c=roundTo(c,round||opts.calendary?0:2,true);const formatter=end.loc.clone(opts).relFormatter(opts);return formatter.format(c,unit);},differ=(unit)=>{if(opts.calendary){if(!end.hasSame(start,unit)){return end.startOf(unit).diff(start.startOf(unit),unit).get(unit);}else return 0;}else{return end.diff(start,unit).get(unit);}};if(opts.unit){return format(differ(opts.unit),opts.unit);}
for(const unit of opts.units){const count=differ(unit);if(Math.abs(count)>=1){return format(count,unit);}}
return format(start>end?-0:0,opts.units[opts.units.length-1]);}
function lastOpts(argList){let opts={},args;if(argList.length>0&&typeof argList[argList.length-1]==="object"){opts=argList[argList.length-1];args=Array.from(argList).slice(0,argList.length-1);}else{args=Array.from(argList);}
return[opts,args];}
class DateTime{constructor(config){const zone=config.zone||Settings.defaultZone;let invalid=config.invalid||(Number.isNaN(config.ts)?new Invalid("invalid input"):null)||(!zone.isValid?unsupportedZone(zone):null);this.ts=isUndefined(config.ts)?Settings.now():config.ts;let c=null,o=null;if(!invalid){const unchanged=config.old&&config.old.ts===this.ts&&config.old.zone.equals(zone);if(unchanged){[c,o]=[config.old.c,config.old.o];}else{const ot=zone.offset(this.ts);c=tsToObj(this.ts,ot);invalid=Number.isNaN(c.year)?new Invalid("invalid input"):null;c=invalid?null:c;o=invalid?null:ot;}}
this._zone=zone;this.loc=config.loc||Locale.create();this.invalid=invalid;this.weekData=null;this.c=c;this.o=o;this.isLuxonDateTime=true;}
static now(){return new DateTime({});}
static local(){const[opts,args]=lastOpts(arguments),[year,month,day,hour,minute,second,millisecond]=args;return quickDT({year,month,day,hour,minute,second,millisecond},opts);}
static utc(){const[opts,args]=lastOpts(arguments),[year,month,day,hour,minute,second,millisecond]=args;opts.zone=FixedOffsetZone.utcInstance;return quickDT({year,month,day,hour,minute,second,millisecond},opts);}
static fromJSDate(date,options={}){const ts=isDate(date)?date.valueOf():NaN;if(Number.isNaN(ts)){return DateTime.invalid("invalid input");}
const zoneToUse=normalizeZone(options.zone,Settings.defaultZone);if(!zoneToUse.isValid){return DateTime.invalid(unsupportedZone(zoneToUse));}
return new DateTime({ts:ts,zone:zoneToUse,loc:Locale.fromObject(options),});}
static fromMillis(milliseconds,options={}){if(!isNumber(milliseconds)){throw new InvalidArgumentError(`fromMillis requires a numerical input, but received a ${typeof milliseconds} with value ${milliseconds}`);}else if(milliseconds<-MAX_DATE||milliseconds>MAX_DATE){return DateTime.invalid("Timestamp out of range");}else{return new DateTime({ts:milliseconds,zone:normalizeZone(options.zone,Settings.defaultZone),loc:Locale.fromObject(options),});}}
static fromSeconds(seconds,options={}){if(!isNumber(seconds)){throw new InvalidArgumentError("fromSeconds requires a numerical input");}else{return new DateTime({ts:seconds*1000,zone:normalizeZone(options.zone,Settings.defaultZone),loc:Locale.fromObject(options),});}}
static fromObject(obj,opts={}){obj=obj||{};const zoneToUse=normalizeZone(opts.zone,Settings.defaultZone);if(!zoneToUse.isValid){return DateTime.invalid(unsupportedZone(zoneToUse));}
const tsNow=Settings.now(),offsetProvis=!isUndefined(opts.specificOffset)?opts.specificOffset:zoneToUse.offset(tsNow),normalized=normalizeObject(obj,normalizeUnit),containsOrdinal=!isUndefined(normalized.ordinal),containsGregorYear=!isUndefined(normalized.year),containsGregorMD=!isUndefined(normalized.month)||!isUndefined(normalized.day),containsGregor=containsGregorYear||containsGregorMD,definiteWeekDef=normalized.weekYear||normalized.weekNumber,loc=Locale.fromObject(opts);if((containsGregor||containsOrdinal)&&definiteWeekDef){throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");}
if(containsGregorMD&&containsOrdinal){throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");}
const useWeekData=definiteWeekDef||(normalized.weekday&&!containsGregor);let units,defaultValues,objNow=tsToObj(tsNow,offsetProvis);if(useWeekData){units=orderedWeekUnits;defaultValues=defaultWeekUnitValues;objNow=gregorianToWeek(objNow);}else if(containsOrdinal){units=orderedOrdinalUnits;defaultValues=defaultOrdinalUnitValues;objNow=gregorianToOrdinal(objNow);}else{units=orderedUnits;defaultValues=defaultUnitValues;}
let foundFirst=false;for(const u of units){const v=normalized[u];if(!isUndefined(v)){foundFirst=true;}else if(foundFirst){normalized[u]=defaultValues[u];}else{normalized[u]=objNow[u];}}
const higherOrderInvalid=useWeekData?hasInvalidWeekData(normalized):containsOrdinal?hasInvalidOrdinalData(normalized):hasInvalidGregorianData(normalized),invalid=higherOrderInvalid||hasInvalidTimeData(normalized);if(invalid){return DateTime.invalid(invalid);}
const gregorian=useWeekData?weekToGregorian(normalized):containsOrdinal?ordinalToGregorian(normalized):normalized,[tsFinal,offsetFinal]=objToTS(gregorian,offsetProvis,zoneToUse),inst=new DateTime({ts:tsFinal,zone:zoneToUse,o:offsetFinal,loc,});if(normalized.weekday&&containsGregor&&obj.weekday!==inst.weekday){return DateTime.invalid("mismatched weekday",`you can't specify both a weekday of ${normalized.weekday} and a date of ${inst.toISO()}`);}
return inst;}
static fromISO(text,opts={}){const[vals,parsedZone]=parseISODate(text);return parseDataToDateTime(vals,parsedZone,opts,"ISO 8601",text);}
static fromRFC2822(text,opts={}){const[vals,parsedZone]=parseRFC2822Date(text);return parseDataToDateTime(vals,parsedZone,opts,"RFC 2822",text);}
static fromHTTP(text,opts={}){const[vals,parsedZone]=parseHTTPDate(text);return parseDataToDateTime(vals,parsedZone,opts,"HTTP",opts);}
static fromFormat(text,fmt,opts={}){if(isUndefined(text)||isUndefined(fmt)){throw new InvalidArgumentError("fromFormat requires an input string and a format");}
const{locale=null,numberingSystem=null}=opts,localeToUse=Locale.fromOpts({locale,numberingSystem,defaultToEN:true,}),[vals,parsedZone,specificOffset,invalid]=parseFromTokens(localeToUse,text,fmt);if(invalid){return DateTime.invalid(invalid);}else{return parseDataToDateTime(vals,parsedZone,opts,`format ${fmt}`,text,specificOffset);}}
static fromString(text,fmt,opts={}){return DateTime.fromFormat(text,fmt,opts);}
static fromSQL(text,opts={}){const[vals,parsedZone]=parseSQL(text);return parseDataToDateTime(vals,parsedZone,opts,"SQL",text);}
static invalid(reason,explanation=null){if(!reason){throw new InvalidArgumentError("need to specify a reason the DateTime is invalid");}
const invalid=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid){throw new InvalidDateTimeError(invalid);}else{return new DateTime({invalid});}}
static isDateTime(o){return(o&&o.isLuxonDateTime)||false;}
static parseFormatForOpts(formatOpts,localeOpts={}){const tokenList=formatOptsToTokens(formatOpts,Locale.fromObject(localeOpts));return!tokenList?null:tokenList.map((t)=>(t?t.val:null)).join("");}
static expandFormat(fmt,localeOpts={}){const expanded=expandMacroTokens(Formatter.parseFormat(fmt),Locale.fromObject(localeOpts));return expanded.map((t)=>t.val).join("");}
get(unit){return this[unit];}
get isValid(){return this.invalid===null;}
get invalidReason(){return this.invalid?this.invalid.reason:null;}
get invalidExplanation(){return this.invalid?this.invalid.explanation:null;}
get locale(){return this.isValid?this.loc.locale:null;}
get numberingSystem(){return this.isValid?this.loc.numberingSystem:null;}
get outputCalendar(){return this.isValid?this.loc.outputCalendar:null;}
get zone(){return this._zone;}
get zoneName(){return this.isValid?this.zone.name:null;}
get year(){return this.isValid?this.c.year:NaN;}
get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN;}
get month(){return this.isValid?this.c.month:NaN;}
get day(){return this.isValid?this.c.day:NaN;}
get hour(){return this.isValid?this.c.hour:NaN;}
get minute(){return this.isValid?this.c.minute:NaN;}
get second(){return this.isValid?this.c.second:NaN;}
get millisecond(){return this.isValid?this.c.millisecond:NaN;}
get weekYear(){return this.isValid?possiblyCachedWeekData(this).weekYear:NaN;}
get weekNumber(){return this.isValid?possiblyCachedWeekData(this).weekNumber:NaN;}
get weekday(){return this.isValid?possiblyCachedWeekData(this).weekday:NaN;}
get ordinal(){return this.isValid?gregorianToOrdinal(this.c).ordinal:NaN;}
get monthShort(){return this.isValid?Info.months("short",{locObj:this.loc})[this.month-1]:null;}
get monthLong(){return this.isValid?Info.months("long",{locObj:this.loc})[this.month-1]:null;}
get weekdayShort(){return this.isValid?Info.weekdays("short",{locObj:this.loc})[this.weekday-1]:null;}
get weekdayLong(){return this.isValid?Info.weekdays("long",{locObj:this.loc})[this.weekday-1]:null;}
get offset(){return this.isValid?+this.o:NaN;}
get offsetNameShort(){if(this.isValid){return this.zone.offsetName(this.ts,{format:"short",locale:this.locale,});}else{return null;}}
get offsetNameLong(){if(this.isValid){return this.zone.offsetName(this.ts,{format:"long",locale:this.locale,});}else{return null;}}
get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null;}
get isInDST(){if(this.isOffsetFixed){return false;}else{return(this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset);}}
getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed){return[this];}
const dayMs=86400000;const minuteMs=60000;const localTS=objToLocalTS(this.c);const oEarlier=this.zone.offset(localTS-dayMs);const oLater=this.zone.offset(localTS+dayMs);const o1=this.zone.offset(localTS-oEarlier*minuteMs);const o2=this.zone.offset(localTS-oLater*minuteMs);if(o1===o2){return[this];}
const ts1=localTS-o1*minuteMs;const ts2=localTS-o2*minuteMs;const c1=tsToObj(ts1,o1);const c2=tsToObj(ts2,o2);if(c1.hour===c2.hour&&c1.minute===c2.minute&&c1.second===c2.second&&c1.millisecond===c2.millisecond){return[clone(this,{ts:ts1}),clone(this,{ts:ts2})];}
return[this];}
get isInLeapYear(){return isLeapYear(this.year);}
get daysInMonth(){return daysInMonth(this.year,this.month);}
get daysInYear(){return this.isValid?daysInYear(this.year):NaN;}
get weeksInWeekYear(){return this.isValid?weeksInWeekYear(this.weekYear):NaN;}
resolvedLocaleOptions(opts={}){const{locale,numberingSystem,calendar}=Formatter.create(this.loc.clone(opts),opts).resolvedOptions(this);return{locale,numberingSystem,outputCalendar:calendar};}
toUTC(offset=0,opts={}){return this.setZone(FixedOffsetZone.instance(offset),opts);}
toLocal(){return this.setZone(Settings.defaultZone);}
setZone(zone,{keepLocalTime=false,keepCalendarTime=false}={}){zone=normalizeZone(zone,Settings.defaultZone);if(zone.equals(this.zone)){return this;}else if(!zone.isValid){return DateTime.invalid(unsupportedZone(zone));}else{let newTS=this.ts;if(keepLocalTime||keepCalendarTime){const offsetGuess=zone.offset(this.ts);const asObj=this.toObject();[newTS]=objToTS(asObj,offsetGuess,zone);}
return clone(this,{ts:newTS,zone});}}
reconfigure({locale,numberingSystem,outputCalendar}={}){const loc=this.loc.clone({locale,numberingSystem,outputCalendar});return clone(this,{loc});}
setLocale(locale){return this.reconfigure({locale});}
set(values){if(!this.isValid)return this;const normalized=normalizeObject(values,normalizeUnit),settingWeekStuff=!isUndefined(normalized.weekYear)||!isUndefined(normalized.weekNumber)||!isUndefined(normalized.weekday),containsOrdinal=!isUndefined(normalized.ordinal),containsGregorYear=!isUndefined(normalized.year),containsGregorMD=!isUndefined(normalized.month)||!isUndefined(normalized.day),containsGregor=containsGregorYear||containsGregorMD,definiteWeekDef=normalized.weekYear||normalized.weekNumber;if((containsGregor||containsOrdinal)&&definiteWeekDef){throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");}
if(containsGregorMD&&containsOrdinal){throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");}
let mixed;if(settingWeekStuff){mixed=weekToGregorian({...gregorianToWeek(this.c),...normalized});}else if(!isUndefined(normalized.ordinal)){mixed=ordinalToGregorian({...gregorianToOrdinal(this.c),...normalized});}else{mixed={...this.toObject(),...normalized};if(isUndefined(normalized.day)){mixed.day=Math.min(daysInMonth(mixed.year,mixed.month),mixed.day);}}
const[ts,o]=objToTS(mixed,this.o,this.zone);return clone(this,{ts,o});}
plus(duration){if(!this.isValid)return this;const dur=Duration.fromDurationLike(duration);return clone(this,adjustTime(this,dur));}
minus(duration){if(!this.isValid)return this;const dur=Duration.fromDurationLike(duration).negate();return clone(this,adjustTime(this,dur));}
startOf(unit){if(!this.isValid)return this;const o={},normalizedUnit=Duration.normalizeUnit(unit);switch(normalizedUnit){case"years":o.month=1;case"quarters":case"months":o.day=1;case"weeks":case"days":o.hour=0;case"hours":o.minute=0;case"minutes":o.second=0;case"seconds":o.millisecond=0;break;}
if(normalizedUnit==="weeks"){o.weekday=1;}
if(normalizedUnit==="quarters"){const q=Math.ceil(this.month/3);o.month=(q-1)*3+1;}
return this.set(o);}
endOf(unit){return this.isValid?this.plus({[unit]:1}).startOf(unit).minus(1):this;}
toFormat(fmt,opts={}){return this.isValid?Formatter.create(this.loc.redefaultToEN(opts)).formatDateTimeFromString(this,fmt):INVALID;}
toLocaleString(formatOpts=DATE_SHORT,opts={}){return this.isValid?Formatter.create(this.loc.clone(opts),formatOpts).formatDateTime(this):INVALID;}
toLocaleParts(opts={}){return this.isValid?Formatter.create(this.loc.clone(opts),opts).formatDateTimeParts(this):[];}
toISO({format="extended",suppressSeconds=false,suppressMilliseconds=false,includeOffset=true,extendedZone=false,}={}){if(!this.isValid){return null;}
const ext=format==="extended";let c=toISODate(this,ext);c+="T";c+=toISOTime(this,ext,suppressSeconds,suppressMilliseconds,includeOffset,extendedZone);return c;}
toISODate({format="extended"}={}){if(!this.isValid){return null;}
return toISODate(this,format==="extended");}
toISOWeekDate(){return toTechFormat(this,"kkkk-'W'WW-c");}
toISOTime({suppressMilliseconds=false,suppressSeconds=false,includeOffset=true,includePrefix=false,extendedZone=false,format="extended",}={}){if(!this.isValid){return null;}
let c=includePrefix?"T":"";return(c+
toISOTime(this,format==="extended",suppressSeconds,suppressMilliseconds,includeOffset,extendedZone));}
toRFC2822(){return toTechFormat(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",false);}
toHTTP(){return toTechFormat(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'");}
toSQLDate(){if(!this.isValid){return null;}
return toISODate(this,true);}
toSQLTime({includeOffset=true,includeZone=false,includeOffsetSpace=true}={}){let fmt="HH:mm:ss.SSS";if(includeZone||includeOffset){if(includeOffsetSpace){fmt+=" ";}
if(includeZone){fmt+="z";}else if(includeOffset){fmt+="ZZ";}}
return toTechFormat(this,fmt,true);}
toSQL(opts={}){if(!this.isValid){return null;}
return`${this.toSQLDate()} ${this.toSQLTime(opts)}`;}
toString(){return this.isValid?this.toISO():INVALID;}
valueOf(){return this.toMillis();}
toMillis(){return this.isValid?this.ts:NaN;}
toSeconds(){return this.isValid?this.ts/1000:NaN;}
toUnixInteger(){return this.isValid?Math.floor(this.ts/1000):NaN;}
toJSON(){return this.toISO();}
toBSON(){return this.toJSDate();}
toObject(opts={}){if(!this.isValid)return{};const base={...this.c};if(opts.includeConfig){base.outputCalendar=this.outputCalendar;base.numberingSystem=this.loc.numberingSystem;base.locale=this.loc.locale;}
return base;}
toJSDate(){return new Date(this.isValid?this.ts:NaN);}
diff(otherDateTime,unit="milliseconds",opts={}){if(!this.isValid||!otherDateTime.isValid){return Duration.invalid("created by diffing an invalid DateTime");}
const durOpts={locale:this.locale,numberingSystem:this.numberingSystem,...opts};const units=maybeArray(unit).map(Duration.normalizeUnit),otherIsLater=otherDateTime.valueOf()>this.valueOf(),earlier=otherIsLater?this:otherDateTime,later=otherIsLater?otherDateTime:this,diffed=diff(earlier,later,units,durOpts);return otherIsLater?diffed.negate():diffed;}
diffNow(unit="milliseconds",opts={}){return this.diff(DateTime.now(),unit,opts);}
until(otherDateTime){return this.isValid?Interval.fromDateTimes(this,otherDateTime):this;}
hasSame(otherDateTime,unit){if(!this.isValid)return false;const inputMs=otherDateTime.valueOf();const adjustedToZone=this.setZone(otherDateTime.zone,{keepLocalTime:true});return adjustedToZone.startOf(unit)<=inputMs&&inputMs<=adjustedToZone.endOf(unit);}
equals(other){return(this.isValid&&other.isValid&&this.valueOf()===other.valueOf()&&this.zone.equals(other.zone)&&this.loc.equals(other.loc));}
toRelative(options={}){if(!this.isValid)return null;const base=options.base||DateTime.fromObject({},{zone:this.zone}),padding=options.padding?(this<base?-options.padding:options.padding):0;let units=["years","months","days","hours","minutes","seconds"];let unit=options.unit;if(Array.isArray(options.unit)){units=options.unit;unit=undefined;}
return diffRelative(base,this.plus(padding),{...options,numeric:"always",units,unit,});}
toRelativeCalendar(options={}){if(!this.isValid)return null;return diffRelative(options.base||DateTime.fromObject({},{zone:this.zone}),this,{...options,numeric:"auto",units:["years","months","days"],calendary:true,});}
static min(...dateTimes){if(!dateTimes.every(DateTime.isDateTime)){throw new InvalidArgumentError("min requires all arguments be DateTimes");}
return bestBy(dateTimes,(i)=>i.valueOf(),Math.min);}
static max(...dateTimes){if(!dateTimes.every(DateTime.isDateTime)){throw new InvalidArgumentError("max requires all arguments be DateTimes");}
return bestBy(dateTimes,(i)=>i.valueOf(),Math.max);}
static fromFormatExplain(text,fmt,options={}){const{locale=null,numberingSystem=null}=options,localeToUse=Locale.fromOpts({locale,numberingSystem,defaultToEN:true,});return explainFromTokens(localeToUse,text,fmt);}
static fromStringExplain(text,fmt,options={}){return DateTime.fromFormatExplain(text,fmt,options);}
static get DATE_SHORT(){return DATE_SHORT;}
static get DATE_MED(){return DATE_MED;}
static get DATE_MED_WITH_WEEKDAY(){return DATE_MED_WITH_WEEKDAY;}
static get DATE_FULL(){return DATE_FULL;}
static get DATE_HUGE(){return DATE_HUGE;}
static get TIME_SIMPLE(){return TIME_SIMPLE;}
static get TIME_WITH_SECONDS(){return TIME_WITH_SECONDS;}
static get TIME_WITH_SHORT_OFFSET(){return TIME_WITH_SHORT_OFFSET;}
static get TIME_WITH_LONG_OFFSET(){return TIME_WITH_LONG_OFFSET;}
static get TIME_24_SIMPLE(){return TIME_24_SIMPLE;}
static get TIME_24_WITH_SECONDS(){return TIME_24_WITH_SECONDS;}
static get TIME_24_WITH_SHORT_OFFSET(){return TIME_24_WITH_SHORT_OFFSET;}
static get TIME_24_WITH_LONG_OFFSET(){return TIME_24_WITH_LONG_OFFSET;}
static get DATETIME_SHORT(){return DATETIME_SHORT;}
static get DATETIME_SHORT_WITH_SECONDS(){return DATETIME_SHORT_WITH_SECONDS;}
static get DATETIME_MED(){return DATETIME_MED;}
static get DATETIME_MED_WITH_SECONDS(){return DATETIME_MED_WITH_SECONDS;}
static get DATETIME_MED_WITH_WEEKDAY(){return DATETIME_MED_WITH_WEEKDAY;}
static get DATETIME_FULL(){return DATETIME_FULL;}
static get DATETIME_FULL_WITH_SECONDS(){return DATETIME_FULL_WITH_SECONDS;}
static get DATETIME_HUGE(){return DATETIME_HUGE;}
static get DATETIME_HUGE_WITH_SECONDS(){return DATETIME_HUGE_WITH_SECONDS;}}
function friendlyDateTime(dateTimeish){if(DateTime.isDateTime(dateTimeish)){return dateTimeish;}else if(dateTimeish&&dateTimeish.valueOf&&isNumber(dateTimeish.valueOf())){return DateTime.fromJSDate(dateTimeish);}else if(dateTimeish&&typeof dateTimeish==="object"){return DateTime.fromObject(dateTimeish);}else{throw new InvalidArgumentError(`Unknown datetime argument: ${dateTimeish}, of type ${typeof dateTimeish}`);}}
const VERSION="3.4.2";exports.DateTime=DateTime;exports.Duration=Duration;exports.FixedOffsetZone=FixedOffsetZone;exports.IANAZone=IANAZone;exports.Info=Info;exports.Interval=Interval;exports.InvalidZone=InvalidZone;exports.Settings=Settings;exports.SystemZone=SystemZone;exports.VERSION=VERSION;exports.Zone=Zone;Object.defineProperty(exports,'__esModule',{value:true});return exports;})({});luxon.DateTime.prototype[Symbol.toStringTag]="LuxonDateTime";luxon.Duration.prototype[Symbol.toStringTag]="LuxonDuration";luxon.Interval.prototype[Symbol.toStringTag]="LuxonInterval";luxon.Settings.prototype[Symbol.toStringTag]="LuxonSettings";luxon.Info.prototype[Symbol.toStringTag]="LuxonInfo";luxon.Zone.prototype[Symbol.toStringTag]="LuxonZone";;

/* /web/static/lib/owl/owl.js */
(function(exports){'use strict';function filterOutModifiersFromData(dataList){dataList=dataList.slice();const modifiers=[];let elm;while((elm=dataList[0])&&typeof elm==="string"){modifiers.push(dataList.shift());}
return{modifiers,data:dataList};}
const config={shouldNormalizeDom:true,mainEventHandler:(data,ev,currentTarget)=>{if(typeof data==="function"){data(ev);}
else if(Array.isArray(data)){data=filterOutModifiersFromData(data).data;data[0](data[1],ev);}
return false;},};class VToggler{constructor(key,child){this.key=key;this.child=child;}
mount(parent,afterNode){this.parentEl=parent;this.child.mount(parent,afterNode);}
moveBeforeDOMNode(node,parent){this.child.moveBeforeDOMNode(node,parent);}
moveBeforeVNode(other,afterNode){this.moveBeforeDOMNode((other&&other.firstNode())||afterNode);}
patch(other,withBeforeRemove){if(this===other){return;}
let child1=this.child;let child2=other.child;if(this.key===other.key){child1.patch(child2,withBeforeRemove);}
else{child2.mount(this.parentEl,child1.firstNode());if(withBeforeRemove){child1.beforeRemove();}
child1.remove();this.child=child2;this.key=other.key;}}
beforeRemove(){this.child.beforeRemove();}
remove(){this.child.remove();}
firstNode(){return this.child.firstNode();}
toString(){return this.child.toString();}}
function toggler(key,child){return new VToggler(key,child);}
class OwlError extends Error{}
const{setAttribute:elemSetAttribute,removeAttribute}=Element.prototype;const tokenList=DOMTokenList.prototype;const tokenListAdd=tokenList.add;const tokenListRemove=tokenList.remove;const isArray=Array.isArray;const{split,trim}=String.prototype;const wordRegexp=/\s+/;function setAttribute(key,value){switch(value){case false:case undefined:removeAttribute.call(this,key);break;case true:elemSetAttribute.call(this,key,"");break;default:elemSetAttribute.call(this,key,value);}}
function createAttrUpdater(attr){return function(value){setAttribute.call(this,attr,value);};}
function attrsSetter(attrs){if(isArray(attrs)){if(attrs[0]==="class"){setClass.call(this,attrs[1]);}
else{setAttribute.call(this,attrs[0],attrs[1]);}}
else{for(let k in attrs){if(k==="class"){setClass.call(this,attrs[k]);}
else{setAttribute.call(this,k,attrs[k]);}}}}
function attrsUpdater(attrs,oldAttrs){if(isArray(attrs)){const name=attrs[0];const val=attrs[1];if(name===oldAttrs[0]){if(val===oldAttrs[1]){return;}
if(name==="class"){updateClass.call(this,val,oldAttrs[1]);}
else{setAttribute.call(this,name,val);}}
else{removeAttribute.call(this,oldAttrs[0]);setAttribute.call(this,name,val);}}
else{for(let k in oldAttrs){if(!(k in attrs)){if(k==="class"){updateClass.call(this,"",oldAttrs[k]);}
else{removeAttribute.call(this,k);}}}
for(let k in attrs){const val=attrs[k];if(val!==oldAttrs[k]){if(k==="class"){updateClass.call(this,val,oldAttrs[k]);}
else{setAttribute.call(this,k,val);}}}}}
function toClassObj(expr){const result={};switch(typeof expr){case"string":const str=trim.call(expr);if(!str){return{};}
let words=split.call(str,wordRegexp);for(let i=0,l=words.length;i<l;i++){result[words[i]]=true;}
return result;case"object":for(let key in expr){const value=expr[key];if(value){key=trim.call(key);if(!key){continue;}
const words=split.call(key,wordRegexp);for(let word of words){result[word]=value;}}}
return result;case"undefined":return{};case"number":return{[expr]:true};default:return{[expr]:true};}}
function setClass(val){val=val===""?{}:toClassObj(val);const cl=this.classList;for(let c in val){tokenListAdd.call(cl,c);}}
function updateClass(val,oldVal){oldVal=oldVal===""?{}:toClassObj(oldVal);val=val===""?{}:toClassObj(val);const cl=this.classList;for(let c in oldVal){if(!(c in val)){tokenListRemove.call(cl,c);}}
for(let c in val){if(!(c in oldVal)){tokenListAdd.call(cl,c);}}}
function batched(callback){let scheduled=false;return async(...args)=>{if(!scheduled){scheduled=true;await Promise.resolve();scheduled=false;callback(...args);}};}
function inOwnerDocument(el){if(!el){return false;}
if(el.ownerDocument.contains(el)){return true;}
const rootNode=el.getRootNode();return rootNode instanceof ShadowRoot&&el.ownerDocument.contains(rootNode.host);}
function validateTarget(target){const document=target&&target.ownerDocument;if(document){const HTMLElement=document.defaultView.HTMLElement;if(target instanceof HTMLElement||target instanceof ShadowRoot){if(!document.body.contains(target instanceof HTMLElement?target:target.host)){throw new OwlError("Cannot mount a component on a detached dom node");}
return;}}
throw new OwlError("Cannot mount component: the target is not a valid DOM element");}
class EventBus extends EventTarget{trigger(name,payload){this.dispatchEvent(new CustomEvent(name,{detail:payload}));}}
function whenReady(fn){return new Promise(function(resolve){if(document.readyState!=="loading"){resolve(true);}
else{document.addEventListener("DOMContentLoaded",resolve,false);}}).then(fn||function(){});}
async function loadFile(url){const result=await fetch(url);if(!result.ok){throw new OwlError("Error while fetching xml templates");}
return await result.text();}
class Markup extends String{}
function markup(value){return new Markup(value);}
function createEventHandler(rawEvent){const eventName=rawEvent.split(".")[0];const capture=rawEvent.includes(".capture");if(rawEvent.includes(".synthetic")){return createSyntheticHandler(eventName,capture);}
else{return createElementHandler(eventName,capture);}}
let nextNativeEventId=1;function createElementHandler(evName,capture=false){let eventKey=`__event__${evName}_${nextNativeEventId++}`;if(capture){eventKey=`${eventKey}_capture`;}
function listener(ev){const currentTarget=ev.currentTarget;if(!currentTarget||!inOwnerDocument(currentTarget))
return;const data=currentTarget[eventKey];if(!data)
return;config.mainEventHandler(data,ev,currentTarget);}
function setup(data){this[eventKey]=data;this.addEventListener(evName,listener,{capture});}
function remove(){delete this[eventKey];this.removeEventListener(evName,listener,{capture});}
function update(data){this[eventKey]=data;}
return{setup,update,remove};}
let nextSyntheticEventId=1;function createSyntheticHandler(evName,capture=false){let eventKey=`__event__synthetic_${evName}`;if(capture){eventKey=`${eventKey}_capture`;}
setupSyntheticEvent(evName,eventKey,capture);const currentId=nextSyntheticEventId++;function setup(data){const _data=this[eventKey]||{};_data[currentId]=data;this[eventKey]=_data;}
function remove(){delete this[eventKey];}
return{setup,update:setup,remove};}
function nativeToSyntheticEvent(eventKey,event){let dom=event.target;while(dom!==null){const _data=dom[eventKey];if(_data){for(const data of Object.values(_data)){const stopped=config.mainEventHandler(data,event,dom);if(stopped)
return;}}
dom=dom.parentNode;}}
const CONFIGURED_SYNTHETIC_EVENTS={};function setupSyntheticEvent(evName,eventKey,capture=false){if(CONFIGURED_SYNTHETIC_EVENTS[eventKey]){return;}
document.addEventListener(evName,(event)=>nativeToSyntheticEvent(eventKey,event),{capture,});CONFIGURED_SYNTHETIC_EVENTS[eventKey]=true;}
const getDescriptor$3=(o,p)=>Object.getOwnPropertyDescriptor(o,p);const nodeProto$4=Node.prototype;const nodeInsertBefore$3=nodeProto$4.insertBefore;const nodeSetTextContent$1=getDescriptor$3(nodeProto$4,"textContent").set;const nodeRemoveChild$3=nodeProto$4.removeChild;class VMulti{constructor(children){this.children=children;}
mount(parent,afterNode){const children=this.children;const l=children.length;const anchors=new Array(l);for(let i=0;i<l;i++){let child=children[i];if(child){child.mount(parent,afterNode);}
else{const childAnchor=document.createTextNode("");anchors[i]=childAnchor;nodeInsertBefore$3.call(parent,childAnchor,afterNode);}}
this.anchors=anchors;this.parentEl=parent;}
moveBeforeDOMNode(node,parent=this.parentEl){this.parentEl=parent;const children=this.children;const anchors=this.anchors;for(let i=0,l=children.length;i<l;i++){let child=children[i];if(child){child.moveBeforeDOMNode(node,parent);}
else{const anchor=anchors[i];nodeInsertBefore$3.call(parent,anchor,node);}}}
moveBeforeVNode(other,afterNode){if(other){const next=other.children[0];afterNode=(next?next.firstNode():other.anchors[0])||null;}
const children=this.children;const parent=this.parentEl;const anchors=this.anchors;for(let i=0,l=children.length;i<l;i++){let child=children[i];if(child){child.moveBeforeVNode(null,afterNode);}
else{const anchor=anchors[i];nodeInsertBefore$3.call(parent,anchor,afterNode);}}}
patch(other,withBeforeRemove){if(this===other){return;}
const children1=this.children;const children2=other.children;const anchors=this.anchors;const parentEl=this.parentEl;for(let i=0,l=children1.length;i<l;i++){const vn1=children1[i];const vn2=children2[i];if(vn1){if(vn2){vn1.patch(vn2,withBeforeRemove);}
else{const afterNode=vn1.firstNode();const anchor=document.createTextNode("");anchors[i]=anchor;nodeInsertBefore$3.call(parentEl,anchor,afterNode);if(withBeforeRemove){vn1.beforeRemove();}
vn1.remove();children1[i]=undefined;}}
else if(vn2){children1[i]=vn2;const anchor=anchors[i];vn2.mount(parentEl,anchor);nodeRemoveChild$3.call(parentEl,anchor);}}}
beforeRemove(){const children=this.children;for(let i=0,l=children.length;i<l;i++){const child=children[i];if(child){child.beforeRemove();}}}
remove(){const parentEl=this.parentEl;if(this.isOnlyChild){nodeSetTextContent$1.call(parentEl,"");}
else{const children=this.children;const anchors=this.anchors;for(let i=0,l=children.length;i<l;i++){const child=children[i];if(child){child.remove();}
else{nodeRemoveChild$3.call(parentEl,anchors[i]);}}}}
firstNode(){const child=this.children[0];return child?child.firstNode():this.anchors[0];}
toString(){return this.children.map((c)=>(c?c.toString():"")).join("");}}
function multi(children){return new VMulti(children);}
const getDescriptor$2=(o,p)=>Object.getOwnPropertyDescriptor(o,p);const nodeProto$3=Node.prototype;const characterDataProto$1=CharacterData.prototype;const nodeInsertBefore$2=nodeProto$3.insertBefore;const characterDataSetData$1=getDescriptor$2(characterDataProto$1,"data").set;const nodeRemoveChild$2=nodeProto$3.removeChild;class VSimpleNode{constructor(text){this.text=text;}
mountNode(node,parent,afterNode){this.parentEl=parent;nodeInsertBefore$2.call(parent,node,afterNode);this.el=node;}
moveBeforeDOMNode(node,parent=this.parentEl){this.parentEl=parent;nodeInsertBefore$2.call(parent,this.el,node);}
moveBeforeVNode(other,afterNode){nodeInsertBefore$2.call(this.parentEl,this.el,other?other.el:afterNode);}
beforeRemove(){}
remove(){nodeRemoveChild$2.call(this.parentEl,this.el);}
firstNode(){return this.el;}
toString(){return this.text;}}
class VText$1 extends VSimpleNode{mount(parent,afterNode){this.mountNode(document.createTextNode(toText(this.text)),parent,afterNode);}
patch(other){const text2=other.text;if(this.text!==text2){characterDataSetData$1.call(this.el,toText(text2));this.text=text2;}}}
class VComment extends VSimpleNode{mount(parent,afterNode){this.mountNode(document.createComment(toText(this.text)),parent,afterNode);}
patch(){}}
function text(str){return new VText$1(str);}
function comment(str){return new VComment(str);}
function toText(value){switch(typeof value){case"string":return value;case"number":return String(value);case"boolean":return value?"true":"false";default:return value||"";}}
const getDescriptor$1=(o,p)=>Object.getOwnPropertyDescriptor(o,p);const nodeProto$2=Node.prototype;const elementProto=Element.prototype;const characterDataProto=CharacterData.prototype;const characterDataSetData=getDescriptor$1(characterDataProto,"data").set;const nodeGetFirstChild=getDescriptor$1(nodeProto$2,"firstChild").get;const nodeGetNextSibling=getDescriptor$1(nodeProto$2,"nextSibling").get;const NO_OP=()=>{};function makePropSetter(name){return function setProp(value){this[name]=value===0?0:value?value.valueOf():"";};}
const cache$1={};function createBlock(str){if(str in cache$1){return cache$1[str];}
const doc=new DOMParser().parseFromString(`<t>${str}</t>`,"text/xml");const node=doc.firstChild.firstChild;if(config.shouldNormalizeDom){normalizeNode(node);}
const tree=buildTree(node);const context=buildContext(tree);const template=tree.el;const Block=buildBlock(template,context);cache$1[str]=Block;return Block;}
function normalizeNode(node){if(node.nodeType===Node.TEXT_NODE){if(!/\S/.test(node.textContent)){node.remove();return;}}
if(node.nodeType===Node.ELEMENT_NODE){if(node.tagName==="pre"){return;}}
for(let i=node.childNodes.length-1;i>=0;--i){normalizeNode(node.childNodes.item(i));}}
function buildTree(node,parent=null,domParentTree=null){switch(node.nodeType){case Node.ELEMENT_NODE:{let currentNS=domParentTree&&domParentTree.currentNS;const tagName=node.tagName;let el=undefined;const info=[];if(tagName.startsWith("block-text-")){const index=parseInt(tagName.slice(11),10);info.push({type:"text",idx:index});el=document.createTextNode("");}
if(tagName.startsWith("block-child-")){if(!domParentTree.isRef){addRef(domParentTree);}
const index=parseInt(tagName.slice(12),10);info.push({type:"child",idx:index});el=document.createTextNode("");}
currentNS||(currentNS=node.namespaceURI);if(!el){el=currentNS?document.createElementNS(currentNS,tagName):document.createElement(tagName);}
if(el instanceof Element){if(!domParentTree){const fragment=document.createElement("template").content;fragment.appendChild(el);}
const attrs=node.attributes;for(let i=0;i<attrs.length;i++){const attrName=attrs[i].name;const attrValue=attrs[i].value;if(attrName.startsWith("block-handler-")){const idx=parseInt(attrName.slice(14),10);info.push({type:"handler",idx,event:attrValue,});}
else if(attrName.startsWith("block-attribute-")){const idx=parseInt(attrName.slice(16),10);info.push({type:"attribute",idx,name:attrValue,tag:tagName,});}
else if(attrName.startsWith("block-property-")){const idx=parseInt(attrName.slice(15),10);info.push({type:"property",idx,name:attrValue,tag:tagName,});}
else if(attrName==="block-attributes"){info.push({type:"attributes",idx:parseInt(attrValue,10),});}
else if(attrName==="block-ref"){info.push({type:"ref",idx:parseInt(attrValue,10),});}
else{el.setAttribute(attrs[i].name,attrValue);}}}
const tree={parent,firstChild:null,nextSibling:null,el,info,refN:0,currentNS,};if(node.firstChild){const childNode=node.childNodes[0];if(node.childNodes.length===1&&childNode.nodeType===Node.ELEMENT_NODE&&childNode.tagName.startsWith("block-child-")){const tagName=childNode.tagName;const index=parseInt(tagName.slice(12),10);info.push({idx:index,type:"child",isOnlyChild:true});}
else{tree.firstChild=buildTree(node.firstChild,tree,tree);el.appendChild(tree.firstChild.el);let curNode=node.firstChild;let curTree=tree.firstChild;while((curNode=curNode.nextSibling)){curTree.nextSibling=buildTree(curNode,curTree,tree);el.appendChild(curTree.nextSibling.el);curTree=curTree.nextSibling;}}}
if(tree.info.length){addRef(tree);}
return tree;}
case Node.TEXT_NODE:case Node.COMMENT_NODE:{const el=node.nodeType===Node.TEXT_NODE?document.createTextNode(node.textContent):document.createComment(node.textContent);return{parent:parent,firstChild:null,nextSibling:null,el,info:[],refN:0,currentNS:null,};}}
throw new OwlError("boom");}
function addRef(tree){tree.isRef=true;do{tree.refN++;}while((tree=tree.parent));}
function parentTree(tree){let parent=tree.parent;while(parent&&parent.nextSibling===tree){tree=parent;parent=parent.parent;}
return parent;}
function buildContext(tree,ctx,fromIdx){if(!ctx){const children=new Array(tree.info.filter((v)=>v.type==="child").length);ctx={collectors:[],locations:[],children,cbRefs:[],refN:tree.refN,refList:[]};fromIdx=0;}
if(tree.refN){const initialIdx=fromIdx;const isRef=tree.isRef;const firstChild=tree.firstChild?tree.firstChild.refN:0;const nextSibling=tree.nextSibling?tree.nextSibling.refN:0;if(isRef){for(let info of tree.info){info.refIdx=initialIdx;}
tree.refIdx=initialIdx;updateCtx(ctx,tree);fromIdx++;}
if(nextSibling){const idx=fromIdx+firstChild;ctx.collectors.push({idx,prevIdx:initialIdx,getVal:nodeGetNextSibling});buildContext(tree.nextSibling,ctx,idx);}
if(firstChild){ctx.collectors.push({idx:fromIdx,prevIdx:initialIdx,getVal:nodeGetFirstChild});buildContext(tree.firstChild,ctx,fromIdx);}}
return ctx;}
function updateCtx(ctx,tree){for(let info of tree.info){switch(info.type){case"text":ctx.locations.push({idx:info.idx,refIdx:info.refIdx,setData:setText,updateData:setText,});break;case"child":if(info.isOnlyChild){ctx.children[info.idx]={parentRefIdx:info.refIdx,isOnlyChild:true,};}
else{ctx.children[info.idx]={parentRefIdx:parentTree(tree).refIdx,afterRefIdx:info.refIdx,};}
break;case"property":{const refIdx=info.refIdx;const setProp=makePropSetter(info.name);ctx.locations.push({idx:info.idx,refIdx,setData:setProp,updateData:setProp,});break;}
case"attribute":{const refIdx=info.refIdx;let updater;let setter;if(info.name==="class"){setter=setClass;updater=updateClass;}
else{setter=createAttrUpdater(info.name);updater=setter;}
ctx.locations.push({idx:info.idx,refIdx,setData:setter,updateData:updater,});break;}
case"attributes":ctx.locations.push({idx:info.idx,refIdx:info.refIdx,setData:attrsSetter,updateData:attrsUpdater,});break;case"handler":{const{setup,update}=createEventHandler(info.event);ctx.locations.push({idx:info.idx,refIdx:info.refIdx,setData:setup,updateData:update,});break;}
case"ref":const index=ctx.cbRefs.push(info.idx)-1;ctx.locations.push({idx:info.idx,refIdx:info.refIdx,setData:makeRefSetter(index,ctx.refList),updateData:NO_OP,});}}}
function buildBlock(template,ctx){let B=createBlockClass(template,ctx);if(ctx.cbRefs.length){const cbRefs=ctx.cbRefs;const refList=ctx.refList;let cbRefsNumber=cbRefs.length;B=class extends B{mount(parent,afterNode){refList.push(new Array(cbRefsNumber));super.mount(parent,afterNode);for(let cbRef of refList.pop()){cbRef();}}
remove(){super.remove();for(let cbRef of cbRefs){let fn=this.data[cbRef];fn(null);}}};}
if(ctx.children.length){B=class extends B{constructor(data,children){super(data);this.children=children;}};B.prototype.beforeRemove=VMulti.prototype.beforeRemove;return(data,children=[])=>new B(data,children);}
return(data)=>new B(data);}
function createBlockClass(template,ctx){const{refN,collectors,children}=ctx;const colN=collectors.length;ctx.locations.sort((a,b)=>a.idx-b.idx);const locations=ctx.locations.map((loc)=>({refIdx:loc.refIdx,setData:loc.setData,updateData:loc.updateData,}));const locN=locations.length;const childN=children.length;const childrenLocs=children;const isDynamic=refN>0;const nodeCloneNode=nodeProto$2.cloneNode;const nodeInsertBefore=nodeProto$2.insertBefore;const elementRemove=elementProto.remove;class Block{constructor(data){this.data=data;}
beforeRemove(){}
remove(){elementRemove.call(this.el);}
firstNode(){return this.el;}
moveBeforeDOMNode(node,parent=this.parentEl){this.parentEl=parent;nodeInsertBefore.call(parent,this.el,node);}
moveBeforeVNode(other,afterNode){nodeInsertBefore.call(this.parentEl,this.el,other?other.el:afterNode);}
toString(){const div=document.createElement("div");this.mount(div,null);return div.innerHTML;}
mount(parent,afterNode){const el=nodeCloneNode.call(template,true);nodeInsertBefore.call(parent,el,afterNode);this.el=el;this.parentEl=parent;}
patch(other,withBeforeRemove){}}
if(isDynamic){Block.prototype.mount=function mount(parent,afterNode){const el=nodeCloneNode.call(template,true);const refs=new Array(refN);this.refs=refs;refs[0]=el;for(let i=0;i<colN;i++){const w=collectors[i];refs[w.idx]=w.getVal.call(refs[w.prevIdx]);}
if(locN){const data=this.data;for(let i=0;i<locN;i++){const loc=locations[i];loc.setData.call(refs[loc.refIdx],data[i]);}}
nodeInsertBefore.call(parent,el,afterNode);if(childN){const children=this.children;for(let i=0;i<childN;i++){const child=children[i];if(child){const loc=childrenLocs[i];const afterNode=loc.afterRefIdx?refs[loc.afterRefIdx]:null;child.isOnlyChild=loc.isOnlyChild;child.mount(refs[loc.parentRefIdx],afterNode);}}}
this.el=el;this.parentEl=parent;};Block.prototype.patch=function patch(other,withBeforeRemove){if(this===other){return;}
const refs=this.refs;if(locN){const data1=this.data;const data2=other.data;for(let i=0;i<locN;i++){const val1=data1[i];const val2=data2[i];if(val1!==val2){const loc=locations[i];loc.updateData.call(refs[loc.refIdx],val2,val1);}}
this.data=data2;}
if(childN){let children1=this.children;const children2=other.children;for(let i=0;i<childN;i++){const child1=children1[i];const child2=children2[i];if(child1){if(child2){child1.patch(child2,withBeforeRemove);}
else{if(withBeforeRemove){child1.beforeRemove();}
child1.remove();children1[i]=undefined;}}
else if(child2){const loc=childrenLocs[i];const afterNode=loc.afterRefIdx?refs[loc.afterRefIdx]:null;child2.mount(refs[loc.parentRefIdx],afterNode);children1[i]=child2;}}}};}
return Block;}
function setText(value){characterDataSetData.call(this,toText(value));}
function makeRefSetter(index,refs){return function setRef(fn){refs[refs.length-1][index]=()=>fn(this);};}
const getDescriptor=(o,p)=>Object.getOwnPropertyDescriptor(o,p);const nodeProto$1=Node.prototype;const nodeInsertBefore$1=nodeProto$1.insertBefore;const nodeAppendChild=nodeProto$1.appendChild;const nodeRemoveChild$1=nodeProto$1.removeChild;const nodeSetTextContent=getDescriptor(nodeProto$1,"textContent").set;class VList{constructor(children){this.children=children;}
mount(parent,afterNode){const children=this.children;const _anchor=document.createTextNode("");this.anchor=_anchor;nodeInsertBefore$1.call(parent,_anchor,afterNode);const l=children.length;if(l){const mount=children[0].mount;for(let i=0;i<l;i++){mount.call(children[i],parent,_anchor);}}
this.parentEl=parent;}
moveBeforeDOMNode(node,parent=this.parentEl){this.parentEl=parent;const children=this.children;for(let i=0,l=children.length;i<l;i++){children[i].moveBeforeDOMNode(node,parent);}
parent.insertBefore(this.anchor,node);}
moveBeforeVNode(other,afterNode){if(other){const next=other.children[0];afterNode=(next?next.firstNode():other.anchor)||null;}
const children=this.children;for(let i=0,l=children.length;i<l;i++){children[i].moveBeforeVNode(null,afterNode);}
this.parentEl.insertBefore(this.anchor,afterNode);}
patch(other,withBeforeRemove){if(this===other){return;}
const ch1=this.children;const ch2=other.children;if(ch2.length===0&&ch1.length===0){return;}
this.children=ch2;const proto=ch2[0]||ch1[0];const{mount:cMount,patch:cPatch,remove:cRemove,beforeRemove,moveBeforeVNode:cMoveBefore,firstNode:cFirstNode,}=proto;const _anchor=this.anchor;const isOnlyChild=this.isOnlyChild;const parent=this.parentEl;if(ch2.length===0&&isOnlyChild){if(withBeforeRemove){for(let i=0,l=ch1.length;i<l;i++){beforeRemove.call(ch1[i]);}}
nodeSetTextContent.call(parent,"");nodeAppendChild.call(parent,_anchor);return;}
let startIdx1=0;let startIdx2=0;let startVn1=ch1[0];let startVn2=ch2[0];let endIdx1=ch1.length-1;let endIdx2=ch2.length-1;let endVn1=ch1[endIdx1];let endVn2=ch2[endIdx2];let mapping=undefined;while(startIdx1<=endIdx1&&startIdx2<=endIdx2){if(startVn1===null){startVn1=ch1[++startIdx1];continue;}
if(endVn1===null){endVn1=ch1[--endIdx1];continue;}
let startKey1=startVn1.key;let startKey2=startVn2.key;if(startKey1===startKey2){cPatch.call(startVn1,startVn2,withBeforeRemove);ch2[startIdx2]=startVn1;startVn1=ch1[++startIdx1];startVn2=ch2[++startIdx2];continue;}
let endKey1=endVn1.key;let endKey2=endVn2.key;if(endKey1===endKey2){cPatch.call(endVn1,endVn2,withBeforeRemove);ch2[endIdx2]=endVn1;endVn1=ch1[--endIdx1];endVn2=ch2[--endIdx2];continue;}
if(startKey1===endKey2){cPatch.call(startVn1,endVn2,withBeforeRemove);ch2[endIdx2]=startVn1;const nextChild=ch2[endIdx2+1];cMoveBefore.call(startVn1,nextChild,_anchor);startVn1=ch1[++startIdx1];endVn2=ch2[--endIdx2];continue;}
if(endKey1===startKey2){cPatch.call(endVn1,startVn2,withBeforeRemove);ch2[startIdx2]=endVn1;const nextChild=ch1[startIdx1];cMoveBefore.call(endVn1,nextChild,_anchor);endVn1=ch1[--endIdx1];startVn2=ch2[++startIdx2];continue;}
mapping=mapping||createMapping(ch1,startIdx1,endIdx1);let idxInOld=mapping[startKey2];if(idxInOld===undefined){cMount.call(startVn2,parent,cFirstNode.call(startVn1)||null);}
else{const elmToMove=ch1[idxInOld];cMoveBefore.call(elmToMove,startVn1,null);cPatch.call(elmToMove,startVn2,withBeforeRemove);ch2[startIdx2]=elmToMove;ch1[idxInOld]=null;}
startVn2=ch2[++startIdx2];}
if(startIdx1<=endIdx1||startIdx2<=endIdx2){if(startIdx1>endIdx1){const nextChild=ch2[endIdx2+1];const anchor=nextChild?cFirstNode.call(nextChild)||null:_anchor;for(let i=startIdx2;i<=endIdx2;i++){cMount.call(ch2[i],parent,anchor);}}
else{for(let i=startIdx1;i<=endIdx1;i++){let ch=ch1[i];if(ch){if(withBeforeRemove){beforeRemove.call(ch);}
cRemove.call(ch);}}}}}
beforeRemove(){const children=this.children;const l=children.length;if(l){const beforeRemove=children[0].beforeRemove;for(let i=0;i<l;i++){beforeRemove.call(children[i]);}}}
remove(){const{parentEl,anchor}=this;if(this.isOnlyChild){nodeSetTextContent.call(parentEl,"");}
else{const children=this.children;const l=children.length;if(l){const remove=children[0].remove;for(let i=0;i<l;i++){remove.call(children[i]);}}
nodeRemoveChild$1.call(parentEl,anchor);}}
firstNode(){const child=this.children[0];return child?child.firstNode():undefined;}
toString(){return this.children.map((c)=>c.toString()).join("");}}
function list(children){return new VList(children);}
function createMapping(ch1,startIdx1,endIdx2){let mapping={};for(let i=startIdx1;i<=endIdx2;i++){mapping[ch1[i].key]=i;}
return mapping;}
const nodeProto=Node.prototype;const nodeInsertBefore=nodeProto.insertBefore;const nodeRemoveChild=nodeProto.removeChild;class VHtml{constructor(html){this.content=[];this.html=html;}
mount(parent,afterNode){this.parentEl=parent;const template=document.createElement("template");template.innerHTML=this.html;this.content=[...template.content.childNodes];for(let elem of this.content){nodeInsertBefore.call(parent,elem,afterNode);}
if(!this.content.length){const textNode=document.createTextNode("");this.content.push(textNode);nodeInsertBefore.call(parent,textNode,afterNode);}}
moveBeforeDOMNode(node,parent=this.parentEl){this.parentEl=parent;for(let elem of this.content){nodeInsertBefore.call(parent,elem,node);}}
moveBeforeVNode(other,afterNode){const target=other?other.content[0]:afterNode;this.moveBeforeDOMNode(target);}
patch(other){if(this===other){return;}
const html2=other.html;if(this.html!==html2){const parent=this.parentEl;const afterNode=this.content[0];const template=document.createElement("template");template.innerHTML=html2;const content=[...template.content.childNodes];for(let elem of content){nodeInsertBefore.call(parent,elem,afterNode);}
if(!content.length){const textNode=document.createTextNode("");content.push(textNode);nodeInsertBefore.call(parent,textNode,afterNode);}
this.remove();this.content=content;this.html=other.html;}}
beforeRemove(){}
remove(){const parent=this.parentEl;for(let elem of this.content){nodeRemoveChild.call(parent,elem);}}
firstNode(){return this.content[0];}
toString(){return this.html;}}
function html(str){return new VHtml(str);}
function createCatcher(eventsSpec){const n=Object.keys(eventsSpec).length;class VCatcher{constructor(child,handlers){this.handlerFns=[];this.afterNode=null;this.child=child;this.handlerData=handlers;}
mount(parent,afterNode){this.parentEl=parent;this.child.mount(parent,afterNode);this.afterNode=document.createTextNode("");parent.insertBefore(this.afterNode,afterNode);this.wrapHandlerData();for(let name in eventsSpec){const index=eventsSpec[name];const handler=createEventHandler(name);this.handlerFns[index]=handler;handler.setup.call(parent,this.handlerData[index]);}}
wrapHandlerData(){for(let i=0;i<n;i++){let handler=this.handlerData[i];let idx=handler.length-2;let origFn=handler[idx];const self=this;handler[idx]=function(ev){const target=ev.target;let currentNode=self.child.firstNode();const afterNode=self.afterNode;while(currentNode&&currentNode!==afterNode){if(currentNode.contains(target)){return origFn.call(this,ev);}
currentNode=currentNode.nextSibling;}};}}
moveBeforeDOMNode(node,parent=this.parentEl){this.parentEl=parent;this.child.moveBeforeDOMNode(node,parent);parent.insertBefore(this.afterNode,node);}
moveBeforeVNode(other,afterNode){if(other){afterNode=other.firstNode()||afterNode;}
this.child.moveBeforeVNode(other?other.child:null,afterNode);this.parentEl.insertBefore(this.afterNode,afterNode);}
patch(other,withBeforeRemove){if(this===other){return;}
this.handlerData=other.handlerData;this.wrapHandlerData();for(let i=0;i<n;i++){this.handlerFns[i].update.call(this.parentEl,this.handlerData[i]);}
this.child.patch(other.child,withBeforeRemove);}
beforeRemove(){this.child.beforeRemove();}
remove(){for(let i=0;i<n;i++){this.handlerFns[i].remove.call(this.parentEl);}
this.child.remove();this.afterNode.remove();}
firstNode(){return this.child.firstNode();}
toString(){return this.child.toString();}}
return function(child,handlers){return new VCatcher(child,handlers);};}
function mount$1(vnode,fixture,afterNode=null){vnode.mount(fixture,afterNode);}
function patch(vnode1,vnode2,withBeforeRemove=false){vnode1.patch(vnode2,withBeforeRemove);}
function remove(vnode,withBeforeRemove=false){if(withBeforeRemove){vnode.beforeRemove();}
vnode.remove();}
const fibersInError=new WeakMap();const nodeErrorHandlers=new WeakMap();function _handleError(node,error){if(!node){return false;}
const fiber=node.fiber;if(fiber){fibersInError.set(fiber,error);}
const errorHandlers=nodeErrorHandlers.get(node);if(errorHandlers){let handled=false;for(let i=errorHandlers.length-1;i>=0;i--){try{errorHandlers[i](error);handled=true;break;}
catch(e){error=e;}}
if(handled){return true;}}
return _handleError(node.parent,error);}
function handleError(params){let{error}=params;if(!(error instanceof OwlError)){error=Object.assign(new OwlError(`An error occured in the owl lifecycle (see this Error's "cause" property)`),{cause:error});}
const node="node"in params?params.node:params.fiber.node;const fiber="fiber"in params?params.fiber:node.fiber;if(fiber){let current=fiber;do{current.node.fiber=current;current=current.parent;}while(current);fibersInError.set(fiber.root,error);}
const handled=_handleError(node,error);if(!handled){console.warn(`[Owl] Unhandled error. Destroying the root component`);try{node.app.destroy();}
catch(e){console.error(e);}
throw error;}}
function makeChildFiber(node,parent){let current=node.fiber;if(current){cancelFibers(current.children);current.root=null;}
return new Fiber(node,parent);}
function makeRootFiber(node){let current=node.fiber;if(current){let root=current.root;root.locked=true;root.setCounter(root.counter+1-cancelFibers(current.children));root.locked=false;current.children=[];current.childrenMap={};current.bdom=null;if(fibersInError.has(current)){fibersInError.delete(current);fibersInError.delete(root);current.appliedToDom=false;}
return current;}
const fiber=new RootFiber(node,null);if(node.willPatch.length){fiber.willPatch.push(fiber);}
if(node.patched.length){fiber.patched.push(fiber);}
return fiber;}
function throwOnRender(){throw new OwlError("Attempted to render cancelled fiber");}
function cancelFibers(fibers){let result=0;for(let fiber of fibers){let node=fiber.node;fiber.render=throwOnRender;if(node.status===0){node.cancel();}
node.fiber=null;if(fiber.bdom){node.forceNextRender=true;}
else{result++;}
result+=cancelFibers(fiber.children);}
return result;}
class Fiber{constructor(node,parent){this.bdom=null;this.children=[];this.appliedToDom=false;this.deep=false;this.childrenMap={};this.node=node;this.parent=parent;if(parent){this.deep=parent.deep;const root=parent.root;root.setCounter(root.counter+1);this.root=root;parent.children.push(this);}
else{this.root=this;}}
render(){let prev=this.root.node;let scheduler=prev.app.scheduler;let current=prev.parent;while(current){if(current.fiber){let root=current.fiber.root;if(root.counter===0&&prev.parentKey in current.fiber.childrenMap){current=root.node;}
else{scheduler.delayedRenders.push(this);return;}}
prev=current;current=current.parent;}
this._render();}
_render(){const node=this.node;const root=this.root;if(root){try{this.bdom=true;this.bdom=node.renderFn();}
catch(e){node.app.handleError({node,error:e});}
root.setCounter(root.counter-1);}}}
class RootFiber extends Fiber{constructor(){super(...arguments);this.counter=1;this.willPatch=[];this.patched=[];this.mounted=[];this.locked=false;}
complete(){const node=this.node;this.locked=true;let current=undefined;try{for(current of this.willPatch){let node=current.node;if(node.fiber===current){const component=node.component;for(let cb of node.willPatch){cb.call(component);}}}
current=undefined;node._patch();this.locked=false;let mountedFibers=this.mounted;while((current=mountedFibers.pop())){current=current;if(current.appliedToDom){for(let cb of current.node.mounted){cb();}}}
let patchedFibers=this.patched;while((current=patchedFibers.pop())){current=current;if(current.appliedToDom){for(let cb of current.node.patched){cb();}}}}
catch(e){this.locked=false;node.app.handleError({fiber:current||this,error:e});}}
setCounter(newValue){this.counter=newValue;if(newValue===0){this.node.app.scheduler.flush();}}}
class MountFiber extends RootFiber{constructor(node,target,options={}){super(node,null);this.target=target;this.position=options.position||"last-child";}
complete(){let current=this;try{const node=this.node;node.children=this.childrenMap;node.app.constructor.validateTarget(this.target);if(node.bdom){node.updateDom();}
else{node.bdom=this.bdom;if(this.position==="last-child"||this.target.childNodes.length===0){mount$1(node.bdom,this.target);}
else{const firstChild=this.target.childNodes[0];mount$1(node.bdom,this.target,firstChild);}}
node.fiber=null;node.status=1;this.appliedToDom=true;let mountedFibers=this.mounted;while((current=mountedFibers.pop())){if(current.appliedToDom){for(let cb of current.node.mounted){cb();}}}}
catch(e){this.node.app.handleError({fiber:current,error:e});}}}
const KEYCHANGES=Symbol("Key changes");const NO_CALLBACK=()=>{throw new Error("Called NO_CALLBACK. Owl is broken, please report this to the maintainers.");};const objectToString=Object.prototype.toString;const objectHasOwnProperty=Object.prototype.hasOwnProperty;const SUPPORTED_RAW_TYPES=["Object","Array","Set","Map","WeakMap"];const COLLECTION_RAW_TYPES=["Set","Map","WeakMap"];function rawType(obj){return objectToString.call(toRaw(obj)).slice(8,-1);}
function canBeMadeReactive(value){if(typeof value!=="object"){return false;}
return SUPPORTED_RAW_TYPES.includes(rawType(value));}
function possiblyReactive(val,cb){return canBeMadeReactive(val)?reactive(val,cb):val;}
const skipped=new WeakSet();function markRaw(value){skipped.add(value);return value;}
function toRaw(value){return targets.has(value)?targets.get(value):value;}
const targetToKeysToCallbacks=new WeakMap();function observeTargetKey(target,key,callback){if(callback===NO_CALLBACK){return;}
if(!targetToKeysToCallbacks.get(target)){targetToKeysToCallbacks.set(target,new Map());}
const keyToCallbacks=targetToKeysToCallbacks.get(target);if(!keyToCallbacks.get(key)){keyToCallbacks.set(key,new Set());}
keyToCallbacks.get(key).add(callback);if(!callbacksToTargets.has(callback)){callbacksToTargets.set(callback,new Set());}
callbacksToTargets.get(callback).add(target);}
function notifyReactives(target,key){const keyToCallbacks=targetToKeysToCallbacks.get(target);if(!keyToCallbacks){return;}
const callbacks=keyToCallbacks.get(key);if(!callbacks){return;}
for(const callback of[...callbacks]){clearReactivesForCallback(callback);callback();}}
const callbacksToTargets=new WeakMap();function clearReactivesForCallback(callback){const targetsToClear=callbacksToTargets.get(callback);if(!targetsToClear){return;}
for(const target of targetsToClear){const observedKeys=targetToKeysToCallbacks.get(target);if(!observedKeys){continue;}
for(const[key,callbacks]of observedKeys.entries()){callbacks.delete(callback);if(!callbacks.size){observedKeys.delete(key);}}}
targetsToClear.clear();}
function getSubscriptions(callback){const targets=callbacksToTargets.get(callback)||[];return[...targets].map((target)=>{const keysToCallbacks=targetToKeysToCallbacks.get(target);let keys=[];if(keysToCallbacks){for(const[key,cbs]of keysToCallbacks){if(cbs.has(callback)){keys.push(key);}}}
return{target,keys};});}
const targets=new WeakMap();const reactiveCache=new WeakMap();function reactive(target,callback=NO_CALLBACK){if(!canBeMadeReactive(target)){throw new OwlError(`Cannot make the given value reactive`);}
if(skipped.has(target)){return target;}
if(targets.has(target)){return reactive(targets.get(target),callback);}
if(!reactiveCache.has(target)){reactiveCache.set(target,new WeakMap());}
const reactivesForTarget=reactiveCache.get(target);if(!reactivesForTarget.has(callback)){const targetRawType=rawType(target);const handler=COLLECTION_RAW_TYPES.includes(targetRawType)?collectionsProxyHandler(target,callback,targetRawType):basicProxyHandler(callback);const proxy=new Proxy(target,handler);reactivesForTarget.set(callback,proxy);targets.set(proxy,target);}
return reactivesForTarget.get(callback);}
function basicProxyHandler(callback){return{get(target,key,receiver){const desc=Object.getOwnPropertyDescriptor(target,key);if(desc&&!desc.writable&&!desc.configurable){return Reflect.get(target,key,receiver);}
observeTargetKey(target,key,callback);return possiblyReactive(Reflect.get(target,key,receiver),callback);},set(target,key,value,receiver){const hadKey=objectHasOwnProperty.call(target,key);const originalValue=Reflect.get(target,key,receiver);const ret=Reflect.set(target,key,toRaw(value),receiver);if(!hadKey&&objectHasOwnProperty.call(target,key)){notifyReactives(target,KEYCHANGES);}
if(originalValue!==Reflect.get(target,key,receiver)||(key==="length"&&Array.isArray(target))){notifyReactives(target,key);}
return ret;},deleteProperty(target,key){const ret=Reflect.deleteProperty(target,key);notifyReactives(target,KEYCHANGES);notifyReactives(target,key);return ret;},ownKeys(target){observeTargetKey(target,KEYCHANGES,callback);return Reflect.ownKeys(target);},has(target,key){observeTargetKey(target,KEYCHANGES,callback);return Reflect.has(target,key);},};}
function makeKeyObserver(methodName,target,callback){return(key)=>{key=toRaw(key);observeTargetKey(target,key,callback);return possiblyReactive(target[methodName](key),callback);};}
function makeIteratorObserver(methodName,target,callback){return function*(){observeTargetKey(target,KEYCHANGES,callback);const keys=target.keys();for(const item of target[methodName]()){const key=keys.next().value;observeTargetKey(target,key,callback);yield possiblyReactive(item,callback);}};}
function makeForEachObserver(target,callback){return function forEach(forEachCb,thisArg){observeTargetKey(target,KEYCHANGES,callback);target.forEach(function(val,key,targetObj){observeTargetKey(target,key,callback);forEachCb.call(thisArg,possiblyReactive(val,callback),possiblyReactive(key,callback),possiblyReactive(targetObj,callback));},thisArg);};}
function delegateAndNotify(setterName,getterName,target){return(key,value)=>{key=toRaw(key);const hadKey=target.has(key);const originalValue=target[getterName](key);const ret=target[setterName](key,value);const hasKey=target.has(key);if(hadKey!==hasKey){notifyReactives(target,KEYCHANGES);}
if(originalValue!==target[getterName](key)){notifyReactives(target,key);}
return ret;};}
function makeClearNotifier(target){return()=>{const allKeys=[...target.keys()];target.clear();notifyReactives(target,KEYCHANGES);for(const key of allKeys){notifyReactives(target,key);}};}
const rawTypeToFuncHandlers={Set:(target,callback)=>({has:makeKeyObserver("has",target,callback),add:delegateAndNotify("add","has",target),delete:delegateAndNotify("delete","has",target),keys:makeIteratorObserver("keys",target,callback),values:makeIteratorObserver("values",target,callback),entries:makeIteratorObserver("entries",target,callback),[Symbol.iterator]:makeIteratorObserver(Symbol.iterator,target,callback),forEach:makeForEachObserver(target,callback),clear:makeClearNotifier(target),get size(){observeTargetKey(target,KEYCHANGES,callback);return target.size;},}),Map:(target,callback)=>({has:makeKeyObserver("has",target,callback),get:makeKeyObserver("get",target,callback),set:delegateAndNotify("set","get",target),delete:delegateAndNotify("delete","has",target),keys:makeIteratorObserver("keys",target,callback),values:makeIteratorObserver("values",target,callback),entries:makeIteratorObserver("entries",target,callback),[Symbol.iterator]:makeIteratorObserver(Symbol.iterator,target,callback),forEach:makeForEachObserver(target,callback),clear:makeClearNotifier(target),get size(){observeTargetKey(target,KEYCHANGES,callback);return target.size;},}),WeakMap:(target,callback)=>({has:makeKeyObserver("has",target,callback),get:makeKeyObserver("get",target,callback),set:delegateAndNotify("set","get",target),delete:delegateAndNotify("delete","has",target),}),};function collectionsProxyHandler(target,callback,targetRawType){const specialHandlers=rawTypeToFuncHandlers[targetRawType](target,callback);return Object.assign(basicProxyHandler(callback),{get(target,key){if(objectHasOwnProperty.call(specialHandlers,key)){return specialHandlers[key];}
observeTargetKey(target,key,callback);return possiblyReactive(target[key],callback);},});}
let currentNode=null;function getCurrent(){if(!currentNode){throw new OwlError("No active component (a hook function should only be called in 'setup')");}
return currentNode;}
function useComponent(){return currentNode.component;}
function applyDefaultProps(props,defaultProps){for(let propName in defaultProps){if(props[propName]===undefined){props[propName]=defaultProps[propName];}}}
const batchedRenderFunctions=new WeakMap();function useState(state){const node=getCurrent();let render=batchedRenderFunctions.get(node);if(!render){render=batched(node.render.bind(node,false));batchedRenderFunctions.set(node,render);node.willDestroy.push(clearReactivesForCallback.bind(null,render));}
return reactive(state,render);}
class ComponentNode{constructor(C,props,app,parent,parentKey){this.fiber=null;this.bdom=null;this.status=0;this.forceNextRender=false;this.nextProps=null;this.children=Object.create(null);this.refs={};this.willStart=[];this.willUpdateProps=[];this.willUnmount=[];this.mounted=[];this.willPatch=[];this.patched=[];this.willDestroy=[];currentNode=this;this.app=app;this.parent=parent;this.props=props;this.parentKey=parentKey;const defaultProps=C.defaultProps;props=Object.assign({},props);if(defaultProps){applyDefaultProps(props,defaultProps);}
const env=(parent&&parent.childEnv)||app.env;this.childEnv=env;for(const key in props){const prop=props[key];if(prop&&typeof prop==="object"&&targets.has(prop)){props[key]=useState(prop);}}
this.component=new C(props,env,this);const ctx=Object.assign(Object.create(this.component),{this:this.component});this.renderFn=app.getTemplate(C.template).bind(this.component,ctx,this);this.component.setup();currentNode=null;}
mountComponent(target,options){const fiber=new MountFiber(this,target,options);this.app.scheduler.addFiber(fiber);this.initiateRender(fiber);}
async initiateRender(fiber){this.fiber=fiber;if(this.mounted.length){fiber.root.mounted.push(fiber);}
const component=this.component;try{await Promise.all(this.willStart.map((f)=>f.call(component)));}
catch(e){this.app.handleError({node:this,error:e});return;}
if(this.status===0&&this.fiber===fiber){fiber.render();}}
async render(deep){if(this.status>=2){return;}
let current=this.fiber;if(current&&(current.root.locked||current.bdom===true)){await Promise.resolve();current=this.fiber;}
if(current){if(!current.bdom&&!fibersInError.has(current)){if(deep){current.deep=deep;}
return;}
deep=deep||current.deep;}
else if(!this.bdom){return;}
const fiber=makeRootFiber(this);fiber.deep=deep;this.fiber=fiber;this.app.scheduler.addFiber(fiber);await Promise.resolve();if(this.status>=2){return;}
if(this.fiber===fiber&&(current||!fiber.parent)){fiber.render();}}
cancel(){this._cancel();delete this.parent.children[this.parentKey];this.app.scheduler.scheduleDestroy(this);}
_cancel(){this.status=2;const children=this.children;for(let childKey in children){children[childKey]._cancel();}}
destroy(){let shouldRemove=this.status===1;this._destroy();if(shouldRemove){this.bdom.remove();}}
_destroy(){const component=this.component;if(this.status===1){for(let cb of this.willUnmount){cb.call(component);}}
for(let child of Object.values(this.children)){child._destroy();}
if(this.willDestroy.length){try{for(let cb of this.willDestroy){cb.call(component);}}
catch(e){this.app.handleError({error:e,node:this});}}
this.status=3;}
async updateAndRender(props,parentFiber){this.nextProps=props;props=Object.assign({},props);const fiber=makeChildFiber(this,parentFiber);this.fiber=fiber;const component=this.component;const defaultProps=component.constructor.defaultProps;if(defaultProps){applyDefaultProps(props,defaultProps);}
currentNode=this;for(const key in props){const prop=props[key];if(prop&&typeof prop==="object"&&targets.has(prop)){props[key]=useState(prop);}}
currentNode=null;const prom=Promise.all(this.willUpdateProps.map((f)=>f.call(component,props)));await prom;if(fiber!==this.fiber){return;}
component.props=props;fiber.render();const parentRoot=parentFiber.root;if(this.willPatch.length){parentRoot.willPatch.push(fiber);}
if(this.patched.length){parentRoot.patched.push(fiber);}}
updateDom(){if(!this.fiber){return;}
if(this.bdom===this.fiber.bdom){for(let k in this.children){const child=this.children[k];child.updateDom();}}
else{this.bdom.patch(this.fiber.bdom,false);this.fiber.appliedToDom=true;this.fiber=null;}}
setRef(name,el){if(el){this.refs[name]=el;}}
firstNode(){const bdom=this.bdom;return bdom?bdom.firstNode():undefined;}
mount(parent,anchor){const bdom=this.fiber.bdom;this.bdom=bdom;bdom.mount(parent,anchor);this.status=1;this.fiber.appliedToDom=true;this.children=this.fiber.childrenMap;this.fiber=null;}
moveBeforeDOMNode(node,parent){this.bdom.moveBeforeDOMNode(node,parent);}
moveBeforeVNode(other,afterNode){this.bdom.moveBeforeVNode(other?other.bdom:null,afterNode);}
patch(){if(this.fiber&&this.fiber.parent){this._patch();this.props=this.nextProps;}}
_patch(){let hasChildren=false;for(let _k in this.children){hasChildren=true;break;}
const fiber=this.fiber;this.children=fiber.childrenMap;this.bdom.patch(fiber.bdom,hasChildren);fiber.appliedToDom=true;this.fiber=null;}
beforeRemove(){this._destroy();}
remove(){this.bdom.remove();}
get name(){return this.component.constructor.name;}
get subscriptions(){const render=batchedRenderFunctions.get(this);return render?getSubscriptions(render):[];}}
const TIMEOUT=Symbol("timeout");function wrapError(fn,hookName){const error=new OwlError(`The following error occurred in ${hookName}: `);const timeoutError=new OwlError(`${hookName}'s promise hasn't resolved after 3 seconds`);const node=getCurrent();return(...args)=>{const onError=(cause)=>{error.cause=cause;if(cause instanceof Error){error.message+=`"${cause.message}"`;}
else{error.message=`Something that is not an Error was thrown in ${hookName} (see this Error's "cause" property)`;}
throw error;};try{const result=fn(...args);if(result instanceof Promise){if(hookName==="onWillStart"||hookName==="onWillUpdateProps"){const fiber=node.fiber;Promise.race([result.catch(()=>{}),new Promise((resolve)=>setTimeout(()=>resolve(TIMEOUT),3000)),]).then((res)=>{if(res===TIMEOUT&&node.fiber===fiber&&node.status<=2){console.warn(timeoutError);}});}
return result.catch(onError);}
return result;}
catch(cause){onError(cause);}};}
function onWillStart(fn){const node=getCurrent();const decorate=node.app.dev?wrapError:(fn)=>fn;node.willStart.push(decorate(fn.bind(node.component),"onWillStart"));}
function onWillUpdateProps(fn){const node=getCurrent();const decorate=node.app.dev?wrapError:(fn)=>fn;node.willUpdateProps.push(decorate(fn.bind(node.component),"onWillUpdateProps"));}
function onMounted(fn){const node=getCurrent();const decorate=node.app.dev?wrapError:(fn)=>fn;node.mounted.push(decorate(fn.bind(node.component),"onMounted"));}
function onWillPatch(fn){const node=getCurrent();const decorate=node.app.dev?wrapError:(fn)=>fn;node.willPatch.unshift(decorate(fn.bind(node.component),"onWillPatch"));}
function onPatched(fn){const node=getCurrent();const decorate=node.app.dev?wrapError:(fn)=>fn;node.patched.push(decorate(fn.bind(node.component),"onPatched"));}
function onWillUnmount(fn){const node=getCurrent();const decorate=node.app.dev?wrapError:(fn)=>fn;node.willUnmount.unshift(decorate(fn.bind(node.component),"onWillUnmount"));}
function onWillDestroy(fn){const node=getCurrent();const decorate=node.app.dev?wrapError:(fn)=>fn;node.willDestroy.push(decorate(fn.bind(node.component),"onWillDestroy"));}
function onWillRender(fn){const node=getCurrent();const renderFn=node.renderFn;const decorate=node.app.dev?wrapError:(fn)=>fn;fn=decorate(fn.bind(node.component),"onWillRender");node.renderFn=()=>{fn();return renderFn();};}
function onRendered(fn){const node=getCurrent();const renderFn=node.renderFn;const decorate=node.app.dev?wrapError:(fn)=>fn;fn=decorate(fn.bind(node.component),"onRendered");node.renderFn=()=>{const result=renderFn();fn();return result;};}
function onError(callback){const node=getCurrent();let handlers=nodeErrorHandlers.get(node);if(!handlers){handlers=[];nodeErrorHandlers.set(node,handlers);}
handlers.push(callback.bind(node.component));}
class Component{constructor(props,env,node){this.props=props;this.env=env;this.__owl__=node;}
setup(){}
render(deep=false){this.__owl__.render(deep===true);}}
Component.template="";const VText=text("").constructor;class VPortal extends VText{constructor(selector,content){super("");this.target=null;this.selector=selector;this.content=content;}
mount(parent,anchor){super.mount(parent,anchor);this.target=document.querySelector(this.selector);if(this.target){this.content.mount(this.target,null);}
else{this.content.mount(parent,anchor);}}
beforeRemove(){this.content.beforeRemove();}
remove(){if(this.content){super.remove();this.content.remove();this.content=null;}}
patch(other){super.patch(other);if(this.content){this.content.patch(other.content,true);}
else{this.content=other.content;this.content.mount(this.target,null);}}}
function portalTemplate(app,bdom,helpers){let{callSlot}=helpers;return function template(ctx,node,key=""){return new VPortal(ctx.props.target,callSlot(ctx,node,key,"default",false,null));};}
class Portal extends Component{setup(){const node=this.__owl__;onMounted(()=>{const portal=node.bdom;if(!portal.target){const target=document.querySelector(this.props.target);if(target){portal.content.moveBeforeDOMNode(target.firstChild,target);}
else{throw new OwlError("invalid portal target");}}});onWillUnmount(()=>{const portal=node.bdom;portal.remove();});}}
Portal.template="__portal__";Portal.props={target:{type:String,},slots:true,};const isUnionType=(t)=>Array.isArray(t);const isBaseType=(t)=>typeof t!=="object";const isValueType=(t)=>typeof t==="object"&&t&&"value"in t;function isOptional(t){return typeof t==="object"&&"optional"in t?t.optional||false:false;}
function describeType(type){return type==="*"||type===true?"value":type.name.toLowerCase();}
function describe(info){if(isBaseType(info)){return describeType(info);}
else if(isUnionType(info)){return info.map(describe).join(" or ");}
else if(isValueType(info)){return String(info.value);}
if("element"in info){return`list of ${describe({ type: info.element, optional: false })}s`;}
if("shape"in info){return`object`;}
return describe(info.type||"*");}
function toSchema(spec){return Object.fromEntries(spec.map((e)=>e.endsWith("?")?[e.slice(0,-1),{optional:true}]:[e,{type:"*",optional:false}]));}
function validate(obj,spec){let errors=validateSchema(obj,spec);if(errors.length){throw new OwlError("Invalid object: "+errors.join(", "));}}
function validateSchema(obj,schema){if(Array.isArray(schema)){schema=toSchema(schema);}
obj=toRaw(obj);let errors=[];for(let key in obj){if(key in schema){let result=validateType(key,obj[key],schema[key]);if(result){errors.push(result);}}
else if(!("*"in schema)){errors.push(`unknown key '${key}'`);}}
for(let key in schema){const spec=schema[key];if(key!=="*"&&!isOptional(spec)&&!(key in obj)){const isObj=typeof spec==="object"&&!Array.isArray(spec);const isAny=spec==="*"||(isObj&&"type"in spec?spec.type==="*":isObj);let detail=isAny?"":` (should be a ${describe(spec)})`;errors.push(`'${key}' is missing${detail}`);}}
return errors;}
function validateBaseType(key,value,type){if(typeof type==="function"){if(typeof value==="object"){if(!(value instanceof type)){return`'${key}' is not a ${describeType(type)}`;}}
else if(typeof value!==type.name.toLowerCase()){return`'${key}' is not a ${describeType(type)}`;}}
return null;}
function validateArrayType(key,value,descr){if(!Array.isArray(value)){return`'${key}' is not a list of ${describe(descr)}s`;}
for(let i=0;i<value.length;i++){const error=validateType(`${key}[${i}]`,value[i],descr);if(error){return error;}}
return null;}
function validateType(key,value,descr){if(value===undefined){return isOptional(descr)?null:`'${key}' is undefined (should be a ${describe(descr)})`;}
else if(isBaseType(descr)){return validateBaseType(key,value,descr);}
else if(isValueType(descr)){return value===descr.value?null:`'${key}' is not equal to '${descr.value}'`;}
else if(isUnionType(descr)){let validDescr=descr.find((p)=>!validateType(key,value,p));return validDescr?null:`'${key}' is not a ${describe(descr)}`;}
let result=null;if("element"in descr){result=validateArrayType(key,value,descr.element);}
else if("shape"in descr){if(typeof value!=="object"||Array.isArray(value)){result=`'${key}' is not an object`;}
else{const errors=validateSchema(value,descr.shape);if(errors.length){result=`'${key}' doesn't have the correct shape (${errors.join(", ")})`;}}}
else if("values"in descr){if(typeof value!=="object"||Array.isArray(value)){result=`'${key}' is not an object`;}
else{const errors=Object.entries(value).map(([key,value])=>validateType(key,value,descr.values)).filter(Boolean);if(errors.length){result=`some of the values in '${key}' are invalid (${errors.join(", ")})`;}}}
if("type"in descr&&!result){result=validateType(key,value,descr.type);}
if("validate"in descr&&!result){result=!descr.validate(value)?`'${key}' is not valid`:null;}
return result;}
const ObjectCreate=Object.create;function withDefault(value,defaultValue){return value===undefined||value===null||value===false?defaultValue:value;}
function callSlot(ctx,parent,key,name,dynamic,extra,defaultContent){key=key+"__slot_"+name;const slots=ctx.props.slots||{};const{__render,__ctx,__scope}=slots[name]||{};const slotScope=ObjectCreate(__ctx||{});if(__scope){slotScope[__scope]=extra;}
const slotBDom=__render?__render(slotScope,parent,key):null;if(defaultContent){let child1=undefined;let child2=undefined;if(slotBDom){child1=dynamic?toggler(name,slotBDom):slotBDom;}
else{child2=defaultContent(ctx,parent,key);}
return multi([child1,child2]);}
return slotBDom||text("");}
function capture(ctx){const result=ObjectCreate(ctx);for(let k in ctx){result[k]=ctx[k];}
return result;}
function withKey(elem,k){elem.key=k;return elem;}
function prepareList(collection){let keys;let values;if(Array.isArray(collection)){keys=collection;values=collection;}
else if(collection instanceof Map){keys=[...collection.keys()];values=[...collection.values()];}
else if(Symbol.iterator in Object(collection)){keys=[...collection];values=keys;}
else if(collection&&typeof collection==="object"){values=Object.values(collection);keys=Object.keys(collection);}
else{throw new OwlError(`Invalid loop expression: "${collection}" is not iterable`);}
const n=values.length;return[keys,values,n,new Array(n)];}
const isBoundary=Symbol("isBoundary");function setContextValue(ctx,key,value){const ctx0=ctx;while(!ctx.hasOwnProperty(key)&&!ctx.hasOwnProperty(isBoundary)){const newCtx=ctx.__proto__;if(!newCtx){ctx=ctx0;break;}
ctx=newCtx;}
ctx[key]=value;}
function toNumber(val){const n=parseFloat(val);return isNaN(n)?val:n;}
function shallowEqual(l1,l2){for(let i=0,l=l1.length;i<l;i++){if(l1[i]!==l2[i]){return false;}}
return true;}
class LazyValue{constructor(fn,ctx,component,node,key){this.fn=fn;this.ctx=capture(ctx);this.component=component;this.node=node;this.key=key;}
evaluate(){return this.fn.call(this.component,this.ctx,this.node,this.key);}
toString(){return this.evaluate().toString();}}
function safeOutput(value,defaultValue){if(value===undefined||value===null){return defaultValue?toggler("default",defaultValue):toggler("undefined",text(""));}
let safeKey;let block;switch(typeof value){case"object":if(value instanceof Markup){safeKey=`string_safe`;block=html(value);}
else if(value instanceof LazyValue){safeKey=`lazy_value`;block=value.evaluate();}
else if(value instanceof String){safeKey="string_unsafe";block=text(value);}
else{safeKey="block_safe";block=value;}
break;case"string":safeKey="string_unsafe";block=text(value);break;default:safeKey="string_unsafe";block=text(String(value));}
return toggler(safeKey,block);}
function validateProps(name,props,comp){const ComponentClass=typeof name!=="string"?name:comp.constructor.components[name];if(!ComponentClass){return;}
const schema=ComponentClass.props;if(!schema){if(comp.__owl__.app.warnIfNoStaticProps){console.warn(`Component '${ComponentClass.name}' does not have a static props description`);}
return;}
const defaultProps=ComponentClass.defaultProps;if(defaultProps){let isMandatory=(name)=>Array.isArray(schema)?schema.includes(name):name in schema&&!("*"in schema)&&!isOptional(schema[name]);for(let p in defaultProps){if(isMandatory(p)){throw new OwlError(`A default value cannot be defined for a mandatory prop (name: '${p}', component: ${ComponentClass.name})`);}}}
const errors=validateSchema(props,schema);if(errors.length){throw new OwlError(`Invalid props for component '${ComponentClass.name}': `+errors.join(", "));}}
function makeRefWrapper(node){let refNames=new Set();return(name,fn)=>{if(refNames.has(name)){throw new OwlError(`Cannot set the same ref more than once in the same component, ref "${name}" was set multiple times in ${node.name}`);}
refNames.add(name);return fn;};}
const helpers={withDefault,zero:Symbol("zero"),isBoundary,callSlot,capture,withKey,prepareList,setContextValue,shallowEqual,toNumber,validateProps,LazyValue,safeOutput,createCatcher,markRaw,OwlError,makeRefWrapper,};function parseXML(xml){const parser=new DOMParser();const doc=parser.parseFromString(xml,"text/xml");if(doc.getElementsByTagName("parsererror").length){let msg="Invalid XML in template.";const parsererrorText=doc.getElementsByTagName("parsererror")[0].textContent;if(parsererrorText){msg+="\nThe parser has produced the following error message:\n"+parsererrorText;const re=/\d+/g;const firstMatch=re.exec(parsererrorText);if(firstMatch){const lineNumber=Number(firstMatch[0]);const line=xml.split("\n")[lineNumber-1];const secondMatch=re.exec(parsererrorText);if(line&&secondMatch){const columnIndex=Number(secondMatch[0])-1;if(line[columnIndex]){msg+=`\nThe error might be located at xml line ${lineNumber} column ${columnIndex}\n`+`${line}\n${"-".repeat(columnIndex - 1)}^`;}}}}
throw new OwlError(msg);}
return doc;}
const bdom={text,createBlock,list,multi,html,toggler,comment};class TemplateSet{constructor(config={}){this.rawTemplates=Object.create(globalTemplates);this.templates={};this.Portal=Portal;this.dev=config.dev||false;this.translateFn=config.translateFn;this.translatableAttributes=config.translatableAttributes;if(config.templates){if(config.templates instanceof Document||typeof config.templates==="string"){this.addTemplates(config.templates);}
else{for(const name in config.templates){this.addTemplate(name,config.templates[name]);}}}
this.getRawTemplate=config.getTemplate;}
static registerTemplate(name,fn){globalTemplates[name]=fn;}
addTemplate(name,template){if(name in this.rawTemplates){if(!this.dev){return;}
const rawTemplate=this.rawTemplates[name];const currentAsString=typeof rawTemplate==="string"?rawTemplate:rawTemplate instanceof Element?rawTemplate.outerHTML:rawTemplate.toString();const newAsString=typeof template==="string"?template:template.outerHTML;if(currentAsString===newAsString){return;}
throw new OwlError(`Template ${name} already defined with different content`);}
this.rawTemplates[name]=template;}
addTemplates(xml){if(!xml){return;}
xml=xml instanceof Document?xml:parseXML(xml);for(const template of xml.querySelectorAll("[t-name]")){const name=template.getAttribute("t-name");this.addTemplate(name,template);}}
getTemplate(name){var _a;if(!(name in this.templates)){const rawTemplate=((_a=this.getRawTemplate)===null||_a===void 0?void 0:_a.call(this,name))||this.rawTemplates[name];if(rawTemplate===undefined){let extraInfo="";try{const componentName=getCurrent().component.constructor.name;extraInfo=` (for component "${componentName}")`;}
catch{}
throw new OwlError(`Missing template: "${name}"${extraInfo}`);}
const isFn=typeof rawTemplate==="function"&&!(rawTemplate instanceof Element);const templateFn=isFn?rawTemplate:this._compileTemplate(name,rawTemplate);const templates=this.templates;this.templates[name]=function(context,parent){return templates[name].call(this,context,parent);};const template=templateFn(this,bdom,helpers);this.templates[name]=template;}
return this.templates[name];}
_compileTemplate(name,template){throw new OwlError(`Unable to compile a template. Please use owl full build instead`);}
callTemplate(owner,subTemplate,ctx,parent,key){const template=this.getTemplate(subTemplate);return toggler(subTemplate,template.call(owner,ctx,parent,key+subTemplate));}}
const globalTemplates={};function xml(...args){const name=`__template__${xml.nextId++}`;const value=String.raw(...args);globalTemplates[name]=value;return name;}
xml.nextId=1;TemplateSet.registerTemplate("__portal__",portalTemplate);const RESERVED_WORDS="true,false,NaN,null,undefined,debugger,console,window,in,instanceof,new,function,return,eval,void,Math,RegExp,Array,Object,Date".split(",");const WORD_REPLACEMENT=Object.assign(Object.create(null),{and:"&&",or:"||",gt:">",gte:">=",lt:"<",lte:"<=",});const STATIC_TOKEN_MAP=Object.assign(Object.create(null),{"{":"LEFT_BRACE","}":"RIGHT_BRACE","[":"LEFT_BRACKET","]":"RIGHT_BRACKET",":":"COLON",",":"COMMA","(":"LEFT_PAREN",")":"RIGHT_PAREN",});const OPERATORS="...,.,===,==,+,!==,!=,!,||,&&,>=,>,<=,<,?,-,*,/,%,typeof ,=>,=,;,in ,new ,|,&,^,~".split(",");let tokenizeString=function(expr){let s=expr[0];let start=s;if(s!=="'"&&s!=='"'&&s!=="`"){return false;}
let i=1;let cur;while(expr[i]&&expr[i]!==start){cur=expr[i];s+=cur;if(cur==="\\"){i++;cur=expr[i];if(!cur){throw new OwlError("Invalid expression");}
s+=cur;}
i++;}
if(expr[i]!==start){throw new OwlError("Invalid expression");}
s+=start;if(start==="`"){return{type:"TEMPLATE_STRING",value:s,replace(replacer){return s.replace(/\$\{(.*?)\}/g,(match,group)=>{return"${"+replacer(group)+"}";});},};}
return{type:"VALUE",value:s};};let tokenizeNumber=function(expr){let s=expr[0];if(s&&s.match(/[0-9]/)){let i=1;while(expr[i]&&expr[i].match(/[0-9]|\./)){s+=expr[i];i++;}
return{type:"VALUE",value:s};}
else{return false;}};let tokenizeSymbol=function(expr){let s=expr[0];if(s&&s.match(/[a-zA-Z_\$]/)){let i=1;while(expr[i]&&expr[i].match(/\w/)){s+=expr[i];i++;}
if(s in WORD_REPLACEMENT){return{type:"OPERATOR",value:WORD_REPLACEMENT[s],size:s.length};}
return{type:"SYMBOL",value:s};}
else{return false;}};const tokenizeStatic=function(expr){const char=expr[0];if(char&&char in STATIC_TOKEN_MAP){return{type:STATIC_TOKEN_MAP[char],value:char};}
return false;};const tokenizeOperator=function(expr){for(let op of OPERATORS){if(expr.startsWith(op)){return{type:"OPERATOR",value:op};}}
return false;};const TOKENIZERS=[tokenizeString,tokenizeNumber,tokenizeOperator,tokenizeSymbol,tokenizeStatic,];function tokenize(expr){const result=[];let token=true;let error;let current=expr;try{while(token){current=current.trim();if(current){for(let tokenizer of TOKENIZERS){token=tokenizer(current);if(token){result.push(token);current=current.slice(token.size||token.value.length);break;}}}
else{token=false;}}}
catch(e){error=e;}
if(current.length||error){throw new OwlError(`Tokenizer error: could not tokenize \`${expr}\``);}
return result;}
const isLeftSeparator=(token)=>token&&(token.type==="LEFT_BRACE"||token.type==="COMMA");const isRightSeparator=(token)=>token&&(token.type==="RIGHT_BRACE"||token.type==="COMMA");function compileExprToArray(expr){const localVars=new Set();const tokens=tokenize(expr);let i=0;let stack=[];while(i<tokens.length){let token=tokens[i];let prevToken=tokens[i-1];let nextToken=tokens[i+1];let groupType=stack[stack.length-1];switch(token.type){case"LEFT_BRACE":case"LEFT_BRACKET":case"LEFT_PAREN":stack.push(token.type);break;case"RIGHT_BRACE":case"RIGHT_BRACKET":case"RIGHT_PAREN":stack.pop();}
let isVar=token.type==="SYMBOL"&&!RESERVED_WORDS.includes(token.value);if(token.type==="SYMBOL"&&!RESERVED_WORDS.includes(token.value)){if(prevToken){if(groupType==="LEFT_BRACE"&&isLeftSeparator(prevToken)&&isRightSeparator(nextToken)){tokens.splice(i+1,0,{type:"COLON",value:":"},{...token});nextToken=tokens[i+1];}
if(prevToken.type==="OPERATOR"&&prevToken.value==="."){isVar=false;}
else if(prevToken.type==="LEFT_BRACE"||prevToken.type==="COMMA"){if(nextToken&&nextToken.type==="COLON"){isVar=false;}}}}
if(token.type==="TEMPLATE_STRING"){token.value=token.replace((expr)=>compileExpr(expr));}
if(nextToken&&nextToken.type==="OPERATOR"&&nextToken.value==="=>"){if(token.type==="RIGHT_PAREN"){let j=i-1;while(j>0&&tokens[j].type!=="LEFT_PAREN"){if(tokens[j].type==="SYMBOL"&&tokens[j].originalValue){tokens[j].value=tokens[j].originalValue;localVars.add(tokens[j].value);}
j--;}}
else{localVars.add(token.value);}}
if(isVar){token.varName=token.value;if(!localVars.has(token.value)){token.originalValue=token.value;token.value=`ctx['${token.value}']`;}}
i++;}
for(const token of tokens){if(token.type==="SYMBOL"&&token.varName&&localVars.has(token.value)){token.originalValue=token.value;token.value=`_${token.value}`;token.isLocal=true;}}
return tokens;}
const paddedValues=new Map([["in "," in "]]);function compileExpr(expr){return compileExprToArray(expr).map((t)=>paddedValues.get(t.value)||t.value).join("");}
const INTERP_REGEXP=/\{\{.*?\}\}|\#\{.*?\}/g;function replaceDynamicParts(s,replacer){let matches=s.match(INTERP_REGEXP);if(matches&&matches[0].length===s.length){return`(${replacer(s.slice(2, matches[0][0] === "{" ? -2 : -1))})`;}
let r=s.replace(INTERP_REGEXP,(s)=>"${"+replacer(s.slice(2,s[0]==="{"?-2:-1))+"}");return"`"+r+"`";}
function interpolate(s){return replaceDynamicParts(s,compileExpr);}
const whitespaceRE=/\s+/g;const xmlDoc=document.implementation.createDocument(null,null,null);const MODS=new Set(["stop","capture","prevent","self","synthetic"]);let nextDataIds={};function generateId(prefix=""){nextDataIds[prefix]=(nextDataIds[prefix]||0)+1;return prefix+nextDataIds[prefix];}
function isProp(tag,key){switch(tag){case"input":return(key==="checked"||key==="indeterminate"||key==="value"||key==="readonly"||key==="readOnly"||key==="disabled");case"option":return key==="selected"||key==="disabled";case"textarea":return key==="value"||key==="readonly"||key==="readOnly"||key==="disabled";case"select":return key==="value"||key==="disabled";case"button":case"optgroup":return key==="disabled";}
return false;}
function toStringExpression(str){return`\`${str.replace(/\\/g, "\\\\").replace(/`/g,"\\`").replace(/\$\{/,"\\${")}\``;}
class BlockDescription{constructor(target,type){this.dynamicTagName=null;this.isRoot=false;this.hasDynamicChildren=false;this.children=[];this.data=[];this.childNumber=0;this.parentVar="";this.id=BlockDescription.nextBlockId++;this.varName="b"+this.id;this.blockName="block"+this.id;this.target=target;this.type=type;}
insertData(str,prefix="d"){const id=generateId(prefix);this.target.addLine(`let ${id} = ${str};`);return this.data.push(id)-1;}
insert(dom){if(this.currentDom){this.currentDom.appendChild(dom);}
else{this.dom=dom;}}
generateExpr(expr){if(this.type==="block"){const hasChildren=this.children.length;let params=this.data.length?`[${this.data.join(", ")}]`:hasChildren?"[]":"";if(hasChildren){params+=", ["+this.children.map((c)=>c.varName).join(", ")+"]";}
if(this.dynamicTagName){return`toggler(${this.dynamicTagName}, ${this.blockName}(${this.dynamicTagName})(${params}))`;}
return`${this.blockName}(${params})`;}
else if(this.type==="list"){return`list(c_block${this.id})`;}
return expr;}
asXmlString(){const t=xmlDoc.createElement("t");t.appendChild(this.dom);return t.innerHTML;}}
BlockDescription.nextBlockId=1;function createContext(parentCtx,params){return Object.assign({block:null,index:0,forceNewBlock:true,translate:parentCtx.translate,tKeyExpr:null,nameSpace:parentCtx.nameSpace,tModelSelectedExpr:parentCtx.tModelSelectedExpr,},params);}
class CodeTarget{constructor(name,on){this.indentLevel=0;this.loopLevel=0;this.code=[];this.hasRoot=false;this.hasCache=false;this.shouldProtectScope=false;this.hasRefWrapper=false;this.name=name;this.on=on||null;}
addLine(line,idx){const prefix=new Array(this.indentLevel+2).join("  ");if(idx===undefined){this.code.push(prefix+line);}
else{this.code.splice(idx,0,prefix+line);}}
generateCode(){let result=[];result.push(`function ${this.name}(ctx, node, key = "") {`);if(this.shouldProtectScope){result.push(`  ctx = Object.create(ctx);`);result.push(`  ctx[isBoundary] = 1`);}
if(this.hasRefWrapper){result.push(`  let refWrapper = makeRefWrapper(this.__owl__);`);}
if(this.hasCache){result.push(`  let cache = ctx.cache || {};`);result.push(`  let nextCache = ctx.cache = {};`);}
for(let line of this.code){result.push(line);}
if(!this.hasRoot){result.push(`return text('');`);}
result.push(`}`);return result.join("\n  ");}
currentKey(ctx){let key=this.loopLevel?`key${this.loopLevel}`:"key";if(ctx.tKeyExpr){key=`${ctx.tKeyExpr} + ${key}`;}
return key;}}
const TRANSLATABLE_ATTRS=["label","title","placeholder","alt"];const translationRE=/^(\s*)([\s\S]+?)(\s*)$/;class CodeGenerator{constructor(ast,options){this.blocks=[];this.nextBlockId=1;this.isDebug=false;this.targets=[];this.target=new CodeTarget("template");this.translatableAttributes=TRANSLATABLE_ATTRS;this.staticDefs=[];this.slotNames=new Set();this.helpers=new Set();this.translateFn=options.translateFn||((s)=>s);if(options.translatableAttributes){const attrs=new Set(TRANSLATABLE_ATTRS);for(let attr of options.translatableAttributes){if(attr.startsWith("-")){attrs.delete(attr.slice(1));}
else{attrs.add(attr);}}
this.translatableAttributes=[...attrs];}
this.hasSafeContext=options.hasSafeContext||false;this.dev=options.dev||false;this.ast=ast;this.templateName=options.name;}
generateCode(){const ast=this.ast;this.isDebug=ast.type===12;BlockDescription.nextBlockId=1;nextDataIds={};this.compileAST(ast,{block:null,index:0,forceNewBlock:false,isLast:true,translate:true,tKeyExpr:null,});let mainCode=[`  let { text, createBlock, list, multi, html, toggler, comment } = bdom;`];if(this.helpers.size){mainCode.push(`let { ${[...this.helpers].join(", ")} } = helpers;`);}
if(this.templateName){mainCode.push(`// Template name: "${this.templateName}"`);}
for(let{id,expr}of this.staticDefs){mainCode.push(`const ${id} = ${expr};`);}
if(this.blocks.length){mainCode.push(``);for(let block of this.blocks){if(block.dom){let xmlString=toStringExpression(block.asXmlString());if(block.dynamicTagName){xmlString=xmlString.replace(/^`<\w+/,`\`<\${tag || '${block.dom.nodeName}'}`);xmlString=xmlString.replace(/\w+>`$/,`\${tag || '${block.dom.nodeName}'}>\``);mainCode.push(`let ${block.blockName} = tag => createBlock(${xmlString});`);}
else{mainCode.push(`let ${block.blockName} = createBlock(${xmlString});`);}}}}
if(this.targets.length){for(let fn of this.targets){mainCode.push("");mainCode=mainCode.concat(fn.generateCode());}}
mainCode.push("");mainCode=mainCode.concat("return "+this.target.generateCode());const code=mainCode.join("\n  ");if(this.isDebug){const msg=`[Owl Debug]\n${code}`;console.log(msg);}
return code;}
compileInNewTarget(prefix,ast,ctx,on){const name=generateId(prefix);const initialTarget=this.target;const target=new CodeTarget(name,on);this.targets.push(target);this.target=target;this.compileAST(ast,createContext(ctx));this.target=initialTarget;return name;}
addLine(line,idx){this.target.addLine(line,idx);}
define(varName,expr){this.addLine(`const ${varName} = ${expr};`);}
insertAnchor(block,index=block.children.length){const tag=`block-child-${index}`;const anchor=xmlDoc.createElement(tag);block.insert(anchor);}
createBlock(parentBlock,type,ctx){const hasRoot=this.target.hasRoot;const block=new BlockDescription(this.target,type);if(!hasRoot){this.target.hasRoot=true;block.isRoot=true;}
if(parentBlock){parentBlock.children.push(block);if(parentBlock.type==="list"){block.parentVar=`c_block${parentBlock.id}`;}}
return block;}
insertBlock(expression,block,ctx){let blockExpr=block.generateExpr(expression);if(block.parentVar){let key=this.target.currentKey(ctx);this.helpers.add("withKey");this.addLine(`${block.parentVar}[${ctx.index}] = withKey(${blockExpr}, ${key});`);return;}
if(ctx.tKeyExpr){blockExpr=`toggler(${ctx.tKeyExpr}, ${blockExpr})`;}
if(block.isRoot){if(this.target.on){blockExpr=this.wrapWithEventCatcher(blockExpr,this.target.on);}
this.addLine(`return ${blockExpr};`);}
else{this.define(block.varName,blockExpr);}}
captureExpression(expr,forceCapture=false){if(!forceCapture&&!expr.includes("=>")){return compileExpr(expr);}
const tokens=compileExprToArray(expr);const mapping=new Map();return tokens.map((tok)=>{if(tok.varName&&!tok.isLocal){if(!mapping.has(tok.varName)){const varId=generateId("v");mapping.set(tok.varName,varId);this.define(varId,tok.value);}
tok.value=mapping.get(tok.varName);}
return tok.value;}).join("");}
translate(str){const match=translationRE.exec(str);return match[1]+this.translateFn(match[2])+match[3];}
compileAST(ast,ctx){switch(ast.type){case 1:return this.compileComment(ast,ctx);case 0:return this.compileText(ast,ctx);case 2:return this.compileTDomNode(ast,ctx);case 4:return this.compileTEsc(ast,ctx);case 8:return this.compileTOut(ast,ctx);case 5:return this.compileTIf(ast,ctx);case 9:return this.compileTForeach(ast,ctx);case 10:return this.compileTKey(ast,ctx);case 3:return this.compileMulti(ast,ctx);case 7:return this.compileTCall(ast,ctx);case 15:return this.compileTCallBlock(ast,ctx);case 6:return this.compileTSet(ast,ctx);case 11:return this.compileComponent(ast,ctx);case 12:return this.compileDebug(ast,ctx);case 13:return this.compileLog(ast,ctx);case 14:return this.compileTSlot(ast,ctx);case 16:return this.compileTTranslation(ast,ctx);case 17:return this.compileTPortal(ast,ctx);}}
compileDebug(ast,ctx){this.addLine(`debugger;`);if(ast.content){return this.compileAST(ast.content,ctx);}
return null;}
compileLog(ast,ctx){this.addLine(`console.log(${compileExpr(ast.expr)});`);if(ast.content){return this.compileAST(ast.content,ctx);}
return null;}
compileComment(ast,ctx){let{block,forceNewBlock}=ctx;const isNewBlock=!block||forceNewBlock;if(isNewBlock){block=this.createBlock(block,"comment",ctx);this.insertBlock(`comment(${toStringExpression(ast.value)})`,block,{...ctx,forceNewBlock:forceNewBlock&&!block,});}
else{const text=xmlDoc.createComment(ast.value);block.insert(text);}
return block.varName;}
compileText(ast,ctx){let{block,forceNewBlock}=ctx;let value=ast.value;if(value&&ctx.translate!==false){value=this.translate(value);}
if(!ctx.inPreTag){value=value.replace(whitespaceRE," ");}
if(!block||forceNewBlock){block=this.createBlock(block,"text",ctx);this.insertBlock(`text(${toStringExpression(value)})`,block,{...ctx,forceNewBlock:forceNewBlock&&!block,});}
else{const createFn=ast.type===0?xmlDoc.createTextNode:xmlDoc.createComment;block.insert(createFn.call(xmlDoc,value));}
return block.varName;}
generateHandlerCode(rawEvent,handler){const modifiers=rawEvent.split(".").slice(1).map((m)=>{if(!MODS.has(m)){throw new OwlError(`Unknown event modifier: '${m}'`);}
return`"${m}"`;});let modifiersCode="";if(modifiers.length){modifiersCode=`${modifiers.join(",")}, `;}
return`[${modifiersCode}${this.captureExpression(handler)}, ctx]`;}
compileTDomNode(ast,ctx){let{block,forceNewBlock}=ctx;const isNewBlock=!block||forceNewBlock||ast.dynamicTag!==null||ast.ns;let codeIdx=this.target.code.length;if(isNewBlock){if((ast.dynamicTag||ctx.tKeyExpr||ast.ns)&&ctx.block){this.insertAnchor(ctx.block);}
block=this.createBlock(block,"block",ctx);this.blocks.push(block);if(ast.dynamicTag){const tagExpr=generateId("tag");this.define(tagExpr,compileExpr(ast.dynamicTag));block.dynamicTagName=tagExpr;}}
const attrs={};for(let key in ast.attrs){let expr,attrName;if(key.startsWith("t-attf")){expr=interpolate(ast.attrs[key]);const idx=block.insertData(expr,"attr");attrName=key.slice(7);attrs["block-attribute-"+idx]=attrName;}
else if(key.startsWith("t-att")){attrName=key==="t-att"?null:key.slice(6);expr=compileExpr(ast.attrs[key]);if(attrName&&isProp(ast.tag,attrName)){if(attrName==="readonly"){attrName="readOnly";}
if(attrName==="value"){expr=`new String((${expr}) === 0 ? 0 : ((${expr}) || ""))`;}
else{expr=`new Boolean(${expr})`;}
const idx=block.insertData(expr,"prop");attrs[`block-property-${idx}`]=attrName;}
else{const idx=block.insertData(expr,"attr");if(key==="t-att"){attrs[`block-attributes`]=String(idx);}
else{attrs[`block-attribute-${idx}`]=attrName;}}}
else if(this.translatableAttributes.includes(key)){attrs[key]=this.translateFn(ast.attrs[key]);}
else{expr=`"${ast.attrs[key]}"`;attrName=key;attrs[key]=ast.attrs[key];}
if(attrName==="value"&&ctx.tModelSelectedExpr){let selectedId=block.insertData(`${ctx.tModelSelectedExpr} === ${expr}`,"attr");attrs[`block-attribute-${selectedId}`]="selected";}}
let tModelSelectedExpr;if(ast.model){const{hasDynamicChildren,baseExpr,expr,eventType,shouldNumberize,shouldTrim,targetAttr,specialInitTargetAttr,}=ast.model;const baseExpression=compileExpr(baseExpr);const bExprId=generateId("bExpr");this.define(bExprId,baseExpression);const expression=compileExpr(expr);const exprId=generateId("expr");this.define(exprId,expression);const fullExpression=`${bExprId}[${exprId}]`;let idx;if(specialInitTargetAttr){let targetExpr=targetAttr in attrs&&`'${attrs[targetAttr]}'`;if(!targetExpr&&ast.attrs){const dynamicTgExpr=ast.attrs[`t-att-${targetAttr}`];if(dynamicTgExpr){targetExpr=compileExpr(dynamicTgExpr);}}
idx=block.insertData(`${fullExpression} === ${targetExpr}`,"prop");attrs[`block-property-${idx}`]=specialInitTargetAttr;}
else if(hasDynamicChildren){const bValueId=generateId("bValue");tModelSelectedExpr=`${bValueId}`;this.define(tModelSelectedExpr,fullExpression);}
else{idx=block.insertData(`${fullExpression}`,"prop");attrs[`block-property-${idx}`]=targetAttr;}
this.helpers.add("toNumber");let valueCode=`ev.target.${targetAttr}`;valueCode=shouldTrim?`${valueCode}.trim()`:valueCode;valueCode=shouldNumberize?`toNumber(${valueCode})`:valueCode;const handler=`[(ev) => { ${fullExpression} = ${valueCode}; }]`;idx=block.insertData(handler,"hdlr");attrs[`block-handler-${idx}`]=eventType;}
for(let ev in ast.on){const name=this.generateHandlerCode(ev,ast.on[ev]);const idx=block.insertData(name,"hdlr");attrs[`block-handler-${idx}`]=ev;}
if(ast.ref){if(this.dev){this.helpers.add("makeRefWrapper");this.target.hasRefWrapper=true;}
const isDynamic=INTERP_REGEXP.test(ast.ref);let name=`\`${ast.ref}\``;if(isDynamic){name=replaceDynamicParts(ast.ref,(expr)=>this.captureExpression(expr,true));}
let setRefStr=`(el) => this.__owl__.setRef((${name}), el)`;if(this.dev){setRefStr=`refWrapper(${name}, ${setRefStr})`;}
const idx=block.insertData(setRefStr,"ref");attrs["block-ref"]=String(idx);}
const nameSpace=ast.ns||ctx.nameSpace;const dom=nameSpace?xmlDoc.createElementNS(nameSpace,ast.tag):xmlDoc.createElement(ast.tag);for(const[attr,val]of Object.entries(attrs)){if(!(attr==="class"&&val==="")){dom.setAttribute(attr,val);}}
block.insert(dom);if(ast.content.length){const initialDom=block.currentDom;block.currentDom=dom;const children=ast.content;for(let i=0;i<children.length;i++){const child=ast.content[i];const subCtx=createContext(ctx,{block,index:block.childNumber,forceNewBlock:false,isLast:ctx.isLast&&i===children.length-1,tKeyExpr:ctx.tKeyExpr,nameSpace,tModelSelectedExpr,inPreTag:ctx.inPreTag||ast.tag==="pre",});this.compileAST(child,subCtx);}
block.currentDom=initialDom;}
if(isNewBlock){this.insertBlock(`${block.blockName}(ddd)`,block,ctx);if(block.children.length&&block.hasDynamicChildren){const code=this.target.code;const children=block.children.slice();let current=children.shift();for(let i=codeIdx;i<code.length;i++){if(code[i].trimStart().startsWith(`const ${current.varName} `)){code[i]=code[i].replace(`const ${current.varName}`,current.varName);current=children.shift();if(!current)
break;}}
this.addLine(`let ${block.children.map((c) => c.varName).join(", ")};`,codeIdx);}}
return block.varName;}
compileTEsc(ast,ctx){let{block,forceNewBlock}=ctx;let expr;if(ast.expr==="0"){this.helpers.add("zero");expr=`ctx[zero]`;}
else{expr=compileExpr(ast.expr);if(ast.defaultValue){this.helpers.add("withDefault");expr=`withDefault(${expr}, ${toStringExpression(ast.defaultValue)})`;}}
if(!block||forceNewBlock){block=this.createBlock(block,"text",ctx);this.insertBlock(`text(${expr})`,block,{...ctx,forceNewBlock:forceNewBlock&&!block});}
else{const idx=block.insertData(expr,"txt");const text=xmlDoc.createElement(`block-text-${idx}`);block.insert(text);}
return block.varName;}
compileTOut(ast,ctx){let{block}=ctx;if(block){this.insertAnchor(block);}
block=this.createBlock(block,"html",ctx);let blockStr;if(ast.expr==="0"){this.helpers.add("zero");blockStr=`ctx[zero]`;}
else if(ast.body){let bodyValue=null;bodyValue=BlockDescription.nextBlockId;const subCtx=createContext(ctx);this.compileAST({type:3,content:ast.body},subCtx);this.helpers.add("safeOutput");blockStr=`safeOutput(${compileExpr(ast.expr)}, b${bodyValue})`;}
else{this.helpers.add("safeOutput");blockStr=`safeOutput(${compileExpr(ast.expr)})`;}
this.insertBlock(blockStr,block,ctx);return block.varName;}
compileTIfBranch(content,block,ctx){this.target.indentLevel++;let childN=block.children.length;this.compileAST(content,createContext(ctx,{block,index:ctx.index}));if(block.children.length>childN){this.insertAnchor(block,childN);}
this.target.indentLevel--;}
compileTIf(ast,ctx,nextNode){let{block,forceNewBlock}=ctx;const codeIdx=this.target.code.length;const isNewBlock=!block||(block.type!=="multi"&&forceNewBlock);if(block){block.hasDynamicChildren=true;}
if(!block||(block.type!=="multi"&&forceNewBlock)){block=this.createBlock(block,"multi",ctx);}
this.addLine(`if (${compileExpr(ast.condition)}) {`);this.compileTIfBranch(ast.content,block,ctx);if(ast.tElif){for(let clause of ast.tElif){this.addLine(`} else if (${compileExpr(clause.condition)}) {`);this.compileTIfBranch(clause.content,block,ctx);}}
if(ast.tElse){this.addLine(`} else {`);this.compileTIfBranch(ast.tElse,block,ctx);}
this.addLine("}");if(isNewBlock){if(block.children.length){const code=this.target.code;const children=block.children.slice();let current=children.shift();for(let i=codeIdx;i<code.length;i++){if(code[i].trimStart().startsWith(`const ${current.varName} `)){code[i]=code[i].replace(`const ${current.varName}`,current.varName);current=children.shift();if(!current)
break;}}
this.addLine(`let ${block.children.map((c) => c.varName).join(", ")};`,codeIdx);}
const args=block.children.map((c)=>c.varName).join(", ");this.insertBlock(`multi([${args}])`,block,ctx);}
return block.varName;}
compileTForeach(ast,ctx){let{block}=ctx;if(block){this.insertAnchor(block);}
block=this.createBlock(block,"list",ctx);this.target.loopLevel++;const loopVar=`i${this.target.loopLevel}`;this.addLine(`ctx = Object.create(ctx);`);const vals=`v_block${block.id}`;const keys=`k_block${block.id}`;const l=`l_block${block.id}`;const c=`c_block${block.id}`;this.helpers.add("prepareList");this.define(`[${keys}, ${vals}, ${l}, ${c}]`,`prepareList(${compileExpr(ast.collection)});`);if(this.dev){this.define(`keys${block.id}`,`new Set()`);}
this.addLine(`for (let ${loopVar} = 0; ${loopVar} < ${l}; ${loopVar}++) {`);this.target.indentLevel++;this.addLine(`ctx[\`${ast.elem}\`] = ${keys}[${loopVar}];`);if(!ast.hasNoFirst){this.addLine(`ctx[\`${ast.elem}_first\`] = ${loopVar} === 0;`);}
if(!ast.hasNoLast){this.addLine(`ctx[\`${ast.elem}_last\`] = ${loopVar} === ${keys}.length - 1;`);}
if(!ast.hasNoIndex){this.addLine(`ctx[\`${ast.elem}_index\`] = ${loopVar};`);}
if(!ast.hasNoValue){this.addLine(`ctx[\`${ast.elem}_value\`] = ${vals}[${loopVar}];`);}
this.define(`key${this.target.loopLevel}`,ast.key?compileExpr(ast.key):loopVar);if(this.dev){this.helpers.add("OwlError");this.addLine(`if (keys${block.id}.has(String(key${this.target.loopLevel}))) { throw new OwlError(\`Got duplicate key in t-foreach: \${key${this.target.loopLevel}}\`)}`);this.addLine(`keys${block.id}.add(String(key${this.target.loopLevel}));`);}
let id;if(ast.memo){this.target.hasCache=true;id=generateId();this.define(`memo${id}`,compileExpr(ast.memo));this.define(`vnode${id}`,`cache[key${this.target.loopLevel}];`);this.addLine(`if (vnode${id}) {`);this.target.indentLevel++;this.addLine(`if (shallowEqual(vnode${id}.memo, memo${id})) {`);this.target.indentLevel++;this.addLine(`${c}[${loopVar}] = vnode${id};`);this.addLine(`nextCache[key${this.target.loopLevel}] = vnode${id};`);this.addLine(`continue;`);this.target.indentLevel--;this.addLine("}");this.target.indentLevel--;this.addLine("}");}
const subCtx=createContext(ctx,{block,index:loopVar});this.compileAST(ast.body,subCtx);if(ast.memo){this.addLine(`nextCache[key${this.target.loopLevel}] = Object.assign(${c}[${loopVar}], {memo: memo${id}});`);}
this.target.indentLevel--;this.target.loopLevel--;this.addLine(`}`);if(!ctx.isLast){this.addLine(`ctx = ctx.__proto__;`);}
this.insertBlock("l",block,ctx);return block.varName;}
compileTKey(ast,ctx){const tKeyExpr=generateId("tKey_");this.define(tKeyExpr,compileExpr(ast.expr));ctx=createContext(ctx,{tKeyExpr,block:ctx.block,index:ctx.index,});return this.compileAST(ast.content,ctx);}
compileMulti(ast,ctx){let{block,forceNewBlock}=ctx;const isNewBlock=!block||forceNewBlock;let codeIdx=this.target.code.length;if(isNewBlock){const n=ast.content.filter((c)=>c.type!==6).length;let result=null;if(n<=1){for(let child of ast.content){const blockName=this.compileAST(child,ctx);result=result||blockName;}
return result;}
block=this.createBlock(block,"multi",ctx);}
let index=0;for(let i=0,l=ast.content.length;i<l;i++){const child=ast.content[i];const isTSet=child.type===6;const subCtx=createContext(ctx,{block,index,forceNewBlock:!isTSet,isLast:ctx.isLast&&i===l-1,});this.compileAST(child,subCtx);if(!isTSet){index++;}}
if(isNewBlock){if(block.hasDynamicChildren&&block.children.length){const code=this.target.code;const children=block.children.slice();let current=children.shift();for(let i=codeIdx;i<code.length;i++){if(code[i].trimStart().startsWith(`const ${current.varName} `)){code[i]=code[i].replace(`const ${current.varName}`,current.varName);current=children.shift();if(!current)
break;}}
this.addLine(`let ${block.children.map((c) => c.varName).join(", ")};`,codeIdx);}
const args=block.children.map((c)=>c.varName).join(", ");this.insertBlock(`multi([${args}])`,block,ctx);}
return block.varName;}
compileTCall(ast,ctx){let{block,forceNewBlock}=ctx;let ctxVar=ctx.ctxVar||"ctx";if(ast.context){ctxVar=generateId("ctx");this.addLine(`let ${ctxVar} = ${compileExpr(ast.context)};`);}
const isDynamic=INTERP_REGEXP.test(ast.name);const subTemplate=isDynamic?interpolate(ast.name):"`"+ast.name+"`";if(block&&!forceNewBlock){this.insertAnchor(block);}
block=this.createBlock(block,"multi",ctx);if(ast.body){this.addLine(`${ctxVar} = Object.create(${ctxVar});`);this.addLine(`${ctxVar}[isBoundary] = 1;`);this.helpers.add("isBoundary");const subCtx=createContext(ctx,{ctxVar});const bl=this.compileMulti({type:3,content:ast.body},subCtx);if(bl){this.helpers.add("zero");this.addLine(`${ctxVar}[zero] = ${bl};`);}}
const key=this.generateComponentKey();if(isDynamic){const templateVar=generateId("template");if(!this.staticDefs.find((d)=>d.id==="call")){this.staticDefs.push({id:"call",expr:`app.callTemplate.bind(app)`});}
this.define(templateVar,subTemplate);this.insertBlock(`call(this, ${templateVar}, ${ctxVar}, node, ${key})`,block,{...ctx,forceNewBlock:!block,});}
else{const id=generateId(`callTemplate_`);this.staticDefs.push({id,expr:`app.getTemplate(${subTemplate})`});this.insertBlock(`${id}.call(this, ${ctxVar}, node, ${key})`,block,{...ctx,forceNewBlock:!block,});}
if(ast.body&&!ctx.isLast){this.addLine(`${ctxVar} = ${ctxVar}.__proto__;`);}
return block.varName;}
compileTCallBlock(ast,ctx){let{block,forceNewBlock}=ctx;if(block){if(!forceNewBlock){this.insertAnchor(block);}}
block=this.createBlock(block,"multi",ctx);this.insertBlock(compileExpr(ast.name),block,{...ctx,forceNewBlock:!block});return block.varName;}
compileTSet(ast,ctx){this.target.shouldProtectScope=true;this.helpers.add("isBoundary").add("withDefault");const expr=ast.value?compileExpr(ast.value||""):"null";if(ast.body){this.helpers.add("LazyValue");const bodyAst={type:3,content:ast.body};const name=this.compileInNewTarget("value",bodyAst,ctx);let key=this.target.currentKey(ctx);let value=`new LazyValue(${name}, ctx, this, node, ${key})`;value=ast.value?(value?`withDefault(${expr}, ${value})`:expr):value;this.addLine(`ctx[\`${ast.name}\`] = ${value};`);}
else{let value;if(ast.defaultValue){const defaultValue=toStringExpression(ctx.translate?this.translate(ast.defaultValue):ast.defaultValue);if(ast.value){value=`withDefault(${expr}, ${defaultValue})`;}
else{value=defaultValue;}}
else{value=expr;}
this.helpers.add("setContextValue");this.addLine(`setContextValue(${ctx.ctxVar || "ctx"}, "${ast.name}", ${value});`);}
return null;}
generateComponentKey(currentKey="key"){const parts=[generateId("__")];for(let i=0;i<this.target.loopLevel;i++){parts.push(`\${key${i + 1}}`);}
return`${currentKey} + \`${parts.join("__")}\``;}
formatProp(name,value){value=this.captureExpression(value);if(name.includes(".")){let[_name,suffix]=name.split(".");name=_name;switch(suffix){case"bind":value=`(${value}).bind(this)`;break;case"alike":break;default:throw new OwlError("Invalid prop suffix");}}
name=/^[a-z_]+$/i.test(name)?name:`'${name}'`;return`${name}: ${value || undefined}`;}
formatPropObject(obj){return Object.entries(obj).map(([k,v])=>this.formatProp(k,v));}
getPropString(props,dynProps){let propString=`{${props.join(",")}}`;if(dynProps){propString=`Object.assign({}, ${compileExpr(dynProps)}${props.length ? ", " + propString : ""})`;}
return propString;}
compileComponent(ast,ctx){let{block}=ctx;const hasSlotsProp="slots"in(ast.props||{});const props=ast.props?this.formatPropObject(ast.props):[];let slotDef="";if(ast.slots){let ctxStr="ctx";if(this.target.loopLevel||!this.hasSafeContext){ctxStr=generateId("ctx");this.helpers.add("capture");this.define(ctxStr,`capture(ctx)`);}
let slotStr=[];for(let slotName in ast.slots){const slotAst=ast.slots[slotName];const params=[];if(slotAst.content){const name=this.compileInNewTarget("slot",slotAst.content,ctx,slotAst.on);params.push(`__render: ${name}.bind(this), __ctx: ${ctxStr}`);}
const scope=ast.slots[slotName].scope;if(scope){params.push(`__scope: "${scope}"`);}
if(ast.slots[slotName].attrs){params.push(...this.formatPropObject(ast.slots[slotName].attrs));}
const slotInfo=`{${params.join(", ")}}`;slotStr.push(`'${slotName}': ${slotInfo}`);}
slotDef=`{${slotStr.join(", ")}}`;}
if(slotDef&&!(ast.dynamicProps||hasSlotsProp)){this.helpers.add("markRaw");props.push(`slots: markRaw(${slotDef})`);}
let propString=this.getPropString(props,ast.dynamicProps);let propVar;if((slotDef&&(ast.dynamicProps||hasSlotsProp))||this.dev){propVar=generateId("props");this.define(propVar,propString);propString=propVar;}
if(slotDef&&(ast.dynamicProps||hasSlotsProp)){this.helpers.add("markRaw");this.addLine(`${propVar}.slots = markRaw(Object.assign(${slotDef}, ${propVar}.slots))`);}
let expr;if(ast.isDynamic){expr=generateId("Comp");this.define(expr,compileExpr(ast.name));}
else{expr=`\`${ast.name}\``;}
if(this.dev){this.addLine(`helpers.validateProps(${expr}, ${propVar}, this);`);}
if(block&&(ctx.forceNewBlock===false||ctx.tKeyExpr)){this.insertAnchor(block);}
let keyArg=this.generateComponentKey();if(ctx.tKeyExpr){keyArg=`${ctx.tKeyExpr} + ${keyArg}`;}
let id=generateId("comp");const propList=[];for(let p in ast.props||{}){let[name,suffix]=p.split(".");if(!suffix){propList.push(`"${name}"`);}}
this.staticDefs.push({id,expr:`app.createComponent(${ast.isDynamic ? null : expr}, ${!ast.isDynamic}, ${!!ast.slots}, ${!!ast.dynamicProps}, [${propList}])`,});if(ast.isDynamic){keyArg=`(${expr}).name + ${keyArg}`;}
let blockExpr=`${id}(${propString}, ${keyArg}, node, this, ${ast.isDynamic ? expr : null})`;if(ast.isDynamic){blockExpr=`toggler(${expr}, ${blockExpr})`;}
if(ast.on){blockExpr=this.wrapWithEventCatcher(blockExpr,ast.on);}
block=this.createBlock(block,"multi",ctx);this.insertBlock(blockExpr,block,ctx);return block.varName;}
wrapWithEventCatcher(expr,on){this.helpers.add("createCatcher");let name=generateId("catcher");let spec={};let handlers=[];for(let ev in on){let handlerId=generateId("hdlr");let idx=handlers.push(handlerId)-1;spec[ev]=idx;const handler=this.generateHandlerCode(ev,on[ev]);this.define(handlerId,handler);}
this.staticDefs.push({id:name,expr:`createCatcher(${JSON.stringify(spec)})`});return`${name}(${expr}, [${handlers.join(",")}])`;}
compileTSlot(ast,ctx){this.helpers.add("callSlot");let{block}=ctx;let blockString;let slotName;let dynamic=false;let isMultiple=false;if(ast.name.match(INTERP_REGEXP)){dynamic=true;isMultiple=true;slotName=interpolate(ast.name);}
else{slotName="'"+ast.name+"'";isMultiple=isMultiple||this.slotNames.has(ast.name);this.slotNames.add(ast.name);}
const dynProps=ast.attrs?ast.attrs["t-props"]:null;if(ast.attrs){delete ast.attrs["t-props"];}
let key=this.target.loopLevel?`key${this.target.loopLevel}`:"key";if(isMultiple){key=this.generateComponentKey(key);}
const props=ast.attrs?this.formatPropObject(ast.attrs):[];const scope=this.getPropString(props,dynProps);if(ast.defaultContent){const name=this.compileInNewTarget("defaultContent",ast.defaultContent,ctx);blockString=`callSlot(ctx, node, ${key}, ${slotName}, ${dynamic}, ${scope}, ${name}.bind(this))`;}
else{if(dynamic){let name=generateId("slot");this.define(name,slotName);blockString=`toggler(${name}, callSlot(ctx, node, ${key}, ${name}, ${dynamic}, ${scope}))`;}
else{blockString=`callSlot(ctx, node, ${key}, ${slotName}, ${dynamic}, ${scope})`;}}
if(ast.on){blockString=this.wrapWithEventCatcher(blockString,ast.on);}
if(block){this.insertAnchor(block);}
block=this.createBlock(block,"multi",ctx);this.insertBlock(blockString,block,{...ctx,forceNewBlock:false});return block.varName;}
compileTTranslation(ast,ctx){if(ast.content){return this.compileAST(ast.content,Object.assign({},ctx,{translate:false}));}
return null;}
compileTPortal(ast,ctx){if(!this.staticDefs.find((d)=>d.id==="Portal")){this.staticDefs.push({id:"Portal",expr:`app.Portal`});}
let{block}=ctx;const name=this.compileInNewTarget("slot",ast.content,ctx);let ctxStr="ctx";if(this.target.loopLevel||!this.hasSafeContext){ctxStr=generateId("ctx");this.helpers.add("capture");this.define(ctxStr,`capture(ctx)`);}
let id=generateId("comp");this.staticDefs.push({id,expr:`app.createComponent(null, false, true, false, false)`,});const target=compileExpr(ast.target);const key=this.generateComponentKey();const blockString=`${id}({target: ${target},slots: {'default': {__render: ${name}.bind(this), __ctx: ${ctxStr}}}}, ${key}, node, ctx, Portal)`;if(block){this.insertAnchor(block);}
block=this.createBlock(block,"multi",ctx);this.insertBlock(blockString,block,{...ctx,forceNewBlock:false});return block.varName;}}
const cache=new WeakMap();function parse(xml){if(typeof xml==="string"){const elem=parseXML(`<t>${xml}</t>`).firstChild;return _parse(elem);}
let ast=cache.get(xml);if(!ast){ast=_parse(xml.cloneNode(true));cache.set(xml,ast);}
return ast;}
function _parse(xml){normalizeXML(xml);const ctx={inPreTag:false};return parseNode(xml,ctx)||{type:0,value:""};}
function parseNode(node,ctx){if(!(node instanceof Element)){return parseTextCommentNode(node,ctx);}
return(parseTDebugLog(node,ctx)||parseTForEach(node,ctx)||parseTIf(node,ctx)||parseTPortal(node,ctx)||parseTCall(node,ctx)||parseTCallBlock(node)||parseTEscNode(node,ctx)||parseTOutNode(node,ctx)||parseTKey(node,ctx)||parseTTranslation(node,ctx)||parseTSlot(node,ctx)||parseComponent(node,ctx)||parseDOMNode(node,ctx)||parseTSetNode(node,ctx)||parseTNode(node,ctx));}
function parseTNode(node,ctx){if(node.tagName!=="t"){return null;}
return parseChildNodes(node,ctx);}
const lineBreakRE=/[\r\n]/;function parseTextCommentNode(node,ctx){if(node.nodeType===Node.TEXT_NODE){let value=node.textContent||"";if(!ctx.inPreTag&&lineBreakRE.test(value)&&!value.trim()){return null;}
return{type:0,value};}
else if(node.nodeType===Node.COMMENT_NODE){return{type:1,value:node.textContent||""};}
return null;}
function parseTDebugLog(node,ctx){if(node.hasAttribute("t-debug")){node.removeAttribute("t-debug");return{type:12,content:parseNode(node,ctx),};}
if(node.hasAttribute("t-log")){const expr=node.getAttribute("t-log");node.removeAttribute("t-log");return{type:13,expr,content:parseNode(node,ctx),};}
return null;}
const hasDotAtTheEnd=/\.[\w_]+\s*$/;const hasBracketsAtTheEnd=/\[[^\[]+\]\s*$/;const ROOT_SVG_TAGS=new Set(["svg","g","path"]);function parseDOMNode(node,ctx){const{tagName}=node;const dynamicTag=node.getAttribute("t-tag");node.removeAttribute("t-tag");if(tagName==="t"&&!dynamicTag){return null;}
if(tagName.startsWith("block-")){throw new OwlError(`Invalid tag name: '${tagName}'`);}
ctx=Object.assign({},ctx);if(tagName==="pre"){ctx.inPreTag=true;}
let ns=!ctx.nameSpace&&ROOT_SVG_TAGS.has(tagName)?"http://www.w3.org/2000/svg":null;const ref=node.getAttribute("t-ref");node.removeAttribute("t-ref");const nodeAttrsNames=node.getAttributeNames();let attrs=null;let on=null;let model=null;for(let attr of nodeAttrsNames){const value=node.getAttribute(attr);if(attr==="t-on"||attr==="t-on-"){throw new OwlError("Missing event name with t-on directive");}
if(attr.startsWith("t-on-")){on=on||{};on[attr.slice(5)]=value;}
else if(attr.startsWith("t-model")){if(!["input","select","textarea"].includes(tagName)){throw new OwlError("The t-model directive only works with <input>, <textarea> and <select>");}
let baseExpr,expr;if(hasDotAtTheEnd.test(value)){const index=value.lastIndexOf(".");baseExpr=value.slice(0,index);expr=`'${value.slice(index + 1)}'`;}
else if(hasBracketsAtTheEnd.test(value)){const index=value.lastIndexOf("[");baseExpr=value.slice(0,index);expr=value.slice(index+1,-1);}
else{throw new OwlError(`Invalid t-model expression: "${value}" (it should be assignable)`);}
const typeAttr=node.getAttribute("type");const isInput=tagName==="input";const isSelect=tagName==="select";const isCheckboxInput=isInput&&typeAttr==="checkbox";const isRadioInput=isInput&&typeAttr==="radio";const hasTrimMod=attr.includes(".trim");const hasLazyMod=hasTrimMod||attr.includes(".lazy");const hasNumberMod=attr.includes(".number");const eventType=isRadioInput?"click":isSelect||hasLazyMod?"change":"input";model={baseExpr,expr,targetAttr:isCheckboxInput?"checked":"value",specialInitTargetAttr:isRadioInput?"checked":null,eventType,hasDynamicChildren:false,shouldTrim:hasTrimMod,shouldNumberize:hasNumberMod,};if(isSelect){ctx=Object.assign({},ctx);ctx.tModelInfo=model;}}
else if(attr.startsWith("block-")){throw new OwlError(`Invalid attribute: '${attr}'`);}
else if(attr==="xmlns"){ns=value;}
else if(attr!=="t-name"){if(attr.startsWith("t-")&&!attr.startsWith("t-att")){throw new OwlError(`Unknown QWeb directive: '${attr}'`);}
const tModel=ctx.tModelInfo;if(tModel&&["t-att-value","t-attf-value"].includes(attr)){tModel.hasDynamicChildren=true;}
attrs=attrs||{};attrs[attr]=value;}}
if(ns){ctx.nameSpace=ns;}
const children=parseChildren(node,ctx);return{type:2,tag:tagName,dynamicTag,attrs,on,ref,content:children,model,ns,};}
function parseTEscNode(node,ctx){if(!node.hasAttribute("t-esc")){return null;}
const escValue=node.getAttribute("t-esc");node.removeAttribute("t-esc");const tesc={type:4,expr:escValue,defaultValue:node.textContent||"",};let ref=node.getAttribute("t-ref");node.removeAttribute("t-ref");const ast=parseNode(node,ctx);if(!ast){return tesc;}
if(ast.type===2){return{...ast,ref,content:[tesc],};}
return tesc;}
function parseTOutNode(node,ctx){if(!node.hasAttribute("t-out")&&!node.hasAttribute("t-raw")){return null;}
if(node.hasAttribute("t-raw")){console.warn(`t-raw has been deprecated in favor of t-out. If the value to render is not wrapped by the "markup" function, it will be escaped`);}
const expr=(node.getAttribute("t-out")||node.getAttribute("t-raw"));node.removeAttribute("t-out");node.removeAttribute("t-raw");const tOut={type:8,expr,body:null};const ref=node.getAttribute("t-ref");node.removeAttribute("t-ref");const ast=parseNode(node,ctx);if(!ast){return tOut;}
if(ast.type===2){tOut.body=ast.content.length?ast.content:null;return{...ast,ref,content:[tOut],};}
return tOut;}
function parseTForEach(node,ctx){if(!node.hasAttribute("t-foreach")){return null;}
const html=node.outerHTML;const collection=node.getAttribute("t-foreach");node.removeAttribute("t-foreach");const elem=node.getAttribute("t-as")||"";node.removeAttribute("t-as");const key=node.getAttribute("t-key");if(!key){throw new OwlError(`"Directive t-foreach should always be used with a t-key!" (expression: t-foreach="${collection}" t-as="${elem}")`);}
node.removeAttribute("t-key");const memo=node.getAttribute("t-memo")||"";node.removeAttribute("t-memo");const body=parseNode(node,ctx);if(!body){return null;}
const hasNoTCall=!html.includes("t-call");const hasNoFirst=hasNoTCall&&!html.includes(`${elem}_first`);const hasNoLast=hasNoTCall&&!html.includes(`${elem}_last`);const hasNoIndex=hasNoTCall&&!html.includes(`${elem}_index`);const hasNoValue=hasNoTCall&&!html.includes(`${elem}_value`);return{type:9,collection,elem,body,memo,key,hasNoFirst,hasNoLast,hasNoIndex,hasNoValue,};}
function parseTKey(node,ctx){if(!node.hasAttribute("t-key")){return null;}
const key=node.getAttribute("t-key");node.removeAttribute("t-key");const body=parseNode(node,ctx);if(!body){return null;}
return{type:10,expr:key,content:body};}
function parseTCall(node,ctx){if(!node.hasAttribute("t-call")){return null;}
const subTemplate=node.getAttribute("t-call");const context=node.getAttribute("t-call-context");node.removeAttribute("t-call");node.removeAttribute("t-call-context");if(node.tagName!=="t"){const ast=parseNode(node,ctx);const tcall={type:7,name:subTemplate,body:null,context};if(ast&&ast.type===2){ast.content=[tcall];return ast;}
if(ast&&ast.type===11){return{...ast,slots:{default:{content:tcall,scope:null,on:null,attrs:null}},};}}
const body=parseChildren(node,ctx);return{type:7,name:subTemplate,body:body.length?body:null,context,};}
function parseTCallBlock(node,ctx){if(!node.hasAttribute("t-call-block")){return null;}
const name=node.getAttribute("t-call-block");return{type:15,name,};}
function parseTIf(node,ctx){if(!node.hasAttribute("t-if")){return null;}
const condition=node.getAttribute("t-if");node.removeAttribute("t-if");const content=parseNode(node,ctx)||{type:0,value:""};let nextElement=node.nextElementSibling;const tElifs=[];while(nextElement&&nextElement.hasAttribute("t-elif")){const condition=nextElement.getAttribute("t-elif");nextElement.removeAttribute("t-elif");const tElif=parseNode(nextElement,ctx);const next=nextElement.nextElementSibling;nextElement.remove();nextElement=next;if(tElif){tElifs.push({condition,content:tElif});}}
let tElse=null;if(nextElement&&nextElement.hasAttribute("t-else")){nextElement.removeAttribute("t-else");tElse=parseNode(nextElement,ctx);nextElement.remove();}
return{type:5,condition,content,tElif:tElifs.length?tElifs:null,tElse,};}
function parseTSetNode(node,ctx){if(!node.hasAttribute("t-set")){return null;}
const name=node.getAttribute("t-set");const value=node.getAttribute("t-value")||null;const defaultValue=node.innerHTML===node.textContent?node.textContent||null:null;let body=null;if(node.textContent!==node.innerHTML){body=parseChildren(node,ctx);}
return{type:6,name,value,defaultValue,body};}
const directiveErrorMap=new Map([["t-ref","t-ref is no longer supported on components. Consider exposing only the public part of the component's API through a callback prop.",],["t-att","t-att makes no sense on component: props are already treated as expressions"],["t-attf","t-attf is not supported on components: use template strings for string interpolation in props",],]);function parseComponent(node,ctx){let name=node.tagName;const firstLetter=name[0];let isDynamic=node.hasAttribute("t-component");if(isDynamic&&name!=="t"){throw new OwlError(`Directive 't-component' can only be used on <t> nodes (used on a <${name}>)`);}
if(!(firstLetter===firstLetter.toUpperCase()||isDynamic)){return null;}
if(isDynamic){name=node.getAttribute("t-component");node.removeAttribute("t-component");}
const dynamicProps=node.getAttribute("t-props");node.removeAttribute("t-props");const defaultSlotScope=node.getAttribute("t-slot-scope");node.removeAttribute("t-slot-scope");let on=null;let props=null;for(let name of node.getAttributeNames()){const value=node.getAttribute(name);if(name.startsWith("t-")){if(name.startsWith("t-on-")){on=on||{};on[name.slice(5)]=value;}
else{const message=directiveErrorMap.get(name.split("-").slice(0,2).join("-"));throw new OwlError(message||`unsupported directive on Component: ${name}`);}}
else{props=props||{};props[name]=value;}}
let slots=null;if(node.hasChildNodes()){const clone=node.cloneNode(true);const slotNodes=Array.from(clone.querySelectorAll("[t-set-slot]"));for(let slotNode of slotNodes){if(slotNode.tagName!=="t"){throw new OwlError(`Directive 't-set-slot' can only be used on <t> nodes (used on a <${slotNode.tagName}>)`);}
const name=slotNode.getAttribute("t-set-slot");let el=slotNode.parentElement;let isInSubComponent=false;while(el&&el!==clone){if(el.hasAttribute("t-component")||el.tagName[0]===el.tagName[0].toUpperCase()){isInSubComponent=true;break;}
el=el.parentElement;}
if(isInSubComponent||!el){continue;}
slotNode.removeAttribute("t-set-slot");slotNode.remove();const slotAst=parseNode(slotNode,ctx);let on=null;let attrs=null;let scope=null;for(let attributeName of slotNode.getAttributeNames()){const value=slotNode.getAttribute(attributeName);if(attributeName==="t-slot-scope"){scope=value;continue;}
else if(attributeName.startsWith("t-on-")){on=on||{};on[attributeName.slice(5)]=value;}
else{attrs=attrs||{};attrs[attributeName]=value;}}
slots=slots||{};slots[name]={content:slotAst,on,attrs,scope};}
const defaultContent=parseChildNodes(clone,ctx);slots=slots||{};if(defaultContent&&!slots.default){slots.default={content:defaultContent,on,attrs:null,scope:defaultSlotScope};}}
return{type:11,name,isDynamic,dynamicProps,props,slots,on};}
function parseTSlot(node,ctx){if(!node.hasAttribute("t-slot")){return null;}
const name=node.getAttribute("t-slot");node.removeAttribute("t-slot");let attrs=null;let on=null;for(let attributeName of node.getAttributeNames()){const value=node.getAttribute(attributeName);if(attributeName.startsWith("t-on-")){on=on||{};on[attributeName.slice(5)]=value;}
else{attrs=attrs||{};attrs[attributeName]=value;}}
return{type:14,name,attrs,on,defaultContent:parseChildNodes(node,ctx),};}
function parseTTranslation(node,ctx){if(node.getAttribute("t-translation")!=="off"){return null;}
node.removeAttribute("t-translation");return{type:16,content:parseNode(node,ctx),};}
function parseTPortal(node,ctx){if(!node.hasAttribute("t-portal")){return null;}
const target=node.getAttribute("t-portal");node.removeAttribute("t-portal");const content=parseNode(node,ctx);if(!content){return{type:0,value:"",};}
return{type:17,target,content,};}
function parseChildren(node,ctx){const children=[];for(let child of node.childNodes){const childAst=parseNode(child,ctx);if(childAst){if(childAst.type===3){children.push(...childAst.content);}
else{children.push(childAst);}}}
return children;}
function parseChildNodes(node,ctx){const children=parseChildren(node,ctx);switch(children.length){case 0:return null;case 1:return children[0];default:return{type:3,content:children};}}
function normalizeTIf(el){let tbranch=el.querySelectorAll("[t-elif], [t-else]");for(let i=0,ilen=tbranch.length;i<ilen;i++){let node=tbranch[i];let prevElem=node.previousElementSibling;let pattr=(name)=>prevElem.getAttribute(name);let nattr=(name)=>+!!node.getAttribute(name);if(prevElem&&(pattr("t-if")||pattr("t-elif"))){if(pattr("t-foreach")){throw new OwlError("t-if cannot stay at the same level as t-foreach when using t-elif or t-else");}
if(["t-if","t-elif","t-else"].map(nattr).reduce(function(a,b){return a+b;})>1){throw new OwlError("Only one conditional branching directive is allowed per node");}
let textNode;while((textNode=node.previousSibling)!==prevElem){if(textNode.nodeValue.trim().length&&textNode.nodeType!==8){throw new OwlError("text is not allowed between branching directives");}
textNode.remove();}}
else{throw new OwlError("t-elif and t-else directives must be preceded by a t-if or t-elif directive");}}}
function normalizeTEscTOut(el){for(const d of["t-esc","t-out"]){const elements=[...el.querySelectorAll(`[${d}]`)].filter((el)=>el.tagName[0]===el.tagName[0].toUpperCase()||el.hasAttribute("t-component"));for(const el of elements){if(el.childNodes.length){throw new OwlError(`Cannot have ${d} on a component that already has content`);}
const value=el.getAttribute(d);el.removeAttribute(d);const t=el.ownerDocument.createElement("t");if(value!=null){t.setAttribute(d,value);}
el.appendChild(t);}}}
function normalizeXML(el){normalizeTIf(el);normalizeTEscTOut(el);}
function compile(template,options={}){const ast=parse(template);const hasSafeContext=template instanceof Node?!(template instanceof Element)||template.querySelector("[t-set], [t-call]")===null:!template.includes("t-set")&&!template.includes("t-call");const codeGenerator=new CodeGenerator(ast,{...options,hasSafeContext});const code=codeGenerator.generateCode();try{return new Function("app, bdom, helpers",code);}
catch(originalError){const{name}=options;const nameStr=name?`template "${name}"`:"anonymous template";const err=new OwlError(`Failed to compile ${nameStr}: ${originalError.message}\n\ngenerated code:\nfunction(app, bdom, helpers) {\n${code}\n}`);err.cause=originalError;throw err;}}
const version="2.2.11";class Scheduler{constructor(){this.tasks=new Set();this.frame=0;this.delayedRenders=[];this.cancelledNodes=new Set();this.requestAnimationFrame=Scheduler.requestAnimationFrame;}
addFiber(fiber){this.tasks.add(fiber.root);}
scheduleDestroy(node){this.cancelledNodes.add(node);if(this.frame===0){this.frame=this.requestAnimationFrame(()=>this.processTasks());}}
flush(){if(this.delayedRenders.length){let renders=this.delayedRenders;this.delayedRenders=[];for(let f of renders){if(f.root&&f.node.status!==3&&f.node.fiber===f){f.render();}}}
if(this.frame===0){this.frame=this.requestAnimationFrame(()=>this.processTasks());}}
processTasks(){this.frame=0;for(let node of this.cancelledNodes){node._destroy();}
this.cancelledNodes.clear();for(let task of this.tasks){this.processFiber(task);}
for(let task of this.tasks){if(task.node.status===3){this.tasks.delete(task);}}}
processFiber(fiber){if(fiber.root!==fiber){this.tasks.delete(fiber);return;}
const hasError=fibersInError.has(fiber);if(hasError&&fiber.counter!==0){this.tasks.delete(fiber);return;}
if(fiber.node.status===3){this.tasks.delete(fiber);return;}
if(fiber.counter===0){if(!hasError){fiber.complete();}
this.tasks.delete(fiber);}}}
Scheduler.requestAnimationFrame=window.requestAnimationFrame.bind(window);let hasBeenLogged=false;const DEV_MSG=()=>{const hash=window.owl?window.owl.__info__.hash:"master";return`Owl is running in 'dev' mode.

This is not suitable for production use.
See https://github.com/odoo/owl/blob/${hash}/doc/reference/app.md#configuration for more information.`;};const apps=new Set();window.__OWL_DEVTOOLS__||(window.__OWL_DEVTOOLS__={apps,Fiber,RootFiber,toRaw,reactive});class App extends TemplateSet{constructor(Root,config={}){super(config);this.scheduler=new Scheduler();this.root=null;this.name=config.name||"";this.Root=Root;apps.add(this);if(config.test){this.dev=true;}
this.warnIfNoStaticProps=config.warnIfNoStaticProps||false;if(this.dev&&!config.test&&!hasBeenLogged){console.info(DEV_MSG());hasBeenLogged=true;}
const env=config.env||{};const descrs=Object.getOwnPropertyDescriptors(env);this.env=Object.freeze(Object.create(Object.getPrototypeOf(env),descrs));this.props=config.props||{};}
mount(target,options){App.validateTarget(target);if(this.dev){validateProps(this.Root,this.props,{__owl__:{app:this}});}
const node=this.makeNode(this.Root,this.props);const prom=this.mountNode(node,target,options);this.root=node;return prom;}
makeNode(Component,props){return new ComponentNode(Component,props,this,null,null);}
mountNode(node,target,options){const promise=new Promise((resolve,reject)=>{let isResolved=false;node.mounted.push(()=>{resolve(node.component);isResolved=true;});let handlers=nodeErrorHandlers.get(node);if(!handlers){handlers=[];nodeErrorHandlers.set(node,handlers);}
handlers.unshift((e)=>{if(!isResolved){reject(e);}
throw e;});});node.mountComponent(target,options);return promise;}
destroy(){if(this.root){this.root.destroy();this.scheduler.processTasks();}
apps.delete(this);}
createComponent(name,isStatic,hasSlotsProp,hasDynamicPropList,propList){const isDynamic=!isStatic;let arePropsDifferent;const hasNoProp=propList.length===0;if(hasSlotsProp){arePropsDifferent=(_1,_2)=>true;}
else if(hasDynamicPropList){arePropsDifferent=function(props1,props2){for(let k in props1){if(props1[k]!==props2[k]){return true;}}
return Object.keys(props1).length!==Object.keys(props2).length;};}
else if(hasNoProp){arePropsDifferent=(_1,_2)=>false;}
else{arePropsDifferent=function(props1,props2){for(let p of propList){if(props1[p]!==props2[p]){return true;}}
return false;};}
const updateAndRender=ComponentNode.prototype.updateAndRender;const initiateRender=ComponentNode.prototype.initiateRender;return(props,key,ctx,parent,C)=>{let children=ctx.children;let node=children[key];if(isDynamic&&node&&node.component.constructor!==C){node=undefined;}
const parentFiber=ctx.fiber;if(node){if(arePropsDifferent(node.props,props)||parentFiber.deep||node.forceNextRender){node.forceNextRender=false;updateAndRender.call(node,props,parentFiber);}}
else{if(isStatic){const components=parent.constructor.components;if(!components){throw new OwlError(`Cannot find the definition of component "${name}", missing static components key in parent`);}
C=components[name];if(!C){throw new OwlError(`Cannot find the definition of component "${name}"`);}
else if(!(C.prototype instanceof Component)){throw new OwlError(`"${name}" is not a Component. It must inherit from the Component class`);}}
node=new ComponentNode(C,props,this,ctx,key);children[key]=node;initiateRender.call(node,new Fiber(node,parentFiber));}
parentFiber.childrenMap[key]=node;return node;};}
handleError(...args){return handleError(...args);}}
App.validateTarget=validateTarget;App.apps=apps;App.version=version;async function mount(C,target,config={}){return new App(C,config).mount(target,config);}
const mainEventHandler=(data,ev,currentTarget)=>{const{data:_data,modifiers}=filterOutModifiersFromData(data);data=_data;let stopped=false;if(modifiers.length){let selfMode=false;const isSelf=ev.target===currentTarget;for(const mod of modifiers){switch(mod){case"self":selfMode=true;if(isSelf){continue;}
else{return stopped;}
case"prevent":if((selfMode&&isSelf)||!selfMode)
ev.preventDefault();continue;case"stop":if((selfMode&&isSelf)||!selfMode)
ev.stopPropagation();stopped=true;continue;}}}
if(Object.hasOwnProperty.call(data,0)){const handler=data[0];if(typeof handler!=="function"){throw new OwlError(`Invalid handler (expected a function, received: '${handler}')`);}
let node=data[1]?data[1].__owl__:null;if(node?node.status===1:true){handler.call(node?node.component:null,ev);}}
return stopped;};function status(component){switch(component.__owl__.status){case 0:return"new";case 2:return"cancelled";case 1:return"mounted";case 3:return"destroyed";}}
function useRef(name){const node=getCurrent();const refs=node.refs;return{get el(){const el=refs[name];return inOwnerDocument(el)?el:null;},};}
function useEnv(){return getCurrent().component.env;}
function extendEnv(currentEnv,extension){const env=Object.create(currentEnv);const descrs=Object.getOwnPropertyDescriptors(extension);return Object.freeze(Object.defineProperties(env,descrs));}
function useSubEnv(envExtension){const node=getCurrent();node.component.env=extendEnv(node.component.env,envExtension);useChildSubEnv(envExtension);}
function useChildSubEnv(envExtension){const node=getCurrent();node.childEnv=extendEnv(node.childEnv,envExtension);}
function useEffect(effect,computeDependencies=()=>[NaN]){let cleanup;let dependencies;onMounted(()=>{dependencies=computeDependencies();cleanup=effect(...dependencies);});onPatched(()=>{const newDeps=computeDependencies();const shouldReapply=newDeps.some((val,i)=>val!==dependencies[i]);if(shouldReapply){dependencies=newDeps;if(cleanup){cleanup();}
cleanup=effect(...dependencies);}});onWillUnmount(()=>cleanup&&cleanup());}
function useExternalListener(target,eventName,handler,eventParams){const node=getCurrent();const boundHandler=handler.bind(node.component);onMounted(()=>target.addEventListener(eventName,boundHandler,eventParams));onWillUnmount(()=>target.removeEventListener(eventName,boundHandler,eventParams));}
config.shouldNormalizeDom=false;config.mainEventHandler=mainEventHandler;const blockDom={config,mount:mount$1,patch,remove,list,multi,text,toggler,createBlock,html,comment,};const __info__={version:App.version,};TemplateSet.prototype._compileTemplate=function _compileTemplate(name,template){return compile(template,{name,dev:this.dev,translateFn:this.translateFn,translatableAttributes:this.translatableAttributes,});};exports.App=App;exports.Component=Component;exports.EventBus=EventBus;exports.OwlError=OwlError;exports.__info__=__info__;exports.batched=batched;exports.blockDom=blockDom;exports.loadFile=loadFile;exports.markRaw=markRaw;exports.markup=markup;exports.mount=mount;exports.onError=onError;exports.onMounted=onMounted;exports.onPatched=onPatched;exports.onRendered=onRendered;exports.onWillDestroy=onWillDestroy;exports.onWillPatch=onWillPatch;exports.onWillRender=onWillRender;exports.onWillStart=onWillStart;exports.onWillUnmount=onWillUnmount;exports.onWillUpdateProps=onWillUpdateProps;exports.reactive=reactive;exports.status=status;exports.toRaw=toRaw;exports.useChildSubEnv=useChildSubEnv;exports.useComponent=useComponent;exports.useEffect=useEffect;exports.useEnv=useEnv;exports.useExternalListener=useExternalListener;exports.useRef=useRef;exports.useState=useState;exports.useSubEnv=useSubEnv;exports.validate=validate;exports.validateType=validateType;exports.whenReady=whenReady;exports.xml=xml;Object.defineProperty(exports,'__esModule',{value:true});__info__.date='2024-06-17T13:31:12.099Z';__info__.hash='e7f405c';__info__.url='https://github.com/odoo/owl';})(this.owl=this.owl||{});;

/* /web/static/lib/owl/odoo_module.js */
odoo.define("@odoo/owl",[],function(){"use strict";return owl;});;

/* /web_editor/static/lib/html2canvas.js */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?module.exports=factory():typeof define==='function'&&define.amd?define(factory):(global=typeof globalThis!=='undefined'?globalThis:global||self,global.html2canvas=factory());}(this,(function(){'use strict';var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b;})||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p];};return extendStatics(d,b);};function __extends(d,b){if(typeof b!=="function"&&b!==null)
throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());}
var __assign=function(){__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p];}
return t;};return __assign.apply(this,arguments);};function __awaiter(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value);});}
return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value));}catch(e){reject(e);}}
function rejected(value){try{step(generator["throw"](value));}catch(e){reject(e);}}
function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected);}
step((generator=generator.apply(thisArg,_arguments||[])).next());});}
function __generator(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1];},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),"throw":verb(1),"return":verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this;}),g;function verb(n){return function(v){return step([n,v]);};}
function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue;}
if(op[0]===3&&(!t||(op[1]>t[0]&&op[1]<t[3]))){_.label=op[1];break;}
if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break;}
if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break;}
if(t[2])_.ops.pop();_.trys.pop();continue;}
op=body.call(thisArg,_);}catch(e){op=[6,e];y=0;}finally{f=t=0;}
if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true};}}
function __spreadArray(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i];}}
return to.concat(ar||from);}
var Bounds=(function(){function Bounds(left,top,width,height){this.left=left;this.top=top;this.width=width;this.height=height;}
Bounds.prototype.add=function(x,y,w,h){return new Bounds(this.left+x,this.top+y,this.width+w,this.height+h);};Bounds.fromClientRect=function(context,clientRect){return new Bounds(clientRect.left+context.windowBounds.left,clientRect.top+context.windowBounds.top,clientRect.width,clientRect.height);};Bounds.fromDOMRectList=function(context,domRectList){var domRect=Array.from(domRectList).find(function(rect){return rect.width!==0;});return domRect?new Bounds(domRect.left+context.windowBounds.left,domRect.top+context.windowBounds.top,domRect.width,domRect.height):Bounds.EMPTY;};Bounds.EMPTY=new Bounds(0,0,0,0);return Bounds;}());var parseBounds=function(context,node){return Bounds.fromClientRect(context,node.getBoundingClientRect());};var parseDocumentSize=function(document){var body=document.body;var documentElement=document.documentElement;if(!body||!documentElement){throw new Error("Unable to get document size");}
var width=Math.max(Math.max(body.scrollWidth,documentElement.scrollWidth),Math.max(body.offsetWidth,documentElement.offsetWidth),Math.max(body.clientWidth,documentElement.clientWidth));var height=Math.max(Math.max(body.scrollHeight,documentElement.scrollHeight),Math.max(body.offsetHeight,documentElement.offsetHeight),Math.max(body.clientHeight,documentElement.clientHeight));return new Bounds(0,0,width,height);};var toCodePoints$1=function(str){var codePoints=[];var i=0;var length=str.length;while(i<length){var value=str.charCodeAt(i++);if(value>=0xd800&&value<=0xdbff&&i<length){var extra=str.charCodeAt(i++);if((extra&0xfc00)===0xdc00){codePoints.push(((value&0x3ff)<<10)+(extra&0x3ff)+0x10000);}
else{codePoints.push(value);i--;}}
else{codePoints.push(value);}}
return codePoints;};var fromCodePoint$1=function(){var codePoints=[];for(var _i=0;_i<arguments.length;_i++){codePoints[_i]=arguments[_i];}
if(String.fromCodePoint){return String.fromCodePoint.apply(String,codePoints);}
var length=codePoints.length;if(!length){return'';}
var codeUnits=[];var index=-1;var result='';while(++index<length){var codePoint=codePoints[index];if(codePoint<=0xffff){codeUnits.push(codePoint);}
else{codePoint-=0x10000;codeUnits.push((codePoint>>10)+0xd800,(codePoint%0x400)+0xdc00);}
if(index+1===length||codeUnits.length>0x4000){result+=String.fromCharCode.apply(String,codeUnits);codeUnits.length=0;}}
return result;};var chars$2='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';var lookup$2=typeof Uint8Array==='undefined'?[]:new Uint8Array(256);for(var i$2=0;i$2<chars$2.length;i$2++){lookup$2[chars$2.charCodeAt(i$2)]=i$2;}
var chars$1$1='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';var lookup$1$1=typeof Uint8Array==='undefined'?[]:new Uint8Array(256);for(var i$1$1=0;i$1$1<chars$1$1.length;i$1$1++){lookup$1$1[chars$1$1.charCodeAt(i$1$1)]=i$1$1;}
var decode$1=function(base64){var bufferLength=base64.length*0.75,len=base64.length,i,p=0,encoded1,encoded2,encoded3,encoded4;if(base64[base64.length-1]==='='){bufferLength--;if(base64[base64.length-2]==='='){bufferLength--;}}
var buffer=typeof ArrayBuffer!=='undefined'&&typeof Uint8Array!=='undefined'&&typeof Uint8Array.prototype.slice!=='undefined'?new ArrayBuffer(bufferLength):new Array(bufferLength);var bytes=Array.isArray(buffer)?buffer:new Uint8Array(buffer);for(i=0;i<len;i+=4){encoded1=lookup$1$1[base64.charCodeAt(i)];encoded2=lookup$1$1[base64.charCodeAt(i+1)];encoded3=lookup$1$1[base64.charCodeAt(i+2)];encoded4=lookup$1$1[base64.charCodeAt(i+3)];bytes[p++]=(encoded1<<2)|(encoded2>>4);bytes[p++]=((encoded2&15)<<4)|(encoded3>>2);bytes[p++]=((encoded3&3)<<6)|(encoded4&63);}
return buffer;};var polyUint16Array$1=function(buffer){var length=buffer.length;var bytes=[];for(var i=0;i<length;i+=2){bytes.push((buffer[i+1]<<8)|buffer[i]);}
return bytes;};var polyUint32Array$1=function(buffer){var length=buffer.length;var bytes=[];for(var i=0;i<length;i+=4){bytes.push((buffer[i+3]<<24)|(buffer[i+2]<<16)|(buffer[i+1]<<8)|buffer[i]);}
return bytes;};var UTRIE2_SHIFT_2$1=5;var UTRIE2_SHIFT_1$1=6+5;var UTRIE2_INDEX_SHIFT$1=2;var UTRIE2_SHIFT_1_2$1=UTRIE2_SHIFT_1$1-UTRIE2_SHIFT_2$1;var UTRIE2_LSCP_INDEX_2_OFFSET$1=0x10000>>UTRIE2_SHIFT_2$1;var UTRIE2_DATA_BLOCK_LENGTH$1=1<<UTRIE2_SHIFT_2$1;var UTRIE2_DATA_MASK$1=UTRIE2_DATA_BLOCK_LENGTH$1-1;var UTRIE2_LSCP_INDEX_2_LENGTH$1=0x400>>UTRIE2_SHIFT_2$1;var UTRIE2_INDEX_2_BMP_LENGTH$1=UTRIE2_LSCP_INDEX_2_OFFSET$1+UTRIE2_LSCP_INDEX_2_LENGTH$1;var UTRIE2_UTF8_2B_INDEX_2_OFFSET$1=UTRIE2_INDEX_2_BMP_LENGTH$1;var UTRIE2_UTF8_2B_INDEX_2_LENGTH$1=0x800>>6;var UTRIE2_INDEX_1_OFFSET$1=UTRIE2_UTF8_2B_INDEX_2_OFFSET$1+UTRIE2_UTF8_2B_INDEX_2_LENGTH$1;var UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1=0x10000>>UTRIE2_SHIFT_1$1;var UTRIE2_INDEX_2_BLOCK_LENGTH$1=1<<UTRIE2_SHIFT_1_2$1;var UTRIE2_INDEX_2_MASK$1=UTRIE2_INDEX_2_BLOCK_LENGTH$1-1;var slice16$1=function(view,start,end){if(view.slice){return view.slice(start,end);}
return new Uint16Array(Array.prototype.slice.call(view,start,end));};var slice32$1=function(view,start,end){if(view.slice){return view.slice(start,end);}
return new Uint32Array(Array.prototype.slice.call(view,start,end));};var createTrieFromBase64$1=function(base64,_byteLength){var buffer=decode$1(base64);var view32=Array.isArray(buffer)?polyUint32Array$1(buffer):new Uint32Array(buffer);var view16=Array.isArray(buffer)?polyUint16Array$1(buffer):new Uint16Array(buffer);var headerLength=24;var index=slice16$1(view16,headerLength/2,view32[4]/2);var data=view32[5]===2?slice16$1(view16,(headerLength+view32[4])/2):slice32$1(view32,Math.ceil((headerLength+view32[4])/4));return new Trie$1(view32[0],view32[1],view32[2],view32[3],index,data);};var Trie$1=(function(){function Trie(initialValue,errorValue,highStart,highValueIndex,index,data){this.initialValue=initialValue;this.errorValue=errorValue;this.highStart=highStart;this.highValueIndex=highValueIndex;this.index=index;this.data=data;}
Trie.prototype.get=function(codePoint){var ix;if(codePoint>=0){if(codePoint<0x0d800||(codePoint>0x0dbff&&codePoint<=0x0ffff)){ix=this.index[codePoint>>UTRIE2_SHIFT_2$1];ix=(ix<<UTRIE2_INDEX_SHIFT$1)+(codePoint&UTRIE2_DATA_MASK$1);return this.data[ix];}
if(codePoint<=0xffff){ix=this.index[UTRIE2_LSCP_INDEX_2_OFFSET$1+((codePoint-0xd800)>>UTRIE2_SHIFT_2$1)];ix=(ix<<UTRIE2_INDEX_SHIFT$1)+(codePoint&UTRIE2_DATA_MASK$1);return this.data[ix];}
if(codePoint<this.highStart){ix=UTRIE2_INDEX_1_OFFSET$1-UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1+(codePoint>>UTRIE2_SHIFT_1$1);ix=this.index[ix];ix+=(codePoint>>UTRIE2_SHIFT_2$1)&UTRIE2_INDEX_2_MASK$1;ix=this.index[ix];ix=(ix<<UTRIE2_INDEX_SHIFT$1)+(codePoint&UTRIE2_DATA_MASK$1);return this.data[ix];}
if(codePoint<=0x10ffff){return this.data[this.highValueIndex];}}
return this.errorValue;};return Trie;}());var chars$3='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';var lookup$3=typeof Uint8Array==='undefined'?[]:new Uint8Array(256);for(var i$3=0;i$3<chars$3.length;i$3++){lookup$3[chars$3.charCodeAt(i$3)]=i$3;}
var base64$1='KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==';var LETTER_NUMBER_MODIFIER=50;var BK=1;var CR$1=2;var LF$1=3;var CM=4;var NL=5;var WJ=7;var ZW=8;var GL=9;var SP=10;var ZWJ$1=11;var B2=12;var BA=13;var BB=14;var HY=15;var CB=16;var CL=17;var CP=18;var EX=19;var IN=20;var NS=21;var OP=22;var QU=23;var IS=24;var NU=25;var PO=26;var PR=27;var SY=28;var AI=29;var AL=30;var CJ=31;var EB=32;var EM=33;var H2=34;var H3=35;var HL=36;var ID=37;var JL=38;var JV=39;var JT=40;var RI$1=41;var SA=42;var XX=43;var ea_OP=[0x2329,0xff08];var BREAK_MANDATORY='!';var BREAK_NOT_ALLOWED$1='';var BREAK_ALLOWED$1='';var UnicodeTrie$1=createTrieFromBase64$1(base64$1);var ALPHABETICS=[AL,HL];var HARD_LINE_BREAKS=[BK,CR$1,LF$1,NL];var SPACE$1=[SP,ZW];var PREFIX_POSTFIX=[PR,PO];var LINE_BREAKS=HARD_LINE_BREAKS.concat(SPACE$1);var KOREAN_SYLLABLE_BLOCK=[JL,JV,JT,H2,H3];var HYPHEN=[HY,BA];var codePointsToCharacterClasses=function(codePoints,lineBreak){if(lineBreak===void 0){lineBreak='strict';}
var types=[];var indices=[];var categories=[];codePoints.forEach(function(codePoint,index){var classType=UnicodeTrie$1.get(codePoint);if(classType>LETTER_NUMBER_MODIFIER){categories.push(true);classType-=LETTER_NUMBER_MODIFIER;}
else{categories.push(false);}
if(['normal','auto','loose'].indexOf(lineBreak)!==-1){if([0x2010,0x2013,0x301c,0x30a0].indexOf(codePoint)!==-1){indices.push(index);return types.push(CB);}}
if(classType===CM||classType===ZWJ$1){if(index===0){indices.push(index);return types.push(AL);}
var prev=types[index-1];if(LINE_BREAKS.indexOf(prev)===-1){indices.push(indices[index-1]);return types.push(prev);}
indices.push(index);return types.push(AL);}
indices.push(index);if(classType===CJ){return types.push(lineBreak==='strict'?NS:ID);}
if(classType===SA){return types.push(AL);}
if(classType===AI){return types.push(AL);}
if(classType===XX){if((codePoint>=0x20000&&codePoint<=0x2fffd)||(codePoint>=0x30000&&codePoint<=0x3fffd)){return types.push(ID);}
else{return types.push(AL);}}
types.push(classType);});return[indices,types,categories];};var isAdjacentWithSpaceIgnored=function(a,b,currentIndex,classTypes){var current=classTypes[currentIndex];if(Array.isArray(a)?a.indexOf(current)!==-1:a===current){var i=currentIndex;while(i<=classTypes.length){i++;var next=classTypes[i];if(next===b){return true;}
if(next!==SP){break;}}}
if(current===SP){var i=currentIndex;while(i>0){i--;var prev=classTypes[i];if(Array.isArray(a)?a.indexOf(prev)!==-1:a===prev){var n=currentIndex;while(n<=classTypes.length){n++;var next=classTypes[n];if(next===b){return true;}
if(next!==SP){break;}}}
if(prev!==SP){break;}}}
return false;};var previousNonSpaceClassType=function(currentIndex,classTypes){var i=currentIndex;while(i>=0){var type=classTypes[i];if(type===SP){i--;}
else{return type;}}
return 0;};var _lineBreakAtIndex=function(codePoints,classTypes,indicies,index,forbiddenBreaks){if(indicies[index]===0){return BREAK_NOT_ALLOWED$1;}
var currentIndex=index-1;if(Array.isArray(forbiddenBreaks)&&forbiddenBreaks[currentIndex]===true){return BREAK_NOT_ALLOWED$1;}
var beforeIndex=currentIndex-1;var afterIndex=currentIndex+1;var current=classTypes[currentIndex];var before=beforeIndex>=0?classTypes[beforeIndex]:0;var next=classTypes[afterIndex];if(current===CR$1&&next===LF$1){return BREAK_NOT_ALLOWED$1;}
if(HARD_LINE_BREAKS.indexOf(current)!==-1){return BREAK_MANDATORY;}
if(HARD_LINE_BREAKS.indexOf(next)!==-1){return BREAK_NOT_ALLOWED$1;}
if(SPACE$1.indexOf(next)!==-1){return BREAK_NOT_ALLOWED$1;}
if(previousNonSpaceClassType(currentIndex,classTypes)===ZW){return BREAK_ALLOWED$1;}
if(UnicodeTrie$1.get(codePoints[currentIndex])===ZWJ$1){return BREAK_NOT_ALLOWED$1;}
if((current===EB||current===EM)&&UnicodeTrie$1.get(codePoints[afterIndex])===ZWJ$1){return BREAK_NOT_ALLOWED$1;}
if(current===WJ||next===WJ){return BREAK_NOT_ALLOWED$1;}
if(current===GL){return BREAK_NOT_ALLOWED$1;}
if([SP,BA,HY].indexOf(current)===-1&&next===GL){return BREAK_NOT_ALLOWED$1;}
if([CL,CP,EX,IS,SY].indexOf(next)!==-1){return BREAK_NOT_ALLOWED$1;}
if(previousNonSpaceClassType(currentIndex,classTypes)===OP){return BREAK_NOT_ALLOWED$1;}
if(isAdjacentWithSpaceIgnored(QU,OP,currentIndex,classTypes)){return BREAK_NOT_ALLOWED$1;}
if(isAdjacentWithSpaceIgnored([CL,CP],NS,currentIndex,classTypes)){return BREAK_NOT_ALLOWED$1;}
if(isAdjacentWithSpaceIgnored(B2,B2,currentIndex,classTypes)){return BREAK_NOT_ALLOWED$1;}
if(current===SP){return BREAK_ALLOWED$1;}
if(current===QU||next===QU){return BREAK_NOT_ALLOWED$1;}
if(next===CB||current===CB){return BREAK_ALLOWED$1;}
if([BA,HY,NS].indexOf(next)!==-1||current===BB){return BREAK_NOT_ALLOWED$1;}
if(before===HL&&HYPHEN.indexOf(current)!==-1){return BREAK_NOT_ALLOWED$1;}
if(current===SY&&next===HL){return BREAK_NOT_ALLOWED$1;}
if(next===IN){return BREAK_NOT_ALLOWED$1;}
if((ALPHABETICS.indexOf(next)!==-1&&current===NU)||(ALPHABETICS.indexOf(current)!==-1&&next===NU)){return BREAK_NOT_ALLOWED$1;}
if((current===PR&&[ID,EB,EM].indexOf(next)!==-1)||([ID,EB,EM].indexOf(current)!==-1&&next===PO)){return BREAK_NOT_ALLOWED$1;}
if((ALPHABETICS.indexOf(current)!==-1&&PREFIX_POSTFIX.indexOf(next)!==-1)||(PREFIX_POSTFIX.indexOf(current)!==-1&&ALPHABETICS.indexOf(next)!==-1)){return BREAK_NOT_ALLOWED$1;}
if(([PR,PO].indexOf(current)!==-1&&(next===NU||([OP,HY].indexOf(next)!==-1&&classTypes[afterIndex+1]===NU)))||([OP,HY].indexOf(current)!==-1&&next===NU)||(current===NU&&[NU,SY,IS].indexOf(next)!==-1)){return BREAK_NOT_ALLOWED$1;}
if([NU,SY,IS,CL,CP].indexOf(next)!==-1){var prevIndex=currentIndex;while(prevIndex>=0){var type=classTypes[prevIndex];if(type===NU){return BREAK_NOT_ALLOWED$1;}
else if([SY,IS].indexOf(type)!==-1){prevIndex--;}
else{break;}}}
if([PR,PO].indexOf(next)!==-1){var prevIndex=[CL,CP].indexOf(current)!==-1?beforeIndex:currentIndex;while(prevIndex>=0){var type=classTypes[prevIndex];if(type===NU){return BREAK_NOT_ALLOWED$1;}
else if([SY,IS].indexOf(type)!==-1){prevIndex--;}
else{break;}}}
if((JL===current&&[JL,JV,H2,H3].indexOf(next)!==-1)||([JV,H2].indexOf(current)!==-1&&[JV,JT].indexOf(next)!==-1)||([JT,H3].indexOf(current)!==-1&&next===JT)){return BREAK_NOT_ALLOWED$1;}
if((KOREAN_SYLLABLE_BLOCK.indexOf(current)!==-1&&[IN,PO].indexOf(next)!==-1)||(KOREAN_SYLLABLE_BLOCK.indexOf(next)!==-1&&current===PR)){return BREAK_NOT_ALLOWED$1;}
if(ALPHABETICS.indexOf(current)!==-1&&ALPHABETICS.indexOf(next)!==-1){return BREAK_NOT_ALLOWED$1;}
if(current===IS&&ALPHABETICS.indexOf(next)!==-1){return BREAK_NOT_ALLOWED$1;}
if((ALPHABETICS.concat(NU).indexOf(current)!==-1&&next===OP&&ea_OP.indexOf(codePoints[afterIndex])===-1)||(ALPHABETICS.concat(NU).indexOf(next)!==-1&&current===CP)){return BREAK_NOT_ALLOWED$1;}
if(current===RI$1&&next===RI$1){var i=indicies[currentIndex];var count=1;while(i>0){i--;if(classTypes[i]===RI$1){count++;}
else{break;}}
if(count%2!==0){return BREAK_NOT_ALLOWED$1;}}
if(current===EB&&next===EM){return BREAK_NOT_ALLOWED$1;}
return BREAK_ALLOWED$1;};var cssFormattedClasses=function(codePoints,options){if(!options){options={lineBreak:'normal',wordBreak:'normal'};}
var _a=codePointsToCharacterClasses(codePoints,options.lineBreak),indicies=_a[0],classTypes=_a[1],isLetterNumber=_a[2];if(options.wordBreak==='break-all'||options.wordBreak==='break-word'){classTypes=classTypes.map(function(type){return([NU,AL,SA].indexOf(type)!==-1?ID:type);});}
var forbiddenBreakpoints=options.wordBreak==='keep-all'?isLetterNumber.map(function(letterNumber,i){return letterNumber&&codePoints[i]>=0x4e00&&codePoints[i]<=0x9fff;}):undefined;return[indicies,classTypes,forbiddenBreakpoints];};var Break=(function(){function Break(codePoints,lineBreak,start,end){this.codePoints=codePoints;this.required=lineBreak===BREAK_MANDATORY;this.start=start;this.end=end;}
Break.prototype.slice=function(){return fromCodePoint$1.apply(void 0,this.codePoints.slice(this.start,this.end));};return Break;}());var LineBreaker=function(str,options){var codePoints=toCodePoints$1(str);var _a=cssFormattedClasses(codePoints,options),indicies=_a[0],classTypes=_a[1],forbiddenBreakpoints=_a[2];var length=codePoints.length;var lastEnd=0;var nextIndex=0;return{next:function(){if(nextIndex>=length){return{done:true,value:null};}
var lineBreak=BREAK_NOT_ALLOWED$1;while(nextIndex<length&&(lineBreak=_lineBreakAtIndex(codePoints,classTypes,indicies,++nextIndex,forbiddenBreakpoints))===BREAK_NOT_ALLOWED$1){}
if(lineBreak!==BREAK_NOT_ALLOWED$1||nextIndex===length){var value=new Break(codePoints,lineBreak,lastEnd,nextIndex);lastEnd=nextIndex;return{value:value,done:false};}
return{done:true,value:null};},};};var FLAG_UNRESTRICTED=1<<0;var FLAG_ID=1<<1;var FLAG_INTEGER=1<<2;var FLAG_NUMBER=1<<3;var LINE_FEED=0x000a;var SOLIDUS=0x002f;var REVERSE_SOLIDUS=0x005c;var CHARACTER_TABULATION=0x0009;var SPACE=0x0020;var QUOTATION_MARK=0x0022;var EQUALS_SIGN=0x003d;var NUMBER_SIGN=0x0023;var DOLLAR_SIGN=0x0024;var PERCENTAGE_SIGN=0x0025;var APOSTROPHE=0x0027;var LEFT_PARENTHESIS=0x0028;var RIGHT_PARENTHESIS=0x0029;var LOW_LINE=0x005f;var HYPHEN_MINUS=0x002d;var EXCLAMATION_MARK=0x0021;var LESS_THAN_SIGN=0x003c;var GREATER_THAN_SIGN=0x003e;var COMMERCIAL_AT=0x0040;var LEFT_SQUARE_BRACKET=0x005b;var RIGHT_SQUARE_BRACKET=0x005d;var CIRCUMFLEX_ACCENT=0x003d;var LEFT_CURLY_BRACKET=0x007b;var QUESTION_MARK=0x003f;var RIGHT_CURLY_BRACKET=0x007d;var VERTICAL_LINE=0x007c;var TILDE=0x007e;var CONTROL=0x0080;var REPLACEMENT_CHARACTER=0xfffd;var ASTERISK=0x002a;var PLUS_SIGN=0x002b;var COMMA=0x002c;var COLON=0x003a;var SEMICOLON=0x003b;var FULL_STOP=0x002e;var NULL=0x0000;var BACKSPACE=0x0008;var LINE_TABULATION=0x000b;var SHIFT_OUT=0x000e;var INFORMATION_SEPARATOR_ONE=0x001f;var DELETE=0x007f;var EOF=-1;var ZERO=0x0030;var a=0x0061;var e=0x0065;var f=0x0066;var u=0x0075;var z=0x007a;var A=0x0041;var E=0x0045;var F=0x0046;var U=0x0055;var Z=0x005a;var isDigit=function(codePoint){return codePoint>=ZERO&&codePoint<=0x0039;};var isSurrogateCodePoint=function(codePoint){return codePoint>=0xd800&&codePoint<=0xdfff;};var isHex=function(codePoint){return isDigit(codePoint)||(codePoint>=A&&codePoint<=F)||(codePoint>=a&&codePoint<=f);};var isLowerCaseLetter=function(codePoint){return codePoint>=a&&codePoint<=z;};var isUpperCaseLetter=function(codePoint){return codePoint>=A&&codePoint<=Z;};var isLetter=function(codePoint){return isLowerCaseLetter(codePoint)||isUpperCaseLetter(codePoint);};var isNonASCIICodePoint=function(codePoint){return codePoint>=CONTROL;};var isWhiteSpace=function(codePoint){return codePoint===LINE_FEED||codePoint===CHARACTER_TABULATION||codePoint===SPACE;};var isNameStartCodePoint=function(codePoint){return isLetter(codePoint)||isNonASCIICodePoint(codePoint)||codePoint===LOW_LINE;};var isNameCodePoint=function(codePoint){return isNameStartCodePoint(codePoint)||isDigit(codePoint)||codePoint===HYPHEN_MINUS;};var isNonPrintableCodePoint=function(codePoint){return((codePoint>=NULL&&codePoint<=BACKSPACE)||codePoint===LINE_TABULATION||(codePoint>=SHIFT_OUT&&codePoint<=INFORMATION_SEPARATOR_ONE)||codePoint===DELETE);};var isValidEscape=function(c1,c2){if(c1!==REVERSE_SOLIDUS){return false;}
return c2!==LINE_FEED;};var isIdentifierStart=function(c1,c2,c3){if(c1===HYPHEN_MINUS){return isNameStartCodePoint(c2)||isValidEscape(c2,c3);}
else if(isNameStartCodePoint(c1)){return true;}
else if(c1===REVERSE_SOLIDUS&&isValidEscape(c1,c2)){return true;}
return false;};var isNumberStart=function(c1,c2,c3){if(c1===PLUS_SIGN||c1===HYPHEN_MINUS){if(isDigit(c2)){return true;}
return c2===FULL_STOP&&isDigit(c3);}
if(c1===FULL_STOP){return isDigit(c2);}
return isDigit(c1);};var stringToNumber=function(codePoints){var c=0;var sign=1;if(codePoints[c]===PLUS_SIGN||codePoints[c]===HYPHEN_MINUS){if(codePoints[c]===HYPHEN_MINUS){sign=-1;}
c++;}
var integers=[];while(isDigit(codePoints[c])){integers.push(codePoints[c++]);}
var int=integers.length?parseInt(fromCodePoint$1.apply(void 0,integers),10):0;if(codePoints[c]===FULL_STOP){c++;}
var fraction=[];while(isDigit(codePoints[c])){fraction.push(codePoints[c++]);}
var fracd=fraction.length;var frac=fracd?parseInt(fromCodePoint$1.apply(void 0,fraction),10):0;if(codePoints[c]===E||codePoints[c]===e){c++;}
var expsign=1;if(codePoints[c]===PLUS_SIGN||codePoints[c]===HYPHEN_MINUS){if(codePoints[c]===HYPHEN_MINUS){expsign=-1;}
c++;}
var exponent=[];while(isDigit(codePoints[c])){exponent.push(codePoints[c++]);}
var exp=exponent.length?parseInt(fromCodePoint$1.apply(void 0,exponent),10):0;return sign*(int+frac*Math.pow(10,-fracd))*Math.pow(10,expsign*exp);};var LEFT_PARENTHESIS_TOKEN={type:2};var RIGHT_PARENTHESIS_TOKEN={type:3};var COMMA_TOKEN={type:4};var SUFFIX_MATCH_TOKEN={type:13};var PREFIX_MATCH_TOKEN={type:8};var COLUMN_TOKEN={type:21};var DASH_MATCH_TOKEN={type:9};var INCLUDE_MATCH_TOKEN={type:10};var LEFT_CURLY_BRACKET_TOKEN={type:11};var RIGHT_CURLY_BRACKET_TOKEN={type:12};var SUBSTRING_MATCH_TOKEN={type:14};var BAD_URL_TOKEN={type:23};var BAD_STRING_TOKEN={type:1};var CDO_TOKEN={type:25};var CDC_TOKEN={type:24};var COLON_TOKEN={type:26};var SEMICOLON_TOKEN={type:27};var LEFT_SQUARE_BRACKET_TOKEN={type:28};var RIGHT_SQUARE_BRACKET_TOKEN={type:29};var WHITESPACE_TOKEN={type:31};var EOF_TOKEN={type:32};var Tokenizer=(function(){function Tokenizer(){this._value=[];}
Tokenizer.prototype.write=function(chunk){this._value=this._value.concat(toCodePoints$1(chunk));};Tokenizer.prototype.read=function(){var tokens=[];var token=this.consumeToken();while(token!==EOF_TOKEN){tokens.push(token);token=this.consumeToken();}
return tokens;};Tokenizer.prototype.consumeToken=function(){var codePoint=this.consumeCodePoint();switch(codePoint){case QUOTATION_MARK:return this.consumeStringToken(QUOTATION_MARK);case NUMBER_SIGN:var c1=this.peekCodePoint(0);var c2=this.peekCodePoint(1);var c3=this.peekCodePoint(2);if(isNameCodePoint(c1)||isValidEscape(c2,c3)){var flags=isIdentifierStart(c1,c2,c3)?FLAG_ID:FLAG_UNRESTRICTED;var value=this.consumeName();return{type:5,value:value,flags:flags};}
break;case DOLLAR_SIGN:if(this.peekCodePoint(0)===EQUALS_SIGN){this.consumeCodePoint();return SUFFIX_MATCH_TOKEN;}
break;case APOSTROPHE:return this.consumeStringToken(APOSTROPHE);case LEFT_PARENTHESIS:return LEFT_PARENTHESIS_TOKEN;case RIGHT_PARENTHESIS:return RIGHT_PARENTHESIS_TOKEN;case ASTERISK:if(this.peekCodePoint(0)===EQUALS_SIGN){this.consumeCodePoint();return SUBSTRING_MATCH_TOKEN;}
break;case PLUS_SIGN:if(isNumberStart(codePoint,this.peekCodePoint(0),this.peekCodePoint(1))){this.reconsumeCodePoint(codePoint);return this.consumeNumericToken();}
break;case COMMA:return COMMA_TOKEN;case HYPHEN_MINUS:var e1=codePoint;var e2=this.peekCodePoint(0);var e3=this.peekCodePoint(1);if(isNumberStart(e1,e2,e3)){this.reconsumeCodePoint(codePoint);return this.consumeNumericToken();}
if(isIdentifierStart(e1,e2,e3)){this.reconsumeCodePoint(codePoint);return this.consumeIdentLikeToken();}
if(e2===HYPHEN_MINUS&&e3===GREATER_THAN_SIGN){this.consumeCodePoint();this.consumeCodePoint();return CDC_TOKEN;}
break;case FULL_STOP:if(isNumberStart(codePoint,this.peekCodePoint(0),this.peekCodePoint(1))){this.reconsumeCodePoint(codePoint);return this.consumeNumericToken();}
break;case SOLIDUS:if(this.peekCodePoint(0)===ASTERISK){this.consumeCodePoint();while(true){var c=this.consumeCodePoint();if(c===ASTERISK){c=this.consumeCodePoint();if(c===SOLIDUS){return this.consumeToken();}}
if(c===EOF){return this.consumeToken();}}}
break;case COLON:return COLON_TOKEN;case SEMICOLON:return SEMICOLON_TOKEN;case LESS_THAN_SIGN:if(this.peekCodePoint(0)===EXCLAMATION_MARK&&this.peekCodePoint(1)===HYPHEN_MINUS&&this.peekCodePoint(2)===HYPHEN_MINUS){this.consumeCodePoint();this.consumeCodePoint();return CDO_TOKEN;}
break;case COMMERCIAL_AT:var a1=this.peekCodePoint(0);var a2=this.peekCodePoint(1);var a3=this.peekCodePoint(2);if(isIdentifierStart(a1,a2,a3)){var value=this.consumeName();return{type:7,value:value};}
break;case LEFT_SQUARE_BRACKET:return LEFT_SQUARE_BRACKET_TOKEN;case REVERSE_SOLIDUS:if(isValidEscape(codePoint,this.peekCodePoint(0))){this.reconsumeCodePoint(codePoint);return this.consumeIdentLikeToken();}
break;case RIGHT_SQUARE_BRACKET:return RIGHT_SQUARE_BRACKET_TOKEN;case CIRCUMFLEX_ACCENT:if(this.peekCodePoint(0)===EQUALS_SIGN){this.consumeCodePoint();return PREFIX_MATCH_TOKEN;}
break;case LEFT_CURLY_BRACKET:return LEFT_CURLY_BRACKET_TOKEN;case RIGHT_CURLY_BRACKET:return RIGHT_CURLY_BRACKET_TOKEN;case u:case U:var u1=this.peekCodePoint(0);var u2=this.peekCodePoint(1);if(u1===PLUS_SIGN&&(isHex(u2)||u2===QUESTION_MARK)){this.consumeCodePoint();this.consumeUnicodeRangeToken();}
this.reconsumeCodePoint(codePoint);return this.consumeIdentLikeToken();case VERTICAL_LINE:if(this.peekCodePoint(0)===EQUALS_SIGN){this.consumeCodePoint();return DASH_MATCH_TOKEN;}
if(this.peekCodePoint(0)===VERTICAL_LINE){this.consumeCodePoint();return COLUMN_TOKEN;}
break;case TILDE:if(this.peekCodePoint(0)===EQUALS_SIGN){this.consumeCodePoint();return INCLUDE_MATCH_TOKEN;}
break;case EOF:return EOF_TOKEN;}
if(isWhiteSpace(codePoint)){this.consumeWhiteSpace();return WHITESPACE_TOKEN;}
if(isDigit(codePoint)){this.reconsumeCodePoint(codePoint);return this.consumeNumericToken();}
if(isNameStartCodePoint(codePoint)){this.reconsumeCodePoint(codePoint);return this.consumeIdentLikeToken();}
return{type:6,value:fromCodePoint$1(codePoint)};};Tokenizer.prototype.consumeCodePoint=function(){var value=this._value.shift();return typeof value==='undefined'?-1:value;};Tokenizer.prototype.reconsumeCodePoint=function(codePoint){this._value.unshift(codePoint);};Tokenizer.prototype.peekCodePoint=function(delta){if(delta>=this._value.length){return-1;}
return this._value[delta];};Tokenizer.prototype.consumeUnicodeRangeToken=function(){var digits=[];var codePoint=this.consumeCodePoint();while(isHex(codePoint)&&digits.length<6){digits.push(codePoint);codePoint=this.consumeCodePoint();}
var questionMarks=false;while(codePoint===QUESTION_MARK&&digits.length<6){digits.push(codePoint);codePoint=this.consumeCodePoint();questionMarks=true;}
if(questionMarks){var start_1=parseInt(fromCodePoint$1.apply(void 0,digits.map(function(digit){return(digit===QUESTION_MARK?ZERO:digit);})),16);var end=parseInt(fromCodePoint$1.apply(void 0,digits.map(function(digit){return(digit===QUESTION_MARK?F:digit);})),16);return{type:30,start:start_1,end:end};}
var start=parseInt(fromCodePoint$1.apply(void 0,digits),16);if(this.peekCodePoint(0)===HYPHEN_MINUS&&isHex(this.peekCodePoint(1))){this.consumeCodePoint();codePoint=this.consumeCodePoint();var endDigits=[];while(isHex(codePoint)&&endDigits.length<6){endDigits.push(codePoint);codePoint=this.consumeCodePoint();}
var end=parseInt(fromCodePoint$1.apply(void 0,endDigits),16);return{type:30,start:start,end:end};}
else{return{type:30,start:start,end:start};}};Tokenizer.prototype.consumeIdentLikeToken=function(){var value=this.consumeName();if(value.toLowerCase()==='url'&&this.peekCodePoint(0)===LEFT_PARENTHESIS){this.consumeCodePoint();return this.consumeUrlToken();}
else if(this.peekCodePoint(0)===LEFT_PARENTHESIS){this.consumeCodePoint();return{type:19,value:value};}
return{type:20,value:value};};Tokenizer.prototype.consumeUrlToken=function(){var value=[];this.consumeWhiteSpace();if(this.peekCodePoint(0)===EOF){return{type:22,value:''};}
var next=this.peekCodePoint(0);if(next===APOSTROPHE||next===QUOTATION_MARK){var stringToken=this.consumeStringToken(this.consumeCodePoint());if(stringToken.type===0){this.consumeWhiteSpace();if(this.peekCodePoint(0)===EOF||this.peekCodePoint(0)===RIGHT_PARENTHESIS){this.consumeCodePoint();return{type:22,value:stringToken.value};}}
this.consumeBadUrlRemnants();return BAD_URL_TOKEN;}
while(true){var codePoint=this.consumeCodePoint();if(codePoint===EOF||codePoint===RIGHT_PARENTHESIS){return{type:22,value:fromCodePoint$1.apply(void 0,value)};}
else if(isWhiteSpace(codePoint)){this.consumeWhiteSpace();if(this.peekCodePoint(0)===EOF||this.peekCodePoint(0)===RIGHT_PARENTHESIS){this.consumeCodePoint();return{type:22,value:fromCodePoint$1.apply(void 0,value)};}
this.consumeBadUrlRemnants();return BAD_URL_TOKEN;}
else if(codePoint===QUOTATION_MARK||codePoint===APOSTROPHE||codePoint===LEFT_PARENTHESIS||isNonPrintableCodePoint(codePoint)){this.consumeBadUrlRemnants();return BAD_URL_TOKEN;}
else if(codePoint===REVERSE_SOLIDUS){if(isValidEscape(codePoint,this.peekCodePoint(0))){value.push(this.consumeEscapedCodePoint());}
else{this.consumeBadUrlRemnants();return BAD_URL_TOKEN;}}
else{value.push(codePoint);}}};Tokenizer.prototype.consumeWhiteSpace=function(){while(isWhiteSpace(this.peekCodePoint(0))){this.consumeCodePoint();}};Tokenizer.prototype.consumeBadUrlRemnants=function(){while(true){var codePoint=this.consumeCodePoint();if(codePoint===RIGHT_PARENTHESIS||codePoint===EOF){return;}
if(isValidEscape(codePoint,this.peekCodePoint(0))){this.consumeEscapedCodePoint();}}};Tokenizer.prototype.consumeStringSlice=function(count){var SLICE_STACK_SIZE=50000;var value='';while(count>0){var amount=Math.min(SLICE_STACK_SIZE,count);value+=fromCodePoint$1.apply(void 0,this._value.splice(0,amount));count-=amount;}
this._value.shift();return value;};Tokenizer.prototype.consumeStringToken=function(endingCodePoint){var value='';var i=0;do{var codePoint=this._value[i];if(codePoint===EOF||codePoint===undefined||codePoint===endingCodePoint){value+=this.consumeStringSlice(i);return{type:0,value:value};}
if(codePoint===LINE_FEED){this._value.splice(0,i);return BAD_STRING_TOKEN;}
if(codePoint===REVERSE_SOLIDUS){var next=this._value[i+1];if(next!==EOF&&next!==undefined){if(next===LINE_FEED){value+=this.consumeStringSlice(i);i=-1;this._value.shift();}
else if(isValidEscape(codePoint,next)){value+=this.consumeStringSlice(i);value+=fromCodePoint$1(this.consumeEscapedCodePoint());i=-1;}}}
i++;}while(true);};Tokenizer.prototype.consumeNumber=function(){var repr=[];var type=FLAG_INTEGER;var c1=this.peekCodePoint(0);if(c1===PLUS_SIGN||c1===HYPHEN_MINUS){repr.push(this.consumeCodePoint());}
while(isDigit(this.peekCodePoint(0))){repr.push(this.consumeCodePoint());}
c1=this.peekCodePoint(0);var c2=this.peekCodePoint(1);if(c1===FULL_STOP&&isDigit(c2)){repr.push(this.consumeCodePoint(),this.consumeCodePoint());type=FLAG_NUMBER;while(isDigit(this.peekCodePoint(0))){repr.push(this.consumeCodePoint());}}
c1=this.peekCodePoint(0);c2=this.peekCodePoint(1);var c3=this.peekCodePoint(2);if((c1===E||c1===e)&&(((c2===PLUS_SIGN||c2===HYPHEN_MINUS)&&isDigit(c3))||isDigit(c2))){repr.push(this.consumeCodePoint(),this.consumeCodePoint());type=FLAG_NUMBER;while(isDigit(this.peekCodePoint(0))){repr.push(this.consumeCodePoint());}}
return[stringToNumber(repr),type];};Tokenizer.prototype.consumeNumericToken=function(){var _a=this.consumeNumber(),number=_a[0],flags=_a[1];var c1=this.peekCodePoint(0);var c2=this.peekCodePoint(1);var c3=this.peekCodePoint(2);if(isIdentifierStart(c1,c2,c3)){var unit=this.consumeName();return{type:15,number:number,flags:flags,unit:unit};}
if(c1===PERCENTAGE_SIGN){this.consumeCodePoint();return{type:16,number:number,flags:flags};}
return{type:17,number:number,flags:flags};};Tokenizer.prototype.consumeEscapedCodePoint=function(){var codePoint=this.consumeCodePoint();if(isHex(codePoint)){var hex=fromCodePoint$1(codePoint);while(isHex(this.peekCodePoint(0))&&hex.length<6){hex+=fromCodePoint$1(this.consumeCodePoint());}
if(isWhiteSpace(this.peekCodePoint(0))){this.consumeCodePoint();}
var hexCodePoint=parseInt(hex,16);if(hexCodePoint===0||isSurrogateCodePoint(hexCodePoint)||hexCodePoint>0x10ffff){return REPLACEMENT_CHARACTER;}
return hexCodePoint;}
if(codePoint===EOF){return REPLACEMENT_CHARACTER;}
return codePoint;};Tokenizer.prototype.consumeName=function(){var result='';while(true){var codePoint=this.consumeCodePoint();if(isNameCodePoint(codePoint)){result+=fromCodePoint$1(codePoint);}
else if(isValidEscape(codePoint,this.peekCodePoint(0))){result+=fromCodePoint$1(this.consumeEscapedCodePoint());}
else{this.reconsumeCodePoint(codePoint);return result;}}};return Tokenizer;}());var Parser=(function(){function Parser(tokens){this._tokens=tokens;}
Parser.create=function(value){var tokenizer=new Tokenizer();tokenizer.write(value);return new Parser(tokenizer.read());};Parser.parseValue=function(value){return Parser.create(value).parseComponentValue();};Parser.parseValues=function(value){return Parser.create(value).parseComponentValues();};Parser.prototype.parseComponentValue=function(){var token=this.consumeToken();while(token.type===31){token=this.consumeToken();}
if(token.type===32){throw new SyntaxError("Error parsing CSS component value, unexpected EOF");}
this.reconsumeToken(token);var value=this.consumeComponentValue();do{token=this.consumeToken();}while(token.type===31);if(token.type===32){return value;}
throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one");};Parser.prototype.parseComponentValues=function(){var values=[];while(true){var value=this.consumeComponentValue();if(value.type===32){return values;}
values.push(value);values.push();}};Parser.prototype.consumeComponentValue=function(){var token=this.consumeToken();switch(token.type){case 11:case 28:case 2:return this.consumeSimpleBlock(token.type);case 19:return this.consumeFunction(token);}
return token;};Parser.prototype.consumeSimpleBlock=function(type){var block={type:type,values:[]};var token=this.consumeToken();while(true){if(token.type===32||isEndingTokenFor(token,type)){return block;}
this.reconsumeToken(token);block.values.push(this.consumeComponentValue());token=this.consumeToken();}};Parser.prototype.consumeFunction=function(functionToken){var cssFunction={name:functionToken.value,values:[],type:18};while(true){var token=this.consumeToken();if(token.type===32||token.type===3){return cssFunction;}
this.reconsumeToken(token);cssFunction.values.push(this.consumeComponentValue());}};Parser.prototype.consumeToken=function(){var token=this._tokens.shift();return typeof token==='undefined'?EOF_TOKEN:token;};Parser.prototype.reconsumeToken=function(token){this._tokens.unshift(token);};return Parser;}());var isDimensionToken=function(token){return token.type===15;};var isNumberToken=function(token){return token.type===17;};var isIdentToken=function(token){return token.type===20;};var isStringToken=function(token){return token.type===0;};var isIdentWithValue=function(token,value){return isIdentToken(token)&&token.value===value;};var nonWhiteSpace=function(token){return token.type!==31;};var nonFunctionArgSeparator=function(token){return token.type!==31&&token.type!==4;};var parseFunctionArgs=function(tokens){var args=[];var arg=[];tokens.forEach(function(token){if(token.type===4){if(arg.length===0){throw new Error("Error parsing function args, zero tokens for arg");}
args.push(arg);arg=[];return;}
if(token.type!==31){arg.push(token);}});if(arg.length){args.push(arg);}
return args;};var isEndingTokenFor=function(token,type){if(type===11&&token.type===12){return true;}
if(type===28&&token.type===29){return true;}
return type===2&&token.type===3;};var isLength=function(token){return token.type===17||token.type===15;};var isLengthPercentage=function(token){return token.type===16||isLength(token);};var parseLengthPercentageTuple=function(tokens){return tokens.length>1?[tokens[0],tokens[1]]:[tokens[0]];};var ZERO_LENGTH={type:17,number:0,flags:FLAG_INTEGER};var FIFTY_PERCENT={type:16,number:50,flags:FLAG_INTEGER};var HUNDRED_PERCENT={type:16,number:100,flags:FLAG_INTEGER};var getAbsoluteValueForTuple=function(tuple,width,height){var x=tuple[0],y=tuple[1];return[getAbsoluteValue(x,width),getAbsoluteValue(typeof y!=='undefined'?y:x,height)];};var getAbsoluteValue=function(token,parent){if(token.type===16){return(token.number/100)*parent;}
if(isDimensionToken(token)){switch(token.unit){case'rem':case'em':return 16*token.number;case'px':default:return token.number;}}
return token.number;};var DEG='deg';var GRAD='grad';var RAD='rad';var TURN='turn';var angle={name:'angle',parse:function(_context,value){if(value.type===15){switch(value.unit){case DEG:return(Math.PI*value.number)/180;case GRAD:return(Math.PI/200)*value.number;case RAD:return value.number;case TURN:return Math.PI*2*value.number;}}
throw new Error("Unsupported angle type");}};var isAngle=function(value){if(value.type===15){if(value.unit===DEG||value.unit===GRAD||value.unit===RAD||value.unit===TURN){return true;}}
return false;};var parseNamedSide=function(tokens){var sideOrCorner=tokens.filter(isIdentToken).map(function(ident){return ident.value;}).join(' ');switch(sideOrCorner){case'to bottom right':case'to right bottom':case'left top':case'top left':return[ZERO_LENGTH,ZERO_LENGTH];case'to top':case'bottom':return deg(0);case'to bottom left':case'to left bottom':case'right top':case'top right':return[ZERO_LENGTH,HUNDRED_PERCENT];case'to right':case'left':return deg(90);case'to top left':case'to left top':case'right bottom':case'bottom right':return[HUNDRED_PERCENT,HUNDRED_PERCENT];case'to bottom':case'top':return deg(180);case'to top right':case'to right top':case'left bottom':case'bottom left':return[HUNDRED_PERCENT,ZERO_LENGTH];case'to left':case'right':return deg(270);}
return 0;};var deg=function(deg){return(Math.PI*deg)/180;};var color$1={name:'color',parse:function(context,value){if(value.type===18){var colorFunction=SUPPORTED_COLOR_FUNCTIONS[value.name];if(typeof colorFunction==='undefined'){throw new Error("Attempting to parse an unsupported color function \""+value.name+"\"");}
return colorFunction(context,value.values);}
if(value.type===5){if(value.value.length===3){var r=value.value.substring(0,1);var g=value.value.substring(1,2);var b=value.value.substring(2,3);return pack(parseInt(r+r,16),parseInt(g+g,16),parseInt(b+b,16),1);}
if(value.value.length===4){var r=value.value.substring(0,1);var g=value.value.substring(1,2);var b=value.value.substring(2,3);var a=value.value.substring(3,4);return pack(parseInt(r+r,16),parseInt(g+g,16),parseInt(b+b,16),parseInt(a+a,16)/255);}
if(value.value.length===6){var r=value.value.substring(0,2);var g=value.value.substring(2,4);var b=value.value.substring(4,6);return pack(parseInt(r,16),parseInt(g,16),parseInt(b,16),1);}
if(value.value.length===8){var r=value.value.substring(0,2);var g=value.value.substring(2,4);var b=value.value.substring(4,6);var a=value.value.substring(6,8);return pack(parseInt(r,16),parseInt(g,16),parseInt(b,16),parseInt(a,16)/255);}}
if(value.type===20){var namedColor=COLORS[value.value.toUpperCase()];if(typeof namedColor!=='undefined'){return namedColor;}}
return COLORS.TRANSPARENT;}};var isTransparent=function(color){return(0xff&color)===0;};var asString=function(color){var alpha=0xff&color;var blue=0xff&(color>>8);var green=0xff&(color>>16);var red=0xff&(color>>24);return alpha<255?"rgba("+red+","+green+","+blue+","+alpha/255+")":"rgb("+red+","+green+","+blue+")";};var pack=function(r,g,b,a){return((r<<24)|(g<<16)|(b<<8)|(Math.round(a*255)<<0))>>>0;};var getTokenColorValue=function(token,i){if(token.type===17){return token.number;}
if(token.type===16){var max=i===3?1:255;return i===3?(token.number/100)*max:Math.round((token.number/100)*max);}
return 0;};var rgb=function(_context,args){var tokens=args.filter(nonFunctionArgSeparator);if(tokens.length===3){var _a=tokens.map(getTokenColorValue),r=_a[0],g=_a[1],b=_a[2];return pack(r,g,b,1);}
if(tokens.length===4){var _b=tokens.map(getTokenColorValue),r=_b[0],g=_b[1],b=_b[2],a=_b[3];return pack(r,g,b,a);}
return 0;};function hue2rgb(t1,t2,hue){if(hue<0){hue+=1;}
if(hue>=1){hue-=1;}
if(hue<1/6){return(t2-t1)*hue*6+t1;}
else if(hue<1/2){return t2;}
else if(hue<2/3){return(t2-t1)*6*(2/3-hue)+t1;}
else{return t1;}}
var hsl=function(context,args){var tokens=args.filter(nonFunctionArgSeparator);var hue=tokens[0],saturation=tokens[1],lightness=tokens[2],alpha=tokens[3];var h=(hue.type===17?deg(hue.number):angle.parse(context,hue))/(Math.PI*2);var s=isLengthPercentage(saturation)?saturation.number/100:0;var l=isLengthPercentage(lightness)?lightness.number/100:0;var a=typeof alpha!=='undefined'&&isLengthPercentage(alpha)?getAbsoluteValue(alpha,1):1;if(s===0){return pack(l*255,l*255,l*255,1);}
var t2=l<=0.5?l*(s+1):l+s-l*s;var t1=l*2-t2;var r=hue2rgb(t1,t2,h+1/3);var g=hue2rgb(t1,t2,h);var b=hue2rgb(t1,t2,h-1/3);return pack(r*255,g*255,b*255,a);};var SUPPORTED_COLOR_FUNCTIONS={hsl:hsl,hsla:hsl,rgb:rgb,rgba:rgb};var parseColor=function(context,value){return color$1.parse(context,Parser.create(value).parseComponentValue());};var COLORS={ALICEBLUE:0xf0f8ffff,ANTIQUEWHITE:0xfaebd7ff,AQUA:0x00ffffff,AQUAMARINE:0x7fffd4ff,AZURE:0xf0ffffff,BEIGE:0xf5f5dcff,BISQUE:0xffe4c4ff,BLACK:0x000000ff,BLANCHEDALMOND:0xffebcdff,BLUE:0x0000ffff,BLUEVIOLET:0x8a2be2ff,BROWN:0xa52a2aff,BURLYWOOD:0xdeb887ff,CADETBLUE:0x5f9ea0ff,CHARTREUSE:0x7fff00ff,CHOCOLATE:0xd2691eff,CORAL:0xff7f50ff,CORNFLOWERBLUE:0x6495edff,CORNSILK:0xfff8dcff,CRIMSON:0xdc143cff,CYAN:0x00ffffff,DARKBLUE:0x00008bff,DARKCYAN:0x008b8bff,DARKGOLDENROD:0xb886bbff,DARKGRAY:0xa9a9a9ff,DARKGREEN:0x006400ff,DARKGREY:0xa9a9a9ff,DARKKHAKI:0xbdb76bff,DARKMAGENTA:0x8b008bff,DARKOLIVEGREEN:0x556b2fff,DARKORANGE:0xff8c00ff,DARKORCHID:0x9932ccff,DARKRED:0x8b0000ff,DARKSALMON:0xe9967aff,DARKSEAGREEN:0x8fbc8fff,DARKSLATEBLUE:0x483d8bff,DARKSLATEGRAY:0x2f4f4fff,DARKSLATEGREY:0x2f4f4fff,DARKTURQUOISE:0x00ced1ff,DARKVIOLET:0x9400d3ff,DEEPPINK:0xff1493ff,DEEPSKYBLUE:0x00bfffff,DIMGRAY:0x696969ff,DIMGREY:0x696969ff,DODGERBLUE:0x1e90ffff,FIREBRICK:0xb22222ff,FLORALWHITE:0xfffaf0ff,FORESTGREEN:0x228b22ff,FUCHSIA:0xff00ffff,GAINSBORO:0xdcdcdcff,GHOSTWHITE:0xf8f8ffff,GOLD:0xffd700ff,GOLDENROD:0xdaa520ff,GRAY:0x808080ff,GREEN:0x008000ff,GREENYELLOW:0xadff2fff,GREY:0x808080ff,HONEYDEW:0xf0fff0ff,HOTPINK:0xff69b4ff,INDIANRED:0xcd5c5cff,INDIGO:0x4b0082ff,IVORY:0xfffff0ff,KHAKI:0xf0e68cff,LAVENDER:0xe6e6faff,LAVENDERBLUSH:0xfff0f5ff,LAWNGREEN:0x7cfc00ff,LEMONCHIFFON:0xfffacdff,LIGHTBLUE:0xadd8e6ff,LIGHTCORAL:0xf08080ff,LIGHTCYAN:0xe0ffffff,LIGHTGOLDENRODYELLOW:0xfafad2ff,LIGHTGRAY:0xd3d3d3ff,LIGHTGREEN:0x90ee90ff,LIGHTGREY:0xd3d3d3ff,LIGHTPINK:0xffb6c1ff,LIGHTSALMON:0xffa07aff,LIGHTSEAGREEN:0x20b2aaff,LIGHTSKYBLUE:0x87cefaff,LIGHTSLATEGRAY:0x778899ff,LIGHTSLATEGREY:0x778899ff,LIGHTSTEELBLUE:0xb0c4deff,LIGHTYELLOW:0xffffe0ff,LIME:0x00ff00ff,LIMEGREEN:0x32cd32ff,LINEN:0xfaf0e6ff,MAGENTA:0xff00ffff,MAROON:0x800000ff,MEDIUMAQUAMARINE:0x66cdaaff,MEDIUMBLUE:0x0000cdff,MEDIUMORCHID:0xba55d3ff,MEDIUMPURPLE:0x9370dbff,MEDIUMSEAGREEN:0x3cb371ff,MEDIUMSLATEBLUE:0x7b68eeff,MEDIUMSPRINGGREEN:0x00fa9aff,MEDIUMTURQUOISE:0x48d1ccff,MEDIUMVIOLETRED:0xc71585ff,MIDNIGHTBLUE:0x191970ff,MINTCREAM:0xf5fffaff,MISTYROSE:0xffe4e1ff,MOCCASIN:0xffe4b5ff,NAVAJOWHITE:0xffdeadff,NAVY:0x000080ff,OLDLACE:0xfdf5e6ff,OLIVE:0x808000ff,OLIVEDRAB:0x6b8e23ff,ORANGE:0xffa500ff,ORANGERED:0xff4500ff,ORCHID:0xda70d6ff,PALEGOLDENROD:0xeee8aaff,PALEGREEN:0x98fb98ff,PALETURQUOISE:0xafeeeeff,PALEVIOLETRED:0xdb7093ff,PAPAYAWHIP:0xffefd5ff,PEACHPUFF:0xffdab9ff,PERU:0xcd853fff,PINK:0xffc0cbff,PLUM:0xdda0ddff,POWDERBLUE:0xb0e0e6ff,PURPLE:0x800080ff,REBECCAPURPLE:0x663399ff,RED:0xff0000ff,ROSYBROWN:0xbc8f8fff,ROYALBLUE:0x4169e1ff,SADDLEBROWN:0x8b4513ff,SALMON:0xfa8072ff,SANDYBROWN:0xf4a460ff,SEAGREEN:0x2e8b57ff,SEASHELL:0xfff5eeff,SIENNA:0xa0522dff,SILVER:0xc0c0c0ff,SKYBLUE:0x87ceebff,SLATEBLUE:0x6a5acdff,SLATEGRAY:0x708090ff,SLATEGREY:0x708090ff,SNOW:0xfffafaff,SPRINGGREEN:0x00ff7fff,STEELBLUE:0x4682b4ff,TAN:0xd2b48cff,TEAL:0x008080ff,THISTLE:0xd8bfd8ff,TOMATO:0xff6347ff,TRANSPARENT:0x00000000,TURQUOISE:0x40e0d0ff,VIOLET:0xee82eeff,WHEAT:0xf5deb3ff,WHITE:0xffffffff,WHITESMOKE:0xf5f5f5ff,YELLOW:0xffff00ff,YELLOWGREEN:0x9acd32ff};var backgroundClip={name:'background-clip',initialValue:'border-box',prefix:false,type:1,parse:function(_context,tokens){return tokens.map(function(token){if(isIdentToken(token)){switch(token.value){case'padding-box':return 1;case'content-box':return 2;}}
return 0;});}};var backgroundColor={name:"background-color",initialValue:'transparent',prefix:false,type:3,format:'color'};var parseColorStop=function(context,args){var color=color$1.parse(context,args[0]);var stop=args[1];return stop&&isLengthPercentage(stop)?{color:color,stop:stop}:{color:color,stop:null};};var processColorStops=function(stops,lineLength){var first=stops[0];var last=stops[stops.length-1];if(first.stop===null){first.stop=ZERO_LENGTH;}
if(last.stop===null){last.stop=HUNDRED_PERCENT;}
var processStops=[];var previous=0;for(var i=0;i<stops.length;i++){var stop_1=stops[i].stop;if(stop_1!==null){var absoluteValue=getAbsoluteValue(stop_1,lineLength);if(absoluteValue>previous){processStops.push(absoluteValue);}
else{processStops.push(previous);}
previous=absoluteValue;}
else{processStops.push(null);}}
var gapBegin=null;for(var i=0;i<processStops.length;i++){var stop_2=processStops[i];if(stop_2===null){if(gapBegin===null){gapBegin=i;}}
else if(gapBegin!==null){var gapLength=i-gapBegin;var beforeGap=processStops[gapBegin-1];var gapValue=(stop_2-beforeGap)/(gapLength+1);for(var g=1;g<=gapLength;g++){processStops[gapBegin+g-1]=gapValue*g;}
gapBegin=null;}}
return stops.map(function(_a,i){var color=_a.color;return{color:color,stop:Math.max(Math.min(1,processStops[i]/lineLength),0)};});};var getAngleFromCorner=function(corner,width,height){var centerX=width/2;var centerY=height/2;var x=getAbsoluteValue(corner[0],width)-centerX;var y=centerY-getAbsoluteValue(corner[1],height);return(Math.atan2(y,x)+Math.PI*2)%(Math.PI*2);};var calculateGradientDirection=function(angle,width,height){var radian=typeof angle==='number'?angle:getAngleFromCorner(angle,width,height);var lineLength=Math.abs(width*Math.sin(radian))+Math.abs(height*Math.cos(radian));var halfWidth=width/2;var halfHeight=height/2;var halfLineLength=lineLength/2;var yDiff=Math.sin(radian-Math.PI/2)*halfLineLength;var xDiff=Math.cos(radian-Math.PI/2)*halfLineLength;return[lineLength,halfWidth-xDiff,halfWidth+xDiff,halfHeight-yDiff,halfHeight+yDiff];};var distance=function(a,b){return Math.sqrt(a*a+b*b);};var findCorner=function(width,height,x,y,closest){var corners=[[0,0],[0,height],[width,0],[width,height]];return corners.reduce(function(stat,corner){var cx=corner[0],cy=corner[1];var d=distance(x-cx,y-cy);if(closest?d<stat.optimumDistance:d>stat.optimumDistance){return{optimumCorner:corner,optimumDistance:d};}
return stat;},{optimumDistance:closest?Infinity:-Infinity,optimumCorner:null}).optimumCorner;};var calculateRadius=function(gradient,x,y,width,height){var rx=0;var ry=0;switch(gradient.size){case 0:if(gradient.shape===0){rx=ry=Math.min(Math.abs(x),Math.abs(x-width),Math.abs(y),Math.abs(y-height));}
else if(gradient.shape===1){rx=Math.min(Math.abs(x),Math.abs(x-width));ry=Math.min(Math.abs(y),Math.abs(y-height));}
break;case 2:if(gradient.shape===0){rx=ry=Math.min(distance(x,y),distance(x,y-height),distance(x-width,y),distance(x-width,y-height));}
else if(gradient.shape===1){var c=Math.min(Math.abs(y),Math.abs(y-height))/Math.min(Math.abs(x),Math.abs(x-width));var _a=findCorner(width,height,x,y,true),cx=_a[0],cy=_a[1];rx=distance(cx-x,(cy-y)/c);ry=c*rx;}
break;case 1:if(gradient.shape===0){rx=ry=Math.max(Math.abs(x),Math.abs(x-width),Math.abs(y),Math.abs(y-height));}
else if(gradient.shape===1){rx=Math.max(Math.abs(x),Math.abs(x-width));ry=Math.max(Math.abs(y),Math.abs(y-height));}
break;case 3:if(gradient.shape===0){rx=ry=Math.max(distance(x,y),distance(x,y-height),distance(x-width,y),distance(x-width,y-height));}
else if(gradient.shape===1){var c=Math.max(Math.abs(y),Math.abs(y-height))/Math.max(Math.abs(x),Math.abs(x-width));var _b=findCorner(width,height,x,y,false),cx=_b[0],cy=_b[1];rx=distance(cx-x,(cy-y)/c);ry=c*rx;}
break;}
if(Array.isArray(gradient.size)){rx=getAbsoluteValue(gradient.size[0],width);ry=gradient.size.length===2?getAbsoluteValue(gradient.size[1],height):rx;}
return[rx,ry];};var linearGradient=function(context,tokens){var angle$1=deg(180);var stops=[];parseFunctionArgs(tokens).forEach(function(arg,i){if(i===0){var firstToken=arg[0];if(firstToken.type===20&&firstToken.value==='to'){angle$1=parseNamedSide(arg);return;}
else if(isAngle(firstToken)){angle$1=angle.parse(context,firstToken);return;}}
var colorStop=parseColorStop(context,arg);stops.push(colorStop);});return{angle:angle$1,stops:stops,type:1};};var prefixLinearGradient=function(context,tokens){var angle$1=deg(180);var stops=[];parseFunctionArgs(tokens).forEach(function(arg,i){if(i===0){var firstToken=arg[0];if(firstToken.type===20&&['top','left','right','bottom'].indexOf(firstToken.value)!==-1){angle$1=parseNamedSide(arg);return;}
else if(isAngle(firstToken)){angle$1=(angle.parse(context,firstToken)+deg(270))%deg(360);return;}}
var colorStop=parseColorStop(context,arg);stops.push(colorStop);});return{angle:angle$1,stops:stops,type:1};};var webkitGradient=function(context,tokens){var angle=deg(180);var stops=[];var type=1;var shape=0;var size=3;var position=[];parseFunctionArgs(tokens).forEach(function(arg,i){var firstToken=arg[0];if(i===0){if(isIdentToken(firstToken)&&firstToken.value==='linear'){type=1;return;}
else if(isIdentToken(firstToken)&&firstToken.value==='radial'){type=2;return;}}
if(firstToken.type===18){if(firstToken.name==='from'){var color=color$1.parse(context,firstToken.values[0]);stops.push({stop:ZERO_LENGTH,color:color});}
else if(firstToken.name==='to'){var color=color$1.parse(context,firstToken.values[0]);stops.push({stop:HUNDRED_PERCENT,color:color});}
else if(firstToken.name==='color-stop'){var values=firstToken.values.filter(nonFunctionArgSeparator);if(values.length===2){var color=color$1.parse(context,values[1]);var stop_1=values[0];if(isNumberToken(stop_1)){stops.push({stop:{type:16,number:stop_1.number*100,flags:stop_1.flags},color:color});}}}}});return type===1?{angle:(angle+deg(180))%deg(360),stops:stops,type:type}:{size:size,shape:shape,stops:stops,position:position,type:type};};var CLOSEST_SIDE='closest-side';var FARTHEST_SIDE='farthest-side';var CLOSEST_CORNER='closest-corner';var FARTHEST_CORNER='farthest-corner';var CIRCLE='circle';var ELLIPSE='ellipse';var COVER='cover';var CONTAIN='contain';var radialGradient=function(context,tokens){var shape=0;var size=3;var stops=[];var position=[];parseFunctionArgs(tokens).forEach(function(arg,i){var isColorStop=true;if(i===0){var isAtPosition_1=false;isColorStop=arg.reduce(function(acc,token){if(isAtPosition_1){if(isIdentToken(token)){switch(token.value){case'center':position.push(FIFTY_PERCENT);return acc;case'top':case'left':position.push(ZERO_LENGTH);return acc;case'right':case'bottom':position.push(HUNDRED_PERCENT);return acc;}}
else if(isLengthPercentage(token)||isLength(token)){position.push(token);}}
else if(isIdentToken(token)){switch(token.value){case CIRCLE:shape=0;return false;case ELLIPSE:shape=1;return false;case'at':isAtPosition_1=true;return false;case CLOSEST_SIDE:size=0;return false;case COVER:case FARTHEST_SIDE:size=1;return false;case CONTAIN:case CLOSEST_CORNER:size=2;return false;case FARTHEST_CORNER:size=3;return false;}}
else if(isLength(token)||isLengthPercentage(token)){if(!Array.isArray(size)){size=[];}
size.push(token);return false;}
return acc;},isColorStop);}
if(isColorStop){var colorStop=parseColorStop(context,arg);stops.push(colorStop);}});return{size:size,shape:shape,stops:stops,position:position,type:2};};var prefixRadialGradient=function(context,tokens){var shape=0;var size=3;var stops=[];var position=[];parseFunctionArgs(tokens).forEach(function(arg,i){var isColorStop=true;if(i===0){isColorStop=arg.reduce(function(acc,token){if(isIdentToken(token)){switch(token.value){case'center':position.push(FIFTY_PERCENT);return false;case'top':case'left':position.push(ZERO_LENGTH);return false;case'right':case'bottom':position.push(HUNDRED_PERCENT);return false;}}
else if(isLengthPercentage(token)||isLength(token)){position.push(token);return false;}
return acc;},isColorStop);}
else if(i===1){isColorStop=arg.reduce(function(acc,token){if(isIdentToken(token)){switch(token.value){case CIRCLE:shape=0;return false;case ELLIPSE:shape=1;return false;case CONTAIN:case CLOSEST_SIDE:size=0;return false;case FARTHEST_SIDE:size=1;return false;case CLOSEST_CORNER:size=2;return false;case COVER:case FARTHEST_CORNER:size=3;return false;}}
else if(isLength(token)||isLengthPercentage(token)){if(!Array.isArray(size)){size=[];}
size.push(token);return false;}
return acc;},isColorStop);}
if(isColorStop){var colorStop=parseColorStop(context,arg);stops.push(colorStop);}});return{size:size,shape:shape,stops:stops,position:position,type:2};};var isLinearGradient=function(background){return background.type===1;};var isRadialGradient=function(background){return background.type===2;};var image={name:'image',parse:function(context,value){if(value.type===22){var image_1={url:value.value,type:0};context.cache.addImage(value.value);return image_1;}
if(value.type===18){var imageFunction=SUPPORTED_IMAGE_FUNCTIONS[value.name];if(typeof imageFunction==='undefined'){throw new Error("Attempting to parse an unsupported image function \""+value.name+"\"");}
return imageFunction(context,value.values);}
throw new Error("Unsupported image type "+value.type);}};function isSupportedImage(value){return(!(value.type===20&&value.value==='none')&&(value.type!==18||!!SUPPORTED_IMAGE_FUNCTIONS[value.name]));}
var SUPPORTED_IMAGE_FUNCTIONS={'linear-gradient':linearGradient,'-moz-linear-gradient':prefixLinearGradient,'-ms-linear-gradient':prefixLinearGradient,'-o-linear-gradient':prefixLinearGradient,'-webkit-linear-gradient':prefixLinearGradient,'radial-gradient':radialGradient,'-moz-radial-gradient':prefixRadialGradient,'-ms-radial-gradient':prefixRadialGradient,'-o-radial-gradient':prefixRadialGradient,'-webkit-radial-gradient':prefixRadialGradient,'-webkit-gradient':webkitGradient};var backgroundImage={name:'background-image',initialValue:'none',type:1,prefix:false,parse:function(context,tokens){if(tokens.length===0){return[];}
var first=tokens[0];if(first.type===20&&first.value==='none'){return[];}
return tokens.filter(function(value){return nonFunctionArgSeparator(value)&&isSupportedImage(value);}).map(function(value){return image.parse(context,value);});}};var backgroundOrigin={name:'background-origin',initialValue:'border-box',prefix:false,type:1,parse:function(_context,tokens){return tokens.map(function(token){if(isIdentToken(token)){switch(token.value){case'padding-box':return 1;case'content-box':return 2;}}
return 0;});}};var backgroundPosition={name:'background-position',initialValue:'0% 0%',type:1,prefix:false,parse:function(_context,tokens){return parseFunctionArgs(tokens).map(function(values){return values.filter(isLengthPercentage);}).map(parseLengthPercentageTuple);}};var backgroundRepeat={name:'background-repeat',initialValue:'repeat',prefix:false,type:1,parse:function(_context,tokens){return parseFunctionArgs(tokens).map(function(values){return values.filter(isIdentToken).map(function(token){return token.value;}).join(' ');}).map(parseBackgroundRepeat);}};var parseBackgroundRepeat=function(value){switch(value){case'no-repeat':return 1;case'repeat-x':case'repeat no-repeat':return 2;case'repeat-y':case'no-repeat repeat':return 3;case'repeat':default:return 0;}};var BACKGROUND_SIZE;(function(BACKGROUND_SIZE){BACKGROUND_SIZE["AUTO"]="auto";BACKGROUND_SIZE["CONTAIN"]="contain";BACKGROUND_SIZE["COVER"]="cover";})(BACKGROUND_SIZE||(BACKGROUND_SIZE={}));var backgroundSize={name:'background-size',initialValue:'0',prefix:false,type:1,parse:function(_context,tokens){return parseFunctionArgs(tokens).map(function(values){return values.filter(isBackgroundSizeInfoToken);});}};var isBackgroundSizeInfoToken=function(value){return isIdentToken(value)||isLengthPercentage(value);};var borderColorForSide=function(side){return({name:"border-"+side+"-color",initialValue:'transparent',prefix:false,type:3,format:'color'});};var borderTopColor=borderColorForSide('top');var borderRightColor=borderColorForSide('right');var borderBottomColor=borderColorForSide('bottom');var borderLeftColor=borderColorForSide('left');var borderRadiusForSide=function(side){return({name:"border-radius-"+side,initialValue:'0 0',prefix:false,type:1,parse:function(_context,tokens){return parseLengthPercentageTuple(tokens.filter(isLengthPercentage));}});};var borderTopLeftRadius=borderRadiusForSide('top-left');var borderTopRightRadius=borderRadiusForSide('top-right');var borderBottomRightRadius=borderRadiusForSide('bottom-right');var borderBottomLeftRadius=borderRadiusForSide('bottom-left');var borderStyleForSide=function(side){return({name:"border-"+side+"-style",initialValue:'solid',prefix:false,type:2,parse:function(_context,style){switch(style){case'none':return 0;case'dashed':return 2;case'dotted':return 3;case'double':return 4;}
return 1;}});};var borderTopStyle=borderStyleForSide('top');var borderRightStyle=borderStyleForSide('right');var borderBottomStyle=borderStyleForSide('bottom');var borderLeftStyle=borderStyleForSide('left');var borderWidthForSide=function(side){return({name:"border-"+side+"-width",initialValue:'0',type:0,prefix:false,parse:function(_context,token){if(isDimensionToken(token)){return token.number;}
return 0;}});};var borderTopWidth=borderWidthForSide('top');var borderRightWidth=borderWidthForSide('right');var borderBottomWidth=borderWidthForSide('bottom');var borderLeftWidth=borderWidthForSide('left');var color={name:"color",initialValue:'transparent',prefix:false,type:3,format:'color'};var direction={name:'direction',initialValue:'ltr',prefix:false,type:2,parse:function(_context,direction){switch(direction){case'rtl':return 1;case'ltr':default:return 0;}}};var display={name:'display',initialValue:'inline-block',prefix:false,type:1,parse:function(_context,tokens){return tokens.filter(isIdentToken).reduce(function(bit,token){return bit|parseDisplayValue(token.value);},0);}};var parseDisplayValue=function(display){switch(display){case'block':case'-webkit-box':return 2;case'inline':return 4;case'run-in':return 8;case'flow':return 16;case'flow-root':return 32;case'table':return 64;case'flex':case'-webkit-flex':return 128;case'grid':case'-ms-grid':return 256;case'ruby':return 512;case'subgrid':return 1024;case'list-item':return 2048;case'table-row-group':return 4096;case'table-header-group':return 8192;case'table-footer-group':return 16384;case'table-row':return 32768;case'table-cell':return 65536;case'table-column-group':return 131072;case'table-column':return 262144;case'table-caption':return 524288;case'ruby-base':return 1048576;case'ruby-text':return 2097152;case'ruby-base-container':return 4194304;case'ruby-text-container':return 8388608;case'contents':return 16777216;case'inline-block':return 33554432;case'inline-list-item':return 67108864;case'inline-table':return 134217728;case'inline-flex':return 268435456;case'inline-grid':return 536870912;}
return 0;};var float={name:'float',initialValue:'none',prefix:false,type:2,parse:function(_context,float){switch(float){case'left':return 1;case'right':return 2;case'inline-start':return 3;case'inline-end':return 4;}
return 0;}};var letterSpacing={name:'letter-spacing',initialValue:'0',prefix:false,type:0,parse:function(_context,token){if(token.type===20&&token.value==='normal'){return 0;}
if(token.type===17){return token.number;}
if(token.type===15){return token.number;}
return 0;}};var LINE_BREAK;(function(LINE_BREAK){LINE_BREAK["NORMAL"]="normal";LINE_BREAK["STRICT"]="strict";})(LINE_BREAK||(LINE_BREAK={}));var lineBreak={name:'line-break',initialValue:'normal',prefix:false,type:2,parse:function(_context,lineBreak){switch(lineBreak){case'strict':return LINE_BREAK.STRICT;case'normal':default:return LINE_BREAK.NORMAL;}}};var lineHeight={name:'line-height',initialValue:'normal',prefix:false,type:4};var computeLineHeight=function(token,fontSize){if(isIdentToken(token)&&token.value==='normal'){return 1.2*fontSize;}
else if(token.type===17){return fontSize*token.number;}
else if(isLengthPercentage(token)){return getAbsoluteValue(token,fontSize);}
return fontSize;};var listStyleImage={name:'list-style-image',initialValue:'none',type:0,prefix:false,parse:function(context,token){if(token.type===20&&token.value==='none'){return null;}
return image.parse(context,token);}};var listStylePosition={name:'list-style-position',initialValue:'outside',prefix:false,type:2,parse:function(_context,position){switch(position){case'inside':return 0;case'outside':default:return 1;}}};var listStyleType={name:'list-style-type',initialValue:'none',prefix:false,type:2,parse:function(_context,type){switch(type){case'disc':return 0;case'circle':return 1;case'square':return 2;case'decimal':return 3;case'cjk-decimal':return 4;case'decimal-leading-zero':return 5;case'lower-roman':return 6;case'upper-roman':return 7;case'lower-greek':return 8;case'lower-alpha':return 9;case'upper-alpha':return 10;case'arabic-indic':return 11;case'armenian':return 12;case'bengali':return 13;case'cambodian':return 14;case'cjk-earthly-branch':return 15;case'cjk-heavenly-stem':return 16;case'cjk-ideographic':return 17;case'devanagari':return 18;case'ethiopic-numeric':return 19;case'georgian':return 20;case'gujarati':return 21;case'gurmukhi':return 22;case'hebrew':return 22;case'hiragana':return 23;case'hiragana-iroha':return 24;case'japanese-formal':return 25;case'japanese-informal':return 26;case'kannada':return 27;case'katakana':return 28;case'katakana-iroha':return 29;case'khmer':return 30;case'korean-hangul-formal':return 31;case'korean-hanja-formal':return 32;case'korean-hanja-informal':return 33;case'lao':return 34;case'lower-armenian':return 35;case'malayalam':return 36;case'mongolian':return 37;case'myanmar':return 38;case'oriya':return 39;case'persian':return 40;case'simp-chinese-formal':return 41;case'simp-chinese-informal':return 42;case'tamil':return 43;case'telugu':return 44;case'thai':return 45;case'tibetan':return 46;case'trad-chinese-formal':return 47;case'trad-chinese-informal':return 48;case'upper-armenian':return 49;case'disclosure-open':return 50;case'disclosure-closed':return 51;case'none':default:return-1;}}};var marginForSide=function(side){return({name:"margin-"+side,initialValue:'0',prefix:false,type:4});};var marginTop=marginForSide('top');var marginRight=marginForSide('right');var marginBottom=marginForSide('bottom');var marginLeft=marginForSide('left');var overflow={name:'overflow',initialValue:'visible',prefix:false,type:1,parse:function(_context,tokens){return tokens.filter(isIdentToken).map(function(overflow){switch(overflow.value){case'hidden':return 1;case'scroll':return 2;case'clip':return 3;case'auto':return 4;case'visible':default:return 0;}});}};var overflowWrap={name:'overflow-wrap',initialValue:'normal',prefix:false,type:2,parse:function(_context,overflow){switch(overflow){case'break-word':return"break-word";case'normal':default:return"normal";}}};var paddingForSide=function(side){return({name:"padding-"+side,initialValue:'0',prefix:false,type:3,format:'length-percentage'});};var paddingTop=paddingForSide('top');var paddingRight=paddingForSide('right');var paddingBottom=paddingForSide('bottom');var paddingLeft=paddingForSide('left');var textAlign={name:'text-align',initialValue:'left',prefix:false,type:2,parse:function(_context,textAlign){switch(textAlign){case'right':return 2;case'center':case'justify':return 1;case'left':default:return 0;}}};var position={name:'position',initialValue:'static',prefix:false,type:2,parse:function(_context,position){switch(position){case'relative':return 1;case'absolute':return 2;case'fixed':return 3;case'sticky':return 4;}
return 0;}};var textShadow={name:'text-shadow',initialValue:'none',type:1,prefix:false,parse:function(context,tokens){if(tokens.length===1&&isIdentWithValue(tokens[0],'none')){return[];}
return parseFunctionArgs(tokens).map(function(values){var shadow={color:COLORS.TRANSPARENT,offsetX:ZERO_LENGTH,offsetY:ZERO_LENGTH,blur:ZERO_LENGTH};var c=0;for(var i=0;i<values.length;i++){var token=values[i];if(isLength(token)){if(c===0){shadow.offsetX=token;}
else if(c===1){shadow.offsetY=token;}
else{shadow.blur=token;}
c++;}
else{shadow.color=color$1.parse(context,token);}}
return shadow;});}};var textTransform={name:'text-transform',initialValue:'none',prefix:false,type:2,parse:function(_context,textTransform){switch(textTransform){case'uppercase':return 2;case'lowercase':return 1;case'capitalize':return 3;}
return 0;}};var transform$1={name:'transform',initialValue:'none',prefix:true,type:0,parse:function(_context,token){if(token.type===20&&token.value==='none'){return null;}
if(token.type===18){var transformFunction=SUPPORTED_TRANSFORM_FUNCTIONS[token.name];if(typeof transformFunction==='undefined'){throw new Error("Attempting to parse an unsupported transform function \""+token.name+"\"");}
return transformFunction(token.values);}
return null;}};var matrix=function(args){var values=args.filter(function(arg){return arg.type===17;}).map(function(arg){return arg.number;});return values.length===6?values:null;};var matrix3d=function(args){var values=args.filter(function(arg){return arg.type===17;}).map(function(arg){return arg.number;});var a1=values[0],b1=values[1];values[2];values[3];var a2=values[4],b2=values[5];values[6];values[7];values[8];values[9];values[10];values[11];var a4=values[12],b4=values[13];values[14];values[15];return values.length===16?[a1,b1,a2,b2,a4,b4]:null;};var SUPPORTED_TRANSFORM_FUNCTIONS={matrix:matrix,matrix3d:matrix3d};var DEFAULT_VALUE={type:16,number:50,flags:FLAG_INTEGER};var DEFAULT=[DEFAULT_VALUE,DEFAULT_VALUE];var transformOrigin={name:'transform-origin',initialValue:'50% 50%',prefix:true,type:1,parse:function(_context,tokens){var origins=tokens.filter(isLengthPercentage);if(origins.length!==2){return DEFAULT;}
return[origins[0],origins[1]];}};var visibility={name:'visible',initialValue:'none',prefix:false,type:2,parse:function(_context,visibility){switch(visibility){case'hidden':return 1;case'collapse':return 2;case'visible':default:return 0;}}};var WORD_BREAK;(function(WORD_BREAK){WORD_BREAK["NORMAL"]="normal";WORD_BREAK["BREAK_ALL"]="break-all";WORD_BREAK["KEEP_ALL"]="keep-all";})(WORD_BREAK||(WORD_BREAK={}));var wordBreak={name:'word-break',initialValue:'normal',prefix:false,type:2,parse:function(_context,wordBreak){switch(wordBreak){case'break-all':return WORD_BREAK.BREAK_ALL;case'keep-all':return WORD_BREAK.KEEP_ALL;case'normal':default:return WORD_BREAK.NORMAL;}}};var zIndex={name:'z-index',initialValue:'auto',prefix:false,type:0,parse:function(_context,token){if(token.type===20){return{auto:true,order:0};}
if(isNumberToken(token)){return{auto:false,order:token.number};}
throw new Error("Invalid z-index number parsed");}};var time={name:'time',parse:function(_context,value){if(value.type===15){switch(value.unit.toLowerCase()){case's':return 1000*value.number;case'ms':return value.number;}}
throw new Error("Unsupported time type");}};var opacity={name:'opacity',initialValue:'1',type:0,prefix:false,parse:function(_context,token){if(isNumberToken(token)){return token.number;}
return 1;}};var textDecorationColor={name:"text-decoration-color",initialValue:'transparent',prefix:false,type:3,format:'color'};var textDecorationLine={name:'text-decoration-line',initialValue:'none',prefix:false,type:1,parse:function(_context,tokens){return tokens.filter(isIdentToken).map(function(token){switch(token.value){case'underline':return 1;case'overline':return 2;case'line-through':return 3;case'none':return 4;}
return 0;}).filter(function(line){return line!==0;});}};var fontFamily={name:"font-family",initialValue:'',prefix:false,type:1,parse:function(_context,tokens){var accumulator=[];var results=[];tokens.forEach(function(token){switch(token.type){case 20:case 0:accumulator.push(token.value);break;case 17:accumulator.push(token.number.toString());break;case 4:results.push(accumulator.join(' '));accumulator.length=0;break;}});if(accumulator.length){results.push(accumulator.join(' '));}
return results.map(function(result){return(result.indexOf(' ')===-1?result:"'"+result+"'");});}};var fontSize={name:"font-size",initialValue:'0',prefix:false,type:3,format:'length'};var fontWeight={name:'font-weight',initialValue:'normal',type:0,prefix:false,parse:function(_context,token){if(isNumberToken(token)){return token.number;}
if(isIdentToken(token)){switch(token.value){case'bold':return 700;case'normal':default:return 400;}}
return 400;}};var fontVariant={name:'font-variant',initialValue:'none',type:1,prefix:false,parse:function(_context,tokens){return tokens.filter(isIdentToken).map(function(token){return token.value;});}};var fontStyle={name:'font-style',initialValue:'normal',prefix:false,type:2,parse:function(_context,overflow){switch(overflow){case'oblique':return"oblique";case'italic':return"italic";case'normal':default:return"normal";}}};var contains=function(bit,value){return(bit&value)!==0;};var content={name:'content',initialValue:'none',type:1,prefix:false,parse:function(_context,tokens){if(tokens.length===0){return[];}
var first=tokens[0];if(first.type===20&&first.value==='none'){return[];}
return tokens;}};var counterIncrement={name:'counter-increment',initialValue:'none',prefix:true,type:1,parse:function(_context,tokens){if(tokens.length===0){return null;}
var first=tokens[0];if(first.type===20&&first.value==='none'){return null;}
var increments=[];var filtered=tokens.filter(nonWhiteSpace);for(var i=0;i<filtered.length;i++){var counter=filtered[i];var next=filtered[i+1];if(counter.type===20){var increment=next&&isNumberToken(next)?next.number:1;increments.push({counter:counter.value,increment:increment});}}
return increments;}};var counterReset={name:'counter-reset',initialValue:'none',prefix:true,type:1,parse:function(_context,tokens){if(tokens.length===0){return[];}
var resets=[];var filtered=tokens.filter(nonWhiteSpace);for(var i=0;i<filtered.length;i++){var counter=filtered[i];var next=filtered[i+1];if(isIdentToken(counter)&&counter.value!=='none'){var reset=next&&isNumberToken(next)?next.number:0;resets.push({counter:counter.value,reset:reset});}}
return resets;}};var duration={name:'duration',initialValue:'0s',prefix:false,type:1,parse:function(context,tokens){return tokens.filter(isDimensionToken).map(function(token){return time.parse(context,token);});}};var quotes={name:'quotes',initialValue:'none',prefix:true,type:1,parse:function(_context,tokens){if(tokens.length===0){return null;}
var first=tokens[0];if(first.type===20&&first.value==='none'){return null;}
var quotes=[];var filtered=tokens.filter(isStringToken);if(filtered.length%2!==0){return null;}
for(var i=0;i<filtered.length;i+=2){var open_1=filtered[i].value;var close_1=filtered[i+1].value;quotes.push({open:open_1,close:close_1});}
return quotes;}};var getQuote=function(quotes,depth,open){if(!quotes){return'';}
var quote=quotes[Math.min(depth,quotes.length-1)];if(!quote){return'';}
return open?quote.open:quote.close;};var boxShadow={name:'box-shadow',initialValue:'none',type:1,prefix:false,parse:function(context,tokens){if(tokens.length===1&&isIdentWithValue(tokens[0],'none')){return[];}
return parseFunctionArgs(tokens).map(function(values){var shadow={color:0x000000ff,offsetX:ZERO_LENGTH,offsetY:ZERO_LENGTH,blur:ZERO_LENGTH,spread:ZERO_LENGTH,inset:false};var c=0;for(var i=0;i<values.length;i++){var token=values[i];if(isIdentWithValue(token,'inset')){shadow.inset=true;}
else if(isLength(token)){if(c===0){shadow.offsetX=token;}
else if(c===1){shadow.offsetY=token;}
else if(c===2){shadow.blur=token;}
else{shadow.spread=token;}
c++;}
else{shadow.color=color$1.parse(context,token);}}
return shadow;});}};var paintOrder={name:'paint-order',initialValue:'normal',prefix:false,type:1,parse:function(_context,tokens){var DEFAULT_VALUE=[0,1,2];var layers=[];tokens.filter(isIdentToken).forEach(function(token){switch(token.value){case'stroke':layers.push(1);break;case'fill':layers.push(0);break;case'markers':layers.push(2);break;}});DEFAULT_VALUE.forEach(function(value){if(layers.indexOf(value)===-1){layers.push(value);}});return layers;}};var webkitTextStrokeColor={name:"-webkit-text-stroke-color",initialValue:'currentcolor',prefix:false,type:3,format:'color'};var webkitTextStrokeWidth={name:"-webkit-text-stroke-width",initialValue:'0',type:0,prefix:false,parse:function(_context,token){if(isDimensionToken(token)){return token.number;}
return 0;}};var CSSParsedDeclaration=(function(){function CSSParsedDeclaration(context,declaration){var _a,_b;this.animationDuration=parse(context,duration,declaration.animationDuration);this.backgroundClip=parse(context,backgroundClip,declaration.backgroundClip);this.backgroundColor=parse(context,backgroundColor,declaration.backgroundColor);this.backgroundImage=parse(context,backgroundImage,declaration.backgroundImage);this.backgroundOrigin=parse(context,backgroundOrigin,declaration.backgroundOrigin);this.backgroundPosition=parse(context,backgroundPosition,declaration.backgroundPosition);this.backgroundRepeat=parse(context,backgroundRepeat,declaration.backgroundRepeat);this.backgroundSize=parse(context,backgroundSize,declaration.backgroundSize);this.borderTopColor=parse(context,borderTopColor,declaration.borderTopColor);this.borderRightColor=parse(context,borderRightColor,declaration.borderRightColor);this.borderBottomColor=parse(context,borderBottomColor,declaration.borderBottomColor);this.borderLeftColor=parse(context,borderLeftColor,declaration.borderLeftColor);this.borderTopLeftRadius=parse(context,borderTopLeftRadius,declaration.borderTopLeftRadius);this.borderTopRightRadius=parse(context,borderTopRightRadius,declaration.borderTopRightRadius);this.borderBottomRightRadius=parse(context,borderBottomRightRadius,declaration.borderBottomRightRadius);this.borderBottomLeftRadius=parse(context,borderBottomLeftRadius,declaration.borderBottomLeftRadius);this.borderTopStyle=parse(context,borderTopStyle,declaration.borderTopStyle);this.borderRightStyle=parse(context,borderRightStyle,declaration.borderRightStyle);this.borderBottomStyle=parse(context,borderBottomStyle,declaration.borderBottomStyle);this.borderLeftStyle=parse(context,borderLeftStyle,declaration.borderLeftStyle);this.borderTopWidth=parse(context,borderTopWidth,declaration.borderTopWidth);this.borderRightWidth=parse(context,borderRightWidth,declaration.borderRightWidth);this.borderBottomWidth=parse(context,borderBottomWidth,declaration.borderBottomWidth);this.borderLeftWidth=parse(context,borderLeftWidth,declaration.borderLeftWidth);this.boxShadow=parse(context,boxShadow,declaration.boxShadow);this.color=parse(context,color,declaration.color);this.direction=parse(context,direction,declaration.direction);this.display=parse(context,display,declaration.display);this.float=parse(context,float,declaration.cssFloat);this.fontFamily=parse(context,fontFamily,declaration.fontFamily);this.fontSize=parse(context,fontSize,declaration.fontSize);this.fontStyle=parse(context,fontStyle,declaration.fontStyle);this.fontVariant=parse(context,fontVariant,declaration.fontVariant);this.fontWeight=parse(context,fontWeight,declaration.fontWeight);this.letterSpacing=parse(context,letterSpacing,declaration.letterSpacing);this.lineBreak=parse(context,lineBreak,declaration.lineBreak);this.lineHeight=parse(context,lineHeight,declaration.lineHeight);this.listStyleImage=parse(context,listStyleImage,declaration.listStyleImage);this.listStylePosition=parse(context,listStylePosition,declaration.listStylePosition);this.listStyleType=parse(context,listStyleType,declaration.listStyleType);this.marginTop=parse(context,marginTop,declaration.marginTop);this.marginRight=parse(context,marginRight,declaration.marginRight);this.marginBottom=parse(context,marginBottom,declaration.marginBottom);this.marginLeft=parse(context,marginLeft,declaration.marginLeft);this.opacity=parse(context,opacity,declaration.opacity);var overflowTuple=parse(context,overflow,declaration.overflow);this.overflowX=overflowTuple[0];this.overflowY=overflowTuple[overflowTuple.length>1?1:0];this.overflowWrap=parse(context,overflowWrap,declaration.overflowWrap);this.paddingTop=parse(context,paddingTop,declaration.paddingTop);this.paddingRight=parse(context,paddingRight,declaration.paddingRight);this.paddingBottom=parse(context,paddingBottom,declaration.paddingBottom);this.paddingLeft=parse(context,paddingLeft,declaration.paddingLeft);this.paintOrder=parse(context,paintOrder,declaration.paintOrder);this.position=parse(context,position,declaration.position);this.textAlign=parse(context,textAlign,declaration.textAlign);this.textDecorationColor=parse(context,textDecorationColor,(_a=declaration.textDecorationColor)!==null&&_a!==void 0?_a:declaration.color);this.textDecorationLine=parse(context,textDecorationLine,(_b=declaration.textDecorationLine)!==null&&_b!==void 0?_b:declaration.textDecoration);this.textShadow=parse(context,textShadow,declaration.textShadow);this.textTransform=parse(context,textTransform,declaration.textTransform);this.transform=parse(context,transform$1,declaration.transform);this.transformOrigin=parse(context,transformOrigin,declaration.transformOrigin);this.visibility=parse(context,visibility,declaration.visibility);this.webkitTextStrokeColor=parse(context,webkitTextStrokeColor,declaration.webkitTextStrokeColor);this.webkitTextStrokeWidth=parse(context,webkitTextStrokeWidth,declaration.webkitTextStrokeWidth);this.wordBreak=parse(context,wordBreak,declaration.wordBreak);this.zIndex=parse(context,zIndex,declaration.zIndex);}
CSSParsedDeclaration.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0;};CSSParsedDeclaration.prototype.isTransparent=function(){return isTransparent(this.backgroundColor);};CSSParsedDeclaration.prototype.isTransformed=function(){return this.transform!==null;};CSSParsedDeclaration.prototype.isPositioned=function(){return this.position!==0;};CSSParsedDeclaration.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto;};CSSParsedDeclaration.prototype.isFloating=function(){return this.float!==0;};CSSParsedDeclaration.prototype.isInlineLevel=function(){return(contains(this.display,4)||contains(this.display,33554432)||contains(this.display,268435456)||contains(this.display,536870912)||contains(this.display,67108864)||contains(this.display,134217728));};return CSSParsedDeclaration;}());var CSSParsedPseudoDeclaration=(function(){function CSSParsedPseudoDeclaration(context,declaration){this.content=parse(context,content,declaration.content);this.quotes=parse(context,quotes,declaration.quotes);}
return CSSParsedPseudoDeclaration;}());var CSSParsedCounterDeclaration=(function(){function CSSParsedCounterDeclaration(context,declaration){this.counterIncrement=parse(context,counterIncrement,declaration.counterIncrement);this.counterReset=parse(context,counterReset,declaration.counterReset);}
return CSSParsedCounterDeclaration;}());var parse=function(context,descriptor,style){var tokenizer=new Tokenizer();var value=style!==null&&typeof style!=='undefined'?style.toString():descriptor.initialValue;tokenizer.write(value);var parser=new Parser(tokenizer.read());switch(descriptor.type){case 2:var token=parser.parseComponentValue();return descriptor.parse(context,isIdentToken(token)?token.value:descriptor.initialValue);case 0:return descriptor.parse(context,parser.parseComponentValue());case 1:return descriptor.parse(context,parser.parseComponentValues());case 4:return parser.parseComponentValue();case 3:switch(descriptor.format){case'angle':return angle.parse(context,parser.parseComponentValue());case'color':return color$1.parse(context,parser.parseComponentValue());case'image':return image.parse(context,parser.parseComponentValue());case'length':var length_1=parser.parseComponentValue();return isLength(length_1)?length_1:ZERO_LENGTH;case'length-percentage':var value_1=parser.parseComponentValue();return isLengthPercentage(value_1)?value_1:ZERO_LENGTH;case'time':return time.parse(context,parser.parseComponentValue());}
break;}};var elementDebuggerAttribute='data-html2canvas-debug';var getElementDebugType=function(element){var attribute=element.getAttribute(elementDebuggerAttribute);switch(attribute){case'all':return 1;case'clone':return 2;case'parse':return 3;case'render':return 4;default:return 0;}};var isDebugging=function(element,type){var elementType=getElementDebugType(element);return elementType===1||type===elementType;};var ElementContainer=(function(){function ElementContainer(context,element){this.context=context;this.textNodes=[];this.elements=[];this.flags=0;if(isDebugging(element,3)){debugger;}
this.styles=new CSSParsedDeclaration(context,window.getComputedStyle(element,null));if(isHTMLElementNode(element)){if(this.styles.animationDuration.some(function(duration){return duration>0;})){element.style.animationDuration='0s';}
if(this.styles.transform!==null){element.style.transform='none';}}
this.bounds=parseBounds(this.context,element);if(isDebugging(element,4)){this.flags|=16;}}
return ElementContainer;}());var base64='AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=';var chars$1='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';var lookup$1=typeof Uint8Array==='undefined'?[]:new Uint8Array(256);for(var i$1=0;i$1<chars$1.length;i$1++){lookup$1[chars$1.charCodeAt(i$1)]=i$1;}
var decode=function(base64){var bufferLength=base64.length*0.75,len=base64.length,i,p=0,encoded1,encoded2,encoded3,encoded4;if(base64[base64.length-1]==='='){bufferLength--;if(base64[base64.length-2]==='='){bufferLength--;}}
var buffer=typeof ArrayBuffer!=='undefined'&&typeof Uint8Array!=='undefined'&&typeof Uint8Array.prototype.slice!=='undefined'?new ArrayBuffer(bufferLength):new Array(bufferLength);var bytes=Array.isArray(buffer)?buffer:new Uint8Array(buffer);for(i=0;i<len;i+=4){encoded1=lookup$1[base64.charCodeAt(i)];encoded2=lookup$1[base64.charCodeAt(i+1)];encoded3=lookup$1[base64.charCodeAt(i+2)];encoded4=lookup$1[base64.charCodeAt(i+3)];bytes[p++]=(encoded1<<2)|(encoded2>>4);bytes[p++]=((encoded2&15)<<4)|(encoded3>>2);bytes[p++]=((encoded3&3)<<6)|(encoded4&63);}
return buffer;};var polyUint16Array=function(buffer){var length=buffer.length;var bytes=[];for(var i=0;i<length;i+=2){bytes.push((buffer[i+1]<<8)|buffer[i]);}
return bytes;};var polyUint32Array=function(buffer){var length=buffer.length;var bytes=[];for(var i=0;i<length;i+=4){bytes.push((buffer[i+3]<<24)|(buffer[i+2]<<16)|(buffer[i+1]<<8)|buffer[i]);}
return bytes;};var UTRIE2_SHIFT_2=5;var UTRIE2_SHIFT_1=6+5;var UTRIE2_INDEX_SHIFT=2;var UTRIE2_SHIFT_1_2=UTRIE2_SHIFT_1-UTRIE2_SHIFT_2;var UTRIE2_LSCP_INDEX_2_OFFSET=0x10000>>UTRIE2_SHIFT_2;var UTRIE2_DATA_BLOCK_LENGTH=1<<UTRIE2_SHIFT_2;var UTRIE2_DATA_MASK=UTRIE2_DATA_BLOCK_LENGTH-1;var UTRIE2_LSCP_INDEX_2_LENGTH=0x400>>UTRIE2_SHIFT_2;var UTRIE2_INDEX_2_BMP_LENGTH=UTRIE2_LSCP_INDEX_2_OFFSET+UTRIE2_LSCP_INDEX_2_LENGTH;var UTRIE2_UTF8_2B_INDEX_2_OFFSET=UTRIE2_INDEX_2_BMP_LENGTH;var UTRIE2_UTF8_2B_INDEX_2_LENGTH=0x800>>6;var UTRIE2_INDEX_1_OFFSET=UTRIE2_UTF8_2B_INDEX_2_OFFSET+UTRIE2_UTF8_2B_INDEX_2_LENGTH;var UTRIE2_OMITTED_BMP_INDEX_1_LENGTH=0x10000>>UTRIE2_SHIFT_1;var UTRIE2_INDEX_2_BLOCK_LENGTH=1<<UTRIE2_SHIFT_1_2;var UTRIE2_INDEX_2_MASK=UTRIE2_INDEX_2_BLOCK_LENGTH-1;var slice16=function(view,start,end){if(view.slice){return view.slice(start,end);}
return new Uint16Array(Array.prototype.slice.call(view,start,end));};var slice32=function(view,start,end){if(view.slice){return view.slice(start,end);}
return new Uint32Array(Array.prototype.slice.call(view,start,end));};var createTrieFromBase64=function(base64,_byteLength){var buffer=decode(base64);var view32=Array.isArray(buffer)?polyUint32Array(buffer):new Uint32Array(buffer);var view16=Array.isArray(buffer)?polyUint16Array(buffer):new Uint16Array(buffer);var headerLength=24;var index=slice16(view16,headerLength/2,view32[4]/2);var data=view32[5]===2?slice16(view16,(headerLength+view32[4])/2):slice32(view32,Math.ceil((headerLength+view32[4])/4));return new Trie(view32[0],view32[1],view32[2],view32[3],index,data);};var Trie=(function(){function Trie(initialValue,errorValue,highStart,highValueIndex,index,data){this.initialValue=initialValue;this.errorValue=errorValue;this.highStart=highStart;this.highValueIndex=highValueIndex;this.index=index;this.data=data;}
Trie.prototype.get=function(codePoint){var ix;if(codePoint>=0){if(codePoint<0x0d800||(codePoint>0x0dbff&&codePoint<=0x0ffff)){ix=this.index[codePoint>>UTRIE2_SHIFT_2];ix=(ix<<UTRIE2_INDEX_SHIFT)+(codePoint&UTRIE2_DATA_MASK);return this.data[ix];}
if(codePoint<=0xffff){ix=this.index[UTRIE2_LSCP_INDEX_2_OFFSET+((codePoint-0xd800)>>UTRIE2_SHIFT_2)];ix=(ix<<UTRIE2_INDEX_SHIFT)+(codePoint&UTRIE2_DATA_MASK);return this.data[ix];}
if(codePoint<this.highStart){ix=UTRIE2_INDEX_1_OFFSET-UTRIE2_OMITTED_BMP_INDEX_1_LENGTH+(codePoint>>UTRIE2_SHIFT_1);ix=this.index[ix];ix+=(codePoint>>UTRIE2_SHIFT_2)&UTRIE2_INDEX_2_MASK;ix=this.index[ix];ix=(ix<<UTRIE2_INDEX_SHIFT)+(codePoint&UTRIE2_DATA_MASK);return this.data[ix];}
if(codePoint<=0x10ffff){return this.data[this.highValueIndex];}}
return this.errorValue;};return Trie;}());var chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';var lookup=typeof Uint8Array==='undefined'?[]:new Uint8Array(256);for(var i=0;i<chars.length;i++){lookup[chars.charCodeAt(i)]=i;}
var Prepend=1;var CR=2;var LF=3;var Control=4;var Extend=5;var SpacingMark=7;var L=8;var V=9;var T=10;var LV=11;var LVT=12;var ZWJ=13;var Extended_Pictographic=14;var RI=15;var toCodePoints=function(str){var codePoints=[];var i=0;var length=str.length;while(i<length){var value=str.charCodeAt(i++);if(value>=0xd800&&value<=0xdbff&&i<length){var extra=str.charCodeAt(i++);if((extra&0xfc00)===0xdc00){codePoints.push(((value&0x3ff)<<10)+(extra&0x3ff)+0x10000);}
else{codePoints.push(value);i--;}}
else{codePoints.push(value);}}
return codePoints;};var fromCodePoint=function(){var codePoints=[];for(var _i=0;_i<arguments.length;_i++){codePoints[_i]=arguments[_i];}
if(String.fromCodePoint){return String.fromCodePoint.apply(String,codePoints);}
var length=codePoints.length;if(!length){return'';}
var codeUnits=[];var index=-1;var result='';while(++index<length){var codePoint=codePoints[index];if(codePoint<=0xffff){codeUnits.push(codePoint);}
else{codePoint-=0x10000;codeUnits.push((codePoint>>10)+0xd800,(codePoint%0x400)+0xdc00);}
if(index+1===length||codeUnits.length>0x4000){result+=String.fromCharCode.apply(String,codeUnits);codeUnits.length=0;}}
return result;};var UnicodeTrie=createTrieFromBase64(base64);var BREAK_NOT_ALLOWED='';var BREAK_ALLOWED='';var codePointToClass=function(codePoint){return UnicodeTrie.get(codePoint);};var _graphemeBreakAtIndex=function(_codePoints,classTypes,index){var prevIndex=index-2;var prev=classTypes[prevIndex];var current=classTypes[index-1];var next=classTypes[index];if(current===CR&&next===LF){return BREAK_NOT_ALLOWED;}
if(current===CR||current===LF||current===Control){return BREAK_ALLOWED;}
if(next===CR||next===LF||next===Control){return BREAK_ALLOWED;}
if(current===L&&[L,V,LV,LVT].indexOf(next)!==-1){return BREAK_NOT_ALLOWED;}
if((current===LV||current===V)&&(next===V||next===T)){return BREAK_NOT_ALLOWED;}
if((current===LVT||current===T)&&next===T){return BREAK_NOT_ALLOWED;}
if(next===ZWJ||next===Extend){return BREAK_NOT_ALLOWED;}
if(next===SpacingMark){return BREAK_NOT_ALLOWED;}
if(current===Prepend){return BREAK_NOT_ALLOWED;}
if(current===ZWJ&&next===Extended_Pictographic){while(prev===Extend){prev=classTypes[--prevIndex];}
if(prev===Extended_Pictographic){return BREAK_NOT_ALLOWED;}}
if(current===RI&&next===RI){var countRI=0;while(prev===RI){countRI++;prev=classTypes[--prevIndex];}
if(countRI%2===0){return BREAK_NOT_ALLOWED;}}
return BREAK_ALLOWED;};var GraphemeBreaker=function(str){var codePoints=toCodePoints(str);var length=codePoints.length;var index=0;var lastEnd=0;var classTypes=codePoints.map(codePointToClass);return{next:function(){if(index>=length){return{done:true,value:null};}
var graphemeBreak=BREAK_NOT_ALLOWED;while(index<length&&(graphemeBreak=_graphemeBreakAtIndex(codePoints,classTypes,++index))===BREAK_NOT_ALLOWED){}
if(graphemeBreak!==BREAK_NOT_ALLOWED||index===length){var value=fromCodePoint.apply(null,codePoints.slice(lastEnd,index));lastEnd=index;return{value:value,done:false};}
return{done:true,value:null};},};};var splitGraphemes=function(str){var breaker=GraphemeBreaker(str);var graphemes=[];var bk;while(!(bk=breaker.next()).done){if(bk.value){graphemes.push(bk.value.slice());}}
return graphemes;};var testRangeBounds=function(document){var TEST_HEIGHT=123;if(document.createRange){var range=document.createRange();if(range.getBoundingClientRect){var testElement=document.createElement('boundtest');testElement.style.height=TEST_HEIGHT+"px";testElement.style.display='block';document.body.appendChild(testElement);range.selectNode(testElement);var rangeBounds=range.getBoundingClientRect();var rangeHeight=Math.round(rangeBounds.height);document.body.removeChild(testElement);if(rangeHeight===TEST_HEIGHT){return true;}}}
return false;};var testIOSLineBreak=function(document){var testElement=document.createElement('boundtest');testElement.style.width='50px';testElement.style.display='block';testElement.style.fontSize='12px';testElement.style.letterSpacing='0px';testElement.style.wordSpacing='0px';document.body.appendChild(testElement);var range=document.createRange();testElement.innerHTML=typeof''.repeat==='function'?'&#128104;'.repeat(10):'';var node=testElement.firstChild;var textList=toCodePoints$1(node.data).map(function(i){return fromCodePoint$1(i);});var offset=0;var prev={};var supports=textList.every(function(text,i){range.setStart(node,offset);range.setEnd(node,offset+text.length);var rect=range.getBoundingClientRect();offset+=text.length;var boundAhead=rect.x>prev.x||rect.y>prev.y;prev=rect;if(i===0){return true;}
return boundAhead;});document.body.removeChild(testElement);return supports;};var testCORS=function(){return typeof new Image().crossOrigin!=='undefined';};var testResponseType=function(){return typeof new XMLHttpRequest().responseType==='string';};var testSVG=function(document){var img=new Image();var canvas=document.createElement('canvas');var ctx=canvas.getContext('2d');if(!ctx){return false;}
img.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{ctx.drawImage(img,0,0);canvas.toDataURL();}
catch(e){return false;}
return true;};var isGreenPixel=function(data){return data[0]===0&&data[1]===255&&data[2]===0&&data[3]===255;};var testForeignObject=function(document){var canvas=document.createElement('canvas');var size=100;canvas.width=size;canvas.height=size;var ctx=canvas.getContext('2d');if(!ctx){return Promise.reject(false);}
ctx.fillStyle='rgb(0, 255, 0)';ctx.fillRect(0,0,size,size);var img=new Image();var greenImageSrc=canvas.toDataURL();img.src=greenImageSrc;var svg=createForeignObjectSVG(size,size,0,0,img);ctx.fillStyle='red';ctx.fillRect(0,0,size,size);return loadSerializedSVG$1(svg).then(function(img){ctx.drawImage(img,0,0);var data=ctx.getImageData(0,0,size,size).data;ctx.fillStyle='red';ctx.fillRect(0,0,size,size);var node=document.createElement('div');node.style.backgroundImage="url("+greenImageSrc+")";node.style.height=size+"px";return isGreenPixel(data)?loadSerializedSVG$1(createForeignObjectSVG(size,size,0,0,node)):Promise.reject(false);}).then(function(img){ctx.drawImage(img,0,0);return isGreenPixel(ctx.getImageData(0,0,size,size).data);}).catch(function(){return false;});};var createForeignObjectSVG=function(width,height,x,y,node){var xmlns='http://www.w3.org/2000/svg';var svg=document.createElementNS(xmlns,'svg');var foreignObject=document.createElementNS(xmlns,'foreignObject');svg.setAttributeNS(null,'width',width.toString());svg.setAttributeNS(null,'height',height.toString());foreignObject.setAttributeNS(null,'width','100%');foreignObject.setAttributeNS(null,'height','100%');foreignObject.setAttributeNS(null,'x',x.toString());foreignObject.setAttributeNS(null,'y',y.toString());foreignObject.setAttributeNS(null,'externalResourcesRequired','true');svg.appendChild(foreignObject);foreignObject.appendChild(node);return svg;};var loadSerializedSVG$1=function(svg){return new Promise(function(resolve,reject){var img=new Image();img.onload=function(){return resolve(img);};img.onerror=reject;img.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(svg));});};var FEATURES={get SUPPORT_RANGE_BOUNDS(){var value=testRangeBounds(document);Object.defineProperty(FEATURES,'SUPPORT_RANGE_BOUNDS',{value:value});return value;},get SUPPORT_WORD_BREAKING(){var value=FEATURES.SUPPORT_RANGE_BOUNDS&&testIOSLineBreak(document);Object.defineProperty(FEATURES,'SUPPORT_WORD_BREAKING',{value:value});return value;},get SUPPORT_SVG_DRAWING(){var value=testSVG(document);Object.defineProperty(FEATURES,'SUPPORT_SVG_DRAWING',{value:value});return value;},get SUPPORT_FOREIGNOBJECT_DRAWING(){var value=typeof Array.from==='function'&&typeof window.fetch==='function'?testForeignObject(document):Promise.resolve(false);Object.defineProperty(FEATURES,'SUPPORT_FOREIGNOBJECT_DRAWING',{value:value});return value;},get SUPPORT_CORS_IMAGES(){var value=testCORS();Object.defineProperty(FEATURES,'SUPPORT_CORS_IMAGES',{value:value});return value;},get SUPPORT_RESPONSE_TYPE(){var value=testResponseType();Object.defineProperty(FEATURES,'SUPPORT_RESPONSE_TYPE',{value:value});return value;},get SUPPORT_CORS_XHR(){var value='withCredentials'in new XMLHttpRequest();Object.defineProperty(FEATURES,'SUPPORT_CORS_XHR',{value:value});return value;},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var value=!!(typeof Intl!=='undefined'&&Intl.Segmenter);Object.defineProperty(FEATURES,'SUPPORT_NATIVE_TEXT_SEGMENTATION',{value:value});return value;}};var TextBounds=(function(){function TextBounds(text,bounds){this.text=text;this.bounds=bounds;}
return TextBounds;}());var parseTextBounds=function(context,value,styles,node){var textList=breakText(value,styles);var textBounds=[];var offset=0;textList.forEach(function(text){if(styles.textDecorationLine.length||text.trim().length>0){if(FEATURES.SUPPORT_RANGE_BOUNDS){var clientRects=createRange(node,offset,text.length).getClientRects();if(clientRects.length>1){var subSegments=segmentGraphemes(text);var subOffset_1=0;subSegments.forEach(function(subSegment){textBounds.push(new TextBounds(subSegment,Bounds.fromDOMRectList(context,createRange(node,subOffset_1+offset,subSegment.length).getClientRects())));subOffset_1+=subSegment.length;});}
else{textBounds.push(new TextBounds(text,Bounds.fromDOMRectList(context,clientRects)));}}
else{var replacementNode=node.splitText(text.length);textBounds.push(new TextBounds(text,getWrapperBounds(context,node)));node=replacementNode;}}
else if(!FEATURES.SUPPORT_RANGE_BOUNDS){node=node.splitText(text.length);}
offset+=text.length;});return textBounds;};var getWrapperBounds=function(context,node){var ownerDocument=node.ownerDocument;if(ownerDocument){var wrapper=ownerDocument.createElement('html2canvaswrapper');wrapper.appendChild(node.cloneNode(true));var parentNode=node.parentNode;if(parentNode){parentNode.replaceChild(wrapper,node);var bounds=parseBounds(context,wrapper);if(wrapper.firstChild){parentNode.replaceChild(wrapper.firstChild,wrapper);}
return bounds;}}
return Bounds.EMPTY;};var createRange=function(node,offset,length){var ownerDocument=node.ownerDocument;if(!ownerDocument){throw new Error('Node has no owner document');}
var range=ownerDocument.createRange();range.setStart(node,offset);range.setEnd(node,offset+length);return range;};var segmentGraphemes=function(value){if(FEATURES.SUPPORT_NATIVE_TEXT_SEGMENTATION){var segmenter=new Intl.Segmenter(void 0,{granularity:'grapheme'});return Array.from(segmenter.segment(value)).map(function(segment){return segment.segment;});}
return splitGraphemes(value);};var segmentWords=function(value,styles){if(FEATURES.SUPPORT_NATIVE_TEXT_SEGMENTATION){var segmenter=new Intl.Segmenter(void 0,{granularity:'word'});return Array.from(segmenter.segment(value)).map(function(segment){return segment.segment;});}
return breakWords(value,styles);};var breakText=function(value,styles){return styles.letterSpacing!==0?segmentGraphemes(value):segmentWords(value,styles);};var wordSeparators=[0x0020,0x00a0,0x1361,0x10100,0x10101,0x1039,0x1091];var breakWords=function(str,styles){var breaker=LineBreaker(str,{lineBreak:styles.lineBreak,wordBreak:styles.overflowWrap==="break-word"?'break-word':styles.wordBreak});var words=[];var bk;var _loop_1=function(){if(bk.value){var value=bk.value.slice();var codePoints=toCodePoints$1(value);var word_1='';codePoints.forEach(function(codePoint){if(wordSeparators.indexOf(codePoint)===-1){word_1+=fromCodePoint$1(codePoint);}
else{if(word_1.length){words.push(word_1);}
words.push(fromCodePoint$1(codePoint));word_1='';}});if(word_1.length){words.push(word_1);}}};while(!(bk=breaker.next()).done){_loop_1();}
return words;};var TextContainer=(function(){function TextContainer(context,node,styles){this.text=transform(node.data,styles.textTransform);this.textBounds=parseTextBounds(context,this.text,styles,node);}
return TextContainer;}());var transform=function(text,transform){switch(transform){case 1:return text.toLowerCase();case 3:return text.replace(CAPITALIZE,capitalize);case 2:return text.toUpperCase();default:return text;}};var CAPITALIZE=/(^|\s|:|-|\(|\))([a-z])/g;var capitalize=function(m,p1,p2){if(m.length>0){return p1+p2.toUpperCase();}
return m;};var ImageElementContainer=(function(_super){__extends(ImageElementContainer,_super);function ImageElementContainer(context,img){var _this=_super.call(this,context,img)||this;_this.src=img.currentSrc||img.src;_this.intrinsicWidth=img.naturalWidth;_this.intrinsicHeight=img.naturalHeight;_this.context.cache.addImage(_this.src);return _this;}
return ImageElementContainer;}(ElementContainer));var CanvasElementContainer=(function(_super){__extends(CanvasElementContainer,_super);function CanvasElementContainer(context,canvas){var _this=_super.call(this,context,canvas)||this;_this.canvas=canvas;_this.intrinsicWidth=canvas.width;_this.intrinsicHeight=canvas.height;return _this;}
return CanvasElementContainer;}(ElementContainer));var SVGElementContainer=(function(_super){__extends(SVGElementContainer,_super);function SVGElementContainer(context,img){var _this=_super.call(this,context,img)||this;var s=new XMLSerializer();var bounds=parseBounds(context,img);img.setAttribute('width',bounds.width+"px");img.setAttribute('height',bounds.height+"px");_this.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(img));_this.intrinsicWidth=img.width.baseVal.value;_this.intrinsicHeight=img.height.baseVal.value;_this.context.cache.addImage(_this.svg);return _this;}
return SVGElementContainer;}(ElementContainer));var LIElementContainer=(function(_super){__extends(LIElementContainer,_super);function LIElementContainer(context,element){var _this=_super.call(this,context,element)||this;_this.value=element.value;return _this;}
return LIElementContainer;}(ElementContainer));var OLElementContainer=(function(_super){__extends(OLElementContainer,_super);function OLElementContainer(context,element){var _this=_super.call(this,context,element)||this;_this.start=element.start;_this.reversed=typeof element.reversed==='boolean'&&element.reversed===true;return _this;}
return OLElementContainer;}(ElementContainer));var CHECKBOX_BORDER_RADIUS=[{type:15,flags:0,unit:'px',number:3}];var RADIO_BORDER_RADIUS=[{type:16,flags:0,number:50}];var reformatInputBounds=function(bounds){if(bounds.width>bounds.height){return new Bounds(bounds.left+(bounds.width-bounds.height)/2,bounds.top,bounds.height,bounds.height);}
else if(bounds.width<bounds.height){return new Bounds(bounds.left,bounds.top+(bounds.height-bounds.width)/2,bounds.width,bounds.width);}
return bounds;};var getInputValue=function(node){var value=node.type===PASSWORD?new Array(node.value.length+1).join('\u2022'):node.value;return value.length===0?node.placeholder||'':value;};var CHECKBOX='checkbox';var RADIO='radio';var PASSWORD='password';var INPUT_COLOR=0x2a2a2aff;var InputElementContainer=(function(_super){__extends(InputElementContainer,_super);function InputElementContainer(context,input){var _this=_super.call(this,context,input)||this;_this.type=input.type.toLowerCase();_this.checked=input.checked;_this.value=getInputValue(input);if(_this.type===CHECKBOX||_this.type===RADIO){_this.styles.backgroundColor=0xdededeff;_this.styles.borderTopColor=_this.styles.borderRightColor=_this.styles.borderBottomColor=_this.styles.borderLeftColor=0xa5a5a5ff;_this.styles.borderTopWidth=_this.styles.borderRightWidth=_this.styles.borderBottomWidth=_this.styles.borderLeftWidth=1;_this.styles.borderTopStyle=_this.styles.borderRightStyle=_this.styles.borderBottomStyle=_this.styles.borderLeftStyle=1;_this.styles.backgroundClip=[0];_this.styles.backgroundOrigin=[0];_this.bounds=reformatInputBounds(_this.bounds);}
switch(_this.type){case CHECKBOX:_this.styles.borderTopRightRadius=_this.styles.borderTopLeftRadius=_this.styles.borderBottomRightRadius=_this.styles.borderBottomLeftRadius=CHECKBOX_BORDER_RADIUS;break;case RADIO:_this.styles.borderTopRightRadius=_this.styles.borderTopLeftRadius=_this.styles.borderBottomRightRadius=_this.styles.borderBottomLeftRadius=RADIO_BORDER_RADIUS;break;}
return _this;}
return InputElementContainer;}(ElementContainer));var SelectElementContainer=(function(_super){__extends(SelectElementContainer,_super);function SelectElementContainer(context,element){var _this=_super.call(this,context,element)||this;var option=element.options[element.selectedIndex||0];_this.value=option?option.text||'':'';return _this;}
return SelectElementContainer;}(ElementContainer));var TextareaElementContainer=(function(_super){__extends(TextareaElementContainer,_super);function TextareaElementContainer(context,element){var _this=_super.call(this,context,element)||this;_this.value=element.value;return _this;}
return TextareaElementContainer;}(ElementContainer));var IFrameElementContainer=(function(_super){__extends(IFrameElementContainer,_super);function IFrameElementContainer(context,iframe){var _this=_super.call(this,context,iframe)||this;_this.src=iframe.src;_this.width=parseInt(iframe.width,10)||0;_this.height=parseInt(iframe.height,10)||0;_this.backgroundColor=_this.styles.backgroundColor;try{if(iframe.contentWindow&&iframe.contentWindow.document&&iframe.contentWindow.document.documentElement){_this.tree=parseTree(context,iframe.contentWindow.document.documentElement);var documentBackgroundColor=iframe.contentWindow.document.documentElement?parseColor(context,getComputedStyle(iframe.contentWindow.document.documentElement).backgroundColor):COLORS.TRANSPARENT;var bodyBackgroundColor=iframe.contentWindow.document.body?parseColor(context,getComputedStyle(iframe.contentWindow.document.body).backgroundColor):COLORS.TRANSPARENT;_this.backgroundColor=isTransparent(documentBackgroundColor)?isTransparent(bodyBackgroundColor)?_this.styles.backgroundColor:bodyBackgroundColor:documentBackgroundColor;}}
catch(e){}
return _this;}
return IFrameElementContainer;}(ElementContainer));var LIST_OWNERS=['OL','UL','MENU'];var parseNodeTree=function(context,node,parent,root){for(var childNode=node.firstChild,nextNode=void 0;childNode;childNode=nextNode){nextNode=childNode.nextSibling;if(isTextNode(childNode)&&childNode.data.trim().length>0){parent.textNodes.push(new TextContainer(context,childNode,parent.styles));}
else if(isElementNode(childNode)){if(isSlotElement(childNode)&&childNode.assignedNodes){childNode.assignedNodes().forEach(function(childNode){return parseNodeTree(context,childNode,parent,root);});}
else{var container=createContainer(context,childNode);if(container.styles.isVisible()){if(createsRealStackingContext(childNode,container,root)){container.flags|=4;}
else if(createsStackingContext(container.styles)){container.flags|=2;}
if(LIST_OWNERS.indexOf(childNode.tagName)!==-1){container.flags|=8;}
parent.elements.push(container);childNode.slot;if(childNode.shadowRoot){parseNodeTree(context,childNode.shadowRoot,container,root);}
else if(!isTextareaElement(childNode)&&!isSVGElement(childNode)&&!isSelectElement(childNode)){parseNodeTree(context,childNode,container,root);}}}}}};var createContainer=function(context,element){if(isImageElement(element)){return new ImageElementContainer(context,element);}
if(isCanvasElement(element)){return new CanvasElementContainer(context,element);}
if(isSVGElement(element)){return new SVGElementContainer(context,element);}
if(isLIElement(element)){return new LIElementContainer(context,element);}
if(isOLElement(element)){return new OLElementContainer(context,element);}
if(isInputElement(element)){return new InputElementContainer(context,element);}
if(isSelectElement(element)){return new SelectElementContainer(context,element);}
if(isTextareaElement(element)){return new TextareaElementContainer(context,element);}
if(isIFrameElement(element)){return new IFrameElementContainer(context,element);}
return new ElementContainer(context,element);};var parseTree=function(context,element){var container=createContainer(context,element);container.flags|=4;parseNodeTree(context,element,container,container);return container;};var createsRealStackingContext=function(node,container,root){return(container.styles.isPositionedWithZIndex()||container.styles.opacity<1||container.styles.isTransformed()||(isBodyElement(node)&&root.styles.isTransparent()));};var createsStackingContext=function(styles){return styles.isPositioned()||styles.isFloating();};var isTextNode=function(node){return node.nodeType===Node.TEXT_NODE;};var isElementNode=function(node){return node.nodeType===Node.ELEMENT_NODE;};var isHTMLElementNode=function(node){return isElementNode(node)&&typeof node.style!=='undefined'&&!isSVGElementNode(node);};var isSVGElementNode=function(element){return typeof element.className==='object';};var isLIElement=function(node){return node.tagName==='LI';};var isOLElement=function(node){return node.tagName==='OL';};var isInputElement=function(node){return node.tagName==='INPUT';};var isHTMLElement=function(node){return node.tagName==='HTML';};var isSVGElement=function(node){return node.tagName==='svg';};var isBodyElement=function(node){return node.tagName==='BODY';};var isCanvasElement=function(node){return node.tagName==='CANVAS';};var isVideoElement=function(node){return node.tagName==='VIDEO';};var isImageElement=function(node){return node.tagName==='IMG';};var isIFrameElement=function(node){return node.tagName==='IFRAME';};var isStyleElement=function(node){return node.tagName==='STYLE';};var isScriptElement=function(node){return node.tagName==='SCRIPT';};var isTextareaElement=function(node){return node.tagName==='TEXTAREA';};var isSelectElement=function(node){return node.tagName==='SELECT';};var isSlotElement=function(node){return node.tagName==='SLOT';};var isCustomElement=function(node){return node.tagName.indexOf('-')>0;};var CounterState=(function(){function CounterState(){this.counters={};}
CounterState.prototype.getCounterValue=function(name){var counter=this.counters[name];if(counter&&counter.length){return counter[counter.length-1];}
return 1;};CounterState.prototype.getCounterValues=function(name){var counter=this.counters[name];return counter?counter:[];};CounterState.prototype.pop=function(counters){var _this=this;counters.forEach(function(counter){return _this.counters[counter].pop();});};CounterState.prototype.parse=function(style){var _this=this;var counterIncrement=style.counterIncrement;var counterReset=style.counterReset;var canReset=true;if(counterIncrement!==null){counterIncrement.forEach(function(entry){var counter=_this.counters[entry.counter];if(counter&&entry.increment!==0){canReset=false;if(!counter.length){counter.push(1);}
counter[Math.max(0,counter.length-1)]+=entry.increment;}});}
var counterNames=[];if(canReset){counterReset.forEach(function(entry){var counter=_this.counters[entry.counter];counterNames.push(entry.counter);if(!counter){counter=_this.counters[entry.counter]=[];}
counter.push(entry.reset);});}
return counterNames;};return CounterState;}());var ROMAN_UPPER={integers:[1000,900,500,400,100,90,50,40,10,9,5,4,1],values:['M','CM','D','CD','C','XC','L','XL','X','IX','V','IV','I']};var ARMENIAN={integers:[9000,8000,7000,6000,5000,4000,3000,2000,1000,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:['','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','']};var HEBREW={integers:[10000,9000,8000,7000,6000,5000,4000,3000,2000,1000,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:['','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','']};var GEORGIAN={integers:[10000,9000,8000,7000,6000,5000,4000,3000,2000,1000,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:['','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','']};var createAdditiveCounter=function(value,min,max,symbols,fallback,suffix){if(value<min||value>max){return createCounterText(value,fallback,suffix.length>0);}
return(symbols.integers.reduce(function(string,integer,index){while(value>=integer){value-=integer;string+=symbols.values[index];}
return string;},'')+suffix);};var createCounterStyleWithSymbolResolver=function(value,codePointRangeLength,isNumeric,resolver){var string='';do{if(!isNumeric){value--;}
string=resolver(value)+string;value/=codePointRangeLength;}while(value*codePointRangeLength>=codePointRangeLength);return string;};var createCounterStyleFromRange=function(value,codePointRangeStart,codePointRangeEnd,isNumeric,suffix){var codePointRangeLength=codePointRangeEnd-codePointRangeStart+1;return((value<0?'-':'')+
(createCounterStyleWithSymbolResolver(Math.abs(value),codePointRangeLength,isNumeric,function(codePoint){return fromCodePoint$1(Math.floor(codePoint%codePointRangeLength)+codePointRangeStart);})+
suffix));};var createCounterStyleFromSymbols=function(value,symbols,suffix){if(suffix===void 0){suffix='. ';}
var codePointRangeLength=symbols.length;return(createCounterStyleWithSymbolResolver(Math.abs(value),codePointRangeLength,false,function(codePoint){return symbols[Math.floor(codePoint%codePointRangeLength)];})+suffix);};var CJK_ZEROS=1<<0;var CJK_TEN_COEFFICIENTS=1<<1;var CJK_TEN_HIGH_COEFFICIENTS=1<<2;var CJK_HUNDRED_COEFFICIENTS=1<<3;var createCJKCounter=function(value,numbers,multipliers,negativeSign,suffix,flags){if(value<-9999||value>9999){return createCounterText(value,4,suffix.length>0);}
var tmp=Math.abs(value);var string=suffix;if(tmp===0){return numbers[0]+string;}
for(var digit=0;tmp>0&&digit<=4;digit++){var coefficient=tmp%10;if(coefficient===0&&contains(flags,CJK_ZEROS)&&string!==''){string=numbers[coefficient]+string;}
else if(coefficient>1||(coefficient===1&&digit===0)||(coefficient===1&&digit===1&&contains(flags,CJK_TEN_COEFFICIENTS))||(coefficient===1&&digit===1&&contains(flags,CJK_TEN_HIGH_COEFFICIENTS)&&value>100)||(coefficient===1&&digit>1&&contains(flags,CJK_HUNDRED_COEFFICIENTS))){string=numbers[coefficient]+(digit>0?multipliers[digit-1]:'')+string;}
else if(coefficient===1&&digit>0){string=multipliers[digit-1]+string;}
tmp=Math.floor(tmp/10);}
return(value<0?negativeSign:'')+string;};var CHINESE_INFORMAL_MULTIPLIERS='';var CHINESE_FORMAL_MULTIPLIERS='';var JAPANESE_NEGATIVE='';var KOREAN_NEGATIVE='';var createCounterText=function(value,type,appendSuffix){var defaultSuffix=appendSuffix?'. ':'';var cjkSuffix=appendSuffix?'':'';var koreanSuffix=appendSuffix?', ':'';var spaceSuffix=appendSuffix?' ':'';switch(type){case 0:return''+spaceSuffix;case 1:return''+spaceSuffix;case 2:return''+spaceSuffix;case 5:var string=createCounterStyleFromRange(value,48,57,true,defaultSuffix);return string.length<4?"0"+string:string;case 4:return createCounterStyleFromSymbols(value,'',cjkSuffix);case 6:return createAdditiveCounter(value,1,3999,ROMAN_UPPER,3,defaultSuffix).toLowerCase();case 7:return createAdditiveCounter(value,1,3999,ROMAN_UPPER,3,defaultSuffix);case 8:return createCounterStyleFromRange(value,945,969,false,defaultSuffix);case 9:return createCounterStyleFromRange(value,97,122,false,defaultSuffix);case 10:return createCounterStyleFromRange(value,65,90,false,defaultSuffix);case 11:return createCounterStyleFromRange(value,1632,1641,true,defaultSuffix);case 12:case 49:return createAdditiveCounter(value,1,9999,ARMENIAN,3,defaultSuffix);case 35:return createAdditiveCounter(value,1,9999,ARMENIAN,3,defaultSuffix).toLowerCase();case 13:return createCounterStyleFromRange(value,2534,2543,true,defaultSuffix);case 14:case 30:return createCounterStyleFromRange(value,6112,6121,true,defaultSuffix);case 15:return createCounterStyleFromSymbols(value,'',cjkSuffix);case 16:return createCounterStyleFromSymbols(value,'',cjkSuffix);case 17:case 48:return createCJKCounter(value,'',CHINESE_INFORMAL_MULTIPLIERS,'',cjkSuffix,CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 47:return createCJKCounter(value,'',CHINESE_FORMAL_MULTIPLIERS,'',cjkSuffix,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 42:return createCJKCounter(value,'',CHINESE_INFORMAL_MULTIPLIERS,'',cjkSuffix,CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 41:return createCJKCounter(value,'',CHINESE_FORMAL_MULTIPLIERS,'',cjkSuffix,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 26:return createCJKCounter(value,'','',JAPANESE_NEGATIVE,cjkSuffix,0);case 25:return createCJKCounter(value,'','',JAPANESE_NEGATIVE,cjkSuffix,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 31:return createCJKCounter(value,'','',KOREAN_NEGATIVE,koreanSuffix,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 33:return createCJKCounter(value,'','',KOREAN_NEGATIVE,koreanSuffix,0);case 32:return createCJKCounter(value,'','',KOREAN_NEGATIVE,koreanSuffix,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 18:return createCounterStyleFromRange(value,0x966,0x96f,true,defaultSuffix);case 20:return createAdditiveCounter(value,1,19999,GEORGIAN,3,defaultSuffix);case 21:return createCounterStyleFromRange(value,0xae6,0xaef,true,defaultSuffix);case 22:return createCounterStyleFromRange(value,0xa66,0xa6f,true,defaultSuffix);case 22:return createAdditiveCounter(value,1,10999,HEBREW,3,defaultSuffix);case 23:return createCounterStyleFromSymbols(value,'');case 24:return createCounterStyleFromSymbols(value,'');case 27:return createCounterStyleFromRange(value,0xce6,0xcef,true,defaultSuffix);case 28:return createCounterStyleFromSymbols(value,'',cjkSuffix);case 29:return createCounterStyleFromSymbols(value,'',cjkSuffix);case 34:return createCounterStyleFromRange(value,0xed0,0xed9,true,defaultSuffix);case 37:return createCounterStyleFromRange(value,0x1810,0x1819,true,defaultSuffix);case 38:return createCounterStyleFromRange(value,0x1040,0x1049,true,defaultSuffix);case 39:return createCounterStyleFromRange(value,0xb66,0xb6f,true,defaultSuffix);case 40:return createCounterStyleFromRange(value,0x6f0,0x6f9,true,defaultSuffix);case 43:return createCounterStyleFromRange(value,0xbe6,0xbef,true,defaultSuffix);case 44:return createCounterStyleFromRange(value,0xc66,0xc6f,true,defaultSuffix);case 45:return createCounterStyleFromRange(value,0xe50,0xe59,true,defaultSuffix);case 46:return createCounterStyleFromRange(value,0xf20,0xf29,true,defaultSuffix);case 3:default:return createCounterStyleFromRange(value,48,57,true,defaultSuffix);}};var IGNORE_ATTRIBUTE='data-html2canvas-ignore';var DocumentCloner=(function(){function DocumentCloner(context,element,options){this.context=context;this.options=options;this.scrolledElements=[];this.referenceElement=element;this.counters=new CounterState();this.quoteDepth=0;if(!element.ownerDocument){throw new Error('Cloned element does not have an owner document');}
this.documentElement=this.cloneNode(element.ownerDocument.documentElement,false);}
DocumentCloner.prototype.toIFrame=function(ownerDocument,windowSize){var _this=this;var iframe=createIFrameContainer(ownerDocument,windowSize);if(!iframe.contentWindow){return Promise.reject("Unable to find iframe window");}
var scrollX=ownerDocument.defaultView.pageXOffset;var scrollY=ownerDocument.defaultView.pageYOffset;var cloneWindow=iframe.contentWindow;var documentClone=cloneWindow.document;var iframeLoad=iframeLoader(iframe).then(function(){return __awaiter(_this,void 0,void 0,function(){var onclone,referenceElement;return __generator(this,function(_a){switch(_a.label){case 0:this.scrolledElements.forEach(restoreNodeScroll);if(cloneWindow){cloneWindow.scrollTo(windowSize.left,windowSize.top);if(/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(cloneWindow.scrollY!==windowSize.top||cloneWindow.scrollX!==windowSize.left)){this.context.logger.warn('Unable to restore scroll position for cloned document');this.context.windowBounds=this.context.windowBounds.add(cloneWindow.scrollX-windowSize.left,cloneWindow.scrollY-windowSize.top,0,0);}}
onclone=this.options.onclone;referenceElement=this.clonedReferenceElement;if(typeof referenceElement==='undefined'){return[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")];}
if(!(documentClone.fonts&&documentClone.fonts.ready))return[3,2];return[4,documentClone.fonts.ready];case 1:_a.sent();_a.label=2;case 2:if(!/(AppleWebKit)/g.test(navigator.userAgent))return[3,4];return[4,imagesReady(documentClone)];case 3:_a.sent();_a.label=4;case 4:if(typeof onclone==='function'){return[2,Promise.resolve().then(function(){return onclone(documentClone,referenceElement);}).then(function(){return iframe;})];}
return[2,iframe];}});});});documentClone.open();documentClone.write(serializeDoctype(document.doctype)+"<html></html>");restoreOwnerScroll(this.referenceElement.ownerDocument,scrollX,scrollY);documentClone.replaceChild(documentClone.adoptNode(this.documentElement),documentClone.documentElement);documentClone.close();return iframeLoad;};DocumentCloner.prototype.createElementClone=function(node){if(isDebugging(node,2)){debugger;}
if(isCanvasElement(node)){return this.createCanvasClone(node);}
if(isVideoElement(node)){return this.createVideoClone(node);}
if(isStyleElement(node)){return this.createStyleClone(node);}
var clone=node.cloneNode(false);if(isImageElement(clone)){if(isImageElement(node)&&node.currentSrc&&node.currentSrc!==node.src){clone.src=node.currentSrc;clone.srcset='';}
if(clone.loading==='lazy'){clone.loading='eager';}}
if(isCustomElement(clone)){return this.createCustomElementClone(clone);}
return clone;};DocumentCloner.prototype.createCustomElementClone=function(node){var clone=document.createElement('html2canvascustomelement');copyCSSStyles(node.style,clone);return clone;};DocumentCloner.prototype.createStyleClone=function(node){try{var sheet=node.sheet;if(sheet&&sheet.cssRules){var css=[].slice.call(sheet.cssRules,0).reduce(function(css,rule){if(rule&&typeof rule.cssText==='string'){return css+rule.cssText;}
return css;},'');var style=node.cloneNode(false);style.textContent=css;return style;}}
catch(e){this.context.logger.error('Unable to access cssRules property',e);if(e.name!=='SecurityError'){throw e;}}
return node.cloneNode(false);};DocumentCloner.prototype.createCanvasClone=function(canvas){var _a;if(this.options.inlineImages&&canvas.ownerDocument){var img=canvas.ownerDocument.createElement('img');try{img.src=canvas.toDataURL();return img;}
catch(e){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",canvas);}}
var clonedCanvas=canvas.cloneNode(false);try{clonedCanvas.width=canvas.width;clonedCanvas.height=canvas.height;var ctx=canvas.getContext('2d');var clonedCtx=clonedCanvas.getContext('2d');if(clonedCtx){if(!this.options.allowTaint&&ctx){clonedCtx.putImageData(ctx.getImageData(0,0,canvas.width,canvas.height),0,0);}
else{var gl=(_a=canvas.getContext('webgl2'))!==null&&_a!==void 0?_a:canvas.getContext('webgl');if(gl){var attribs=gl.getContextAttributes();if((attribs===null||attribs===void 0?void 0:attribs.preserveDrawingBuffer)===false){this.context.logger.warn('Unable to clone WebGL context as it has preserveDrawingBuffer=false',canvas);}}
clonedCtx.drawImage(canvas,0,0);}}
return clonedCanvas;}
catch(e){this.context.logger.info("Unable to clone canvas as it is tainted",canvas);}
return clonedCanvas;};DocumentCloner.prototype.createVideoClone=function(video){var canvas=video.ownerDocument.createElement('canvas');canvas.width=video.offsetWidth;canvas.height=video.offsetHeight;var ctx=canvas.getContext('2d');try{if(ctx){ctx.drawImage(video,0,0,canvas.width,canvas.height);if(!this.options.allowTaint){ctx.getImageData(0,0,canvas.width,canvas.height);}}
return canvas;}
catch(e){this.context.logger.info("Unable to clone video as it is tainted",video);}
var blankCanvas=video.ownerDocument.createElement('canvas');blankCanvas.width=video.offsetWidth;blankCanvas.height=video.offsetHeight;return blankCanvas;};DocumentCloner.prototype.appendChildNode=function(clone,child,copyStyles){if(!isElementNode(child)||(!isScriptElement(child)&&!child.hasAttribute(IGNORE_ATTRIBUTE)&&(typeof this.options.ignoreElements!=='function'||!this.options.ignoreElements(child)))){if(!this.options.copyStyles||!isElementNode(child)||!isStyleElement(child)){clone.appendChild(this.cloneNode(child,copyStyles));}}};DocumentCloner.prototype.cloneChildNodes=function(node,clone,copyStyles){var _this=this;for(var child=node.shadowRoot?node.shadowRoot.firstChild:node.firstChild;child;child=child.nextSibling){if(isElementNode(child)&&isSlotElement(child)&&typeof child.assignedNodes==='function'){var assignedNodes=child.assignedNodes();if(assignedNodes.length){assignedNodes.forEach(function(assignedNode){return _this.appendChildNode(clone,assignedNode,copyStyles);});}}
else{this.appendChildNode(clone,child,copyStyles);}}};DocumentCloner.prototype.cloneNode=function(node,copyStyles){if(isTextNode(node)){return document.createTextNode(node.data);}
if(!node.ownerDocument){return node.cloneNode(false);}
var window=node.ownerDocument.defaultView;if(window&&isElementNode(node)&&(isHTMLElementNode(node)||isSVGElementNode(node))){var clone=this.createElementClone(node);clone.style.transitionProperty='none';var style=window.getComputedStyle(node);var styleBefore=window.getComputedStyle(node,':before');var styleAfter=window.getComputedStyle(node,':after');if(this.referenceElement===node&&isHTMLElementNode(clone)){this.clonedReferenceElement=clone;}
if(isBodyElement(clone)){createPseudoHideStyles(clone);}
var counters=this.counters.parse(new CSSParsedCounterDeclaration(this.context,style));var before=this.resolvePseudoContent(node,clone,styleBefore,PseudoElementType.BEFORE);if(isCustomElement(node)){copyStyles=true;}
if(!isVideoElement(node)){this.cloneChildNodes(node,clone,copyStyles);}
if(before){clone.insertBefore(before,clone.firstChild);}
var after=this.resolvePseudoContent(node,clone,styleAfter,PseudoElementType.AFTER);if(after){clone.appendChild(after);}
this.counters.pop(counters);if((style&&(this.options.copyStyles||isSVGElementNode(node))&&!isIFrameElement(node))||copyStyles){copyCSSStyles(style,clone);}
if(node.scrollTop!==0||node.scrollLeft!==0){this.scrolledElements.push([clone,node.scrollLeft,node.scrollTop]);}
if((isTextareaElement(node)||isSelectElement(node))&&(isTextareaElement(clone)||isSelectElement(clone))){clone.value=node.value;}
return clone;}
return node.cloneNode(false);};DocumentCloner.prototype.resolvePseudoContent=function(node,clone,style,pseudoElt){var _this=this;if(!style){return;}
var value=style.content;var document=clone.ownerDocument;if(!document||!value||value==='none'||value==='-moz-alt-content'||style.display==='none'){return;}
this.counters.parse(new CSSParsedCounterDeclaration(this.context,style));var declaration=new CSSParsedPseudoDeclaration(this.context,style);var anonymousReplacedElement=document.createElement('html2canvaspseudoelement');copyCSSStyles(style,anonymousReplacedElement);declaration.content.forEach(function(token){if(token.type===0){anonymousReplacedElement.appendChild(document.createTextNode(token.value));}
else if(token.type===22){var img=document.createElement('img');img.src=token.value;img.style.opacity='1';anonymousReplacedElement.appendChild(img);}
else if(token.type===18){if(token.name==='attr'){var attr=token.values.filter(isIdentToken);if(attr.length){anonymousReplacedElement.appendChild(document.createTextNode(node.getAttribute(attr[0].value)||''));}}
else if(token.name==='counter'){var _a=token.values.filter(nonFunctionArgSeparator),counter=_a[0],counterStyle=_a[1];if(counter&&isIdentToken(counter)){var counterState=_this.counters.getCounterValue(counter.value);var counterType=counterStyle&&isIdentToken(counterStyle)?listStyleType.parse(_this.context,counterStyle.value):3;anonymousReplacedElement.appendChild(document.createTextNode(createCounterText(counterState,counterType,false)));}}
else if(token.name==='counters'){var _b=token.values.filter(nonFunctionArgSeparator),counter=_b[0],delim=_b[1],counterStyle=_b[2];if(counter&&isIdentToken(counter)){var counterStates=_this.counters.getCounterValues(counter.value);var counterType_1=counterStyle&&isIdentToken(counterStyle)?listStyleType.parse(_this.context,counterStyle.value):3;var separator=delim&&delim.type===0?delim.value:'';var text=counterStates.map(function(value){return createCounterText(value,counterType_1,false);}).join(separator);anonymousReplacedElement.appendChild(document.createTextNode(text));}}
else;}
else if(token.type===20){switch(token.value){case'open-quote':anonymousReplacedElement.appendChild(document.createTextNode(getQuote(declaration.quotes,_this.quoteDepth++,true)));break;case'close-quote':anonymousReplacedElement.appendChild(document.createTextNode(getQuote(declaration.quotes,--_this.quoteDepth,false)));break;default:anonymousReplacedElement.appendChild(document.createTextNode(token.value));}}});anonymousReplacedElement.className=PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+PSEUDO_HIDE_ELEMENT_CLASS_AFTER;var newClassName=pseudoElt===PseudoElementType.BEFORE?" "+PSEUDO_HIDE_ELEMENT_CLASS_BEFORE:" "+PSEUDO_HIDE_ELEMENT_CLASS_AFTER;if(isSVGElementNode(clone)){clone.className.baseValue+=newClassName;}
else{clone.className+=newClassName;}
return anonymousReplacedElement;};DocumentCloner.destroy=function(container){if(container.parentNode){container.parentNode.removeChild(container);return true;}
return false;};return DocumentCloner;}());var PseudoElementType;(function(PseudoElementType){PseudoElementType[PseudoElementType["BEFORE"]=0]="BEFORE";PseudoElementType[PseudoElementType["AFTER"]=1]="AFTER";})(PseudoElementType||(PseudoElementType={}));var createIFrameContainer=function(ownerDocument,bounds){var cloneIframeContainer=ownerDocument.createElement('iframe');cloneIframeContainer.className='html2canvas-container';cloneIframeContainer.style.visibility='hidden';cloneIframeContainer.style.position='fixed';cloneIframeContainer.style.left='-10000px';cloneIframeContainer.style.top='0px';cloneIframeContainer.style.border='0';cloneIframeContainer.width=bounds.width.toString();cloneIframeContainer.height=bounds.height.toString();cloneIframeContainer.scrolling='no';cloneIframeContainer.setAttribute(IGNORE_ATTRIBUTE,'true');ownerDocument.body.appendChild(cloneIframeContainer);return cloneIframeContainer;};var imageReady=function(img){return new Promise(function(resolve){if(img.complete){resolve();return;}
if(!img.src){resolve();return;}
img.onload=resolve;img.onerror=resolve;});};var imagesReady=function(document){return Promise.all([].slice.call(document.images,0).map(imageReady));};var iframeLoader=function(iframe){return new Promise(function(resolve,reject){var cloneWindow=iframe.contentWindow;if(!cloneWindow){return reject("No window assigned for iframe");}
var documentClone=cloneWindow.document;var interval=setInterval(function(){if(documentClone.body.childNodes.length>0&&(documentClone.readyState==='complete'||documentClone.readyState==='interactive')){clearInterval(interval);resolve(iframe);}},50);});};var ignoredStyleProperties=['all','d','content'];var copyCSSStyles=function(style,target){for(var i=style.length-1;i>=0;i--){var property=style.item(i);if(ignoredStyleProperties.indexOf(property)===-1){target.style.setProperty(property,style.getPropertyValue(property));}}
return target;};var serializeDoctype=function(doctype){var str='';if(doctype){str+='<!DOCTYPE ';if(doctype.name){str+=doctype.name;}
if(doctype.internalSubset){str+=doctype.internalSubset;}
if(doctype.publicId){str+="\""+doctype.publicId+"\"";}
if(doctype.systemId){str+="\""+doctype.systemId+"\"";}
str+='>';}
return str;};var restoreOwnerScroll=function(ownerDocument,x,y){if(ownerDocument&&ownerDocument.defaultView&&(x!==ownerDocument.defaultView.pageXOffset||y!==ownerDocument.defaultView.pageYOffset)){ownerDocument.defaultView.scrollTo(x,y);}};var restoreNodeScroll=function(_a){var element=_a[0],x=_a[1],y=_a[2];element.scrollLeft=x;element.scrollTop=y;};var PSEUDO_BEFORE=':before';var PSEUDO_AFTER=':after';var PSEUDO_HIDE_ELEMENT_CLASS_BEFORE='___html2canvas___pseudoelement_before';var PSEUDO_HIDE_ELEMENT_CLASS_AFTER='___html2canvas___pseudoelement_after';var PSEUDO_HIDE_ELEMENT_STYLE="{\n    content: \"\" !important;\n    display: none !important;\n}";var createPseudoHideStyles=function(body){createStyles(body,"."+PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+PSEUDO_BEFORE+PSEUDO_HIDE_ELEMENT_STYLE+"\n         ."+PSEUDO_HIDE_ELEMENT_CLASS_AFTER+PSEUDO_AFTER+PSEUDO_HIDE_ELEMENT_STYLE);};var createStyles=function(body,styles){var document=body.ownerDocument;if(document){var style=document.createElement('style');style.textContent=styles;body.appendChild(style);}};var CacheStorage=(function(){function CacheStorage(){}
CacheStorage.getOrigin=function(url){var link=CacheStorage._link;if(!link){return'about:blank';}
link.href=url;link.href=link.href;return link.protocol+link.hostname+link.port;};CacheStorage.isSameOrigin=function(src){return CacheStorage.getOrigin(src)===CacheStorage._origin;};CacheStorage.setContext=function(window){CacheStorage._link=window.document.createElement('a');CacheStorage._origin=CacheStorage.getOrigin(window.location.href);};CacheStorage._origin='about:blank';return CacheStorage;}());var Cache=(function(){function Cache(context,_options){this.context=context;this._options=_options;this._cache={};}
Cache.prototype.addImage=function(src){var result=Promise.resolve();if(this.has(src)){return result;}
if(isBlobImage(src)||isRenderable(src)){(this._cache[src]=this.loadImage(src)).catch(function(){});return result;}
return result;};Cache.prototype.match=function(src){return this._cache[src];};Cache.prototype.loadImage=function(key){return __awaiter(this,void 0,void 0,function(){var isSameOrigin,useCORS,useProxy,src;var _this=this;return __generator(this,function(_a){switch(_a.label){case 0:isSameOrigin=CacheStorage.isSameOrigin(key);useCORS=!isInlineImage(key)&&this._options.useCORS===true&&FEATURES.SUPPORT_CORS_IMAGES&&!isSameOrigin;useProxy=!isInlineImage(key)&&!isSameOrigin&&!isBlobImage(key)&&typeof this._options.proxy==='string'&&FEATURES.SUPPORT_CORS_XHR&&!useCORS;if(!isSameOrigin&&this._options.allowTaint===false&&!isInlineImage(key)&&!isBlobImage(key)&&!useProxy&&!useCORS){return[2];}
src=key;if(!useProxy)return[3,2];return[4,this.proxy(src)];case 1:src=_a.sent();_a.label=2;case 2:this.context.logger.debug("Added image "+key.substring(0,256));return[4,new Promise(function(resolve,reject){var img=new Image();img.onload=function(){return resolve(img);};img.onerror=reject;if(isInlineBase64Image(src)||useCORS){img.crossOrigin='anonymous';}
img.src=src;if(img.complete===true){setTimeout(function(){return resolve(img);},500);}
if(_this._options.imageTimeout>0){setTimeout(function(){return reject("Timed out ("+_this._options.imageTimeout+"ms) loading image");},_this._options.imageTimeout);}})];case 3:return[2,_a.sent()];}});});};Cache.prototype.has=function(key){return typeof this._cache[key]!=='undefined';};Cache.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache));};Cache.prototype.proxy=function(src){var _this=this;var proxy=this._options.proxy;if(!proxy){throw new Error('No proxy defined');}
var key=src.substring(0,256);return new Promise(function(resolve,reject){var responseType=FEATURES.SUPPORT_RESPONSE_TYPE?'blob':'text';var xhr=new XMLHttpRequest();xhr.onload=function(){if(xhr.status===200){if(responseType==='text'){resolve(xhr.response);}
else{var reader_1=new FileReader();reader_1.addEventListener('load',function(){return resolve(reader_1.result);},false);reader_1.addEventListener('error',function(e){return reject(e);},false);reader_1.readAsDataURL(xhr.response);}}
else{reject("Failed to proxy resource "+key+" with status code "+xhr.status);}};xhr.onerror=reject;var queryString=proxy.indexOf('?')>-1?'&':'?';xhr.open('GET',""+proxy+queryString+"url="+encodeURIComponent(src)+"&responseType="+responseType);if(responseType!=='text'&&xhr instanceof XMLHttpRequest){xhr.responseType=responseType;}
if(_this._options.imageTimeout){var timeout_1=_this._options.imageTimeout;xhr.timeout=timeout_1;xhr.ontimeout=function(){return reject("Timed out ("+timeout_1+"ms) proxying "+key);};}
xhr.send();});};return Cache;}());var INLINE_SVG=/^data:image\/svg\+xml/i;var INLINE_BASE64=/^data:image\/.*;base64,/i;var INLINE_IMG=/^data:image\/.*/i;var isRenderable=function(src){return FEATURES.SUPPORT_SVG_DRAWING||!isSVG(src);};var isInlineImage=function(src){return INLINE_IMG.test(src);};var isInlineBase64Image=function(src){return INLINE_BASE64.test(src);};var isBlobImage=function(src){return src.substr(0,4)==='blob';};var isSVG=function(src){return src.substr(-3).toLowerCase()==='svg'||INLINE_SVG.test(src);};var Vector=(function(){function Vector(x,y){this.type=0;this.x=x;this.y=y;}
Vector.prototype.add=function(deltaX,deltaY){return new Vector(this.x+deltaX,this.y+deltaY);};return Vector;}());var lerp=function(a,b,t){return new Vector(a.x+(b.x-a.x)*t,a.y+(b.y-a.y)*t);};var BezierCurve=(function(){function BezierCurve(start,startControl,endControl,end){this.type=1;this.start=start;this.startControl=startControl;this.endControl=endControl;this.end=end;}
BezierCurve.prototype.subdivide=function(t,firstHalf){var ab=lerp(this.start,this.startControl,t);var bc=lerp(this.startControl,this.endControl,t);var cd=lerp(this.endControl,this.end,t);var abbc=lerp(ab,bc,t);var bccd=lerp(bc,cd,t);var dest=lerp(abbc,bccd,t);return firstHalf?new BezierCurve(this.start,ab,abbc,dest):new BezierCurve(dest,bccd,cd,this.end);};BezierCurve.prototype.add=function(deltaX,deltaY){return new BezierCurve(this.start.add(deltaX,deltaY),this.startControl.add(deltaX,deltaY),this.endControl.add(deltaX,deltaY),this.end.add(deltaX,deltaY));};BezierCurve.prototype.reverse=function(){return new BezierCurve(this.end,this.endControl,this.startControl,this.start);};return BezierCurve;}());var isBezierCurve=function(path){return path.type===1;};var BoundCurves=(function(){function BoundCurves(element){var styles=element.styles;var bounds=element.bounds;var _a=getAbsoluteValueForTuple(styles.borderTopLeftRadius,bounds.width,bounds.height),tlh=_a[0],tlv=_a[1];var _b=getAbsoluteValueForTuple(styles.borderTopRightRadius,bounds.width,bounds.height),trh=_b[0],trv=_b[1];var _c=getAbsoluteValueForTuple(styles.borderBottomRightRadius,bounds.width,bounds.height),brh=_c[0],brv=_c[1];var _d=getAbsoluteValueForTuple(styles.borderBottomLeftRadius,bounds.width,bounds.height),blh=_d[0],blv=_d[1];var factors=[];factors.push((tlh+trh)/bounds.width);factors.push((blh+brh)/bounds.width);factors.push((tlv+blv)/bounds.height);factors.push((trv+brv)/bounds.height);var maxFactor=Math.max.apply(Math,factors);if(maxFactor>1){tlh/=maxFactor;tlv/=maxFactor;trh/=maxFactor;trv/=maxFactor;brh/=maxFactor;brv/=maxFactor;blh/=maxFactor;blv/=maxFactor;}
var topWidth=bounds.width-trh;var rightHeight=bounds.height-brv;var bottomWidth=bounds.width-brh;var leftHeight=bounds.height-blv;var borderTopWidth=styles.borderTopWidth;var borderRightWidth=styles.borderRightWidth;var borderBottomWidth=styles.borderBottomWidth;var borderLeftWidth=styles.borderLeftWidth;var paddingTop=getAbsoluteValue(styles.paddingTop,element.bounds.width);var paddingRight=getAbsoluteValue(styles.paddingRight,element.bounds.width);var paddingBottom=getAbsoluteValue(styles.paddingBottom,element.bounds.width);var paddingLeft=getAbsoluteValue(styles.paddingLeft,element.bounds.width);this.topLeftBorderDoubleOuterBox=tlh>0||tlv>0?getCurvePoints(bounds.left+borderLeftWidth/3,bounds.top+borderTopWidth/3,tlh-borderLeftWidth/3,tlv-borderTopWidth/3,CORNER.TOP_LEFT):new Vector(bounds.left+borderLeftWidth/3,bounds.top+borderTopWidth/3);this.topRightBorderDoubleOuterBox=tlh>0||tlv>0?getCurvePoints(bounds.left+topWidth,bounds.top+borderTopWidth/3,trh-borderRightWidth/3,trv-borderTopWidth/3,CORNER.TOP_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth/3,bounds.top+borderTopWidth/3);this.bottomRightBorderDoubleOuterBox=brh>0||brv>0?getCurvePoints(bounds.left+bottomWidth,bounds.top+rightHeight,brh-borderRightWidth/3,brv-borderBottomWidth/3,CORNER.BOTTOM_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth/3,bounds.top+bounds.height-borderBottomWidth/3);this.bottomLeftBorderDoubleOuterBox=blh>0||blv>0?getCurvePoints(bounds.left+borderLeftWidth/3,bounds.top+leftHeight,blh-borderLeftWidth/3,blv-borderBottomWidth/3,CORNER.BOTTOM_LEFT):new Vector(bounds.left+borderLeftWidth/3,bounds.top+bounds.height-borderBottomWidth/3);this.topLeftBorderDoubleInnerBox=tlh>0||tlv>0?getCurvePoints(bounds.left+(borderLeftWidth*2)/3,bounds.top+(borderTopWidth*2)/3,tlh-(borderLeftWidth*2)/3,tlv-(borderTopWidth*2)/3,CORNER.TOP_LEFT):new Vector(bounds.left+(borderLeftWidth*2)/3,bounds.top+(borderTopWidth*2)/3);this.topRightBorderDoubleInnerBox=tlh>0||tlv>0?getCurvePoints(bounds.left+topWidth,bounds.top+(borderTopWidth*2)/3,trh-(borderRightWidth*2)/3,trv-(borderTopWidth*2)/3,CORNER.TOP_RIGHT):new Vector(bounds.left+bounds.width-(borderRightWidth*2)/3,bounds.top+(borderTopWidth*2)/3);this.bottomRightBorderDoubleInnerBox=brh>0||brv>0?getCurvePoints(bounds.left+bottomWidth,bounds.top+rightHeight,brh-(borderRightWidth*2)/3,brv-(borderBottomWidth*2)/3,CORNER.BOTTOM_RIGHT):new Vector(bounds.left+bounds.width-(borderRightWidth*2)/3,bounds.top+bounds.height-(borderBottomWidth*2)/3);this.bottomLeftBorderDoubleInnerBox=blh>0||blv>0?getCurvePoints(bounds.left+(borderLeftWidth*2)/3,bounds.top+leftHeight,blh-(borderLeftWidth*2)/3,blv-(borderBottomWidth*2)/3,CORNER.BOTTOM_LEFT):new Vector(bounds.left+(borderLeftWidth*2)/3,bounds.top+bounds.height-(borderBottomWidth*2)/3);this.topLeftBorderStroke=tlh>0||tlv>0?getCurvePoints(bounds.left+borderLeftWidth/2,bounds.top+borderTopWidth/2,tlh-borderLeftWidth/2,tlv-borderTopWidth/2,CORNER.TOP_LEFT):new Vector(bounds.left+borderLeftWidth/2,bounds.top+borderTopWidth/2);this.topRightBorderStroke=tlh>0||tlv>0?getCurvePoints(bounds.left+topWidth,bounds.top+borderTopWidth/2,trh-borderRightWidth/2,trv-borderTopWidth/2,CORNER.TOP_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth/2,bounds.top+borderTopWidth/2);this.bottomRightBorderStroke=brh>0||brv>0?getCurvePoints(bounds.left+bottomWidth,bounds.top+rightHeight,brh-borderRightWidth/2,brv-borderBottomWidth/2,CORNER.BOTTOM_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth/2,bounds.top+bounds.height-borderBottomWidth/2);this.bottomLeftBorderStroke=blh>0||blv>0?getCurvePoints(bounds.left+borderLeftWidth/2,bounds.top+leftHeight,blh-borderLeftWidth/2,blv-borderBottomWidth/2,CORNER.BOTTOM_LEFT):new Vector(bounds.left+borderLeftWidth/2,bounds.top+bounds.height-borderBottomWidth/2);this.topLeftBorderBox=tlh>0||tlv>0?getCurvePoints(bounds.left,bounds.top,tlh,tlv,CORNER.TOP_LEFT):new Vector(bounds.left,bounds.top);this.topRightBorderBox=trh>0||trv>0?getCurvePoints(bounds.left+topWidth,bounds.top,trh,trv,CORNER.TOP_RIGHT):new Vector(bounds.left+bounds.width,bounds.top);this.bottomRightBorderBox=brh>0||brv>0?getCurvePoints(bounds.left+bottomWidth,bounds.top+rightHeight,brh,brv,CORNER.BOTTOM_RIGHT):new Vector(bounds.left+bounds.width,bounds.top+bounds.height);this.bottomLeftBorderBox=blh>0||blv>0?getCurvePoints(bounds.left,bounds.top+leftHeight,blh,blv,CORNER.BOTTOM_LEFT):new Vector(bounds.left,bounds.top+bounds.height);this.topLeftPaddingBox=tlh>0||tlv>0?getCurvePoints(bounds.left+borderLeftWidth,bounds.top+borderTopWidth,Math.max(0,tlh-borderLeftWidth),Math.max(0,tlv-borderTopWidth),CORNER.TOP_LEFT):new Vector(bounds.left+borderLeftWidth,bounds.top+borderTopWidth);this.topRightPaddingBox=trh>0||trv>0?getCurvePoints(bounds.left+Math.min(topWidth,bounds.width-borderRightWidth),bounds.top+borderTopWidth,topWidth>bounds.width+borderRightWidth?0:Math.max(0,trh-borderRightWidth),Math.max(0,trv-borderTopWidth),CORNER.TOP_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth,bounds.top+borderTopWidth);this.bottomRightPaddingBox=brh>0||brv>0?getCurvePoints(bounds.left+Math.min(bottomWidth,bounds.width-borderLeftWidth),bounds.top+Math.min(rightHeight,bounds.height-borderBottomWidth),Math.max(0,brh-borderRightWidth),Math.max(0,brv-borderBottomWidth),CORNER.BOTTOM_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth,bounds.top+bounds.height-borderBottomWidth);this.bottomLeftPaddingBox=blh>0||blv>0?getCurvePoints(bounds.left+borderLeftWidth,bounds.top+Math.min(leftHeight,bounds.height-borderBottomWidth),Math.max(0,blh-borderLeftWidth),Math.max(0,blv-borderBottomWidth),CORNER.BOTTOM_LEFT):new Vector(bounds.left+borderLeftWidth,bounds.top+bounds.height-borderBottomWidth);this.topLeftContentBox=tlh>0||tlv>0?getCurvePoints(bounds.left+borderLeftWidth+paddingLeft,bounds.top+borderTopWidth+paddingTop,Math.max(0,tlh-(borderLeftWidth+paddingLeft)),Math.max(0,tlv-(borderTopWidth+paddingTop)),CORNER.TOP_LEFT):new Vector(bounds.left+borderLeftWidth+paddingLeft,bounds.top+borderTopWidth+paddingTop);this.topRightContentBox=trh>0||trv>0?getCurvePoints(bounds.left+Math.min(topWidth,bounds.width+borderLeftWidth+paddingLeft),bounds.top+borderTopWidth+paddingTop,topWidth>bounds.width+borderLeftWidth+paddingLeft?0:trh-borderLeftWidth+paddingLeft,trv-(borderTopWidth+paddingTop),CORNER.TOP_RIGHT):new Vector(bounds.left+bounds.width-(borderRightWidth+paddingRight),bounds.top+borderTopWidth+paddingTop);this.bottomRightContentBox=brh>0||brv>0?getCurvePoints(bounds.left+Math.min(bottomWidth,bounds.width-(borderLeftWidth+paddingLeft)),bounds.top+Math.min(rightHeight,bounds.height+borderTopWidth+paddingTop),Math.max(0,brh-(borderRightWidth+paddingRight)),brv-(borderBottomWidth+paddingBottom),CORNER.BOTTOM_RIGHT):new Vector(bounds.left+bounds.width-(borderRightWidth+paddingRight),bounds.top+bounds.height-(borderBottomWidth+paddingBottom));this.bottomLeftContentBox=blh>0||blv>0?getCurvePoints(bounds.left+borderLeftWidth+paddingLeft,bounds.top+leftHeight,Math.max(0,blh-(borderLeftWidth+paddingLeft)),blv-(borderBottomWidth+paddingBottom),CORNER.BOTTOM_LEFT):new Vector(bounds.left+borderLeftWidth+paddingLeft,bounds.top+bounds.height-(borderBottomWidth+paddingBottom));}
return BoundCurves;}());var CORNER;(function(CORNER){CORNER[CORNER["TOP_LEFT"]=0]="TOP_LEFT";CORNER[CORNER["TOP_RIGHT"]=1]="TOP_RIGHT";CORNER[CORNER["BOTTOM_RIGHT"]=2]="BOTTOM_RIGHT";CORNER[CORNER["BOTTOM_LEFT"]=3]="BOTTOM_LEFT";})(CORNER||(CORNER={}));var getCurvePoints=function(x,y,r1,r2,position){var kappa=4*((Math.sqrt(2)-1)/3);var ox=r1*kappa;var oy=r2*kappa;var xm=x+r1;var ym=y+r2;switch(position){case CORNER.TOP_LEFT:return new BezierCurve(new Vector(x,ym),new Vector(x,ym-oy),new Vector(xm-ox,y),new Vector(xm,y));case CORNER.TOP_RIGHT:return new BezierCurve(new Vector(x,y),new Vector(x+ox,y),new Vector(xm,ym-oy),new Vector(xm,ym));case CORNER.BOTTOM_RIGHT:return new BezierCurve(new Vector(xm,y),new Vector(xm,y+oy),new Vector(x+ox,ym),new Vector(x,ym));case CORNER.BOTTOM_LEFT:default:return new BezierCurve(new Vector(xm,ym),new Vector(xm-ox,ym),new Vector(x,y+oy),new Vector(x,y));}};var calculateBorderBoxPath=function(curves){return[curves.topLeftBorderBox,curves.topRightBorderBox,curves.bottomRightBorderBox,curves.bottomLeftBorderBox];};var calculateContentBoxPath=function(curves){return[curves.topLeftContentBox,curves.topRightContentBox,curves.bottomRightContentBox,curves.bottomLeftContentBox];};var calculatePaddingBoxPath=function(curves){return[curves.topLeftPaddingBox,curves.topRightPaddingBox,curves.bottomRightPaddingBox,curves.bottomLeftPaddingBox];};var TransformEffect=(function(){function TransformEffect(offsetX,offsetY,matrix){this.offsetX=offsetX;this.offsetY=offsetY;this.matrix=matrix;this.type=0;this.target=2|4;}
return TransformEffect;}());var ClipEffect=(function(){function ClipEffect(path,target){this.path=path;this.target=target;this.type=1;}
return ClipEffect;}());var OpacityEffect=(function(){function OpacityEffect(opacity){this.opacity=opacity;this.type=2;this.target=2|4;}
return OpacityEffect;}());var isTransformEffect=function(effect){return effect.type===0;};var isClipEffect=function(effect){return effect.type===1;};var isOpacityEffect=function(effect){return effect.type===2;};var equalPath=function(a,b){if(a.length===b.length){return a.some(function(v,i){return v===b[i];});}
return false;};var transformPath=function(path,deltaX,deltaY,deltaW,deltaH){return path.map(function(point,index){switch(index){case 0:return point.add(deltaX,deltaY);case 1:return point.add(deltaX+deltaW,deltaY);case 2:return point.add(deltaX+deltaW,deltaY+deltaH);case 3:return point.add(deltaX,deltaY+deltaH);}
return point;});};var StackingContext=(function(){function StackingContext(container){this.element=container;this.inlineLevel=[];this.nonInlineLevel=[];this.negativeZIndex=[];this.zeroOrAutoZIndexOrTransformedOrOpacity=[];this.positiveZIndex=[];this.nonPositionedFloats=[];this.nonPositionedInlineLevel=[];}
return StackingContext;}());var ElementPaint=(function(){function ElementPaint(container,parent){this.container=container;this.parent=parent;this.effects=[];this.curves=new BoundCurves(this.container);if(this.container.styles.opacity<1){this.effects.push(new OpacityEffect(this.container.styles.opacity));}
if(this.container.styles.transform!==null){var offsetX=this.container.bounds.left+this.container.styles.transformOrigin[0].number;var offsetY=this.container.bounds.top+this.container.styles.transformOrigin[1].number;var matrix=this.container.styles.transform;this.effects.push(new TransformEffect(offsetX,offsetY,matrix));}
if(this.container.styles.overflowX!==0){var borderBox=calculateBorderBoxPath(this.curves);var paddingBox=calculatePaddingBoxPath(this.curves);if(equalPath(borderBox,paddingBox)){this.effects.push(new ClipEffect(borderBox,2|4));}
else{this.effects.push(new ClipEffect(borderBox,2));this.effects.push(new ClipEffect(paddingBox,4));}}}
ElementPaint.prototype.getEffects=function(target){var inFlow=[2,3].indexOf(this.container.styles.position)===-1;var parent=this.parent;var effects=this.effects.slice(0);while(parent){var croplessEffects=parent.effects.filter(function(effect){return!isClipEffect(effect);});if(inFlow||parent.container.styles.position!==0||!parent.parent){effects.unshift.apply(effects,croplessEffects);inFlow=[2,3].indexOf(parent.container.styles.position)===-1;if(parent.container.styles.overflowX!==0){var borderBox=calculateBorderBoxPath(parent.curves);var paddingBox=calculatePaddingBoxPath(parent.curves);if(!equalPath(borderBox,paddingBox)){effects.unshift(new ClipEffect(paddingBox,2|4));}}}
else{effects.unshift.apply(effects,croplessEffects);}
parent=parent.parent;}
return effects.filter(function(effect){return contains(effect.target,target);});};return ElementPaint;}());var parseStackTree=function(parent,stackingContext,realStackingContext,listItems){parent.container.elements.forEach(function(child){var treatAsRealStackingContext=contains(child.flags,4);var createsStackingContext=contains(child.flags,2);var paintContainer=new ElementPaint(child,parent);if(contains(child.styles.display,2048)){listItems.push(paintContainer);}
var listOwnerItems=contains(child.flags,8)?[]:listItems;if(treatAsRealStackingContext||createsStackingContext){var parentStack=treatAsRealStackingContext||child.styles.isPositioned()?realStackingContext:stackingContext;var stack=new StackingContext(paintContainer);if(child.styles.isPositioned()||child.styles.opacity<1||child.styles.isTransformed()){var order_1=child.styles.zIndex.order;if(order_1<0){var index_1=0;parentStack.negativeZIndex.some(function(current,i){if(order_1>current.element.container.styles.zIndex.order){index_1=i;return false;}
else if(index_1>0){return true;}
return false;});parentStack.negativeZIndex.splice(index_1,0,stack);}
else if(order_1>0){var index_2=0;parentStack.positiveZIndex.some(function(current,i){if(order_1>=current.element.container.styles.zIndex.order){index_2=i+1;return false;}
else if(index_2>0){return true;}
return false;});parentStack.positiveZIndex.splice(index_2,0,stack);}
else{parentStack.zeroOrAutoZIndexOrTransformedOrOpacity.push(stack);}}
else{if(child.styles.isFloating()){parentStack.nonPositionedFloats.push(stack);}
else{parentStack.nonPositionedInlineLevel.push(stack);}}
parseStackTree(paintContainer,stack,treatAsRealStackingContext?stack:realStackingContext,listOwnerItems);}
else{if(child.styles.isInlineLevel()){stackingContext.inlineLevel.push(paintContainer);}
else{stackingContext.nonInlineLevel.push(paintContainer);}
parseStackTree(paintContainer,stackingContext,realStackingContext,listOwnerItems);}
if(contains(child.flags,8)){processListItems(child,listOwnerItems);}});};var processListItems=function(owner,elements){var numbering=owner instanceof OLElementContainer?owner.start:1;var reversed=owner instanceof OLElementContainer?owner.reversed:false;for(var i=0;i<elements.length;i++){var item=elements[i];if(item.container instanceof LIElementContainer&&typeof item.container.value==='number'&&item.container.value!==0){numbering=item.container.value;}
item.listValue=createCounterText(numbering,item.container.styles.listStyleType,true);numbering+=reversed?-1:1;}};var parseStackingContexts=function(container){var paintContainer=new ElementPaint(container,null);var root=new StackingContext(paintContainer);var listItems=[];parseStackTree(paintContainer,root,root,listItems);processListItems(paintContainer.container,listItems);return root;};var parsePathForBorder=function(curves,borderSide){switch(borderSide){case 0:return createPathFromCurves(curves.topLeftBorderBox,curves.topLeftPaddingBox,curves.topRightBorderBox,curves.topRightPaddingBox);case 1:return createPathFromCurves(curves.topRightBorderBox,curves.topRightPaddingBox,curves.bottomRightBorderBox,curves.bottomRightPaddingBox);case 2:return createPathFromCurves(curves.bottomRightBorderBox,curves.bottomRightPaddingBox,curves.bottomLeftBorderBox,curves.bottomLeftPaddingBox);case 3:default:return createPathFromCurves(curves.bottomLeftBorderBox,curves.bottomLeftPaddingBox,curves.topLeftBorderBox,curves.topLeftPaddingBox);}};var parsePathForBorderDoubleOuter=function(curves,borderSide){switch(borderSide){case 0:return createPathFromCurves(curves.topLeftBorderBox,curves.topLeftBorderDoubleOuterBox,curves.topRightBorderBox,curves.topRightBorderDoubleOuterBox);case 1:return createPathFromCurves(curves.topRightBorderBox,curves.topRightBorderDoubleOuterBox,curves.bottomRightBorderBox,curves.bottomRightBorderDoubleOuterBox);case 2:return createPathFromCurves(curves.bottomRightBorderBox,curves.bottomRightBorderDoubleOuterBox,curves.bottomLeftBorderBox,curves.bottomLeftBorderDoubleOuterBox);case 3:default:return createPathFromCurves(curves.bottomLeftBorderBox,curves.bottomLeftBorderDoubleOuterBox,curves.topLeftBorderBox,curves.topLeftBorderDoubleOuterBox);}};var parsePathForBorderDoubleInner=function(curves,borderSide){switch(borderSide){case 0:return createPathFromCurves(curves.topLeftBorderDoubleInnerBox,curves.topLeftPaddingBox,curves.topRightBorderDoubleInnerBox,curves.topRightPaddingBox);case 1:return createPathFromCurves(curves.topRightBorderDoubleInnerBox,curves.topRightPaddingBox,curves.bottomRightBorderDoubleInnerBox,curves.bottomRightPaddingBox);case 2:return createPathFromCurves(curves.bottomRightBorderDoubleInnerBox,curves.bottomRightPaddingBox,curves.bottomLeftBorderDoubleInnerBox,curves.bottomLeftPaddingBox);case 3:default:return createPathFromCurves(curves.bottomLeftBorderDoubleInnerBox,curves.bottomLeftPaddingBox,curves.topLeftBorderDoubleInnerBox,curves.topLeftPaddingBox);}};var parsePathForBorderStroke=function(curves,borderSide){switch(borderSide){case 0:return createStrokePathFromCurves(curves.topLeftBorderStroke,curves.topRightBorderStroke);case 1:return createStrokePathFromCurves(curves.topRightBorderStroke,curves.bottomRightBorderStroke);case 2:return createStrokePathFromCurves(curves.bottomRightBorderStroke,curves.bottomLeftBorderStroke);case 3:default:return createStrokePathFromCurves(curves.bottomLeftBorderStroke,curves.topLeftBorderStroke);}};var createStrokePathFromCurves=function(outer1,outer2){var path=[];if(isBezierCurve(outer1)){path.push(outer1.subdivide(0.5,false));}
else{path.push(outer1);}
if(isBezierCurve(outer2)){path.push(outer2.subdivide(0.5,true));}
else{path.push(outer2);}
return path;};var createPathFromCurves=function(outer1,inner1,outer2,inner2){var path=[];if(isBezierCurve(outer1)){path.push(outer1.subdivide(0.5,false));}
else{path.push(outer1);}
if(isBezierCurve(outer2)){path.push(outer2.subdivide(0.5,true));}
else{path.push(outer2);}
if(isBezierCurve(inner2)){path.push(inner2.subdivide(0.5,true).reverse());}
else{path.push(inner2);}
if(isBezierCurve(inner1)){path.push(inner1.subdivide(0.5,false).reverse());}
else{path.push(inner1);}
return path;};var paddingBox=function(element){var bounds=element.bounds;var styles=element.styles;return bounds.add(styles.borderLeftWidth,styles.borderTopWidth,-(styles.borderRightWidth+styles.borderLeftWidth),-(styles.borderTopWidth+styles.borderBottomWidth));};var contentBox=function(element){var styles=element.styles;var bounds=element.bounds;var paddingLeft=getAbsoluteValue(styles.paddingLeft,bounds.width);var paddingRight=getAbsoluteValue(styles.paddingRight,bounds.width);var paddingTop=getAbsoluteValue(styles.paddingTop,bounds.width);var paddingBottom=getAbsoluteValue(styles.paddingBottom,bounds.width);return bounds.add(paddingLeft+styles.borderLeftWidth,paddingTop+styles.borderTopWidth,-(styles.borderRightWidth+styles.borderLeftWidth+paddingLeft+paddingRight),-(styles.borderTopWidth+styles.borderBottomWidth+paddingTop+paddingBottom));};var calculateBackgroundPositioningArea=function(backgroundOrigin,element){if(backgroundOrigin===0){return element.bounds;}
if(backgroundOrigin===2){return contentBox(element);}
return paddingBox(element);};var calculateBackgroundPaintingArea=function(backgroundClip,element){if(backgroundClip===0){return element.bounds;}
if(backgroundClip===2){return contentBox(element);}
return paddingBox(element);};var calculateBackgroundRendering=function(container,index,intrinsicSize){var backgroundPositioningArea=calculateBackgroundPositioningArea(getBackgroundValueForIndex(container.styles.backgroundOrigin,index),container);var backgroundPaintingArea=calculateBackgroundPaintingArea(getBackgroundValueForIndex(container.styles.backgroundClip,index),container);var backgroundImageSize=calculateBackgroundSize(getBackgroundValueForIndex(container.styles.backgroundSize,index),intrinsicSize,backgroundPositioningArea);var sizeWidth=backgroundImageSize[0],sizeHeight=backgroundImageSize[1];var position=getAbsoluteValueForTuple(getBackgroundValueForIndex(container.styles.backgroundPosition,index),backgroundPositioningArea.width-sizeWidth,backgroundPositioningArea.height-sizeHeight);var path=calculateBackgroundRepeatPath(getBackgroundValueForIndex(container.styles.backgroundRepeat,index),position,backgroundImageSize,backgroundPositioningArea,backgroundPaintingArea);var offsetX=Math.round(backgroundPositioningArea.left+position[0]);var offsetY=Math.round(backgroundPositioningArea.top+position[1]);return[path,offsetX,offsetY,sizeWidth,sizeHeight];};var isAuto=function(token){return isIdentToken(token)&&token.value===BACKGROUND_SIZE.AUTO;};var hasIntrinsicValue=function(value){return typeof value==='number';};var calculateBackgroundSize=function(size,_a,bounds){var intrinsicWidth=_a[0],intrinsicHeight=_a[1],intrinsicProportion=_a[2];var first=size[0],second=size[1];if(!first){return[0,0];}
if(isLengthPercentage(first)&&second&&isLengthPercentage(second)){return[getAbsoluteValue(first,bounds.width),getAbsoluteValue(second,bounds.height)];}
var hasIntrinsicProportion=hasIntrinsicValue(intrinsicProportion);if(isIdentToken(first)&&(first.value===BACKGROUND_SIZE.CONTAIN||first.value===BACKGROUND_SIZE.COVER)){if(hasIntrinsicValue(intrinsicProportion)){var targetRatio=bounds.width/bounds.height;return targetRatio<intrinsicProportion!==(first.value===BACKGROUND_SIZE.COVER)?[bounds.width,bounds.width/intrinsicProportion]:[bounds.height*intrinsicProportion,bounds.height];}
return[bounds.width,bounds.height];}
var hasIntrinsicWidth=hasIntrinsicValue(intrinsicWidth);var hasIntrinsicHeight=hasIntrinsicValue(intrinsicHeight);var hasIntrinsicDimensions=hasIntrinsicWidth||hasIntrinsicHeight;if(isAuto(first)&&(!second||isAuto(second))){if(hasIntrinsicWidth&&hasIntrinsicHeight){return[intrinsicWidth,intrinsicHeight];}
if(!hasIntrinsicProportion&&!hasIntrinsicDimensions){return[bounds.width,bounds.height];}
if(hasIntrinsicDimensions&&hasIntrinsicProportion){var width_1=hasIntrinsicWidth?intrinsicWidth:intrinsicHeight*intrinsicProportion;var height_1=hasIntrinsicHeight?intrinsicHeight:intrinsicWidth/intrinsicProportion;return[width_1,height_1];}
var width_2=hasIntrinsicWidth?intrinsicWidth:bounds.width;var height_2=hasIntrinsicHeight?intrinsicHeight:bounds.height;return[width_2,height_2];}
if(hasIntrinsicProportion){var width_3=0;var height_3=0;if(isLengthPercentage(first)){width_3=getAbsoluteValue(first,bounds.width);}
else if(isLengthPercentage(second)){height_3=getAbsoluteValue(second,bounds.height);}
if(isAuto(first)){width_3=height_3*intrinsicProportion;}
else if(!second||isAuto(second)){height_3=width_3/intrinsicProportion;}
return[width_3,height_3];}
var width=null;var height=null;if(isLengthPercentage(first)){width=getAbsoluteValue(first,bounds.width);}
else if(second&&isLengthPercentage(second)){height=getAbsoluteValue(second,bounds.height);}
if(width!==null&&(!second||isAuto(second))){height=hasIntrinsicWidth&&hasIntrinsicHeight?(width/intrinsicWidth)*intrinsicHeight:bounds.height;}
if(height!==null&&isAuto(first)){width=hasIntrinsicWidth&&hasIntrinsicHeight?(height/intrinsicHeight)*intrinsicWidth:bounds.width;}
if(width!==null&&height!==null){return[width,height];}
throw new Error("Unable to calculate background-size for element");};var getBackgroundValueForIndex=function(values,index){var value=values[index];if(typeof value==='undefined'){return values[0];}
return value;};var calculateBackgroundRepeatPath=function(repeat,_a,_b,backgroundPositioningArea,backgroundPaintingArea){var x=_a[0],y=_a[1];var width=_b[0],height=_b[1];switch(repeat){case 2:return[new Vector(Math.round(backgroundPositioningArea.left),Math.round(backgroundPositioningArea.top+y)),new Vector(Math.round(backgroundPositioningArea.left+backgroundPositioningArea.width),Math.round(backgroundPositioningArea.top+y)),new Vector(Math.round(backgroundPositioningArea.left+backgroundPositioningArea.width),Math.round(height+backgroundPositioningArea.top+y)),new Vector(Math.round(backgroundPositioningArea.left),Math.round(height+backgroundPositioningArea.top+y))];case 3:return[new Vector(Math.round(backgroundPositioningArea.left+x),Math.round(backgroundPositioningArea.top)),new Vector(Math.round(backgroundPositioningArea.left+x+width),Math.round(backgroundPositioningArea.top)),new Vector(Math.round(backgroundPositioningArea.left+x+width),Math.round(backgroundPositioningArea.height+backgroundPositioningArea.top)),new Vector(Math.round(backgroundPositioningArea.left+x),Math.round(backgroundPositioningArea.height+backgroundPositioningArea.top))];case 1:return[new Vector(Math.round(backgroundPositioningArea.left+x),Math.round(backgroundPositioningArea.top+y)),new Vector(Math.round(backgroundPositioningArea.left+x+width),Math.round(backgroundPositioningArea.top+y)),new Vector(Math.round(backgroundPositioningArea.left+x+width),Math.round(backgroundPositioningArea.top+y+height)),new Vector(Math.round(backgroundPositioningArea.left+x),Math.round(backgroundPositioningArea.top+y+height))];default:return[new Vector(Math.round(backgroundPaintingArea.left),Math.round(backgroundPaintingArea.top)),new Vector(Math.round(backgroundPaintingArea.left+backgroundPaintingArea.width),Math.round(backgroundPaintingArea.top)),new Vector(Math.round(backgroundPaintingArea.left+backgroundPaintingArea.width),Math.round(backgroundPaintingArea.height+backgroundPaintingArea.top)),new Vector(Math.round(backgroundPaintingArea.left),Math.round(backgroundPaintingArea.height+backgroundPaintingArea.top))];}};var SMALL_IMAGE='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';var SAMPLE_TEXT='Hidden Text';var FontMetrics=(function(){function FontMetrics(document){this._data={};this._document=document;}
FontMetrics.prototype.parseMetrics=function(fontFamily,fontSize){var container=this._document.createElement('div');var img=this._document.createElement('img');var span=this._document.createElement('span');var body=this._document.body;container.style.visibility='hidden';container.style.fontFamily=fontFamily;container.style.fontSize=fontSize;container.style.margin='0';container.style.padding='0';container.style.whiteSpace='nowrap';body.appendChild(container);img.src=SMALL_IMAGE;img.width=1;img.height=1;img.style.margin='0';img.style.padding='0';img.style.verticalAlign='baseline';span.style.fontFamily=fontFamily;span.style.fontSize=fontSize;span.style.margin='0';span.style.padding='0';span.appendChild(this._document.createTextNode(SAMPLE_TEXT));container.appendChild(span);container.appendChild(img);var baseline=img.offsetTop-span.offsetTop+2;container.removeChild(span);container.appendChild(this._document.createTextNode(SAMPLE_TEXT));container.style.lineHeight='normal';img.style.verticalAlign='super';var middle=img.offsetTop-container.offsetTop+2;body.removeChild(container);return{baseline:baseline,middle:middle};};FontMetrics.prototype.getMetrics=function(fontFamily,fontSize){var key=fontFamily+" "+fontSize;if(typeof this._data[key]==='undefined'){this._data[key]=this.parseMetrics(fontFamily,fontSize);}
return this._data[key];};return FontMetrics;}());var Renderer=(function(){function Renderer(context,options){this.context=context;this.options=options;}
return Renderer;}());var MASK_OFFSET=10000;var CanvasRenderer=(function(_super){__extends(CanvasRenderer,_super);function CanvasRenderer(context,options){var _this=_super.call(this,context,options)||this;_this._activeEffects=[];_this.canvas=options.canvas?options.canvas:document.createElement('canvas');_this.ctx=_this.canvas.getContext('2d');if(!options.canvas){_this.canvas.width=Math.floor(options.width*options.scale);_this.canvas.height=Math.floor(options.height*options.scale);_this.canvas.style.width=options.width+"px";_this.canvas.style.height=options.height+"px";}
_this.fontMetrics=new FontMetrics(document);_this.ctx.scale(_this.options.scale,_this.options.scale);_this.ctx.translate(-options.x,-options.y);_this.ctx.textBaseline='bottom';_this._activeEffects=[];_this.context.logger.debug("Canvas renderer initialized ("+options.width+"x"+options.height+") with scale "+options.scale);return _this;}
CanvasRenderer.prototype.applyEffects=function(effects){var _this=this;while(this._activeEffects.length){this.popEffect();}
effects.forEach(function(effect){return _this.applyEffect(effect);});};CanvasRenderer.prototype.applyEffect=function(effect){this.ctx.save();if(isOpacityEffect(effect)){this.ctx.globalAlpha=effect.opacity;}
if(isTransformEffect(effect)){this.ctx.translate(effect.offsetX,effect.offsetY);this.ctx.transform(effect.matrix[0],effect.matrix[1],effect.matrix[2],effect.matrix[3],effect.matrix[4],effect.matrix[5]);this.ctx.translate(-effect.offsetX,-effect.offsetY);}
if(isClipEffect(effect)){this.path(effect.path);this.ctx.clip();}
this._activeEffects.push(effect);};CanvasRenderer.prototype.popEffect=function(){this._activeEffects.pop();this.ctx.restore();};CanvasRenderer.prototype.renderStack=function(stack){return __awaiter(this,void 0,void 0,function(){var styles;return __generator(this,function(_a){switch(_a.label){case 0:styles=stack.element.container.styles;if(!styles.isVisible())return[3,2];return[4,this.renderStackContent(stack)];case 1:_a.sent();_a.label=2;case 2:return[2];}});});};CanvasRenderer.prototype.renderNode=function(paint){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:if(contains(paint.container.flags,16)){debugger;}
if(!paint.container.styles.isVisible())return[3,3];return[4,this.renderNodeBackgroundAndBorders(paint)];case 1:_a.sent();return[4,this.renderNodeContent(paint)];case 2:_a.sent();_a.label=3;case 3:return[2];}});});};CanvasRenderer.prototype.renderTextWithLetterSpacing=function(text,letterSpacing,baseline){var _this=this;if(letterSpacing===0){this.ctx.fillText(text.text,text.bounds.left,text.bounds.top+baseline);}
else{var letters=segmentGraphemes(text.text);letters.reduce(function(left,letter){_this.ctx.fillText(letter,left,text.bounds.top+baseline);return left+_this.ctx.measureText(letter).width;},text.bounds.left);}};CanvasRenderer.prototype.createFontStyle=function(styles){var fontVariant=styles.fontVariant.filter(function(variant){return variant==='normal'||variant==='small-caps';}).join('');var fontFamily=fixIOSSystemFonts(styles.fontFamily).join(', ');var fontSize=isDimensionToken(styles.fontSize)?""+styles.fontSize.number+styles.fontSize.unit:styles.fontSize.number+"px";return[[styles.fontStyle,fontVariant,styles.fontWeight,fontSize,fontFamily].join(' '),fontFamily,fontSize];};CanvasRenderer.prototype.renderTextNode=function(text,styles){return __awaiter(this,void 0,void 0,function(){var _a,font,fontFamily,fontSize,_b,baseline,middle,paintOrder;var _this=this;return __generator(this,function(_c){_a=this.createFontStyle(styles),font=_a[0],fontFamily=_a[1],fontSize=_a[2];this.ctx.font=font;this.ctx.direction=styles.direction===1?'rtl':'ltr';this.ctx.textAlign='left';this.ctx.textBaseline='alphabetic';_b=this.fontMetrics.getMetrics(fontFamily,fontSize),baseline=_b.baseline,middle=_b.middle;paintOrder=styles.paintOrder;text.textBounds.forEach(function(text){paintOrder.forEach(function(paintOrderLayer){switch(paintOrderLayer){case 0:_this.ctx.fillStyle=asString(styles.color);_this.renderTextWithLetterSpacing(text,styles.letterSpacing,baseline);var textShadows=styles.textShadow;if(textShadows.length&&text.text.trim().length){textShadows.slice(0).reverse().forEach(function(textShadow){_this.ctx.shadowColor=asString(textShadow.color);_this.ctx.shadowOffsetX=textShadow.offsetX.number*_this.options.scale;_this.ctx.shadowOffsetY=textShadow.offsetY.number*_this.options.scale;_this.ctx.shadowBlur=textShadow.blur.number;_this.renderTextWithLetterSpacing(text,styles.letterSpacing,baseline);});_this.ctx.shadowColor='';_this.ctx.shadowOffsetX=0;_this.ctx.shadowOffsetY=0;_this.ctx.shadowBlur=0;}
if(styles.textDecorationLine.length){_this.ctx.fillStyle=asString(styles.textDecorationColor||styles.color);styles.textDecorationLine.forEach(function(textDecorationLine){switch(textDecorationLine){case 1:_this.ctx.fillRect(text.bounds.left,Math.round(text.bounds.top+baseline),text.bounds.width,1);break;case 2:_this.ctx.fillRect(text.bounds.left,Math.round(text.bounds.top),text.bounds.width,1);break;case 3:_this.ctx.fillRect(text.bounds.left,Math.ceil(text.bounds.top+middle),text.bounds.width,1);break;}});}
break;case 1:if(styles.webkitTextStrokeWidth&&text.text.trim().length){_this.ctx.strokeStyle=asString(styles.webkitTextStrokeColor);_this.ctx.lineWidth=styles.webkitTextStrokeWidth;_this.ctx.lineJoin=!!window.chrome?'miter':'round';_this.ctx.strokeText(text.text,text.bounds.left,text.bounds.top+baseline);}
_this.ctx.strokeStyle='';_this.ctx.lineWidth=0;_this.ctx.lineJoin='miter';break;}});});return[2];});});};CanvasRenderer.prototype.renderReplacedElement=function(container,curves,image){if(image&&container.intrinsicWidth>0&&container.intrinsicHeight>0){var box=contentBox(container);var path=calculatePaddingBoxPath(curves);this.path(path);this.ctx.save();this.ctx.clip();this.ctx.drawImage(image,0,0,container.intrinsicWidth,container.intrinsicHeight,box.left,box.top,box.width,box.height);this.ctx.restore();}};CanvasRenderer.prototype.renderNodeContent=function(paint){return __awaiter(this,void 0,void 0,function(){var container,curves,styles,_i,_a,child,image,image,iframeRenderer,canvas,size,_b,fontFamily,fontSize,baseline,bounds,x,textBounds,img,image,url,fontFamily,bounds;return __generator(this,function(_c){switch(_c.label){case 0:this.applyEffects(paint.getEffects(4));container=paint.container;curves=paint.curves;styles=container.styles;_i=0,_a=container.textNodes;_c.label=1;case 1:if(!(_i<_a.length))return[3,4];child=_a[_i];return[4,this.renderTextNode(child,styles)];case 2:_c.sent();_c.label=3;case 3:_i++;return[3,1];case 4:if(!(container instanceof ImageElementContainer))return[3,8];_c.label=5;case 5:_c.trys.push([5,7,,8]);return[4,this.context.cache.match(container.src)];case 6:image=_c.sent();this.renderReplacedElement(container,curves,image);return[3,8];case 7:_c.sent();this.context.logger.error("Error loading image "+container.src);return[3,8];case 8:if(container instanceof CanvasElementContainer){this.renderReplacedElement(container,curves,container.canvas);}
if(!(container instanceof SVGElementContainer))return[3,12];_c.label=9;case 9:_c.trys.push([9,11,,12]);return[4,this.context.cache.match(container.svg)];case 10:image=_c.sent();this.renderReplacedElement(container,curves,image);return[3,12];case 11:_c.sent();this.context.logger.error("Error loading svg "+container.svg.substring(0,255));return[3,12];case 12:if(!(container instanceof IFrameElementContainer&&container.tree))return[3,14];iframeRenderer=new CanvasRenderer(this.context,{scale:this.options.scale,backgroundColor:container.backgroundColor,x:0,y:0,width:container.width,height:container.height});return[4,iframeRenderer.render(container.tree)];case 13:canvas=_c.sent();if(container.width&&container.height){this.ctx.drawImage(canvas,0,0,container.width,container.height,container.bounds.left,container.bounds.top,container.bounds.width,container.bounds.height);}
_c.label=14;case 14:if(container instanceof InputElementContainer){size=Math.min(container.bounds.width,container.bounds.height);if(container.type===CHECKBOX){if(container.checked){this.ctx.save();this.path([new Vector(container.bounds.left+size*0.39363,container.bounds.top+size*0.79),new Vector(container.bounds.left+size*0.16,container.bounds.top+size*0.5549),new Vector(container.bounds.left+size*0.27347,container.bounds.top+size*0.44071),new Vector(container.bounds.left+size*0.39694,container.bounds.top+size*0.5649),new Vector(container.bounds.left+size*0.72983,container.bounds.top+size*0.23),new Vector(container.bounds.left+size*0.84,container.bounds.top+size*0.34085),new Vector(container.bounds.left+size*0.39363,container.bounds.top+size*0.79)]);this.ctx.fillStyle=asString(INPUT_COLOR);this.ctx.fill();this.ctx.restore();}}
else if(container.type===RADIO){if(container.checked){this.ctx.save();this.ctx.beginPath();this.ctx.arc(container.bounds.left+size/2,container.bounds.top+size/2,size/4,0,Math.PI*2,true);this.ctx.fillStyle=asString(INPUT_COLOR);this.ctx.fill();this.ctx.restore();}}}
if(isTextInputElement(container)&&container.value.length){_b=this.createFontStyle(styles),fontFamily=_b[0],fontSize=_b[1];baseline=this.fontMetrics.getMetrics(fontFamily,fontSize).baseline;this.ctx.font=fontFamily;this.ctx.fillStyle=asString(styles.color);this.ctx.textBaseline='alphabetic';this.ctx.textAlign=canvasTextAlign(container.styles.textAlign);bounds=contentBox(container);x=0;switch(container.styles.textAlign){case 1:x+=bounds.width/2;break;case 2:x+=bounds.width;break;}
textBounds=bounds.add(x,0,0,-bounds.height/2+1);this.ctx.save();this.path([new Vector(bounds.left,bounds.top),new Vector(bounds.left+bounds.width,bounds.top),new Vector(bounds.left+bounds.width,bounds.top+bounds.height),new Vector(bounds.left,bounds.top+bounds.height)]);this.ctx.clip();this.renderTextWithLetterSpacing(new TextBounds(container.value,textBounds),styles.letterSpacing,baseline);this.ctx.restore();this.ctx.textBaseline='alphabetic';this.ctx.textAlign='left';}
if(!contains(container.styles.display,2048))return[3,20];if(!(container.styles.listStyleImage!==null))return[3,19];img=container.styles.listStyleImage;if(!(img.type===0))return[3,18];image=void 0;url=img.url;_c.label=15;case 15:_c.trys.push([15,17,,18]);return[4,this.context.cache.match(url)];case 16:image=_c.sent();this.ctx.drawImage(image,container.bounds.left-(image.width+10),container.bounds.top);return[3,18];case 17:_c.sent();this.context.logger.error("Error loading list-style-image "+url);return[3,18];case 18:return[3,20];case 19:if(paint.listValue&&container.styles.listStyleType!==-1){fontFamily=this.createFontStyle(styles)[0];this.ctx.font=fontFamily;this.ctx.fillStyle=asString(styles.color);this.ctx.textBaseline='middle';this.ctx.textAlign='right';bounds=new Bounds(container.bounds.left,container.bounds.top+getAbsoluteValue(container.styles.paddingTop,container.bounds.width),container.bounds.width,computeLineHeight(styles.lineHeight,styles.fontSize.number)/2+1);this.renderTextWithLetterSpacing(new TextBounds(paint.listValue,bounds),styles.letterSpacing,computeLineHeight(styles.lineHeight,styles.fontSize.number)/2+2);this.ctx.textBaseline='bottom';this.ctx.textAlign='left';}
_c.label=20;case 20:return[2];}});});};CanvasRenderer.prototype.renderStackContent=function(stack){return __awaiter(this,void 0,void 0,function(){var _i,_a,child,_b,_c,child,_d,_e,child,_f,_g,child,_h,_j,child,_k,_l,child,_m,_o,child;return __generator(this,function(_p){switch(_p.label){case 0:if(contains(stack.element.container.flags,16)){debugger;}
return[4,this.renderNodeBackgroundAndBorders(stack.element)];case 1:_p.sent();_i=0,_a=stack.negativeZIndex;_p.label=2;case 2:if(!(_i<_a.length))return[3,5];child=_a[_i];return[4,this.renderStack(child)];case 3:_p.sent();_p.label=4;case 4:_i++;return[3,2];case 5:return[4,this.renderNodeContent(stack.element)];case 6:_p.sent();_b=0,_c=stack.nonInlineLevel;_p.label=7;case 7:if(!(_b<_c.length))return[3,10];child=_c[_b];return[4,this.renderNode(child)];case 8:_p.sent();_p.label=9;case 9:_b++;return[3,7];case 10:_d=0,_e=stack.nonPositionedFloats;_p.label=11;case 11:if(!(_d<_e.length))return[3,14];child=_e[_d];return[4,this.renderStack(child)];case 12:_p.sent();_p.label=13;case 13:_d++;return[3,11];case 14:_f=0,_g=stack.nonPositionedInlineLevel;_p.label=15;case 15:if(!(_f<_g.length))return[3,18];child=_g[_f];return[4,this.renderStack(child)];case 16:_p.sent();_p.label=17;case 17:_f++;return[3,15];case 18:_h=0,_j=stack.inlineLevel;_p.label=19;case 19:if(!(_h<_j.length))return[3,22];child=_j[_h];return[4,this.renderNode(child)];case 20:_p.sent();_p.label=21;case 21:_h++;return[3,19];case 22:_k=0,_l=stack.zeroOrAutoZIndexOrTransformedOrOpacity;_p.label=23;case 23:if(!(_k<_l.length))return[3,26];child=_l[_k];return[4,this.renderStack(child)];case 24:_p.sent();_p.label=25;case 25:_k++;return[3,23];case 26:_m=0,_o=stack.positiveZIndex;_p.label=27;case 27:if(!(_m<_o.length))return[3,30];child=_o[_m];return[4,this.renderStack(child)];case 28:_p.sent();_p.label=29;case 29:_m++;return[3,27];case 30:return[2];}});});};CanvasRenderer.prototype.mask=function(paths){this.ctx.beginPath();this.ctx.moveTo(0,0);this.ctx.lineTo(this.canvas.width,0);this.ctx.lineTo(this.canvas.width,this.canvas.height);this.ctx.lineTo(0,this.canvas.height);this.ctx.lineTo(0,0);this.formatPath(paths.slice(0).reverse());this.ctx.closePath();};CanvasRenderer.prototype.path=function(paths){this.ctx.beginPath();this.formatPath(paths);this.ctx.closePath();};CanvasRenderer.prototype.formatPath=function(paths){var _this=this;paths.forEach(function(point,index){var start=isBezierCurve(point)?point.start:point;if(index===0){_this.ctx.moveTo(start.x,start.y);}
else{_this.ctx.lineTo(start.x,start.y);}
if(isBezierCurve(point)){_this.ctx.bezierCurveTo(point.startControl.x,point.startControl.y,point.endControl.x,point.endControl.y,point.end.x,point.end.y);}});};CanvasRenderer.prototype.renderRepeat=function(path,pattern,offsetX,offsetY){this.path(path);this.ctx.fillStyle=pattern;this.ctx.translate(offsetX,offsetY);this.ctx.fill();this.ctx.translate(-offsetX,-offsetY);};CanvasRenderer.prototype.resizeImage=function(image,width,height){var _a;if(image.width===width&&image.height===height){return image;}
var ownerDocument=(_a=this.canvas.ownerDocument)!==null&&_a!==void 0?_a:document;var canvas=ownerDocument.createElement('canvas');canvas.width=Math.max(1,width);canvas.height=Math.max(1,height);var ctx=canvas.getContext('2d');ctx.drawImage(image,0,0,image.width,image.height,0,0,width,height);return canvas;};CanvasRenderer.prototype.renderBackgroundImage=function(container){return __awaiter(this,void 0,void 0,function(){var index,_loop_1,this_1,_i,_a,backgroundImage;return __generator(this,function(_b){switch(_b.label){case 0:index=container.styles.backgroundImage.length-1;_loop_1=function(backgroundImage){var image,url,_c,path,x,y,width,height,pattern,_d,path,x,y,width,height,_e,lineLength,x0,x1,y0,y1,canvas,ctx,gradient_1,pattern,_f,path,left,top_1,width,height,position,x,y,_g,rx,ry,radialGradient_1,midX,midY,f,invF;return __generator(this,function(_h){switch(_h.label){case 0:if(!(backgroundImage.type===0))return[3,5];image=void 0;url=backgroundImage.url;_h.label=1;case 1:_h.trys.push([1,3,,4]);return[4,this_1.context.cache.match(url)];case 2:image=_h.sent();return[3,4];case 3:_h.sent();this_1.context.logger.error("Error loading background-image "+url);return[3,4];case 4:if(image){_c=calculateBackgroundRendering(container,index,[image.width,image.height,image.width/image.height]),path=_c[0],x=_c[1],y=_c[2],width=_c[3],height=_c[4];pattern=this_1.ctx.createPattern(this_1.resizeImage(image,width,height),'repeat');this_1.renderRepeat(path,pattern,x,y);}
return[3,6];case 5:if(isLinearGradient(backgroundImage)){_d=calculateBackgroundRendering(container,index,[null,null,null]),path=_d[0],x=_d[1],y=_d[2],width=_d[3],height=_d[4];_e=calculateGradientDirection(backgroundImage.angle,width,height),lineLength=_e[0],x0=_e[1],x1=_e[2],y0=_e[3],y1=_e[4];canvas=document.createElement('canvas');canvas.width=width;canvas.height=height;ctx=canvas.getContext('2d');gradient_1=ctx.createLinearGradient(x0,y0,x1,y1);processColorStops(backgroundImage.stops,lineLength).forEach(function(colorStop){return gradient_1.addColorStop(colorStop.stop,asString(colorStop.color));});ctx.fillStyle=gradient_1;ctx.fillRect(0,0,width,height);if(width>0&&height>0){pattern=this_1.ctx.createPattern(canvas,'repeat');this_1.renderRepeat(path,pattern,x,y);}}
else if(isRadialGradient(backgroundImage)){_f=calculateBackgroundRendering(container,index,[null,null,null]),path=_f[0],left=_f[1],top_1=_f[2],width=_f[3],height=_f[4];position=backgroundImage.position.length===0?[FIFTY_PERCENT]:backgroundImage.position;x=getAbsoluteValue(position[0],width);y=getAbsoluteValue(position[position.length-1],height);_g=calculateRadius(backgroundImage,x,y,width,height),rx=_g[0],ry=_g[1];if(rx>0&&ry>0){radialGradient_1=this_1.ctx.createRadialGradient(left+x,top_1+y,0,left+x,top_1+y,rx);processColorStops(backgroundImage.stops,rx*2).forEach(function(colorStop){return radialGradient_1.addColorStop(colorStop.stop,asString(colorStop.color));});this_1.path(path);this_1.ctx.fillStyle=radialGradient_1;if(rx!==ry){midX=container.bounds.left+0.5*container.bounds.width;midY=container.bounds.top+0.5*container.bounds.height;f=ry/rx;invF=1/f;this_1.ctx.save();this_1.ctx.translate(midX,midY);this_1.ctx.transform(1,0,0,f,0,0);this_1.ctx.translate(-midX,-midY);this_1.ctx.fillRect(left,invF*(top_1-midY)+midY,width,height*invF);this_1.ctx.restore();}
else{this_1.ctx.fill();}}}
_h.label=6;case 6:index--;return[2];}});};this_1=this;_i=0,_a=container.styles.backgroundImage.slice(0).reverse();_b.label=1;case 1:if(!(_i<_a.length))return[3,4];backgroundImage=_a[_i];return[5,_loop_1(backgroundImage)];case 2:_b.sent();_b.label=3;case 3:_i++;return[3,1];case 4:return[2];}});});};CanvasRenderer.prototype.renderSolidBorder=function(color,side,curvePoints){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){this.path(parsePathForBorder(curvePoints,side));this.ctx.fillStyle=asString(color);this.ctx.fill();return[2];});});};CanvasRenderer.prototype.renderDoubleBorder=function(color,width,side,curvePoints){return __awaiter(this,void 0,void 0,function(){var outerPaths,innerPaths;return __generator(this,function(_a){switch(_a.label){case 0:if(!(width<3))return[3,2];return[4,this.renderSolidBorder(color,side,curvePoints)];case 1:_a.sent();return[2];case 2:outerPaths=parsePathForBorderDoubleOuter(curvePoints,side);this.path(outerPaths);this.ctx.fillStyle=asString(color);this.ctx.fill();innerPaths=parsePathForBorderDoubleInner(curvePoints,side);this.path(innerPaths);this.ctx.fill();return[2];}});});};CanvasRenderer.prototype.renderNodeBackgroundAndBorders=function(paint){return __awaiter(this,void 0,void 0,function(){var styles,hasBackground,borders,backgroundPaintingArea,side,_i,borders_1,border;var _this=this;return __generator(this,function(_a){switch(_a.label){case 0:this.applyEffects(paint.getEffects(2));styles=paint.container.styles;hasBackground=!isTransparent(styles.backgroundColor)||styles.backgroundImage.length;borders=[{style:styles.borderTopStyle,color:styles.borderTopColor,width:styles.borderTopWidth},{style:styles.borderRightStyle,color:styles.borderRightColor,width:styles.borderRightWidth},{style:styles.borderBottomStyle,color:styles.borderBottomColor,width:styles.borderBottomWidth},{style:styles.borderLeftStyle,color:styles.borderLeftColor,width:styles.borderLeftWidth}];backgroundPaintingArea=calculateBackgroundCurvedPaintingArea(getBackgroundValueForIndex(styles.backgroundClip,0),paint.curves);if(!(hasBackground||styles.boxShadow.length))return[3,2];this.ctx.save();this.path(backgroundPaintingArea);this.ctx.clip();if(!isTransparent(styles.backgroundColor)){this.ctx.fillStyle=asString(styles.backgroundColor);this.ctx.fill();}
return[4,this.renderBackgroundImage(paint.container)];case 1:_a.sent();this.ctx.restore();styles.boxShadow.slice(0).reverse().forEach(function(shadow){_this.ctx.save();var borderBoxArea=calculateBorderBoxPath(paint.curves);var maskOffset=shadow.inset?0:MASK_OFFSET;var shadowPaintingArea=transformPath(borderBoxArea,-maskOffset+(shadow.inset?1:-1)*shadow.spread.number,(shadow.inset?1:-1)*shadow.spread.number,shadow.spread.number*(shadow.inset?-2:2),shadow.spread.number*(shadow.inset?-2:2));if(shadow.inset){_this.path(borderBoxArea);_this.ctx.clip();_this.mask(shadowPaintingArea);}
else{_this.mask(borderBoxArea);_this.ctx.clip();_this.path(shadowPaintingArea);}
_this.ctx.shadowOffsetX=shadow.offsetX.number+maskOffset;_this.ctx.shadowOffsetY=shadow.offsetY.number;_this.ctx.shadowColor=asString(shadow.color);_this.ctx.shadowBlur=shadow.blur.number;_this.ctx.fillStyle=shadow.inset?asString(shadow.color):'rgba(0,0,0,1)';_this.ctx.fill();_this.ctx.restore();});_a.label=2;case 2:side=0;_i=0,borders_1=borders;_a.label=3;case 3:if(!(_i<borders_1.length))return[3,13];border=borders_1[_i];if(!(border.style!==0&&!isTransparent(border.color)&&border.width>0))return[3,11];if(!(border.style===2))return[3,5];return[4,this.renderDashedDottedBorder(border.color,border.width,side,paint.curves,2)];case 4:_a.sent();return[3,11];case 5:if(!(border.style===3))return[3,7];return[4,this.renderDashedDottedBorder(border.color,border.width,side,paint.curves,3)];case 6:_a.sent();return[3,11];case 7:if(!(border.style===4))return[3,9];return[4,this.renderDoubleBorder(border.color,border.width,side,paint.curves)];case 8:_a.sent();return[3,11];case 9:return[4,this.renderSolidBorder(border.color,side,paint.curves)];case 10:_a.sent();_a.label=11;case 11:side++;_a.label=12;case 12:_i++;return[3,3];case 13:return[2];}});});};CanvasRenderer.prototype.renderDashedDottedBorder=function(color,width,side,curvePoints,style){return __awaiter(this,void 0,void 0,function(){var strokePaths,boxPaths,startX,startY,endX,endY,length,dashLength,spaceLength,useLineDash,multiplier,numberOfDashes,minSpace,maxSpace,path1,path2,path1,path2;return __generator(this,function(_a){this.ctx.save();strokePaths=parsePathForBorderStroke(curvePoints,side);boxPaths=parsePathForBorder(curvePoints,side);if(style===2){this.path(boxPaths);this.ctx.clip();}
if(isBezierCurve(boxPaths[0])){startX=boxPaths[0].start.x;startY=boxPaths[0].start.y;}
else{startX=boxPaths[0].x;startY=boxPaths[0].y;}
if(isBezierCurve(boxPaths[1])){endX=boxPaths[1].end.x;endY=boxPaths[1].end.y;}
else{endX=boxPaths[1].x;endY=boxPaths[1].y;}
if(side===0||side===2){length=Math.abs(startX-endX);}
else{length=Math.abs(startY-endY);}
this.ctx.beginPath();if(style===3){this.formatPath(strokePaths);}
else{this.formatPath(boxPaths.slice(0,2));}
dashLength=width<3?width*3:width*2;spaceLength=width<3?width*2:width;if(style===3){dashLength=width;spaceLength=width;}
useLineDash=true;if(length<=dashLength*2){useLineDash=false;}
else if(length<=dashLength*2+spaceLength){multiplier=length/(2*dashLength+spaceLength);dashLength*=multiplier;spaceLength*=multiplier;}
else{numberOfDashes=Math.floor((length+spaceLength)/(dashLength+spaceLength));minSpace=(length-numberOfDashes*dashLength)/(numberOfDashes-1);maxSpace=(length-(numberOfDashes+1)*dashLength)/numberOfDashes;spaceLength=maxSpace<=0||Math.abs(spaceLength-minSpace)<Math.abs(spaceLength-maxSpace)?minSpace:maxSpace;}
if(useLineDash){if(style===3){this.ctx.setLineDash([0,dashLength+spaceLength]);}
else{this.ctx.setLineDash([dashLength,spaceLength]);}}
if(style===3){this.ctx.lineCap='round';this.ctx.lineWidth=width;}
else{this.ctx.lineWidth=width*2+1.1;}
this.ctx.strokeStyle=asString(color);this.ctx.stroke();this.ctx.setLineDash([]);if(style===2){if(isBezierCurve(boxPaths[0])){path1=boxPaths[3];path2=boxPaths[0];this.ctx.beginPath();this.formatPath([new Vector(path1.end.x,path1.end.y),new Vector(path2.start.x,path2.start.y)]);this.ctx.stroke();}
if(isBezierCurve(boxPaths[1])){path1=boxPaths[1];path2=boxPaths[2];this.ctx.beginPath();this.formatPath([new Vector(path1.end.x,path1.end.y),new Vector(path2.start.x,path2.start.y)]);this.ctx.stroke();}}
this.ctx.restore();return[2];});});};CanvasRenderer.prototype.render=function(element){return __awaiter(this,void 0,void 0,function(){var stack;return __generator(this,function(_a){switch(_a.label){case 0:if(this.options.backgroundColor){this.ctx.fillStyle=asString(this.options.backgroundColor);this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height);}
stack=parseStackingContexts(element);return[4,this.renderStack(stack)];case 1:_a.sent();this.applyEffects([]);return[2,this.canvas];}});});};return CanvasRenderer;}(Renderer));var isTextInputElement=function(container){if(container instanceof TextareaElementContainer){return true;}
else if(container instanceof SelectElementContainer){return true;}
else if(container instanceof InputElementContainer&&container.type!==RADIO&&container.type!==CHECKBOX){return true;}
return false;};var calculateBackgroundCurvedPaintingArea=function(clip,curves){switch(clip){case 0:return calculateBorderBoxPath(curves);case 2:return calculateContentBoxPath(curves);case 1:default:return calculatePaddingBoxPath(curves);}};var canvasTextAlign=function(textAlign){switch(textAlign){case 1:return'center';case 2:return'right';case 0:default:return'left';}};var iOSBrokenFonts=['-apple-system','system-ui'];var fixIOSSystemFonts=function(fontFamilies){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?fontFamilies.filter(function(fontFamily){return iOSBrokenFonts.indexOf(fontFamily)===-1;}):fontFamilies;};var ForeignObjectRenderer=(function(_super){__extends(ForeignObjectRenderer,_super);function ForeignObjectRenderer(context,options){var _this=_super.call(this,context,options)||this;_this.canvas=options.canvas?options.canvas:document.createElement('canvas');_this.ctx=_this.canvas.getContext('2d');_this.options=options;_this.canvas.width=Math.floor(options.width*options.scale);_this.canvas.height=Math.floor(options.height*options.scale);_this.canvas.style.width=options.width+"px";_this.canvas.style.height=options.height+"px";_this.ctx.scale(_this.options.scale,_this.options.scale);_this.ctx.translate(-options.x,-options.y);_this.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+options.width+"x"+options.height+" at "+options.x+","+options.y+") with scale "+options.scale);return _this;}
ForeignObjectRenderer.prototype.render=function(element){return __awaiter(this,void 0,void 0,function(){var svg,img;return __generator(this,function(_a){switch(_a.label){case 0:svg=createForeignObjectSVG(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,element);return[4,loadSerializedSVG(svg)];case 1:img=_a.sent();if(this.options.backgroundColor){this.ctx.fillStyle=asString(this.options.backgroundColor);this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale);}
this.ctx.drawImage(img,-this.options.x*this.options.scale,-this.options.y*this.options.scale);return[2,this.canvas];}});});};return ForeignObjectRenderer;}(Renderer));var loadSerializedSVG=function(svg){return new Promise(function(resolve,reject){var img=new Image();img.onload=function(){resolve(img);};img.onerror=reject;img.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(svg));});};var Logger=(function(){function Logger(_a){var id=_a.id,enabled=_a.enabled;this.id=id;this.enabled=enabled;this.start=Date.now();}
Logger.prototype.debug=function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}
if(this.enabled){if(typeof window!=='undefined'&&window.console&&typeof console.debug==='function'){console.debug.apply(console,__spreadArray([this.id,this.getTime()+"ms"],args));}
else{this.info.apply(this,args);}}};Logger.prototype.getTime=function(){return Date.now()-this.start;};Logger.prototype.info=function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}
if(this.enabled){if(typeof window!=='undefined'&&window.console&&typeof console.info==='function'){console.info.apply(console,__spreadArray([this.id,this.getTime()+"ms"],args));}}};Logger.prototype.warn=function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}
if(this.enabled){if(typeof window!=='undefined'&&window.console&&typeof console.warn==='function'){console.warn.apply(console,__spreadArray([this.id,this.getTime()+"ms"],args));}
else{this.info.apply(this,args);}}};Logger.prototype.error=function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}
if(this.enabled){if(typeof window!=='undefined'&&window.console&&typeof console.error==='function'){console.error.apply(console,__spreadArray([this.id,this.getTime()+"ms"],args));}
else{this.info.apply(this,args);}}};Logger.instances={};return Logger;}());var Context=(function(){function Context(options,windowBounds){var _a;this.windowBounds=windowBounds;this.instanceName="#"+Context.instanceCount++;this.logger=new Logger({id:this.instanceName,enabled:options.logging});this.cache=(_a=options.cache)!==null&&_a!==void 0?_a:new Cache(this,options);}
Context.instanceCount=1;return Context;}());var html2canvas=function(element,options){if(options===void 0){options={};}
return renderElement(element,options);};if(typeof window!=='undefined'){CacheStorage.setContext(window);}
var renderElement=function(element,opts){return __awaiter(void 0,void 0,void 0,function(){var ownerDocument,defaultView,resourceOptions,contextOptions,windowOptions,windowBounds,context,foreignObjectRendering,cloneOptions,documentCloner,clonedElement,container,_a,width,height,left,top,backgroundColor,renderOptions,canvas,renderer,root,renderer;var _b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t;return __generator(this,function(_u){switch(_u.label){case 0:if(!element||typeof element!=='object'){return[2,Promise.reject('Invalid element provided as first argument')];}
ownerDocument=element.ownerDocument;if(!ownerDocument){throw new Error("Element is not attached to a Document");}
defaultView=ownerDocument.defaultView;if(!defaultView){throw new Error("Document is not attached to a Window");}
resourceOptions={allowTaint:(_b=opts.allowTaint)!==null&&_b!==void 0?_b:false,imageTimeout:(_c=opts.imageTimeout)!==null&&_c!==void 0?_c:15000,proxy:opts.proxy,useCORS:(_d=opts.useCORS)!==null&&_d!==void 0?_d:false};contextOptions=__assign({logging:(_e=opts.logging)!==null&&_e!==void 0?_e:true,cache:opts.cache},resourceOptions);windowOptions={windowWidth:(_f=opts.windowWidth)!==null&&_f!==void 0?_f:defaultView.innerWidth,windowHeight:(_g=opts.windowHeight)!==null&&_g!==void 0?_g:defaultView.innerHeight,scrollX:(_h=opts.scrollX)!==null&&_h!==void 0?_h:defaultView.pageXOffset,scrollY:(_j=opts.scrollY)!==null&&_j!==void 0?_j:defaultView.pageYOffset};windowBounds=new Bounds(windowOptions.scrollX,windowOptions.scrollY,windowOptions.windowWidth,windowOptions.windowHeight);context=new Context(contextOptions,windowBounds);foreignObjectRendering=(_k=opts.foreignObjectRendering)!==null&&_k!==void 0?_k:false;cloneOptions={allowTaint:(_l=opts.allowTaint)!==null&&_l!==void 0?_l:false,onclone:opts.onclone,ignoreElements:opts.ignoreElements,inlineImages:foreignObjectRendering,copyStyles:foreignObjectRendering};context.logger.debug("Starting document clone with size "+windowBounds.width+"x"+windowBounds.height+" scrolled to "+-windowBounds.left+","+-windowBounds.top);documentCloner=new DocumentCloner(context,element,cloneOptions);clonedElement=documentCloner.clonedReferenceElement;if(!clonedElement){return[2,Promise.reject("Unable to find element in cloned iframe")];}
return[4,documentCloner.toIFrame(ownerDocument,windowBounds)];case 1:container=_u.sent();_a=isBodyElement(clonedElement)||isHTMLElement(clonedElement)?parseDocumentSize(clonedElement.ownerDocument):parseBounds(context,clonedElement),width=_a.width,height=_a.height,left=_a.left,top=_a.top;backgroundColor=parseBackgroundColor(context,clonedElement,opts.backgroundColor);renderOptions={canvas:opts.canvas,backgroundColor:backgroundColor,scale:(_o=(_m=opts.scale)!==null&&_m!==void 0?_m:defaultView.devicePixelRatio)!==null&&_o!==void 0?_o:1,x:((_p=opts.x)!==null&&_p!==void 0?_p:0)+left,y:((_q=opts.y)!==null&&_q!==void 0?_q:0)+top,width:(_r=opts.width)!==null&&_r!==void 0?_r:Math.ceil(width),height:(_s=opts.height)!==null&&_s!==void 0?_s:Math.ceil(height)};if(!foreignObjectRendering)return[3,3];context.logger.debug("Document cloned, using foreign object rendering");renderer=new ForeignObjectRenderer(context,renderOptions);return[4,renderer.render(clonedElement)];case 2:canvas=_u.sent();return[3,5];case 3:context.logger.debug("Document cloned, element located at "+left+","+top+" with size "+width+"x"+height+" using computed rendering");context.logger.debug("Starting DOM parsing");root=parseTree(context,clonedElement);if(backgroundColor===root.styles.backgroundColor){root.styles.backgroundColor=COLORS.TRANSPARENT;}
context.logger.debug("Starting renderer for element at "+renderOptions.x+","+renderOptions.y+" with size "+renderOptions.width+"x"+renderOptions.height);renderer=new CanvasRenderer(context,renderOptions);return[4,renderer.render(root)];case 4:canvas=_u.sent();_u.label=5;case 5:if((_t=opts.removeContainer)!==null&&_t!==void 0?_t:true){if(!DocumentCloner.destroy(container)){context.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore");}}
context.logger.debug("Finished rendering");return[2,canvas];}});});};var parseBackgroundColor=function(context,element,backgroundColorOverride){var ownerDocument=element.ownerDocument;var documentBackgroundColor=ownerDocument.documentElement?parseColor(context,getComputedStyle(ownerDocument.documentElement).backgroundColor):COLORS.TRANSPARENT;var bodyBackgroundColor=ownerDocument.body?parseColor(context,getComputedStyle(ownerDocument.body).backgroundColor):COLORS.TRANSPARENT;var defaultBackgroundColor=typeof backgroundColorOverride==='string'?parseColor(context,backgroundColorOverride):backgroundColorOverride===null?COLORS.TRANSPARENT:0xffffffff;return element===ownerDocument.documentElement?isTransparent(documentBackgroundColor)?isTransparent(bodyBackgroundColor)?defaultBackgroundColor:bodyBackgroundColor:documentBackgroundColor:defaultBackgroundColor;};return html2canvas;})));;

/* /web/static/lib/zxing-library/zxing-library.js */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(exports):typeof define==='function'&&define.amd?define(['exports'],factory):(global=typeof globalThis!=='undefined'?globalThis:global||self,factory(global.ZXing={}));}(this,(function(exports){'use strict';var extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b;})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];};function __extends(d,b){extendStatics(d,b);function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());}
function fixProto(target,prototype){var setPrototypeOf=Object.setPrototypeOf;setPrototypeOf?setPrototypeOf(target,prototype):(target.__proto__=prototype);}
function fixStack(target,fn){if(fn===void 0){fn=target.constructor;}
var captureStackTrace=Error.captureStackTrace;captureStackTrace&&captureStackTrace(target,fn);}
var CustomError=(function(_super){__extends(CustomError,_super);function CustomError(message){var _newTarget=this.constructor;var _this=_super.call(this,message)||this;Object.defineProperty(_this,'name',{value:_newTarget.name,enumerable:false});fixProto(_this,_newTarget.prototype);fixStack(_this);return _this;}
return CustomError;})(Error);class Exception extends CustomError{constructor(message=undefined){super(message);this.message=message;}
getKind(){const ex=this.constructor;return ex.kind;}}
Exception.kind='Exception';class ArgumentException extends Exception{}
ArgumentException.kind='ArgumentException';class IllegalArgumentException extends Exception{}
IllegalArgumentException.kind='IllegalArgumentException';class BinaryBitmap{constructor(binarizer){this.binarizer=binarizer;if(binarizer===null){throw new IllegalArgumentException('Binarizer must be non-null.');}}
getWidth(){return this.binarizer.getWidth();}
getHeight(){return this.binarizer.getHeight();}
getBlackRow(y,row){return this.binarizer.getBlackRow(y,row);}
getBlackMatrix(){if(this.matrix===null||this.matrix===undefined){this.matrix=this.binarizer.getBlackMatrix();}
return this.matrix;}
isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported();}
crop(left,top,width,height){const newSource=this.binarizer.getLuminanceSource().crop(left,top,width,height);return new BinaryBitmap(this.binarizer.createBinarizer(newSource));}
isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported();}
rotateCounterClockwise(){const newSource=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new BinaryBitmap(this.binarizer.createBinarizer(newSource));}
rotateCounterClockwise45(){const newSource=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new BinaryBitmap(this.binarizer.createBinarizer(newSource));}
toString(){try{return this.getBlackMatrix().toString();}
catch(e){return'';}}}
class ChecksumException extends Exception{static getChecksumInstance(){return new ChecksumException();}}
ChecksumException.kind='ChecksumException';class Binarizer{constructor(source){this.source=source;}
getLuminanceSource(){return this.source;}
getWidth(){return this.source.getWidth();}
getHeight(){return this.source.getHeight();}}
class System{static arraycopy(src,srcPos,dest,destPos,length){while(length--){dest[destPos++]=src[srcPos++];}}
static currentTimeMillis(){return Date.now();}}
class IndexOutOfBoundsException extends Exception{}
IndexOutOfBoundsException.kind='IndexOutOfBoundsException';class ArrayIndexOutOfBoundsException extends IndexOutOfBoundsException{constructor(index=undefined,message=undefined){super(message);this.index=index;this.message=message;}}
ArrayIndexOutOfBoundsException.kind='ArrayIndexOutOfBoundsException';class Arrays{static fill(a,val){for(let i=0,len=a.length;i<len;i++)
a[i]=val;}
static fillWithin(a,fromIndex,toIndex,val){Arrays.rangeCheck(a.length,fromIndex,toIndex);for(let i=fromIndex;i<toIndex;i++)
a[i]=val;}
static rangeCheck(arrayLength,fromIndex,toIndex){if(fromIndex>toIndex){throw new IllegalArgumentException('fromIndex('+fromIndex+') > toIndex('+toIndex+')');}
if(fromIndex<0){throw new ArrayIndexOutOfBoundsException(fromIndex);}
if(toIndex>arrayLength){throw new ArrayIndexOutOfBoundsException(toIndex);}}
static asList(...args){return args;}
static create(rows,cols,value){let arr=Array.from({length:rows});return arr.map(x=>Array.from({length:cols}).fill(value));}
static createInt32Array(rows,cols,value){let arr=Array.from({length:rows});return arr.map(x=>Int32Array.from({length:cols}).fill(value));}
static equals(first,second){if(!first){return false;}
if(!second){return false;}
if(!first.length){return false;}
if(!second.length){return false;}
if(first.length!==second.length){return false;}
for(let i=0,length=first.length;i<length;i++){if(first[i]!==second[i]){return false;}}
return true;}
static hashCode(a){if(a===null){return 0;}
let result=1;for(const element of a){result=31*result+element;}
return result;}
static fillUint8Array(a,value){for(let i=0;i!==a.length;i++){a[i]=value;}}
static copyOf(original,newLength){return original.slice(0,newLength);}
static copyOfUint8Array(original,newLength){if(original.length<=newLength){const newArray=new Uint8Array(newLength);newArray.set(original);return newArray;}
return original.slice(0,newLength);}
static copyOfRange(original,from,to){const newLength=to-from;const copy=new Int32Array(newLength);System.arraycopy(original,from,copy,0,newLength);return copy;}
static binarySearch(ar,el,comparator){if(undefined===comparator){comparator=Arrays.numberComparator;}
let m=0;let n=ar.length-1;while(m<=n){const k=(n+m)>>1;const cmp=comparator(el,ar[k]);if(cmp>0){m=k+1;}
else if(cmp<0){n=k-1;}
else{return k;}}
return-m-1;}
static numberComparator(a,b){return a-b;}}
class Integer{static numberOfTrailingZeros(i){let y;if(i===0)
return 32;let n=31;y=i<<16;if(y!==0){n-=16;i=y;}
y=i<<8;if(y!==0){n-=8;i=y;}
y=i<<4;if(y!==0){n-=4;i=y;}
y=i<<2;if(y!==0){n-=2;i=y;}
return n-((i<<1)>>>31);}
static numberOfLeadingZeros(i){if(i===0){return 32;}
let n=1;if(i>>>16===0){n+=16;i<<=16;}
if(i>>>24===0){n+=8;i<<=8;}
if(i>>>28===0){n+=4;i<<=4;}
if(i>>>30===0){n+=2;i<<=2;}
n-=i>>>31;return n;}
static toHexString(i){return i.toString(16);}
static toBinaryString(intNumber){return String(parseInt(String(intNumber),2));}
static bitCount(i){i=i-((i>>>1)&0x55555555);i=(i&0x33333333)+((i>>>2)&0x33333333);i=(i+(i>>>4))&0x0f0f0f0f;i=i+(i>>>8);i=i+(i>>>16);return i&0x3f;}
static truncDivision(dividend,divisor){return Math.trunc(dividend/divisor);}
static parseInt(num,radix=undefined){return parseInt(num,radix);}}
Integer.MIN_VALUE_32_BITS=-2147483648;Integer.MAX_VALUE=Number.MAX_SAFE_INTEGER;class BitArray{constructor(size,bits){if(undefined===size){this.size=0;this.bits=new Int32Array(1);}
else{this.size=size;if(undefined===bits||null===bits){this.bits=BitArray.makeArray(size);}
else{this.bits=bits;}}}
getSize(){return this.size;}
getSizeInBytes(){return Math.floor((this.size+7)/8);}
ensureCapacity(size){if(size>this.bits.length*32){const newBits=BitArray.makeArray(size);System.arraycopy(this.bits,0,newBits,0,this.bits.length);this.bits=newBits;}}
get(i){return(this.bits[Math.floor(i/32)]&(1<<(i&0x1F)))!==0;}
set(i){this.bits[Math.floor(i/32)]|=1<<(i&0x1F);}
flip(i){this.bits[Math.floor(i/32)]^=1<<(i&0x1F);}
getNextSet(from){const size=this.size;if(from>=size){return size;}
const bits=this.bits;let bitsOffset=Math.floor(from/32);let currentBits=bits[bitsOffset];currentBits&=~((1<<(from&0x1F))-1);const length=bits.length;while(currentBits===0){if(++bitsOffset===length){return size;}
currentBits=bits[bitsOffset];}
const result=(bitsOffset*32)+Integer.numberOfTrailingZeros(currentBits);return result>size?size:result;}
getNextUnset(from){const size=this.size;if(from>=size){return size;}
const bits=this.bits;let bitsOffset=Math.floor(from/32);let currentBits=~bits[bitsOffset];currentBits&=~((1<<(from&0x1F))-1);const length=bits.length;while(currentBits===0){if(++bitsOffset===length){return size;}
currentBits=~bits[bitsOffset];}
const result=(bitsOffset*32)+Integer.numberOfTrailingZeros(currentBits);return result>size?size:result;}
setBulk(i,newBits){this.bits[Math.floor(i/32)]=newBits;}
setRange(start,end){if(end<start||start<0||end>this.size){throw new IllegalArgumentException();}
if(end===start){return;}
end--;const firstInt=Math.floor(start/32);const lastInt=Math.floor(end/32);const bits=this.bits;for(let i=firstInt;i<=lastInt;i++){const firstBit=i>firstInt?0:start&0x1F;const lastBit=i<lastInt?31:end&0x1F;const mask=(2<<lastBit)-(1<<firstBit);bits[i]|=mask;}}
clear(){const max=this.bits.length;const bits=this.bits;for(let i=0;i<max;i++){bits[i]=0;}}
isRange(start,end,value){if(end<start||start<0||end>this.size){throw new IllegalArgumentException();}
if(end===start){return true;}
end--;const firstInt=Math.floor(start/32);const lastInt=Math.floor(end/32);const bits=this.bits;for(let i=firstInt;i<=lastInt;i++){const firstBit=i>firstInt?0:start&0x1F;const lastBit=i<lastInt?31:end&0x1F;const mask=(2<<lastBit)-(1<<firstBit)&0xFFFFFFFF;if((bits[i]&mask)!==(value?mask:0)){return false;}}
return true;}
appendBit(bit){this.ensureCapacity(this.size+1);if(bit){this.bits[Math.floor(this.size/32)]|=1<<(this.size&0x1F);}
this.size++;}
appendBits(value,numBits){if(numBits<0||numBits>32){throw new IllegalArgumentException('Num bits must be between 0 and 32');}
this.ensureCapacity(this.size+numBits);for(let numBitsLeft=numBits;numBitsLeft>0;numBitsLeft--){this.appendBit(((value>>(numBitsLeft-1))&0x01)===1);}}
appendBitArray(other){const otherSize=other.size;this.ensureCapacity(this.size+otherSize);for(let i=0;i<otherSize;i++){this.appendBit(other.get(i));}}
xor(other){if(this.size!==other.size){throw new IllegalArgumentException('Sizes don\'t match');}
const bits=this.bits;for(let i=0,length=bits.length;i<length;i++){bits[i]^=other.bits[i];}}
toBytes(bitOffset,array,offset,numBytes){for(let i=0;i<numBytes;i++){let theByte=0;for(let j=0;j<8;j++){if(this.get(bitOffset)){theByte|=1<<(7-j);}
bitOffset++;}
array[offset+i]=theByte;}}
getBitArray(){return this.bits;}
reverse(){const newBits=new Int32Array(this.bits.length);const len=Math.floor((this.size-1)/32);const oldBitsLen=len+1;const bits=this.bits;for(let i=0;i<oldBitsLen;i++){let x=bits[i];x=((x>>1)&0x55555555)|((x&0x55555555)<<1);x=((x>>2)&0x33333333)|((x&0x33333333)<<2);x=((x>>4)&0x0f0f0f0f)|((x&0x0f0f0f0f)<<4);x=((x>>8)&0x00ff00ff)|((x&0x00ff00ff)<<8);x=((x>>16)&0x0000ffff)|((x&0x0000ffff)<<16);newBits[len-i]=x;}
if(this.size!==oldBitsLen*32){const leftOffset=oldBitsLen*32-this.size;let currentInt=newBits[0]>>>leftOffset;for(let i=1;i<oldBitsLen;i++){const nextInt=newBits[i];currentInt|=nextInt<<(32-leftOffset);newBits[i-1]=currentInt;currentInt=nextInt>>>leftOffset;}
newBits[oldBitsLen-1]=currentInt;}
this.bits=newBits;}
static makeArray(size){return new Int32Array(Math.floor((size+31)/32));}
equals(o){if(!(o instanceof BitArray)){return false;}
const other=o;return this.size===other.size&&Arrays.equals(this.bits,other.bits);}
hashCode(){return 31*this.size+Arrays.hashCode(this.bits);}
toString(){let result='';for(let i=0,size=this.size;i<size;i++){if((i&0x07)===0){result+=' ';}
result+=this.get(i)?'X':'.';}
return result;}
clone(){return new BitArray(this.size,this.bits.slice());}}
var DecodeHintType;(function(DecodeHintType){DecodeHintType[DecodeHintType["OTHER"]=0]="OTHER";DecodeHintType[DecodeHintType["PURE_BARCODE"]=1]="PURE_BARCODE";DecodeHintType[DecodeHintType["POSSIBLE_FORMATS"]=2]="POSSIBLE_FORMATS";DecodeHintType[DecodeHintType["TRY_HARDER"]=3]="TRY_HARDER";DecodeHintType[DecodeHintType["CHARACTER_SET"]=4]="CHARACTER_SET";DecodeHintType[DecodeHintType["ALLOWED_LENGTHS"]=5]="ALLOWED_LENGTHS";DecodeHintType[DecodeHintType["ASSUME_CODE_39_CHECK_DIGIT"]=6]="ASSUME_CODE_39_CHECK_DIGIT";DecodeHintType[DecodeHintType["ASSUME_GS1"]=7]="ASSUME_GS1";DecodeHintType[DecodeHintType["RETURN_CODABAR_START_END"]=8]="RETURN_CODABAR_START_END";DecodeHintType[DecodeHintType["NEED_RESULT_POINT_CALLBACK"]=9]="NEED_RESULT_POINT_CALLBACK";DecodeHintType[DecodeHintType["ALLOWED_EAN_EXTENSIONS"]=10]="ALLOWED_EAN_EXTENSIONS";})(DecodeHintType||(DecodeHintType={}));var DecodeHintType$1=DecodeHintType;class FormatException extends Exception{static getFormatInstance(){return new FormatException();}}
FormatException.kind='FormatException';var CharacterSetValueIdentifiers;(function(CharacterSetValueIdentifiers){CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["Cp437"]=0]="Cp437";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_1"]=1]="ISO8859_1";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_2"]=2]="ISO8859_2";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_3"]=3]="ISO8859_3";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_4"]=4]="ISO8859_4";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_5"]=5]="ISO8859_5";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_6"]=6]="ISO8859_6";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_7"]=7]="ISO8859_7";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_8"]=8]="ISO8859_8";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_9"]=9]="ISO8859_9";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_10"]=10]="ISO8859_10";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_11"]=11]="ISO8859_11";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_13"]=12]="ISO8859_13";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_14"]=13]="ISO8859_14";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_15"]=14]="ISO8859_15";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ISO8859_16"]=15]="ISO8859_16";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["SJIS"]=16]="SJIS";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["Cp1250"]=17]="Cp1250";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["Cp1251"]=18]="Cp1251";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["Cp1252"]=19]="Cp1252";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["Cp1256"]=20]="Cp1256";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["UnicodeBigUnmarked"]=21]="UnicodeBigUnmarked";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["UTF8"]=22]="UTF8";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["ASCII"]=23]="ASCII";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["Big5"]=24]="Big5";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["GB18030"]=25]="GB18030";CharacterSetValueIdentifiers[CharacterSetValueIdentifiers["EUC_KR"]=26]="EUC_KR";})(CharacterSetValueIdentifiers||(CharacterSetValueIdentifiers={}));class CharacterSetECI{constructor(valueIdentifier,valuesParam,name,...otherEncodingNames){this.valueIdentifier=valueIdentifier;this.name=name;if(typeof valuesParam==='number'){this.values=Int32Array.from([valuesParam]);}
else{this.values=valuesParam;}
this.otherEncodingNames=otherEncodingNames;CharacterSetECI.VALUE_IDENTIFIER_TO_ECI.set(valueIdentifier,this);CharacterSetECI.NAME_TO_ECI.set(name,this);const values=this.values;for(let i=0,length=values.length;i!==length;i++){const v=values[i];CharacterSetECI.VALUES_TO_ECI.set(v,this);}
for(const otherName of otherEncodingNames){CharacterSetECI.NAME_TO_ECI.set(otherName,this);}}
getValueIdentifier(){return this.valueIdentifier;}
getName(){return this.name;}
getValue(){return this.values[0];}
static getCharacterSetECIByValue(value){if(value<0||value>=900){throw new FormatException('incorect value');}
const characterSet=CharacterSetECI.VALUES_TO_ECI.get(value);if(undefined===characterSet){throw new FormatException('incorect value');}
return characterSet;}
static getCharacterSetECIByName(name){const characterSet=CharacterSetECI.NAME_TO_ECI.get(name);if(undefined===characterSet){throw new FormatException('incorect value');}
return characterSet;}
equals(o){if(!(o instanceof CharacterSetECI)){return false;}
const other=o;return this.getName()===other.getName();}}
CharacterSetECI.VALUE_IDENTIFIER_TO_ECI=new Map();CharacterSetECI.VALUES_TO_ECI=new Map();CharacterSetECI.NAME_TO_ECI=new Map();CharacterSetECI.Cp437=new CharacterSetECI(CharacterSetValueIdentifiers.Cp437,Int32Array.from([0,2]),'Cp437');CharacterSetECI.ISO8859_1=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_1,Int32Array.from([1,3]),'ISO-8859-1','ISO88591','ISO8859_1');CharacterSetECI.ISO8859_2=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_2,4,'ISO-8859-2','ISO88592','ISO8859_2');CharacterSetECI.ISO8859_3=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_3,5,'ISO-8859-3','ISO88593','ISO8859_3');CharacterSetECI.ISO8859_4=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_4,6,'ISO-8859-4','ISO88594','ISO8859_4');CharacterSetECI.ISO8859_5=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_5,7,'ISO-8859-5','ISO88595','ISO8859_5');CharacterSetECI.ISO8859_6=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_6,8,'ISO-8859-6','ISO88596','ISO8859_6');CharacterSetECI.ISO8859_7=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_7,9,'ISO-8859-7','ISO88597','ISO8859_7');CharacterSetECI.ISO8859_8=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_8,10,'ISO-8859-8','ISO88598','ISO8859_8');CharacterSetECI.ISO8859_9=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_9,11,'ISO-8859-9','ISO88599','ISO8859_9');CharacterSetECI.ISO8859_10=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_10,12,'ISO-8859-10','ISO885910','ISO8859_10');CharacterSetECI.ISO8859_11=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_11,13,'ISO-8859-11','ISO885911','ISO8859_11');CharacterSetECI.ISO8859_13=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_13,15,'ISO-8859-13','ISO885913','ISO8859_13');CharacterSetECI.ISO8859_14=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_14,16,'ISO-8859-14','ISO885914','ISO8859_14');CharacterSetECI.ISO8859_15=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_15,17,'ISO-8859-15','ISO885915','ISO8859_15');CharacterSetECI.ISO8859_16=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_16,18,'ISO-8859-16','ISO885916','ISO8859_16');CharacterSetECI.SJIS=new CharacterSetECI(CharacterSetValueIdentifiers.SJIS,20,'SJIS','Shift_JIS');CharacterSetECI.Cp1250=new CharacterSetECI(CharacterSetValueIdentifiers.Cp1250,21,'Cp1250','windows-1250');CharacterSetECI.Cp1251=new CharacterSetECI(CharacterSetValueIdentifiers.Cp1251,22,'Cp1251','windows-1251');CharacterSetECI.Cp1252=new CharacterSetECI(CharacterSetValueIdentifiers.Cp1252,23,'Cp1252','windows-1252');CharacterSetECI.Cp1256=new CharacterSetECI(CharacterSetValueIdentifiers.Cp1256,24,'Cp1256','windows-1256');CharacterSetECI.UnicodeBigUnmarked=new CharacterSetECI(CharacterSetValueIdentifiers.UnicodeBigUnmarked,25,'UnicodeBigUnmarked','UTF-16BE','UnicodeBig');CharacterSetECI.UTF8=new CharacterSetECI(CharacterSetValueIdentifiers.UTF8,26,'UTF8','UTF-8');CharacterSetECI.ASCII=new CharacterSetECI(CharacterSetValueIdentifiers.ASCII,Int32Array.from([27,170]),'ASCII','US-ASCII');CharacterSetECI.Big5=new CharacterSetECI(CharacterSetValueIdentifiers.Big5,28,'Big5');CharacterSetECI.GB18030=new CharacterSetECI(CharacterSetValueIdentifiers.GB18030,29,'GB18030','GB2312','EUC_CN','GBK');CharacterSetECI.EUC_KR=new CharacterSetECI(CharacterSetValueIdentifiers.EUC_KR,30,'EUC_KR','EUC-KR');class UnsupportedOperationException extends Exception{}
UnsupportedOperationException.kind='UnsupportedOperationException';class StringEncoding{static decode(bytes,encoding){const encodingName=this.encodingName(encoding);if(this.customDecoder){return this.customDecoder(bytes,encodingName);}
if(typeof TextDecoder==='undefined'||this.shouldDecodeOnFallback(encodingName)){return this.decodeFallback(bytes,encodingName);}
return new TextDecoder(encodingName).decode(bytes);}
static shouldDecodeOnFallback(encodingName){return!StringEncoding.isBrowser()&&encodingName==='ISO-8859-1';}
static encode(s,encoding){const encodingName=this.encodingName(encoding);if(this.customEncoder){return this.customEncoder(s,encodingName);}
if(typeof TextEncoder==='undefined'){return this.encodeFallback(s);}
return new TextEncoder().encode(s);}
static isBrowser(){return(typeof window!=='undefined'&&{}.toString.call(window)==='[object Window]');}
static encodingName(encoding){return typeof encoding==='string'?encoding:encoding.getName();}
static encodingCharacterSet(encoding){if(encoding instanceof CharacterSetECI){return encoding;}
return CharacterSetECI.getCharacterSetECIByName(encoding);}
static decodeFallback(bytes,encoding){const characterSet=this.encodingCharacterSet(encoding);if(StringEncoding.isDecodeFallbackSupported(characterSet)){let s='';for(let i=0,length=bytes.length;i<length;i++){let h=bytes[i].toString(16);if(h.length<2){h='0'+h;}
s+='%'+h;}
return decodeURIComponent(s);}
if(characterSet.equals(CharacterSetECI.UnicodeBigUnmarked)){return String.fromCharCode.apply(null,new Uint16Array(bytes.buffer));}
throw new UnsupportedOperationException(`Encoding ${this.encodingName(encoding)} not supported by fallback.`);}
static isDecodeFallbackSupported(characterSet){return characterSet.equals(CharacterSetECI.UTF8)||characterSet.equals(CharacterSetECI.ISO8859_1)||characterSet.equals(CharacterSetECI.ASCII);}
static encodeFallback(s){const encodedURIstring=btoa(unescape(encodeURIComponent(s)));const charList=encodedURIstring.split('');const uintArray=[];for(let i=0;i<charList.length;i++){uintArray.push(charList[i].charCodeAt(0));}
return new Uint8Array(uintArray);}}
class StringUtils{static castAsNonUtf8Char(code,encoding=null){const e=encoding?encoding.getName():this.ISO88591;return StringEncoding.decode(new Uint8Array([code]),e);}
static guessEncoding(bytes,hints){if(hints!==null&&hints!==undefined&&undefined!==hints.get(DecodeHintType$1.CHARACTER_SET)){return hints.get(DecodeHintType$1.CHARACTER_SET).toString();}
const length=bytes.length;let canBeISO88591=true;let canBeShiftJIS=true;let canBeUTF8=true;let utf8BytesLeft=0;let utf2BytesChars=0;let utf3BytesChars=0;let utf4BytesChars=0;let sjisBytesLeft=0;let sjisKatakanaChars=0;let sjisCurKatakanaWordLength=0;let sjisCurDoubleBytesWordLength=0;let sjisMaxKatakanaWordLength=0;let sjisMaxDoubleBytesWordLength=0;let isoHighOther=0;const utf8bom=bytes.length>3&&bytes[0]===0xEF&&bytes[1]===0xBB&&bytes[2]===0xBF;for(let i=0;i<length&&(canBeISO88591||canBeShiftJIS||canBeUTF8);i++){const value=bytes[i]&0xFF;if(canBeUTF8){if(utf8BytesLeft>0){if((value&0x80)===0){canBeUTF8=false;}
else{utf8BytesLeft--;}}
else if((value&0x80)!==0){if((value&0x40)===0){canBeUTF8=false;}
else{utf8BytesLeft++;if((value&0x20)===0){utf2BytesChars++;}
else{utf8BytesLeft++;if((value&0x10)===0){utf3BytesChars++;}
else{utf8BytesLeft++;if((value&0x08)===0){utf4BytesChars++;}
else{canBeUTF8=false;}}}}}}
if(canBeISO88591){if(value>0x7F&&value<0xA0){canBeISO88591=false;}
else if(value>0x9F){if(value<0xC0||value===0xD7||value===0xF7){isoHighOther++;}}}
if(canBeShiftJIS){if(sjisBytesLeft>0){if(value<0x40||value===0x7F||value>0xFC){canBeShiftJIS=false;}
else{sjisBytesLeft--;}}
else if(value===0x80||value===0xA0||value>0xEF){canBeShiftJIS=false;}
else if(value>0xA0&&value<0xE0){sjisKatakanaChars++;sjisCurDoubleBytesWordLength=0;sjisCurKatakanaWordLength++;if(sjisCurKatakanaWordLength>sjisMaxKatakanaWordLength){sjisMaxKatakanaWordLength=sjisCurKatakanaWordLength;}}
else if(value>0x7F){sjisBytesLeft++;sjisCurKatakanaWordLength=0;sjisCurDoubleBytesWordLength++;if(sjisCurDoubleBytesWordLength>sjisMaxDoubleBytesWordLength){sjisMaxDoubleBytesWordLength=sjisCurDoubleBytesWordLength;}}
else{sjisCurKatakanaWordLength=0;sjisCurDoubleBytesWordLength=0;}}}
if(canBeUTF8&&utf8BytesLeft>0){canBeUTF8=false;}
if(canBeShiftJIS&&sjisBytesLeft>0){canBeShiftJIS=false;}
if(canBeUTF8&&(utf8bom||utf2BytesChars+utf3BytesChars+utf4BytesChars>0)){return StringUtils.UTF8;}
if(canBeShiftJIS&&(StringUtils.ASSUME_SHIFT_JIS||sjisMaxKatakanaWordLength>=3||sjisMaxDoubleBytesWordLength>=3)){return StringUtils.SHIFT_JIS;}
if(canBeISO88591&&canBeShiftJIS){return(sjisMaxKatakanaWordLength===2&&sjisKatakanaChars===2)||isoHighOther*10>=length?StringUtils.SHIFT_JIS:StringUtils.ISO88591;}
if(canBeISO88591){return StringUtils.ISO88591;}
if(canBeShiftJIS){return StringUtils.SHIFT_JIS;}
if(canBeUTF8){return StringUtils.UTF8;}
return StringUtils.PLATFORM_DEFAULT_ENCODING;}
static format(append,...args){let i=-1;function callback(exp,p0,p1,p2,p3,p4){if(exp==='%%')
return'%';if(args[++i]===undefined)
return undefined;exp=p2?parseInt(p2.substr(1)):undefined;let base=p3?parseInt(p3.substr(1)):undefined;let val;switch(p4){case's':val=args[i];break;case'c':val=args[i][0];break;case'f':val=parseFloat(args[i]).toFixed(exp);break;case'p':val=parseFloat(args[i]).toPrecision(exp);break;case'e':val=parseFloat(args[i]).toExponential(exp);break;case'x':val=parseInt(args[i]).toString(base?base:16);break;case'd':val=parseFloat(parseInt(args[i],base?base:10).toPrecision(exp)).toFixed(0);break;}
val=typeof val==='object'?JSON.stringify(val):(+val).toString(base);let size=parseInt(p1);let ch=p1&&(p1[0]+'')==='0'?'0':' ';while(val.length<size)
val=p0!==undefined?val+ch:ch+val;return val;}
let regex=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return append.replace(regex,callback);}
static getBytes(str,encoding){return StringEncoding.encode(str,encoding);}
static getCharCode(str,index=0){return str.charCodeAt(index);}
static getCharAt(charCode){return String.fromCharCode(charCode);}}
StringUtils.SHIFT_JIS=CharacterSetECI.SJIS.getName();StringUtils.GB2312='GB2312';StringUtils.ISO88591=CharacterSetECI.ISO8859_1.getName();StringUtils.EUC_JP='EUC_JP';StringUtils.UTF8=CharacterSetECI.UTF8.getName();StringUtils.PLATFORM_DEFAULT_ENCODING=StringUtils.UTF8;StringUtils.ASSUME_SHIFT_JIS=false;class StringBuilder{constructor(value=''){this.value=value;}
enableDecoding(encoding){this.encoding=encoding;return this;}
append(s){if(typeof s==='string'){this.value+=s.toString();}
else if(this.encoding){this.value+=StringUtils.castAsNonUtf8Char(s,this.encoding);}
else{this.value+=String.fromCharCode(s);}
return this;}
appendChars(str,offset,len){for(let i=offset;offset<offset+len;i++){this.append(str[i]);}
return this;}
length(){return this.value.length;}
charAt(n){return this.value.charAt(n);}
deleteCharAt(n){this.value=this.value.substr(0,n)+this.value.substring(n+1);}
setCharAt(n,c){this.value=this.value.substr(0,n)+c+this.value.substr(n+1);}
substring(start,end){return this.value.substring(start,end);}
setLengthToZero(){this.value='';}
toString(){return this.value;}
insert(n,c){this.value=this.value.substr(0,n)+c+this.value.substr(n+c.length);}}
class BitMatrix{constructor(width,height,rowSize,bits){this.width=width;this.height=height;this.rowSize=rowSize;this.bits=bits;if(undefined===height||null===height){height=width;}
this.height=height;if(width<1||height<1){throw new IllegalArgumentException('Both dimensions must be greater than 0');}
if(undefined===rowSize||null===rowSize){rowSize=Math.floor((width+31)/32);}
this.rowSize=rowSize;if(undefined===bits||null===bits){this.bits=new Int32Array(this.rowSize*this.height);}}
static parseFromBooleanArray(image){const height=image.length;const width=image[0].length;const bits=new BitMatrix(width,height);for(let i=0;i<height;i++){const imageI=image[i];for(let j=0;j<width;j++){if(imageI[j]){bits.set(j,i);}}}
return bits;}
static parseFromString(stringRepresentation,setString,unsetString){if(stringRepresentation===null){throw new IllegalArgumentException('stringRepresentation cannot be null');}
const bits=new Array(stringRepresentation.length);let bitsPos=0;let rowStartPos=0;let rowLength=-1;let nRows=0;let pos=0;while(pos<stringRepresentation.length){if(stringRepresentation.charAt(pos)==='\n'||stringRepresentation.charAt(pos)==='\r'){if(bitsPos>rowStartPos){if(rowLength===-1){rowLength=bitsPos-rowStartPos;}
else if(bitsPos-rowStartPos!==rowLength){throw new IllegalArgumentException('row lengths do not match');}
rowStartPos=bitsPos;nRows++;}
pos++;}
else if(stringRepresentation.substring(pos,pos+setString.length)===setString){pos+=setString.length;bits[bitsPos]=true;bitsPos++;}
else if(stringRepresentation.substring(pos,pos+unsetString.length)===unsetString){pos+=unsetString.length;bits[bitsPos]=false;bitsPos++;}
else{throw new IllegalArgumentException('illegal character encountered: '+stringRepresentation.substring(pos));}}
if(bitsPos>rowStartPos){if(rowLength===-1){rowLength=bitsPos-rowStartPos;}
else if(bitsPos-rowStartPos!==rowLength){throw new IllegalArgumentException('row lengths do not match');}
nRows++;}
const matrix=new BitMatrix(rowLength,nRows);for(let i=0;i<bitsPos;i++){if(bits[i]){matrix.set(Math.floor(i%rowLength),Math.floor(i/rowLength));}}
return matrix;}
get(x,y){const offset=y*this.rowSize+Math.floor(x/32);return((this.bits[offset]>>>(x&0x1f))&1)!==0;}
set(x,y){const offset=y*this.rowSize+Math.floor(x/32);this.bits[offset]|=(1<<(x&0x1f))&0xFFFFFFFF;}
unset(x,y){const offset=y*this.rowSize+Math.floor(x/32);this.bits[offset]&=~((1<<(x&0x1f))&0xFFFFFFFF);}
flip(x,y){const offset=y*this.rowSize+Math.floor(x/32);this.bits[offset]^=((1<<(x&0x1f))&0xFFFFFFFF);}
xor(mask){if(this.width!==mask.getWidth()||this.height!==mask.getHeight()||this.rowSize!==mask.getRowSize()){throw new IllegalArgumentException('input matrix dimensions do not match');}
const rowArray=new BitArray(Math.floor(this.width/32)+1);const rowSize=this.rowSize;const bits=this.bits;for(let y=0,height=this.height;y<height;y++){const offset=y*rowSize;const row=mask.getRow(y,rowArray).getBitArray();for(let x=0;x<rowSize;x++){bits[offset+x]^=row[x];}}}
clear(){const bits=this.bits;const max=bits.length;for(let i=0;i<max;i++){bits[i]=0;}}
setRegion(left,top,width,height){if(top<0||left<0){throw new IllegalArgumentException('Left and top must be nonnegative');}
if(height<1||width<1){throw new IllegalArgumentException('Height and width must be at least 1');}
const right=left+width;const bottom=top+height;if(bottom>this.height||right>this.width){throw new IllegalArgumentException('The region must fit inside the matrix');}
const rowSize=this.rowSize;const bits=this.bits;for(let y=top;y<bottom;y++){const offset=y*rowSize;for(let x=left;x<right;x++){bits[offset+Math.floor(x/32)]|=((1<<(x&0x1f))&0xFFFFFFFF);}}}
getRow(y,row){if(row===null||row===undefined||row.getSize()<this.width){row=new BitArray(this.width);}
else{row.clear();}
const rowSize=this.rowSize;const bits=this.bits;const offset=y*rowSize;for(let x=0;x<rowSize;x++){row.setBulk(x*32,bits[offset+x]);}
return row;}
setRow(y,row){System.arraycopy(row.getBitArray(),0,this.bits,y*this.rowSize,this.rowSize);}
rotate180(){const width=this.getWidth();const height=this.getHeight();let topRow=new BitArray(width);let bottomRow=new BitArray(width);for(let i=0,length=Math.floor((height+1)/2);i<length;i++){topRow=this.getRow(i,topRow);bottomRow=this.getRow(height-1-i,bottomRow);topRow.reverse();bottomRow.reverse();this.setRow(i,bottomRow);this.setRow(height-1-i,topRow);}}
getEnclosingRectangle(){const width=this.width;const height=this.height;const rowSize=this.rowSize;const bits=this.bits;let left=width;let top=height;let right=-1;let bottom=-1;for(let y=0;y<height;y++){for(let x32=0;x32<rowSize;x32++){const theBits=bits[y*rowSize+x32];if(theBits!==0){if(y<top){top=y;}
if(y>bottom){bottom=y;}
if(x32*32<left){let bit=0;while(((theBits<<(31-bit))&0xFFFFFFFF)===0){bit++;}
if((x32*32+bit)<left){left=x32*32+bit;}}
if(x32*32+31>right){let bit=31;while((theBits>>>bit)===0){bit--;}
if((x32*32+bit)>right){right=x32*32+bit;}}}}}
if(right<left||bottom<top){return null;}
return Int32Array.from([left,top,right-left+1,bottom-top+1]);}
getTopLeftOnBit(){const rowSize=this.rowSize;const bits=this.bits;let bitsOffset=0;while(bitsOffset<bits.length&&bits[bitsOffset]===0){bitsOffset++;}
if(bitsOffset===bits.length){return null;}
const y=bitsOffset/rowSize;let x=(bitsOffset%rowSize)*32;const theBits=bits[bitsOffset];let bit=0;while(((theBits<<(31-bit))&0xFFFFFFFF)===0){bit++;}
x+=bit;return Int32Array.from([x,y]);}
getBottomRightOnBit(){const rowSize=this.rowSize;const bits=this.bits;let bitsOffset=bits.length-1;while(bitsOffset>=0&&bits[bitsOffset]===0){bitsOffset--;}
if(bitsOffset<0){return null;}
const y=Math.floor(bitsOffset/rowSize);let x=Math.floor(bitsOffset%rowSize)*32;const theBits=bits[bitsOffset];let bit=31;while((theBits>>>bit)===0){bit--;}
x+=bit;return Int32Array.from([x,y]);}
getWidth(){return this.width;}
getHeight(){return this.height;}
getRowSize(){return this.rowSize;}
equals(o){if(!(o instanceof BitMatrix)){return false;}
const other=o;return this.width===other.width&&this.height===other.height&&this.rowSize===other.rowSize&&Arrays.equals(this.bits,other.bits);}
hashCode(){let hash=this.width;hash=31*hash+this.width;hash=31*hash+this.height;hash=31*hash+this.rowSize;hash=31*hash+Arrays.hashCode(this.bits);return hash;}
toString(setString='X ',unsetString='  ',lineSeparator='\n'){return this.buildToString(setString,unsetString,lineSeparator);}
buildToString(setString,unsetString,lineSeparator){let result=new StringBuilder();for(let y=0,height=this.height;y<height;y++){for(let x=0,width=this.width;x<width;x++){result.append(this.get(x,y)?setString:unsetString);}
result.append(lineSeparator);}
return result.toString();}
clone(){return new BitMatrix(this.width,this.height,this.rowSize,this.bits.slice());}}
class NotFoundException extends Exception{static getNotFoundInstance(){return new NotFoundException();}}
NotFoundException.kind='NotFoundException';class GlobalHistogramBinarizer extends Binarizer{constructor(source){super(source);this.luminances=GlobalHistogramBinarizer.EMPTY;this.buckets=new Int32Array(GlobalHistogramBinarizer.LUMINANCE_BUCKETS);}
getBlackRow(y,row){const source=this.getLuminanceSource();const width=source.getWidth();if(row===undefined||row===null||row.getSize()<width){row=new BitArray(width);}
else{row.clear();}
this.initArrays(width);const localLuminances=source.getRow(y,this.luminances);const localBuckets=this.buckets;for(let x=0;x<width;x++){localBuckets[(localLuminances[x]&0xff)>>GlobalHistogramBinarizer.LUMINANCE_SHIFT]++;}
const blackPoint=GlobalHistogramBinarizer.estimateBlackPoint(localBuckets);if(width<3){for(let x=0;x<width;x++){if((localLuminances[x]&0xff)<blackPoint){row.set(x);}}}
else{let left=localLuminances[0]&0xff;let center=localLuminances[1]&0xff;for(let x=1;x<width-1;x++){const right=localLuminances[x+1]&0xff;if(((center*4)-left-right)/2<blackPoint){row.set(x);}
left=center;center=right;}}
return row;}
getBlackMatrix(){const source=this.getLuminanceSource();const width=source.getWidth();const height=source.getHeight();const matrix=new BitMatrix(width,height);this.initArrays(width);const localBuckets=this.buckets;for(let y=1;y<5;y++){const row=Math.floor((height*y)/5);const localLuminances=source.getRow(row,this.luminances);const right=Math.floor((width*4)/5);for(let x=Math.floor(width/5);x<right;x++){const pixel=localLuminances[x]&0xff;localBuckets[pixel>>GlobalHistogramBinarizer.LUMINANCE_SHIFT]++;}}
const blackPoint=GlobalHistogramBinarizer.estimateBlackPoint(localBuckets);const localLuminances=source.getMatrix();for(let y=0;y<height;y++){const offset=y*width;for(let x=0;x<width;x++){const pixel=localLuminances[offset+x]&0xff;if(pixel<blackPoint){matrix.set(x,y);}}}
return matrix;}
createBinarizer(source){return new GlobalHistogramBinarizer(source);}
initArrays(luminanceSize){if(this.luminances.length<luminanceSize){this.luminances=new Uint8ClampedArray(luminanceSize);}
const buckets=this.buckets;for(let x=0;x<GlobalHistogramBinarizer.LUMINANCE_BUCKETS;x++){buckets[x]=0;}}
static estimateBlackPoint(buckets){const numBuckets=buckets.length;let maxBucketCount=0;let firstPeak=0;let firstPeakSize=0;for(let x=0;x<numBuckets;x++){if(buckets[x]>firstPeakSize){firstPeak=x;firstPeakSize=buckets[x];}
if(buckets[x]>maxBucketCount){maxBucketCount=buckets[x];}}
let secondPeak=0;let secondPeakScore=0;for(let x=0;x<numBuckets;x++){const distanceToBiggest=x-firstPeak;const score=buckets[x]*distanceToBiggest*distanceToBiggest;if(score>secondPeakScore){secondPeak=x;secondPeakScore=score;}}
if(firstPeak>secondPeak){const temp=firstPeak;firstPeak=secondPeak;secondPeak=temp;}
if(secondPeak-firstPeak<=numBuckets/16){throw new NotFoundException();}
let bestValley=secondPeak-1;let bestValleyScore=-1;for(let x=secondPeak-1;x>firstPeak;x--){const fromFirst=x-firstPeak;const score=fromFirst*fromFirst*(secondPeak-x)*(maxBucketCount-buckets[x]);if(score>bestValleyScore){bestValley=x;bestValleyScore=score;}}
return bestValley<<GlobalHistogramBinarizer.LUMINANCE_SHIFT;}}
GlobalHistogramBinarizer.LUMINANCE_BITS=5;GlobalHistogramBinarizer.LUMINANCE_SHIFT=8-GlobalHistogramBinarizer.LUMINANCE_BITS;GlobalHistogramBinarizer.LUMINANCE_BUCKETS=1<<GlobalHistogramBinarizer.LUMINANCE_BITS;GlobalHistogramBinarizer.EMPTY=Uint8ClampedArray.from([0]);class HybridBinarizer extends GlobalHistogramBinarizer{constructor(source){super(source);this.matrix=null;}
getBlackMatrix(){if(this.matrix!==null){return this.matrix;}
const source=this.getLuminanceSource();const width=source.getWidth();const height=source.getHeight();if(width>=HybridBinarizer.MINIMUM_DIMENSION&&height>=HybridBinarizer.MINIMUM_DIMENSION){const luminances=source.getMatrix();let subWidth=width>>HybridBinarizer.BLOCK_SIZE_POWER;if((width&HybridBinarizer.BLOCK_SIZE_MASK)!==0){subWidth++;}
let subHeight=height>>HybridBinarizer.BLOCK_SIZE_POWER;if((height&HybridBinarizer.BLOCK_SIZE_MASK)!==0){subHeight++;}
const blackPoints=HybridBinarizer.calculateBlackPoints(luminances,subWidth,subHeight,width,height);const newMatrix=new BitMatrix(width,height);HybridBinarizer.calculateThresholdForBlock(luminances,subWidth,subHeight,width,height,blackPoints,newMatrix);this.matrix=newMatrix;}
else{this.matrix=super.getBlackMatrix();}
return this.matrix;}
createBinarizer(source){return new HybridBinarizer(source);}
static calculateThresholdForBlock(luminances,subWidth,subHeight,width,height,blackPoints,matrix){const maxYOffset=height-HybridBinarizer.BLOCK_SIZE;const maxXOffset=width-HybridBinarizer.BLOCK_SIZE;for(let y=0;y<subHeight;y++){let yoffset=y<<HybridBinarizer.BLOCK_SIZE_POWER;if(yoffset>maxYOffset){yoffset=maxYOffset;}
const top=HybridBinarizer.cap(y,2,subHeight-3);for(let x=0;x<subWidth;x++){let xoffset=x<<HybridBinarizer.BLOCK_SIZE_POWER;if(xoffset>maxXOffset){xoffset=maxXOffset;}
const left=HybridBinarizer.cap(x,2,subWidth-3);let sum=0;for(let z=-2;z<=2;z++){const blackRow=blackPoints[top+z];sum+=blackRow[left-2]+blackRow[left-1]+blackRow[left]+blackRow[left+1]+blackRow[left+2];}
const average=sum/25;HybridBinarizer.thresholdBlock(luminances,xoffset,yoffset,average,width,matrix);}}}
static cap(value,min,max){return value<min?min:value>max?max:value;}
static thresholdBlock(luminances,xoffset,yoffset,threshold,stride,matrix){for(let y=0,offset=yoffset*stride+xoffset;y<HybridBinarizer.BLOCK_SIZE;y++,offset+=stride){for(let x=0;x<HybridBinarizer.BLOCK_SIZE;x++){if((luminances[offset+x]&0xFF)<=threshold){matrix.set(xoffset+x,yoffset+y);}}}}
static calculateBlackPoints(luminances,subWidth,subHeight,width,height){const maxYOffset=height-HybridBinarizer.BLOCK_SIZE;const maxXOffset=width-HybridBinarizer.BLOCK_SIZE;const blackPoints=new Array(subHeight);for(let y=0;y<subHeight;y++){blackPoints[y]=new Int32Array(subWidth);let yoffset=y<<HybridBinarizer.BLOCK_SIZE_POWER;if(yoffset>maxYOffset){yoffset=maxYOffset;}
for(let x=0;x<subWidth;x++){let xoffset=x<<HybridBinarizer.BLOCK_SIZE_POWER;if(xoffset>maxXOffset){xoffset=maxXOffset;}
let sum=0;let min=0xFF;let max=0;for(let yy=0,offset=yoffset*width+xoffset;yy<HybridBinarizer.BLOCK_SIZE;yy++,offset+=width){for(let xx=0;xx<HybridBinarizer.BLOCK_SIZE;xx++){const pixel=luminances[offset+xx]&0xFF;sum+=pixel;if(pixel<min){min=pixel;}
if(pixel>max){max=pixel;}}
if(max-min>HybridBinarizer.MIN_DYNAMIC_RANGE){for(yy++,offset+=width;yy<HybridBinarizer.BLOCK_SIZE;yy++,offset+=width){for(let xx=0;xx<HybridBinarizer.BLOCK_SIZE;xx++){sum+=luminances[offset+xx]&0xFF;}}}}
let average=sum>>(HybridBinarizer.BLOCK_SIZE_POWER*2);if(max-min<=HybridBinarizer.MIN_DYNAMIC_RANGE){average=min/2;if(y>0&&x>0){const averageNeighborBlackPoint=(blackPoints[y-1][x]+(2*blackPoints[y][x-1])+blackPoints[y-1][x-1])/4;if(min<averageNeighborBlackPoint){average=averageNeighborBlackPoint;}}}
blackPoints[y][x]=average;}}
return blackPoints;}}
HybridBinarizer.BLOCK_SIZE_POWER=3;HybridBinarizer.BLOCK_SIZE=1<<HybridBinarizer.BLOCK_SIZE_POWER;HybridBinarizer.BLOCK_SIZE_MASK=HybridBinarizer.BLOCK_SIZE-1;HybridBinarizer.MINIMUM_DIMENSION=HybridBinarizer.BLOCK_SIZE*5;HybridBinarizer.MIN_DYNAMIC_RANGE=24;class LuminanceSource{constructor(width,height){this.width=width;this.height=height;}
getWidth(){return this.width;}
getHeight(){return this.height;}
isCropSupported(){return false;}
crop(left,top,width,height){throw new UnsupportedOperationException('This luminance source does not support cropping.');}
isRotateSupported(){return false;}
rotateCounterClockwise(){throw new UnsupportedOperationException('This luminance source does not support rotation by 90 degrees.');}
rotateCounterClockwise45(){throw new UnsupportedOperationException('This luminance source does not support rotation by 45 degrees.');}
toString(){const row=new Uint8ClampedArray(this.width);let result=new StringBuilder();for(let y=0;y<this.height;y++){const sourceRow=this.getRow(y,row);for(let x=0;x<this.width;x++){const luminance=sourceRow[x]&0xFF;let c;if(luminance<0x40){c='#';}
else if(luminance<0x80){c='+';}
else if(luminance<0xC0){c='.';}
else{c=' ';}
result.append(c);}
result.append('\n');}
return result.toString();}}
class InvertedLuminanceSource extends LuminanceSource{constructor(delegate){super(delegate.getWidth(),delegate.getHeight());this.delegate=delegate;}
getRow(y,row){const sourceRow=this.delegate.getRow(y,row);const width=this.getWidth();for(let i=0;i<width;i++){sourceRow[i]=(255-(sourceRow[i]&0xFF));}
return sourceRow;}
getMatrix(){const matrix=this.delegate.getMatrix();const length=this.getWidth()*this.getHeight();const invertedMatrix=new Uint8ClampedArray(length);for(let i=0;i<length;i++){invertedMatrix[i]=(255-(matrix[i]&0xFF));}
return invertedMatrix;}
isCropSupported(){return this.delegate.isCropSupported();}
crop(left,top,width,height){return new InvertedLuminanceSource(this.delegate.crop(left,top,width,height));}
isRotateSupported(){return this.delegate.isRotateSupported();}
invert(){return this.delegate;}
rotateCounterClockwise(){return new InvertedLuminanceSource(this.delegate.rotateCounterClockwise());}
rotateCounterClockwise45(){return new InvertedLuminanceSource(this.delegate.rotateCounterClockwise45());}}
class HTMLCanvasElementLuminanceSource extends LuminanceSource{constructor(canvas){super(canvas.width,canvas.height);this.canvas=canvas;this.tempCanvasElement=null;this.buffer=HTMLCanvasElementLuminanceSource.makeBufferFromCanvasImageData(canvas);}
static makeBufferFromCanvasImageData(canvas){const imageData=canvas.getContext('2d').getImageData(0,0,canvas.width,canvas.height);return HTMLCanvasElementLuminanceSource.toGrayscaleBuffer(imageData.data,canvas.width,canvas.height);}
static toGrayscaleBuffer(imageBuffer,width,height){const grayscaleBuffer=new Uint8ClampedArray(width*height);for(let i=0,j=0,length=imageBuffer.length;i<length;i+=4,j++){let gray;const alpha=imageBuffer[i+3];if(alpha===0){gray=0xFF;}
else{const pixelR=imageBuffer[i];const pixelG=imageBuffer[i+1];const pixelB=imageBuffer[i+2];gray=(306*pixelR+
601*pixelG+
117*pixelB+
0x200)>>10;}
grayscaleBuffer[j]=gray;}
return grayscaleBuffer;}
getRow(y,row){if(y<0||y>=this.getHeight()){throw new IllegalArgumentException('Requested row is outside the image: '+y);}
const width=this.getWidth();const start=y*width;if(row===null){row=this.buffer.slice(start,start+width);}
else{if(row.length<width){row=new Uint8ClampedArray(width);}
row.set(this.buffer.slice(start,start+width));}
return row;}
getMatrix(){return this.buffer;}
isCropSupported(){return true;}
crop(left,top,width,height){super.crop(left,top,width,height);return this;}
isRotateSupported(){return true;}
rotateCounterClockwise(){this.rotate(-90);return this;}
rotateCounterClockwise45(){this.rotate(-45);return this;}
getTempCanvasElement(){if(null===this.tempCanvasElement){const tempCanvasElement=this.canvas.ownerDocument.createElement('canvas');tempCanvasElement.width=this.canvas.width;tempCanvasElement.height=this.canvas.height;this.tempCanvasElement=tempCanvasElement;}
return this.tempCanvasElement;}
rotate(angle){const tempCanvasElement=this.getTempCanvasElement();const tempContext=tempCanvasElement.getContext('2d');const angleRadians=angle*HTMLCanvasElementLuminanceSource.DEGREE_TO_RADIANS;const width=this.canvas.width;const height=this.canvas.height;const newWidth=Math.ceil(Math.abs(Math.cos(angleRadians))*width+Math.abs(Math.sin(angleRadians))*height);const newHeight=Math.ceil(Math.abs(Math.sin(angleRadians))*width+Math.abs(Math.cos(angleRadians))*height);tempCanvasElement.width=newWidth;tempCanvasElement.height=newHeight;tempContext.translate(newWidth/2,newHeight/2);tempContext.rotate(angleRadians);tempContext.drawImage(this.canvas,width/-2,height/-2);this.buffer=HTMLCanvasElementLuminanceSource.makeBufferFromCanvasImageData(tempCanvasElement);return this;}
invert(){return new InvertedLuminanceSource(this);}}
HTMLCanvasElementLuminanceSource.DEGREE_TO_RADIANS=Math.PI/180;class VideoInputDevice{constructor(deviceId,label,groupId){this.deviceId=deviceId;this.label=label;this.kind='videoinput';this.groupId=groupId||undefined;}
toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label,};}}
var __awaiter=((globalThis||global||self||window||undefined)&&(globalThis||global||self||window||undefined).__awaiter)||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value);});}
return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value));}catch(e){reject(e);}}
function rejected(value){try{step(generator["throw"](value));}catch(e){reject(e);}}
function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected);}
step((generator=generator.apply(thisArg,_arguments||[])).next());});};class BrowserCodeReader{constructor(reader,timeBetweenScansMillis=500,_hints){this.reader=reader;this.timeBetweenScansMillis=timeBetweenScansMillis;this._hints=_hints;this._stopContinuousDecode=false;this._stopAsyncDecode=false;this._timeBetweenDecodingAttempts=0;}
get hasNavigator(){return typeof navigator!=='undefined';}
get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices;}
get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices);}
get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts;}
set timeBetweenDecodingAttempts(millis){this._timeBetweenDecodingAttempts=millis<0?0:millis;}
set hints(hints){this._hints=hints||null;}
get hints(){return this._hints;}
listVideoInputDevices(){return __awaiter(this,void 0,void 0,function*(){if(!this.hasNavigator){throw new Error('Can\'t enumerate devices, navigator is not present.');}
if(!this.canEnumerateDevices){throw new Error('Can\'t enumerate devices, method not supported.');}
const devices=yield navigator.mediaDevices.enumerateDevices();const videoDevices=[];for(const device of devices){const kind=device.kind==='video'?'videoinput':device.kind;if(kind!=='videoinput'){continue;}
const deviceId=device.deviceId||device.id;const label=device.label||`Video device ${videoDevices.length + 1}`;const groupId=device.groupId;const videoDevice={deviceId,label,kind,groupId};videoDevices.push(videoDevice);}
return videoDevices;});}
getVideoInputDevices(){return __awaiter(this,void 0,void 0,function*(){const devices=yield this.listVideoInputDevices();return devices.map(d=>new VideoInputDevice(d.deviceId,d.label));});}
findDeviceById(deviceId){return __awaiter(this,void 0,void 0,function*(){const devices=yield this.listVideoInputDevices();if(!devices){return null;}
return devices.find(x=>x.deviceId===deviceId);});}
decodeFromInputVideoDevice(deviceId,videoSource){return __awaiter(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(deviceId,videoSource);});}
decodeOnceFromVideoDevice(deviceId,videoSource){return __awaiter(this,void 0,void 0,function*(){this.reset();let videoConstraints;if(!deviceId){videoConstraints={facingMode:'environment'};}
else{videoConstraints={deviceId:{exact:deviceId}};}
const constraints={video:videoConstraints};return yield this.decodeOnceFromConstraints(constraints,videoSource);});}
decodeOnceFromConstraints(constraints,videoSource){return __awaiter(this,void 0,void 0,function*(){const stream=yield navigator.mediaDevices.getUserMedia(constraints);return yield this.decodeOnceFromStream(stream,videoSource);});}
decodeOnceFromStream(stream,videoSource){return __awaiter(this,void 0,void 0,function*(){this.reset();const video=yield this.attachStreamToVideo(stream,videoSource);const result=yield this.decodeOnce(video);return result;});}
decodeFromInputVideoDeviceContinuously(deviceId,videoSource,callbackFn){return __awaiter(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(deviceId,videoSource,callbackFn);});}
decodeFromVideoDevice(deviceId,videoSource,callbackFn){return __awaiter(this,void 0,void 0,function*(){let videoConstraints;if(!deviceId){videoConstraints={facingMode:'environment'};}
else{videoConstraints={deviceId:{exact:deviceId}};}
const constraints={video:videoConstraints};return yield this.decodeFromConstraints(constraints,videoSource,callbackFn);});}
decodeFromConstraints(constraints,videoSource,callbackFn){return __awaiter(this,void 0,void 0,function*(){const stream=yield navigator.mediaDevices.getUserMedia(constraints);return yield this.decodeFromStream(stream,videoSource,callbackFn);});}
decodeFromStream(stream,videoSource,callbackFn){return __awaiter(this,void 0,void 0,function*(){this.reset();const video=yield this.attachStreamToVideo(stream,videoSource);return yield this.decodeContinuously(video,callbackFn);});}
stopAsyncDecode(){this._stopAsyncDecode=true;}
stopContinuousDecode(){this._stopContinuousDecode=true;}
attachStreamToVideo(stream,videoSource){return __awaiter(this,void 0,void 0,function*(){const videoElement=this.prepareVideoElement(videoSource);this.addVideoSource(videoElement,stream);this.videoElement=videoElement;this.stream=stream;yield this.playVideoOnLoadAsync(videoElement);return videoElement;});}
playVideoOnLoadAsync(videoElement){return new Promise((resolve,reject)=>this.playVideoOnLoad(videoElement,()=>resolve()));}
playVideoOnLoad(element,callbackFn){this.videoEndedListener=()=>this.stopStreams();this.videoCanPlayListener=()=>this.tryPlayVideo(element);element.addEventListener('ended',this.videoEndedListener);element.addEventListener('canplay',this.videoCanPlayListener);element.addEventListener('playing',callbackFn);this.tryPlayVideo(element);}
isVideoPlaying(video){return video.currentTime>0&&!video.paused&&!video.ended&&video.readyState>2;}
tryPlayVideo(videoElement){return __awaiter(this,void 0,void 0,function*(){if(this.isVideoPlaying(videoElement)){console.warn('Trying to play video that is already playing.');return;}
try{yield videoElement.play();}
catch(_a){console.warn('It was not possible to play the video.');}});}
getMediaElement(mediaElementId,type){const mediaElement=document.getElementById(mediaElementId);if(!mediaElement){throw new ArgumentException(`element with id '${mediaElementId}' not found`);}
if(mediaElement.nodeName.toLowerCase()!==type.toLowerCase()){throw new ArgumentException(`element with id '${mediaElementId}' must be an ${type} element`);}
return mediaElement;}
decodeFromImage(source,url){if(!source&&!url){throw new ArgumentException('either imageElement with a src set or an url must be provided');}
if(url&&!source){return this.decodeFromImageUrl(url);}
return this.decodeFromImageElement(source);}
decodeFromVideo(source,url){if(!source&&!url){throw new ArgumentException('Either an element with a src set or an URL must be provided');}
if(url&&!source){return this.decodeFromVideoUrl(url);}
return this.decodeFromVideoElement(source);}
decodeFromVideoContinuously(source,url,callbackFn){if(undefined===source&&undefined===url){throw new ArgumentException('Either an element with a src set or an URL must be provided');}
if(url&&!source){return this.decodeFromVideoUrlContinuously(url,callbackFn);}
return this.decodeFromVideoElementContinuously(source,callbackFn);}
decodeFromImageElement(source){if(!source){throw new ArgumentException('An image element must be provided.');}
this.reset();const element=this.prepareImageElement(source);this.imageElement=element;let task;if(this.isImageLoaded(element)){task=this.decodeOnce(element,false,true);}
else{task=this._decodeOnLoadImage(element);}
return task;}
decodeFromVideoElement(source){const element=this._decodeFromVideoElementSetup(source);return this._decodeOnLoadVideo(element);}
decodeFromVideoElementContinuously(source,callbackFn){const element=this._decodeFromVideoElementSetup(source);return this._decodeOnLoadVideoContinuously(element,callbackFn);}
_decodeFromVideoElementSetup(source){if(!source){throw new ArgumentException('A video element must be provided.');}
this.reset();const element=this.prepareVideoElement(source);this.videoElement=element;return element;}
decodeFromImageUrl(url){if(!url){throw new ArgumentException('An URL must be provided.');}
this.reset();const element=this.prepareImageElement();this.imageElement=element;const decodeTask=this._decodeOnLoadImage(element);element.src=url;return decodeTask;}
decodeFromVideoUrl(url){if(!url){throw new ArgumentException('An URL must be provided.');}
this.reset();const element=this.prepareVideoElement();const decodeTask=this.decodeFromVideoElement(element);element.src=url;return decodeTask;}
decodeFromVideoUrlContinuously(url,callbackFn){if(!url){throw new ArgumentException('An URL must be provided.');}
this.reset();const element=this.prepareVideoElement();const decodeTask=this.decodeFromVideoElementContinuously(element,callbackFn);element.src=url;return decodeTask;}
_decodeOnLoadImage(element){return new Promise((resolve,reject)=>{this.imageLoadedListener=()=>this.decodeOnce(element,false,true).then(resolve,reject);element.addEventListener('load',this.imageLoadedListener);});}
_decodeOnLoadVideo(videoElement){return __awaiter(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(videoElement);return yield this.decodeOnce(videoElement);});}
_decodeOnLoadVideoContinuously(videoElement,callbackFn){return __awaiter(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(videoElement);this.decodeContinuously(videoElement,callbackFn);});}
isImageLoaded(img){if(!img.complete){return false;}
if(img.naturalWidth===0){return false;}
return true;}
prepareImageElement(imageSource){let imageElement;if(typeof imageSource==='undefined'){imageElement=document.createElement('img');imageElement.width=200;imageElement.height=200;}
if(typeof imageSource==='string'){imageElement=this.getMediaElement(imageSource,'img');}
if(imageSource instanceof HTMLImageElement){imageElement=imageSource;}
return imageElement;}
prepareVideoElement(videoSource){let videoElement;if(!videoSource&&typeof document!=='undefined'){videoElement=document.createElement('video');videoElement.width=200;videoElement.height=200;}
if(typeof videoSource==='string'){videoElement=this.getMediaElement(videoSource,'video');}
if(videoSource instanceof HTMLVideoElement){videoElement=videoSource;}
videoElement.setAttribute('autoplay','true');videoElement.setAttribute('muted','true');videoElement.setAttribute('playsinline','true');return videoElement;}
decodeOnce(element,retryIfNotFound=true,retryIfChecksumOrFormatError=true){this._stopAsyncDecode=false;const loop=(resolve,reject)=>{if(this._stopAsyncDecode){reject(new NotFoundException('Video stream has ended before any code could be detected.'));this._stopAsyncDecode=undefined;return;}
try{const result=this.decode(element);resolve(result);}
catch(e){const ifNotFound=retryIfNotFound&&e instanceof NotFoundException;const isChecksumOrFormatError=e instanceof ChecksumException||e instanceof FormatException;const ifChecksumOrFormat=isChecksumOrFormatError&&retryIfChecksumOrFormatError;if(ifNotFound||ifChecksumOrFormat){return setTimeout(loop,this._timeBetweenDecodingAttempts,resolve,reject);}
reject(e);}};return new Promise((resolve,reject)=>loop(resolve,reject));}
decodeContinuously(element,callbackFn){this._stopContinuousDecode=false;const loop=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=undefined;return;}
try{const result=this.decode(element);callbackFn(result,null);setTimeout(loop,this.timeBetweenScansMillis);}
catch(e){callbackFn(null,e);const isChecksumOrFormatError=e instanceof ChecksumException||e instanceof FormatException;const isNotFound=e instanceof NotFoundException;if(isChecksumOrFormatError||isNotFound){setTimeout(loop,this._timeBetweenDecodingAttempts);}}};loop();}
decode(element){const binaryBitmap=this.createBinaryBitmap(element);return this.decodeBitmap(binaryBitmap);}
_isHTMLVideoElement(mediaElement){const potentialVideo=mediaElement;return potentialVideo.videoWidth!==0;}
createBinaryBitmap(mediaElement){const ctx=this.getCaptureCanvasContext(mediaElement);if(this._isHTMLVideoElement(mediaElement)){this.drawFrameOnCanvas(mediaElement);}
else{this.drawImageOnCanvas(mediaElement);}
const canvas=this.getCaptureCanvas(mediaElement);const luminanceSource=new HTMLCanvasElementLuminanceSource(canvas);const hybridBinarizer=new HybridBinarizer(luminanceSource);return new BinaryBitmap(hybridBinarizer);}
getCaptureCanvasContext(mediaElement){if(!this.captureCanvasContext){const elem=this.getCaptureCanvas(mediaElement);const ctx=elem.getContext('2d');this.captureCanvasContext=ctx;}
return this.captureCanvasContext;}
getCaptureCanvas(mediaElement){if(!this.captureCanvas){const elem=this.createCaptureCanvas(mediaElement);this.captureCanvas=elem;}
return this.captureCanvas;}
drawFrameOnCanvas(srcElement,dimensions={sx:0,sy:0,sWidth:srcElement.videoWidth,sHeight:srcElement.videoHeight,dx:0,dy:0,dWidth:srcElement.videoWidth,dHeight:srcElement.videoHeight},canvasElementContext=this.captureCanvasContext){canvasElementContext.drawImage(srcElement,dimensions.sx,dimensions.sy,dimensions.sWidth,dimensions.sHeight,dimensions.dx,dimensions.dy,dimensions.dWidth,dimensions.dHeight);}
drawImageOnCanvas(srcElement,dimensions={sx:0,sy:0,sWidth:srcElement.naturalWidth,sHeight:srcElement.naturalHeight,dx:0,dy:0,dWidth:srcElement.naturalWidth,dHeight:srcElement.naturalHeight},canvasElementContext=this.captureCanvasContext){canvasElementContext.drawImage(srcElement,dimensions.sx,dimensions.sy,dimensions.sWidth,dimensions.sHeight,dimensions.dx,dimensions.dy,dimensions.dWidth,dimensions.dHeight);}
decodeBitmap(binaryBitmap){return this.reader.decode(binaryBitmap,this._hints);}
createCaptureCanvas(mediaElement){if(typeof document==='undefined'){this._destroyCaptureCanvas();return null;}
const canvasElement=document.createElement('canvas');let width;let height;if(typeof mediaElement!=='undefined'){if(mediaElement instanceof HTMLVideoElement){width=mediaElement.videoWidth;height=mediaElement.videoHeight;}
else if(mediaElement instanceof HTMLImageElement){width=mediaElement.naturalWidth||mediaElement.width;height=mediaElement.naturalHeight||mediaElement.height;}}
canvasElement.style.width=width+'px';canvasElement.style.height=height+'px';canvasElement.width=width;canvasElement.height=height;return canvasElement;}
stopStreams(){if(this.stream){this.stream.getVideoTracks().forEach(t=>t.stop());this.stream=undefined;}
if(this._stopAsyncDecode===false){this.stopAsyncDecode();}
if(this._stopContinuousDecode===false){this.stopContinuousDecode();}}
reset(){this.stopStreams();this._destroyVideoElement();this._destroyImageElement();this._destroyCaptureCanvas();}
_destroyVideoElement(){if(!this.videoElement){return;}
if(typeof this.videoEndedListener!=='undefined'){this.videoElement.removeEventListener('ended',this.videoEndedListener);}
if(typeof this.videoPlayingEventListener!=='undefined'){this.videoElement.removeEventListener('playing',this.videoPlayingEventListener);}
if(typeof this.videoCanPlayListener!=='undefined'){this.videoElement.removeEventListener('loadedmetadata',this.videoCanPlayListener);}
this.cleanVideoSource(this.videoElement);this.videoElement=undefined;}
_destroyImageElement(){if(!this.imageElement){return;}
if(undefined!==this.imageLoadedListener){this.imageElement.removeEventListener('load',this.imageLoadedListener);}
this.imageElement.src=undefined;this.imageElement.removeAttribute('src');this.imageElement=undefined;}
_destroyCaptureCanvas(){this.captureCanvasContext=undefined;this.captureCanvas=undefined;}
addVideoSource(videoElement,stream){try{videoElement.srcObject=stream;}
catch(err){videoElement.src=URL.createObjectURL(stream);}}
cleanVideoSource(videoElement){try{videoElement.srcObject=null;}
catch(err){videoElement.src='';}
this.videoElement.removeAttribute('src');}}
class Result{constructor(text,rawBytes,numBits=rawBytes==null?0:8*rawBytes.length,resultPoints,format,timestamp=System.currentTimeMillis()){this.text=text;this.rawBytes=rawBytes;this.numBits=numBits;this.resultPoints=resultPoints;this.format=format;this.timestamp=timestamp;this.text=text;this.rawBytes=rawBytes;if(undefined===numBits||null===numBits){this.numBits=(rawBytes===null||rawBytes===undefined)?0:8*rawBytes.length;}
else{this.numBits=numBits;}
this.resultPoints=resultPoints;this.format=format;this.resultMetadata=null;if(undefined===timestamp||null===timestamp){this.timestamp=System.currentTimeMillis();}
else{this.timestamp=timestamp;}}
getText(){return this.text;}
getRawBytes(){return this.rawBytes;}
getNumBits(){return this.numBits;}
getResultPoints(){return this.resultPoints;}
getBarcodeFormat(){return this.format;}
getResultMetadata(){return this.resultMetadata;}
putMetadata(type,value){if(this.resultMetadata===null){this.resultMetadata=new Map();}
this.resultMetadata.set(type,value);}
putAllMetadata(metadata){if(metadata!==null){if(this.resultMetadata===null){this.resultMetadata=metadata;}
else{this.resultMetadata=new Map(metadata);}}}
addResultPoints(newPoints){const oldPoints=this.resultPoints;if(oldPoints===null){this.resultPoints=newPoints;}
else if(newPoints!==null&&newPoints.length>0){const allPoints=new Array(oldPoints.length+newPoints.length);System.arraycopy(oldPoints,0,allPoints,0,oldPoints.length);System.arraycopy(newPoints,0,allPoints,oldPoints.length,newPoints.length);this.resultPoints=allPoints;}}
getTimestamp(){return this.timestamp;}
toString(){return this.text;}}
var BarcodeFormat;(function(BarcodeFormat){BarcodeFormat[BarcodeFormat["AZTEC"]=0]="AZTEC";BarcodeFormat[BarcodeFormat["CODABAR"]=1]="CODABAR";BarcodeFormat[BarcodeFormat["CODE_39"]=2]="CODE_39";BarcodeFormat[BarcodeFormat["CODE_93"]=3]="CODE_93";BarcodeFormat[BarcodeFormat["CODE_128"]=4]="CODE_128";BarcodeFormat[BarcodeFormat["DATA_MATRIX"]=5]="DATA_MATRIX";BarcodeFormat[BarcodeFormat["EAN_8"]=6]="EAN_8";BarcodeFormat[BarcodeFormat["EAN_13"]=7]="EAN_13";BarcodeFormat[BarcodeFormat["ITF"]=8]="ITF";BarcodeFormat[BarcodeFormat["MAXICODE"]=9]="MAXICODE";BarcodeFormat[BarcodeFormat["PDF_417"]=10]="PDF_417";BarcodeFormat[BarcodeFormat["QR_CODE"]=11]="QR_CODE";BarcodeFormat[BarcodeFormat["RSS_14"]=12]="RSS_14";BarcodeFormat[BarcodeFormat["RSS_EXPANDED"]=13]="RSS_EXPANDED";BarcodeFormat[BarcodeFormat["UPC_A"]=14]="UPC_A";BarcodeFormat[BarcodeFormat["UPC_E"]=15]="UPC_E";BarcodeFormat[BarcodeFormat["UPC_EAN_EXTENSION"]=16]="UPC_EAN_EXTENSION";})(BarcodeFormat||(BarcodeFormat={}));var BarcodeFormat$1=BarcodeFormat;var ResultMetadataType;(function(ResultMetadataType){ResultMetadataType[ResultMetadataType["OTHER"]=0]="OTHER";ResultMetadataType[ResultMetadataType["ORIENTATION"]=1]="ORIENTATION";ResultMetadataType[ResultMetadataType["BYTE_SEGMENTS"]=2]="BYTE_SEGMENTS";ResultMetadataType[ResultMetadataType["ERROR_CORRECTION_LEVEL"]=3]="ERROR_CORRECTION_LEVEL";ResultMetadataType[ResultMetadataType["ISSUE_NUMBER"]=4]="ISSUE_NUMBER";ResultMetadataType[ResultMetadataType["SUGGESTED_PRICE"]=5]="SUGGESTED_PRICE";ResultMetadataType[ResultMetadataType["POSSIBLE_COUNTRY"]=6]="POSSIBLE_COUNTRY";ResultMetadataType[ResultMetadataType["UPC_EAN_EXTENSION"]=7]="UPC_EAN_EXTENSION";ResultMetadataType[ResultMetadataType["PDF417_EXTRA_METADATA"]=8]="PDF417_EXTRA_METADATA";ResultMetadataType[ResultMetadataType["STRUCTURED_APPEND_SEQUENCE"]=9]="STRUCTURED_APPEND_SEQUENCE";ResultMetadataType[ResultMetadataType["STRUCTURED_APPEND_PARITY"]=10]="STRUCTURED_APPEND_PARITY";})(ResultMetadataType||(ResultMetadataType={}));var ResultMetadataType$1=ResultMetadataType;class DecoderResult{constructor(rawBytes,text,byteSegments,ecLevel,structuredAppendSequenceNumber=-1,structuredAppendParity=-1){this.rawBytes=rawBytes;this.text=text;this.byteSegments=byteSegments;this.ecLevel=ecLevel;this.structuredAppendSequenceNumber=structuredAppendSequenceNumber;this.structuredAppendParity=structuredAppendParity;this.numBits=(rawBytes===undefined||rawBytes===null)?0:8*rawBytes.length;}
getRawBytes(){return this.rawBytes;}
getNumBits(){return this.numBits;}
setNumBits(numBits){this.numBits=numBits;}
getText(){return this.text;}
getByteSegments(){return this.byteSegments;}
getECLevel(){return this.ecLevel;}
getErrorsCorrected(){return this.errorsCorrected;}
setErrorsCorrected(errorsCorrected){this.errorsCorrected=errorsCorrected;}
getErasures(){return this.erasures;}
setErasures(erasures){this.erasures=erasures;}
getOther(){return this.other;}
setOther(other){this.other=other;}
hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0;}
getStructuredAppendParity(){return this.structuredAppendParity;}
getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber;}}
class AbstractGenericGF{exp(a){return this.expTable[a];}
log(a){if(a===0){throw new IllegalArgumentException();}
return this.logTable[a];}
static addOrSubtract(a,b){return a^b;}}
class GenericGFPoly{constructor(field,coefficients){if(coefficients.length===0){throw new IllegalArgumentException();}
this.field=field;const coefficientsLength=coefficients.length;if(coefficientsLength>1&&coefficients[0]===0){let firstNonZero=1;while(firstNonZero<coefficientsLength&&coefficients[firstNonZero]===0){firstNonZero++;}
if(firstNonZero===coefficientsLength){this.coefficients=Int32Array.from([0]);}
else{this.coefficients=new Int32Array(coefficientsLength-firstNonZero);System.arraycopy(coefficients,firstNonZero,this.coefficients,0,this.coefficients.length);}}
else{this.coefficients=coefficients;}}
getCoefficients(){return this.coefficients;}
getDegree(){return this.coefficients.length-1;}
isZero(){return this.coefficients[0]===0;}
getCoefficient(degree){return this.coefficients[this.coefficients.length-1-degree];}
evaluateAt(a){if(a===0){return this.getCoefficient(0);}
const coefficients=this.coefficients;let result;if(a===1){result=0;for(let i=0,length=coefficients.length;i!==length;i++){const coefficient=coefficients[i];result=AbstractGenericGF.addOrSubtract(result,coefficient);}
return result;}
result=coefficients[0];const size=coefficients.length;const field=this.field;for(let i=1;i<size;i++){result=AbstractGenericGF.addOrSubtract(field.multiply(a,result),coefficients[i]);}
return result;}
addOrSubtract(other){if(!this.field.equals(other.field)){throw new IllegalArgumentException('GenericGFPolys do not have same GenericGF field');}
if(this.isZero()){return other;}
if(other.isZero()){return this;}
let smallerCoefficients=this.coefficients;let largerCoefficients=other.coefficients;if(smallerCoefficients.length>largerCoefficients.length){const temp=smallerCoefficients;smallerCoefficients=largerCoefficients;largerCoefficients=temp;}
let sumDiff=new Int32Array(largerCoefficients.length);const lengthDiff=largerCoefficients.length-smallerCoefficients.length;System.arraycopy(largerCoefficients,0,sumDiff,0,lengthDiff);for(let i=lengthDiff;i<largerCoefficients.length;i++){sumDiff[i]=AbstractGenericGF.addOrSubtract(smallerCoefficients[i-lengthDiff],largerCoefficients[i]);}
return new GenericGFPoly(this.field,sumDiff);}
multiply(other){if(!this.field.equals(other.field)){throw new IllegalArgumentException('GenericGFPolys do not have same GenericGF field');}
if(this.isZero()||other.isZero()){return this.field.getZero();}
const aCoefficients=this.coefficients;const aLength=aCoefficients.length;const bCoefficients=other.coefficients;const bLength=bCoefficients.length;const product=new Int32Array(aLength+bLength-1);const field=this.field;for(let i=0;i<aLength;i++){const aCoeff=aCoefficients[i];for(let j=0;j<bLength;j++){product[i+j]=AbstractGenericGF.addOrSubtract(product[i+j],field.multiply(aCoeff,bCoefficients[j]));}}
return new GenericGFPoly(field,product);}
multiplyScalar(scalar){if(scalar===0){return this.field.getZero();}
if(scalar===1){return this;}
const size=this.coefficients.length;const field=this.field;const product=new Int32Array(size);const coefficients=this.coefficients;for(let i=0;i<size;i++){product[i]=field.multiply(coefficients[i],scalar);}
return new GenericGFPoly(field,product);}
multiplyByMonomial(degree,coefficient){if(degree<0){throw new IllegalArgumentException();}
if(coefficient===0){return this.field.getZero();}
const coefficients=this.coefficients;const size=coefficients.length;const product=new Int32Array(size+degree);const field=this.field;for(let i=0;i<size;i++){product[i]=field.multiply(coefficients[i],coefficient);}
return new GenericGFPoly(field,product);}
divide(other){if(!this.field.equals(other.field)){throw new IllegalArgumentException('GenericGFPolys do not have same GenericGF field');}
if(other.isZero()){throw new IllegalArgumentException('Divide by 0');}
const field=this.field;let quotient=field.getZero();let remainder=this;const denominatorLeadingTerm=other.getCoefficient(other.getDegree());const inverseDenominatorLeadingTerm=field.inverse(denominatorLeadingTerm);while(remainder.getDegree()>=other.getDegree()&&!remainder.isZero()){const degreeDifference=remainder.getDegree()-other.getDegree();const scale=field.multiply(remainder.getCoefficient(remainder.getDegree()),inverseDenominatorLeadingTerm);const term=other.multiplyByMonomial(degreeDifference,scale);const iterationQuotient=field.buildMonomial(degreeDifference,scale);quotient=quotient.addOrSubtract(iterationQuotient);remainder=remainder.addOrSubtract(term);}
return[quotient,remainder];}
toString(){let result='';for(let degree=this.getDegree();degree>=0;degree--){let coefficient=this.getCoefficient(degree);if(coefficient!==0){if(coefficient<0){result+=' - ';coefficient=-coefficient;}
else{if(result.length>0){result+=' + ';}}
if(degree===0||coefficient!==1){const alphaPower=this.field.log(coefficient);if(alphaPower===0){result+='1';}
else if(alphaPower===1){result+='a';}
else{result+='a^';result+=alphaPower;}}
if(degree!==0){if(degree===1){result+='x';}
else{result+='x^';result+=degree;}}}}
return result;}}
class ArithmeticException extends Exception{}
ArithmeticException.kind='ArithmeticException';class GenericGF extends AbstractGenericGF{constructor(primitive,size,generatorBase){super();this.primitive=primitive;this.size=size;this.generatorBase=generatorBase;const expTable=new Int32Array(size);let x=1;for(let i=0;i<size;i++){expTable[i]=x;x*=2;if(x>=size){x^=primitive;x&=size-1;}}
this.expTable=expTable;const logTable=new Int32Array(size);for(let i=0;i<size-1;i++){logTable[expTable[i]]=i;}
this.logTable=logTable;this.zero=new GenericGFPoly(this,Int32Array.from([0]));this.one=new GenericGFPoly(this,Int32Array.from([1]));}
getZero(){return this.zero;}
getOne(){return this.one;}
buildMonomial(degree,coefficient){if(degree<0){throw new IllegalArgumentException();}
if(coefficient===0){return this.zero;}
const coefficients=new Int32Array(degree+1);coefficients[0]=coefficient;return new GenericGFPoly(this,coefficients);}
inverse(a){if(a===0){throw new ArithmeticException();}
return this.expTable[this.size-this.logTable[a]-1];}
multiply(a,b){if(a===0||b===0){return 0;}
return this.expTable[(this.logTable[a]+this.logTable[b])%(this.size-1)];}
getSize(){return this.size;}
getGeneratorBase(){return this.generatorBase;}
toString(){return('GF(0x'+Integer.toHexString(this.primitive)+','+this.size+')');}
equals(o){return o===this;}}
GenericGF.AZTEC_DATA_12=new GenericGF(0x1069,4096,1);GenericGF.AZTEC_DATA_10=new GenericGF(0x409,1024,1);GenericGF.AZTEC_DATA_6=new GenericGF(0x43,64,1);GenericGF.AZTEC_PARAM=new GenericGF(0x13,16,1);GenericGF.QR_CODE_FIELD_256=new GenericGF(0x011d,256,0);GenericGF.DATA_MATRIX_FIELD_256=new GenericGF(0x012d,256,1);GenericGF.AZTEC_DATA_8=GenericGF.DATA_MATRIX_FIELD_256;GenericGF.MAXICODE_FIELD_64=GenericGF.AZTEC_DATA_6;class ReedSolomonException extends Exception{}
ReedSolomonException.kind='ReedSolomonException';class IllegalStateException extends Exception{}
IllegalStateException.kind='IllegalStateException';class ReedSolomonDecoder{constructor(field){this.field=field;}
decode(received,twoS){const field=this.field;const poly=new GenericGFPoly(field,received);const syndromeCoefficients=new Int32Array(twoS);let noError=true;for(let i=0;i<twoS;i++){const evalResult=poly.evaluateAt(field.exp(i+field.getGeneratorBase()));syndromeCoefficients[syndromeCoefficients.length-1-i]=evalResult;if(evalResult!==0){noError=false;}}
if(noError){return;}
const syndrome=new GenericGFPoly(field,syndromeCoefficients);const sigmaOmega=this.runEuclideanAlgorithm(field.buildMonomial(twoS,1),syndrome,twoS);const sigma=sigmaOmega[0];const omega=sigmaOmega[1];const errorLocations=this.findErrorLocations(sigma);const errorMagnitudes=this.findErrorMagnitudes(omega,errorLocations);for(let i=0;i<errorLocations.length;i++){const position=received.length-1-field.log(errorLocations[i]);if(position<0){throw new ReedSolomonException('Bad error location');}
received[position]=GenericGF.addOrSubtract(received[position],errorMagnitudes[i]);}}
runEuclideanAlgorithm(a,b,R){if(a.getDegree()<b.getDegree()){const temp=a;a=b;b=temp;}
const field=this.field;let rLast=a;let r=b;let tLast=field.getZero();let t=field.getOne();while(r.getDegree()>=(R/2|0)){let rLastLast=rLast;let tLastLast=tLast;rLast=r;tLast=t;if(rLast.isZero()){throw new ReedSolomonException('r_{i-1} was zero');}
r=rLastLast;let q=field.getZero();const denominatorLeadingTerm=rLast.getCoefficient(rLast.getDegree());const dltInverse=field.inverse(denominatorLeadingTerm);while(r.getDegree()>=rLast.getDegree()&&!r.isZero()){const degreeDiff=r.getDegree()-rLast.getDegree();const scale=field.multiply(r.getCoefficient(r.getDegree()),dltInverse);q=q.addOrSubtract(field.buildMonomial(degreeDiff,scale));r=r.addOrSubtract(rLast.multiplyByMonomial(degreeDiff,scale));}
t=q.multiply(tLast).addOrSubtract(tLastLast);if(r.getDegree()>=rLast.getDegree()){throw new IllegalStateException('Division algorithm failed to reduce polynomial?');}}
const sigmaTildeAtZero=t.getCoefficient(0);if(sigmaTildeAtZero===0){throw new ReedSolomonException('sigmaTilde(0) was zero');}
const inverse=field.inverse(sigmaTildeAtZero);const sigma=t.multiplyScalar(inverse);const omega=r.multiplyScalar(inverse);return[sigma,omega];}
findErrorLocations(errorLocator){const numErrors=errorLocator.getDegree();if(numErrors===1){return Int32Array.from([errorLocator.getCoefficient(1)]);}
const result=new Int32Array(numErrors);let e=0;const field=this.field;for(let i=1;i<field.getSize()&&e<numErrors;i++){if(errorLocator.evaluateAt(i)===0){result[e]=field.inverse(i);e++;}}
if(e!==numErrors){throw new ReedSolomonException('Error locator degree does not match number of roots');}
return result;}
findErrorMagnitudes(errorEvaluator,errorLocations){const s=errorLocations.length;const result=new Int32Array(s);const field=this.field;for(let i=0;i<s;i++){const xiInverse=field.inverse(errorLocations[i]);let denominator=1;for(let j=0;j<s;j++){if(i!==j){const term=field.multiply(errorLocations[j],xiInverse);const termPlus1=(term&0x1)===0?term|1:term&~1;denominator=field.multiply(denominator,termPlus1);}}
result[i]=field.multiply(errorEvaluator.evaluateAt(xiInverse),field.inverse(denominator));if(field.getGeneratorBase()!==0){result[i]=field.multiply(result[i],xiInverse);}}
return result;}}
var Table;(function(Table){Table[Table["UPPER"]=0]="UPPER";Table[Table["LOWER"]=1]="LOWER";Table[Table["MIXED"]=2]="MIXED";Table[Table["DIGIT"]=3]="DIGIT";Table[Table["PUNCT"]=4]="PUNCT";Table[Table["BINARY"]=5]="BINARY";})(Table||(Table={}));class Decoder{decode(detectorResult){this.ddata=detectorResult;let matrix=detectorResult.getBits();let rawbits=this.extractBits(matrix);let correctedBits=this.correctBits(rawbits);let rawBytes=Decoder.convertBoolArrayToByteArray(correctedBits);let result=Decoder.getEncodedData(correctedBits);let decoderResult=new DecoderResult(rawBytes,result,null,null);decoderResult.setNumBits(correctedBits.length);return decoderResult;}
static highLevelDecode(correctedBits){return this.getEncodedData(correctedBits);}
static getEncodedData(correctedBits){let endIndex=correctedBits.length;let latchTable=Table.UPPER;let shiftTable=Table.UPPER;let result='';let index=0;while(index<endIndex){if(shiftTable===Table.BINARY){if(endIndex-index<5){break;}
let length=Decoder.readCode(correctedBits,index,5);index+=5;if(length===0){if(endIndex-index<11){break;}
length=Decoder.readCode(correctedBits,index,11)+31;index+=11;}
for(let charCount=0;charCount<length;charCount++){if(endIndex-index<8){index=endIndex;break;}
const code=Decoder.readCode(correctedBits,index,8);result+=StringUtils.castAsNonUtf8Char(code);index+=8;}
shiftTable=latchTable;}
else{let size=shiftTable===Table.DIGIT?4:5;if(endIndex-index<size){break;}
let code=Decoder.readCode(correctedBits,index,size);index+=size;let str=Decoder.getCharacter(shiftTable,code);if(str.startsWith('CTRL_')){latchTable=shiftTable;shiftTable=Decoder.getTable(str.charAt(5));if(str.charAt(6)==='L'){latchTable=shiftTable;}}
else{result+=str;shiftTable=latchTable;}}}
return result;}
static getTable(t){switch(t){case'L':return Table.LOWER;case'P':return Table.PUNCT;case'M':return Table.MIXED;case'D':return Table.DIGIT;case'B':return Table.BINARY;case'U':default:return Table.UPPER;}}
static getCharacter(table,code){switch(table){case Table.UPPER:return Decoder.UPPER_TABLE[code];case Table.LOWER:return Decoder.LOWER_TABLE[code];case Table.MIXED:return Decoder.MIXED_TABLE[code];case Table.PUNCT:return Decoder.PUNCT_TABLE[code];case Table.DIGIT:return Decoder.DIGIT_TABLE[code];default:throw new IllegalStateException('Bad table');}}
correctBits(rawbits){let gf;let codewordSize;if(this.ddata.getNbLayers()<=2){codewordSize=6;gf=GenericGF.AZTEC_DATA_6;}
else if(this.ddata.getNbLayers()<=8){codewordSize=8;gf=GenericGF.AZTEC_DATA_8;}
else if(this.ddata.getNbLayers()<=22){codewordSize=10;gf=GenericGF.AZTEC_DATA_10;}
else{codewordSize=12;gf=GenericGF.AZTEC_DATA_12;}
let numDataCodewords=this.ddata.getNbDatablocks();let numCodewords=rawbits.length/codewordSize;if(numCodewords<numDataCodewords){throw new FormatException();}
let offset=rawbits.length%codewordSize;let dataWords=new Int32Array(numCodewords);for(let i=0;i<numCodewords;i++,offset+=codewordSize){dataWords[i]=Decoder.readCode(rawbits,offset,codewordSize);}
try{let rsDecoder=new ReedSolomonDecoder(gf);rsDecoder.decode(dataWords,numCodewords-numDataCodewords);}
catch(ex){throw new FormatException(ex);}
let mask=(1<<codewordSize)-1;let stuffedBits=0;for(let i=0;i<numDataCodewords;i++){let dataWord=dataWords[i];if(dataWord===0||dataWord===mask){throw new FormatException();}
else if(dataWord===1||dataWord===mask-1){stuffedBits++;}}
let correctedBits=new Array(numDataCodewords*codewordSize-stuffedBits);let index=0;for(let i=0;i<numDataCodewords;i++){let dataWord=dataWords[i];if(dataWord===1||dataWord===mask-1){correctedBits.fill(dataWord>1,index,index+codewordSize-1);index+=codewordSize-1;}
else{for(let bit=codewordSize-1;bit>=0;--bit){correctedBits[index++]=(dataWord&(1<<bit))!==0;}}}
return correctedBits;}
extractBits(matrix){let compact=this.ddata.isCompact();let layers=this.ddata.getNbLayers();let baseMatrixSize=(compact?11:14)+layers*4;let alignmentMap=new Int32Array(baseMatrixSize);let rawbits=new Array(this.totalBitsInLayer(layers,compact));if(compact){for(let i=0;i<alignmentMap.length;i++){alignmentMap[i]=i;}}
else{let matrixSize=baseMatrixSize+1+2*Integer.truncDivision((Integer.truncDivision(baseMatrixSize,2)-1),15);let origCenter=baseMatrixSize/2;let center=Integer.truncDivision(matrixSize,2);for(let i=0;i<origCenter;i++){let newOffset=i+Integer.truncDivision(i,15);alignmentMap[origCenter-i-1]=center-newOffset-1;alignmentMap[origCenter+i]=center+newOffset+1;}}
for(let i=0,rowOffset=0;i<layers;i++){let rowSize=(layers-i)*4+(compact?9:12);let low=i*2;let high=baseMatrixSize-1-low;for(let j=0;j<rowSize;j++){let columnOffset=j*2;for(let k=0;k<2;k++){rawbits[rowOffset+columnOffset+k]=matrix.get(alignmentMap[low+k],alignmentMap[low+j]);rawbits[rowOffset+2*rowSize+columnOffset+k]=matrix.get(alignmentMap[low+j],alignmentMap[high-k]);rawbits[rowOffset+4*rowSize+columnOffset+k]=matrix.get(alignmentMap[high-k],alignmentMap[high-j]);rawbits[rowOffset+6*rowSize+columnOffset+k]=matrix.get(alignmentMap[high-j],alignmentMap[low+k]);}}
rowOffset+=rowSize*8;}
return rawbits;}
static readCode(rawbits,startIndex,length){let res=0;for(let i=startIndex;i<startIndex+length;i++){res<<=1;if(rawbits[i]){res|=0x01;}}
return res;}
static readByte(rawbits,startIndex){let n=rawbits.length-startIndex;if(n>=8){return Decoder.readCode(rawbits,startIndex,8);}
return Decoder.readCode(rawbits,startIndex,n)<<(8-n);}
static convertBoolArrayToByteArray(boolArr){let byteArr=new Uint8Array((boolArr.length+7)/8);for(let i=0;i<byteArr.length;i++){byteArr[i]=Decoder.readByte(boolArr,8*i);}
return byteArr;}
totalBitsInLayer(layers,compact){return((compact?88:112)+16*layers)*layers;}}
Decoder.UPPER_TABLE=['CTRL_PS',' ','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','CTRL_LL','CTRL_ML','CTRL_DL','CTRL_BS'];Decoder.LOWER_TABLE=['CTRL_PS',' ','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','CTRL_US','CTRL_ML','CTRL_DL','CTRL_BS'];Decoder.MIXED_TABLE=['CTRL_PS',' ','\\1','\\2','\\3','\\4','\\5','\\6','\\7','\b','\t','\n','\\13','\f','\r','\\33','\\34','\\35','\\36','\\37','@','\\','^','_','`','|','~','\\177','CTRL_LL','CTRL_UL','CTRL_PL','CTRL_BS'];Decoder.PUNCT_TABLE=['','\r','\r\n','. ',', ',': ','!','"','#','$','%','&','\'','(',')','*','+',',','-','.','/',':',';','<','=','>','?','[',']','{','}','CTRL_UL'];Decoder.DIGIT_TABLE=['CTRL_PS',' ','0','1','2','3','4','5','6','7','8','9',',','.','CTRL_UL','CTRL_US'];class MathUtils{constructor(){}
static round(d){if(NaN===d)
return 0;if(d<=Number.MIN_SAFE_INTEGER)
return Number.MIN_SAFE_INTEGER;if(d>=Number.MAX_SAFE_INTEGER)
return Number.MAX_SAFE_INTEGER;return(d+(d<0.0?-0.5:0.5))|0;}
static distance(aX,aY,bX,bY){const xDiff=aX-bX;const yDiff=aY-bY;return Math.sqrt(xDiff*xDiff+yDiff*yDiff);}
static sum(array){let count=0;for(let i=0,length=array.length;i!==length;i++){const a=array[i];count+=a;}
return count;}}
class Float{static floatToIntBits(f){return f;}}
Float.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ResultPoint{constructor(x,y){this.x=x;this.y=y;}
getX(){return this.x;}
getY(){return this.y;}
equals(other){if(other instanceof ResultPoint){const otherPoint=other;return this.x===otherPoint.x&&this.y===otherPoint.y;}
return false;}
hashCode(){return 31*Float.floatToIntBits(this.x)+Float.floatToIntBits(this.y);}
toString(){return'('+this.x+','+this.y+')';}
static orderBestPatterns(patterns){const zeroOneDistance=this.distance(patterns[0],patterns[1]);const oneTwoDistance=this.distance(patterns[1],patterns[2]);const zeroTwoDistance=this.distance(patterns[0],patterns[2]);let pointA;let pointB;let pointC;if(oneTwoDistance>=zeroOneDistance&&oneTwoDistance>=zeroTwoDistance){pointB=patterns[0];pointA=patterns[1];pointC=patterns[2];}
else if(zeroTwoDistance>=oneTwoDistance&&zeroTwoDistance>=zeroOneDistance){pointB=patterns[1];pointA=patterns[0];pointC=patterns[2];}
else{pointB=patterns[2];pointA=patterns[0];pointC=patterns[1];}
if(this.crossProductZ(pointA,pointB,pointC)<0.0){const temp=pointA;pointA=pointC;pointC=temp;}
patterns[0]=pointA;patterns[1]=pointB;patterns[2]=pointC;}
static distance(pattern1,pattern2){return MathUtils.distance(pattern1.x,pattern1.y,pattern2.x,pattern2.y);}
static crossProductZ(pointA,pointB,pointC){const bX=pointB.x;const bY=pointB.y;return((pointC.x-bX)*(pointA.y-bY))-((pointC.y-bY)*(pointA.x-bX));}}
class DetectorResult{constructor(bits,points){this.bits=bits;this.points=points;}
getBits(){return this.bits;}
getPoints(){return this.points;}}
class AztecDetectorResult extends DetectorResult{constructor(bits,points,compact,nbDatablocks,nbLayers){super(bits,points);this.compact=compact;this.nbDatablocks=nbDatablocks;this.nbLayers=nbLayers;}
getNbLayers(){return this.nbLayers;}
getNbDatablocks(){return this.nbDatablocks;}
isCompact(){return this.compact;}}
class WhiteRectangleDetector{constructor(image,initSize,x,y){this.image=image;this.height=image.getHeight();this.width=image.getWidth();if(undefined===initSize||null===initSize){initSize=WhiteRectangleDetector.INIT_SIZE;}
if(undefined===x||null===x){x=image.getWidth()/2|0;}
if(undefined===y||null===y){y=image.getHeight()/2|0;}
const halfsize=initSize/2|0;this.leftInit=x-halfsize;this.rightInit=x+halfsize;this.upInit=y-halfsize;this.downInit=y+halfsize;if(this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width){throw new NotFoundException();}}
detect(){let left=this.leftInit;let right=this.rightInit;let up=this.upInit;let down=this.downInit;let sizeExceeded=false;let aBlackPointFoundOnBorder=true;let atLeastOneBlackPointFoundOnBorder=false;let atLeastOneBlackPointFoundOnRight=false;let atLeastOneBlackPointFoundOnBottom=false;let atLeastOneBlackPointFoundOnLeft=false;let atLeastOneBlackPointFoundOnTop=false;const width=this.width;const height=this.height;while(aBlackPointFoundOnBorder){aBlackPointFoundOnBorder=false;let rightBorderNotWhite=true;while((rightBorderNotWhite||!atLeastOneBlackPointFoundOnRight)&&right<width){rightBorderNotWhite=this.containsBlackPoint(up,down,right,false);if(rightBorderNotWhite){right++;aBlackPointFoundOnBorder=true;atLeastOneBlackPointFoundOnRight=true;}
else if(!atLeastOneBlackPointFoundOnRight){right++;}}
if(right>=width){sizeExceeded=true;break;}
let bottomBorderNotWhite=true;while((bottomBorderNotWhite||!atLeastOneBlackPointFoundOnBottom)&&down<height){bottomBorderNotWhite=this.containsBlackPoint(left,right,down,true);if(bottomBorderNotWhite){down++;aBlackPointFoundOnBorder=true;atLeastOneBlackPointFoundOnBottom=true;}
else if(!atLeastOneBlackPointFoundOnBottom){down++;}}
if(down>=height){sizeExceeded=true;break;}
let leftBorderNotWhite=true;while((leftBorderNotWhite||!atLeastOneBlackPointFoundOnLeft)&&left>=0){leftBorderNotWhite=this.containsBlackPoint(up,down,left,false);if(leftBorderNotWhite){left--;aBlackPointFoundOnBorder=true;atLeastOneBlackPointFoundOnLeft=true;}
else if(!atLeastOneBlackPointFoundOnLeft){left--;}}
if(left<0){sizeExceeded=true;break;}
let topBorderNotWhite=true;while((topBorderNotWhite||!atLeastOneBlackPointFoundOnTop)&&up>=0){topBorderNotWhite=this.containsBlackPoint(left,right,up,true);if(topBorderNotWhite){up--;aBlackPointFoundOnBorder=true;atLeastOneBlackPointFoundOnTop=true;}
else if(!atLeastOneBlackPointFoundOnTop){up--;}}
if(up<0){sizeExceeded=true;break;}
if(aBlackPointFoundOnBorder){atLeastOneBlackPointFoundOnBorder=true;}}
if(!sizeExceeded&&atLeastOneBlackPointFoundOnBorder){const maxSize=right-left;let z=null;for(let i=1;z===null&&i<maxSize;i++){z=this.getBlackPointOnSegment(left,down-i,left+i,down);}
if(z==null){throw new NotFoundException();}
let t=null;for(let i=1;t===null&&i<maxSize;i++){t=this.getBlackPointOnSegment(left,up+i,left+i,up);}
if(t==null){throw new NotFoundException();}
let x=null;for(let i=1;x===null&&i<maxSize;i++){x=this.getBlackPointOnSegment(right,up+i,right-i,up);}
if(x==null){throw new NotFoundException();}
let y=null;for(let i=1;y===null&&i<maxSize;i++){y=this.getBlackPointOnSegment(right,down-i,right-i,down);}
if(y==null){throw new NotFoundException();}
return this.centerEdges(y,z,x,t);}
else{throw new NotFoundException();}}
getBlackPointOnSegment(aX,aY,bX,bY){const dist=MathUtils.round(MathUtils.distance(aX,aY,bX,bY));const xStep=(bX-aX)/dist;const yStep=(bY-aY)/dist;const image=this.image;for(let i=0;i<dist;i++){const x=MathUtils.round(aX+i*xStep);const y=MathUtils.round(aY+i*yStep);if(image.get(x,y)){return new ResultPoint(x,y);}}
return null;}
centerEdges(y,z,x,t){const yi=y.getX();const yj=y.getY();const zi=z.getX();const zj=z.getY();const xi=x.getX();const xj=x.getY();const ti=t.getX();const tj=t.getY();const CORR=WhiteRectangleDetector.CORR;if(yi<this.width/2.0){return[new ResultPoint(ti-CORR,tj+CORR),new ResultPoint(zi+CORR,zj+CORR),new ResultPoint(xi-CORR,xj-CORR),new ResultPoint(yi+CORR,yj-CORR)];}
else{return[new ResultPoint(ti+CORR,tj+CORR),new ResultPoint(zi+CORR,zj-CORR),new ResultPoint(xi-CORR,xj+CORR),new ResultPoint(yi-CORR,yj-CORR)];}}
containsBlackPoint(a,b,fixed,horizontal){const image=this.image;if(horizontal){for(let x=a;x<=b;x++){if(image.get(x,fixed)){return true;}}}
else{for(let y=a;y<=b;y++){if(image.get(fixed,y)){return true;}}}
return false;}}
WhiteRectangleDetector.INIT_SIZE=10;WhiteRectangleDetector.CORR=1;class GridSampler{static checkAndNudgePoints(image,points){const width=image.getWidth();const height=image.getHeight();let nudged=true;for(let offset=0;offset<points.length&&nudged;offset+=2){const x=Math.floor(points[offset]);const y=Math.floor(points[offset+1]);if(x<-1||x>width||y<-1||y>height){throw new NotFoundException();}
nudged=false;if(x===-1){points[offset]=0.0;nudged=true;}
else if(x===width){points[offset]=width-1;nudged=true;}
if(y===-1){points[offset+1]=0.0;nudged=true;}
else if(y===height){points[offset+1]=height-1;nudged=true;}}
nudged=true;for(let offset=points.length-2;offset>=0&&nudged;offset-=2){const x=Math.floor(points[offset]);const y=Math.floor(points[offset+1]);if(x<-1||x>width||y<-1||y>height){throw new NotFoundException();}
nudged=false;if(x===-1){points[offset]=0.0;nudged=true;}
else if(x===width){points[offset]=width-1;nudged=true;}
if(y===-1){points[offset+1]=0.0;nudged=true;}
else if(y===height){points[offset+1]=height-1;nudged=true;}}}}
class PerspectiveTransform{constructor(a11,a21,a31,a12,a22,a32,a13,a23,a33){this.a11=a11;this.a21=a21;this.a31=a31;this.a12=a12;this.a22=a22;this.a32=a32;this.a13=a13;this.a23=a23;this.a33=a33;}
static quadrilateralToQuadrilateral(x0,y0,x1,y1,x2,y2,x3,y3,x0p,y0p,x1p,y1p,x2p,y2p,x3p,y3p){const qToS=PerspectiveTransform.quadrilateralToSquare(x0,y0,x1,y1,x2,y2,x3,y3);const sToQ=PerspectiveTransform.squareToQuadrilateral(x0p,y0p,x1p,y1p,x2p,y2p,x3p,y3p);return sToQ.times(qToS);}
transformPoints(points){const max=points.length;const a11=this.a11;const a12=this.a12;const a13=this.a13;const a21=this.a21;const a22=this.a22;const a23=this.a23;const a31=this.a31;const a32=this.a32;const a33=this.a33;for(let i=0;i<max;i+=2){const x=points[i];const y=points[i+1];const denominator=a13*x+a23*y+a33;points[i]=(a11*x+a21*y+a31)/denominator;points[i+1]=(a12*x+a22*y+a32)/denominator;}}
transformPointsWithValues(xValues,yValues){const a11=this.a11;const a12=this.a12;const a13=this.a13;const a21=this.a21;const a22=this.a22;const a23=this.a23;const a31=this.a31;const a32=this.a32;const a33=this.a33;const n=xValues.length;for(let i=0;i<n;i++){const x=xValues[i];const y=yValues[i];const denominator=a13*x+a23*y+a33;xValues[i]=(a11*x+a21*y+a31)/denominator;yValues[i]=(a12*x+a22*y+a32)/denominator;}}
static squareToQuadrilateral(x0,y0,x1,y1,x2,y2,x3,y3){const dx3=x0-x1+x2-x3;const dy3=y0-y1+y2-y3;if(dx3===0.0&&dy3===0.0){return new PerspectiveTransform(x1-x0,x2-x1,x0,y1-y0,y2-y1,y0,0.0,0.0,1.0);}
else{const dx1=x1-x2;const dx2=x3-x2;const dy1=y1-y2;const dy2=y3-y2;const denominator=dx1*dy2-dx2*dy1;const a13=(dx3*dy2-dx2*dy3)/denominator;const a23=(dx1*dy3-dx3*dy1)/denominator;return new PerspectiveTransform(x1-x0+a13*x1,x3-x0+a23*x3,x0,y1-y0+a13*y1,y3-y0+a23*y3,y0,a13,a23,1.0);}}
static quadrilateralToSquare(x0,y0,x1,y1,x2,y2,x3,y3){return PerspectiveTransform.squareToQuadrilateral(x0,y0,x1,y1,x2,y2,x3,y3).buildAdjoint();}
buildAdjoint(){return new PerspectiveTransform(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21);}
times(other){return new PerspectiveTransform(this.a11*other.a11+this.a21*other.a12+this.a31*other.a13,this.a11*other.a21+this.a21*other.a22+this.a31*other.a23,this.a11*other.a31+this.a21*other.a32+this.a31*other.a33,this.a12*other.a11+this.a22*other.a12+this.a32*other.a13,this.a12*other.a21+this.a22*other.a22+this.a32*other.a23,this.a12*other.a31+this.a22*other.a32+this.a32*other.a33,this.a13*other.a11+this.a23*other.a12+this.a33*other.a13,this.a13*other.a21+this.a23*other.a22+this.a33*other.a23,this.a13*other.a31+this.a23*other.a32+this.a33*other.a33);}}
class DefaultGridSampler extends GridSampler{sampleGrid(image,dimensionX,dimensionY,p1ToX,p1ToY,p2ToX,p2ToY,p3ToX,p3ToY,p4ToX,p4ToY,p1FromX,p1FromY,p2FromX,p2FromY,p3FromX,p3FromY,p4FromX,p4FromY){const transform=PerspectiveTransform.quadrilateralToQuadrilateral(p1ToX,p1ToY,p2ToX,p2ToY,p3ToX,p3ToY,p4ToX,p4ToY,p1FromX,p1FromY,p2FromX,p2FromY,p3FromX,p3FromY,p4FromX,p4FromY);return this.sampleGridWithTransform(image,dimensionX,dimensionY,transform);}
sampleGridWithTransform(image,dimensionX,dimensionY,transform){if(dimensionX<=0||dimensionY<=0){throw new NotFoundException();}
const bits=new BitMatrix(dimensionX,dimensionY);const points=new Float32Array(2*dimensionX);for(let y=0;y<dimensionY;y++){const max=points.length;const iValue=y+0.5;for(let x=0;x<max;x+=2){points[x]=(x/2)+0.5;points[x+1]=iValue;}
transform.transformPoints(points);GridSampler.checkAndNudgePoints(image,points);try{for(let x=0;x<max;x+=2){if(image.get(Math.floor(points[x]),Math.floor(points[x+1]))){bits.set(x/2,y);}}}
catch(aioobe){throw new NotFoundException();}}
return bits;}}
class GridSamplerInstance{static setGridSampler(newGridSampler){GridSamplerInstance.gridSampler=newGridSampler;}
static getInstance(){return GridSamplerInstance.gridSampler;}}
GridSamplerInstance.gridSampler=new DefaultGridSampler();class Point{constructor(x,y){this.x=x;this.y=y;}
toResultPoint(){return new ResultPoint(this.getX(),this.getY());}
getX(){return this.x;}
getY(){return this.y;}}
class Detector{constructor(image){this.EXPECTED_CORNER_BITS=new Int32Array([0xee0,0x1dc,0x83b,0x707,]);this.image=image;}
detect(){return this.detectMirror(false);}
detectMirror(isMirror){let pCenter=this.getMatrixCenter();let bullsEyeCorners=this.getBullsEyeCorners(pCenter);if(isMirror){let temp=bullsEyeCorners[0];bullsEyeCorners[0]=bullsEyeCorners[2];bullsEyeCorners[2]=temp;}
this.extractParameters(bullsEyeCorners);let bits=this.sampleGrid(this.image,bullsEyeCorners[this.shift%4],bullsEyeCorners[(this.shift+1)%4],bullsEyeCorners[(this.shift+2)%4],bullsEyeCorners[(this.shift+3)%4]);let corners=this.getMatrixCornerPoints(bullsEyeCorners);return new AztecDetectorResult(bits,corners,this.compact,this.nbDataBlocks,this.nbLayers);}
extractParameters(bullsEyeCorners){if(!this.isValidPoint(bullsEyeCorners[0])||!this.isValidPoint(bullsEyeCorners[1])||!this.isValidPoint(bullsEyeCorners[2])||!this.isValidPoint(bullsEyeCorners[3])){throw new NotFoundException();}
let length=2*this.nbCenterLayers;let sides=new Int32Array([this.sampleLine(bullsEyeCorners[0],bullsEyeCorners[1],length),this.sampleLine(bullsEyeCorners[1],bullsEyeCorners[2],length),this.sampleLine(bullsEyeCorners[2],bullsEyeCorners[3],length),this.sampleLine(bullsEyeCorners[3],bullsEyeCorners[0],length)]);this.shift=this.getRotation(sides,length);let parameterData=0;for(let i=0;i<4;i++){let side=sides[(this.shift+i)%4];if(this.compact){parameterData<<=7;parameterData+=(side>>1)&0x7F;}
else{parameterData<<=10;parameterData+=((side>>2)&(0x1f<<5))+((side>>1)&0x1F);}}
let correctedData=this.getCorrectedParameterData(parameterData,this.compact);if(this.compact){this.nbLayers=(correctedData>>6)+1;this.nbDataBlocks=(correctedData&0x3F)+1;}
else{this.nbLayers=(correctedData>>11)+1;this.nbDataBlocks=(correctedData&0x7FF)+1;}}
getRotation(sides,length){let cornerBits=0;sides.forEach((side,idx,arr)=>{let t=((side>>(length-2))<<1)+(side&1);cornerBits=(cornerBits<<3)+t;});cornerBits=((cornerBits&1)<<11)+(cornerBits>>1);for(let shift=0;shift<4;shift++){if(Integer.bitCount(cornerBits^this.EXPECTED_CORNER_BITS[shift])<=2){return shift;}}
throw new NotFoundException();}
getCorrectedParameterData(parameterData,compact){let numCodewords;let numDataCodewords;if(compact){numCodewords=7;numDataCodewords=2;}
else{numCodewords=10;numDataCodewords=4;}
let numECCodewords=numCodewords-numDataCodewords;let parameterWords=new Int32Array(numCodewords);for(let i=numCodewords-1;i>=0;--i){parameterWords[i]=parameterData&0xF;parameterData>>=4;}
try{let rsDecoder=new ReedSolomonDecoder(GenericGF.AZTEC_PARAM);rsDecoder.decode(parameterWords,numECCodewords);}
catch(ignored){throw new NotFoundException();}
let result=0;for(let i=0;i<numDataCodewords;i++){result=(result<<4)+parameterWords[i];}
return result;}
getBullsEyeCorners(pCenter){let pina=pCenter;let pinb=pCenter;let pinc=pCenter;let pind=pCenter;let color=true;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let pouta=this.getFirstDifferent(pina,color,1,-1);let poutb=this.getFirstDifferent(pinb,color,1,1);let poutc=this.getFirstDifferent(pinc,color,-1,1);let poutd=this.getFirstDifferent(pind,color,-1,-1);if(this.nbCenterLayers>2){let q=(this.distancePoint(poutd,pouta)*this.nbCenterLayers)/(this.distancePoint(pind,pina)*(this.nbCenterLayers+2));if(q<0.75||q>1.25||!this.isWhiteOrBlackRectangle(pouta,poutb,poutc,poutd)){break;}}
pina=pouta;pinb=poutb;pinc=poutc;pind=poutd;color=!color;}
if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7){throw new NotFoundException();}
this.compact=this.nbCenterLayers===5;let pinax=new ResultPoint(pina.getX()+0.5,pina.getY()-0.5);let pinbx=new ResultPoint(pinb.getX()+0.5,pinb.getY()+0.5);let pincx=new ResultPoint(pinc.getX()-0.5,pinc.getY()+0.5);let pindx=new ResultPoint(pind.getX()-0.5,pind.getY()-0.5);return this.expandSquare([pinax,pinbx,pincx,pindx],2*this.nbCenterLayers-3,2*this.nbCenterLayers);}
getMatrixCenter(){let pointA;let pointB;let pointC;let pointD;try{let cornerPoints=new WhiteRectangleDetector(this.image).detect();pointA=cornerPoints[0];pointB=cornerPoints[1];pointC=cornerPoints[2];pointD=cornerPoints[3];}
catch(e){let cx=this.image.getWidth()/2;let cy=this.image.getHeight()/2;pointA=this.getFirstDifferent(new Point(cx+7,cy-7),false,1,-1).toResultPoint();pointB=this.getFirstDifferent(new Point(cx+7,cy+7),false,1,1).toResultPoint();pointC=this.getFirstDifferent(new Point(cx-7,cy+7),false,-1,1).toResultPoint();pointD=this.getFirstDifferent(new Point(cx-7,cy-7),false,-1,-1).toResultPoint();}
let cx=MathUtils.round((pointA.getX()+pointD.getX()+pointB.getX()+pointC.getX())/4.0);let cy=MathUtils.round((pointA.getY()+pointD.getY()+pointB.getY()+pointC.getY())/4.0);try{let cornerPoints=new WhiteRectangleDetector(this.image,15,cx,cy).detect();pointA=cornerPoints[0];pointB=cornerPoints[1];pointC=cornerPoints[2];pointD=cornerPoints[3];}
catch(e){pointA=this.getFirstDifferent(new Point(cx+7,cy-7),false,1,-1).toResultPoint();pointB=this.getFirstDifferent(new Point(cx+7,cy+7),false,1,1).toResultPoint();pointC=this.getFirstDifferent(new Point(cx-7,cy+7),false,-1,1).toResultPoint();pointD=this.getFirstDifferent(new Point(cx-7,cy-7),false,-1,-1).toResultPoint();}
cx=MathUtils.round((pointA.getX()+pointD.getX()+pointB.getX()+pointC.getX())/4.0);cy=MathUtils.round((pointA.getY()+pointD.getY()+pointB.getY()+pointC.getY())/4.0);return new Point(cx,cy);}
getMatrixCornerPoints(bullsEyeCorners){return this.expandSquare(bullsEyeCorners,2*this.nbCenterLayers,this.getDimension());}
sampleGrid(image,topLeft,topRight,bottomRight,bottomLeft){let sampler=GridSamplerInstance.getInstance();let dimension=this.getDimension();let low=dimension/2-this.nbCenterLayers;let high=dimension/2+this.nbCenterLayers;return sampler.sampleGrid(image,dimension,dimension,low,low,high,low,high,high,low,high,topLeft.getX(),topLeft.getY(),topRight.getX(),topRight.getY(),bottomRight.getX(),bottomRight.getY(),bottomLeft.getX(),bottomLeft.getY());}
sampleLine(p1,p2,size){let result=0;let d=this.distanceResultPoint(p1,p2);let moduleSize=d/size;let px=p1.getX();let py=p1.getY();let dx=moduleSize*(p2.getX()-p1.getX())/d;let dy=moduleSize*(p2.getY()-p1.getY())/d;for(let i=0;i<size;i++){if(this.image.get(MathUtils.round(px+i*dx),MathUtils.round(py+i*dy))){result|=1<<(size-i-1);}}
return result;}
isWhiteOrBlackRectangle(p1,p2,p3,p4){let corr=3;p1=new Point(p1.getX()-corr,p1.getY()+corr);p2=new Point(p2.getX()-corr,p2.getY()-corr);p3=new Point(p3.getX()+corr,p3.getY()-corr);p4=new Point(p4.getX()+corr,p4.getY()+corr);let cInit=this.getColor(p4,p1);if(cInit===0){return false;}
let c=this.getColor(p1,p2);if(c!==cInit){return false;}
c=this.getColor(p2,p3);if(c!==cInit){return false;}
c=this.getColor(p3,p4);return c===cInit;}
getColor(p1,p2){let d=this.distancePoint(p1,p2);let dx=(p2.getX()-p1.getX())/d;let dy=(p2.getY()-p1.getY())/d;let error=0;let px=p1.getX();let py=p1.getY();let colorModel=this.image.get(p1.getX(),p1.getY());let iMax=Math.ceil(d);for(let i=0;i<iMax;i++){px+=dx;py+=dy;if(this.image.get(MathUtils.round(px),MathUtils.round(py))!==colorModel){error++;}}
let errRatio=error/d;if(errRatio>0.1&&errRatio<0.9){return 0;}
return(errRatio<=0.1)===colorModel?1:-1;}
getFirstDifferent(init,color,dx,dy){let x=init.getX()+dx;let y=init.getY()+dy;while(this.isValid(x,y)&&this.image.get(x,y)===color){x+=dx;y+=dy;}
x-=dx;y-=dy;while(this.isValid(x,y)&&this.image.get(x,y)===color){x+=dx;}
x-=dx;while(this.isValid(x,y)&&this.image.get(x,y)===color){y+=dy;}
y-=dy;return new Point(x,y);}
expandSquare(cornerPoints,oldSide,newSide){let ratio=newSide/(2.0*oldSide);let dx=cornerPoints[0].getX()-cornerPoints[2].getX();let dy=cornerPoints[0].getY()-cornerPoints[2].getY();let centerx=(cornerPoints[0].getX()+cornerPoints[2].getX())/2.0;let centery=(cornerPoints[0].getY()+cornerPoints[2].getY())/2.0;let result0=new ResultPoint(centerx+ratio*dx,centery+ratio*dy);let result2=new ResultPoint(centerx-ratio*dx,centery-ratio*dy);dx=cornerPoints[1].getX()-cornerPoints[3].getX();dy=cornerPoints[1].getY()-cornerPoints[3].getY();centerx=(cornerPoints[1].getX()+cornerPoints[3].getX())/2.0;centery=(cornerPoints[1].getY()+cornerPoints[3].getY())/2.0;let result1=new ResultPoint(centerx+ratio*dx,centery+ratio*dy);let result3=new ResultPoint(centerx-ratio*dx,centery-ratio*dy);let results=[result0,result1,result2,result3];return results;}
isValid(x,y){return x>=0&&x<this.image.getWidth()&&y>0&&y<this.image.getHeight();}
isValidPoint(point){let x=MathUtils.round(point.getX());let y=MathUtils.round(point.getY());return this.isValid(x,y);}
distancePoint(a,b){return MathUtils.distance(a.getX(),a.getY(),b.getX(),b.getY());}
distanceResultPoint(a,b){return MathUtils.distance(a.getX(),a.getY(),b.getX(),b.getY());}
getDimension(){if(this.compact){return 4*this.nbLayers+11;}
if(this.nbLayers<=4){return 4*this.nbLayers+15;}
return 4*this.nbLayers+2*(Integer.truncDivision((this.nbLayers-4),8)+1)+15;}}
class AztecReader{decode(image,hints=null){let exception=null;let detector=new Detector(image.getBlackMatrix());let points=null;let decoderResult=null;try{let detectorResult=detector.detectMirror(false);points=detectorResult.getPoints();this.reportFoundResultPoints(hints,points);decoderResult=new Decoder().decode(detectorResult);}
catch(e){exception=e;}
if(decoderResult==null){try{let detectorResult=detector.detectMirror(true);points=detectorResult.getPoints();this.reportFoundResultPoints(hints,points);decoderResult=new Decoder().decode(detectorResult);}
catch(e){if(exception!=null){throw exception;}
throw e;}}
let result=new Result(decoderResult.getText(),decoderResult.getRawBytes(),decoderResult.getNumBits(),points,BarcodeFormat$1.AZTEC,System.currentTimeMillis());let byteSegments=decoderResult.getByteSegments();if(byteSegments!=null){result.putMetadata(ResultMetadataType$1.BYTE_SEGMENTS,byteSegments);}
let ecLevel=decoderResult.getECLevel();if(ecLevel!=null){result.putMetadata(ResultMetadataType$1.ERROR_CORRECTION_LEVEL,ecLevel);}
return result;}
reportFoundResultPoints(hints,points){if(hints!=null){let rpcb=hints.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);if(rpcb!=null){points.forEach((point,idx,arr)=>{rpcb.foundPossibleResultPoint(point);});}}}
reset(){}}
class BrowserAztecCodeReader extends BrowserCodeReader{constructor(timeBetweenScansMillis=500){super(new AztecReader(),timeBetweenScansMillis);}}
class OneDReader{decode(image,hints){try{return this.doDecode(image,hints);}
catch(nfe){const tryHarder=hints&&(hints.get(DecodeHintType$1.TRY_HARDER)===true);if(tryHarder&&image.isRotateSupported()){const rotatedImage=image.rotateCounterClockwise();const result=this.doDecode(rotatedImage,hints);const metadata=result.getResultMetadata();let orientation=270;if(metadata!==null&&(metadata.get(ResultMetadataType$1.ORIENTATION)===true)){orientation=(orientation+metadata.get(ResultMetadataType$1.ORIENTATION)%360);}
result.putMetadata(ResultMetadataType$1.ORIENTATION,orientation);const points=result.getResultPoints();if(points!==null){const height=rotatedImage.getHeight();for(let i=0;i<points.length;i++){points[i]=new ResultPoint(height-points[i].getY()-1,points[i].getX());}}
return result;}
else{throw new NotFoundException();}}}
reset(){}
doDecode(image,hints){const width=image.getWidth();const height=image.getHeight();let row=new BitArray(width);const tryHarder=hints&&(hints.get(DecodeHintType$1.TRY_HARDER)===true);const rowStep=Math.max(1,height>>(tryHarder?8:5));let maxLines;if(tryHarder){maxLines=height;}
else{maxLines=15;}
const middle=Math.trunc(height/2);for(let x=0;x<maxLines;x++){const rowStepsAboveOrBelow=Math.trunc((x+1)/2);const isAbove=(x&0x01)===0;const rowNumber=middle+rowStep*(isAbove?rowStepsAboveOrBelow:-rowStepsAboveOrBelow);if(rowNumber<0||rowNumber>=height){break;}
try{row=image.getBlackRow(rowNumber,row);}
catch(ignored){continue;}
for(let attempt=0;attempt<2;attempt++){if(attempt===1){row.reverse();if(hints&&(hints.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK)===true)){const newHints=new Map();hints.forEach((hint,key)=>newHints.set(key,hint));newHints.delete(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);hints=newHints;}}
try{const result=this.decodeRow(rowNumber,row,hints);if(attempt===1){result.putMetadata(ResultMetadataType$1.ORIENTATION,180);const points=result.getResultPoints();if(points!==null){points[0]=new ResultPoint(width-points[0].getX()-1,points[0].getY());points[1]=new ResultPoint(width-points[1].getX()-1,points[1].getY());}}
return result;}
catch(re){}}}
throw new NotFoundException();}
static recordPattern(row,start,counters){const numCounters=counters.length;for(let index=0;index<numCounters;index++)
counters[index]=0;const end=row.getSize();if(start>=end){throw new NotFoundException();}
let isWhite=!row.get(start);let counterPosition=0;let i=start;while(i<end){if(row.get(i)!==isWhite){counters[counterPosition]++;}
else{if(++counterPosition===numCounters){break;}
else{counters[counterPosition]=1;isWhite=!isWhite;}}
i++;}
if(!(counterPosition===numCounters||(counterPosition===numCounters-1&&i===end))){throw new NotFoundException();}}
static recordPatternInReverse(row,start,counters){let numTransitionsLeft=counters.length;let last=row.get(start);while(start>0&&numTransitionsLeft>=0){if(row.get(--start)!==last){numTransitionsLeft--;last=!last;}}
if(numTransitionsLeft>=0){throw new NotFoundException();}
OneDReader.recordPattern(row,start+1,counters);}
static patternMatchVariance(counters,pattern,maxIndividualVariance){const numCounters=counters.length;let total=0;let patternLength=0;for(let i=0;i<numCounters;i++){total+=counters[i];patternLength+=pattern[i];}
if(total<patternLength){return Number.POSITIVE_INFINITY;}
const unitBarWidth=total/patternLength;maxIndividualVariance*=unitBarWidth;let totalVariance=0.0;for(let x=0;x<numCounters;x++){const counter=counters[x];const scaledPattern=pattern[x]*unitBarWidth;const variance=counter>scaledPattern?counter-scaledPattern:scaledPattern-counter;if(variance>maxIndividualVariance){return Number.POSITIVE_INFINITY;}
totalVariance+=variance;}
return totalVariance/total;}}
class Code128Reader extends OneDReader{static findStartPattern(row){const width=row.getSize();const rowOffset=row.getNextSet(0);let counterPosition=0;let counters=Int32Array.from([0,0,0,0,0,0]);let patternStart=rowOffset;let isWhite=false;const patternLength=6;for(let i=rowOffset;i<width;i++){if(row.get(i)!==isWhite){counters[counterPosition]++;}
else{if(counterPosition===(patternLength-1)){let bestVariance=Code128Reader.MAX_AVG_VARIANCE;let bestMatch=-1;for(let startCode=Code128Reader.CODE_START_A;startCode<=Code128Reader.CODE_START_C;startCode++){const variance=OneDReader.patternMatchVariance(counters,Code128Reader.CODE_PATTERNS[startCode],Code128Reader.MAX_INDIVIDUAL_VARIANCE);if(variance<bestVariance){bestVariance=variance;bestMatch=startCode;}}
if(bestMatch>=0&&row.isRange(Math.max(0,patternStart-(i-patternStart)/2),patternStart,false)){return Int32Array.from([patternStart,i,bestMatch]);}
patternStart+=counters[0]+counters[1];counters=counters.slice(2,counters.length-1);counters[counterPosition-1]=0;counters[counterPosition]=0;counterPosition--;}
else{counterPosition++;}
counters[counterPosition]=1;isWhite=!isWhite;}}
throw new NotFoundException();}
static decodeCode(row,counters,rowOffset){OneDReader.recordPattern(row,rowOffset,counters);let bestVariance=Code128Reader.MAX_AVG_VARIANCE;let bestMatch=-1;for(let d=0;d<Code128Reader.CODE_PATTERNS.length;d++){const pattern=Code128Reader.CODE_PATTERNS[d];const variance=this.patternMatchVariance(counters,pattern,Code128Reader.MAX_INDIVIDUAL_VARIANCE);if(variance<bestVariance){bestVariance=variance;bestMatch=d;}}
if(bestMatch>=0){return bestMatch;}
else{throw new NotFoundException();}}
decodeRow(rowNumber,row,hints){const convertFNC1=hints&&(hints.get(DecodeHintType$1.ASSUME_GS1)===true);const startPatternInfo=Code128Reader.findStartPattern(row);const startCode=startPatternInfo[2];let currentRawCodesIndex=0;const rawCodes=new Uint8Array(20);rawCodes[currentRawCodesIndex++]=startCode;let codeSet;switch(startCode){case Code128Reader.CODE_START_A:codeSet=Code128Reader.CODE_CODE_A;break;case Code128Reader.CODE_START_B:codeSet=Code128Reader.CODE_CODE_B;break;case Code128Reader.CODE_START_C:codeSet=Code128Reader.CODE_CODE_C;break;default:throw new FormatException();}
let done=false;let isNextShifted=false;let result='';let lastStart=startPatternInfo[0];let nextStart=startPatternInfo[1];const counters=Int32Array.from([0,0,0,0,0,0]);let lastCode=0;let code=0;let checksumTotal=startCode;let multiplier=0;let lastCharacterWasPrintable=true;let upperMode=false;let shiftUpperMode=false;while(!done){const unshift=isNextShifted;isNextShifted=false;lastCode=code;code=Code128Reader.decodeCode(row,counters,nextStart);rawCodes[currentRawCodesIndex++]=code;if(code!==Code128Reader.CODE_STOP){lastCharacterWasPrintable=true;}
if(code!==Code128Reader.CODE_STOP){multiplier++;checksumTotal+=multiplier*code;}
lastStart=nextStart;nextStart+=counters.reduce((previous,current)=>previous+current,0);switch(code){case Code128Reader.CODE_START_A:case Code128Reader.CODE_START_B:case Code128Reader.CODE_START_C:throw new FormatException();}
switch(codeSet){case Code128Reader.CODE_CODE_A:if(code<64){if(shiftUpperMode===upperMode){result+=String.fromCharCode((' '.charCodeAt(0)+code));}
else{result+=String.fromCharCode((' '.charCodeAt(0)+code+128));}
shiftUpperMode=false;}
else if(code<96){if(shiftUpperMode===upperMode){result+=String.fromCharCode((code-64));}
else{result+=String.fromCharCode((code+64));}
shiftUpperMode=false;}
else{if(code!==Code128Reader.CODE_STOP){lastCharacterWasPrintable=false;}
switch(code){case Code128Reader.CODE_FNC_1:if(convertFNC1){if(result.length===0){result+=']C1';}
else{result+=String.fromCharCode(29);}}
break;case Code128Reader.CODE_FNC_2:case Code128Reader.CODE_FNC_3:break;case Code128Reader.CODE_FNC_4_A:if(!upperMode&&shiftUpperMode){upperMode=true;shiftUpperMode=false;}
else if(upperMode&&shiftUpperMode){upperMode=false;shiftUpperMode=false;}
else{shiftUpperMode=true;}
break;case Code128Reader.CODE_SHIFT:isNextShifted=true;codeSet=Code128Reader.CODE_CODE_B;break;case Code128Reader.CODE_CODE_B:codeSet=Code128Reader.CODE_CODE_B;break;case Code128Reader.CODE_CODE_C:codeSet=Code128Reader.CODE_CODE_C;break;case Code128Reader.CODE_STOP:done=true;break;}}
break;case Code128Reader.CODE_CODE_B:if(code<96){if(shiftUpperMode===upperMode){result+=String.fromCharCode((' '.charCodeAt(0)+code));}
else{result+=String.fromCharCode((' '.charCodeAt(0)+code+128));}
shiftUpperMode=false;}
else{if(code!==Code128Reader.CODE_STOP){lastCharacterWasPrintable=false;}
switch(code){case Code128Reader.CODE_FNC_1:if(convertFNC1){if(result.length===0){result+=']C1';}
else{result+=String.fromCharCode(29);}}
break;case Code128Reader.CODE_FNC_2:case Code128Reader.CODE_FNC_3:break;case Code128Reader.CODE_FNC_4_B:if(!upperMode&&shiftUpperMode){upperMode=true;shiftUpperMode=false;}
else if(upperMode&&shiftUpperMode){upperMode=false;shiftUpperMode=false;}
else{shiftUpperMode=true;}
break;case Code128Reader.CODE_SHIFT:isNextShifted=true;codeSet=Code128Reader.CODE_CODE_A;break;case Code128Reader.CODE_CODE_A:codeSet=Code128Reader.CODE_CODE_A;break;case Code128Reader.CODE_CODE_C:codeSet=Code128Reader.CODE_CODE_C;break;case Code128Reader.CODE_STOP:done=true;break;}}
break;case Code128Reader.CODE_CODE_C:if(code<100){if(code<10){result+='0';}
result+=code;}
else{if(code!==Code128Reader.CODE_STOP){lastCharacterWasPrintable=false;}
switch(code){case Code128Reader.CODE_FNC_1:if(convertFNC1){if(result.length===0){result+=']C1';}
else{result+=String.fromCharCode(29);}}
break;case Code128Reader.CODE_CODE_A:codeSet=Code128Reader.CODE_CODE_A;break;case Code128Reader.CODE_CODE_B:codeSet=Code128Reader.CODE_CODE_B;break;case Code128Reader.CODE_STOP:done=true;break;}}
break;}
if(unshift){codeSet=codeSet===Code128Reader.CODE_CODE_A?Code128Reader.CODE_CODE_B:Code128Reader.CODE_CODE_A;}}
const lastPatternSize=nextStart-lastStart;nextStart=row.getNextUnset(nextStart);if(!row.isRange(nextStart,Math.min(row.getSize(),nextStart+(nextStart-lastStart)/2),false)){throw new NotFoundException();}
checksumTotal-=multiplier*lastCode;if(checksumTotal%103!==lastCode){throw new ChecksumException();}
const resultLength=result.length;if(resultLength===0){throw new NotFoundException();}
if(resultLength>0&&lastCharacterWasPrintable){if(codeSet===Code128Reader.CODE_CODE_C){result=result.substring(0,resultLength-2);}
else{result=result.substring(0,resultLength-1);}}
const left=(startPatternInfo[1]+startPatternInfo[0])/2.0;const right=lastStart+lastPatternSize/2.0;const rawCodesSize=rawCodes.length;const rawBytes=new Uint8Array(rawCodesSize);for(let i=0;i<rawCodesSize;i++){rawBytes[i]=rawCodes[i];}
const points=[new ResultPoint(left,rowNumber),new ResultPoint(right,rowNumber)];return new Result(result,rawBytes,0,points,BarcodeFormat$1.CODE_128,new Date().getTime());}}
Code128Reader.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2]),];Code128Reader.MAX_AVG_VARIANCE=0.25;Code128Reader.MAX_INDIVIDUAL_VARIANCE=0.7;Code128Reader.CODE_SHIFT=98;Code128Reader.CODE_CODE_C=99;Code128Reader.CODE_CODE_B=100;Code128Reader.CODE_CODE_A=101;Code128Reader.CODE_FNC_1=102;Code128Reader.CODE_FNC_2=97;Code128Reader.CODE_FNC_3=96;Code128Reader.CODE_FNC_4_A=101;Code128Reader.CODE_FNC_4_B=100;Code128Reader.CODE_START_A=103;Code128Reader.CODE_START_B=104;Code128Reader.CODE_START_C=105;Code128Reader.CODE_STOP=106;class Code39Reader extends OneDReader{constructor(usingCheckDigit=false,extendedMode=false){super();this.usingCheckDigit=usingCheckDigit;this.extendedMode=extendedMode;this.decodeRowResult='';this.counters=new Int32Array(9);}
decodeRow(rowNumber,row,hints){let theCounters=this.counters;theCounters.fill(0);this.decodeRowResult='';let start=Code39Reader.findAsteriskPattern(row,theCounters);let nextStart=row.getNextSet(start[1]);let end=row.getSize();let decodedChar;let lastStart;do{Code39Reader.recordPattern(row,nextStart,theCounters);let pattern=Code39Reader.toNarrowWidePattern(theCounters);if(pattern<0){throw new NotFoundException();}
decodedChar=Code39Reader.patternToChar(pattern);this.decodeRowResult+=decodedChar;lastStart=nextStart;for(let counter of theCounters){nextStart+=counter;}
nextStart=row.getNextSet(nextStart);}while(decodedChar!=='*');this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let lastPatternSize=0;for(let counter of theCounters){lastPatternSize+=counter;}
let whiteSpaceAfterEnd=nextStart-lastStart-lastPatternSize;if(nextStart!==end&&(whiteSpaceAfterEnd*2)<lastPatternSize){throw new NotFoundException();}
if(this.usingCheckDigit){let max=this.decodeRowResult.length-1;let total=0;for(let i=0;i<max;i++){total+=Code39Reader.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(i));}
if(this.decodeRowResult.charAt(max)!==Code39Reader.ALPHABET_STRING.charAt(total%43)){throw new ChecksumException();}
this.decodeRowResult=this.decodeRowResult.substring(0,max);}
if(this.decodeRowResult.length===0){throw new NotFoundException();}
let resultString;if(this.extendedMode){resultString=Code39Reader.decodeExtended(this.decodeRowResult);}
else{resultString=this.decodeRowResult;}
let left=(start[1]+start[0])/2.0;let right=lastStart+lastPatternSize/2.0;return new Result(resultString,null,0,[new ResultPoint(left,rowNumber),new ResultPoint(right,rowNumber)],BarcodeFormat$1.CODE_39,new Date().getTime());}
static findAsteriskPattern(row,counters){let width=row.getSize();let rowOffset=row.getNextSet(0);let counterPosition=0;let patternStart=rowOffset;let isWhite=false;let patternLength=counters.length;for(let i=rowOffset;i<width;i++){if(row.get(i)!==isWhite){counters[counterPosition]++;}
else{if(counterPosition===patternLength-1){if(this.toNarrowWidePattern(counters)===Code39Reader.ASTERISK_ENCODING&&row.isRange(Math.max(0,patternStart-Math.floor((i-patternStart)/2)),patternStart,false)){return[patternStart,i];}
patternStart+=counters[0]+counters[1];counters.copyWithin(0,2,2+counterPosition-1);counters[counterPosition-1]=0;counters[counterPosition]=0;counterPosition--;}
else{counterPosition++;}
counters[counterPosition]=1;isWhite=!isWhite;}}
throw new NotFoundException();}
static toNarrowWidePattern(counters){let numCounters=counters.length;let maxNarrowCounter=0;let wideCounters;do{let minCounter=0x7fffffff;for(let counter of counters){if(counter<minCounter&&counter>maxNarrowCounter){minCounter=counter;}}
maxNarrowCounter=minCounter;wideCounters=0;let totalWideCountersWidth=0;let pattern=0;for(let i=0;i<numCounters;i++){let counter=counters[i];if(counter>maxNarrowCounter){pattern|=1<<(numCounters-1-i);wideCounters++;totalWideCountersWidth+=counter;}}
if(wideCounters===3){for(let i=0;i<numCounters&&wideCounters>0;i++){let counter=counters[i];if(counter>maxNarrowCounter){wideCounters--;if((counter*2)>=totalWideCountersWidth){return-1;}}}
return pattern;}}while(wideCounters>3);return-1;}
static patternToChar(pattern){for(let i=0;i<Code39Reader.CHARACTER_ENCODINGS.length;i++){if(Code39Reader.CHARACTER_ENCODINGS[i]===pattern){return Code39Reader.ALPHABET_STRING.charAt(i);}}
if(pattern===Code39Reader.ASTERISK_ENCODING){return'*';}
throw new NotFoundException();}
static decodeExtended(encoded){let length=encoded.length;let decoded='';for(let i=0;i<length;i++){let c=encoded.charAt(i);if(c==='+'||c==='$'||c==='%'||c==='/'){let next=encoded.charAt(i+1);let decodedChar='\0';switch(c){case'+':if(next>='A'&&next<='Z'){decodedChar=String.fromCharCode(next.charCodeAt(0)+32);}
else{throw new FormatException();}
break;case'$':if(next>='A'&&next<='Z'){decodedChar=String.fromCharCode(next.charCodeAt(0)-64);}
else{throw new FormatException();}
break;case'%':if(next>='A'&&next<='E'){decodedChar=String.fromCharCode(next.charCodeAt(0)-38);}
else if(next>='F'&&next<='J'){decodedChar=String.fromCharCode(next.charCodeAt(0)-11);}
else if(next>='K'&&next<='O'){decodedChar=String.fromCharCode(next.charCodeAt(0)+16);}
else if(next>='P'&&next<='T'){decodedChar=String.fromCharCode(next.charCodeAt(0)+43);}
else if(next==='U'){decodedChar='\0';}
else if(next==='V'){decodedChar='@';}
else if(next==='W'){decodedChar='`';}
else if(next==='X'||next==='Y'||next==='Z'){decodedChar='\x7f';}
else{throw new FormatException();}
break;case'/':if(next>='A'&&next<='O'){decodedChar=String.fromCharCode(next.charCodeAt(0)-32);}
else if(next==='Z'){decodedChar=':';}
else{throw new FormatException();}
break;}
decoded+=decodedChar;i++;}
else{decoded+=c;}}
return decoded;}}
Code39Reader.ALPHABET_STRING='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%';Code39Reader.CHARACTER_ENCODINGS=[0x034,0x121,0x061,0x160,0x031,0x130,0x070,0x025,0x124,0x064,0x109,0x049,0x148,0x019,0x118,0x058,0x00D,0x10C,0x04C,0x01C,0x103,0x043,0x142,0x013,0x112,0x052,0x007,0x106,0x046,0x016,0x181,0x0C1,0x1C0,0x091,0x190,0x0D0,0x085,0x184,0x0C4,0x0A8,0x0A2,0x08A,0x02A];Code39Reader.ASTERISK_ENCODING=0x094;class ITFReader extends OneDReader{constructor(){super(...arguments);this.narrowLineWidth=-1;}
decodeRow(rowNumber,row,hints){let startRange=this.decodeStart(row);let endRange=this.decodeEnd(row);let result=new StringBuilder();ITFReader.decodeMiddle(row,startRange[1],endRange[0],result);let resultString=result.toString();let allowedLengths=null;if(hints!=null){allowedLengths=hints.get(DecodeHintType$1.ALLOWED_LENGTHS);}
if(allowedLengths==null){allowedLengths=ITFReader.DEFAULT_ALLOWED_LENGTHS;}
let length=resultString.length;let lengthOK=false;let maxAllowedLength=0;for(let value of allowedLengths){if(length===value){lengthOK=true;break;}
if(value>maxAllowedLength){maxAllowedLength=value;}}
if(!lengthOK&&length>maxAllowedLength){lengthOK=true;}
if(!lengthOK){throw new FormatException();}
const points=[new ResultPoint(startRange[1],rowNumber),new ResultPoint(endRange[0],rowNumber)];let resultReturn=new Result(resultString,null,0,points,BarcodeFormat$1.ITF,new Date().getTime());return resultReturn;}
static decodeMiddle(row,payloadStart,payloadEnd,resultString){let counterDigitPair=new Int32Array(10);let counterBlack=new Int32Array(5);let counterWhite=new Int32Array(5);counterDigitPair.fill(0);counterBlack.fill(0);counterWhite.fill(0);while(payloadStart<payloadEnd){OneDReader.recordPattern(row,payloadStart,counterDigitPair);for(let k=0;k<5;k++){let twoK=2*k;counterBlack[k]=counterDigitPair[twoK];counterWhite[k]=counterDigitPair[twoK+1];}
let bestMatch=ITFReader.decodeDigit(counterBlack);resultString.append(bestMatch.toString());bestMatch=this.decodeDigit(counterWhite);resultString.append(bestMatch.toString());counterDigitPair.forEach(function(counterDigit){payloadStart+=counterDigit;});}}
decodeStart(row){let endStart=ITFReader.skipWhiteSpace(row);let startPattern=ITFReader.findGuardPattern(row,endStart,ITFReader.START_PATTERN);this.narrowLineWidth=(startPattern[1]-startPattern[0])/4;this.validateQuietZone(row,startPattern[0]);return startPattern;}
validateQuietZone(row,startPattern){let quietCount=this.narrowLineWidth*10;quietCount=quietCount<startPattern?quietCount:startPattern;for(let i=startPattern-1;quietCount>0&&i>=0;i--){if(row.get(i)){break;}
quietCount--;}
if(quietCount!==0){throw new NotFoundException();}}
static skipWhiteSpace(row){const width=row.getSize();const endStart=row.getNextSet(0);if(endStart===width){throw new NotFoundException();}
return endStart;}
decodeEnd(row){row.reverse();try{let endStart=ITFReader.skipWhiteSpace(row);let endPattern;try{endPattern=ITFReader.findGuardPattern(row,endStart,ITFReader.END_PATTERN_REVERSED[0]);}
catch(error){if(error instanceof NotFoundException){endPattern=ITFReader.findGuardPattern(row,endStart,ITFReader.END_PATTERN_REVERSED[1]);}}
this.validateQuietZone(row,endPattern[0]);let temp=endPattern[0];endPattern[0]=row.getSize()-endPattern[1];endPattern[1]=row.getSize()-temp;return endPattern;}
finally{row.reverse();}}
static findGuardPattern(row,rowOffset,pattern){let patternLength=pattern.length;let counters=new Int32Array(patternLength);let width=row.getSize();let isWhite=false;let counterPosition=0;let patternStart=rowOffset;counters.fill(0);for(let x=rowOffset;x<width;x++){if(row.get(x)!==isWhite){counters[counterPosition]++;}
else{if(counterPosition===patternLength-1){if(OneDReader.patternMatchVariance(counters,pattern,ITFReader.MAX_INDIVIDUAL_VARIANCE)<ITFReader.MAX_AVG_VARIANCE){return[patternStart,x];}
patternStart+=counters[0]+counters[1];System.arraycopy(counters,2,counters,0,counterPosition-1);counters[counterPosition-1]=0;counters[counterPosition]=0;counterPosition--;}
else{counterPosition++;}
counters[counterPosition]=1;isWhite=!isWhite;}}
throw new NotFoundException();}
static decodeDigit(counters){let bestVariance=ITFReader.MAX_AVG_VARIANCE;let bestMatch=-1;let max=ITFReader.PATTERNS.length;for(let i=0;i<max;i++){let pattern=ITFReader.PATTERNS[i];let variance=OneDReader.patternMatchVariance(counters,pattern,ITFReader.MAX_INDIVIDUAL_VARIANCE);if(variance<bestVariance){bestVariance=variance;bestMatch=i;}
else if(variance===bestVariance){bestMatch=-1;}}
if(bestMatch>=0){return bestMatch%10;}
else{throw new NotFoundException();}}}
ITFReader.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])];ITFReader.MAX_AVG_VARIANCE=0.38;ITFReader.MAX_INDIVIDUAL_VARIANCE=0.5;ITFReader.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14];ITFReader.START_PATTERN=Int32Array.from([1,1,1,1]);ITFReader.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class AbstractUPCEANReader extends OneDReader{constructor(){super(...arguments);this.decodeRowStringBuffer='';}
static findStartGuardPattern(row){let foundStart=false;let startRange;let nextStart=0;let counters=Int32Array.from([0,0,0]);while(!foundStart){counters=Int32Array.from([0,0,0]);startRange=AbstractUPCEANReader.findGuardPattern(row,nextStart,false,this.START_END_PATTERN,counters);let start=startRange[0];nextStart=startRange[1];let quietStart=start-(nextStart-start);if(quietStart>=0){foundStart=row.isRange(quietStart,start,false);}}
return startRange;}
static checkChecksum(s){return AbstractUPCEANReader.checkStandardUPCEANChecksum(s);}
static checkStandardUPCEANChecksum(s){let length=s.length;if(length===0)
return false;let check=parseInt(s.charAt(length-1),10);return AbstractUPCEANReader.getStandardUPCEANChecksum(s.substring(0,length-1))===check;}
static getStandardUPCEANChecksum(s){let length=s.length;let sum=0;for(let i=length-1;i>=0;i-=2){let digit=s.charAt(i).charCodeAt(0)-'0'.charCodeAt(0);if(digit<0||digit>9){throw new FormatException();}
sum+=digit;}
sum*=3;for(let i=length-2;i>=0;i-=2){let digit=s.charAt(i).charCodeAt(0)-'0'.charCodeAt(0);if(digit<0||digit>9){throw new FormatException();}
sum+=digit;}
return(1000-sum)%10;}
static decodeEnd(row,endStart){return AbstractUPCEANReader.findGuardPattern(row,endStart,false,AbstractUPCEANReader.START_END_PATTERN,new Int32Array(AbstractUPCEANReader.START_END_PATTERN.length).fill(0));}
static findGuardPatternWithoutCounters(row,rowOffset,whiteFirst,pattern){return this.findGuardPattern(row,rowOffset,whiteFirst,pattern,new Int32Array(pattern.length));}
static findGuardPattern(row,rowOffset,whiteFirst,pattern,counters){let width=row.getSize();rowOffset=whiteFirst?row.getNextUnset(rowOffset):row.getNextSet(rowOffset);let counterPosition=0;let patternStart=rowOffset;let patternLength=pattern.length;let isWhite=whiteFirst;for(let x=rowOffset;x<width;x++){if(row.get(x)!==isWhite){counters[counterPosition]++;}
else{if(counterPosition===patternLength-1){if(OneDReader.patternMatchVariance(counters,pattern,AbstractUPCEANReader.MAX_INDIVIDUAL_VARIANCE)<AbstractUPCEANReader.MAX_AVG_VARIANCE){return Int32Array.from([patternStart,x]);}
patternStart+=counters[0]+counters[1];let slice=counters.slice(2,counters.length-1);for(let i=0;i<counterPosition-1;i++){counters[i]=slice[i];}
counters[counterPosition-1]=0;counters[counterPosition]=0;counterPosition--;}
else{counterPosition++;}
counters[counterPosition]=1;isWhite=!isWhite;}}
throw new NotFoundException();}
static decodeDigit(row,counters,rowOffset,patterns){this.recordPattern(row,rowOffset,counters);let bestVariance=this.MAX_AVG_VARIANCE;let bestMatch=-1;let max=patterns.length;for(let i=0;i<max;i++){let pattern=patterns[i];let variance=OneDReader.patternMatchVariance(counters,pattern,AbstractUPCEANReader.MAX_INDIVIDUAL_VARIANCE);if(variance<bestVariance){bestVariance=variance;bestMatch=i;}}
if(bestMatch>=0){return bestMatch;}
else{throw new NotFoundException();}}}
AbstractUPCEANReader.MAX_AVG_VARIANCE=0.48;AbstractUPCEANReader.MAX_INDIVIDUAL_VARIANCE=0.7;AbstractUPCEANReader.START_END_PATTERN=Int32Array.from([1,1,1]);AbstractUPCEANReader.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]);AbstractUPCEANReader.END_PATTERN=Int32Array.from([1,1,1,1,1,1]);AbstractUPCEANReader.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2]),];class UPCEANExtension5Support{constructor(){this.CHECK_DIGIT_ENCODINGS=[0x18,0x14,0x12,0x11,0x0C,0x06,0x03,0x0A,0x09,0x05];this.decodeMiddleCounters=Int32Array.from([0,0,0,0]);this.decodeRowStringBuffer='';}
decodeRow(rowNumber,row,extensionStartRange){let result=this.decodeRowStringBuffer;let end=this.decodeMiddle(row,extensionStartRange,result);let resultString=result.toString();let extensionData=UPCEANExtension5Support.parseExtensionString(resultString);let resultPoints=[new ResultPoint((extensionStartRange[0]+extensionStartRange[1])/2.0,rowNumber),new ResultPoint(end,rowNumber)];let extensionResult=new Result(resultString,null,0,resultPoints,BarcodeFormat$1.UPC_EAN_EXTENSION,new Date().getTime());if(extensionData!=null){extensionResult.putAllMetadata(extensionData);}
return extensionResult;}
decodeMiddle(row,startRange,resultString){let counters=this.decodeMiddleCounters;counters[0]=0;counters[1]=0;counters[2]=0;counters[3]=0;let end=row.getSize();let rowOffset=startRange[1];let lgPatternFound=0;for(let x=0;x<5&&rowOffset<end;x++){let bestMatch=AbstractUPCEANReader.decodeDigit(row,counters,rowOffset,AbstractUPCEANReader.L_AND_G_PATTERNS);resultString+=String.fromCharCode(('0'.charCodeAt(0)+bestMatch%10));for(let counter of counters){rowOffset+=counter;}
if(bestMatch>=10){lgPatternFound|=1<<(4-x);}
if(x!==4){rowOffset=row.getNextSet(rowOffset);rowOffset=row.getNextUnset(rowOffset);}}
if(resultString.length!==5){throw new NotFoundException();}
let checkDigit=this.determineCheckDigit(lgPatternFound);if(UPCEANExtension5Support.extensionChecksum(resultString.toString())!==checkDigit){throw new NotFoundException();}
return rowOffset;}
static extensionChecksum(s){let length=s.length;let sum=0;for(let i=length-2;i>=0;i-=2){sum+=s.charAt(i).charCodeAt(0)-'0'.charCodeAt(0);}
sum*=3;for(let i=length-1;i>=0;i-=2){sum+=s.charAt(i).charCodeAt(0)-'0'.charCodeAt(0);}
sum*=3;return sum%10;}
determineCheckDigit(lgPatternFound){for(let d=0;d<10;d++){if(lgPatternFound===this.CHECK_DIGIT_ENCODINGS[d]){return d;}}
throw new NotFoundException();}
static parseExtensionString(raw){if(raw.length!==5){return null;}
let value=UPCEANExtension5Support.parseExtension5String(raw);if(value==null){return null;}
return new Map([[ResultMetadataType$1.SUGGESTED_PRICE,value]]);}
static parseExtension5String(raw){let currency;switch(raw.charAt(0)){case'0':currency='';break;case'5':currency='$';break;case'9':switch(raw){case'90000':return null;case'99991':return'0.00';case'99990':return'Used';}
currency='';break;default:currency='';break;}
let rawAmount=parseInt(raw.substring(1));let unitsString=(rawAmount/100).toString();let hundredths=rawAmount%100;let hundredthsString=hundredths<10?'0'+hundredths:hundredths.toString();return currency+unitsString+'.'+hundredthsString;}}
class UPCEANExtension2Support{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]);this.decodeRowStringBuffer='';}
decodeRow(rowNumber,row,extensionStartRange){let result=this.decodeRowStringBuffer;let end=this.decodeMiddle(row,extensionStartRange,result);let resultString=result.toString();let extensionData=UPCEANExtension2Support.parseExtensionString(resultString);let resultPoints=[new ResultPoint((extensionStartRange[0]+extensionStartRange[1])/2.0,rowNumber),new ResultPoint(end,rowNumber)];let extensionResult=new Result(resultString,null,0,resultPoints,BarcodeFormat$1.UPC_EAN_EXTENSION,new Date().getTime());if(extensionData!=null){extensionResult.putAllMetadata(extensionData);}
return extensionResult;}
decodeMiddle(row,startRange,resultString){let counters=this.decodeMiddleCounters;counters[0]=0;counters[1]=0;counters[2]=0;counters[3]=0;let end=row.getSize();let rowOffset=startRange[1];let checkParity=0;for(let x=0;x<2&&rowOffset<end;x++){let bestMatch=AbstractUPCEANReader.decodeDigit(row,counters,rowOffset,AbstractUPCEANReader.L_AND_G_PATTERNS);resultString+=String.fromCharCode(('0'.charCodeAt(0)+bestMatch%10));for(let counter of counters){rowOffset+=counter;}
if(bestMatch>=10){checkParity|=1<<(1-x);}
if(x!==1){rowOffset=row.getNextSet(rowOffset);rowOffset=row.getNextUnset(rowOffset);}}
if(resultString.length!==2){throw new NotFoundException();}
if(parseInt(resultString.toString())%4!==checkParity){throw new NotFoundException();}
return rowOffset;}
static parseExtensionString(raw){if(raw.length!==2){return null;}
return new Map([[ResultMetadataType$1.ISSUE_NUMBER,parseInt(raw)]]);}}
class UPCEANExtensionSupport{static decodeRow(rowNumber,row,rowOffset){let extensionStartRange=AbstractUPCEANReader.findGuardPattern(row,rowOffset,false,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{let fiveSupport=new UPCEANExtension5Support();return fiveSupport.decodeRow(rowNumber,row,extensionStartRange);}
catch(err){let twoSupport=new UPCEANExtension2Support();return twoSupport.decodeRow(rowNumber,row,extensionStartRange);}}}
UPCEANExtensionSupport.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class UPCEANReader extends AbstractUPCEANReader{constructor(){super();this.decodeRowStringBuffer='';UPCEANReader.L_AND_G_PATTERNS=UPCEANReader.L_PATTERNS.map(arr=>Int32Array.from(arr));for(let i=10;i<20;i++){let widths=UPCEANReader.L_PATTERNS[i-10];let reversedWidths=new Int32Array(widths.length);for(let j=0;j<widths.length;j++){reversedWidths[j]=widths[widths.length-j-1];}
UPCEANReader.L_AND_G_PATTERNS[i]=reversedWidths;}}
decodeRow(rowNumber,row,hints){let startGuardRange=UPCEANReader.findStartGuardPattern(row);let resultPointCallback=hints==null?null:hints.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);if(resultPointCallback!=null){const resultPoint=new ResultPoint((startGuardRange[0]+startGuardRange[1])/2.0,rowNumber);resultPointCallback.foundPossibleResultPoint(resultPoint);}
let budello=this.decodeMiddle(row,startGuardRange,this.decodeRowStringBuffer);let endStart=budello.rowOffset;let result=budello.resultString;if(resultPointCallback!=null){const resultPoint=new ResultPoint(endStart,rowNumber);resultPointCallback.foundPossibleResultPoint(resultPoint);}
let endRange=UPCEANReader.decodeEnd(row,endStart);if(resultPointCallback!=null){const resultPoint=new ResultPoint((endRange[0]+endRange[1])/2.0,rowNumber);resultPointCallback.foundPossibleResultPoint(resultPoint);}
let end=endRange[1];let quietEnd=end+(end-endRange[0]);if(quietEnd>=row.getSize()||!row.isRange(end,quietEnd,false)){throw new NotFoundException();}
let resultString=result.toString();if(resultString.length<8){throw new FormatException();}
if(!UPCEANReader.checkChecksum(resultString)){throw new ChecksumException();}
let left=(startGuardRange[1]+startGuardRange[0])/2.0;let right=(endRange[1]+endRange[0])/2.0;let format=this.getBarcodeFormat();let resultPoint=[new ResultPoint(left,rowNumber),new ResultPoint(right,rowNumber)];let decodeResult=new Result(resultString,null,0,resultPoint,format,new Date().getTime());let extensionLength=0;try{let extensionResult=UPCEANExtensionSupport.decodeRow(rowNumber,row,endRange[1]);decodeResult.putMetadata(ResultMetadataType$1.UPC_EAN_EXTENSION,extensionResult.getText());decodeResult.putAllMetadata(extensionResult.getResultMetadata());decodeResult.addResultPoints(extensionResult.getResultPoints());extensionLength=extensionResult.getText().length;}
catch(err){}
let allowedExtensions=hints==null?null:hints.get(DecodeHintType$1.ALLOWED_EAN_EXTENSIONS);if(allowedExtensions!=null){let valid=false;for(let length in allowedExtensions){if(extensionLength.toString()===length){valid=true;break;}}
if(!valid){throw new NotFoundException();}}
if(format===BarcodeFormat$1.EAN_13||format===BarcodeFormat$1.UPC_A);return decodeResult;}
static checkChecksum(s){return UPCEANReader.checkStandardUPCEANChecksum(s);}
static checkStandardUPCEANChecksum(s){let length=s.length;if(length===0)
return false;let check=parseInt(s.charAt(length-1),10);return UPCEANReader.getStandardUPCEANChecksum(s.substring(0,length-1))===check;}
static getStandardUPCEANChecksum(s){let length=s.length;let sum=0;for(let i=length-1;i>=0;i-=2){let digit=s.charAt(i).charCodeAt(0)-'0'.charCodeAt(0);if(digit<0||digit>9){throw new FormatException();}
sum+=digit;}
sum*=3;for(let i=length-2;i>=0;i-=2){let digit=s.charAt(i).charCodeAt(0)-'0'.charCodeAt(0);if(digit<0||digit>9){throw new FormatException();}
sum+=digit;}
return(1000-sum)%10;}
static decodeEnd(row,endStart){return UPCEANReader.findGuardPattern(row,endStart,false,UPCEANReader.START_END_PATTERN,new Int32Array(UPCEANReader.START_END_PATTERN.length).fill(0));}}
class EAN13Reader extends UPCEANReader{constructor(){super();this.decodeMiddleCounters=Int32Array.from([0,0,0,0]);}
decodeMiddle(row,startRange,resultString){let counters=this.decodeMiddleCounters;counters[0]=0;counters[1]=0;counters[2]=0;counters[3]=0;let end=row.getSize();let rowOffset=startRange[1];let lgPatternFound=0;for(let x=0;x<6&&rowOffset<end;x++){let bestMatch=UPCEANReader.decodeDigit(row,counters,rowOffset,UPCEANReader.L_AND_G_PATTERNS);resultString+=String.fromCharCode(('0'.charCodeAt(0)+bestMatch%10));for(let counter of counters){rowOffset+=counter;}
if(bestMatch>=10){lgPatternFound|=1<<(5-x);}}
resultString=EAN13Reader.determineFirstDigit(resultString,lgPatternFound);let middleRange=UPCEANReader.findGuardPattern(row,rowOffset,true,UPCEANReader.MIDDLE_PATTERN,new Int32Array(UPCEANReader.MIDDLE_PATTERN.length).fill(0));rowOffset=middleRange[1];for(let x=0;x<6&&rowOffset<end;x++){let bestMatch=UPCEANReader.decodeDigit(row,counters,rowOffset,UPCEANReader.L_PATTERNS);resultString+=String.fromCharCode(('0'.charCodeAt(0)+bestMatch));for(let counter of counters){rowOffset+=counter;}}
return{rowOffset,resultString};}
getBarcodeFormat(){return BarcodeFormat$1.EAN_13;}
static determineFirstDigit(resultString,lgPatternFound){for(let d=0;d<10;d++){if(lgPatternFound===this.FIRST_DIGIT_ENCODINGS[d]){resultString=String.fromCharCode(('0'.charCodeAt(0)+d))+resultString;return resultString;}}
throw new NotFoundException();}}
EAN13Reader.FIRST_DIGIT_ENCODINGS=[0x00,0x0B,0x0D,0xE,0x13,0x19,0x1C,0x15,0x16,0x1A];class EAN8Reader extends UPCEANReader{constructor(){super();this.decodeMiddleCounters=Int32Array.from([0,0,0,0]);}
decodeMiddle(row,startRange,resultString){const counters=this.decodeMiddleCounters;counters[0]=0;counters[1]=0;counters[2]=0;counters[3]=0;let end=row.getSize();let rowOffset=startRange[1];for(let x=0;x<4&&rowOffset<end;x++){let bestMatch=UPCEANReader.decodeDigit(row,counters,rowOffset,UPCEANReader.L_PATTERNS);resultString+=String.fromCharCode(('0'.charCodeAt(0)+bestMatch));for(let counter of counters){rowOffset+=counter;}}
let middleRange=UPCEANReader.findGuardPattern(row,rowOffset,true,UPCEANReader.MIDDLE_PATTERN,new Int32Array(UPCEANReader.MIDDLE_PATTERN.length).fill(0));rowOffset=middleRange[1];for(let x=0;x<4&&rowOffset<end;x++){let bestMatch=UPCEANReader.decodeDigit(row,counters,rowOffset,UPCEANReader.L_PATTERNS);resultString+=String.fromCharCode(('0'.charCodeAt(0)+bestMatch));for(let counter of counters){rowOffset+=counter;}}
return{rowOffset,resultString};}
getBarcodeFormat(){return BarcodeFormat$1.EAN_8;}}
class UPCAReader extends UPCEANReader{constructor(){super(...arguments);this.ean13Reader=new EAN13Reader();}
getBarcodeFormat(){return BarcodeFormat$1.UPC_A;}
decode(image,hints){return this.maybeReturnResult(this.ean13Reader.decode(image));}
decodeRow(rowNumber,row,hints){return this.maybeReturnResult(this.ean13Reader.decodeRow(rowNumber,row,hints));}
decodeMiddle(row,startRange,resultString){return this.ean13Reader.decodeMiddle(row,startRange,resultString);}
maybeReturnResult(result){let text=result.getText();if(text.charAt(0)==='0'){let upcaResult=new Result(text.substring(1),null,null,result.getResultPoints(),BarcodeFormat$1.UPC_A);if(result.getResultMetadata()!=null){upcaResult.putAllMetadata(result.getResultMetadata());}
return upcaResult;}
else{throw new NotFoundException();}}
reset(){this.ean13Reader.reset();}}
class UPCEReader extends UPCEANReader{constructor(){super();this.decodeMiddleCounters=new Int32Array(4);}
decodeMiddle(row,startRange,result){const counters=this.decodeMiddleCounters.map(x=>x);counters[0]=0;counters[1]=0;counters[2]=0;counters[3]=0;const end=row.getSize();let rowOffset=startRange[1];let lgPatternFound=0;for(let x=0;x<6&&rowOffset<end;x++){const bestMatch=UPCEReader.decodeDigit(row,counters,rowOffset,UPCEReader.L_AND_G_PATTERNS);result+=String.fromCharCode(('0'.charCodeAt(0)+bestMatch%10));for(let counter of counters){rowOffset+=counter;}
if(bestMatch>=10){lgPatternFound|=1<<(5-x);}}
UPCEReader.determineNumSysAndCheckDigit(new StringBuilder(result),lgPatternFound);return rowOffset;}
decodeEnd(row,endStart){return UPCEReader.findGuardPatternWithoutCounters(row,endStart,true,UPCEReader.MIDDLE_END_PATTERN);}
checkChecksum(s){return UPCEANReader.checkChecksum(UPCEReader.convertUPCEtoUPCA(s));}
static determineNumSysAndCheckDigit(resultString,lgPatternFound){for(let numSys=0;numSys<=1;numSys++){for(let d=0;d<10;d++){if(lgPatternFound===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[numSys][d]){resultString.insert(0,('0'+numSys));resultString.append(('0'+d));return;}}}
throw NotFoundException.getNotFoundInstance();}
getBarcodeFormat(){return BarcodeFormat$1.UPC_E;}
static convertUPCEtoUPCA(upce){const upceChars=upce.slice(1,7).split('').map(x=>x.charCodeAt(0));const result=new StringBuilder();result.append(upce.charAt(0));let lastChar=upceChars[5];switch(lastChar){case 0:case 1:case 2:result.appendChars(upceChars,0,2);result.append(lastChar);result.append('0000');result.appendChars(upceChars,2,3);break;case 3:result.appendChars(upceChars,0,3);result.append('00000');result.appendChars(upceChars,3,2);break;case 4:result.appendChars(upceChars,0,4);result.append('00000');result.append(upceChars[4]);break;default:result.appendChars(upceChars,0,5);result.append('0000');result.append(lastChar);break;}
if(upce.length>=8){result.append(upce.charAt(7));}
return result.toString();}}
UPCEReader.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]);UPCEReader.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([0x38,0x34,0x32,0x31,0x2C,0x26,0x23,0x2A,0x29,0x25]),Int32Array.from([0x07,0x0B,0x0D,0x0E,0x13,0x19,0x1C,0x15,0x16,0x1]),];class MultiFormatUPCEANReader extends OneDReader{constructor(hints){super();let possibleFormats=hints==null?null:hints.get(DecodeHintType$1.POSSIBLE_FORMATS);let readers=[];if(possibleFormats!=null){if(possibleFormats.indexOf(BarcodeFormat$1.EAN_13)>-1){readers.push(new EAN13Reader());}
if(possibleFormats.indexOf(BarcodeFormat$1.UPC_A)>-1){readers.push(new UPCAReader());}
if(possibleFormats.indexOf(BarcodeFormat$1.EAN_8)>-1){readers.push(new EAN8Reader());}
if(possibleFormats.indexOf(BarcodeFormat$1.UPC_E)>-1){readers.push(new UPCEReader());}}
if(readers.length===0){readers.push(new EAN13Reader());readers.push(new UPCAReader());readers.push(new EAN8Reader());readers.push(new UPCEReader());}
this.readers=readers;}
decodeRow(rowNumber,row,hints){for(let reader of this.readers){try{const result=reader.decodeRow(rowNumber,row,hints);const ean13MayBeUPCA=result.getBarcodeFormat()===BarcodeFormat$1.EAN_13&&result.getText().charAt(0)==='0';const possibleFormats=hints==null?null:hints.get(DecodeHintType$1.POSSIBLE_FORMATS);const canReturnUPCA=possibleFormats==null||possibleFormats.includes(BarcodeFormat$1.UPC_A);if(ean13MayBeUPCA&&canReturnUPCA){const rawBytes=result.getRawBytes();const resultUPCA=new Result(result.getText().substring(1),rawBytes,(rawBytes?rawBytes.length:null),result.getResultPoints(),BarcodeFormat$1.UPC_A);resultUPCA.putAllMetadata(result.getResultMetadata());return resultUPCA;}
return result;}
catch(err){}}
throw new NotFoundException();}
reset(){for(let reader of this.readers){reader.reset();}}}
class AbstractRSSReader extends OneDReader{constructor(){super();this.decodeFinderCounters=new Int32Array(4);this.dataCharacterCounters=new Int32Array(8);this.oddRoundingErrors=new Array(4);this.evenRoundingErrors=new Array(4);this.oddCounts=new Array(this.dataCharacterCounters.length/2);this.evenCounts=new Array(this.dataCharacterCounters.length/2);}
getDecodeFinderCounters(){return this.decodeFinderCounters;}
getDataCharacterCounters(){return this.dataCharacterCounters;}
getOddRoundingErrors(){return this.oddRoundingErrors;}
getEvenRoundingErrors(){return this.evenRoundingErrors;}
getOddCounts(){return this.oddCounts;}
getEvenCounts(){return this.evenCounts;}
parseFinderValue(counters,finderPatterns){for(let value=0;value<finderPatterns.length;value++){if(OneDReader.patternMatchVariance(counters,finderPatterns[value],AbstractRSSReader.MAX_INDIVIDUAL_VARIANCE)<AbstractRSSReader.MAX_AVG_VARIANCE){return value;}}
throw new NotFoundException();}
static count(array){return MathUtils.sum(new Int32Array(array));}
static increment(array,errors){let index=0;let biggestError=errors[0];for(let i=1;i<array.length;i++){if(errors[i]>biggestError){biggestError=errors[i];index=i;}}
array[index]++;}
static decrement(array,errors){let index=0;let biggestError=errors[0];for(let i=1;i<array.length;i++){if(errors[i]<biggestError){biggestError=errors[i];index=i;}}
array[index]--;}
static isFinderPattern(counters){let firstTwoSum=counters[0]+counters[1];let sum=firstTwoSum+counters[2]+counters[3];let ratio=firstTwoSum/sum;if(ratio>=AbstractRSSReader.MIN_FINDER_PATTERN_RATIO&&ratio<=AbstractRSSReader.MAX_FINDER_PATTERN_RATIO){let minCounter=Number.MAX_SAFE_INTEGER;let maxCounter=Number.MIN_SAFE_INTEGER;for(let counter of counters){if(counter>maxCounter){maxCounter=counter;}
if(counter<minCounter){minCounter=counter;}}
return maxCounter<10*minCounter;}
return false;}}
AbstractRSSReader.MAX_AVG_VARIANCE=0.2;AbstractRSSReader.MAX_INDIVIDUAL_VARIANCE=0.45;AbstractRSSReader.MIN_FINDER_PATTERN_RATIO=9.5/12.0;AbstractRSSReader.MAX_FINDER_PATTERN_RATIO=12.5/14.0;class DataCharacter{constructor(value,checksumPortion){this.value=value;this.checksumPortion=checksumPortion;}
getValue(){return this.value;}
getChecksumPortion(){return this.checksumPortion;}
toString(){return this.value+'('+this.checksumPortion+')';}
equals(o){if(!(o instanceof DataCharacter)){return false;}
const that=o;return this.value===that.value&&this.checksumPortion===that.checksumPortion;}
hashCode(){return this.value^this.checksumPortion;}}
class FinderPattern{constructor(value,startEnd,start,end,rowNumber){this.value=value;this.startEnd=startEnd;this.value=value;this.startEnd=startEnd;this.resultPoints=new Array();this.resultPoints.push(new ResultPoint(start,rowNumber));this.resultPoints.push(new ResultPoint(end,rowNumber));}
getValue(){return this.value;}
getStartEnd(){return this.startEnd;}
getResultPoints(){return this.resultPoints;}
equals(o){if(!(o instanceof FinderPattern)){return false;}
const that=o;return this.value===that.value;}
hashCode(){return this.value;}}
class RSSUtils{constructor(){}
static getRSSvalue(widths,maxWidth,noNarrow){let n=0;for(let width of widths){n+=width;}
let val=0;let narrowMask=0;let elements=widths.length;for(let bar=0;bar<elements-1;bar++){let elmWidth;for(elmWidth=1,narrowMask|=1<<bar;elmWidth<widths[bar];elmWidth++,narrowMask&=~(1<<bar)){let subVal=RSSUtils.combins(n-elmWidth-1,elements-bar-2);if(noNarrow&&(narrowMask===0)&&(n-elmWidth-(elements-bar-1)>=elements-bar-1)){subVal-=RSSUtils.combins(n-elmWidth-(elements-bar),elements-bar-2);}
if(elements-bar-1>1){let lessVal=0;for(let mxwElement=n-elmWidth-(elements-bar-2);mxwElement>maxWidth;mxwElement--){lessVal+=RSSUtils.combins(n-elmWidth-mxwElement-1,elements-bar-3);}
subVal-=lessVal*(elements-1-bar);}
else if(n-elmWidth>maxWidth){subVal--;}
val+=subVal;}
n-=elmWidth;}
return val;}
static combins(n,r){let maxDenom;let minDenom;if(n-r>r){minDenom=r;maxDenom=n-r;}
else{minDenom=n-r;maxDenom=r;}
let val=1;let j=1;for(let i=n;i>maxDenom;i--){val*=i;if(j<=minDenom){val/=j;j++;}}
while((j<=minDenom)){val/=j;j++;}
return val;}}
class BitArrayBuilder{static buildBitArray(pairs){let charNumber=(pairs.length*2)-1;if(pairs[pairs.length-1].getRightChar()==null){charNumber-=1;}
let size=12*charNumber;let binary=new BitArray(size);let accPos=0;let firstPair=pairs[0];let firstValue=firstPair.getRightChar().getValue();for(let i=11;i>=0;--i){if((firstValue&(1<<i))!=0){binary.set(accPos);}
accPos++;}
for(let i=1;i<pairs.length;++i){let currentPair=pairs[i];let leftValue=currentPair.getLeftChar().getValue();for(let j=11;j>=0;--j){if((leftValue&(1<<j))!=0){binary.set(accPos);}
accPos++;}
if(currentPair.getRightChar()!=null){let rightValue=currentPair.getRightChar().getValue();for(let j=11;j>=0;--j){if((rightValue&(1<<j))!=0){binary.set(accPos);}
accPos++;}}}
return binary;}}
class BlockParsedResult{constructor(finished,decodedInformation){if(decodedInformation){this.decodedInformation=null;}
else{this.finished=finished;this.decodedInformation=decodedInformation;}}
getDecodedInformation(){return this.decodedInformation;}
isFinished(){return this.finished;}}
class DecodedObject{constructor(newPosition){this.newPosition=newPosition;}
getNewPosition(){return this.newPosition;}}
class DecodedChar extends DecodedObject{constructor(newPosition,value){super(newPosition);this.value=value;}
getValue(){return this.value;}
isFNC1(){return this.value===DecodedChar.FNC1;}}
DecodedChar.FNC1='$';class DecodedInformation extends DecodedObject{constructor(newPosition,newString,remainingValue){super(newPosition);if(remainingValue){this.remaining=true;this.remainingValue=this.remainingValue;}
else{this.remaining=false;this.remainingValue=0;}
this.newString=newString;}
getNewString(){return this.newString;}
isRemaining(){return this.remaining;}
getRemainingValue(){return this.remainingValue;}}
class DecodedNumeric extends DecodedObject{constructor(newPosition,firstDigit,secondDigit){super(newPosition);if(firstDigit<0||firstDigit>10||secondDigit<0||secondDigit>10){throw new FormatException();}
this.firstDigit=firstDigit;this.secondDigit=secondDigit;}
getFirstDigit(){return this.firstDigit;}
getSecondDigit(){return this.secondDigit;}
getValue(){return this.firstDigit*10+this.secondDigit;}
isFirstDigitFNC1(){return this.firstDigit===DecodedNumeric.FNC1;}
isSecondDigitFNC1(){return this.secondDigit===DecodedNumeric.FNC1;}
isAnyFNC1(){return this.firstDigit===DecodedNumeric.FNC1||this.secondDigit===DecodedNumeric.FNC1;}}
DecodedNumeric.FNC1=10;class FieldParser{constructor(){}
static parseFieldsInGeneralPurpose(rawInformation){if(!rawInformation){return null;}
if(rawInformation.length<2){throw new NotFoundException();}
let firstTwoDigits=rawInformation.substring(0,2);for(let dataLength of FieldParser.TWO_DIGIT_DATA_LENGTH){if(dataLength[0]===firstTwoDigits){if(dataLength[1]===FieldParser.VARIABLE_LENGTH){return FieldParser.processVariableAI(2,dataLength[2],rawInformation);}
return FieldParser.processFixedAI(2,dataLength[1],rawInformation);}}
if(rawInformation.length<3){throw new NotFoundException();}
let firstThreeDigits=rawInformation.substring(0,3);for(let dataLength of FieldParser.THREE_DIGIT_DATA_LENGTH){if(dataLength[0]===firstThreeDigits){if(dataLength[1]===FieldParser.VARIABLE_LENGTH){return FieldParser.processVariableAI(3,dataLength[2],rawInformation);}
return FieldParser.processFixedAI(3,dataLength[1],rawInformation);}}
for(let dataLength of FieldParser.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH){if(dataLength[0]===firstThreeDigits){if(dataLength[1]===FieldParser.VARIABLE_LENGTH){return FieldParser.processVariableAI(4,dataLength[2],rawInformation);}
return FieldParser.processFixedAI(4,dataLength[1],rawInformation);}}
if(rawInformation.length<4){throw new NotFoundException();}
let firstFourDigits=rawInformation.substring(0,4);for(let dataLength of FieldParser.FOUR_DIGIT_DATA_LENGTH){if(dataLength[0]===firstFourDigits){if(dataLength[1]===FieldParser.VARIABLE_LENGTH){return FieldParser.processVariableAI(4,dataLength[2],rawInformation);}
return FieldParser.processFixedAI(4,dataLength[1],rawInformation);}}
throw new NotFoundException();}
static processFixedAI(aiSize,fieldSize,rawInformation){if(rawInformation.length<aiSize){throw new NotFoundException();}
let ai=rawInformation.substring(0,aiSize);if(rawInformation.length<aiSize+fieldSize){throw new NotFoundException();}
let field=rawInformation.substring(aiSize,aiSize+fieldSize);let remaining=rawInformation.substring(aiSize+fieldSize);let result='('+ai+')'+field;let parsedAI=FieldParser.parseFieldsInGeneralPurpose(remaining);return parsedAI==null?result:result+parsedAI;}
static processVariableAI(aiSize,variableFieldSize,rawInformation){let ai=rawInformation.substring(0,aiSize);let maxSize;if(rawInformation.length<aiSize+variableFieldSize){maxSize=rawInformation.length;}
else{maxSize=aiSize+variableFieldSize;}
let field=rawInformation.substring(aiSize,maxSize);let remaining=rawInformation.substring(maxSize);let result='('+ai+')'+field;let parsedAI=FieldParser.parseFieldsInGeneralPurpose(remaining);return parsedAI==null?result:result+parsedAI;}}
FieldParser.VARIABLE_LENGTH=[];FieldParser.TWO_DIGIT_DATA_LENGTH=[['00',18],['01',14],['02',14],['10',FieldParser.VARIABLE_LENGTH,20],['11',6],['12',6],['13',6],['15',6],['17',6],['20',2],['21',FieldParser.VARIABLE_LENGTH,20],['22',FieldParser.VARIABLE_LENGTH,29],['30',FieldParser.VARIABLE_LENGTH,8],['37',FieldParser.VARIABLE_LENGTH,8],['90',FieldParser.VARIABLE_LENGTH,30],['91',FieldParser.VARIABLE_LENGTH,30],['92',FieldParser.VARIABLE_LENGTH,30],['93',FieldParser.VARIABLE_LENGTH,30],['94',FieldParser.VARIABLE_LENGTH,30],['95',FieldParser.VARIABLE_LENGTH,30],['96',FieldParser.VARIABLE_LENGTH,30],['97',FieldParser.VARIABLE_LENGTH,3],['98',FieldParser.VARIABLE_LENGTH,30],['99',FieldParser.VARIABLE_LENGTH,30],];FieldParser.THREE_DIGIT_DATA_LENGTH=[['240',FieldParser.VARIABLE_LENGTH,30],['241',FieldParser.VARIABLE_LENGTH,30],['242',FieldParser.VARIABLE_LENGTH,6],['250',FieldParser.VARIABLE_LENGTH,30],['251',FieldParser.VARIABLE_LENGTH,30],['253',FieldParser.VARIABLE_LENGTH,17],['254',FieldParser.VARIABLE_LENGTH,20],['400',FieldParser.VARIABLE_LENGTH,30],['401',FieldParser.VARIABLE_LENGTH,30],['402',17],['403',FieldParser.VARIABLE_LENGTH,30],['410',13],['411',13],['412',13],['413',13],['414',13],['420',FieldParser.VARIABLE_LENGTH,20],['421',FieldParser.VARIABLE_LENGTH,15],['422',3],['423',FieldParser.VARIABLE_LENGTH,15],['424',3],['425',3],['426',3],];FieldParser.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[['310',6],['311',6],['312',6],['313',6],['314',6],['315',6],['316',6],['320',6],['321',6],['322',6],['323',6],['324',6],['325',6],['326',6],['327',6],['328',6],['329',6],['330',6],['331',6],['332',6],['333',6],['334',6],['335',6],['336',6],['340',6],['341',6],['342',6],['343',6],['344',6],['345',6],['346',6],['347',6],['348',6],['349',6],['350',6],['351',6],['352',6],['353',6],['354',6],['355',6],['356',6],['357',6],['360',6],['361',6],['362',6],['363',6],['364',6],['365',6],['366',6],['367',6],['368',6],['369',6],['390',FieldParser.VARIABLE_LENGTH,15],['391',FieldParser.VARIABLE_LENGTH,18],['392',FieldParser.VARIABLE_LENGTH,15],['393',FieldParser.VARIABLE_LENGTH,18],['703',FieldParser.VARIABLE_LENGTH,30],];FieldParser.FOUR_DIGIT_DATA_LENGTH=[['7001',13],['7002',FieldParser.VARIABLE_LENGTH,30],['7003',10],['8001',14],['8002',FieldParser.VARIABLE_LENGTH,20],['8003',FieldParser.VARIABLE_LENGTH,30],['8004',FieldParser.VARIABLE_LENGTH,30],['8005',6],['8006',18],['8007',FieldParser.VARIABLE_LENGTH,30],['8008',FieldParser.VARIABLE_LENGTH,12],['8018',18],['8020',FieldParser.VARIABLE_LENGTH,25],['8100',6],['8101',10],['8102',2],['8110',FieldParser.VARIABLE_LENGTH,70],['8200',FieldParser.VARIABLE_LENGTH,70],];class GeneralAppIdDecoder{constructor(information){this.buffer=new StringBuilder();this.information=information;}
decodeAllCodes(buff,initialPosition){let currentPosition=initialPosition;let remaining=null;do{let info=this.decodeGeneralPurposeField(currentPosition,remaining);let parsedFields=FieldParser.parseFieldsInGeneralPurpose(info.getNewString());if(parsedFields!=null){buff.append(parsedFields);}
if(info.isRemaining()){remaining=''+info.getRemainingValue();}
else{remaining=null;}
if(currentPosition===info.getNewPosition()){break;}
currentPosition=info.getNewPosition();}while(true);return buff.toString();}
isStillNumeric(pos){if(pos+7>this.information.getSize()){return pos+4<=this.information.getSize();}
for(let i=pos;i<pos+3;++i){if(this.information.get(i)){return true;}}
return this.information.get(pos+3);}
decodeNumeric(pos){if(pos+7>this.information.getSize()){let numeric=this.extractNumericValueFromBitArray(pos,4);if(numeric===0){return new DecodedNumeric(this.information.getSize(),DecodedNumeric.FNC1,DecodedNumeric.FNC1);}
return new DecodedNumeric(this.information.getSize(),numeric-1,DecodedNumeric.FNC1);}
let numeric=this.extractNumericValueFromBitArray(pos,7);let digit1=(numeric-8)/11;let digit2=(numeric-8)%11;return new DecodedNumeric(pos+7,digit1,digit2);}
extractNumericValueFromBitArray(pos,bits){return GeneralAppIdDecoder.extractNumericValueFromBitArray(this.information,pos,bits);}
static extractNumericValueFromBitArray(information,pos,bits){let value=0;for(let i=0;i<bits;++i){if(information.get(pos+i)){value|=1<<(bits-i-1);}}
return value;}
decodeGeneralPurposeField(pos,remaining){this.buffer.setLengthToZero();if(remaining!=null){this.buffer.append(remaining);}
this.current.setPosition(pos);let lastDecoded=this.parseBlocks();if(lastDecoded!=null&&lastDecoded.isRemaining()){return new DecodedInformation(this.current.getPosition(),this.buffer.toString(),lastDecoded.getRemainingValue());}
return new DecodedInformation(this.current.getPosition(),this.buffer.toString());}
parseBlocks(){let isFinished;let result;do{let initialPosition=this.current.getPosition();if(this.current.isAlpha()){result=this.parseAlphaBlock();isFinished=result.isFinished();}
else if(this.current.isIsoIec646()){result=this.parseIsoIec646Block();isFinished=result.isFinished();}
else{result=this.parseNumericBlock();isFinished=result.isFinished();}
let positionChanged=initialPosition!==this.current.getPosition();if(!positionChanged&&!isFinished){break;}}while(!isFinished);return result.getDecodedInformation();}
parseNumericBlock(){while(this.isStillNumeric(this.current.getPosition())){let numeric=this.decodeNumeric(this.current.getPosition());this.current.setPosition(numeric.getNewPosition());if(numeric.isFirstDigitFNC1()){let information;if(numeric.isSecondDigitFNC1()){information=new DecodedInformation(this.current.getPosition(),this.buffer.toString());}
else{information=new DecodedInformation(this.current.getPosition(),this.buffer.toString(),numeric.getSecondDigit());}
return new BlockParsedResult(true,information);}
this.buffer.append(numeric.getFirstDigit());if(numeric.isSecondDigitFNC1()){let information=new DecodedInformation(this.current.getPosition(),this.buffer.toString());return new BlockParsedResult(true,information);}
this.buffer.append(numeric.getSecondDigit());}
if(this.isNumericToAlphaNumericLatch(this.current.getPosition())){this.current.setAlpha();this.current.incrementPosition(4);}
return new BlockParsedResult(false);}
parseIsoIec646Block(){while(this.isStillIsoIec646(this.current.getPosition())){let iso=this.decodeIsoIec646(this.current.getPosition());this.current.setPosition(iso.getNewPosition());if(iso.isFNC1()){let information=new DecodedInformation(this.current.getPosition(),this.buffer.toString());return new BlockParsedResult(true,information);}
this.buffer.append(iso.getValue());}
if(this.isAlphaOr646ToNumericLatch(this.current.getPosition())){this.current.incrementPosition(3);this.current.setNumeric();}
else if(this.isAlphaTo646ToAlphaLatch(this.current.getPosition())){if(this.current.getPosition()+5<this.information.getSize()){this.current.incrementPosition(5);}
else{this.current.setPosition(this.information.getSize());}
this.current.setAlpha();}
return new BlockParsedResult(false);}
parseAlphaBlock(){while(this.isStillAlpha(this.current.getPosition())){let alpha=this.decodeAlphanumeric(this.current.getPosition());this.current.setPosition(alpha.getNewPosition());if(alpha.isFNC1()){let information=new DecodedInformation(this.current.getPosition(),this.buffer.toString());return new BlockParsedResult(true,information);}
this.buffer.append(alpha.getValue());}
if(this.isAlphaOr646ToNumericLatch(this.current.getPosition())){this.current.incrementPosition(3);this.current.setNumeric();}
else if(this.isAlphaTo646ToAlphaLatch(this.current.getPosition())){if(this.current.getPosition()+5<this.information.getSize()){this.current.incrementPosition(5);}
else{this.current.setPosition(this.information.getSize());}
this.current.setIsoIec646();}
return new BlockParsedResult(false);}
isStillIsoIec646(pos){if(pos+5>this.information.getSize()){return false;}
let fiveBitValue=this.extractNumericValueFromBitArray(pos,5);if(fiveBitValue>=5&&fiveBitValue<16){return true;}
if(pos+7>this.information.getSize()){return false;}
let sevenBitValue=this.extractNumericValueFromBitArray(pos,7);if(sevenBitValue>=64&&sevenBitValue<116){return true;}
if(pos+8>this.information.getSize()){return false;}
let eightBitValue=this.extractNumericValueFromBitArray(pos,8);return eightBitValue>=232&&eightBitValue<253;}
decodeIsoIec646(pos){let fiveBitValue=this.extractNumericValueFromBitArray(pos,5);if(fiveBitValue===15){return new DecodedChar(pos+5,DecodedChar.FNC1);}
if(fiveBitValue>=5&&fiveBitValue<15){return new DecodedChar(pos+5,('0'+(fiveBitValue-5)));}
let sevenBitValue=this.extractNumericValueFromBitArray(pos,7);if(sevenBitValue>=64&&sevenBitValue<90){return new DecodedChar(pos+7,(''+(sevenBitValue+1)));}
if(sevenBitValue>=90&&sevenBitValue<116){return new DecodedChar(pos+7,(''+(sevenBitValue+7)));}
let eightBitValue=this.extractNumericValueFromBitArray(pos,8);let c;switch(eightBitValue){case 232:c='!';break;case 233:c='"';break;case 234:c='%';break;case 235:c='&';break;case 236:c='\'';break;case 237:c='(';break;case 238:c=')';break;case 239:c='*';break;case 240:c='+';break;case 241:c=',';break;case 242:c='-';break;case 243:c='.';break;case 244:c='/';break;case 245:c=':';break;case 246:c=';';break;case 247:c='<';break;case 248:c='=';break;case 249:c='>';break;case 250:c='?';break;case 251:c='_';break;case 252:c=' ';break;default:throw new FormatException();}
return new DecodedChar(pos+8,c);}
isStillAlpha(pos){if(pos+5>this.information.getSize()){return false;}
let fiveBitValue=this.extractNumericValueFromBitArray(pos,5);if(fiveBitValue>=5&&fiveBitValue<16){return true;}
if(pos+6>this.information.getSize()){return false;}
let sixBitValue=this.extractNumericValueFromBitArray(pos,6);return sixBitValue>=16&&sixBitValue<63;}
decodeAlphanumeric(pos){let fiveBitValue=this.extractNumericValueFromBitArray(pos,5);if(fiveBitValue===15){return new DecodedChar(pos+5,DecodedChar.FNC1);}
if(fiveBitValue>=5&&fiveBitValue<15){return new DecodedChar(pos+5,('0'+(fiveBitValue-5)));}
let sixBitValue=this.extractNumericValueFromBitArray(pos,6);if(sixBitValue>=32&&sixBitValue<58){return new DecodedChar(pos+6,(''+(sixBitValue+33)));}
let c;switch(sixBitValue){case 58:c='*';break;case 59:c=',';break;case 60:c='-';break;case 61:c='.';break;case 62:c='/';break;default:throw new IllegalStateException('Decoding invalid alphanumeric value: '+sixBitValue);}
return new DecodedChar(pos+6,c);}
isAlphaTo646ToAlphaLatch(pos){if(pos+1>this.information.getSize()){return false;}
for(let i=0;i<5&&i+pos<this.information.getSize();++i){if(i===2){if(!this.information.get(pos+2)){return false;}}
else if(this.information.get(pos+i)){return false;}}
return true;}
isAlphaOr646ToNumericLatch(pos){if(pos+3>this.information.getSize()){return false;}
for(let i=pos;i<pos+3;++i){if(this.information.get(i)){return false;}}
return true;}
isNumericToAlphaNumericLatch(pos){if(pos+1>this.information.getSize()){return false;}
for(let i=0;i<4&&i+pos<this.information.getSize();++i){if(this.information.get(pos+i)){return false;}}
return true;}}
class AbstractExpandedDecoder{constructor(information){this.information=information;this.generalDecoder=new GeneralAppIdDecoder(information);}
getInformation(){return this.information;}
getGeneralDecoder(){return this.generalDecoder;}}
class AI01decoder extends AbstractExpandedDecoder{constructor(information){super(information);}
encodeCompressedGtin(buf,currentPos){buf.append('(01)');let initialPosition=buf.length();buf.append('9');this.encodeCompressedGtinWithoutAI(buf,currentPos,initialPosition);}
encodeCompressedGtinWithoutAI(buf,currentPos,initialBufferPosition){for(let i=0;i<4;++i){let currentBlock=this.getGeneralDecoder().extractNumericValueFromBitArray(currentPos+10*i,10);if(currentBlock/100===0){buf.append('0');}
if(currentBlock/10===0){buf.append('0');}
buf.append(currentBlock);}
AI01decoder.appendCheckDigit(buf,initialBufferPosition);}
static appendCheckDigit(buf,currentPos){let checkDigit=0;for(let i=0;i<13;i++){let digit=buf.charAt(i+currentPos).charCodeAt(0)-'0'.charCodeAt(0);checkDigit+=(i&0x01)===0?3*digit:digit;}
checkDigit=10-(checkDigit%10);if(checkDigit===10){checkDigit=0;}
buf.append(checkDigit);}}
AI01decoder.GTIN_SIZE=40;class AI01AndOtherAIs extends AI01decoder{constructor(information){super(information);}
parseInformation(){let buff=new StringBuilder();buff.append('(01)');let initialGtinPosition=buff.length();let firstGtinDigit=this.getGeneralDecoder().extractNumericValueFromBitArray(AI01AndOtherAIs.HEADER_SIZE,4);buff.append(firstGtinDigit);this.encodeCompressedGtinWithoutAI(buff,AI01AndOtherAIs.HEADER_SIZE+4,initialGtinPosition);return this.getGeneralDecoder().decodeAllCodes(buff,AI01AndOtherAIs.HEADER_SIZE+44);}}
AI01AndOtherAIs.HEADER_SIZE=1+1+2;class AnyAIDecoder extends AbstractExpandedDecoder{constructor(information){super(information);}
parseInformation(){let buf=new StringBuilder();return this.getGeneralDecoder().decodeAllCodes(buf,AnyAIDecoder.HEADER_SIZE);}}
AnyAIDecoder.HEADER_SIZE=2+1+2;class AI01weightDecoder extends AI01decoder{constructor(information){super(information);}
encodeCompressedWeight(buf,currentPos,weightSize){let originalWeightNumeric=this.getGeneralDecoder().extractNumericValueFromBitArray(currentPos,weightSize);this.addWeightCode(buf,originalWeightNumeric);let weightNumeric=this.checkWeight(originalWeightNumeric);let currentDivisor=100000;for(let i=0;i<5;++i){if(weightNumeric/currentDivisor===0){buf.append('0');}
currentDivisor/=10;}
buf.append(weightNumeric);}}
class AI013x0xDecoder extends AI01weightDecoder{constructor(information){super(information);}
parseInformation(){if(this.getInformation().getSize()!=AI013x0xDecoder.HEADER_SIZE+AI01weightDecoder.GTIN_SIZE+AI013x0xDecoder.WEIGHT_SIZE){throw new NotFoundException();}
let buf=new StringBuilder();this.encodeCompressedGtin(buf,AI013x0xDecoder.HEADER_SIZE);this.encodeCompressedWeight(buf,AI013x0xDecoder.HEADER_SIZE+AI01weightDecoder.GTIN_SIZE,AI013x0xDecoder.WEIGHT_SIZE);return buf.toString();}}
AI013x0xDecoder.HEADER_SIZE=4+1;AI013x0xDecoder.WEIGHT_SIZE=15;class AI013103decoder extends AI013x0xDecoder{constructor(information){super(information);}
addWeightCode(buf,weight){buf.append('(3103)');}
checkWeight(weight){return weight;}}
class AI01320xDecoder extends AI013x0xDecoder{constructor(information){super(information);}
addWeightCode(buf,weight){if(weight<10000){buf.append('(3202)');}
else{buf.append('(3203)');}}
checkWeight(weight){if(weight<10000){return weight;}
return weight-10000;}}
class AI01392xDecoder extends AI01decoder{constructor(information){super(information);}
parseInformation(){if(this.getInformation().getSize()<AI01392xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE){throw new NotFoundException();}
let buf=new StringBuilder();this.encodeCompressedGtin(buf,AI01392xDecoder.HEADER_SIZE);let lastAIdigit=this.getGeneralDecoder().extractNumericValueFromBitArray(AI01392xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE,AI01392xDecoder.LAST_DIGIT_SIZE);buf.append('(392');buf.append(lastAIdigit);buf.append(')');let decodedInformation=this.getGeneralDecoder().decodeGeneralPurposeField(AI01392xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE+AI01392xDecoder.LAST_DIGIT_SIZE,null);buf.append(decodedInformation.getNewString());return buf.toString();}}
AI01392xDecoder.HEADER_SIZE=5+1+2;AI01392xDecoder.LAST_DIGIT_SIZE=2;class AI01393xDecoder extends AI01decoder{constructor(information){super(information);}
parseInformation(){if(this.getInformation().getSize()<AI01393xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE){throw new NotFoundException();}
let buf=new StringBuilder();this.encodeCompressedGtin(buf,AI01393xDecoder.HEADER_SIZE);let lastAIdigit=this.getGeneralDecoder().extractNumericValueFromBitArray(AI01393xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE,AI01393xDecoder.LAST_DIGIT_SIZE);buf.append('(393');buf.append(lastAIdigit);buf.append(')');let firstThreeDigits=this.getGeneralDecoder().extractNumericValueFromBitArray(AI01393xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE+AI01393xDecoder.LAST_DIGIT_SIZE,AI01393xDecoder.FIRST_THREE_DIGITS_SIZE);if(firstThreeDigits/100==0){buf.append('0');}
if(firstThreeDigits/10==0){buf.append('0');}
buf.append(firstThreeDigits);let generalInformation=this.getGeneralDecoder().decodeGeneralPurposeField(AI01393xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE+AI01393xDecoder.LAST_DIGIT_SIZE+AI01393xDecoder.FIRST_THREE_DIGITS_SIZE,null);buf.append(generalInformation.getNewString());return buf.toString();}}
AI01393xDecoder.HEADER_SIZE=5+1+2;AI01393xDecoder.LAST_DIGIT_SIZE=2;AI01393xDecoder.FIRST_THREE_DIGITS_SIZE=10;class AI013x0x1xDecoder extends AI01weightDecoder{constructor(information,firstAIdigits,dateCode){super(information);this.dateCode=dateCode;this.firstAIdigits=firstAIdigits;}
parseInformation(){if(this.getInformation().getSize()!=AI013x0x1xDecoder.HEADER_SIZE+AI013x0x1xDecoder.GTIN_SIZE+AI013x0x1xDecoder.WEIGHT_SIZE+AI013x0x1xDecoder.DATE_SIZE){throw new NotFoundException();}
let buf=new StringBuilder();this.encodeCompressedGtin(buf,AI013x0x1xDecoder.HEADER_SIZE);this.encodeCompressedWeight(buf,AI013x0x1xDecoder.HEADER_SIZE+AI013x0x1xDecoder.GTIN_SIZE,AI013x0x1xDecoder.WEIGHT_SIZE);this.encodeCompressedDate(buf,AI013x0x1xDecoder.HEADER_SIZE+AI013x0x1xDecoder.GTIN_SIZE+AI013x0x1xDecoder.WEIGHT_SIZE);return buf.toString();}
encodeCompressedDate(buf,currentPos){let numericDate=this.getGeneralDecoder().extractNumericValueFromBitArray(currentPos,AI013x0x1xDecoder.DATE_SIZE);if(numericDate==38400){return;}
buf.append('(');buf.append(this.dateCode);buf.append(')');let day=numericDate%32;numericDate/=32;let month=numericDate%12+1;numericDate/=12;let year=numericDate;if(year/10==0){buf.append('0');}
buf.append(year);if(month/10==0){buf.append('0');}
buf.append(month);if(day/10==0){buf.append('0');}
buf.append(day);}
addWeightCode(buf,weight){buf.append('(');buf.append(this.firstAIdigits);buf.append(weight/100000);buf.append(')');}
checkWeight(weight){return weight%100000;}}
AI013x0x1xDecoder.HEADER_SIZE=7+1;AI013x0x1xDecoder.WEIGHT_SIZE=20;AI013x0x1xDecoder.DATE_SIZE=16;function createDecoder(information){try{if(information.get(1)){return new AI01AndOtherAIs(information);}
if(!information.get(2)){return new AnyAIDecoder(information);}
let fourBitEncodationMethod=GeneralAppIdDecoder.extractNumericValueFromBitArray(information,1,4);switch(fourBitEncodationMethod){case 4:return new AI013103decoder(information);case 5:return new AI01320xDecoder(information);}
let fiveBitEncodationMethod=GeneralAppIdDecoder.extractNumericValueFromBitArray(information,1,5);switch(fiveBitEncodationMethod){case 12:return new AI01392xDecoder(information);case 13:return new AI01393xDecoder(information);}
let sevenBitEncodationMethod=GeneralAppIdDecoder.extractNumericValueFromBitArray(information,1,7);switch(sevenBitEncodationMethod){case 56:return new AI013x0x1xDecoder(information,'310','11');case 57:return new AI013x0x1xDecoder(information,'320','11');case 58:return new AI013x0x1xDecoder(information,'310','13');case 59:return new AI013x0x1xDecoder(information,'320','13');case 60:return new AI013x0x1xDecoder(information,'310','15');case 61:return new AI013x0x1xDecoder(information,'320','15');case 62:return new AI013x0x1xDecoder(information,'310','17');case 63:return new AI013x0x1xDecoder(information,'320','17');}}
catch(e){console.log(e);throw new IllegalStateException('unknown decoder: '+information);}}
class ExpandedPair{constructor(leftChar,rightChar,finderPatter,mayBeLast){this.leftchar=leftChar;this.rightchar=rightChar;this.finderpattern=finderPatter;this.maybeLast=mayBeLast;}
mayBeLast(){return this.maybeLast;}
getLeftChar(){return this.leftchar;}
getRightChar(){return this.rightchar;}
getFinderPattern(){return this.finderpattern;}
mustBeLast(){return this.rightchar==null;}
toString(){return'[ '+this.leftchar+', '+this.rightchar+' : '+(this.finderpattern==null?'null':this.finderpattern.getValue())+' ]';}
static equals(o1,o2){if(!(o1 instanceof ExpandedPair)){return false;}
return ExpandedPair.equalsOrNull(o1.leftchar,o2.leftchar)&&ExpandedPair.equalsOrNull(o1.rightchar,o2.rightchar)&&ExpandedPair.equalsOrNull(o1.finderpattern,o2.finderpattern);}
static equalsOrNull(o1,o2){return o1===null?o2===null:ExpandedPair.equals(o1,o2);}
hashCode(){let value=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return value;}}
class ExpandedRow{constructor(pairs,rowNumber,wasReversed){this.pairs=pairs;this.rowNumber=rowNumber;this.wasReversed=wasReversed;}
getPairs(){return this.pairs;}
getRowNumber(){return this.rowNumber;}
isReversed(){return this.wasReversed;}
isEquivalent(otherPairs){return this.checkEqualitity(this,otherPairs);}
toString(){return'{ '+this.pairs+' }';}
equals(o1,o2){if(!(o1 instanceof ExpandedRow)){return false;}
return this.checkEqualitity(o1,o2)&&o1.wasReversed===o2.wasReversed;}
checkEqualitity(pair1,pair2){if(!pair1||!pair2)
return;let result;pair1.forEach((e1,i)=>{pair2.forEach(e2=>{if(e1.getLeftChar().getValue()===e2.getLeftChar().getValue()&&e1.getRightChar().getValue()===e2.getRightChar().getValue()&&e1.getFinderPatter().getValue()===e2.getFinderPatter().getValue()){result=true;}});});return result;}}
class RSSExpandedReader extends AbstractRSSReader{constructor(){super(...arguments);this.pairs=new Array(RSSExpandedReader.MAX_PAIRS);this.rows=new Array();this.startEnd=[2];}
decodeRow(rowNumber,row,hints){this.pairs.length=0;this.startFromEven=false;try{return RSSExpandedReader.constructResult(this.decodeRow2pairs(rowNumber,row));}
catch(e){}
this.pairs.length=0;this.startFromEven=true;return RSSExpandedReader.constructResult(this.decodeRow2pairs(rowNumber,row));}
reset(){this.pairs.length=0;this.rows.length=0;}
decodeRow2pairs(rowNumber,row){let done=false;while(!done){try{this.pairs.push(this.retrieveNextPair(row,this.pairs,rowNumber));}
catch(error){if(error instanceof NotFoundException){if(!this.pairs.length){throw new NotFoundException();}
done=true;}}}
if(this.checkChecksum()){return this.pairs;}
let tryStackedDecode;if(this.rows.length){tryStackedDecode=true;}
else{tryStackedDecode=false;}
this.storeRow(rowNumber,false);if(tryStackedDecode){let ps=this.checkRowsBoolean(false);if(ps!=null){return ps;}
ps=this.checkRowsBoolean(true);if(ps!=null){return ps;}}
throw new NotFoundException();}
checkRowsBoolean(reverse){if(this.rows.length>25){this.rows.length=0;return null;}
this.pairs.length=0;if(reverse){this.rows=this.rows.reverse();}
let ps=null;try{ps=this.checkRows(new Array(),0);}
catch(e){console.log(e);}
if(reverse){this.rows=this.rows.reverse();}
return ps;}
checkRows(collectedRows,currentRow){for(let i=currentRow;i<this.rows.length;i++){let row=this.rows[i];this.pairs.length=0;for(let collectedRow of collectedRows){this.pairs.push(collectedRow.getPairs());}
this.pairs.push(row.getPairs());if(!RSSExpandedReader.isValidSequence(this.pairs)){continue;}
if(this.checkChecksum()){return this.pairs;}
let rs=new Array(collectedRows);rs.push(row);try{return this.checkRows(rs,i+1);}
catch(e){console.log(e);}}
throw new NotFoundException();}
static isValidSequence(pairs){for(let sequence of RSSExpandedReader.FINDER_PATTERN_SEQUENCES){if(pairs.length>sequence.length){continue;}
let stop=true;for(let j=0;j<pairs.length;j++){if(pairs[j].getFinderPattern().getValue()!=sequence[j]){stop=false;break;}}
if(stop){return true;}}
return false;}
storeRow(rowNumber,wasReversed){let insertPos=0;let prevIsSame=false;let nextIsSame=false;while(insertPos<this.rows.length){let erow=this.rows[insertPos];if(erow.getRowNumber()>rowNumber){nextIsSame=erow.isEquivalent(this.pairs);break;}
prevIsSame=erow.isEquivalent(this.pairs);insertPos++;}
if(nextIsSame||prevIsSame){return;}
if(RSSExpandedReader.isPartialRow(this.pairs,this.rows)){return;}
this.rows.push(insertPos,new ExpandedRow(this.pairs,rowNumber,wasReversed));this.removePartialRows(this.pairs,this.rows);}
removePartialRows(pairs,rows){for(let row of rows){if(row.getPairs().length===pairs.length){continue;}
for(let p of row.getPairs()){for(let pp of pairs){if(ExpandedPair.equals(p,pp)){break;}}}}}
static isPartialRow(pairs,rows){for(let r of rows){let allFound=true;for(let p of pairs){let found=false;for(let pp of r.getPairs()){if(p.equals(pp)){found=true;break;}}
if(!found){allFound=false;break;}}
if(allFound){return true;}}
return false;}
getRows(){return this.rows;}
static constructResult(pairs){let binary=BitArrayBuilder.buildBitArray(pairs);let decoder=createDecoder(binary);let resultingString=decoder.parseInformation();let firstPoints=pairs[0].getFinderPattern().getResultPoints();let lastPoints=pairs[pairs.length-1].getFinderPattern().getResultPoints();let points=[firstPoints[0],firstPoints[1],lastPoints[0],lastPoints[1]];return new Result(resultingString,null,null,points,BarcodeFormat$1.RSS_EXPANDED,null);}
checkChecksum(){let firstPair=this.pairs.get(0);let checkCharacter=firstPair.getLeftChar();let firstCharacter=firstPair.getRightChar();if(firstCharacter==null){return false;}
let checksum=firstCharacter.getChecksumPortion();let s=2;for(let i=1;i<this.pairs.size();++i){let currentPair=this.pairs.get(i);checksum+=currentPair.getLeftChar().getChecksumPortion();s++;let currentRightChar=currentPair.getRightChar();if(currentRightChar!=null){checksum+=currentRightChar.getChecksumPortion();s++;}}
checksum%=211;let checkCharacterValue=211*(s-4)+checksum;return checkCharacterValue==checkCharacter.getValue();}
static getNextSecondBar(row,initialPos){let currentPos;if(row.get(initialPos)){currentPos=row.getNextUnset(initialPos);currentPos=row.getNextSet(currentPos);}
else{currentPos=row.getNextSet(initialPos);currentPos=row.getNextUnset(currentPos);}
return currentPos;}
retrieveNextPair(row,previousPairs,rowNumber){let isOddPattern=previousPairs.length%2==0;if(this.startFromEven){isOddPattern=!isOddPattern;}
let pattern;let keepFinding=true;let forcedOffset=-1;do{this.findNextPair(row,previousPairs,forcedOffset);pattern=this.parseFoundFinderPattern(row,rowNumber,isOddPattern);if(pattern==null){forcedOffset=RSSExpandedReader.getNextSecondBar(row,this.startEnd[0]);}
else{keepFinding=false;}}while(keepFinding);let leftChar=this.decodeDataCharacter(row,pattern,isOddPattern,true);if(!this.isEmptyPair(previousPairs)&&previousPairs[previousPairs.length-1].mustBeLast()){throw new NotFoundException();}
let rightChar;try{rightChar=this.decodeDataCharacter(row,pattern,isOddPattern,false);}
catch(e){rightChar=null;console.log(e);}
return new ExpandedPair(leftChar,rightChar,pattern,true);}
isEmptyPair(pairs){if(pairs.length===0){return true;}
return false;}
findNextPair(row,previousPairs,forcedOffset){let counters=this.getDecodeFinderCounters();counters[0]=0;counters[1]=0;counters[2]=0;counters[3]=0;let width=row.getSize();let rowOffset;if(forcedOffset>=0){rowOffset=forcedOffset;}
else if(this.isEmptyPair(previousPairs)){rowOffset=0;}
else{let lastPair=previousPairs[previousPairs.length-1];rowOffset=lastPair.getFinderPattern().getStartEnd()[1];}
let searchingEvenPair=previousPairs.length%2!=0;if(this.startFromEven){searchingEvenPair=!searchingEvenPair;}
let isWhite=false;while(rowOffset<width){isWhite=!row.get(rowOffset);if(!isWhite){break;}
rowOffset++;}
let counterPosition=0;let patternStart=rowOffset;for(let x=rowOffset;x<width;x++){if(row.get(x)!=isWhite){counters[counterPosition]++;}
else{if(counterPosition==3){if(searchingEvenPair){RSSExpandedReader.reverseCounters(counters);}
if(RSSExpandedReader.isFinderPattern(counters)){this.startEnd[0]=patternStart;this.startEnd[1]=x;return;}
if(searchingEvenPair){RSSExpandedReader.reverseCounters(counters);}
patternStart+=counters[0]+counters[1];counters[0]=counters[2];counters[1]=counters[3];counters[2]=0;counters[3]=0;counterPosition--;}
else{counterPosition++;}
counters[counterPosition]=1;isWhite=!isWhite;}}
throw new NotFoundException();}
static reverseCounters(counters){let length=counters.length;for(let i=0;i<length/2;++i){let tmp=counters[i];counters[i]=counters[length-i-1];counters[length-i-1]=tmp;}}
parseFoundFinderPattern(row,rowNumber,oddPattern){let firstCounter;let start;let end;if(oddPattern){let firstElementStart=this.startEnd[0]-1;while(firstElementStart>=0&&!row.get(firstElementStart)){firstElementStart--;}
firstElementStart++;firstCounter=this.startEnd[0]-firstElementStart;start=firstElementStart;end=this.startEnd[1];}
else{start=this.startEnd[0];end=row.getNextUnset(this.startEnd[1]+1);firstCounter=end-this.startEnd[1];}
let counters=this.getDecodeFinderCounters();System.arraycopy(counters,0,counters,1,counters.length-1);counters[0]=firstCounter;let value;try{value=this.parseFinderValue(counters,RSSExpandedReader.FINDER_PATTERNS);}
catch(e){return null;}
return new FinderPattern(value,[start,end],start,end,rowNumber);}
decodeDataCharacter(row,pattern,isOddPattern,leftChar){let counters=this.getDataCharacterCounters();for(let x=0;x<counters.length;x++){counters[x]=0;}
if(leftChar){RSSExpandedReader.recordPatternInReverse(row,pattern.getStartEnd()[0],counters);}
else{RSSExpandedReader.recordPattern(row,pattern.getStartEnd()[1],counters);for(let i=0,j=counters.length-1;i<j;i++,j--){let temp=counters[i];counters[i]=counters[j];counters[j]=temp;}}
let numModules=17;let elementWidth=MathUtils.sum(new Int32Array(counters))/numModules;let expectedElementWidth=(pattern.getStartEnd()[1]-pattern.getStartEnd()[0])/15.0;if(Math.abs(elementWidth-expectedElementWidth)/expectedElementWidth>0.3){throw new NotFoundException();}
let oddCounts=this.getOddCounts();let evenCounts=this.getEvenCounts();let oddRoundingErrors=this.getOddRoundingErrors();let evenRoundingErrors=this.getEvenRoundingErrors();for(let i=0;i<counters.length;i++){let value=1.0*counters[i]/elementWidth;let count=value+0.5;if(count<1){if(value<0.3){throw new NotFoundException();}
count=1;}
else if(count>8){if(value>8.7){throw new NotFoundException();}
count=8;}
let offset=i/2;if((i&0x01)==0){oddCounts[offset]=count;oddRoundingErrors[offset]=value-count;}
else{evenCounts[offset]=count;evenRoundingErrors[offset]=value-count;}}
this.adjustOddEvenCounts(numModules);let weightRowNumber=4*pattern.getValue()+(isOddPattern?0:2)+(leftChar?0:1)-1;let oddSum=0;let oddChecksumPortion=0;for(let i=oddCounts.length-1;i>=0;i--){if(RSSExpandedReader.isNotA1left(pattern,isOddPattern,leftChar)){let weight=RSSExpandedReader.WEIGHTS[weightRowNumber][2*i];oddChecksumPortion+=oddCounts[i]*weight;}
oddSum+=oddCounts[i];}
let evenChecksumPortion=0;for(let i=evenCounts.length-1;i>=0;i--){if(RSSExpandedReader.isNotA1left(pattern,isOddPattern,leftChar)){let weight=RSSExpandedReader.WEIGHTS[weightRowNumber][2*i+1];evenChecksumPortion+=evenCounts[i]*weight;}}
let checksumPortion=oddChecksumPortion+evenChecksumPortion;if((oddSum&0x01)!=0||oddSum>13||oddSum<4){throw new NotFoundException();}
let group=(13-oddSum)/2;let oddWidest=RSSExpandedReader.SYMBOL_WIDEST[group];let evenWidest=9-oddWidest;let vOdd=RSSUtils.getRSSvalue(oddCounts,oddWidest,true);let vEven=RSSUtils.getRSSvalue(evenCounts,evenWidest,false);let tEven=RSSExpandedReader.EVEN_TOTAL_SUBSET[group];let gSum=RSSExpandedReader.GSUM[group];let value=vOdd*tEven+vEven+gSum;return new DataCharacter(value,checksumPortion);}
static isNotA1left(pattern,isOddPattern,leftChar){return!(pattern.getValue()==0&&isOddPattern&&leftChar);}
adjustOddEvenCounts(numModules){let oddSum=MathUtils.sum(new Int32Array(this.getOddCounts()));let evenSum=MathUtils.sum(new Int32Array(this.getEvenCounts()));let incrementOdd=false;let decrementOdd=false;if(oddSum>13){decrementOdd=true;}
else if(oddSum<4){incrementOdd=true;}
let incrementEven=false;let decrementEven=false;if(evenSum>13){decrementEven=true;}
else if(evenSum<4){incrementEven=true;}
let mismatch=oddSum+evenSum-numModules;let oddParityBad=(oddSum&0x01)==1;let evenParityBad=(evenSum&0x01)==0;if(mismatch==1){if(oddParityBad){if(evenParityBad){throw new NotFoundException();}
decrementOdd=true;}
else{if(!evenParityBad){throw new NotFoundException();}
decrementEven=true;}}
else if(mismatch==-1){if(oddParityBad){if(evenParityBad){throw new NotFoundException();}
incrementOdd=true;}
else{if(!evenParityBad){throw new NotFoundException();}
incrementEven=true;}}
else if(mismatch==0){if(oddParityBad){if(!evenParityBad){throw new NotFoundException();}
if(oddSum<evenSum){incrementOdd=true;decrementEven=true;}
else{decrementOdd=true;incrementEven=true;}}
else{if(evenParityBad){throw new NotFoundException();}}}
else{throw new NotFoundException();}
if(incrementOdd){if(decrementOdd){throw new NotFoundException();}
RSSExpandedReader.increment(this.getOddCounts(),this.getOddRoundingErrors());}
if(decrementOdd){RSSExpandedReader.decrement(this.getOddCounts(),this.getOddRoundingErrors());}
if(incrementEven){if(decrementEven){throw new NotFoundException();}
RSSExpandedReader.increment(this.getEvenCounts(),this.getOddRoundingErrors());}
if(decrementEven){RSSExpandedReader.decrement(this.getEvenCounts(),this.getEvenRoundingErrors());}}}
RSSExpandedReader.SYMBOL_WIDEST=[7,5,4,3,1];RSSExpandedReader.EVEN_TOTAL_SUBSET=[4,20,52,104,204];RSSExpandedReader.GSUM=[0,348,1388,2948,3988];RSSExpandedReader.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])];RSSExpandedReader.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]];RSSExpandedReader.FINDER_PAT_A=0;RSSExpandedReader.FINDER_PAT_B=1;RSSExpandedReader.FINDER_PAT_C=2;RSSExpandedReader.FINDER_PAT_D=3;RSSExpandedReader.FINDER_PAT_E=4;RSSExpandedReader.FINDER_PAT_F=5;RSSExpandedReader.FINDER_PATTERN_SEQUENCES=[[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_D],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_C],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_F],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_F,RSSExpandedReader.FINDER_PAT_F],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_D],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_E],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_F,RSSExpandedReader.FINDER_PAT_F],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_F,RSSExpandedReader.FINDER_PAT_F],];RSSExpandedReader.MAX_PAIRS=11;class Pair extends DataCharacter{constructor(value,checksumPortion,finderPattern){super(value,checksumPortion);this.count=0;this.finderPattern=finderPattern;}
getFinderPattern(){return this.finderPattern;}
getCount(){return this.count;}
incrementCount(){this.count++;}}
class RSS14Reader extends AbstractRSSReader{constructor(){super(...arguments);this.possibleLeftPairs=[];this.possibleRightPairs=[];}
decodeRow(rowNumber,row,hints){const leftPair=this.decodePair(row,false,rowNumber,hints);RSS14Reader.addOrTally(this.possibleLeftPairs,leftPair);row.reverse();let rightPair=this.decodePair(row,true,rowNumber,hints);RSS14Reader.addOrTally(this.possibleRightPairs,rightPair);row.reverse();for(let left of this.possibleLeftPairs){if(left.getCount()>1){for(let right of this.possibleRightPairs){if(right.getCount()>1&&RSS14Reader.checkChecksum(left,right)){return RSS14Reader.constructResult(left,right);}}}}
throw new NotFoundException();}
static addOrTally(possiblePairs,pair){if(pair==null){return;}
let found=false;for(let other of possiblePairs){if(other.getValue()===pair.getValue()){other.incrementCount();found=true;break;}}
if(!found){possiblePairs.push(pair);}}
reset(){this.possibleLeftPairs.length=0;this.possibleRightPairs.length=0;}
static constructResult(leftPair,rightPair){let symbolValue=4537077*leftPair.getValue()+rightPair.getValue();let text=new String(symbolValue).toString();let buffer=new StringBuilder();for(let i=13-text.length;i>0;i--){buffer.append('0');}
buffer.append(text);let checkDigit=0;for(let i=0;i<13;i++){let digit=buffer.charAt(i).charCodeAt(0)-'0'.charCodeAt(0);checkDigit+=((i&0x01)===0)?3*digit:digit;}
checkDigit=10-(checkDigit%10);if(checkDigit===10){checkDigit=0;}
buffer.append(checkDigit.toString());let leftPoints=leftPair.getFinderPattern().getResultPoints();let rightPoints=rightPair.getFinderPattern().getResultPoints();return new Result(buffer.toString(),null,0,[leftPoints[0],leftPoints[1],rightPoints[0],rightPoints[1]],BarcodeFormat$1.RSS_14,new Date().getTime());}
static checkChecksum(leftPair,rightPair){let checkValue=(leftPair.getChecksumPortion()+16*rightPair.getChecksumPortion())%79;let targetCheckValue=9*leftPair.getFinderPattern().getValue()+rightPair.getFinderPattern().getValue();if(targetCheckValue>72){targetCheckValue--;}
if(targetCheckValue>8){targetCheckValue--;}
return checkValue===targetCheckValue;}
decodePair(row,right,rowNumber,hints){try{let startEnd=this.findFinderPattern(row,right);let pattern=this.parseFoundFinderPattern(row,rowNumber,right,startEnd);let resultPointCallback=hints==null?null:hints.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);if(resultPointCallback!=null){let center=(startEnd[0]+startEnd[1])/2.0;if(right){center=row.getSize()-1-center;}
resultPointCallback.foundPossibleResultPoint(new ResultPoint(center,rowNumber));}
let outside=this.decodeDataCharacter(row,pattern,true);let inside=this.decodeDataCharacter(row,pattern,false);return new Pair(1597*outside.getValue()+inside.getValue(),outside.getChecksumPortion()+4*inside.getChecksumPortion(),pattern);}
catch(err){return null;}}
decodeDataCharacter(row,pattern,outsideChar){let counters=this.getDataCharacterCounters();for(let x=0;x<counters.length;x++){counters[x]=0;}
if(outsideChar){OneDReader.recordPatternInReverse(row,pattern.getStartEnd()[0],counters);}
else{OneDReader.recordPattern(row,pattern.getStartEnd()[1]+1,counters);for(let i=0,j=counters.length-1;i<j;i++,j--){let temp=counters[i];counters[i]=counters[j];counters[j]=temp;}}
let numModules=outsideChar?16:15;let elementWidth=MathUtils.sum(new Int32Array(counters))/numModules;let oddCounts=this.getOddCounts();let evenCounts=this.getEvenCounts();let oddRoundingErrors=this.getOddRoundingErrors();let evenRoundingErrors=this.getEvenRoundingErrors();for(let i=0;i<counters.length;i++){let value=counters[i]/elementWidth;let count=Math.floor(value+0.5);if(count<1){count=1;}
else if(count>8){count=8;}
let offset=Math.floor(i/2);if((i&0x01)===0){oddCounts[offset]=count;oddRoundingErrors[offset]=value-count;}
else{evenCounts[offset]=count;evenRoundingErrors[offset]=value-count;}}
this.adjustOddEvenCounts(outsideChar,numModules);let oddSum=0;let oddChecksumPortion=0;for(let i=oddCounts.length-1;i>=0;i--){oddChecksumPortion*=9;oddChecksumPortion+=oddCounts[i];oddSum+=oddCounts[i];}
let evenChecksumPortion=0;let evenSum=0;for(let i=evenCounts.length-1;i>=0;i--){evenChecksumPortion*=9;evenChecksumPortion+=evenCounts[i];evenSum+=evenCounts[i];}
let checksumPortion=oddChecksumPortion+3*evenChecksumPortion;if(outsideChar){if((oddSum&0x01)!==0||oddSum>12||oddSum<4){throw new NotFoundException();}
let group=(12-oddSum)/2;let oddWidest=RSS14Reader.OUTSIDE_ODD_WIDEST[group];let evenWidest=9-oddWidest;let vOdd=RSSUtils.getRSSvalue(oddCounts,oddWidest,false);let vEven=RSSUtils.getRSSvalue(evenCounts,evenWidest,true);let tEven=RSS14Reader.OUTSIDE_EVEN_TOTAL_SUBSET[group];let gSum=RSS14Reader.OUTSIDE_GSUM[group];return new DataCharacter(vOdd*tEven+vEven+gSum,checksumPortion);}
else{if((evenSum&0x01)!==0||evenSum>10||evenSum<4){throw new NotFoundException();}
let group=(10-evenSum)/2;let oddWidest=RSS14Reader.INSIDE_ODD_WIDEST[group];let evenWidest=9-oddWidest;let vOdd=RSSUtils.getRSSvalue(oddCounts,oddWidest,true);let vEven=RSSUtils.getRSSvalue(evenCounts,evenWidest,false);let tOdd=RSS14Reader.INSIDE_ODD_TOTAL_SUBSET[group];let gSum=RSS14Reader.INSIDE_GSUM[group];return new DataCharacter(vEven*tOdd+vOdd+gSum,checksumPortion);}}
findFinderPattern(row,rightFinderPattern){let counters=this.getDecodeFinderCounters();counters[0]=0;counters[1]=0;counters[2]=0;counters[3]=0;let width=row.getSize();let isWhite=false;let rowOffset=0;while(rowOffset<width){isWhite=!row.get(rowOffset);if(rightFinderPattern===isWhite){break;}
rowOffset++;}
let counterPosition=0;let patternStart=rowOffset;for(let x=rowOffset;x<width;x++){if(row.get(x)!==isWhite){counters[counterPosition]++;}
else{if(counterPosition===3){if(AbstractRSSReader.isFinderPattern(counters)){return[patternStart,x];}
patternStart+=counters[0]+counters[1];counters[0]=counters[2];counters[1]=counters[3];counters[2]=0;counters[3]=0;counterPosition--;}
else{counterPosition++;}
counters[counterPosition]=1;isWhite=!isWhite;}}
throw new NotFoundException();}
parseFoundFinderPattern(row,rowNumber,right,startEnd){let firstIsBlack=row.get(startEnd[0]);let firstElementStart=startEnd[0]-1;while(firstElementStart>=0&&firstIsBlack!==row.get(firstElementStart)){firstElementStart--;}
firstElementStart++;const firstCounter=startEnd[0]-firstElementStart;const counters=this.getDecodeFinderCounters();const copy=new Int32Array(counters.length);System.arraycopy(counters,0,copy,1,counters.length-1);copy[0]=firstCounter;const value=this.parseFinderValue(copy,RSS14Reader.FINDER_PATTERNS);let start=firstElementStart;let end=startEnd[1];if(right){start=row.getSize()-1-start;end=row.getSize()-1-end;}
return new FinderPattern(value,[firstElementStart,startEnd[1]],start,end,rowNumber);}
adjustOddEvenCounts(outsideChar,numModules){let oddSum=MathUtils.sum(new Int32Array(this.getOddCounts()));let evenSum=MathUtils.sum(new Int32Array(this.getEvenCounts()));let incrementOdd=false;let decrementOdd=false;let incrementEven=false;let decrementEven=false;if(outsideChar){if(oddSum>12){decrementOdd=true;}
else if(oddSum<4){incrementOdd=true;}
if(evenSum>12){decrementEven=true;}
else if(evenSum<4){incrementEven=true;}}
else{if(oddSum>11){decrementOdd=true;}
else if(oddSum<5){incrementOdd=true;}
if(evenSum>10){decrementEven=true;}
else if(evenSum<4){incrementEven=true;}}
let mismatch=oddSum+evenSum-numModules;let oddParityBad=(oddSum&0x01)===(outsideChar?1:0);let evenParityBad=(evenSum&0x01)===1;if(mismatch===1){if(oddParityBad){if(evenParityBad){throw new NotFoundException();}
decrementOdd=true;}
else{if(!evenParityBad){throw new NotFoundException();}
decrementEven=true;}}
else if(mismatch===-1){if(oddParityBad){if(evenParityBad){throw new NotFoundException();}
incrementOdd=true;}
else{if(!evenParityBad){throw new NotFoundException();}
incrementEven=true;}}
else if(mismatch===0){if(oddParityBad){if(!evenParityBad){throw new NotFoundException();}
if(oddSum<evenSum){incrementOdd=true;decrementEven=true;}
else{decrementOdd=true;incrementEven=true;}}
else{if(evenParityBad){throw new NotFoundException();}}}
else{throw new NotFoundException();}
if(incrementOdd){if(decrementOdd){throw new NotFoundException();}
AbstractRSSReader.increment(this.getOddCounts(),this.getOddRoundingErrors());}
if(decrementOdd){AbstractRSSReader.decrement(this.getOddCounts(),this.getOddRoundingErrors());}
if(incrementEven){if(decrementEven){throw new NotFoundException();}
AbstractRSSReader.increment(this.getEvenCounts(),this.getOddRoundingErrors());}
if(decrementEven){AbstractRSSReader.decrement(this.getEvenCounts(),this.getEvenRoundingErrors());}}}
RSS14Reader.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126];RSS14Reader.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81];RSS14Reader.OUTSIDE_GSUM=[0,161,961,2015,2715];RSS14Reader.INSIDE_GSUM=[0,336,1036,1516];RSS14Reader.OUTSIDE_ODD_WIDEST=[8,6,4,3,1];RSS14Reader.INSIDE_ODD_WIDEST=[2,4,6,8];RSS14Reader.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1]),];class MultiFormatOneDReader extends OneDReader{constructor(hints){super();this.readers=[];const possibleFormats=!hints?null:hints.get(DecodeHintType$1.POSSIBLE_FORMATS);const useCode39CheckDigit=hints&&hints.get(DecodeHintType$1.ASSUME_CODE_39_CHECK_DIGIT)!==undefined;if(possibleFormats){if(possibleFormats.includes(BarcodeFormat$1.EAN_13)||possibleFormats.includes(BarcodeFormat$1.UPC_A)||possibleFormats.includes(BarcodeFormat$1.EAN_8)||possibleFormats.includes(BarcodeFormat$1.UPC_E)){this.readers.push(new MultiFormatUPCEANReader(hints));}
if(possibleFormats.includes(BarcodeFormat$1.CODE_39)){this.readers.push(new Code39Reader(useCode39CheckDigit));}
if(possibleFormats.includes(BarcodeFormat$1.CODE_128)){this.readers.push(new Code128Reader());}
if(possibleFormats.includes(BarcodeFormat$1.ITF)){this.readers.push(new ITFReader());}
if(possibleFormats.includes(BarcodeFormat$1.RSS_14)){this.readers.push(new RSS14Reader());}
if(possibleFormats.includes(BarcodeFormat$1.RSS_EXPANDED)){console.warn('RSS Expanded reader IS NOT ready for production yet! use at your own risk.');this.readers.push(new RSSExpandedReader());}}
if(this.readers.length===0){this.readers.push(new MultiFormatUPCEANReader(hints));this.readers.push(new Code39Reader());this.readers.push(new MultiFormatUPCEANReader(hints));this.readers.push(new Code128Reader());this.readers.push(new ITFReader());this.readers.push(new RSS14Reader());}}
decodeRow(rowNumber,row,hints){for(let i=0;i<this.readers.length;i++){try{return this.readers[i].decodeRow(rowNumber,row,hints);}
catch(re){}}
throw new NotFoundException();}
reset(){this.readers.forEach(reader=>reader.reset());}}
class BrowserBarcodeReader extends BrowserCodeReader{constructor(timeBetweenScansMillis=500,hints){super(new MultiFormatOneDReader(hints),timeBetweenScansMillis,hints);}}
class ECBlocks{constructor(ecCodewords,ecBlocks1,ecBlocks2){this.ecCodewords=ecCodewords;this.ecBlocks=[ecBlocks1];ecBlocks2&&this.ecBlocks.push(ecBlocks2);}
getECCodewords(){return this.ecCodewords;}
getECBlocks(){return this.ecBlocks;}}
class ECB{constructor(count,dataCodewords){this.count=count;this.dataCodewords=dataCodewords;}
getCount(){return this.count;}
getDataCodewords(){return this.dataCodewords;}}
class Version{constructor(versionNumber,symbolSizeRows,symbolSizeColumns,dataRegionSizeRows,dataRegionSizeColumns,ecBlocks){this.versionNumber=versionNumber;this.symbolSizeRows=symbolSizeRows;this.symbolSizeColumns=symbolSizeColumns;this.dataRegionSizeRows=dataRegionSizeRows;this.dataRegionSizeColumns=dataRegionSizeColumns;this.ecBlocks=ecBlocks;let total=0;const ecCodewords=ecBlocks.getECCodewords();const ecbArray=ecBlocks.getECBlocks();for(let ecBlock of ecbArray){total+=ecBlock.getCount()*(ecBlock.getDataCodewords()+ecCodewords);}
this.totalCodewords=total;}
getVersionNumber(){return this.versionNumber;}
getSymbolSizeRows(){return this.symbolSizeRows;}
getSymbolSizeColumns(){return this.symbolSizeColumns;}
getDataRegionSizeRows(){return this.dataRegionSizeRows;}
getDataRegionSizeColumns(){return this.dataRegionSizeColumns;}
getTotalCodewords(){return this.totalCodewords;}
getECBlocks(){return this.ecBlocks;}
static getVersionForDimensions(numRows,numColumns){if((numRows&0x01)!==0||(numColumns&0x01)!==0){throw new FormatException();}
for(let version of Version.VERSIONS){if(version.symbolSizeRows===numRows&&version.symbolSizeColumns===numColumns){return version;}}
throw new FormatException();}
toString(){return''+this.versionNumber;}
static buildVersions(){return[new Version(1,10,10,8,8,new ECBlocks(5,new ECB(1,3))),new Version(2,12,12,10,10,new ECBlocks(7,new ECB(1,5))),new Version(3,14,14,12,12,new ECBlocks(10,new ECB(1,8))),new Version(4,16,16,14,14,new ECBlocks(12,new ECB(1,12))),new Version(5,18,18,16,16,new ECBlocks(14,new ECB(1,18))),new Version(6,20,20,18,18,new ECBlocks(18,new ECB(1,22))),new Version(7,22,22,20,20,new ECBlocks(20,new ECB(1,30))),new Version(8,24,24,22,22,new ECBlocks(24,new ECB(1,36))),new Version(9,26,26,24,24,new ECBlocks(28,new ECB(1,44))),new Version(10,32,32,14,14,new ECBlocks(36,new ECB(1,62))),new Version(11,36,36,16,16,new ECBlocks(42,new ECB(1,86))),new Version(12,40,40,18,18,new ECBlocks(48,new ECB(1,114))),new Version(13,44,44,20,20,new ECBlocks(56,new ECB(1,144))),new Version(14,48,48,22,22,new ECBlocks(68,new ECB(1,174))),new Version(15,52,52,24,24,new ECBlocks(42,new ECB(2,102))),new Version(16,64,64,14,14,new ECBlocks(56,new ECB(2,140))),new Version(17,72,72,16,16,new ECBlocks(36,new ECB(4,92))),new Version(18,80,80,18,18,new ECBlocks(48,new ECB(4,114))),new Version(19,88,88,20,20,new ECBlocks(56,new ECB(4,144))),new Version(20,96,96,22,22,new ECBlocks(68,new ECB(4,174))),new Version(21,104,104,24,24,new ECBlocks(56,new ECB(6,136))),new Version(22,120,120,18,18,new ECBlocks(68,new ECB(6,175))),new Version(23,132,132,20,20,new ECBlocks(62,new ECB(8,163))),new Version(24,144,144,22,22,new ECBlocks(62,new ECB(8,156),new ECB(2,155))),new Version(25,8,18,6,16,new ECBlocks(7,new ECB(1,5))),new Version(26,8,32,6,14,new ECBlocks(11,new ECB(1,10))),new Version(27,12,26,10,24,new ECBlocks(14,new ECB(1,16))),new Version(28,12,36,10,16,new ECBlocks(18,new ECB(1,22))),new Version(29,16,36,14,16,new ECBlocks(24,new ECB(1,32))),new Version(30,16,48,14,22,new ECBlocks(28,new ECB(1,49)))];}}
Version.VERSIONS=Version.buildVersions();class BitMatrixParser{constructor(bitMatrix){const dimension=bitMatrix.getHeight();if(dimension<8||dimension>144||(dimension&0x01)!==0){throw new FormatException();}
this.version=BitMatrixParser.readVersion(bitMatrix);this.mappingBitMatrix=this.extractDataRegion(bitMatrix);this.readMappingMatrix=new BitMatrix(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight());}
getVersion(){return this.version;}
static readVersion(bitMatrix){const numRows=bitMatrix.getHeight();const numColumns=bitMatrix.getWidth();return Version.getVersionForDimensions(numRows,numColumns);}
readCodewords(){const result=new Int8Array(this.version.getTotalCodewords());let resultOffset=0;let row=4;let column=0;const numRows=this.mappingBitMatrix.getHeight();const numColumns=this.mappingBitMatrix.getWidth();let corner1Read=false;let corner2Read=false;let corner3Read=false;let corner4Read=false;do{if((row===numRows)&&(column===0)&&!corner1Read){result[resultOffset++]=this.readCorner1(numRows,numColumns)&0xff;row-=2;column+=2;corner1Read=true;}
else if((row===numRows-2)&&(column===0)&&((numColumns&0x03)!==0)&&!corner2Read){result[resultOffset++]=this.readCorner2(numRows,numColumns)&0xff;row-=2;column+=2;corner2Read=true;}
else if((row===numRows+4)&&(column===2)&&((numColumns&0x07)===0)&&!corner3Read){result[resultOffset++]=this.readCorner3(numRows,numColumns)&0xff;row-=2;column+=2;corner3Read=true;}
else if((row===numRows-2)&&(column===0)&&((numColumns&0x07)===4)&&!corner4Read){result[resultOffset++]=this.readCorner4(numRows,numColumns)&0xff;row-=2;column+=2;corner4Read=true;}
else{do{if((row<numRows)&&(column>=0)&&!this.readMappingMatrix.get(column,row)){result[resultOffset++]=this.readUtah(row,column,numRows,numColumns)&0xff;}
row-=2;column+=2;}while((row>=0)&&(column<numColumns));row+=1;column+=3;do{if((row>=0)&&(column<numColumns)&&!this.readMappingMatrix.get(column,row)){result[resultOffset++]=this.readUtah(row,column,numRows,numColumns)&0xff;}
row+=2;column-=2;}while((row<numRows)&&(column>=0));row+=3;column+=1;}}while((row<numRows)||(column<numColumns));if(resultOffset!==this.version.getTotalCodewords()){throw new FormatException();}
return result;}
readModule(row,column,numRows,numColumns){if(row<0){row+=numRows;column+=4-((numRows+4)&0x07);}
if(column<0){column+=numColumns;row+=4-((numColumns+4)&0x07);}
this.readMappingMatrix.set(column,row);return this.mappingBitMatrix.get(column,row);}
readUtah(row,column,numRows,numColumns){let currentByte=0;if(this.readModule(row-2,column-2,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(row-2,column-1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(row-1,column-2,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(row-1,column-1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(row-1,column,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(row,column-2,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(row,column-1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(row,column,numRows,numColumns)){currentByte|=1;}
return currentByte;}
readCorner1(numRows,numColumns){let currentByte=0;if(this.readModule(numRows-1,0,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(numRows-1,1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(numRows-1,2,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(0,numColumns-2,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(0,numColumns-1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(1,numColumns-1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(2,numColumns-1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(3,numColumns-1,numRows,numColumns)){currentByte|=1;}
return currentByte;}
readCorner2(numRows,numColumns){let currentByte=0;if(this.readModule(numRows-3,0,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(numRows-2,0,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(numRows-1,0,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(0,numColumns-4,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(0,numColumns-3,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(0,numColumns-2,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(0,numColumns-1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(1,numColumns-1,numRows,numColumns)){currentByte|=1;}
return currentByte;}
readCorner3(numRows,numColumns){let currentByte=0;if(this.readModule(numRows-1,0,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(numRows-1,numColumns-1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(0,numColumns-3,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(0,numColumns-2,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(0,numColumns-1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(1,numColumns-3,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(1,numColumns-2,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(1,numColumns-1,numRows,numColumns)){currentByte|=1;}
return currentByte;}
readCorner4(numRows,numColumns){let currentByte=0;if(this.readModule(numRows-3,0,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(numRows-2,0,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(numRows-1,0,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(0,numColumns-2,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(0,numColumns-1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(1,numColumns-1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(2,numColumns-1,numRows,numColumns)){currentByte|=1;}
currentByte<<=1;if(this.readModule(3,numColumns-1,numRows,numColumns)){currentByte|=1;}
return currentByte;}
extractDataRegion(bitMatrix){const symbolSizeRows=this.version.getSymbolSizeRows();const symbolSizeColumns=this.version.getSymbolSizeColumns();if(bitMatrix.getHeight()!==symbolSizeRows){throw new IllegalArgumentException('Dimension of bitMatrix must match the version size');}
const dataRegionSizeRows=this.version.getDataRegionSizeRows();const dataRegionSizeColumns=this.version.getDataRegionSizeColumns();const numDataRegionsRow=symbolSizeRows/dataRegionSizeRows|0;const numDataRegionsColumn=symbolSizeColumns/dataRegionSizeColumns|0;const sizeDataRegionRow=numDataRegionsRow*dataRegionSizeRows;const sizeDataRegionColumn=numDataRegionsColumn*dataRegionSizeColumns;const bitMatrixWithoutAlignment=new BitMatrix(sizeDataRegionColumn,sizeDataRegionRow);for(let dataRegionRow=0;dataRegionRow<numDataRegionsRow;++dataRegionRow){const dataRegionRowOffset=dataRegionRow*dataRegionSizeRows;for(let dataRegionColumn=0;dataRegionColumn<numDataRegionsColumn;++dataRegionColumn){const dataRegionColumnOffset=dataRegionColumn*dataRegionSizeColumns;for(let i=0;i<dataRegionSizeRows;++i){const readRowOffset=dataRegionRow*(dataRegionSizeRows+2)+1+i;const writeRowOffset=dataRegionRowOffset+i;for(let j=0;j<dataRegionSizeColumns;++j){const readColumnOffset=dataRegionColumn*(dataRegionSizeColumns+2)+1+j;if(bitMatrix.get(readColumnOffset,readRowOffset)){const writeColumnOffset=dataRegionColumnOffset+j;bitMatrixWithoutAlignment.set(writeColumnOffset,writeRowOffset);}}}}}
return bitMatrixWithoutAlignment;}}
class DataBlock{constructor(numDataCodewords,codewords){this.numDataCodewords=numDataCodewords;this.codewords=codewords;}
static getDataBlocks(rawCodewords,version){const ecBlocks=version.getECBlocks();let totalBlocks=0;const ecBlockArray=ecBlocks.getECBlocks();for(let ecBlock of ecBlockArray){totalBlocks+=ecBlock.getCount();}
const result=new Array(totalBlocks);let numResultBlocks=0;for(let ecBlock of ecBlockArray){for(let i=0;i<ecBlock.getCount();i++){const numDataCodewords=ecBlock.getDataCodewords();const numBlockCodewords=ecBlocks.getECCodewords()+numDataCodewords;result[numResultBlocks++]=new DataBlock(numDataCodewords,new Uint8Array(numBlockCodewords));}}
const longerBlocksTotalCodewords=result[0].codewords.length;const longerBlocksNumDataCodewords=longerBlocksTotalCodewords-ecBlocks.getECCodewords();const shorterBlocksNumDataCodewords=longerBlocksNumDataCodewords-1;let rawCodewordsOffset=0;for(let i=0;i<shorterBlocksNumDataCodewords;i++){for(let j=0;j<numResultBlocks;j++){result[j].codewords[i]=rawCodewords[rawCodewordsOffset++];}}
const specialVersion=version.getVersionNumber()===24;const numLongerBlocks=specialVersion?8:numResultBlocks;for(let j=0;j<numLongerBlocks;j++){result[j].codewords[longerBlocksNumDataCodewords-1]=rawCodewords[rawCodewordsOffset++];}
const max=result[0].codewords.length;for(let i=longerBlocksNumDataCodewords;i<max;i++){for(let j=0;j<numResultBlocks;j++){const jOffset=specialVersion?(j+8)%numResultBlocks:j;const iOffset=specialVersion&&jOffset>7?i-1:i;result[jOffset].codewords[iOffset]=rawCodewords[rawCodewordsOffset++];}}
if(rawCodewordsOffset!==rawCodewords.length){throw new IllegalArgumentException();}
return result;}
getNumDataCodewords(){return this.numDataCodewords;}
getCodewords(){return this.codewords;}}
class BitSource{constructor(bytes){this.bytes=bytes;this.byteOffset=0;this.bitOffset=0;}
getBitOffset(){return this.bitOffset;}
getByteOffset(){return this.byteOffset;}
readBits(numBits){if(numBits<1||numBits>32||numBits>this.available()){throw new IllegalArgumentException(''+numBits);}
let result=0;let bitOffset=this.bitOffset;let byteOffset=this.byteOffset;const bytes=this.bytes;if(bitOffset>0){const bitsLeft=8-bitOffset;const toRead=numBits<bitsLeft?numBits:bitsLeft;const bitsToNotRead=bitsLeft-toRead;const mask=(0xFF>>(8-toRead))<<bitsToNotRead;result=(bytes[byteOffset]&mask)>>bitsToNotRead;numBits-=toRead;bitOffset+=toRead;if(bitOffset===8){bitOffset=0;byteOffset++;}}
if(numBits>0){while(numBits>=8){result=(result<<8)|(bytes[byteOffset]&0xFF);byteOffset++;numBits-=8;}
if(numBits>0){const bitsToNotRead=8-numBits;const mask=(0xFF>>bitsToNotRead)<<bitsToNotRead;result=(result<<numBits)|((bytes[byteOffset]&mask)>>bitsToNotRead);bitOffset+=numBits;}}
this.bitOffset=bitOffset;this.byteOffset=byteOffset;return result;}
available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset;}}
var Mode;(function(Mode){Mode[Mode["PAD_ENCODE"]=0]="PAD_ENCODE";Mode[Mode["ASCII_ENCODE"]=1]="ASCII_ENCODE";Mode[Mode["C40_ENCODE"]=2]="C40_ENCODE";Mode[Mode["TEXT_ENCODE"]=3]="TEXT_ENCODE";Mode[Mode["ANSIX12_ENCODE"]=4]="ANSIX12_ENCODE";Mode[Mode["EDIFACT_ENCODE"]=5]="EDIFACT_ENCODE";Mode[Mode["BASE256_ENCODE"]=6]="BASE256_ENCODE";})(Mode||(Mode={}));class DecodedBitStreamParser{static decode(bytes){const bits=new BitSource(bytes);const result=new StringBuilder();const resultTrailer=new StringBuilder();const byteSegments=new Array();let mode=Mode.ASCII_ENCODE;do{if(mode===Mode.ASCII_ENCODE){mode=this.decodeAsciiSegment(bits,result,resultTrailer);}
else{switch(mode){case Mode.C40_ENCODE:this.decodeC40Segment(bits,result);break;case Mode.TEXT_ENCODE:this.decodeTextSegment(bits,result);break;case Mode.ANSIX12_ENCODE:this.decodeAnsiX12Segment(bits,result);break;case Mode.EDIFACT_ENCODE:this.decodeEdifactSegment(bits,result);break;case Mode.BASE256_ENCODE:this.decodeBase256Segment(bits,result,byteSegments);break;default:throw new FormatException();}
mode=Mode.ASCII_ENCODE;}}while(mode!==Mode.PAD_ENCODE&&bits.available()>0);if(resultTrailer.length()>0){result.append(resultTrailer.toString());}
return new DecoderResult(bytes,result.toString(),byteSegments.length===0?null:byteSegments,null);}
static decodeAsciiSegment(bits,result,resultTrailer){let upperShift=false;do{let oneByte=bits.readBits(8);if(oneByte===0){throw new FormatException();}
else if(oneByte<=128){if(upperShift){oneByte+=128;}
result.append(String.fromCharCode(oneByte-1));return Mode.ASCII_ENCODE;}
else if(oneByte===129){return Mode.PAD_ENCODE;}
else if(oneByte<=229){const value=oneByte-130;if(value<10){result.append('0');}
result.append(''+value);}
else{switch(oneByte){case 230:return Mode.C40_ENCODE;case 231:return Mode.BASE256_ENCODE;case 232:result.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:upperShift=true;break;case 236:result.append('[)>\u001E05\u001D');resultTrailer.insert(0,'\u001E\u0004');break;case 237:result.append('[)>\u001E06\u001D');resultTrailer.insert(0,'\u001E\u0004');break;case 238:return Mode.ANSIX12_ENCODE;case 239:return Mode.TEXT_ENCODE;case 240:return Mode.EDIFACT_ENCODE;case 241:break;default:if(oneByte!==254||bits.available()!==0){throw new FormatException();}
break;}}}while(bits.available()>0);return Mode.ASCII_ENCODE;}
static decodeC40Segment(bits,result){let upperShift=false;const cValues=[];let shift=0;do{if(bits.available()===8){return;}
const firstByte=bits.readBits(8);if(firstByte===254){return;}
this.parseTwoBytes(firstByte,bits.readBits(8),cValues);for(let i=0;i<3;i++){const cValue=cValues[i];switch(shift){case 0:if(cValue<3){shift=cValue+1;}
else if(cValue<this.C40_BASIC_SET_CHARS.length){const c40char=this.C40_BASIC_SET_CHARS[cValue];if(upperShift){result.append(String.fromCharCode(c40char.charCodeAt(0)+128));upperShift=false;}
else{result.append(c40char);}}
else{throw new FormatException();}
break;case 1:if(upperShift){result.append(String.fromCharCode(cValue+128));upperShift=false;}
else{result.append(String.fromCharCode(cValue));}
shift=0;break;case 2:if(cValue<this.C40_SHIFT2_SET_CHARS.length){const c40char=this.C40_SHIFT2_SET_CHARS[cValue];if(upperShift){result.append(String.fromCharCode(c40char.charCodeAt(0)+128));upperShift=false;}
else{result.append(c40char);}}
else{switch(cValue){case 27:result.append(String.fromCharCode(29));break;case 30:upperShift=true;break;default:throw new FormatException();}}
shift=0;break;case 3:if(upperShift){result.append(String.fromCharCode(cValue+224));upperShift=false;}
else{result.append(String.fromCharCode(cValue+96));}
shift=0;break;default:throw new FormatException();}}}while(bits.available()>0);}
static decodeTextSegment(bits,result){let upperShift=false;let cValues=[];let shift=0;do{if(bits.available()===8){return;}
const firstByte=bits.readBits(8);if(firstByte===254){return;}
this.parseTwoBytes(firstByte,bits.readBits(8),cValues);for(let i=0;i<3;i++){const cValue=cValues[i];switch(shift){case 0:if(cValue<3){shift=cValue+1;}
else if(cValue<this.TEXT_BASIC_SET_CHARS.length){const textChar=this.TEXT_BASIC_SET_CHARS[cValue];if(upperShift){result.append(String.fromCharCode(textChar.charCodeAt(0)+128));upperShift=false;}
else{result.append(textChar);}}
else{throw new FormatException();}
break;case 1:if(upperShift){result.append(String.fromCharCode(cValue+128));upperShift=false;}
else{result.append(String.fromCharCode(cValue));}
shift=0;break;case 2:if(cValue<this.TEXT_SHIFT2_SET_CHARS.length){const textChar=this.TEXT_SHIFT2_SET_CHARS[cValue];if(upperShift){result.append(String.fromCharCode(textChar.charCodeAt(0)+128));upperShift=false;}
else{result.append(textChar);}}
else{switch(cValue){case 27:result.append(String.fromCharCode(29));break;case 30:upperShift=true;break;default:throw new FormatException();}}
shift=0;break;case 3:if(cValue<this.TEXT_SHIFT3_SET_CHARS.length){const textChar=this.TEXT_SHIFT3_SET_CHARS[cValue];if(upperShift){result.append(String.fromCharCode(textChar.charCodeAt(0)+128));upperShift=false;}
else{result.append(textChar);}
shift=0;}
else{throw new FormatException();}
break;default:throw new FormatException();}}}while(bits.available()>0);}
static decodeAnsiX12Segment(bits,result){const cValues=[];do{if(bits.available()===8){return;}
const firstByte=bits.readBits(8);if(firstByte===254){return;}
this.parseTwoBytes(firstByte,bits.readBits(8),cValues);for(let i=0;i<3;i++){const cValue=cValues[i];switch(cValue){case 0:result.append('\r');break;case 1:result.append('*');break;case 2:result.append('>');break;case 3:result.append(' ');break;default:if(cValue<14){result.append(String.fromCharCode(cValue+44));}
else if(cValue<40){result.append(String.fromCharCode(cValue+51));}
else{throw new FormatException();}
break;}}}while(bits.available()>0);}
static parseTwoBytes(firstByte,secondByte,result){let fullBitValue=(firstByte<<8)+secondByte-1;let temp=Math.floor(fullBitValue/1600);result[0]=temp;fullBitValue-=temp*1600;temp=Math.floor(fullBitValue/40);result[1]=temp;result[2]=fullBitValue-temp*40;}
static decodeEdifactSegment(bits,result){do{if(bits.available()<=16){return;}
for(let i=0;i<4;i++){let edifactValue=bits.readBits(6);if(edifactValue===0x1F){const bitsLeft=8-bits.getBitOffset();if(bitsLeft!==8){bits.readBits(bitsLeft);}
return;}
if((edifactValue&0x20)===0){edifactValue|=0x40;}
result.append(String.fromCharCode(edifactValue));}}while(bits.available()>0);}
static decodeBase256Segment(bits,result,byteSegments){let codewordPosition=1+bits.getByteOffset();const d1=this.unrandomize255State(bits.readBits(8),codewordPosition++);let count;if(d1===0){count=bits.available()/8|0;}
else if(d1<250){count=d1;}
else{count=250*(d1-249)+this.unrandomize255State(bits.readBits(8),codewordPosition++);}
if(count<0){throw new FormatException();}
const bytes=new Uint8Array(count);for(let i=0;i<count;i++){if(bits.available()<8){throw new FormatException();}
bytes[i]=this.unrandomize255State(bits.readBits(8),codewordPosition++);}
byteSegments.push(bytes);try{result.append(StringEncoding.decode(bytes,StringUtils.ISO88591));}
catch(uee){throw new IllegalStateException('Platform does not support required encoding: '+uee.message);}}
static unrandomize255State(randomizedBase256Codeword,base256CodewordPosition){const pseudoRandomNumber=((149*base256CodewordPosition)%255)+1;const tempVariable=randomizedBase256Codeword-pseudoRandomNumber;return tempVariable>=0?tempVariable:tempVariable+256;}}
DecodedBitStreamParser.C40_BASIC_SET_CHARS=['*','*','*',' ','0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];DecodedBitStreamParser.C40_SHIFT2_SET_CHARS=['!','"','#','$','%','&','\'','(',')','*','+',',','-','.','/',':',';','<','=','>','?','@','[','\\',']','^','_'];DecodedBitStreamParser.TEXT_BASIC_SET_CHARS=['*','*','*',' ','0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'];DecodedBitStreamParser.TEXT_SHIFT2_SET_CHARS=DecodedBitStreamParser.C40_SHIFT2_SET_CHARS;DecodedBitStreamParser.TEXT_SHIFT3_SET_CHARS=['`','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','{','|','}','~',String.fromCharCode(127)];class Decoder$1{constructor(){this.rsDecoder=new ReedSolomonDecoder(GenericGF.DATA_MATRIX_FIELD_256);}
decode(bits){const parser=new BitMatrixParser(bits);const version=parser.getVersion();const codewords=parser.readCodewords();const dataBlocks=DataBlock.getDataBlocks(codewords,version);let totalBytes=0;for(let db of dataBlocks){totalBytes+=db.getNumDataCodewords();}
const resultBytes=new Uint8Array(totalBytes);const dataBlocksCount=dataBlocks.length;for(let j=0;j<dataBlocksCount;j++){const dataBlock=dataBlocks[j];const codewordBytes=dataBlock.getCodewords();const numDataCodewords=dataBlock.getNumDataCodewords();this.correctErrors(codewordBytes,numDataCodewords);for(let i=0;i<numDataCodewords;i++){resultBytes[i*dataBlocksCount+j]=codewordBytes[i];}}
return DecodedBitStreamParser.decode(resultBytes);}
correctErrors(codewordBytes,numDataCodewords){const codewordsInts=new Int32Array(codewordBytes);try{this.rsDecoder.decode(codewordsInts,codewordBytes.length-numDataCodewords);}
catch(ignored){throw new ChecksumException();}
for(let i=0;i<numDataCodewords;i++){codewordBytes[i]=codewordsInts[i];}}}
class Detector$1{constructor(image){this.image=image;this.rectangleDetector=new WhiteRectangleDetector(this.image);}
detect(){const cornerPoints=this.rectangleDetector.detect();let points=this.detectSolid1(cornerPoints);points=this.detectSolid2(points);points[3]=this.correctTopRight(points);if(!points[3]){throw new NotFoundException();}
points=this.shiftToModuleCenter(points);const topLeft=points[0];const bottomLeft=points[1];const bottomRight=points[2];const topRight=points[3];let dimensionTop=this.transitionsBetween(topLeft,topRight)+1;let dimensionRight=this.transitionsBetween(bottomRight,topRight)+1;if((dimensionTop&0x01)===1){dimensionTop+=1;}
if((dimensionRight&0x01)===1){dimensionRight+=1;}
if(4*dimensionTop<7*dimensionRight&&4*dimensionRight<7*dimensionTop){dimensionTop=dimensionRight=Math.max(dimensionTop,dimensionRight);}
let bits=Detector$1.sampleGrid(this.image,topLeft,bottomLeft,bottomRight,topRight,dimensionTop,dimensionRight);return new DetectorResult(bits,[topLeft,bottomLeft,bottomRight,topRight]);}
static shiftPoint(point,to,div){let x=(to.getX()-point.getX())/(div+1);let y=(to.getY()-point.getY())/(div+1);return new ResultPoint(point.getX()+x,point.getY()+y);}
static moveAway(point,fromX,fromY){let x=point.getX();let y=point.getY();if(x<fromX){x-=1;}
else{x+=1;}
if(y<fromY){y-=1;}
else{y+=1;}
return new ResultPoint(x,y);}
detectSolid1(cornerPoints){let pointA=cornerPoints[0];let pointB=cornerPoints[1];let pointC=cornerPoints[3];let pointD=cornerPoints[2];let trAB=this.transitionsBetween(pointA,pointB);let trBC=this.transitionsBetween(pointB,pointC);let trCD=this.transitionsBetween(pointC,pointD);let trDA=this.transitionsBetween(pointD,pointA);let min=trAB;let points=[pointD,pointA,pointB,pointC];if(min>trBC){min=trBC;points[0]=pointA;points[1]=pointB;points[2]=pointC;points[3]=pointD;}
if(min>trCD){min=trCD;points[0]=pointB;points[1]=pointC;points[2]=pointD;points[3]=pointA;}
if(min>trDA){points[0]=pointC;points[1]=pointD;points[2]=pointA;points[3]=pointB;}
return points;}
detectSolid2(points){let pointA=points[0];let pointB=points[1];let pointC=points[2];let pointD=points[3];let tr=this.transitionsBetween(pointA,pointD);let pointBs=Detector$1.shiftPoint(pointB,pointC,(tr+1)*4);let pointCs=Detector$1.shiftPoint(pointC,pointB,(tr+1)*4);let trBA=this.transitionsBetween(pointBs,pointA);let trCD=this.transitionsBetween(pointCs,pointD);if(trBA<trCD){points[0]=pointA;points[1]=pointB;points[2]=pointC;points[3]=pointD;}
else{points[0]=pointB;points[1]=pointC;points[2]=pointD;points[3]=pointA;}
return points;}
correctTopRight(points){let pointA=points[0];let pointB=points[1];let pointC=points[2];let pointD=points[3];let trTop=this.transitionsBetween(pointA,pointD);let trRight=this.transitionsBetween(pointB,pointD);let pointAs=Detector$1.shiftPoint(pointA,pointB,(trRight+1)*4);let pointCs=Detector$1.shiftPoint(pointC,pointB,(trTop+1)*4);trTop=this.transitionsBetween(pointAs,pointD);trRight=this.transitionsBetween(pointCs,pointD);let candidate1=new ResultPoint(pointD.getX()+(pointC.getX()-pointB.getX())/(trTop+1),pointD.getY()+(pointC.getY()-pointB.getY())/(trTop+1));let candidate2=new ResultPoint(pointD.getX()+(pointA.getX()-pointB.getX())/(trRight+1),pointD.getY()+(pointA.getY()-pointB.getY())/(trRight+1));if(!this.isValid(candidate1)){if(this.isValid(candidate2)){return candidate2;}
return null;}
if(!this.isValid(candidate2)){return candidate1;}
let sumc1=this.transitionsBetween(pointAs,candidate1)+this.transitionsBetween(pointCs,candidate1);let sumc2=this.transitionsBetween(pointAs,candidate2)+this.transitionsBetween(pointCs,candidate2);if(sumc1>sumc2){return candidate1;}
else{return candidate2;}}
shiftToModuleCenter(points){let pointA=points[0];let pointB=points[1];let pointC=points[2];let pointD=points[3];let dimH=this.transitionsBetween(pointA,pointD)+1;let dimV=this.transitionsBetween(pointC,pointD)+1;let pointAs=Detector$1.shiftPoint(pointA,pointB,dimV*4);let pointCs=Detector$1.shiftPoint(pointC,pointB,dimH*4);dimH=this.transitionsBetween(pointAs,pointD)+1;dimV=this.transitionsBetween(pointCs,pointD)+1;if((dimH&0x01)===1){dimH+=1;}
if((dimV&0x01)===1){dimV+=1;}
let centerX=(pointA.getX()+pointB.getX()+pointC.getX()+pointD.getX())/4;let centerY=(pointA.getY()+pointB.getY()+pointC.getY()+pointD.getY())/4;pointA=Detector$1.moveAway(pointA,centerX,centerY);pointB=Detector$1.moveAway(pointB,centerX,centerY);pointC=Detector$1.moveAway(pointC,centerX,centerY);pointD=Detector$1.moveAway(pointD,centerX,centerY);let pointBs;let pointDs;pointAs=Detector$1.shiftPoint(pointA,pointB,dimV*4);pointAs=Detector$1.shiftPoint(pointAs,pointD,dimH*4);pointBs=Detector$1.shiftPoint(pointB,pointA,dimV*4);pointBs=Detector$1.shiftPoint(pointBs,pointC,dimH*4);pointCs=Detector$1.shiftPoint(pointC,pointD,dimV*4);pointCs=Detector$1.shiftPoint(pointCs,pointB,dimH*4);pointDs=Detector$1.shiftPoint(pointD,pointC,dimV*4);pointDs=Detector$1.shiftPoint(pointDs,pointA,dimH*4);return[pointAs,pointBs,pointCs,pointDs];}
isValid(p){return p.getX()>=0&&p.getX()<this.image.getWidth()&&p.getY()>0&&p.getY()<this.image.getHeight();}
static sampleGrid(image,topLeft,bottomLeft,bottomRight,topRight,dimensionX,dimensionY){const sampler=GridSamplerInstance.getInstance();return sampler.sampleGrid(image,dimensionX,dimensionY,0.5,0.5,dimensionX-0.5,0.5,dimensionX-0.5,dimensionY-0.5,0.5,dimensionY-0.5,topLeft.getX(),topLeft.getY(),topRight.getX(),topRight.getY(),bottomRight.getX(),bottomRight.getY(),bottomLeft.getX(),bottomLeft.getY());}
transitionsBetween(from,to){let fromX=Math.trunc(from.getX());let fromY=Math.trunc(from.getY());let toX=Math.trunc(to.getX());let toY=Math.trunc(to.getY());let steep=Math.abs(toY-fromY)>Math.abs(toX-fromX);if(steep){let temp=fromX;fromX=fromY;fromY=temp;temp=toX;toX=toY;toY=temp;}
let dx=Math.abs(toX-fromX);let dy=Math.abs(toY-fromY);let error=-dx/2;let ystep=fromY<toY?1:-1;let xstep=fromX<toX?1:-1;let transitions=0;let inBlack=this.image.get(steep?fromY:fromX,steep?fromX:fromY);for(let x=fromX,y=fromY;x!==toX;x+=xstep){let isBlack=this.image.get(steep?y:x,steep?x:y);if(isBlack!==inBlack){transitions++;inBlack=isBlack;}
error+=dy;if(error>0){if(y===toY){break;}
y+=ystep;error-=dx;}}
return transitions;}}
class DataMatrixReader{constructor(){this.decoder=new Decoder$1();}
decode(image,hints=null){let decoderResult;let points;if(hints!=null&&hints.has(DecodeHintType$1.PURE_BARCODE)){const bits=DataMatrixReader.extractPureBits(image.getBlackMatrix());decoderResult=this.decoder.decode(bits);points=DataMatrixReader.NO_POINTS;}
else{const detectorResult=new Detector$1(image.getBlackMatrix()).detect();decoderResult=this.decoder.decode(detectorResult.getBits());points=detectorResult.getPoints();}
const rawBytes=decoderResult.getRawBytes();const result=new Result(decoderResult.getText(),rawBytes,8*rawBytes.length,points,BarcodeFormat$1.DATA_MATRIX,System.currentTimeMillis());const byteSegments=decoderResult.getByteSegments();if(byteSegments!=null){result.putMetadata(ResultMetadataType$1.BYTE_SEGMENTS,byteSegments);}
const ecLevel=decoderResult.getECLevel();if(ecLevel!=null){result.putMetadata(ResultMetadataType$1.ERROR_CORRECTION_LEVEL,ecLevel);}
return result;}
reset(){}
static extractPureBits(image){const leftTopBlack=image.getTopLeftOnBit();const rightBottomBlack=image.getBottomRightOnBit();if(leftTopBlack==null||rightBottomBlack==null){throw new NotFoundException();}
const moduleSize=this.moduleSize(leftTopBlack,image);let top=leftTopBlack[1];const bottom=rightBottomBlack[1];let left=leftTopBlack[0];const right=rightBottomBlack[0];const matrixWidth=(right-left+1)/moduleSize;const matrixHeight=(bottom-top+1)/moduleSize;if(matrixWidth<=0||matrixHeight<=0){throw new NotFoundException();}
const nudge=moduleSize/2;top+=nudge;left+=nudge;const bits=new BitMatrix(matrixWidth,matrixHeight);for(let y=0;y<matrixHeight;y++){const iOffset=top+y*moduleSize;for(let x=0;x<matrixWidth;x++){if(image.get(left+x*moduleSize,iOffset)){bits.set(x,y);}}}
return bits;}
static moduleSize(leftTopBlack,image){const width=image.getWidth();let x=leftTopBlack[0];const y=leftTopBlack[1];while(x<width&&image.get(x,y)){x++;}
if(x===width){throw new NotFoundException();}
const moduleSize=x-leftTopBlack[0];if(moduleSize===0){throw new NotFoundException();}
return moduleSize;}}
DataMatrixReader.NO_POINTS=[];class BrowserDatamatrixCodeReader extends BrowserCodeReader{constructor(timeBetweenScansMillis=500){super(new DataMatrixReader(),timeBetweenScansMillis);}}
var ErrorCorrectionLevelValues;(function(ErrorCorrectionLevelValues){ErrorCorrectionLevelValues[ErrorCorrectionLevelValues["L"]=0]="L";ErrorCorrectionLevelValues[ErrorCorrectionLevelValues["M"]=1]="M";ErrorCorrectionLevelValues[ErrorCorrectionLevelValues["Q"]=2]="Q";ErrorCorrectionLevelValues[ErrorCorrectionLevelValues["H"]=3]="H";})(ErrorCorrectionLevelValues||(ErrorCorrectionLevelValues={}));class ErrorCorrectionLevel{constructor(value,stringValue,bits){this.value=value;this.stringValue=stringValue;this.bits=bits;ErrorCorrectionLevel.FOR_BITS.set(bits,this);ErrorCorrectionLevel.FOR_VALUE.set(value,this);}
getValue(){return this.value;}
getBits(){return this.bits;}
static fromString(s){switch(s){case'L':return ErrorCorrectionLevel.L;case'M':return ErrorCorrectionLevel.M;case'Q':return ErrorCorrectionLevel.Q;case'H':return ErrorCorrectionLevel.H;default:throw new ArgumentException(s+'not available');}}
toString(){return this.stringValue;}
equals(o){if(!(o instanceof ErrorCorrectionLevel)){return false;}
const other=o;return this.value===other.value;}
static forBits(bits){if(bits<0||bits>=ErrorCorrectionLevel.FOR_BITS.size){throw new IllegalArgumentException();}
return ErrorCorrectionLevel.FOR_BITS.get(bits);}}
ErrorCorrectionLevel.FOR_BITS=new Map();ErrorCorrectionLevel.FOR_VALUE=new Map();ErrorCorrectionLevel.L=new ErrorCorrectionLevel(ErrorCorrectionLevelValues.L,'L',0x01);ErrorCorrectionLevel.M=new ErrorCorrectionLevel(ErrorCorrectionLevelValues.M,'M',0x00);ErrorCorrectionLevel.Q=new ErrorCorrectionLevel(ErrorCorrectionLevelValues.Q,'Q',0x03);ErrorCorrectionLevel.H=new ErrorCorrectionLevel(ErrorCorrectionLevelValues.H,'H',0x02);class FormatInformation{constructor(formatInfo){this.errorCorrectionLevel=ErrorCorrectionLevel.forBits((formatInfo>>3)&0x03);this.dataMask=(formatInfo&0x07);}
static numBitsDiffering(a,b){return Integer.bitCount(a^b);}
static decodeFormatInformation(maskedFormatInfo1,maskedFormatInfo2){const formatInfo=FormatInformation.doDecodeFormatInformation(maskedFormatInfo1,maskedFormatInfo2);if(formatInfo!==null){return formatInfo;}
return FormatInformation.doDecodeFormatInformation(maskedFormatInfo1^FormatInformation.FORMAT_INFO_MASK_QR,maskedFormatInfo2^FormatInformation.FORMAT_INFO_MASK_QR);}
static doDecodeFormatInformation(maskedFormatInfo1,maskedFormatInfo2){let bestDifference=Number.MAX_SAFE_INTEGER;let bestFormatInfo=0;for(const decodeInfo of FormatInformation.FORMAT_INFO_DECODE_LOOKUP){const targetInfo=decodeInfo[0];if(targetInfo===maskedFormatInfo1||targetInfo===maskedFormatInfo2){return new FormatInformation(decodeInfo[1]);}
let bitsDifference=FormatInformation.numBitsDiffering(maskedFormatInfo1,targetInfo);if(bitsDifference<bestDifference){bestFormatInfo=decodeInfo[1];bestDifference=bitsDifference;}
if(maskedFormatInfo1!==maskedFormatInfo2){bitsDifference=FormatInformation.numBitsDiffering(maskedFormatInfo2,targetInfo);if(bitsDifference<bestDifference){bestFormatInfo=decodeInfo[1];bestDifference=bitsDifference;}}}
if(bestDifference<=3){return new FormatInformation(bestFormatInfo);}
return null;}
getErrorCorrectionLevel(){return this.errorCorrectionLevel;}
getDataMask(){return this.dataMask;}
hashCode(){return(this.errorCorrectionLevel.getBits()<<3)|this.dataMask;}
equals(o){if(!(o instanceof FormatInformation)){return false;}
const other=o;return this.errorCorrectionLevel===other.errorCorrectionLevel&&this.dataMask===other.dataMask;}}
FormatInformation.FORMAT_INFO_MASK_QR=0x5412;FormatInformation.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([0x5412,0x00]),Int32Array.from([0x5125,0x01]),Int32Array.from([0x5E7C,0x02]),Int32Array.from([0x5B4B,0x03]),Int32Array.from([0x45F9,0x04]),Int32Array.from([0x40CE,0x05]),Int32Array.from([0x4F97,0x06]),Int32Array.from([0x4AA0,0x07]),Int32Array.from([0x77C4,0x08]),Int32Array.from([0x72F3,0x09]),Int32Array.from([0x7DAA,0x0A]),Int32Array.from([0x789D,0x0B]),Int32Array.from([0x662F,0x0C]),Int32Array.from([0x6318,0x0D]),Int32Array.from([0x6C41,0x0E]),Int32Array.from([0x6976,0x0F]),Int32Array.from([0x1689,0x10]),Int32Array.from([0x13BE,0x11]),Int32Array.from([0x1CE7,0x12]),Int32Array.from([0x19D0,0x13]),Int32Array.from([0x0762,0x14]),Int32Array.from([0x0255,0x15]),Int32Array.from([0x0D0C,0x16]),Int32Array.from([0x083B,0x17]),Int32Array.from([0x355F,0x18]),Int32Array.from([0x3068,0x19]),Int32Array.from([0x3F31,0x1A]),Int32Array.from([0x3A06,0x1B]),Int32Array.from([0x24B4,0x1C]),Int32Array.from([0x2183,0x1D]),Int32Array.from([0x2EDA,0x1E]),Int32Array.from([0x2BED,0x1F]),];class ECBlocks$1{constructor(ecCodewordsPerBlock,...ecBlocks){this.ecCodewordsPerBlock=ecCodewordsPerBlock;this.ecBlocks=ecBlocks;}
getECCodewordsPerBlock(){return this.ecCodewordsPerBlock;}
getNumBlocks(){let total=0;const ecBlocks=this.ecBlocks;for(const ecBlock of ecBlocks){total+=ecBlock.getCount();}
return total;}
getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks();}
getECBlocks(){return this.ecBlocks;}}
class ECB$1{constructor(count,dataCodewords){this.count=count;this.dataCodewords=dataCodewords;}
getCount(){return this.count;}
getDataCodewords(){return this.dataCodewords;}}
class Version$1{constructor(versionNumber,alignmentPatternCenters,...ecBlocks){this.versionNumber=versionNumber;this.alignmentPatternCenters=alignmentPatternCenters;this.ecBlocks=ecBlocks;let total=0;const ecCodewords=ecBlocks[0].getECCodewordsPerBlock();const ecbArray=ecBlocks[0].getECBlocks();for(const ecBlock of ecbArray){total+=ecBlock.getCount()*(ecBlock.getDataCodewords()+ecCodewords);}
this.totalCodewords=total;}
getVersionNumber(){return this.versionNumber;}
getAlignmentPatternCenters(){return this.alignmentPatternCenters;}
getTotalCodewords(){return this.totalCodewords;}
getDimensionForVersion(){return 17+4*this.versionNumber;}
getECBlocksForLevel(ecLevel){return this.ecBlocks[ecLevel.getValue()];}
static getProvisionalVersionForDimension(dimension){if(dimension%4!==1){throw new FormatException();}
try{return this.getVersionForNumber((dimension-17)/4);}
catch(ignored){throw new FormatException();}}
static getVersionForNumber(versionNumber){if(versionNumber<1||versionNumber>40){throw new IllegalArgumentException();}
return Version$1.VERSIONS[versionNumber-1];}
static decodeVersionInformation(versionBits){let bestDifference=Number.MAX_SAFE_INTEGER;let bestVersion=0;for(let i=0;i<Version$1.VERSION_DECODE_INFO.length;i++){const targetVersion=Version$1.VERSION_DECODE_INFO[i];if(targetVersion===versionBits){return Version$1.getVersionForNumber(i+7);}
const bitsDifference=FormatInformation.numBitsDiffering(versionBits,targetVersion);if(bitsDifference<bestDifference){bestVersion=i+7;bestDifference=bitsDifference;}}
if(bestDifference<=3){return Version$1.getVersionForNumber(bestVersion);}
return null;}
buildFunctionPattern(){const dimension=this.getDimensionForVersion();const bitMatrix=new BitMatrix(dimension);bitMatrix.setRegion(0,0,9,9);bitMatrix.setRegion(dimension-8,0,8,9);bitMatrix.setRegion(0,dimension-8,9,8);const max=this.alignmentPatternCenters.length;for(let x=0;x<max;x++){const i=this.alignmentPatternCenters[x]-2;for(let y=0;y<max;y++){if((x===0&&(y===0||y===max-1))||(x===max-1&&y===0)){continue;}
bitMatrix.setRegion(this.alignmentPatternCenters[y]-2,i,5,5);}}
bitMatrix.setRegion(6,9,1,dimension-17);bitMatrix.setRegion(9,6,dimension-17,1);if(this.versionNumber>6){bitMatrix.setRegion(dimension-11,0,3,6);bitMatrix.setRegion(0,dimension-11,6,3);}
return bitMatrix;}
toString(){return''+this.versionNumber;}}
Version$1.VERSION_DECODE_INFO=Int32Array.from([0x07C94,0x085BC,0x09A99,0x0A4D3,0x0BBF6,0x0C762,0x0D847,0x0E60D,0x0F928,0x10B78,0x1145D,0x12A17,0x13532,0x149A6,0x15683,0x168C9,0x177EC,0x18EC4,0x191E1,0x1AFAB,0x1B08E,0x1CC1A,0x1D33F,0x1ED75,0x1F250,0x209D5,0x216F0,0x228BA,0x2379F,0x24B0B,0x2542E,0x26A64,0x27541,0x28C69]);Version$1.VERSIONS=[new Version$1(1,new Int32Array(0),new ECBlocks$1(7,new ECB$1(1,19)),new ECBlocks$1(10,new ECB$1(1,16)),new ECBlocks$1(13,new ECB$1(1,13)),new ECBlocks$1(17,new ECB$1(1,9))),new Version$1(2,Int32Array.from([6,18]),new ECBlocks$1(10,new ECB$1(1,34)),new ECBlocks$1(16,new ECB$1(1,28)),new ECBlocks$1(22,new ECB$1(1,22)),new ECBlocks$1(28,new ECB$1(1,16))),new Version$1(3,Int32Array.from([6,22]),new ECBlocks$1(15,new ECB$1(1,55)),new ECBlocks$1(26,new ECB$1(1,44)),new ECBlocks$1(18,new ECB$1(2,17)),new ECBlocks$1(22,new ECB$1(2,13))),new Version$1(4,Int32Array.from([6,26]),new ECBlocks$1(20,new ECB$1(1,80)),new ECBlocks$1(18,new ECB$1(2,32)),new ECBlocks$1(26,new ECB$1(2,24)),new ECBlocks$1(16,new ECB$1(4,9))),new Version$1(5,Int32Array.from([6,30]),new ECBlocks$1(26,new ECB$1(1,108)),new ECBlocks$1(24,new ECB$1(2,43)),new ECBlocks$1(18,new ECB$1(2,15),new ECB$1(2,16)),new ECBlocks$1(22,new ECB$1(2,11),new ECB$1(2,12))),new Version$1(6,Int32Array.from([6,34]),new ECBlocks$1(18,new ECB$1(2,68)),new ECBlocks$1(16,new ECB$1(4,27)),new ECBlocks$1(24,new ECB$1(4,19)),new ECBlocks$1(28,new ECB$1(4,15))),new Version$1(7,Int32Array.from([6,22,38]),new ECBlocks$1(20,new ECB$1(2,78)),new ECBlocks$1(18,new ECB$1(4,31)),new ECBlocks$1(18,new ECB$1(2,14),new ECB$1(4,15)),new ECBlocks$1(26,new ECB$1(4,13),new ECB$1(1,14))),new Version$1(8,Int32Array.from([6,24,42]),new ECBlocks$1(24,new ECB$1(2,97)),new ECBlocks$1(22,new ECB$1(2,38),new ECB$1(2,39)),new ECBlocks$1(22,new ECB$1(4,18),new ECB$1(2,19)),new ECBlocks$1(26,new ECB$1(4,14),new ECB$1(2,15))),new Version$1(9,Int32Array.from([6,26,46]),new ECBlocks$1(30,new ECB$1(2,116)),new ECBlocks$1(22,new ECB$1(3,36),new ECB$1(2,37)),new ECBlocks$1(20,new ECB$1(4,16),new ECB$1(4,17)),new ECBlocks$1(24,new ECB$1(4,12),new ECB$1(4,13))),new Version$1(10,Int32Array.from([6,28,50]),new ECBlocks$1(18,new ECB$1(2,68),new ECB$1(2,69)),new ECBlocks$1(26,new ECB$1(4,43),new ECB$1(1,44)),new ECBlocks$1(24,new ECB$1(6,19),new ECB$1(2,20)),new ECBlocks$1(28,new ECB$1(6,15),new ECB$1(2,16))),new Version$1(11,Int32Array.from([6,30,54]),new ECBlocks$1(20,new ECB$1(4,81)),new ECBlocks$1(30,new ECB$1(1,50),new ECB$1(4,51)),new ECBlocks$1(28,new ECB$1(4,22),new ECB$1(4,23)),new ECBlocks$1(24,new ECB$1(3,12),new ECB$1(8,13))),new Version$1(12,Int32Array.from([6,32,58]),new ECBlocks$1(24,new ECB$1(2,92),new ECB$1(2,93)),new ECBlocks$1(22,new ECB$1(6,36),new ECB$1(2,37)),new ECBlocks$1(26,new ECB$1(4,20),new ECB$1(6,21)),new ECBlocks$1(28,new ECB$1(7,14),new ECB$1(4,15))),new Version$1(13,Int32Array.from([6,34,62]),new ECBlocks$1(26,new ECB$1(4,107)),new ECBlocks$1(22,new ECB$1(8,37),new ECB$1(1,38)),new ECBlocks$1(24,new ECB$1(8,20),new ECB$1(4,21)),new ECBlocks$1(22,new ECB$1(12,11),new ECB$1(4,12))),new Version$1(14,Int32Array.from([6,26,46,66]),new ECBlocks$1(30,new ECB$1(3,115),new ECB$1(1,116)),new ECBlocks$1(24,new ECB$1(4,40),new ECB$1(5,41)),new ECBlocks$1(20,new ECB$1(11,16),new ECB$1(5,17)),new ECBlocks$1(24,new ECB$1(11,12),new ECB$1(5,13))),new Version$1(15,Int32Array.from([6,26,48,70]),new ECBlocks$1(22,new ECB$1(5,87),new ECB$1(1,88)),new ECBlocks$1(24,new ECB$1(5,41),new ECB$1(5,42)),new ECBlocks$1(30,new ECB$1(5,24),new ECB$1(7,25)),new ECBlocks$1(24,new ECB$1(11,12),new ECB$1(7,13))),new Version$1(16,Int32Array.from([6,26,50,74]),new ECBlocks$1(24,new ECB$1(5,98),new ECB$1(1,99)),new ECBlocks$1(28,new ECB$1(7,45),new ECB$1(3,46)),new ECBlocks$1(24,new ECB$1(15,19),new ECB$1(2,20)),new ECBlocks$1(30,new ECB$1(3,15),new ECB$1(13,16))),new Version$1(17,Int32Array.from([6,30,54,78]),new ECBlocks$1(28,new ECB$1(1,107),new ECB$1(5,108)),new ECBlocks$1(28,new ECB$1(10,46),new ECB$1(1,47)),new ECBlocks$1(28,new ECB$1(1,22),new ECB$1(15,23)),new ECBlocks$1(28,new ECB$1(2,14),new ECB$1(17,15))),new Version$1(18,Int32Array.from([6,30,56,82]),new ECBlocks$1(30,new ECB$1(5,120),new ECB$1(1,121)),new ECBlocks$1(26,new ECB$1(9,43),new ECB$1(4,44)),new ECBlocks$1(28,new ECB$1(17,22),new ECB$1(1,23)),new ECBlocks$1(28,new ECB$1(2,14),new ECB$1(19,15))),new Version$1(19,Int32Array.from([6,30,58,86]),new ECBlocks$1(28,new ECB$1(3,113),new ECB$1(4,114)),new ECBlocks$1(26,new ECB$1(3,44),new ECB$1(11,45)),new ECBlocks$1(26,new ECB$1(17,21),new ECB$1(4,22)),new ECBlocks$1(26,new ECB$1(9,13),new ECB$1(16,14))),new Version$1(20,Int32Array.from([6,34,62,90]),new ECBlocks$1(28,new ECB$1(3,107),new ECB$1(5,108)),new ECBlocks$1(26,new ECB$1(3,41),new ECB$1(13,42)),new ECBlocks$1(30,new ECB$1(15,24),new ECB$1(5,25)),new ECBlocks$1(28,new ECB$1(15,15),new ECB$1(10,16))),new Version$1(21,Int32Array.from([6,28,50,72,94]),new ECBlocks$1(28,new ECB$1(4,116),new ECB$1(4,117)),new ECBlocks$1(26,new ECB$1(17,42)),new ECBlocks$1(28,new ECB$1(17,22),new ECB$1(6,23)),new ECBlocks$1(30,new ECB$1(19,16),new ECB$1(6,17))),new Version$1(22,Int32Array.from([6,26,50,74,98]),new ECBlocks$1(28,new ECB$1(2,111),new ECB$1(7,112)),new ECBlocks$1(28,new ECB$1(17,46)),new ECBlocks$1(30,new ECB$1(7,24),new ECB$1(16,25)),new ECBlocks$1(24,new ECB$1(34,13))),new Version$1(23,Int32Array.from([6,30,54,78,102]),new ECBlocks$1(30,new ECB$1(4,121),new ECB$1(5,122)),new ECBlocks$1(28,new ECB$1(4,47),new ECB$1(14,48)),new ECBlocks$1(30,new ECB$1(11,24),new ECB$1(14,25)),new ECBlocks$1(30,new ECB$1(16,15),new ECB$1(14,16))),new Version$1(24,Int32Array.from([6,28,54,80,106]),new ECBlocks$1(30,new ECB$1(6,117),new ECB$1(4,118)),new ECBlocks$1(28,new ECB$1(6,45),new ECB$1(14,46)),new ECBlocks$1(30,new ECB$1(11,24),new ECB$1(16,25)),new ECBlocks$1(30,new ECB$1(30,16),new ECB$1(2,17))),new Version$1(25,Int32Array.from([6,32,58,84,110]),new ECBlocks$1(26,new ECB$1(8,106),new ECB$1(4,107)),new ECBlocks$1(28,new ECB$1(8,47),new ECB$1(13,48)),new ECBlocks$1(30,new ECB$1(7,24),new ECB$1(22,25)),new ECBlocks$1(30,new ECB$1(22,15),new ECB$1(13,16))),new Version$1(26,Int32Array.from([6,30,58,86,114]),new ECBlocks$1(28,new ECB$1(10,114),new ECB$1(2,115)),new ECBlocks$1(28,new ECB$1(19,46),new ECB$1(4,47)),new ECBlocks$1(28,new ECB$1(28,22),new ECB$1(6,23)),new ECBlocks$1(30,new ECB$1(33,16),new ECB$1(4,17))),new Version$1(27,Int32Array.from([6,34,62,90,118]),new ECBlocks$1(30,new ECB$1(8,122),new ECB$1(4,123)),new ECBlocks$1(28,new ECB$1(22,45),new ECB$1(3,46)),new ECBlocks$1(30,new ECB$1(8,23),new ECB$1(26,24)),new ECBlocks$1(30,new ECB$1(12,15),new ECB$1(28,16))),new Version$1(28,Int32Array.from([6,26,50,74,98,122]),new ECBlocks$1(30,new ECB$1(3,117),new ECB$1(10,118)),new ECBlocks$1(28,new ECB$1(3,45),new ECB$1(23,46)),new ECBlocks$1(30,new ECB$1(4,24),new ECB$1(31,25)),new ECBlocks$1(30,new ECB$1(11,15),new ECB$1(31,16))),new Version$1(29,Int32Array.from([6,30,54,78,102,126]),new ECBlocks$1(30,new ECB$1(7,116),new ECB$1(7,117)),new ECBlocks$1(28,new ECB$1(21,45),new ECB$1(7,46)),new ECBlocks$1(30,new ECB$1(1,23),new ECB$1(37,24)),new ECBlocks$1(30,new ECB$1(19,15),new ECB$1(26,16))),new Version$1(30,Int32Array.from([6,26,52,78,104,130]),new ECBlocks$1(30,new ECB$1(5,115),new ECB$1(10,116)),new ECBlocks$1(28,new ECB$1(19,47),new ECB$1(10,48)),new ECBlocks$1(30,new ECB$1(15,24),new ECB$1(25,25)),new ECBlocks$1(30,new ECB$1(23,15),new ECB$1(25,16))),new Version$1(31,Int32Array.from([6,30,56,82,108,134]),new ECBlocks$1(30,new ECB$1(13,115),new ECB$1(3,116)),new ECBlocks$1(28,new ECB$1(2,46),new ECB$1(29,47)),new ECBlocks$1(30,new ECB$1(42,24),new ECB$1(1,25)),new ECBlocks$1(30,new ECB$1(23,15),new ECB$1(28,16))),new Version$1(32,Int32Array.from([6,34,60,86,112,138]),new ECBlocks$1(30,new ECB$1(17,115)),new ECBlocks$1(28,new ECB$1(10,46),new ECB$1(23,47)),new ECBlocks$1(30,new ECB$1(10,24),new ECB$1(35,25)),new ECBlocks$1(30,new ECB$1(19,15),new ECB$1(35,16))),new Version$1(33,Int32Array.from([6,30,58,86,114,142]),new ECBlocks$1(30,new ECB$1(17,115),new ECB$1(1,116)),new ECBlocks$1(28,new ECB$1(14,46),new ECB$1(21,47)),new ECBlocks$1(30,new ECB$1(29,24),new ECB$1(19,25)),new ECBlocks$1(30,new ECB$1(11,15),new ECB$1(46,16))),new Version$1(34,Int32Array.from([6,34,62,90,118,146]),new ECBlocks$1(30,new ECB$1(13,115),new ECB$1(6,116)),new ECBlocks$1(28,new ECB$1(14,46),new ECB$1(23,47)),new ECBlocks$1(30,new ECB$1(44,24),new ECB$1(7,25)),new ECBlocks$1(30,new ECB$1(59,16),new ECB$1(1,17))),new Version$1(35,Int32Array.from([6,30,54,78,102,126,150]),new ECBlocks$1(30,new ECB$1(12,121),new ECB$1(7,122)),new ECBlocks$1(28,new ECB$1(12,47),new ECB$1(26,48)),new ECBlocks$1(30,new ECB$1(39,24),new ECB$1(14,25)),new ECBlocks$1(30,new ECB$1(22,15),new ECB$1(41,16))),new Version$1(36,Int32Array.from([6,24,50,76,102,128,154]),new ECBlocks$1(30,new ECB$1(6,121),new ECB$1(14,122)),new ECBlocks$1(28,new ECB$1(6,47),new ECB$1(34,48)),new ECBlocks$1(30,new ECB$1(46,24),new ECB$1(10,25)),new ECBlocks$1(30,new ECB$1(2,15),new ECB$1(64,16))),new Version$1(37,Int32Array.from([6,28,54,80,106,132,158]),new ECBlocks$1(30,new ECB$1(17,122),new ECB$1(4,123)),new ECBlocks$1(28,new ECB$1(29,46),new ECB$1(14,47)),new ECBlocks$1(30,new ECB$1(49,24),new ECB$1(10,25)),new ECBlocks$1(30,new ECB$1(24,15),new ECB$1(46,16))),new Version$1(38,Int32Array.from([6,32,58,84,110,136,162]),new ECBlocks$1(30,new ECB$1(4,122),new ECB$1(18,123)),new ECBlocks$1(28,new ECB$1(13,46),new ECB$1(32,47)),new ECBlocks$1(30,new ECB$1(48,24),new ECB$1(14,25)),new ECBlocks$1(30,new ECB$1(42,15),new ECB$1(32,16))),new Version$1(39,Int32Array.from([6,26,54,82,110,138,166]),new ECBlocks$1(30,new ECB$1(20,117),new ECB$1(4,118)),new ECBlocks$1(28,new ECB$1(40,47),new ECB$1(7,48)),new ECBlocks$1(30,new ECB$1(43,24),new ECB$1(22,25)),new ECBlocks$1(30,new ECB$1(10,15),new ECB$1(67,16))),new Version$1(40,Int32Array.from([6,30,58,86,114,142,170]),new ECBlocks$1(30,new ECB$1(19,118),new ECB$1(6,119)),new ECBlocks$1(28,new ECB$1(18,47),new ECB$1(31,48)),new ECBlocks$1(30,new ECB$1(34,24),new ECB$1(34,25)),new ECBlocks$1(30,new ECB$1(20,15),new ECB$1(61,16)))];var DataMaskValues;(function(DataMaskValues){DataMaskValues[DataMaskValues["DATA_MASK_000"]=0]="DATA_MASK_000";DataMaskValues[DataMaskValues["DATA_MASK_001"]=1]="DATA_MASK_001";DataMaskValues[DataMaskValues["DATA_MASK_010"]=2]="DATA_MASK_010";DataMaskValues[DataMaskValues["DATA_MASK_011"]=3]="DATA_MASK_011";DataMaskValues[DataMaskValues["DATA_MASK_100"]=4]="DATA_MASK_100";DataMaskValues[DataMaskValues["DATA_MASK_101"]=5]="DATA_MASK_101";DataMaskValues[DataMaskValues["DATA_MASK_110"]=6]="DATA_MASK_110";DataMaskValues[DataMaskValues["DATA_MASK_111"]=7]="DATA_MASK_111";})(DataMaskValues||(DataMaskValues={}));class DataMask{constructor(value,isMasked){this.value=value;this.isMasked=isMasked;}
unmaskBitMatrix(bits,dimension){for(let i=0;i<dimension;i++){for(let j=0;j<dimension;j++){if(this.isMasked(i,j)){bits.flip(j,i);}}}}}
DataMask.values=new Map([[DataMaskValues.DATA_MASK_000,new DataMask(DataMaskValues.DATA_MASK_000,(i,j)=>{return((i+j)&0x01)===0;})],[DataMaskValues.DATA_MASK_001,new DataMask(DataMaskValues.DATA_MASK_001,(i,j)=>{return(i&0x01)===0;})],[DataMaskValues.DATA_MASK_010,new DataMask(DataMaskValues.DATA_MASK_010,(i,j)=>{return j%3===0;})],[DataMaskValues.DATA_MASK_011,new DataMask(DataMaskValues.DATA_MASK_011,(i,j)=>{return(i+j)%3===0;})],[DataMaskValues.DATA_MASK_100,new DataMask(DataMaskValues.DATA_MASK_100,(i,j)=>{return((Math.floor(i/2)+Math.floor(j/3))&0x01)===0;})],[DataMaskValues.DATA_MASK_101,new DataMask(DataMaskValues.DATA_MASK_101,(i,j)=>{return(i*j)%6===0;})],[DataMaskValues.DATA_MASK_110,new DataMask(DataMaskValues.DATA_MASK_110,(i,j)=>{return((i*j)%6)<3;})],[DataMaskValues.DATA_MASK_111,new DataMask(DataMaskValues.DATA_MASK_111,(i,j)=>{return((i+j+((i*j)%3))&0x01)===0;})],]);class BitMatrixParser$1{constructor(bitMatrix){const dimension=bitMatrix.getHeight();if(dimension<21||(dimension&0x03)!==1){throw new FormatException();}
this.bitMatrix=bitMatrix;}
readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==undefined){return this.parsedFormatInfo;}
let formatInfoBits1=0;for(let i=0;i<6;i++){formatInfoBits1=this.copyBit(i,8,formatInfoBits1);}
formatInfoBits1=this.copyBit(7,8,formatInfoBits1);formatInfoBits1=this.copyBit(8,8,formatInfoBits1);formatInfoBits1=this.copyBit(8,7,formatInfoBits1);for(let j=5;j>=0;j--){formatInfoBits1=this.copyBit(8,j,formatInfoBits1);}
const dimension=this.bitMatrix.getHeight();let formatInfoBits2=0;const jMin=dimension-7;for(let j=dimension-1;j>=jMin;j--){formatInfoBits2=this.copyBit(8,j,formatInfoBits2);}
for(let i=dimension-8;i<dimension;i++){formatInfoBits2=this.copyBit(i,8,formatInfoBits2);}
this.parsedFormatInfo=FormatInformation.decodeFormatInformation(formatInfoBits1,formatInfoBits2);if(this.parsedFormatInfo!==null){return this.parsedFormatInfo;}
throw new FormatException();}
readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==undefined){return this.parsedVersion;}
const dimension=this.bitMatrix.getHeight();const provisionalVersion=Math.floor((dimension-17)/4);if(provisionalVersion<=6){return Version$1.getVersionForNumber(provisionalVersion);}
let versionBits=0;const ijMin=dimension-11;for(let j=5;j>=0;j--){for(let i=dimension-9;i>=ijMin;i--){versionBits=this.copyBit(i,j,versionBits);}}
let theParsedVersion=Version$1.decodeVersionInformation(versionBits);if(theParsedVersion!==null&&theParsedVersion.getDimensionForVersion()===dimension){this.parsedVersion=theParsedVersion;return theParsedVersion;}
versionBits=0;for(let i=5;i>=0;i--){for(let j=dimension-9;j>=ijMin;j--){versionBits=this.copyBit(i,j,versionBits);}}
theParsedVersion=Version$1.decodeVersionInformation(versionBits);if(theParsedVersion!==null&&theParsedVersion.getDimensionForVersion()===dimension){this.parsedVersion=theParsedVersion;return theParsedVersion;}
throw new FormatException();}
copyBit(i,j,versionBits){const bit=this.isMirror?this.bitMatrix.get(j,i):this.bitMatrix.get(i,j);return bit?(versionBits<<1)|0x1:versionBits<<1;}
readCodewords(){const formatInfo=this.readFormatInformation();const version=this.readVersion();const dataMask=DataMask.values.get(formatInfo.getDataMask());const dimension=this.bitMatrix.getHeight();dataMask.unmaskBitMatrix(this.bitMatrix,dimension);const functionPattern=version.buildFunctionPattern();let readingUp=true;const result=new Uint8Array(version.getTotalCodewords());let resultOffset=0;let currentByte=0;let bitsRead=0;for(let j=dimension-1;j>0;j-=2){if(j===6){j--;}
for(let count=0;count<dimension;count++){const i=readingUp?dimension-1-count:count;for(let col=0;col<2;col++){if(!functionPattern.get(j-col,i)){bitsRead++;currentByte<<=1;if(this.bitMatrix.get(j-col,i)){currentByte|=1;}
if(bitsRead===8){result[resultOffset++]=currentByte;bitsRead=0;currentByte=0;}}}}
readingUp=!readingUp;}
if(resultOffset!==version.getTotalCodewords()){throw new FormatException();}
return result;}
remask(){if(this.parsedFormatInfo===null){return;}
const dataMask=DataMask.values[this.parsedFormatInfo.getDataMask()];const dimension=this.bitMatrix.getHeight();dataMask.unmaskBitMatrix(this.bitMatrix,dimension);}
setMirror(isMirror){this.parsedVersion=null;this.parsedFormatInfo=null;this.isMirror=isMirror;}
mirror(){const bitMatrix=this.bitMatrix;for(let x=0,width=bitMatrix.getWidth();x<width;x++){for(let y=x+1,height=bitMatrix.getHeight();y<height;y++){if(bitMatrix.get(x,y)!==bitMatrix.get(y,x)){bitMatrix.flip(y,x);bitMatrix.flip(x,y);}}}}}
class DataBlock$1{constructor(numDataCodewords,codewords){this.numDataCodewords=numDataCodewords;this.codewords=codewords;}
static getDataBlocks(rawCodewords,version,ecLevel){if(rawCodewords.length!==version.getTotalCodewords()){throw new IllegalArgumentException();}
const ecBlocks=version.getECBlocksForLevel(ecLevel);let totalBlocks=0;const ecBlockArray=ecBlocks.getECBlocks();for(const ecBlock of ecBlockArray){totalBlocks+=ecBlock.getCount();}
const result=new Array(totalBlocks);let numResultBlocks=0;for(const ecBlock of ecBlockArray){for(let i=0;i<ecBlock.getCount();i++){const numDataCodewords=ecBlock.getDataCodewords();const numBlockCodewords=ecBlocks.getECCodewordsPerBlock()+numDataCodewords;result[numResultBlocks++]=new DataBlock$1(numDataCodewords,new Uint8Array(numBlockCodewords));}}
const shorterBlocksTotalCodewords=result[0].codewords.length;let longerBlocksStartAt=result.length-1;while(longerBlocksStartAt>=0){const numCodewords=result[longerBlocksStartAt].codewords.length;if(numCodewords===shorterBlocksTotalCodewords){break;}
longerBlocksStartAt--;}
longerBlocksStartAt++;const shorterBlocksNumDataCodewords=shorterBlocksTotalCodewords-ecBlocks.getECCodewordsPerBlock();let rawCodewordsOffset=0;for(let i=0;i<shorterBlocksNumDataCodewords;i++){for(let j=0;j<numResultBlocks;j++){result[j].codewords[i]=rawCodewords[rawCodewordsOffset++];}}
for(let j=longerBlocksStartAt;j<numResultBlocks;j++){result[j].codewords[shorterBlocksNumDataCodewords]=rawCodewords[rawCodewordsOffset++];}
const max=result[0].codewords.length;for(let i=shorterBlocksNumDataCodewords;i<max;i++){for(let j=0;j<numResultBlocks;j++){const iOffset=j<longerBlocksStartAt?i:i+1;result[j].codewords[iOffset]=rawCodewords[rawCodewordsOffset++];}}
return result;}
getNumDataCodewords(){return this.numDataCodewords;}
getCodewords(){return this.codewords;}}
var ModeValues;(function(ModeValues){ModeValues[ModeValues["TERMINATOR"]=0]="TERMINATOR";ModeValues[ModeValues["NUMERIC"]=1]="NUMERIC";ModeValues[ModeValues["ALPHANUMERIC"]=2]="ALPHANUMERIC";ModeValues[ModeValues["STRUCTURED_APPEND"]=3]="STRUCTURED_APPEND";ModeValues[ModeValues["BYTE"]=4]="BYTE";ModeValues[ModeValues["ECI"]=5]="ECI";ModeValues[ModeValues["KANJI"]=6]="KANJI";ModeValues[ModeValues["FNC1_FIRST_POSITION"]=7]="FNC1_FIRST_POSITION";ModeValues[ModeValues["FNC1_SECOND_POSITION"]=8]="FNC1_SECOND_POSITION";ModeValues[ModeValues["HANZI"]=9]="HANZI";})(ModeValues||(ModeValues={}));class Mode$1{constructor(value,stringValue,characterCountBitsForVersions,bits){this.value=value;this.stringValue=stringValue;this.characterCountBitsForVersions=characterCountBitsForVersions;this.bits=bits;Mode$1.FOR_BITS.set(bits,this);Mode$1.FOR_VALUE.set(value,this);}
static forBits(bits){const mode=Mode$1.FOR_BITS.get(bits);if(undefined===mode){throw new IllegalArgumentException();}
return mode;}
getCharacterCountBits(version){const versionNumber=version.getVersionNumber();let offset;if(versionNumber<=9){offset=0;}
else if(versionNumber<=26){offset=1;}
else{offset=2;}
return this.characterCountBitsForVersions[offset];}
getValue(){return this.value;}
getBits(){return this.bits;}
equals(o){if(!(o instanceof Mode$1)){return false;}
const other=o;return this.value===other.value;}
toString(){return this.stringValue;}}
Mode$1.FOR_BITS=new Map();Mode$1.FOR_VALUE=new Map();Mode$1.TERMINATOR=new Mode$1(ModeValues.TERMINATOR,'TERMINATOR',Int32Array.from([0,0,0]),0x00);Mode$1.NUMERIC=new Mode$1(ModeValues.NUMERIC,'NUMERIC',Int32Array.from([10,12,14]),0x01);Mode$1.ALPHANUMERIC=new Mode$1(ModeValues.ALPHANUMERIC,'ALPHANUMERIC',Int32Array.from([9,11,13]),0x02);Mode$1.STRUCTURED_APPEND=new Mode$1(ModeValues.STRUCTURED_APPEND,'STRUCTURED_APPEND',Int32Array.from([0,0,0]),0x03);Mode$1.BYTE=new Mode$1(ModeValues.BYTE,'BYTE',Int32Array.from([8,16,16]),0x04);Mode$1.ECI=new Mode$1(ModeValues.ECI,'ECI',Int32Array.from([0,0,0]),0x07);Mode$1.KANJI=new Mode$1(ModeValues.KANJI,'KANJI',Int32Array.from([8,10,12]),0x08);Mode$1.FNC1_FIRST_POSITION=new Mode$1(ModeValues.FNC1_FIRST_POSITION,'FNC1_FIRST_POSITION',Int32Array.from([0,0,0]),0x05);Mode$1.FNC1_SECOND_POSITION=new Mode$1(ModeValues.FNC1_SECOND_POSITION,'FNC1_SECOND_POSITION',Int32Array.from([0,0,0]),0x09);Mode$1.HANZI=new Mode$1(ModeValues.HANZI,'HANZI',Int32Array.from([8,10,12]),0x0D);class DecodedBitStreamParser$1{static decode(bytes,version,ecLevel,hints){const bits=new BitSource(bytes);let result=new StringBuilder();const byteSegments=new Array();let symbolSequence=-1;let parityData=-1;try{let currentCharacterSetECI=null;let fc1InEffect=false;let mode;do{if(bits.available()<4){mode=Mode$1.TERMINATOR;}
else{const modeBits=bits.readBits(4);mode=Mode$1.forBits(modeBits);}
switch(mode){case Mode$1.TERMINATOR:break;case Mode$1.FNC1_FIRST_POSITION:case Mode$1.FNC1_SECOND_POSITION:fc1InEffect=true;break;case Mode$1.STRUCTURED_APPEND:if(bits.available()<16){throw new FormatException();}
symbolSequence=bits.readBits(8);parityData=bits.readBits(8);break;case Mode$1.ECI:const value=DecodedBitStreamParser$1.parseECIValue(bits);currentCharacterSetECI=CharacterSetECI.getCharacterSetECIByValue(value);if(currentCharacterSetECI===null){throw new FormatException();}
break;case Mode$1.HANZI:const subset=bits.readBits(4);const countHanzi=bits.readBits(mode.getCharacterCountBits(version));if(subset===DecodedBitStreamParser$1.GB2312_SUBSET){DecodedBitStreamParser$1.decodeHanziSegment(bits,result,countHanzi);}
break;default:const count=bits.readBits(mode.getCharacterCountBits(version));switch(mode){case Mode$1.NUMERIC:DecodedBitStreamParser$1.decodeNumericSegment(bits,result,count);break;case Mode$1.ALPHANUMERIC:DecodedBitStreamParser$1.decodeAlphanumericSegment(bits,result,count,fc1InEffect);break;case Mode$1.BYTE:DecodedBitStreamParser$1.decodeByteSegment(bits,result,count,currentCharacterSetECI,byteSegments,hints);break;case Mode$1.KANJI:DecodedBitStreamParser$1.decodeKanjiSegment(bits,result,count);break;default:throw new FormatException();}
break;}}while(mode!==Mode$1.TERMINATOR);}
catch(iae){throw new FormatException();}
return new DecoderResult(bytes,result.toString(),byteSegments.length===0?null:byteSegments,ecLevel===null?null:ecLevel.toString(),symbolSequence,parityData);}
static decodeHanziSegment(bits,result,count){if(count*13>bits.available()){throw new FormatException();}
const buffer=new Uint8Array(2*count);let offset=0;while(count>0){const twoBytes=bits.readBits(13);let assembledTwoBytes=(((twoBytes/0x060)<<8)&0xFFFFFFFF)|(twoBytes%0x060);if(assembledTwoBytes<0x003BF){assembledTwoBytes+=0x0A1A1;}
else{assembledTwoBytes+=0x0A6A1;}
buffer[offset]=((assembledTwoBytes>>8)&0xFF);buffer[offset+1]=(assembledTwoBytes&0xFF);offset+=2;count--;}
try{result.append(StringEncoding.decode(buffer,StringUtils.GB2312));}
catch(ignored){throw new FormatException(ignored);}}
static decodeKanjiSegment(bits,result,count){if(count*13>bits.available()){throw new FormatException();}
const buffer=new Uint8Array(2*count);let offset=0;while(count>0){const twoBytes=bits.readBits(13);let assembledTwoBytes=(((twoBytes/0x0C0)<<8)&0xFFFFFFFF)|(twoBytes%0x0C0);if(assembledTwoBytes<0x01F00){assembledTwoBytes+=0x08140;}
else{assembledTwoBytes+=0x0C140;}
buffer[offset]=(assembledTwoBytes>>8);buffer[offset+1]=assembledTwoBytes;offset+=2;count--;}
try{result.append(StringEncoding.decode(buffer,StringUtils.SHIFT_JIS));}
catch(ignored){throw new FormatException(ignored);}}
static decodeByteSegment(bits,result,count,currentCharacterSetECI,byteSegments,hints){if(8*count>bits.available()){throw new FormatException();}
const readBytes=new Uint8Array(count);for(let i=0;i<count;i++){readBytes[i]=bits.readBits(8);}
let encoding;if(currentCharacterSetECI===null){encoding=StringUtils.guessEncoding(readBytes,hints);}
else{encoding=currentCharacterSetECI.getName();}
try{result.append(StringEncoding.decode(readBytes,encoding));}
catch(ignored){throw new FormatException(ignored);}
byteSegments.push(readBytes);}
static toAlphaNumericChar(value){if(value>=DecodedBitStreamParser$1.ALPHANUMERIC_CHARS.length){throw new FormatException();}
return DecodedBitStreamParser$1.ALPHANUMERIC_CHARS[value];}
static decodeAlphanumericSegment(bits,result,count,fc1InEffect){const start=result.length();while(count>1){if(bits.available()<11){throw new FormatException();}
const nextTwoCharsBits=bits.readBits(11);result.append(DecodedBitStreamParser$1.toAlphaNumericChar(Math.floor(nextTwoCharsBits/45)));result.append(DecodedBitStreamParser$1.toAlphaNumericChar(nextTwoCharsBits%45));count-=2;}
if(count===1){if(bits.available()<6){throw new FormatException();}
result.append(DecodedBitStreamParser$1.toAlphaNumericChar(bits.readBits(6)));}
if(fc1InEffect){for(let i=start;i<result.length();i++){if(result.charAt(i)==='%'){if(i<result.length()-1&&result.charAt(i+1)==='%'){result.deleteCharAt(i+1);}
else{result.setCharAt(i,String.fromCharCode(0x1D));}}}}}
static decodeNumericSegment(bits,result,count){while(count>=3){if(bits.available()<10){throw new FormatException();}
const threeDigitsBits=bits.readBits(10);if(threeDigitsBits>=1000){throw new FormatException();}
result.append(DecodedBitStreamParser$1.toAlphaNumericChar(Math.floor(threeDigitsBits/100)));result.append(DecodedBitStreamParser$1.toAlphaNumericChar(Math.floor(threeDigitsBits/10)%10));result.append(DecodedBitStreamParser$1.toAlphaNumericChar(threeDigitsBits%10));count-=3;}
if(count===2){if(bits.available()<7){throw new FormatException();}
const twoDigitsBits=bits.readBits(7);if(twoDigitsBits>=100){throw new FormatException();}
result.append(DecodedBitStreamParser$1.toAlphaNumericChar(Math.floor(twoDigitsBits/10)));result.append(DecodedBitStreamParser$1.toAlphaNumericChar(twoDigitsBits%10));}
else if(count===1){if(bits.available()<4){throw new FormatException();}
const digitBits=bits.readBits(4);if(digitBits>=10){throw new FormatException();}
result.append(DecodedBitStreamParser$1.toAlphaNumericChar(digitBits));}}
static parseECIValue(bits){const firstByte=bits.readBits(8);if((firstByte&0x80)===0){return firstByte&0x7F;}
if((firstByte&0xC0)===0x80){const secondByte=bits.readBits(8);return(((firstByte&0x3F)<<8)&0xFFFFFFFF)|secondByte;}
if((firstByte&0xE0)===0xC0){const secondThirdBytes=bits.readBits(16);return(((firstByte&0x1F)<<16)&0xFFFFFFFF)|secondThirdBytes;}
throw new FormatException();}}
DecodedBitStreamParser$1.ALPHANUMERIC_CHARS='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:';DecodedBitStreamParser$1.GB2312_SUBSET=1;class QRCodeDecoderMetaData{constructor(mirrored){this.mirrored=mirrored;}
isMirrored(){return this.mirrored;}
applyMirroredCorrection(points){if(!this.mirrored||points===null||points.length<3){return;}
const bottomLeft=points[0];points[0]=points[2];points[2]=bottomLeft;}}
class Decoder$2{constructor(){this.rsDecoder=new ReedSolomonDecoder(GenericGF.QR_CODE_FIELD_256);}
decodeBooleanArray(image,hints){return this.decodeBitMatrix(BitMatrix.parseFromBooleanArray(image),hints);}
decodeBitMatrix(bits,hints){const parser=new BitMatrixParser$1(bits);let ex=null;try{return this.decodeBitMatrixParser(parser,hints);}
catch(e){ex=e;}
try{parser.remask();parser.setMirror(true);parser.readVersion();parser.readFormatInformation();parser.mirror();const result=this.decodeBitMatrixParser(parser,hints);result.setOther(new QRCodeDecoderMetaData(true));return result;}
catch(e){if(ex!==null){throw ex;}
throw e;}}
decodeBitMatrixParser(parser,hints){const version=parser.readVersion();const ecLevel=parser.readFormatInformation().getErrorCorrectionLevel();const codewords=parser.readCodewords();const dataBlocks=DataBlock$1.getDataBlocks(codewords,version,ecLevel);let totalBytes=0;for(const dataBlock of dataBlocks){totalBytes+=dataBlock.getNumDataCodewords();}
const resultBytes=new Uint8Array(totalBytes);let resultOffset=0;for(const dataBlock of dataBlocks){const codewordBytes=dataBlock.getCodewords();const numDataCodewords=dataBlock.getNumDataCodewords();this.correctErrors(codewordBytes,numDataCodewords);for(let i=0;i<numDataCodewords;i++){resultBytes[resultOffset++]=codewordBytes[i];}}
return DecodedBitStreamParser$1.decode(resultBytes,version,ecLevel,hints);}
correctErrors(codewordBytes,numDataCodewords){const codewordsInts=new Int32Array(codewordBytes);try{this.rsDecoder.decode(codewordsInts,codewordBytes.length-numDataCodewords);}
catch(ignored){throw new ChecksumException();}
for(let i=0;i<numDataCodewords;i++){codewordBytes[i]=codewordsInts[i];}}}
class AlignmentPattern extends ResultPoint{constructor(posX,posY,estimatedModuleSize){super(posX,posY);this.estimatedModuleSize=estimatedModuleSize;}
aboutEquals(moduleSize,i,j){if(Math.abs(i-this.getY())<=moduleSize&&Math.abs(j-this.getX())<=moduleSize){const moduleSizeDiff=Math.abs(moduleSize-this.estimatedModuleSize);return moduleSizeDiff<=1.0||moduleSizeDiff<=this.estimatedModuleSize;}
return false;}
combineEstimate(i,j,newModuleSize){const combinedX=(this.getX()+j)/2.0;const combinedY=(this.getY()+i)/2.0;const combinedModuleSize=(this.estimatedModuleSize+newModuleSize)/2.0;return new AlignmentPattern(combinedX,combinedY,combinedModuleSize);}}
class AlignmentPatternFinder{constructor(image,startX,startY,width,height,moduleSize,resultPointCallback){this.image=image;this.startX=startX;this.startY=startY;this.width=width;this.height=height;this.moduleSize=moduleSize;this.resultPointCallback=resultPointCallback;this.possibleCenters=[];this.crossCheckStateCount=new Int32Array(3);}
find(){const startX=this.startX;const height=this.height;const width=this.width;const maxJ=startX+width;const middleI=this.startY+(height/2);const stateCount=new Int32Array(3);const image=this.image;for(let iGen=0;iGen<height;iGen++){const i=middleI+((iGen&0x01)===0?Math.floor((iGen+1)/2):-Math.floor((iGen+1)/2));stateCount[0]=0;stateCount[1]=0;stateCount[2]=0;let j=startX;while(j<maxJ&&!image.get(j,i)){j++;}
let currentState=0;while(j<maxJ){if(image.get(j,i)){if(currentState===1){stateCount[1]++;}
else{if(currentState===2){if(this.foundPatternCross(stateCount)){const confirmed=this.handlePossibleCenter(stateCount,i,j);if(confirmed!==null){return confirmed;}}
stateCount[0]=stateCount[2];stateCount[1]=1;stateCount[2]=0;currentState=1;}
else{stateCount[++currentState]++;}}}
else{if(currentState===1){currentState++;}
stateCount[currentState]++;}
j++;}
if(this.foundPatternCross(stateCount)){const confirmed=this.handlePossibleCenter(stateCount,i,maxJ);if(confirmed!==null){return confirmed;}}}
if(this.possibleCenters.length!==0){return this.possibleCenters[0];}
throw new NotFoundException();}
static centerFromEnd(stateCount,end){return(end-stateCount[2])-stateCount[1]/2.0;}
foundPatternCross(stateCount){const moduleSize=this.moduleSize;const maxVariance=moduleSize/2.0;for(let i=0;i<3;i++){if(Math.abs(moduleSize-stateCount[i])>=maxVariance){return false;}}
return true;}
crossCheckVertical(startI,centerJ,maxCount,originalStateCountTotal){const image=this.image;const maxI=image.getHeight();const stateCount=this.crossCheckStateCount;stateCount[0]=0;stateCount[1]=0;stateCount[2]=0;let i=startI;while(i>=0&&image.get(centerJ,i)&&stateCount[1]<=maxCount){stateCount[1]++;i--;}
if(i<0||stateCount[1]>maxCount){return NaN;}
while(i>=0&&!image.get(centerJ,i)&&stateCount[0]<=maxCount){stateCount[0]++;i--;}
if(stateCount[0]>maxCount){return NaN;}
i=startI+1;while(i<maxI&&image.get(centerJ,i)&&stateCount[1]<=maxCount){stateCount[1]++;i++;}
if(i===maxI||stateCount[1]>maxCount){return NaN;}
while(i<maxI&&!image.get(centerJ,i)&&stateCount[2]<=maxCount){stateCount[2]++;i++;}
if(stateCount[2]>maxCount){return NaN;}
const stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2];if(5*Math.abs(stateCountTotal-originalStateCountTotal)>=2*originalStateCountTotal){return NaN;}
return this.foundPatternCross(stateCount)?AlignmentPatternFinder.centerFromEnd(stateCount,i):NaN;}
handlePossibleCenter(stateCount,i,j){const stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2];const centerJ=AlignmentPatternFinder.centerFromEnd(stateCount,j);const centerI=this.crossCheckVertical(i,centerJ,2*stateCount[1],stateCountTotal);if(!isNaN(centerI)){const estimatedModuleSize=(stateCount[0]+stateCount[1]+stateCount[2])/3.0;for(const center of this.possibleCenters){if(center.aboutEquals(estimatedModuleSize,centerI,centerJ)){return center.combineEstimate(centerI,centerJ,estimatedModuleSize);}}
const point=new AlignmentPattern(centerJ,centerI,estimatedModuleSize);this.possibleCenters.push(point);if(this.resultPointCallback!==null&&this.resultPointCallback!==undefined){this.resultPointCallback.foundPossibleResultPoint(point);}}
return null;}}
class FinderPattern$1 extends ResultPoint{constructor(posX,posY,estimatedModuleSize,count){super(posX,posY);this.estimatedModuleSize=estimatedModuleSize;this.count=count;if(undefined===count){this.count=1;}}
getEstimatedModuleSize(){return this.estimatedModuleSize;}
getCount(){return this.count;}
aboutEquals(moduleSize,i,j){if(Math.abs(i-this.getY())<=moduleSize&&Math.abs(j-this.getX())<=moduleSize){const moduleSizeDiff=Math.abs(moduleSize-this.estimatedModuleSize);return moduleSizeDiff<=1.0||moduleSizeDiff<=this.estimatedModuleSize;}
return false;}
combineEstimate(i,j,newModuleSize){const combinedCount=this.count+1;const combinedX=(this.count*this.getX()+j)/combinedCount;const combinedY=(this.count*this.getY()+i)/combinedCount;const combinedModuleSize=(this.count*this.estimatedModuleSize+newModuleSize)/combinedCount;return new FinderPattern$1(combinedX,combinedY,combinedModuleSize,combinedCount);}}
class FinderPatternInfo{constructor(patternCenters){this.bottomLeft=patternCenters[0];this.topLeft=patternCenters[1];this.topRight=patternCenters[2];}
getBottomLeft(){return this.bottomLeft;}
getTopLeft(){return this.topLeft;}
getTopRight(){return this.topRight;}}
class FinderPatternFinder{constructor(image,resultPointCallback){this.image=image;this.resultPointCallback=resultPointCallback;this.possibleCenters=[];this.crossCheckStateCount=new Int32Array(5);this.resultPointCallback=resultPointCallback;}
getImage(){return this.image;}
getPossibleCenters(){return this.possibleCenters;}
find(hints){const tryHarder=(hints!==null&&hints!==undefined)&&undefined!==hints.get(DecodeHintType$1.TRY_HARDER);const pureBarcode=(hints!==null&&hints!==undefined)&&undefined!==hints.get(DecodeHintType$1.PURE_BARCODE);const image=this.image;const maxI=image.getHeight();const maxJ=image.getWidth();let iSkip=Math.floor((3*maxI)/(4*FinderPatternFinder.MAX_MODULES));if(iSkip<FinderPatternFinder.MIN_SKIP||tryHarder){iSkip=FinderPatternFinder.MIN_SKIP;}
let done=false;const stateCount=new Int32Array(5);for(let i=iSkip-1;i<maxI&&!done;i+=iSkip){stateCount[0]=0;stateCount[1]=0;stateCount[2]=0;stateCount[3]=0;stateCount[4]=0;let currentState=0;for(let j=0;j<maxJ;j++){if(image.get(j,i)){if((currentState&1)===1){currentState++;}
stateCount[currentState]++;}
else{if((currentState&1)===0){if(currentState===4){if(FinderPatternFinder.foundPatternCross(stateCount)){const confirmed=this.handlePossibleCenter(stateCount,i,j,pureBarcode);if(confirmed===true){iSkip=2;if(this.hasSkipped===true){done=this.haveMultiplyConfirmedCenters();}
else{const rowSkip=this.findRowSkip();if(rowSkip>stateCount[2]){i+=rowSkip-stateCount[2]-iSkip;j=maxJ-1;}}}
else{stateCount[0]=stateCount[2];stateCount[1]=stateCount[3];stateCount[2]=stateCount[4];stateCount[3]=1;stateCount[4]=0;currentState=3;continue;}
currentState=0;stateCount[0]=0;stateCount[1]=0;stateCount[2]=0;stateCount[3]=0;stateCount[4]=0;}
else{stateCount[0]=stateCount[2];stateCount[1]=stateCount[3];stateCount[2]=stateCount[4];stateCount[3]=1;stateCount[4]=0;currentState=3;}}
else{stateCount[++currentState]++;}}
else{stateCount[currentState]++;}}}
if(FinderPatternFinder.foundPatternCross(stateCount)){const confirmed=this.handlePossibleCenter(stateCount,i,maxJ,pureBarcode);if(confirmed===true){iSkip=stateCount[0];if(this.hasSkipped){done=this.haveMultiplyConfirmedCenters();}}}}
const patternInfo=this.selectBestPatterns();ResultPoint.orderBestPatterns(patternInfo);return new FinderPatternInfo(patternInfo);}
static centerFromEnd(stateCount,end){return(end-stateCount[4]-stateCount[3])-stateCount[2]/2.0;}
static foundPatternCross(stateCount){let totalModuleSize=0;for(let i=0;i<5;i++){const count=stateCount[i];if(count===0){return false;}
totalModuleSize+=count;}
if(totalModuleSize<7){return false;}
const moduleSize=totalModuleSize/7.0;const maxVariance=moduleSize/2.0;return Math.abs(moduleSize-stateCount[0])<maxVariance&&Math.abs(moduleSize-stateCount[1])<maxVariance&&Math.abs(3.0*moduleSize-stateCount[2])<3*maxVariance&&Math.abs(moduleSize-stateCount[3])<maxVariance&&Math.abs(moduleSize-stateCount[4])<maxVariance;}
getCrossCheckStateCount(){const crossCheckStateCount=this.crossCheckStateCount;crossCheckStateCount[0]=0;crossCheckStateCount[1]=0;crossCheckStateCount[2]=0;crossCheckStateCount[3]=0;crossCheckStateCount[4]=0;return crossCheckStateCount;}
crossCheckDiagonal(startI,centerJ,maxCount,originalStateCountTotal){const stateCount=this.getCrossCheckStateCount();let i=0;const image=this.image;while(startI>=i&&centerJ>=i&&image.get(centerJ-i,startI-i)){stateCount[2]++;i++;}
if(startI<i||centerJ<i){return false;}
while(startI>=i&&centerJ>=i&&!image.get(centerJ-i,startI-i)&&stateCount[1]<=maxCount){stateCount[1]++;i++;}
if(startI<i||centerJ<i||stateCount[1]>maxCount){return false;}
while(startI>=i&&centerJ>=i&&image.get(centerJ-i,startI-i)&&stateCount[0]<=maxCount){stateCount[0]++;i++;}
if(stateCount[0]>maxCount){return false;}
const maxI=image.getHeight();const maxJ=image.getWidth();i=1;while(startI+i<maxI&&centerJ+i<maxJ&&image.get(centerJ+i,startI+i)){stateCount[2]++;i++;}
if(startI+i>=maxI||centerJ+i>=maxJ){return false;}
while(startI+i<maxI&&centerJ+i<maxJ&&!image.get(centerJ+i,startI+i)&&stateCount[3]<maxCount){stateCount[3]++;i++;}
if(startI+i>=maxI||centerJ+i>=maxJ||stateCount[3]>=maxCount){return false;}
while(startI+i<maxI&&centerJ+i<maxJ&&image.get(centerJ+i,startI+i)&&stateCount[4]<maxCount){stateCount[4]++;i++;}
if(stateCount[4]>=maxCount){return false;}
const stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2]+stateCount[3]+stateCount[4];return Math.abs(stateCountTotal-originalStateCountTotal)<2*originalStateCountTotal&&FinderPatternFinder.foundPatternCross(stateCount);}
crossCheckVertical(startI,centerJ,maxCount,originalStateCountTotal){const image=this.image;const maxI=image.getHeight();const stateCount=this.getCrossCheckStateCount();let i=startI;while(i>=0&&image.get(centerJ,i)){stateCount[2]++;i--;}
if(i<0){return NaN;}
while(i>=0&&!image.get(centerJ,i)&&stateCount[1]<=maxCount){stateCount[1]++;i--;}
if(i<0||stateCount[1]>maxCount){return NaN;}
while(i>=0&&image.get(centerJ,i)&&stateCount[0]<=maxCount){stateCount[0]++;i--;}
if(stateCount[0]>maxCount){return NaN;}
i=startI+1;while(i<maxI&&image.get(centerJ,i)){stateCount[2]++;i++;}
if(i===maxI){return NaN;}
while(i<maxI&&!image.get(centerJ,i)&&stateCount[3]<maxCount){stateCount[3]++;i++;}
if(i===maxI||stateCount[3]>=maxCount){return NaN;}
while(i<maxI&&image.get(centerJ,i)&&stateCount[4]<maxCount){stateCount[4]++;i++;}
if(stateCount[4]>=maxCount){return NaN;}
const stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2]+stateCount[3]+
stateCount[4];if(5*Math.abs(stateCountTotal-originalStateCountTotal)>=2*originalStateCountTotal){return NaN;}
return FinderPatternFinder.foundPatternCross(stateCount)?FinderPatternFinder.centerFromEnd(stateCount,i):NaN;}
crossCheckHorizontal(startJ,centerI,maxCount,originalStateCountTotal){const image=this.image;const maxJ=image.getWidth();const stateCount=this.getCrossCheckStateCount();let j=startJ;while(j>=0&&image.get(j,centerI)){stateCount[2]++;j--;}
if(j<0){return NaN;}
while(j>=0&&!image.get(j,centerI)&&stateCount[1]<=maxCount){stateCount[1]++;j--;}
if(j<0||stateCount[1]>maxCount){return NaN;}
while(j>=0&&image.get(j,centerI)&&stateCount[0]<=maxCount){stateCount[0]++;j--;}
if(stateCount[0]>maxCount){return NaN;}
j=startJ+1;while(j<maxJ&&image.get(j,centerI)){stateCount[2]++;j++;}
if(j===maxJ){return NaN;}
while(j<maxJ&&!image.get(j,centerI)&&stateCount[3]<maxCount){stateCount[3]++;j++;}
if(j===maxJ||stateCount[3]>=maxCount){return NaN;}
while(j<maxJ&&image.get(j,centerI)&&stateCount[4]<maxCount){stateCount[4]++;j++;}
if(stateCount[4]>=maxCount){return NaN;}
const stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2]+stateCount[3]+
stateCount[4];if(5*Math.abs(stateCountTotal-originalStateCountTotal)>=originalStateCountTotal){return NaN;}
return FinderPatternFinder.foundPatternCross(stateCount)?FinderPatternFinder.centerFromEnd(stateCount,j):NaN;}
handlePossibleCenter(stateCount,i,j,pureBarcode){const stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2]+stateCount[3]+
stateCount[4];let centerJ=FinderPatternFinder.centerFromEnd(stateCount,j);let centerI=this.crossCheckVertical(i,Math.floor(centerJ),stateCount[2],stateCountTotal);if(!isNaN(centerI)){centerJ=this.crossCheckHorizontal(Math.floor(centerJ),Math.floor(centerI),stateCount[2],stateCountTotal);if(!isNaN(centerJ)&&(!pureBarcode||this.crossCheckDiagonal(Math.floor(centerI),Math.floor(centerJ),stateCount[2],stateCountTotal))){const estimatedModuleSize=stateCountTotal/7.0;let found=false;const possibleCenters=this.possibleCenters;for(let index=0,length=possibleCenters.length;index<length;index++){const center=possibleCenters[index];if(center.aboutEquals(estimatedModuleSize,centerI,centerJ)){possibleCenters[index]=center.combineEstimate(centerI,centerJ,estimatedModuleSize);found=true;break;}}
if(!found){const point=new FinderPattern$1(centerJ,centerI,estimatedModuleSize);possibleCenters.push(point);if(this.resultPointCallback!==null&&this.resultPointCallback!==undefined){this.resultPointCallback.foundPossibleResultPoint(point);}}
return true;}}
return false;}
findRowSkip(){const max=this.possibleCenters.length;if(max<=1){return 0;}
let firstConfirmedCenter=null;for(const center of this.possibleCenters){if(center.getCount()>=FinderPatternFinder.CENTER_QUORUM){if(firstConfirmedCenter==null){firstConfirmedCenter=center;}
else{this.hasSkipped=true;return Math.floor((Math.abs(firstConfirmedCenter.getX()-center.getX())-
Math.abs(firstConfirmedCenter.getY()-center.getY()))/2);}}}
return 0;}
haveMultiplyConfirmedCenters(){let confirmedCount=0;let totalModuleSize=0.0;const max=this.possibleCenters.length;for(const pattern of this.possibleCenters){if(pattern.getCount()>=FinderPatternFinder.CENTER_QUORUM){confirmedCount++;totalModuleSize+=pattern.getEstimatedModuleSize();}}
if(confirmedCount<3){return false;}
const average=totalModuleSize/max;let totalDeviation=0.0;for(const pattern of this.possibleCenters){totalDeviation+=Math.abs(pattern.getEstimatedModuleSize()-average);}
return totalDeviation<=0.05*totalModuleSize;}
selectBestPatterns(){const startSize=this.possibleCenters.length;if(startSize<3){throw new NotFoundException();}
const possibleCenters=this.possibleCenters;let average;if(startSize>3){let totalModuleSize=0.0;let square=0.0;for(const center of this.possibleCenters){const size=center.getEstimatedModuleSize();totalModuleSize+=size;square+=size*size;}
average=totalModuleSize/startSize;let stdDev=Math.sqrt(square/startSize-average*average);possibleCenters.sort((center1,center2)=>{const dA=Math.abs(center2.getEstimatedModuleSize()-average);const dB=Math.abs(center1.getEstimatedModuleSize()-average);return dA<dB?-1:dA>dB?1:0;});const limit=Math.max(0.2*average,stdDev);for(let i=0;i<possibleCenters.length&&possibleCenters.length>3;i++){const pattern=possibleCenters[i];if(Math.abs(pattern.getEstimatedModuleSize()-average)>limit){possibleCenters.splice(i,1);i--;}}}
if(possibleCenters.length>3){let totalModuleSize=0.0;for(const possibleCenter of possibleCenters){totalModuleSize+=possibleCenter.getEstimatedModuleSize();}
average=totalModuleSize/possibleCenters.length;possibleCenters.sort((center1,center2)=>{if(center2.getCount()===center1.getCount()){const dA=Math.abs(center2.getEstimatedModuleSize()-average);const dB=Math.abs(center1.getEstimatedModuleSize()-average);return dA<dB?1:dA>dB?-1:0;}
else{return center2.getCount()-center1.getCount();}});possibleCenters.splice(3);}
return[possibleCenters[0],possibleCenters[1],possibleCenters[2]];}}
FinderPatternFinder.CENTER_QUORUM=2;FinderPatternFinder.MIN_SKIP=3;FinderPatternFinder.MAX_MODULES=57;class Detector$2{constructor(image){this.image=image;}
getImage(){return this.image;}
getResultPointCallback(){return this.resultPointCallback;}
detect(hints){this.resultPointCallback=(hints===null||hints===undefined)?null:hints.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);const finder=new FinderPatternFinder(this.image,this.resultPointCallback);const info=finder.find(hints);return this.processFinderPatternInfo(info);}
processFinderPatternInfo(info){const topLeft=info.getTopLeft();const topRight=info.getTopRight();const bottomLeft=info.getBottomLeft();const moduleSize=this.calculateModuleSize(topLeft,topRight,bottomLeft);if(moduleSize<1.0){throw new NotFoundException('No pattern found in proccess finder.');}
const dimension=Detector$2.computeDimension(topLeft,topRight,bottomLeft,moduleSize);const provisionalVersion=Version$1.getProvisionalVersionForDimension(dimension);const modulesBetweenFPCenters=provisionalVersion.getDimensionForVersion()-7;let alignmentPattern=null;if(provisionalVersion.getAlignmentPatternCenters().length>0){const bottomRightX=topRight.getX()-topLeft.getX()+bottomLeft.getX();const bottomRightY=topRight.getY()-topLeft.getY()+bottomLeft.getY();const correctionToTopLeft=1.0-3.0/modulesBetweenFPCenters;const estAlignmentX=Math.floor(topLeft.getX()+correctionToTopLeft*(bottomRightX-topLeft.getX()));const estAlignmentY=Math.floor(topLeft.getY()+correctionToTopLeft*(bottomRightY-topLeft.getY()));for(let i=4;i<=16;i<<=1){try{alignmentPattern=this.findAlignmentInRegion(moduleSize,estAlignmentX,estAlignmentY,i);break;}
catch(re){if(!(re instanceof NotFoundException)){throw re;}}}}
const transform=Detector$2.createTransform(topLeft,topRight,bottomLeft,alignmentPattern,dimension);const bits=Detector$2.sampleGrid(this.image,transform,dimension);let points;if(alignmentPattern===null){points=[bottomLeft,topLeft,topRight];}
else{points=[bottomLeft,topLeft,topRight,alignmentPattern];}
return new DetectorResult(bits,points);}
static createTransform(topLeft,topRight,bottomLeft,alignmentPattern,dimension){const dimMinusThree=dimension-3.5;let bottomRightX;let bottomRightY;let sourceBottomRightX;let sourceBottomRightY;if(alignmentPattern!==null){bottomRightX=alignmentPattern.getX();bottomRightY=alignmentPattern.getY();sourceBottomRightX=dimMinusThree-3.0;sourceBottomRightY=sourceBottomRightX;}
else{bottomRightX=(topRight.getX()-topLeft.getX())+bottomLeft.getX();bottomRightY=(topRight.getY()-topLeft.getY())+bottomLeft.getY();sourceBottomRightX=dimMinusThree;sourceBottomRightY=dimMinusThree;}
return PerspectiveTransform.quadrilateralToQuadrilateral(3.5,3.5,dimMinusThree,3.5,sourceBottomRightX,sourceBottomRightY,3.5,dimMinusThree,topLeft.getX(),topLeft.getY(),topRight.getX(),topRight.getY(),bottomRightX,bottomRightY,bottomLeft.getX(),bottomLeft.getY());}
static sampleGrid(image,transform,dimension){const sampler=GridSamplerInstance.getInstance();return sampler.sampleGridWithTransform(image,dimension,dimension,transform);}
static computeDimension(topLeft,topRight,bottomLeft,moduleSize){const tltrCentersDimension=MathUtils.round(ResultPoint.distance(topLeft,topRight)/moduleSize);const tlblCentersDimension=MathUtils.round(ResultPoint.distance(topLeft,bottomLeft)/moduleSize);let dimension=Math.floor((tltrCentersDimension+tlblCentersDimension)/2)+7;switch(dimension&0x03){case 0:dimension++;break;case 2:dimension--;break;case 3:throw new NotFoundException('Dimensions could be not found.');}
return dimension;}
calculateModuleSize(topLeft,topRight,bottomLeft){return(this.calculateModuleSizeOneWay(topLeft,topRight)+
this.calculateModuleSizeOneWay(topLeft,bottomLeft))/2.0;}
calculateModuleSizeOneWay(pattern,otherPattern){const moduleSizeEst1=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(pattern.getX()),Math.floor(pattern.getY()),Math.floor(otherPattern.getX()),Math.floor(otherPattern.getY()));const moduleSizeEst2=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(otherPattern.getX()),Math.floor(otherPattern.getY()),Math.floor(pattern.getX()),Math.floor(pattern.getY()));if(isNaN(moduleSizeEst1)){return moduleSizeEst2/7.0;}
if(isNaN(moduleSizeEst2)){return moduleSizeEst1/7.0;}
return(moduleSizeEst1+moduleSizeEst2)/14.0;}
sizeOfBlackWhiteBlackRunBothWays(fromX,fromY,toX,toY){let result=this.sizeOfBlackWhiteBlackRun(fromX,fromY,toX,toY);let scale=1.0;let otherToX=fromX-(toX-fromX);if(otherToX<0){scale=fromX/(fromX-otherToX);otherToX=0;}
else if(otherToX>=this.image.getWidth()){scale=(this.image.getWidth()-1-fromX)/(otherToX-fromX);otherToX=this.image.getWidth()-1;}
let otherToY=Math.floor(fromY-(toY-fromY)*scale);scale=1.0;if(otherToY<0){scale=fromY/(fromY-otherToY);otherToY=0;}
else if(otherToY>=this.image.getHeight()){scale=(this.image.getHeight()-1-fromY)/(otherToY-fromY);otherToY=this.image.getHeight()-1;}
otherToX=Math.floor(fromX+(otherToX-fromX)*scale);result+=this.sizeOfBlackWhiteBlackRun(fromX,fromY,otherToX,otherToY);return result-1.0;}
sizeOfBlackWhiteBlackRun(fromX,fromY,toX,toY){const steep=Math.abs(toY-fromY)>Math.abs(toX-fromX);if(steep){let temp=fromX;fromX=fromY;fromY=temp;temp=toX;toX=toY;toY=temp;}
const dx=Math.abs(toX-fromX);const dy=Math.abs(toY-fromY);let error=-dx/2;const xstep=fromX<toX?1:-1;const ystep=fromY<toY?1:-1;let state=0;const xLimit=toX+xstep;for(let x=fromX,y=fromY;x!==xLimit;x+=xstep){const realX=steep?y:x;const realY=steep?x:y;if((state===1)===this.image.get(realX,realY)){if(state===2){return MathUtils.distance(x,y,fromX,fromY);}
state++;}
error+=dy;if(error>0){if(y===toY){break;}
y+=ystep;error-=dx;}}
if(state===2){return MathUtils.distance(toX+xstep,toY,fromX,fromY);}
return NaN;}
findAlignmentInRegion(overallEstModuleSize,estAlignmentX,estAlignmentY,allowanceFactor){const allowance=Math.floor(allowanceFactor*overallEstModuleSize);const alignmentAreaLeftX=Math.max(0,estAlignmentX-allowance);const alignmentAreaRightX=Math.min(this.image.getWidth()-1,estAlignmentX+allowance);if(alignmentAreaRightX-alignmentAreaLeftX<overallEstModuleSize*3){throw new NotFoundException('Alignment top exceeds estimated module size.');}
const alignmentAreaTopY=Math.max(0,estAlignmentY-allowance);const alignmentAreaBottomY=Math.min(this.image.getHeight()-1,estAlignmentY+allowance);if(alignmentAreaBottomY-alignmentAreaTopY<overallEstModuleSize*3){throw new NotFoundException('Alignment bottom exceeds estimated module size.');}
const alignmentFinder=new AlignmentPatternFinder(this.image,alignmentAreaLeftX,alignmentAreaTopY,alignmentAreaRightX-alignmentAreaLeftX,alignmentAreaBottomY-alignmentAreaTopY,overallEstModuleSize,this.resultPointCallback);return alignmentFinder.find();}}
class QRCodeReader{constructor(){this.decoder=new Decoder$2();}
getDecoder(){return this.decoder;}
decode(image,hints){let decoderResult;let points;if(hints!==undefined&&hints!==null&&undefined!==hints.get(DecodeHintType$1.PURE_BARCODE)){const bits=QRCodeReader.extractPureBits(image.getBlackMatrix());decoderResult=this.decoder.decodeBitMatrix(bits,hints);points=QRCodeReader.NO_POINTS;}
else{const detectorResult=new Detector$2(image.getBlackMatrix()).detect(hints);decoderResult=this.decoder.decodeBitMatrix(detectorResult.getBits(),hints);points=detectorResult.getPoints();}
if(decoderResult.getOther()instanceof QRCodeDecoderMetaData){decoderResult.getOther().applyMirroredCorrection(points);}
const result=new Result(decoderResult.getText(),decoderResult.getRawBytes(),undefined,points,BarcodeFormat$1.QR_CODE,undefined);const byteSegments=decoderResult.getByteSegments();if(byteSegments!==null){result.putMetadata(ResultMetadataType$1.BYTE_SEGMENTS,byteSegments);}
const ecLevel=decoderResult.getECLevel();if(ecLevel!==null){result.putMetadata(ResultMetadataType$1.ERROR_CORRECTION_LEVEL,ecLevel);}
if(decoderResult.hasStructuredAppend()){result.putMetadata(ResultMetadataType$1.STRUCTURED_APPEND_SEQUENCE,decoderResult.getStructuredAppendSequenceNumber());result.putMetadata(ResultMetadataType$1.STRUCTURED_APPEND_PARITY,decoderResult.getStructuredAppendParity());}
return result;}
reset(){}
static extractPureBits(image){const leftTopBlack=image.getTopLeftOnBit();const rightBottomBlack=image.getBottomRightOnBit();if(leftTopBlack===null||rightBottomBlack===null){throw new NotFoundException();}
const moduleSize=this.moduleSize(leftTopBlack,image);let top=leftTopBlack[1];let bottom=rightBottomBlack[1];let left=leftTopBlack[0];let right=rightBottomBlack[0];if(left>=right||top>=bottom){throw new NotFoundException();}
if(bottom-top!==right-left){right=left+(bottom-top);if(right>=image.getWidth()){throw new NotFoundException();}}
const matrixWidth=Math.round((right-left+1)/moduleSize);const matrixHeight=Math.round((bottom-top+1)/moduleSize);if(matrixWidth<=0||matrixHeight<=0){throw new NotFoundException();}
if(matrixHeight!==matrixWidth){throw new NotFoundException();}
const nudge=Math.floor(moduleSize/2.0);top+=nudge;left+=nudge;const nudgedTooFarRight=left+Math.floor((matrixWidth-1)*moduleSize)-right;if(nudgedTooFarRight>0){if(nudgedTooFarRight>nudge){throw new NotFoundException();}
left-=nudgedTooFarRight;}
const nudgedTooFarDown=top+Math.floor((matrixHeight-1)*moduleSize)-bottom;if(nudgedTooFarDown>0){if(nudgedTooFarDown>nudge){throw new NotFoundException();}
top-=nudgedTooFarDown;}
const bits=new BitMatrix(matrixWidth,matrixHeight);for(let y=0;y<matrixHeight;y++){const iOffset=top+Math.floor(y*moduleSize);for(let x=0;x<matrixWidth;x++){if(image.get(left+Math.floor(x*moduleSize),iOffset)){bits.set(x,y);}}}
return bits;}
static moduleSize(leftTopBlack,image){const height=image.getHeight();const width=image.getWidth();let x=leftTopBlack[0];let y=leftTopBlack[1];let inBlack=true;let transitions=0;while(x<width&&y<height){if(inBlack!==image.get(x,y)){if(++transitions===5){break;}
inBlack=!inBlack;}
x++;y++;}
if(x===width||y===height){throw new NotFoundException();}
return(x-leftTopBlack[0])/7.0;}}
QRCodeReader.NO_POINTS=new Array();class PDF417Common{PDF417Common(){}
static getBitCountSum(moduleBitCount){return MathUtils.sum(moduleBitCount);}
static toIntArray(list){if(list==null||!list.length){return PDF417Common.EMPTY_INT_ARRAY;}
const result=new Int32Array(list.length);let i=0;for(const integer of list){result[i++]=integer;}
return result;}
static getCodeword(symbol){const i=Arrays.binarySearch(PDF417Common.SYMBOL_TABLE,symbol&0x3FFFF);if(i<0){return-1;}
return(PDF417Common.CODEWORD_TABLE[i]-1)%PDF417Common.NUMBER_OF_CODEWORDS;}}
PDF417Common.NUMBER_OF_CODEWORDS=929;PDF417Common.MAX_CODEWORDS_IN_BARCODE=PDF417Common.NUMBER_OF_CODEWORDS-1;PDF417Common.MIN_ROWS_IN_BARCODE=3;PDF417Common.MAX_ROWS_IN_BARCODE=90;PDF417Common.MODULES_IN_CODEWORD=17;PDF417Common.MODULES_IN_STOP_PATTERN=18;PDF417Common.BARS_IN_MODULE=8;PDF417Common.EMPTY_INT_ARRAY=new Int32Array([]);PDF417Common.SYMBOL_TABLE=Int32Array.from([0x1025e,0x1027a,0x1029e,0x102bc,0x102f2,0x102f4,0x1032e,0x1034e,0x1035c,0x10396,0x103a6,0x103ac,0x10422,0x10428,0x10436,0x10442,0x10444,0x10448,0x10450,0x1045e,0x10466,0x1046c,0x1047a,0x10482,0x1049e,0x104a0,0x104bc,0x104c6,0x104d8,0x104ee,0x104f2,0x104f4,0x10504,0x10508,0x10510,0x1051e,0x10520,0x1053c,0x10540,0x10578,0x10586,0x1058c,0x10598,0x105b0,0x105be,0x105ce,0x105dc,0x105e2,0x105e4,0x105e8,0x105f6,0x1062e,0x1064e,0x1065c,0x1068e,0x1069c,0x106b8,0x106de,0x106fa,0x10716,0x10726,0x1072c,0x10746,0x1074c,0x10758,0x1076e,0x10792,0x10794,0x107a2,0x107a4,0x107a8,0x107b6,0x10822,0x10828,0x10842,0x10848,0x10850,0x1085e,0x10866,0x1086c,0x1087a,0x10882,0x10884,0x10890,0x1089e,0x108a0,0x108bc,0x108c6,0x108cc,0x108d8,0x108ee,0x108f2,0x108f4,0x10902,0x10908,0x1091e,0x10920,0x1093c,0x10940,0x10978,0x10986,0x10998,0x109b0,0x109be,0x109ce,0x109dc,0x109e2,0x109e4,0x109e8,0x109f6,0x10a08,0x10a10,0x10a1e,0x10a20,0x10a3c,0x10a40,0x10a78,0x10af0,0x10b06,0x10b0c,0x10b18,0x10b30,0x10b3e,0x10b60,0x10b7c,0x10b8e,0x10b9c,0x10bb8,0x10bc2,0x10bc4,0x10bc8,0x10bd0,0x10bde,0x10be6,0x10bec,0x10c2e,0x10c4e,0x10c5c,0x10c62,0x10c64,0x10c68,0x10c76,0x10c8e,0x10c9c,0x10cb8,0x10cc2,0x10cc4,0x10cc8,0x10cd0,0x10cde,0x10ce6,0x10cec,0x10cfa,0x10d0e,0x10d1c,0x10d38,0x10d70,0x10d7e,0x10d82,0x10d84,0x10d88,0x10d90,0x10d9e,0x10da0,0x10dbc,0x10dc6,0x10dcc,0x10dd8,0x10dee,0x10df2,0x10df4,0x10e16,0x10e26,0x10e2c,0x10e46,0x10e58,0x10e6e,0x10e86,0x10e8c,0x10e98,0x10eb0,0x10ebe,0x10ece,0x10edc,0x10f0a,0x10f12,0x10f14,0x10f22,0x10f28,0x10f36,0x10f42,0x10f44,0x10f48,0x10f50,0x10f5e,0x10f66,0x10f6c,0x10fb2,0x10fb4,0x11022,0x11028,0x11042,0x11048,0x11050,0x1105e,0x1107a,0x11082,0x11084,0x11090,0x1109e,0x110a0,0x110bc,0x110c6,0x110cc,0x110d8,0x110ee,0x110f2,0x110f4,0x11102,0x1111e,0x11120,0x1113c,0x11140,0x11178,0x11186,0x11198,0x111b0,0x111be,0x111ce,0x111dc,0x111e2,0x111e4,0x111e8,0x111f6,0x11208,0x1121e,0x11220,0x11278,0x112f0,0x1130c,0x11330,0x1133e,0x11360,0x1137c,0x1138e,0x1139c,0x113b8,0x113c2,0x113c8,0x113d0,0x113de,0x113e6,0x113ec,0x11408,0x11410,0x1141e,0x11420,0x1143c,0x11440,0x11478,0x114f0,0x115e0,0x1160c,0x11618,0x11630,0x1163e,0x11660,0x1167c,0x116c0,0x116f8,0x1171c,0x11738,0x11770,0x1177e,0x11782,0x11784,0x11788,0x11790,0x1179e,0x117a0,0x117bc,0x117c6,0x117cc,0x117d8,0x117ee,0x1182e,0x11834,0x1184e,0x1185c,0x11862,0x11864,0x11868,0x11876,0x1188e,0x1189c,0x118b8,0x118c2,0x118c8,0x118d0,0x118de,0x118e6,0x118ec,0x118fa,0x1190e,0x1191c,0x11938,0x11970,0x1197e,0x11982,0x11984,0x11990,0x1199e,0x119a0,0x119bc,0x119c6,0x119cc,0x119d8,0x119ee,0x119f2,0x119f4,0x11a0e,0x11a1c,0x11a38,0x11a70,0x11a7e,0x11ae0,0x11afc,0x11b08,0x11b10,0x11b1e,0x11b20,0x11b3c,0x11b40,0x11b78,0x11b8c,0x11b98,0x11bb0,0x11bbe,0x11bce,0x11bdc,0x11be2,0x11be4,0x11be8,0x11bf6,0x11c16,0x11c26,0x11c2c,0x11c46,0x11c4c,0x11c58,0x11c6e,0x11c86,0x11c98,0x11cb0,0x11cbe,0x11cce,0x11cdc,0x11ce2,0x11ce4,0x11ce8,0x11cf6,0x11d06,0x11d0c,0x11d18,0x11d30,0x11d3e,0x11d60,0x11d7c,0x11d8e,0x11d9c,0x11db8,0x11dc4,0x11dc8,0x11dd0,0x11dde,0x11de6,0x11dec,0x11dfa,0x11e0a,0x11e12,0x11e14,0x11e22,0x11e24,0x11e28,0x11e36,0x11e42,0x11e44,0x11e50,0x11e5e,0x11e66,0x11e6c,0x11e82,0x11e84,0x11e88,0x11e90,0x11e9e,0x11ea0,0x11ebc,0x11ec6,0x11ecc,0x11ed8,0x11eee,0x11f1a,0x11f2e,0x11f32,0x11f34,0x11f4e,0x11f5c,0x11f62,0x11f64,0x11f68,0x11f76,0x12048,0x1205e,0x12082,0x12084,0x12090,0x1209e,0x120a0,0x120bc,0x120d8,0x120f2,0x120f4,0x12108,0x1211e,0x12120,0x1213c,0x12140,0x12178,0x12186,0x12198,0x121b0,0x121be,0x121e2,0x121e4,0x121e8,0x121f6,0x12204,0x12210,0x1221e,0x12220,0x12278,0x122f0,0x12306,0x1230c,0x12330,0x1233e,0x12360,0x1237c,0x1238e,0x1239c,0x123b8,0x123c2,0x123c8,0x123d0,0x123e6,0x123ec,0x1241e,0x12420,0x1243c,0x124f0,0x125e0,0x12618,0x1263e,0x12660,0x1267c,0x126c0,0x126f8,0x12738,0x12770,0x1277e,0x12782,0x12784,0x12790,0x1279e,0x127a0,0x127bc,0x127c6,0x127cc,0x127d8,0x127ee,0x12820,0x1283c,0x12840,0x12878,0x128f0,0x129e0,0x12bc0,0x12c18,0x12c30,0x12c3e,0x12c60,0x12c7c,0x12cc0,0x12cf8,0x12df0,0x12e1c,0x12e38,0x12e70,0x12e7e,0x12ee0,0x12efc,0x12f04,0x12f08,0x12f10,0x12f20,0x12f3c,0x12f40,0x12f78,0x12f86,0x12f8c,0x12f98,0x12fb0,0x12fbe,0x12fce,0x12fdc,0x1302e,0x1304e,0x1305c,0x13062,0x13068,0x1308e,0x1309c,0x130b8,0x130c2,0x130c8,0x130d0,0x130de,0x130ec,0x130fa,0x1310e,0x13138,0x13170,0x1317e,0x13182,0x13184,0x13190,0x1319e,0x131a0,0x131bc,0x131c6,0x131cc,0x131d8,0x131f2,0x131f4,0x1320e,0x1321c,0x13270,0x1327e,0x132e0,0x132fc,0x13308,0x1331e,0x13320,0x1333c,0x13340,0x13378,0x13386,0x13398,0x133b0,0x133be,0x133ce,0x133dc,0x133e2,0x133e4,0x133e8,0x133f6,0x1340e,0x1341c,0x13438,0x13470,0x1347e,0x134e0,0x134fc,0x135c0,0x135f8,0x13608,0x13610,0x1361e,0x13620,0x1363c,0x13640,0x13678,0x136f0,0x1370c,0x13718,0x13730,0x1373e,0x13760,0x1377c,0x1379c,0x137b8,0x137c2,0x137c4,0x137c8,0x137d0,0x137de,0x137e6,0x137ec,0x13816,0x13826,0x1382c,0x13846,0x1384c,0x13858,0x1386e,0x13874,0x13886,0x13898,0x138b0,0x138be,0x138ce,0x138dc,0x138e2,0x138e4,0x138e8,0x13906,0x1390c,0x13930,0x1393e,0x13960,0x1397c,0x1398e,0x1399c,0x139b8,0x139c8,0x139d0,0x139de,0x139e6,0x139ec,0x139fa,0x13a06,0x13a0c,0x13a18,0x13a30,0x13a3e,0x13a60,0x13a7c,0x13ac0,0x13af8,0x13b0e,0x13b1c,0x13b38,0x13b70,0x13b7e,0x13b88,0x13b90,0x13b9e,0x13ba0,0x13bbc,0x13bcc,0x13bd8,0x13bee,0x13bf2,0x13bf4,0x13c12,0x13c14,0x13c22,0x13c24,0x13c28,0x13c36,0x13c42,0x13c48,0x13c50,0x13c5e,0x13c66,0x13c6c,0x13c82,0x13c84,0x13c90,0x13c9e,0x13ca0,0x13cbc,0x13cc6,0x13ccc,0x13cd8,0x13cee,0x13d02,0x13d04,0x13d08,0x13d10,0x13d1e,0x13d20,0x13d3c,0x13d40,0x13d78,0x13d86,0x13d8c,0x13d98,0x13db0,0x13dbe,0x13dce,0x13ddc,0x13de4,0x13de8,0x13df6,0x13e1a,0x13e2e,0x13e32,0x13e34,0x13e4e,0x13e5c,0x13e62,0x13e64,0x13e68,0x13e76,0x13e8e,0x13e9c,0x13eb8,0x13ec2,0x13ec4,0x13ec8,0x13ed0,0x13ede,0x13ee6,0x13eec,0x13f26,0x13f2c,0x13f3a,0x13f46,0x13f4c,0x13f58,0x13f6e,0x13f72,0x13f74,0x14082,0x1409e,0x140a0,0x140bc,0x14104,0x14108,0x14110,0x1411e,0x14120,0x1413c,0x14140,0x14178,0x1418c,0x14198,0x141b0,0x141be,0x141e2,0x141e4,0x141e8,0x14208,0x14210,0x1421e,0x14220,0x1423c,0x14240,0x14278,0x142f0,0x14306,0x1430c,0x14318,0x14330,0x1433e,0x14360,0x1437c,0x1438e,0x143c2,0x143c4,0x143c8,0x143d0,0x143e6,0x143ec,0x14408,0x14410,0x1441e,0x14420,0x1443c,0x14440,0x14478,0x144f0,0x145e0,0x1460c,0x14618,0x14630,0x1463e,0x14660,0x1467c,0x146c0,0x146f8,0x1471c,0x14738,0x14770,0x1477e,0x14782,0x14784,0x14788,0x14790,0x147a0,0x147bc,0x147c6,0x147cc,0x147d8,0x147ee,0x14810,0x14820,0x1483c,0x14840,0x14878,0x148f0,0x149e0,0x14bc0,0x14c30,0x14c3e,0x14c60,0x14c7c,0x14cc0,0x14cf8,0x14df0,0x14e38,0x14e70,0x14e7e,0x14ee0,0x14efc,0x14f04,0x14f08,0x14f10,0x14f1e,0x14f20,0x14f3c,0x14f40,0x14f78,0x14f86,0x14f8c,0x14f98,0x14fb0,0x14fce,0x14fdc,0x15020,0x15040,0x15078,0x150f0,0x151e0,0x153c0,0x15860,0x1587c,0x158c0,0x158f8,0x159f0,0x15be0,0x15c70,0x15c7e,0x15ce0,0x15cfc,0x15dc0,0x15df8,0x15e08,0x15e10,0x15e20,0x15e40,0x15e78,0x15ef0,0x15f0c,0x15f18,0x15f30,0x15f60,0x15f7c,0x15f8e,0x15f9c,0x15fb8,0x1604e,0x1605c,0x1608e,0x1609c,0x160b8,0x160c2,0x160c4,0x160c8,0x160de,0x1610e,0x1611c,0x16138,0x16170,0x1617e,0x16184,0x16188,0x16190,0x1619e,0x161a0,0x161bc,0x161c6,0x161cc,0x161d8,0x161f2,0x161f4,0x1620e,0x1621c,0x16238,0x16270,0x1627e,0x162e0,0x162fc,0x16304,0x16308,0x16310,0x1631e,0x16320,0x1633c,0x16340,0x16378,0x16386,0x1638c,0x16398,0x163b0,0x163be,0x163ce,0x163dc,0x163e2,0x163e4,0x163e8,0x163f6,0x1640e,0x1641c,0x16438,0x16470,0x1647e,0x164e0,0x164fc,0x165c0,0x165f8,0x16610,0x1661e,0x16620,0x1663c,0x16640,0x16678,0x166f0,0x16718,0x16730,0x1673e,0x16760,0x1677c,0x1678e,0x1679c,0x167b8,0x167c2,0x167c4,0x167c8,0x167d0,0x167de,0x167e6,0x167ec,0x1681c,0x16838,0x16870,0x168e0,0x168fc,0x169c0,0x169f8,0x16bf0,0x16c10,0x16c1e,0x16c20,0x16c3c,0x16c40,0x16c78,0x16cf0,0x16de0,0x16e18,0x16e30,0x16e3e,0x16e60,0x16e7c,0x16ec0,0x16ef8,0x16f1c,0x16f38,0x16f70,0x16f7e,0x16f84,0x16f88,0x16f90,0x16f9e,0x16fa0,0x16fbc,0x16fc6,0x16fcc,0x16fd8,0x17026,0x1702c,0x17046,0x1704c,0x17058,0x1706e,0x17086,0x1708c,0x17098,0x170b0,0x170be,0x170ce,0x170dc,0x170e8,0x17106,0x1710c,0x17118,0x17130,0x1713e,0x17160,0x1717c,0x1718e,0x1719c,0x171b8,0x171c2,0x171c4,0x171c8,0x171d0,0x171de,0x171e6,0x171ec,0x171fa,0x17206,0x1720c,0x17218,0x17230,0x1723e,0x17260,0x1727c,0x172c0,0x172f8,0x1730e,0x1731c,0x17338,0x17370,0x1737e,0x17388,0x17390,0x1739e,0x173a0,0x173bc,0x173cc,0x173d8,0x173ee,0x173f2,0x173f4,0x1740c,0x17418,0x17430,0x1743e,0x17460,0x1747c,0x174c0,0x174f8,0x175f0,0x1760e,0x1761c,0x17638,0x17670,0x1767e,0x176e0,0x176fc,0x17708,0x17710,0x1771e,0x17720,0x1773c,0x17740,0x17778,0x17798,0x177b0,0x177be,0x177dc,0x177e2,0x177e4,0x177e8,0x17822,0x17824,0x17828,0x17836,0x17842,0x17844,0x17848,0x17850,0x1785e,0x17866,0x1786c,0x17882,0x17884,0x17888,0x17890,0x1789e,0x178a0,0x178bc,0x178c6,0x178cc,0x178d8,0x178ee,0x178f2,0x178f4,0x17902,0x17904,0x17908,0x17910,0x1791e,0x17920,0x1793c,0x17940,0x17978,0x17986,0x1798c,0x17998,0x179b0,0x179be,0x179ce,0x179dc,0x179e2,0x179e4,0x179e8,0x179f6,0x17a04,0x17a08,0x17a10,0x17a1e,0x17a20,0x17a3c,0x17a40,0x17a78,0x17af0,0x17b06,0x17b0c,0x17b18,0x17b30,0x17b3e,0x17b60,0x17b7c,0x17b8e,0x17b9c,0x17bb8,0x17bc4,0x17bc8,0x17bd0,0x17bde,0x17be6,0x17bec,0x17c2e,0x17c32,0x17c34,0x17c4e,0x17c5c,0x17c62,0x17c64,0x17c68,0x17c76,0x17c8e,0x17c9c,0x17cb8,0x17cc2,0x17cc4,0x17cc8,0x17cd0,0x17cde,0x17ce6,0x17cec,0x17d0e,0x17d1c,0x17d38,0x17d70,0x17d82,0x17d84,0x17d88,0x17d90,0x17d9e,0x17da0,0x17dbc,0x17dc6,0x17dcc,0x17dd8,0x17dee,0x17e26,0x17e2c,0x17e3a,0x17e46,0x17e4c,0x17e58,0x17e6e,0x17e72,0x17e74,0x17e86,0x17e8c,0x17e98,0x17eb0,0x17ece,0x17edc,0x17ee2,0x17ee4,0x17ee8,0x17ef6,0x1813a,0x18172,0x18174,0x18216,0x18226,0x1823a,0x1824c,0x18258,0x1826e,0x18272,0x18274,0x18298,0x182be,0x182e2,0x182e4,0x182e8,0x182f6,0x1835e,0x1837a,0x183ae,0x183d6,0x18416,0x18426,0x1842c,0x1843a,0x18446,0x18458,0x1846e,0x18472,0x18474,0x18486,0x184b0,0x184be,0x184ce,0x184dc,0x184e2,0x184e4,0x184e8,0x184f6,0x18506,0x1850c,0x18518,0x18530,0x1853e,0x18560,0x1857c,0x1858e,0x1859c,0x185b8,0x185c2,0x185c4,0x185c8,0x185d0,0x185de,0x185e6,0x185ec,0x185fa,0x18612,0x18614,0x18622,0x18628,0x18636,0x18642,0x18650,0x1865e,0x1867a,0x18682,0x18684,0x18688,0x18690,0x1869e,0x186a0,0x186bc,0x186c6,0x186cc,0x186d8,0x186ee,0x186f2,0x186f4,0x1872e,0x1874e,0x1875c,0x18796,0x187a6,0x187ac,0x187d2,0x187d4,0x18826,0x1882c,0x1883a,0x18846,0x1884c,0x18858,0x1886e,0x18872,0x18874,0x18886,0x18898,0x188b0,0x188be,0x188ce,0x188dc,0x188e2,0x188e4,0x188e8,0x188f6,0x1890c,0x18930,0x1893e,0x18960,0x1897c,0x1898e,0x189b8,0x189c2,0x189c8,0x189d0,0x189de,0x189e6,0x189ec,0x189fa,0x18a18,0x18a30,0x18a3e,0x18a60,0x18a7c,0x18ac0,0x18af8,0x18b1c,0x18b38,0x18b70,0x18b7e,0x18b82,0x18b84,0x18b88,0x18b90,0x18b9e,0x18ba0,0x18bbc,0x18bc6,0x18bcc,0x18bd8,0x18bee,0x18bf2,0x18bf4,0x18c22,0x18c24,0x18c28,0x18c36,0x18c42,0x18c48,0x18c50,0x18c5e,0x18c66,0x18c7a,0x18c82,0x18c84,0x18c90,0x18c9e,0x18ca0,0x18cbc,0x18ccc,0x18cf2,0x18cf4,0x18d04,0x18d08,0x18d10,0x18d1e,0x18d20,0x18d3c,0x18d40,0x18d78,0x18d86,0x18d98,0x18dce,0x18de2,0x18de4,0x18de8,0x18e2e,0x18e32,0x18e34,0x18e4e,0x18e5c,0x18e62,0x18e64,0x18e68,0x18e8e,0x18e9c,0x18eb8,0x18ec2,0x18ec4,0x18ec8,0x18ed0,0x18efa,0x18f16,0x18f26,0x18f2c,0x18f46,0x18f4c,0x18f58,0x18f6e,0x18f8a,0x18f92,0x18f94,0x18fa2,0x18fa4,0x18fa8,0x18fb6,0x1902c,0x1903a,0x19046,0x1904c,0x19058,0x19072,0x19074,0x19086,0x19098,0x190b0,0x190be,0x190ce,0x190dc,0x190e2,0x190e8,0x190f6,0x19106,0x1910c,0x19130,0x1913e,0x19160,0x1917c,0x1918e,0x1919c,0x191b8,0x191c2,0x191c8,0x191d0,0x191de,0x191e6,0x191ec,0x191fa,0x19218,0x1923e,0x19260,0x1927c,0x192c0,0x192f8,0x19338,0x19370,0x1937e,0x19382,0x19384,0x19390,0x1939e,0x193a0,0x193bc,0x193c6,0x193cc,0x193d8,0x193ee,0x193f2,0x193f4,0x19430,0x1943e,0x19460,0x1947c,0x194c0,0x194f8,0x195f0,0x19638,0x19670,0x1967e,0x196e0,0x196fc,0x19702,0x19704,0x19708,0x19710,0x19720,0x1973c,0x19740,0x19778,0x19786,0x1978c,0x19798,0x197b0,0x197be,0x197ce,0x197dc,0x197e2,0x197e4,0x197e8,0x19822,0x19824,0x19842,0x19848,0x19850,0x1985e,0x19866,0x1987a,0x19882,0x19884,0x19890,0x1989e,0x198a0,0x198bc,0x198cc,0x198f2,0x198f4,0x19902,0x19908,0x1991e,0x19920,0x1993c,0x19940,0x19978,0x19986,0x19998,0x199ce,0x199e2,0x199e4,0x199e8,0x19a08,0x19a10,0x19a1e,0x19a20,0x19a3c,0x19a40,0x19a78,0x19af0,0x19b18,0x19b3e,0x19b60,0x19b9c,0x19bc2,0x19bc4,0x19bc8,0x19bd0,0x19be6,0x19c2e,0x19c34,0x19c4e,0x19c5c,0x19c62,0x19c64,0x19c68,0x19c8e,0x19c9c,0x19cb8,0x19cc2,0x19cc8,0x19cd0,0x19ce6,0x19cfa,0x19d0e,0x19d1c,0x19d38,0x19d70,0x19d7e,0x19d82,0x19d84,0x19d88,0x19d90,0x19da0,0x19dcc,0x19df2,0x19df4,0x19e16,0x19e26,0x19e2c,0x19e46,0x19e4c,0x19e58,0x19e74,0x19e86,0x19e8c,0x19e98,0x19eb0,0x19ebe,0x19ece,0x19ee2,0x19ee4,0x19ee8,0x19f0a,0x19f12,0x19f14,0x19f22,0x19f24,0x19f28,0x19f42,0x19f44,0x19f48,0x19f50,0x19f5e,0x19f6c,0x19f9a,0x19fae,0x19fb2,0x19fb4,0x1a046,0x1a04c,0x1a072,0x1a074,0x1a086,0x1a08c,0x1a098,0x1a0b0,0x1a0be,0x1a0e2,0x1a0e4,0x1a0e8,0x1a0f6,0x1a106,0x1a10c,0x1a118,0x1a130,0x1a13e,0x1a160,0x1a17c,0x1a18e,0x1a19c,0x1a1b8,0x1a1c2,0x1a1c4,0x1a1c8,0x1a1d0,0x1a1de,0x1a1e6,0x1a1ec,0x1a218,0x1a230,0x1a23e,0x1a260,0x1a27c,0x1a2c0,0x1a2f8,0x1a31c,0x1a338,0x1a370,0x1a37e,0x1a382,0x1a384,0x1a388,0x1a390,0x1a39e,0x1a3a0,0x1a3bc,0x1a3c6,0x1a3cc,0x1a3d8,0x1a3ee,0x1a3f2,0x1a3f4,0x1a418,0x1a430,0x1a43e,0x1a460,0x1a47c,0x1a4c0,0x1a4f8,0x1a5f0,0x1a61c,0x1a638,0x1a670,0x1a67e,0x1a6e0,0x1a6fc,0x1a702,0x1a704,0x1a708,0x1a710,0x1a71e,0x1a720,0x1a73c,0x1a740,0x1a778,0x1a786,0x1a78c,0x1a798,0x1a7b0,0x1a7be,0x1a7ce,0x1a7dc,0x1a7e2,0x1a7e4,0x1a7e8,0x1a830,0x1a860,0x1a87c,0x1a8c0,0x1a8f8,0x1a9f0,0x1abe0,0x1ac70,0x1ac7e,0x1ace0,0x1acfc,0x1adc0,0x1adf8,0x1ae04,0x1ae08,0x1ae10,0x1ae20,0x1ae3c,0x1ae40,0x1ae78,0x1aef0,0x1af06,0x1af0c,0x1af18,0x1af30,0x1af3e,0x1af60,0x1af7c,0x1af8e,0x1af9c,0x1afb8,0x1afc4,0x1afc8,0x1afd0,0x1afde,0x1b042,0x1b05e,0x1b07a,0x1b082,0x1b084,0x1b088,0x1b090,0x1b09e,0x1b0a0,0x1b0bc,0x1b0cc,0x1b0f2,0x1b0f4,0x1b102,0x1b104,0x1b108,0x1b110,0x1b11e,0x1b120,0x1b13c,0x1b140,0x1b178,0x1b186,0x1b198,0x1b1ce,0x1b1e2,0x1b1e4,0x1b1e8,0x1b204,0x1b208,0x1b210,0x1b21e,0x1b220,0x1b23c,0x1b240,0x1b278,0x1b2f0,0x1b30c,0x1b33e,0x1b360,0x1b39c,0x1b3c2,0x1b3c4,0x1b3c8,0x1b3d0,0x1b3e6,0x1b410,0x1b41e,0x1b420,0x1b43c,0x1b440,0x1b478,0x1b4f0,0x1b5e0,0x1b618,0x1b660,0x1b67c,0x1b6c0,0x1b738,0x1b782,0x1b784,0x1b788,0x1b790,0x1b79e,0x1b7a0,0x1b7cc,0x1b82e,0x1b84e,0x1b85c,0x1b88e,0x1b89c,0x1b8b8,0x1b8c2,0x1b8c4,0x1b8c8,0x1b8d0,0x1b8e6,0x1b8fa,0x1b90e,0x1b91c,0x1b938,0x1b970,0x1b97e,0x1b982,0x1b984,0x1b988,0x1b990,0x1b99e,0x1b9a0,0x1b9cc,0x1b9f2,0x1b9f4,0x1ba0e,0x1ba1c,0x1ba38,0x1ba70,0x1ba7e,0x1bae0,0x1bafc,0x1bb08,0x1bb10,0x1bb20,0x1bb3c,0x1bb40,0x1bb98,0x1bbce,0x1bbe2,0x1bbe4,0x1bbe8,0x1bc16,0x1bc26,0x1bc2c,0x1bc46,0x1bc4c,0x1bc58,0x1bc72,0x1bc74,0x1bc86,0x1bc8c,0x1bc98,0x1bcb0,0x1bcbe,0x1bcce,0x1bce2,0x1bce4,0x1bce8,0x1bd06,0x1bd0c,0x1bd18,0x1bd30,0x1bd3e,0x1bd60,0x1bd7c,0x1bd9c,0x1bdc2,0x1bdc4,0x1bdc8,0x1bdd0,0x1bde6,0x1bdfa,0x1be12,0x1be14,0x1be22,0x1be24,0x1be28,0x1be42,0x1be44,0x1be48,0x1be50,0x1be5e,0x1be66,0x1be82,0x1be84,0x1be88,0x1be90,0x1be9e,0x1bea0,0x1bebc,0x1becc,0x1bef4,0x1bf1a,0x1bf2e,0x1bf32,0x1bf34,0x1bf4e,0x1bf5c,0x1bf62,0x1bf64,0x1bf68,0x1c09a,0x1c0b2,0x1c0b4,0x1c11a,0x1c132,0x1c134,0x1c162,0x1c164,0x1c168,0x1c176,0x1c1ba,0x1c21a,0x1c232,0x1c234,0x1c24e,0x1c25c,0x1c262,0x1c264,0x1c268,0x1c276,0x1c28e,0x1c2c2,0x1c2c4,0x1c2c8,0x1c2d0,0x1c2de,0x1c2e6,0x1c2ec,0x1c2fa,0x1c316,0x1c326,0x1c33a,0x1c346,0x1c34c,0x1c372,0x1c374,0x1c41a,0x1c42e,0x1c432,0x1c434,0x1c44e,0x1c45c,0x1c462,0x1c464,0x1c468,0x1c476,0x1c48e,0x1c49c,0x1c4b8,0x1c4c2,0x1c4c8,0x1c4d0,0x1c4de,0x1c4e6,0x1c4ec,0x1c4fa,0x1c51c,0x1c538,0x1c570,0x1c57e,0x1c582,0x1c584,0x1c588,0x1c590,0x1c59e,0x1c5a0,0x1c5bc,0x1c5c6,0x1c5cc,0x1c5d8,0x1c5ee,0x1c5f2,0x1c5f4,0x1c616,0x1c626,0x1c62c,0x1c63a,0x1c646,0x1c64c,0x1c658,0x1c66e,0x1c672,0x1c674,0x1c686,0x1c68c,0x1c698,0x1c6b0,0x1c6be,0x1c6ce,0x1c6dc,0x1c6e2,0x1c6e4,0x1c6e8,0x1c712,0x1c714,0x1c722,0x1c728,0x1c736,0x1c742,0x1c744,0x1c748,0x1c750,0x1c75e,0x1c766,0x1c76c,0x1c77a,0x1c7ae,0x1c7d6,0x1c7ea,0x1c81a,0x1c82e,0x1c832,0x1c834,0x1c84e,0x1c85c,0x1c862,0x1c864,0x1c868,0x1c876,0x1c88e,0x1c89c,0x1c8b8,0x1c8c2,0x1c8c8,0x1c8d0,0x1c8de,0x1c8e6,0x1c8ec,0x1c8fa,0x1c90e,0x1c938,0x1c970,0x1c97e,0x1c982,0x1c984,0x1c990,0x1c99e,0x1c9a0,0x1c9bc,0x1c9c6,0x1c9cc,0x1c9d8,0x1c9ee,0x1c9f2,0x1c9f4,0x1ca38,0x1ca70,0x1ca7e,0x1cae0,0x1cafc,0x1cb02,0x1cb04,0x1cb08,0x1cb10,0x1cb20,0x1cb3c,0x1cb40,0x1cb78,0x1cb86,0x1cb8c,0x1cb98,0x1cbb0,0x1cbbe,0x1cbce,0x1cbdc,0x1cbe2,0x1cbe4,0x1cbe8,0x1cbf6,0x1cc16,0x1cc26,0x1cc2c,0x1cc3a,0x1cc46,0x1cc58,0x1cc72,0x1cc74,0x1cc86,0x1ccb0,0x1ccbe,0x1ccce,0x1cce2,0x1cce4,0x1cce8,0x1cd06,0x1cd0c,0x1cd18,0x1cd30,0x1cd3e,0x1cd60,0x1cd7c,0x1cd9c,0x1cdc2,0x1cdc4,0x1cdc8,0x1cdd0,0x1cdde,0x1cde6,0x1cdfa,0x1ce22,0x1ce28,0x1ce42,0x1ce50,0x1ce5e,0x1ce66,0x1ce7a,0x1ce82,0x1ce84,0x1ce88,0x1ce90,0x1ce9e,0x1cea0,0x1cebc,0x1cecc,0x1cef2,0x1cef4,0x1cf2e,0x1cf32,0x1cf34,0x1cf4e,0x1cf5c,0x1cf62,0x1cf64,0x1cf68,0x1cf96,0x1cfa6,0x1cfac,0x1cfca,0x1cfd2,0x1cfd4,0x1d02e,0x1d032,0x1d034,0x1d04e,0x1d05c,0x1d062,0x1d064,0x1d068,0x1d076,0x1d08e,0x1d09c,0x1d0b8,0x1d0c2,0x1d0c4,0x1d0c8,0x1d0d0,0x1d0de,0x1d0e6,0x1d0ec,0x1d0fa,0x1d11c,0x1d138,0x1d170,0x1d17e,0x1d182,0x1d184,0x1d188,0x1d190,0x1d19e,0x1d1a0,0x1d1bc,0x1d1c6,0x1d1cc,0x1d1d8,0x1d1ee,0x1d1f2,0x1d1f4,0x1d21c,0x1d238,0x1d270,0x1d27e,0x1d2e0,0x1d2fc,0x1d302,0x1d304,0x1d308,0x1d310,0x1d31e,0x1d320,0x1d33c,0x1d340,0x1d378,0x1d386,0x1d38c,0x1d398,0x1d3b0,0x1d3be,0x1d3ce,0x1d3dc,0x1d3e2,0x1d3e4,0x1d3e8,0x1d3f6,0x1d470,0x1d47e,0x1d4e0,0x1d4fc,0x1d5c0,0x1d5f8,0x1d604,0x1d608,0x1d610,0x1d620,0x1d640,0x1d678,0x1d6f0,0x1d706,0x1d70c,0x1d718,0x1d730,0x1d73e,0x1d760,0x1d77c,0x1d78e,0x1d79c,0x1d7b8,0x1d7c2,0x1d7c4,0x1d7c8,0x1d7d0,0x1d7de,0x1d7e6,0x1d7ec,0x1d826,0x1d82c,0x1d83a,0x1d846,0x1d84c,0x1d858,0x1d872,0x1d874,0x1d886,0x1d88c,0x1d898,0x1d8b0,0x1d8be,0x1d8ce,0x1d8e2,0x1d8e4,0x1d8e8,0x1d8f6,0x1d90c,0x1d918,0x1d930,0x1d93e,0x1d960,0x1d97c,0x1d99c,0x1d9c2,0x1d9c4,0x1d9c8,0x1d9d0,0x1d9e6,0x1d9fa,0x1da0c,0x1da18,0x1da30,0x1da3e,0x1da60,0x1da7c,0x1dac0,0x1daf8,0x1db38,0x1db82,0x1db84,0x1db88,0x1db90,0x1db9e,0x1dba0,0x1dbcc,0x1dbf2,0x1dbf4,0x1dc22,0x1dc42,0x1dc44,0x1dc48,0x1dc50,0x1dc5e,0x1dc66,0x1dc7a,0x1dc82,0x1dc84,0x1dc88,0x1dc90,0x1dc9e,0x1dca0,0x1dcbc,0x1dccc,0x1dcf2,0x1dcf4,0x1dd04,0x1dd08,0x1dd10,0x1dd1e,0x1dd20,0x1dd3c,0x1dd40,0x1dd78,0x1dd86,0x1dd98,0x1ddce,0x1dde2,0x1dde4,0x1dde8,0x1de2e,0x1de32,0x1de34,0x1de4e,0x1de5c,0x1de62,0x1de64,0x1de68,0x1de8e,0x1de9c,0x1deb8,0x1dec2,0x1dec4,0x1dec8,0x1ded0,0x1dee6,0x1defa,0x1df16,0x1df26,0x1df2c,0x1df46,0x1df4c,0x1df58,0x1df72,0x1df74,0x1df8a,0x1df92,0x1df94,0x1dfa2,0x1dfa4,0x1dfa8,0x1e08a,0x1e092,0x1e094,0x1e0a2,0x1e0a4,0x1e0a8,0x1e0b6,0x1e0da,0x1e10a,0x1e112,0x1e114,0x1e122,0x1e124,0x1e128,0x1e136,0x1e142,0x1e144,0x1e148,0x1e150,0x1e166,0x1e16c,0x1e17a,0x1e19a,0x1e1b2,0x1e1b4,0x1e20a,0x1e212,0x1e214,0x1e222,0x1e224,0x1e228,0x1e236,0x1e242,0x1e248,0x1e250,0x1e25e,0x1e266,0x1e26c,0x1e27a,0x1e282,0x1e284,0x1e288,0x1e290,0x1e2a0,0x1e2bc,0x1e2c6,0x1e2cc,0x1e2d8,0x1e2ee,0x1e2f2,0x1e2f4,0x1e31a,0x1e332,0x1e334,0x1e35c,0x1e362,0x1e364,0x1e368,0x1e3ba,0x1e40a,0x1e412,0x1e414,0x1e422,0x1e428,0x1e436,0x1e442,0x1e448,0x1e450,0x1e45e,0x1e466,0x1e46c,0x1e47a,0x1e482,0x1e484,0x1e490,0x1e49e,0x1e4a0,0x1e4bc,0x1e4c6,0x1e4cc,0x1e4d8,0x1e4ee,0x1e4f2,0x1e4f4,0x1e502,0x1e504,0x1e508,0x1e510,0x1e51e,0x1e520,0x1e53c,0x1e540,0x1e578,0x1e586,0x1e58c,0x1e598,0x1e5b0,0x1e5be,0x1e5ce,0x1e5dc,0x1e5e2,0x1e5e4,0x1e5e8,0x1e5f6,0x1e61a,0x1e62e,0x1e632,0x1e634,0x1e64e,0x1e65c,0x1e662,0x1e668,0x1e68e,0x1e69c,0x1e6b8,0x1e6c2,0x1e6c4,0x1e6c8,0x1e6d0,0x1e6e6,0x1e6fa,0x1e716,0x1e726,0x1e72c,0x1e73a,0x1e746,0x1e74c,0x1e758,0x1e772,0x1e774,0x1e792,0x1e794,0x1e7a2,0x1e7a4,0x1e7a8,0x1e7b6,0x1e812,0x1e814,0x1e822,0x1e824,0x1e828,0x1e836,0x1e842,0x1e844,0x1e848,0x1e850,0x1e85e,0x1e866,0x1e86c,0x1e87a,0x1e882,0x1e884,0x1e888,0x1e890,0x1e89e,0x1e8a0,0x1e8bc,0x1e8c6,0x1e8cc,0x1e8d8,0x1e8ee,0x1e8f2,0x1e8f4,0x1e902,0x1e904,0x1e908,0x1e910,0x1e920,0x1e93c,0x1e940,0x1e978,0x1e986,0x1e98c,0x1e998,0x1e9b0,0x1e9be,0x1e9ce,0x1e9dc,0x1e9e2,0x1e9e4,0x1e9e8,0x1e9f6,0x1ea04,0x1ea08,0x1ea10,0x1ea20,0x1ea40,0x1ea78,0x1eaf0,0x1eb06,0x1eb0c,0x1eb18,0x1eb30,0x1eb3e,0x1eb60,0x1eb7c,0x1eb8e,0x1eb9c,0x1ebb8,0x1ebc2,0x1ebc4,0x1ebc8,0x1ebd0,0x1ebde,0x1ebe6,0x1ebec,0x1ec1a,0x1ec2e,0x1ec32,0x1ec34,0x1ec4e,0x1ec5c,0x1ec62,0x1ec64,0x1ec68,0x1ec8e,0x1ec9c,0x1ecb8,0x1ecc2,0x1ecc4,0x1ecc8,0x1ecd0,0x1ece6,0x1ecfa,0x1ed0e,0x1ed1c,0x1ed38,0x1ed70,0x1ed7e,0x1ed82,0x1ed84,0x1ed88,0x1ed90,0x1ed9e,0x1eda0,0x1edcc,0x1edf2,0x1edf4,0x1ee16,0x1ee26,0x1ee2c,0x1ee3a,0x1ee46,0x1ee4c,0x1ee58,0x1ee6e,0x1ee72,0x1ee74,0x1ee86,0x1ee8c,0x1ee98,0x1eeb0,0x1eebe,0x1eece,0x1eedc,0x1eee2,0x1eee4,0x1eee8,0x1ef12,0x1ef22,0x1ef24,0x1ef28,0x1ef36,0x1ef42,0x1ef44,0x1ef48,0x1ef50,0x1ef5e,0x1ef66,0x1ef6c,0x1ef7a,0x1efae,0x1efb2,0x1efb4,0x1efd6,0x1f096,0x1f0a6,0x1f0ac,0x1f0ba,0x1f0ca,0x1f0d2,0x1f0d4,0x1f116,0x1f126,0x1f12c,0x1f13a,0x1f146,0x1f14c,0x1f158,0x1f16e,0x1f172,0x1f174,0x1f18a,0x1f192,0x1f194,0x1f1a2,0x1f1a4,0x1f1a8,0x1f1da,0x1f216,0x1f226,0x1f22c,0x1f23a,0x1f246,0x1f258,0x1f26e,0x1f272,0x1f274,0x1f286,0x1f28c,0x1f298,0x1f2b0,0x1f2be,0x1f2ce,0x1f2dc,0x1f2e2,0x1f2e4,0x1f2e8,0x1f2f6,0x1f30a,0x1f312,0x1f314,0x1f322,0x1f328,0x1f342,0x1f344,0x1f348,0x1f350,0x1f35e,0x1f366,0x1f37a,0x1f39a,0x1f3ae,0x1f3b2,0x1f3b4,0x1f416,0x1f426,0x1f42c,0x1f43a,0x1f446,0x1f44c,0x1f458,0x1f46e,0x1f472,0x1f474,0x1f486,0x1f48c,0x1f498,0x1f4b0,0x1f4be,0x1f4ce,0x1f4dc,0x1f4e2,0x1f4e4,0x1f4e8,0x1f4f6,0x1f506,0x1f50c,0x1f518,0x1f530,0x1f53e,0x1f560,0x1f57c,0x1f58e,0x1f59c,0x1f5b8,0x1f5c2,0x1f5c4,0x1f5c8,0x1f5d0,0x1f5de,0x1f5e6,0x1f5ec,0x1f5fa,0x1f60a,0x1f612,0x1f614,0x1f622,0x1f624,0x1f628,0x1f636,0x1f642,0x1f644,0x1f648,0x1f650,0x1f65e,0x1f666,0x1f67a,0x1f682,0x1f684,0x1f688,0x1f690,0x1f69e,0x1f6a0,0x1f6bc,0x1f6cc,0x1f6f2,0x1f6f4,0x1f71a,0x1f72e,0x1f732,0x1f734,0x1f74e,0x1f75c,0x1f762,0x1f764,0x1f768,0x1f776,0x1f796,0x1f7a6,0x1f7ac,0x1f7ba,0x1f7d2,0x1f7d4,0x1f89a,0x1f8ae,0x1f8b2,0x1f8b4,0x1f8d6,0x1f8ea,0x1f91a,0x1f92e,0x1f932,0x1f934,0x1f94e,0x1f95c,0x1f962,0x1f964,0x1f968,0x1f976,0x1f996,0x1f9a6,0x1f9ac,0x1f9ba,0x1f9ca,0x1f9d2,0x1f9d4,0x1fa1a,0x1fa2e,0x1fa32,0x1fa34,0x1fa4e,0x1fa5c,0x1fa62,0x1fa64,0x1fa68,0x1fa76,0x1fa8e,0x1fa9c,0x1fab8,0x1fac2,0x1fac4,0x1fac8,0x1fad0,0x1fade,0x1fae6,0x1faec,0x1fb16,0x1fb26,0x1fb2c,0x1fb3a,0x1fb46,0x1fb4c,0x1fb58,0x1fb6e,0x1fb72,0x1fb74,0x1fb8a,0x1fb92,0x1fb94,0x1fba2,0x1fba4,0x1fba8,0x1fbb6,0x1fbda]);PDF417Common.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2000,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1000,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class PDF417DetectorResult{constructor(bits,points){this.bits=bits;this.points=points;}
getBits(){return this.bits;}
getPoints(){return this.points;}}
class Detector$3{static detectMultiple(image,hints,multiple){let bitMatrix=image.getBlackMatrix();let barcodeCoordinates=Detector$3.detect(multiple,bitMatrix);if(!barcodeCoordinates.length){bitMatrix=bitMatrix.clone();bitMatrix.rotate180();barcodeCoordinates=Detector$3.detect(multiple,bitMatrix);}
return new PDF417DetectorResult(bitMatrix,barcodeCoordinates);}
static detect(multiple,bitMatrix){const barcodeCoordinates=new Array();let row=0;let column=0;let foundBarcodeInRow=false;while(row<bitMatrix.getHeight()){const vertices=Detector$3.findVertices(bitMatrix,row,column);if(vertices[0]==null&&vertices[3]==null){if(!foundBarcodeInRow){break;}
foundBarcodeInRow=false;column=0;for(const barcodeCoordinate of barcodeCoordinates){if(barcodeCoordinate[1]!=null){row=Math.trunc(Math.max(row,barcodeCoordinate[1].getY()));}
if(barcodeCoordinate[3]!=null){row=Math.max(row,Math.trunc(barcodeCoordinate[3].getY()));}}
row+=Detector$3.ROW_STEP;continue;}
foundBarcodeInRow=true;barcodeCoordinates.push(vertices);if(!multiple){break;}
if(vertices[2]!=null){column=Math.trunc(vertices[2].getX());row=Math.trunc(vertices[2].getY());}
else{column=Math.trunc(vertices[4].getX());row=Math.trunc(vertices[4].getY());}}
return barcodeCoordinates;}
static findVertices(matrix,startRow,startColumn){const height=matrix.getHeight();const width=matrix.getWidth();const result=new Array(8);Detector$3.copyToResult(result,Detector$3.findRowsWithPattern(matrix,height,width,startRow,startColumn,Detector$3.START_PATTERN),Detector$3.INDEXES_START_PATTERN);if(result[4]!=null){startColumn=Math.trunc(result[4].getX());startRow=Math.trunc(result[4].getY());}
Detector$3.copyToResult(result,Detector$3.findRowsWithPattern(matrix,height,width,startRow,startColumn,Detector$3.STOP_PATTERN),Detector$3.INDEXES_STOP_PATTERN);return result;}
static copyToResult(result,tmpResult,destinationIndexes){for(let i=0;i<destinationIndexes.length;i++){result[destinationIndexes[i]]=tmpResult[i];}}
static findRowsWithPattern(matrix,height,width,startRow,startColumn,pattern){const result=new Array(4);let found=false;const counters=new Int32Array(pattern.length);for(;startRow<height;startRow+=Detector$3.ROW_STEP){let loc=Detector$3.findGuardPattern(matrix,startColumn,startRow,width,false,pattern,counters);if(loc!=null){while(startRow>0){const previousRowLoc=Detector$3.findGuardPattern(matrix,startColumn,--startRow,width,false,pattern,counters);if(previousRowLoc!=null){loc=previousRowLoc;}
else{startRow++;break;}}
result[0]=new ResultPoint(loc[0],startRow);result[1]=new ResultPoint(loc[1],startRow);found=true;break;}}
let stopRow=startRow+1;if(found){let skippedRowCount=0;let previousRowLoc=Int32Array.from([Math.trunc(result[0].getX()),Math.trunc(result[1].getX())]);for(;stopRow<height;stopRow++){const loc=Detector$3.findGuardPattern(matrix,previousRowLoc[0],stopRow,width,false,pattern,counters);if(loc!=null&&Math.abs(previousRowLoc[0]-loc[0])<Detector$3.MAX_PATTERN_DRIFT&&Math.abs(previousRowLoc[1]-loc[1])<Detector$3.MAX_PATTERN_DRIFT){previousRowLoc=loc;skippedRowCount=0;}
else{if(skippedRowCount>Detector$3.SKIPPED_ROW_COUNT_MAX){break;}
else{skippedRowCount++;}}}
stopRow-=skippedRowCount+1;result[2]=new ResultPoint(previousRowLoc[0],stopRow);result[3]=new ResultPoint(previousRowLoc[1],stopRow);}
if(stopRow-startRow<Detector$3.BARCODE_MIN_HEIGHT){Arrays.fill(result,null);}
return result;}
static findGuardPattern(matrix,column,row,width,whiteFirst,pattern,counters){Arrays.fillWithin(counters,0,counters.length,0);let patternStart=column;let pixelDrift=0;while(matrix.get(patternStart,row)&&patternStart>0&&pixelDrift++<Detector$3.MAX_PIXEL_DRIFT){patternStart--;}
let x=patternStart;let counterPosition=0;let patternLength=pattern.length;for(let isWhite=whiteFirst;x<width;x++){let pixel=matrix.get(x,row);if(pixel!==isWhite){counters[counterPosition]++;}
else{if(counterPosition===patternLength-1){if(Detector$3.patternMatchVariance(counters,pattern,Detector$3.MAX_INDIVIDUAL_VARIANCE)<Detector$3.MAX_AVG_VARIANCE){return new Int32Array([patternStart,x]);}
patternStart+=counters[0]+counters[1];System.arraycopy(counters,2,counters,0,counterPosition-1);counters[counterPosition-1]=0;counters[counterPosition]=0;counterPosition--;}
else{counterPosition++;}
counters[counterPosition]=1;isWhite=!isWhite;}}
if(counterPosition===patternLength-1&&Detector$3.patternMatchVariance(counters,pattern,Detector$3.MAX_INDIVIDUAL_VARIANCE)<Detector$3.MAX_AVG_VARIANCE){return new Int32Array([patternStart,x-1]);}
return null;}
static patternMatchVariance(counters,pattern,maxIndividualVariance){let numCounters=counters.length;let total=0;let patternLength=0;for(let i=0;i<numCounters;i++){total+=counters[i];patternLength+=pattern[i];}
if(total<patternLength){return Infinity;}
let unitBarWidth=total/patternLength;maxIndividualVariance*=unitBarWidth;let totalVariance=0.0;for(let x=0;x<numCounters;x++){let counter=counters[x];let scaledPattern=pattern[x]*unitBarWidth;let variance=counter>scaledPattern?counter-scaledPattern:scaledPattern-counter;if(variance>maxIndividualVariance){return Infinity;}
totalVariance+=variance;}
return totalVariance/total;}}
Detector$3.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]);Detector$3.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]);Detector$3.MAX_AVG_VARIANCE=0.42;Detector$3.MAX_INDIVIDUAL_VARIANCE=0.8;Detector$3.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]);Detector$3.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]);Detector$3.MAX_PIXEL_DRIFT=3;Detector$3.MAX_PATTERN_DRIFT=5;Detector$3.SKIPPED_ROW_COUNT_MAX=25;Detector$3.ROW_STEP=5;Detector$3.BARCODE_MIN_HEIGHT=10;class ModulusPoly{constructor(field,coefficients){if(coefficients.length===0){throw new IllegalArgumentException();}
this.field=field;let coefficientsLength=coefficients.length;if(coefficientsLength>1&&coefficients[0]===0){let firstNonZero=1;while(firstNonZero<coefficientsLength&&coefficients[firstNonZero]===0){firstNonZero++;}
if(firstNonZero===coefficientsLength){this.coefficients=new Int32Array([0]);}
else{this.coefficients=new Int32Array(coefficientsLength-firstNonZero);System.arraycopy(coefficients,firstNonZero,this.coefficients,0,this.coefficients.length);}}
else{this.coefficients=coefficients;}}
getCoefficients(){return this.coefficients;}
getDegree(){return this.coefficients.length-1;}
isZero(){return this.coefficients[0]===0;}
getCoefficient(degree){return this.coefficients[this.coefficients.length-1-degree];}
evaluateAt(a){if(a===0){return this.getCoefficient(0);}
if(a===1){let sum=0;for(let coefficient of this.coefficients){sum=this.field.add(sum,coefficient);}
return sum;}
let result=this.coefficients[0];let size=this.coefficients.length;for(let i=1;i<size;i++){result=this.field.add(this.field.multiply(a,result),this.coefficients[i]);}
return result;}
add(other){if(!this.field.equals(other.field)){throw new IllegalArgumentException('ModulusPolys do not have same ModulusGF field');}
if(this.isZero()){return other;}
if(other.isZero()){return this;}
let smallerCoefficients=this.coefficients;let largerCoefficients=other.coefficients;if(smallerCoefficients.length>largerCoefficients.length){let temp=smallerCoefficients;smallerCoefficients=largerCoefficients;largerCoefficients=temp;}
let sumDiff=new Int32Array(largerCoefficients.length);let lengthDiff=largerCoefficients.length-smallerCoefficients.length;System.arraycopy(largerCoefficients,0,sumDiff,0,lengthDiff);for(let i=lengthDiff;i<largerCoefficients.length;i++){sumDiff[i]=this.field.add(smallerCoefficients[i-lengthDiff],largerCoefficients[i]);}
return new ModulusPoly(this.field,sumDiff);}
subtract(other){if(!this.field.equals(other.field)){throw new IllegalArgumentException('ModulusPolys do not have same ModulusGF field');}
if(other.isZero()){return this;}
return this.add(other.negative());}
multiply(other){if(other instanceof ModulusPoly){return this.multiplyOther(other);}
return this.multiplyScalar(other);}
multiplyOther(other){if(!this.field.equals(other.field)){throw new IllegalArgumentException('ModulusPolys do not have same ModulusGF field');}
if(this.isZero()||other.isZero()){return new ModulusPoly(this.field,new Int32Array([0]));}
let aCoefficients=this.coefficients;let aLength=aCoefficients.length;let bCoefficients=other.coefficients;let bLength=bCoefficients.length;let product=new Int32Array(aLength+bLength-1);for(let i=0;i<aLength;i++){let aCoeff=aCoefficients[i];for(let j=0;j<bLength;j++){product[i+j]=this.field.add(product[i+j],this.field.multiply(aCoeff,bCoefficients[j]));}}
return new ModulusPoly(this.field,product);}
negative(){let size=this.coefficients.length;let negativeCoefficients=new Int32Array(size);for(let i=0;i<size;i++){negativeCoefficients[i]=this.field.subtract(0,this.coefficients[i]);}
return new ModulusPoly(this.field,negativeCoefficients);}
multiplyScalar(scalar){if(scalar===0){return new ModulusPoly(this.field,new Int32Array([0]));}
if(scalar===1){return this;}
let size=this.coefficients.length;let product=new Int32Array(size);for(let i=0;i<size;i++){product[i]=this.field.multiply(this.coefficients[i],scalar);}
return new ModulusPoly(this.field,product);}
multiplyByMonomial(degree,coefficient){if(degree<0){throw new IllegalArgumentException();}
if(coefficient===0){return new ModulusPoly(this.field,new Int32Array([0]));}
let size=this.coefficients.length;let product=new Int32Array(size+degree);for(let i=0;i<size;i++){product[i]=this.field.multiply(this.coefficients[i],coefficient);}
return new ModulusPoly(this.field,product);}
toString(){let result=new StringBuilder();for(let degree=this.getDegree();degree>=0;degree--){let coefficient=this.getCoefficient(degree);if(coefficient!==0){if(coefficient<0){result.append(' - ');coefficient=-coefficient;}
else{if(result.length()>0){result.append(' + ');}}
if(degree===0||coefficient!==1){result.append(coefficient);}
if(degree!==0){if(degree===1){result.append('x');}
else{result.append('x^');result.append(degree);}}}}
return result.toString();}}
class ModulusBase{add(a,b){return(a+b)%this.modulus;}
subtract(a,b){return(this.modulus+a-b)%this.modulus;}
exp(a){return this.expTable[a];}
log(a){if(a===0){throw new IllegalArgumentException();}
return this.logTable[a];}
inverse(a){if(a===0){throw new ArithmeticException();}
return this.expTable[this.modulus-this.logTable[a]-1];}
multiply(a,b){if(a===0||b===0){return 0;}
return this.expTable[(this.logTable[a]+this.logTable[b])%(this.modulus-1)];}
getSize(){return this.modulus;}
equals(o){return o===this;}}
class ModulusGF extends ModulusBase{constructor(modulus,generator){super();this.modulus=modulus;this.expTable=new Int32Array(modulus);this.logTable=new Int32Array(modulus);let x=1;for(let i=0;i<modulus;i++){this.expTable[i]=x;x=(x*generator)%modulus;}
for(let i=0;i<modulus-1;i++){this.logTable[this.expTable[i]]=i;}
this.zero=new ModulusPoly(this,new Int32Array([0]));this.one=new ModulusPoly(this,new Int32Array([1]));}
getZero(){return this.zero;}
getOne(){return this.one;}
buildMonomial(degree,coefficient){if(degree<0){throw new IllegalArgumentException();}
if(coefficient===0){return this.zero;}
let coefficients=new Int32Array(degree+1);coefficients[0]=coefficient;return new ModulusPoly(this,coefficients);}}
ModulusGF.PDF417_GF=new ModulusGF(PDF417Common.NUMBER_OF_CODEWORDS,3);class ErrorCorrection{constructor(){this.field=ModulusGF.PDF417_GF;}
decode(received,numECCodewords,erasures){let poly=new ModulusPoly(this.field,received);let S=new Int32Array(numECCodewords);let error=false;for(let i=numECCodewords;i>0;i--){let evaluation=poly.evaluateAt(this.field.exp(i));S[numECCodewords-i]=evaluation;if(evaluation!==0){error=true;}}
if(!error){return 0;}
let knownErrors=this.field.getOne();if(erasures!=null){for(const erasure of erasures){let b=this.field.exp(received.length-1-erasure);let term=new ModulusPoly(this.field,new Int32Array([this.field.subtract(0,b),1]));knownErrors=knownErrors.multiply(term);}}
let syndrome=new ModulusPoly(this.field,S);let sigmaOmega=this.runEuclideanAlgorithm(this.field.buildMonomial(numECCodewords,1),syndrome,numECCodewords);let sigma=sigmaOmega[0];let omega=sigmaOmega[1];let errorLocations=this.findErrorLocations(sigma);let errorMagnitudes=this.findErrorMagnitudes(omega,sigma,errorLocations);for(let i=0;i<errorLocations.length;i++){let position=received.length-1-this.field.log(errorLocations[i]);if(position<0){throw ChecksumException.getChecksumInstance();}
received[position]=this.field.subtract(received[position],errorMagnitudes[i]);}
return errorLocations.length;}
runEuclideanAlgorithm(a,b,R){if(a.getDegree()<b.getDegree()){let temp=a;a=b;b=temp;}
let rLast=a;let r=b;let tLast=this.field.getZero();let t=this.field.getOne();while(r.getDegree()>=Math.round(R/2)){let rLastLast=rLast;let tLastLast=tLast;rLast=r;tLast=t;if(rLast.isZero()){throw ChecksumException.getChecksumInstance();}
r=rLastLast;let q=this.field.getZero();let denominatorLeadingTerm=rLast.getCoefficient(rLast.getDegree());let dltInverse=this.field.inverse(denominatorLeadingTerm);while(r.getDegree()>=rLast.getDegree()&&!r.isZero()){let degreeDiff=r.getDegree()-rLast.getDegree();let scale=this.field.multiply(r.getCoefficient(r.getDegree()),dltInverse);q=q.add(this.field.buildMonomial(degreeDiff,scale));r=r.subtract(rLast.multiplyByMonomial(degreeDiff,scale));}
t=q.multiply(tLast).subtract(tLastLast).negative();}
let sigmaTildeAtZero=t.getCoefficient(0);if(sigmaTildeAtZero===0){throw ChecksumException.getChecksumInstance();}
let inverse=this.field.inverse(sigmaTildeAtZero);let sigma=t.multiply(inverse);let omega=r.multiply(inverse);return[sigma,omega];}
findErrorLocations(errorLocator){let numErrors=errorLocator.getDegree();let result=new Int32Array(numErrors);let e=0;for(let i=1;i<this.field.getSize()&&e<numErrors;i++){if(errorLocator.evaluateAt(i)===0){result[e]=this.field.inverse(i);e++;}}
if(e!==numErrors){throw ChecksumException.getChecksumInstance();}
return result;}
findErrorMagnitudes(errorEvaluator,errorLocator,errorLocations){let errorLocatorDegree=errorLocator.getDegree();let formalDerivativeCoefficients=new Int32Array(errorLocatorDegree);for(let i=1;i<=errorLocatorDegree;i++){formalDerivativeCoefficients[errorLocatorDegree-i]=this.field.multiply(i,errorLocator.getCoefficient(i));}
let formalDerivative=new ModulusPoly(this.field,formalDerivativeCoefficients);let s=errorLocations.length;let result=new Int32Array(s);for(let i=0;i<s;i++){let xiInverse=this.field.inverse(errorLocations[i]);let numerator=this.field.subtract(0,errorEvaluator.evaluateAt(xiInverse));let denominator=this.field.inverse(formalDerivative.evaluateAt(xiInverse));result[i]=this.field.multiply(numerator,denominator);}
return result;}}
class BoundingBox{constructor(image,topLeft,bottomLeft,topRight,bottomRight){if(image instanceof BoundingBox){this.constructor_2(image);}
else{this.constructor_1(image,topLeft,bottomLeft,topRight,bottomRight);}}
constructor_1(image,topLeft,bottomLeft,topRight,bottomRight){const leftUnspecified=topLeft==null||bottomLeft==null;const rightUnspecified=topRight==null||bottomRight==null;if(leftUnspecified&&rightUnspecified){throw new NotFoundException();}
if(leftUnspecified){topLeft=new ResultPoint(0,topRight.getY());bottomLeft=new ResultPoint(0,bottomRight.getY());}
else if(rightUnspecified){topRight=new ResultPoint(image.getWidth()-1,topLeft.getY());bottomRight=new ResultPoint(image.getWidth()-1,bottomLeft.getY());}
this.image=image;this.topLeft=topLeft;this.bottomLeft=bottomLeft;this.topRight=topRight;this.bottomRight=bottomRight;this.minX=Math.trunc(Math.min(topLeft.getX(),bottomLeft.getX()));this.maxX=Math.trunc(Math.max(topRight.getX(),bottomRight.getX()));this.minY=Math.trunc(Math.min(topLeft.getY(),topRight.getY()));this.maxY=Math.trunc(Math.max(bottomLeft.getY(),bottomRight.getY()));}
constructor_2(boundingBox){this.image=boundingBox.image;this.topLeft=boundingBox.getTopLeft();this.bottomLeft=boundingBox.getBottomLeft();this.topRight=boundingBox.getTopRight();this.bottomRight=boundingBox.getBottomRight();this.minX=boundingBox.getMinX();this.maxX=boundingBox.getMaxX();this.minY=boundingBox.getMinY();this.maxY=boundingBox.getMaxY();}
static merge(leftBox,rightBox){if(leftBox==null){return rightBox;}
if(rightBox==null){return leftBox;}
return new BoundingBox(leftBox.image,leftBox.topLeft,leftBox.bottomLeft,rightBox.topRight,rightBox.bottomRight);}
addMissingRows(missingStartRows,missingEndRows,isLeft){let newTopLeft=this.topLeft;let newBottomLeft=this.bottomLeft;let newTopRight=this.topRight;let newBottomRight=this.bottomRight;if(missingStartRows>0){let top=isLeft?this.topLeft:this.topRight;let newMinY=Math.trunc(top.getY()-missingStartRows);if(newMinY<0){newMinY=0;}
let newTop=new ResultPoint(top.getX(),newMinY);if(isLeft){newTopLeft=newTop;}
else{newTopRight=newTop;}}
if(missingEndRows>0){let bottom=isLeft?this.bottomLeft:this.bottomRight;let newMaxY=Math.trunc(bottom.getY()+missingEndRows);if(newMaxY>=this.image.getHeight()){newMaxY=this.image.getHeight()-1;}
let newBottom=new ResultPoint(bottom.getX(),newMaxY);if(isLeft){newBottomLeft=newBottom;}
else{newBottomRight=newBottom;}}
return new BoundingBox(this.image,newTopLeft,newBottomLeft,newTopRight,newBottomRight);}
getMinX(){return this.minX;}
getMaxX(){return this.maxX;}
getMinY(){return this.minY;}
getMaxY(){return this.maxY;}
getTopLeft(){return this.topLeft;}
getTopRight(){return this.topRight;}
getBottomLeft(){return this.bottomLeft;}
getBottomRight(){return this.bottomRight;}}
class BarcodeMetadata{constructor(columnCount,rowCountUpperPart,rowCountLowerPart,errorCorrectionLevel){this.columnCount=columnCount;this.errorCorrectionLevel=errorCorrectionLevel;this.rowCountUpperPart=rowCountUpperPart;this.rowCountLowerPart=rowCountLowerPart;this.rowCount=rowCountUpperPart+rowCountLowerPart;}
getColumnCount(){return this.columnCount;}
getErrorCorrectionLevel(){return this.errorCorrectionLevel;}
getRowCount(){return this.rowCount;}
getRowCountUpperPart(){return this.rowCountUpperPart;}
getRowCountLowerPart(){return this.rowCountLowerPart;}}
class Formatter{constructor(){this.buffer='';}
static form(str,arr){let i=-1;function callback(exp,p0,p1,p2,p3,p4){if(exp==='%%')
return'%';if(arr[++i]===undefined)
return undefined;exp=p2?parseInt(p2.substr(1)):undefined;let base=p3?parseInt(p3.substr(1)):undefined;let val;switch(p4){case's':val=arr[i];break;case'c':val=arr[i][0];break;case'f':val=parseFloat(arr[i]).toFixed(exp);break;case'p':val=parseFloat(arr[i]).toPrecision(exp);break;case'e':val=parseFloat(arr[i]).toExponential(exp);break;case'x':val=parseInt(arr[i]).toString(base?base:16);break;case'd':val=parseFloat(parseInt(arr[i],base?base:10).toPrecision(exp)).toFixed(0);break;}
val=typeof val==='object'?JSON.stringify(val):(+val).toString(base);let size=parseInt(p1);let ch=p1&&(p1[0]+'')==='0'?'0':' ';while(val.length<size)
val=p0!==undefined?val+ch:ch+val;return val;}
let regex=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return str.replace(regex,callback);}
format(append,...args){this.buffer+=Formatter.form(append,args);}
toString(){return this.buffer;}}
class DetectionResultColumn{constructor(boundingBox){this.boundingBox=new BoundingBox(boundingBox);this.codewords=new Array(boundingBox.getMaxY()-boundingBox.getMinY()+1);}
getCodewordNearby(imageRow){let codeword=this.getCodeword(imageRow);if(codeword!=null){return codeword;}
for(let i=1;i<DetectionResultColumn.MAX_NEARBY_DISTANCE;i++){let nearImageRow=this.imageRowToCodewordIndex(imageRow)-i;if(nearImageRow>=0){codeword=this.codewords[nearImageRow];if(codeword!=null){return codeword;}}
nearImageRow=this.imageRowToCodewordIndex(imageRow)+i;if(nearImageRow<this.codewords.length){codeword=this.codewords[nearImageRow];if(codeword!=null){return codeword;}}}
return null;}
imageRowToCodewordIndex(imageRow){return imageRow-this.boundingBox.getMinY();}
setCodeword(imageRow,codeword){this.codewords[this.imageRowToCodewordIndex(imageRow)]=codeword;}
getCodeword(imageRow){return this.codewords[this.imageRowToCodewordIndex(imageRow)];}
getBoundingBox(){return this.boundingBox;}
getCodewords(){return this.codewords;}
toString(){const formatter=new Formatter();let row=0;for(const codeword of this.codewords){if(codeword==null){formatter.format('%3d:    |   %n',row++);continue;}
formatter.format('%3d: %3d|%3d%n',row++,codeword.getRowNumber(),codeword.getValue());}
return formatter.toString();}}
DetectionResultColumn.MAX_NEARBY_DISTANCE=5;class BarcodeValue{constructor(){this.values=new Map();}
setValue(value){value=Math.trunc(value);let confidence=this.values.get(value);if(confidence==null){confidence=0;}
confidence++;this.values.set(value,confidence);}
getValue(){let maxConfidence=-1;let result=new Array();for(const[key,value]of this.values.entries()){const entry={getKey:()=>key,getValue:()=>value,};if(entry.getValue()>maxConfidence){maxConfidence=entry.getValue();result=[];result.push(entry.getKey());}
else if(entry.getValue()===maxConfidence){result.push(entry.getKey());}}
return PDF417Common.toIntArray(result);}
getConfidence(value){return this.values.get(value);}}
class DetectionResultRowIndicatorColumn extends DetectionResultColumn{constructor(boundingBox,isLeft){super(boundingBox);this._isLeft=isLeft;}
setRowNumbers(){for(let codeword of this.getCodewords()){if(codeword!=null){codeword.setRowNumberAsRowIndicatorColumn();}}}
adjustCompleteIndicatorColumnRowNumbers(barcodeMetadata){let codewords=this.getCodewords();this.setRowNumbers();this.removeIncorrectCodewords(codewords,barcodeMetadata);let boundingBox=this.getBoundingBox();let top=this._isLeft?boundingBox.getTopLeft():boundingBox.getTopRight();let bottom=this._isLeft?boundingBox.getBottomLeft():boundingBox.getBottomRight();let firstRow=this.imageRowToCodewordIndex(Math.trunc(top.getY()));let lastRow=this.imageRowToCodewordIndex(Math.trunc(bottom.getY()));let barcodeRow=-1;let maxRowHeight=1;let currentRowHeight=0;for(let codewordsRow=firstRow;codewordsRow<lastRow;codewordsRow++){if(codewords[codewordsRow]==null){continue;}
let codeword=codewords[codewordsRow];let rowDifference=codeword.getRowNumber()-barcodeRow;if(rowDifference===0){currentRowHeight++;}
else if(rowDifference===1){maxRowHeight=Math.max(maxRowHeight,currentRowHeight);currentRowHeight=1;barcodeRow=codeword.getRowNumber();}
else if(rowDifference<0||codeword.getRowNumber()>=barcodeMetadata.getRowCount()||rowDifference>codewordsRow){codewords[codewordsRow]=null;}
else{let checkedRows;if(maxRowHeight>2){checkedRows=(maxRowHeight-2)*rowDifference;}
else{checkedRows=rowDifference;}
let closePreviousCodewordFound=checkedRows>=codewordsRow;for(let i=1;i<=checkedRows&&!closePreviousCodewordFound;i++){closePreviousCodewordFound=codewords[codewordsRow-i]!=null;}
if(closePreviousCodewordFound){codewords[codewordsRow]=null;}
else{barcodeRow=codeword.getRowNumber();currentRowHeight=1;}}}}
getRowHeights(){let barcodeMetadata=this.getBarcodeMetadata();if(barcodeMetadata==null){return null;}
this.adjustIncompleteIndicatorColumnRowNumbers(barcodeMetadata);let result=new Int32Array(barcodeMetadata.getRowCount());for(let codeword of this.getCodewords()){if(codeword!=null){let rowNumber=codeword.getRowNumber();if(rowNumber>=result.length){continue;}
result[rowNumber]++;}}
return result;}
adjustIncompleteIndicatorColumnRowNumbers(barcodeMetadata){let boundingBox=this.getBoundingBox();let top=this._isLeft?boundingBox.getTopLeft():boundingBox.getTopRight();let bottom=this._isLeft?boundingBox.getBottomLeft():boundingBox.getBottomRight();let firstRow=this.imageRowToCodewordIndex(Math.trunc(top.getY()));let lastRow=this.imageRowToCodewordIndex(Math.trunc(bottom.getY()));let codewords=this.getCodewords();let barcodeRow=-1;for(let codewordsRow=firstRow;codewordsRow<lastRow;codewordsRow++){if(codewords[codewordsRow]==null){continue;}
let codeword=codewords[codewordsRow];codeword.setRowNumberAsRowIndicatorColumn();let rowDifference=codeword.getRowNumber()-barcodeRow;if(rowDifference===0);else if(rowDifference===1){barcodeRow=codeword.getRowNumber();}
else if(codeword.getRowNumber()>=barcodeMetadata.getRowCount()){codewords[codewordsRow]=null;}
else{barcodeRow=codeword.getRowNumber();}}}
getBarcodeMetadata(){let codewords=this.getCodewords();let barcodeColumnCount=new BarcodeValue();let barcodeRowCountUpperPart=new BarcodeValue();let barcodeRowCountLowerPart=new BarcodeValue();let barcodeECLevel=new BarcodeValue();for(let codeword of codewords){if(codeword==null){continue;}
codeword.setRowNumberAsRowIndicatorColumn();let rowIndicatorValue=codeword.getValue()%30;let codewordRowNumber=codeword.getRowNumber();if(!this._isLeft){codewordRowNumber+=2;}
switch(codewordRowNumber%3){case 0:barcodeRowCountUpperPart.setValue(rowIndicatorValue*3+1);break;case 1:barcodeECLevel.setValue(rowIndicatorValue/3);barcodeRowCountLowerPart.setValue(rowIndicatorValue%3);break;case 2:barcodeColumnCount.setValue(rowIndicatorValue+1);break;}}
if((barcodeColumnCount.getValue().length===0)||(barcodeRowCountUpperPart.getValue().length===0)||(barcodeRowCountLowerPart.getValue().length===0)||(barcodeECLevel.getValue().length===0)||barcodeColumnCount.getValue()[0]<1||barcodeRowCountUpperPart.getValue()[0]+barcodeRowCountLowerPart.getValue()[0]<PDF417Common.MIN_ROWS_IN_BARCODE||barcodeRowCountUpperPart.getValue()[0]+barcodeRowCountLowerPart.getValue()[0]>PDF417Common.MAX_ROWS_IN_BARCODE){return null;}
let barcodeMetadata=new BarcodeMetadata(barcodeColumnCount.getValue()[0],barcodeRowCountUpperPart.getValue()[0],barcodeRowCountLowerPart.getValue()[0],barcodeECLevel.getValue()[0]);this.removeIncorrectCodewords(codewords,barcodeMetadata);return barcodeMetadata;}
removeIncorrectCodewords(codewords,barcodeMetadata){for(let codewordRow=0;codewordRow<codewords.length;codewordRow++){let codeword=codewords[codewordRow];if(codewords[codewordRow]==null){continue;}
let rowIndicatorValue=codeword.getValue()%30;let codewordRowNumber=codeword.getRowNumber();if(codewordRowNumber>barcodeMetadata.getRowCount()){codewords[codewordRow]=null;continue;}
if(!this._isLeft){codewordRowNumber+=2;}
switch(codewordRowNumber%3){case 0:if(rowIndicatorValue*3+1!==barcodeMetadata.getRowCountUpperPart()){codewords[codewordRow]=null;}
break;case 1:if(Math.trunc(rowIndicatorValue/3)!==barcodeMetadata.getErrorCorrectionLevel()||rowIndicatorValue%3!==barcodeMetadata.getRowCountLowerPart()){codewords[codewordRow]=null;}
break;case 2:if(rowIndicatorValue+1!==barcodeMetadata.getColumnCount()){codewords[codewordRow]=null;}
break;}}}
isLeft(){return this._isLeft;}
toString(){return'IsLeft: '+this._isLeft+'\n'+super.toString();}}
class DetectionResult{constructor(barcodeMetadata,boundingBox){this.ADJUST_ROW_NUMBER_SKIP=2;this.barcodeMetadata=barcodeMetadata;this.barcodeColumnCount=barcodeMetadata.getColumnCount();this.boundingBox=boundingBox;this.detectionResultColumns=new Array(this.barcodeColumnCount+2);}
getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]);this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let unadjustedCodewordCount=PDF417Common.MAX_CODEWORDS_IN_BARCODE;let previousUnadjustedCount;do{previousUnadjustedCount=unadjustedCodewordCount;unadjustedCodewordCount=this.adjustRowNumbersAndGetCount();}while(unadjustedCodewordCount>0&&unadjustedCodewordCount<previousUnadjustedCount);return this.detectionResultColumns;}
adjustIndicatorColumnRowNumbers(detectionResultColumn){if(detectionResultColumn!=null){detectionResultColumn.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata);}}
adjustRowNumbersAndGetCount(){let unadjustedCount=this.adjustRowNumbersByRow();if(unadjustedCount===0){return 0;}
for(let barcodeColumn=1;barcodeColumn<this.barcodeColumnCount+1;barcodeColumn++){let codewords=this.detectionResultColumns[barcodeColumn].getCodewords();for(let codewordsRow=0;codewordsRow<codewords.length;codewordsRow++){if(codewords[codewordsRow]==null){continue;}
if(!codewords[codewordsRow].hasValidRowNumber()){this.adjustRowNumbers(barcodeColumn,codewordsRow,codewords);}}}
return unadjustedCount;}
adjustRowNumbersByRow(){this.adjustRowNumbersFromBothRI();let unadjustedCount=this.adjustRowNumbersFromLRI();return unadjustedCount+this.adjustRowNumbersFromRRI();}
adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null){return;}
let LRIcodewords=this.detectionResultColumns[0].getCodewords();let RRIcodewords=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let codewordsRow=0;codewordsRow<LRIcodewords.length;codewordsRow++){if(LRIcodewords[codewordsRow]!=null&&RRIcodewords[codewordsRow]!=null&&LRIcodewords[codewordsRow].getRowNumber()===RRIcodewords[codewordsRow].getRowNumber()){for(let barcodeColumn=1;barcodeColumn<=this.barcodeColumnCount;barcodeColumn++){let codeword=this.detectionResultColumns[barcodeColumn].getCodewords()[codewordsRow];if(codeword==null){continue;}
codeword.setRowNumber(LRIcodewords[codewordsRow].getRowNumber());if(!codeword.hasValidRowNumber()){this.detectionResultColumns[barcodeColumn].getCodewords()[codewordsRow]=null;}}}}}
adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null){return 0;}
let unadjustedCount=0;let codewords=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let codewordsRow=0;codewordsRow<codewords.length;codewordsRow++){if(codewords[codewordsRow]==null){continue;}
let rowIndicatorRowNumber=codewords[codewordsRow].getRowNumber();let invalidRowCounts=0;for(let barcodeColumn=this.barcodeColumnCount+1;barcodeColumn>0&&invalidRowCounts<this.ADJUST_ROW_NUMBER_SKIP;barcodeColumn--){let codeword=this.detectionResultColumns[barcodeColumn].getCodewords()[codewordsRow];if(codeword!=null){invalidRowCounts=DetectionResult.adjustRowNumberIfValid(rowIndicatorRowNumber,invalidRowCounts,codeword);if(!codeword.hasValidRowNumber()){unadjustedCount++;}}}}
return unadjustedCount;}
adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null){return 0;}
let unadjustedCount=0;let codewords=this.detectionResultColumns[0].getCodewords();for(let codewordsRow=0;codewordsRow<codewords.length;codewordsRow++){if(codewords[codewordsRow]==null){continue;}
let rowIndicatorRowNumber=codewords[codewordsRow].getRowNumber();let invalidRowCounts=0;for(let barcodeColumn=1;barcodeColumn<this.barcodeColumnCount+1&&invalidRowCounts<this.ADJUST_ROW_NUMBER_SKIP;barcodeColumn++){let codeword=this.detectionResultColumns[barcodeColumn].getCodewords()[codewordsRow];if(codeword!=null){invalidRowCounts=DetectionResult.adjustRowNumberIfValid(rowIndicatorRowNumber,invalidRowCounts,codeword);if(!codeword.hasValidRowNumber()){unadjustedCount++;}}}}
return unadjustedCount;}
static adjustRowNumberIfValid(rowIndicatorRowNumber,invalidRowCounts,codeword){if(codeword==null){return invalidRowCounts;}
if(!codeword.hasValidRowNumber()){if(codeword.isValidRowNumber(rowIndicatorRowNumber)){codeword.setRowNumber(rowIndicatorRowNumber);invalidRowCounts=0;}
else{++invalidRowCounts;}}
return invalidRowCounts;}
adjustRowNumbers(barcodeColumn,codewordsRow,codewords){if(this.detectionResultColumns[barcodeColumn-1]==null){return;}
let codeword=codewords[codewordsRow];let previousColumnCodewords=this.detectionResultColumns[barcodeColumn-1].getCodewords();let nextColumnCodewords=previousColumnCodewords;if(this.detectionResultColumns[barcodeColumn+1]!=null){nextColumnCodewords=this.detectionResultColumns[barcodeColumn+1].getCodewords();}
let otherCodewords=new Array(14);otherCodewords[2]=previousColumnCodewords[codewordsRow];otherCodewords[3]=nextColumnCodewords[codewordsRow];if(codewordsRow>0){otherCodewords[0]=codewords[codewordsRow-1];otherCodewords[4]=previousColumnCodewords[codewordsRow-1];otherCodewords[5]=nextColumnCodewords[codewordsRow-1];}
if(codewordsRow>1){otherCodewords[8]=codewords[codewordsRow-2];otherCodewords[10]=previousColumnCodewords[codewordsRow-2];otherCodewords[11]=nextColumnCodewords[codewordsRow-2];}
if(codewordsRow<codewords.length-1){otherCodewords[1]=codewords[codewordsRow+1];otherCodewords[6]=previousColumnCodewords[codewordsRow+1];otherCodewords[7]=nextColumnCodewords[codewordsRow+1];}
if(codewordsRow<codewords.length-2){otherCodewords[9]=codewords[codewordsRow+2];otherCodewords[12]=previousColumnCodewords[codewordsRow+2];otherCodewords[13]=nextColumnCodewords[codewordsRow+2];}
for(let otherCodeword of otherCodewords){if(DetectionResult.adjustRowNumber(codeword,otherCodeword)){return;}}}
static adjustRowNumber(codeword,otherCodeword){if(otherCodeword==null){return false;}
if(otherCodeword.hasValidRowNumber()&&otherCodeword.getBucket()===codeword.getBucket()){codeword.setRowNumber(otherCodeword.getRowNumber());return true;}
return false;}
getBarcodeColumnCount(){return this.barcodeColumnCount;}
getBarcodeRowCount(){return this.barcodeMetadata.getRowCount();}
getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel();}
setBoundingBox(boundingBox){this.boundingBox=boundingBox;}
getBoundingBox(){return this.boundingBox;}
setDetectionResultColumn(barcodeColumn,detectionResultColumn){this.detectionResultColumns[barcodeColumn]=detectionResultColumn;}
getDetectionResultColumn(barcodeColumn){return this.detectionResultColumns[barcodeColumn];}
toString(){let rowIndicatorColumn=this.detectionResultColumns[0];if(rowIndicatorColumn==null){rowIndicatorColumn=this.detectionResultColumns[this.barcodeColumnCount+1];}
let formatter=new Formatter();for(let codewordsRow=0;codewordsRow<rowIndicatorColumn.getCodewords().length;codewordsRow++){formatter.format('CW %3d:',codewordsRow);for(let barcodeColumn=0;barcodeColumn<this.barcodeColumnCount+2;barcodeColumn++){if(this.detectionResultColumns[barcodeColumn]==null){formatter.format('    |   ');continue;}
let codeword=this.detectionResultColumns[barcodeColumn].getCodewords()[codewordsRow];if(codeword==null){formatter.format('    |   ');continue;}
formatter.format(' %3d|%3d',codeword.getRowNumber(),codeword.getValue());}
formatter.format('%n');}
return formatter.toString();}}
class Codeword{constructor(startX,endX,bucket,value){this.rowNumber=Codeword.BARCODE_ROW_UNKNOWN;this.startX=Math.trunc(startX);this.endX=Math.trunc(endX);this.bucket=Math.trunc(bucket);this.value=Math.trunc(value);}
hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber);}
isValidRowNumber(rowNumber){return rowNumber!==Codeword.BARCODE_ROW_UNKNOWN&&this.bucket===(rowNumber%3)*3;}
setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc((Math.trunc(this.value/30))*3+Math.trunc(this.bucket/3));}
getWidth(){return this.endX-this.startX;}
getStartX(){return this.startX;}
getEndX(){return this.endX;}
getBucket(){return this.bucket;}
getValue(){return this.value;}
getRowNumber(){return this.rowNumber;}
setRowNumber(rowNumber){this.rowNumber=rowNumber;}
toString(){return this.rowNumber+'|'+this.value;}}
Codeword.BARCODE_ROW_UNKNOWN=-1;class PDF417CodewordDecoder{static initialize(){for(let i=0;i<PDF417Common.SYMBOL_TABLE.length;i++){let currentSymbol=PDF417Common.SYMBOL_TABLE[i];let currentBit=currentSymbol&0x1;for(let j=0;j<PDF417Common.BARS_IN_MODULE;j++){let size=0.0;while((currentSymbol&0x1)===currentBit){size+=1.0;currentSymbol>>=1;}
currentBit=currentSymbol&0x1;if(!PDF417CodewordDecoder.RATIOS_TABLE[i]){PDF417CodewordDecoder.RATIOS_TABLE[i]=new Array(PDF417Common.BARS_IN_MODULE);}
PDF417CodewordDecoder.RATIOS_TABLE[i][PDF417Common.BARS_IN_MODULE-j-1]=Math.fround(size/PDF417Common.MODULES_IN_CODEWORD);}}
this.bSymbolTableReady=true;}
static getDecodedValue(moduleBitCount){let decodedValue=PDF417CodewordDecoder.getDecodedCodewordValue(PDF417CodewordDecoder.sampleBitCounts(moduleBitCount));if(decodedValue!==-1){return decodedValue;}
return PDF417CodewordDecoder.getClosestDecodedValue(moduleBitCount);}
static sampleBitCounts(moduleBitCount){let bitCountSum=MathUtils.sum(moduleBitCount);let result=new Int32Array(PDF417Common.BARS_IN_MODULE);let bitCountIndex=0;let sumPreviousBits=0;for(let i=0;i<PDF417Common.MODULES_IN_CODEWORD;i++){let sampleIndex=bitCountSum/(2*PDF417Common.MODULES_IN_CODEWORD)+
(i*bitCountSum)/PDF417Common.MODULES_IN_CODEWORD;if(sumPreviousBits+moduleBitCount[bitCountIndex]<=sampleIndex){sumPreviousBits+=moduleBitCount[bitCountIndex];bitCountIndex++;}
result[bitCountIndex]++;}
return result;}
static getDecodedCodewordValue(moduleBitCount){let decodedValue=PDF417CodewordDecoder.getBitValue(moduleBitCount);return PDF417Common.getCodeword(decodedValue)===-1?-1:decodedValue;}
static getBitValue(moduleBitCount){let result=0;for(let i=0;i<moduleBitCount.length;i++){for(let bit=0;bit<moduleBitCount[i];bit++){result=(result<<1)|(i%2===0?1:0);}}
return Math.trunc(result);}
static getClosestDecodedValue(moduleBitCount){let bitCountSum=MathUtils.sum(moduleBitCount);let bitCountRatios=new Array(PDF417Common.BARS_IN_MODULE);if(bitCountSum>1){for(let i=0;i<bitCountRatios.length;i++){bitCountRatios[i]=Math.fround(moduleBitCount[i]/bitCountSum);}}
let bestMatchError=Float.MAX_VALUE;let bestMatch=-1;if(!this.bSymbolTableReady){PDF417CodewordDecoder.initialize();}
for(let j=0;j<PDF417CodewordDecoder.RATIOS_TABLE.length;j++){let error=0.0;let ratioTableRow=PDF417CodewordDecoder.RATIOS_TABLE[j];for(let k=0;k<PDF417Common.BARS_IN_MODULE;k++){let diff=Math.fround(ratioTableRow[k]-bitCountRatios[k]);error+=Math.fround(diff*diff);if(error>=bestMatchError){break;}}
if(error<bestMatchError){bestMatchError=error;bestMatch=PDF417Common.SYMBOL_TABLE[j];}}
return bestMatch;}}
PDF417CodewordDecoder.bSymbolTableReady=false;PDF417CodewordDecoder.RATIOS_TABLE=new Array(PDF417Common.SYMBOL_TABLE.length).map(x=>x=new Array(PDF417Common.BARS_IN_MODULE));class PDF417ResultMetadata{constructor(){this.segmentCount=-1;this.fileSize=-1;this.timestamp=-1;this.checksum=-1;}
getSegmentIndex(){return this.segmentIndex;}
setSegmentIndex(segmentIndex){this.segmentIndex=segmentIndex;}
getFileId(){return this.fileId;}
setFileId(fileId){this.fileId=fileId;}
getOptionalData(){return this.optionalData;}
setOptionalData(optionalData){this.optionalData=optionalData;}
isLastSegment(){return this.lastSegment;}
setLastSegment(lastSegment){this.lastSegment=lastSegment;}
getSegmentCount(){return this.segmentCount;}
setSegmentCount(segmentCount){this.segmentCount=segmentCount;}
getSender(){return this.sender||null;}
setSender(sender){this.sender=sender;}
getAddressee(){return this.addressee||null;}
setAddressee(addressee){this.addressee=addressee;}
getFileName(){return this.fileName;}
setFileName(fileName){this.fileName=fileName;}
getFileSize(){return this.fileSize;}
setFileSize(fileSize){this.fileSize=fileSize;}
getChecksum(){return this.checksum;}
setChecksum(checksum){this.checksum=checksum;}
getTimestamp(){return this.timestamp;}
setTimestamp(timestamp){this.timestamp=timestamp;}}
class Long{static parseLong(num,radix=undefined){return parseInt(num,radix);}}
class NullPointerException extends Exception{}
NullPointerException.kind='NullPointerException';class OutputStream{writeBytes(b){this.writeBytesOffset(b,0,b.length);}
writeBytesOffset(b,off,len){if(b==null){throw new NullPointerException();}
else if((off<0)||(off>b.length)||(len<0)||((off+len)>b.length)||((off+len)<0)){throw new IndexOutOfBoundsException();}
else if(len===0){return;}
for(let i=0;i<len;i++){this.write(b[off+i]);}}
flush(){}
close(){}}
class OutOfMemoryError extends Exception{}
class ByteArrayOutputStream extends OutputStream{constructor(size=32){super();this.count=0;if(size<0){throw new IllegalArgumentException('Negative initial size: '
+size);}
this.buf=new Uint8Array(size);}
ensureCapacity(minCapacity){if(minCapacity-this.buf.length>0)
this.grow(minCapacity);}
grow(minCapacity){let oldCapacity=this.buf.length;let newCapacity=oldCapacity<<1;if(newCapacity-minCapacity<0)
newCapacity=minCapacity;if(newCapacity<0){if(minCapacity<0)
throw new OutOfMemoryError();newCapacity=Integer.MAX_VALUE;}
this.buf=Arrays.copyOfUint8Array(this.buf,newCapacity);}
write(b){this.ensureCapacity(this.count+1);this.buf[this.count]=b;this.count+=1;}
writeBytesOffset(b,off,len){if((off<0)||(off>b.length)||(len<0)||((off+len)-b.length>0)){throw new IndexOutOfBoundsException();}
this.ensureCapacity(this.count+len);System.arraycopy(b,off,this.buf,this.count,len);this.count+=len;}
writeTo(out){out.writeBytesOffset(this.buf,0,this.count);}
reset(){this.count=0;}
toByteArray(){return Arrays.copyOfUint8Array(this.buf,this.count);}
size(){return this.count;}
toString(param){if(!param){return this.toString_void();}
if(typeof param==='string'){return this.toString_string(param);}
return this.toString_number(param);}
toString_void(){return new String(this.buf).toString();}
toString_string(charsetName){return new String(this.buf).toString();}
toString_number(hibyte){return new String(this.buf).toString();}
close(){}}
var Mode$2;(function(Mode){Mode[Mode["ALPHA"]=0]="ALPHA";Mode[Mode["LOWER"]=1]="LOWER";Mode[Mode["MIXED"]=2]="MIXED";Mode[Mode["PUNCT"]=3]="PUNCT";Mode[Mode["ALPHA_SHIFT"]=4]="ALPHA_SHIFT";Mode[Mode["PUNCT_SHIFT"]=5]="PUNCT_SHIFT";})(Mode$2||(Mode$2={}));function getBigIntConstructor(){if(typeof window!=='undefined'){return window['BigInt']||null;}
if(typeof global!=='undefined'){return global['BigInt']||null;}
if(typeof self!=='undefined'){return self['BigInt']||null;}
throw new Error('Can\'t search globals for BigInt!');}
let BigInteger;function createBigInt(num){if(typeof BigInteger==='undefined'){BigInteger=getBigIntConstructor();}
if(BigInteger===null){throw new Error('BigInt is not supported!');}
return BigInteger(num);}
function getEXP900(){let EXP900=[];EXP900[0]=createBigInt(1);let nineHundred=createBigInt(900);EXP900[1]=nineHundred;for(let i=2;i<16;i++){EXP900[i]=EXP900[i-1]*nineHundred;}
return EXP900;}
class DecodedBitStreamParser$2{static decode(codewords,ecLevel){let result=new StringBuilder('');let encoding=CharacterSetECI.ISO8859_1;result.enableDecoding(encoding);let codeIndex=1;let code=codewords[codeIndex++];let resultMetadata=new PDF417ResultMetadata();while(codeIndex<codewords[0]){switch(code){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:codeIndex=DecodedBitStreamParser$2.textCompaction(codewords,codeIndex,result);break;case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:codeIndex=DecodedBitStreamParser$2.byteCompaction(code,codewords,encoding,codeIndex,result);break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(codewords[codeIndex++]);break;case DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH:codeIndex=DecodedBitStreamParser$2.numericCompaction(codewords,codeIndex,result);break;case DecodedBitStreamParser$2.ECI_CHARSET:let charsetECI=CharacterSetECI.getCharacterSetECIByValue(codewords[codeIndex++]);break;case DecodedBitStreamParser$2.ECI_GENERAL_PURPOSE:codeIndex+=2;break;case DecodedBitStreamParser$2.ECI_USER_DEFINED:codeIndex++;break;case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:codeIndex=DecodedBitStreamParser$2.decodeMacroBlock(codewords,codeIndex,resultMetadata);break;case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:throw new FormatException();default:codeIndex--;codeIndex=DecodedBitStreamParser$2.textCompaction(codewords,codeIndex,result);break;}
if(codeIndex<codewords.length){code=codewords[codeIndex++];}
else{throw FormatException.getFormatInstance();}}
if(result.length()===0){throw FormatException.getFormatInstance();}
let decoderResult=new DecoderResult(null,result.toString(),null,ecLevel);decoderResult.setOther(resultMetadata);return decoderResult;}
static decodeMacroBlock(codewords,codeIndex,resultMetadata){if(codeIndex+DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS>codewords[0]){throw FormatException.getFormatInstance();}
let segmentIndexArray=new Int32Array(DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS);for(let i=0;i<DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS;i++,codeIndex++){segmentIndexArray[i]=codewords[codeIndex];}
resultMetadata.setSegmentIndex(Integer.parseInt(DecodedBitStreamParser$2.decodeBase900toBase10(segmentIndexArray,DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS)));let fileId=new StringBuilder();codeIndex=DecodedBitStreamParser$2.textCompaction(codewords,codeIndex,fileId);resultMetadata.setFileId(fileId.toString());let optionalFieldsStart=-1;if(codewords[codeIndex]===DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD){optionalFieldsStart=codeIndex+1;}
while(codeIndex<codewords[0]){switch(codewords[codeIndex]){case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:codeIndex++;switch(codewords[codeIndex]){case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let fileName=new StringBuilder();codeIndex=DecodedBitStreamParser$2.textCompaction(codewords,codeIndex+1,fileName);resultMetadata.setFileName(fileName.toString());break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let sender=new StringBuilder();codeIndex=DecodedBitStreamParser$2.textCompaction(codewords,codeIndex+1,sender);resultMetadata.setSender(sender.toString());break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let addressee=new StringBuilder();codeIndex=DecodedBitStreamParser$2.textCompaction(codewords,codeIndex+1,addressee);resultMetadata.setAddressee(addressee.toString());break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let segmentCount=new StringBuilder();codeIndex=DecodedBitStreamParser$2.numericCompaction(codewords,codeIndex+1,segmentCount);resultMetadata.setSegmentCount(Integer.parseInt(segmentCount.toString()));break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let timestamp=new StringBuilder();codeIndex=DecodedBitStreamParser$2.numericCompaction(codewords,codeIndex+1,timestamp);resultMetadata.setTimestamp(Long.parseLong(timestamp.toString()));break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let checksum=new StringBuilder();codeIndex=DecodedBitStreamParser$2.numericCompaction(codewords,codeIndex+1,checksum);resultMetadata.setChecksum(Integer.parseInt(checksum.toString()));break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let fileSize=new StringBuilder();codeIndex=DecodedBitStreamParser$2.numericCompaction(codewords,codeIndex+1,fileSize);resultMetadata.setFileSize(Long.parseLong(fileSize.toString()));break;default:throw FormatException.getFormatInstance();}
break;case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:codeIndex++;resultMetadata.setLastSegment(true);break;default:throw FormatException.getFormatInstance();}}
if(optionalFieldsStart!==-1){let optionalFieldsLength=codeIndex-optionalFieldsStart;if(resultMetadata.isLastSegment()){optionalFieldsLength--;}
resultMetadata.setOptionalData(Arrays.copyOfRange(codewords,optionalFieldsStart,optionalFieldsStart+optionalFieldsLength));}
return codeIndex;}
static textCompaction(codewords,codeIndex,result){let textCompactionData=new Int32Array((codewords[0]-codeIndex)*2);let byteCompactionData=new Int32Array((codewords[0]-codeIndex)*2);let index=0;let end=false;while((codeIndex<codewords[0])&&!end){let code=codewords[codeIndex++];if(code<DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH){textCompactionData[index]=code/30;textCompactionData[index+1]=code%30;index+=2;}
else{switch(code){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:textCompactionData[index++]=DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH;break;case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:codeIndex--;end=true;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:textCompactionData[index]=DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE;code=codewords[codeIndex++];byteCompactionData[index]=code;index++;break;}}}
DecodedBitStreamParser$2.decodeTextCompaction(textCompactionData,byteCompactionData,index,result);return codeIndex;}
static decodeTextCompaction(textCompactionData,byteCompactionData,length,result){let subMode=Mode$2.ALPHA;let priorToShiftMode=Mode$2.ALPHA;let i=0;while(i<length){let subModeCh=textCompactionData[i];let ch='';switch(subMode){case Mode$2.ALPHA:if(subModeCh<26){ch=String.fromCharCode(65+subModeCh);}
else{switch(subModeCh){case 26:ch=' ';break;case DecodedBitStreamParser$2.LL:subMode=Mode$2.LOWER;break;case DecodedBitStreamParser$2.ML:subMode=Mode$2.MIXED;break;case DecodedBitStreamParser$2.PS:priorToShiftMode=subMode;subMode=Mode$2.PUNCT_SHIFT;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$2.ALPHA;break;}}
break;case Mode$2.LOWER:if(subModeCh<26){ch=String.fromCharCode(97+subModeCh);}
else{switch(subModeCh){case 26:ch=' ';break;case DecodedBitStreamParser$2.AS:priorToShiftMode=subMode;subMode=Mode$2.ALPHA_SHIFT;break;case DecodedBitStreamParser$2.ML:subMode=Mode$2.MIXED;break;case DecodedBitStreamParser$2.PS:priorToShiftMode=subMode;subMode=Mode$2.PUNCT_SHIFT;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$2.ALPHA;break;}}
break;case Mode$2.MIXED:if(subModeCh<DecodedBitStreamParser$2.PL){ch=DecodedBitStreamParser$2.MIXED_CHARS[subModeCh];}
else{switch(subModeCh){case DecodedBitStreamParser$2.PL:subMode=Mode$2.PUNCT;break;case 26:ch=' ';break;case DecodedBitStreamParser$2.LL:subMode=Mode$2.LOWER;break;case DecodedBitStreamParser$2.AL:subMode=Mode$2.ALPHA;break;case DecodedBitStreamParser$2.PS:priorToShiftMode=subMode;subMode=Mode$2.PUNCT_SHIFT;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$2.ALPHA;break;}}
break;case Mode$2.PUNCT:if(subModeCh<DecodedBitStreamParser$2.PAL){ch=DecodedBitStreamParser$2.PUNCT_CHARS[subModeCh];}
else{switch(subModeCh){case DecodedBitStreamParser$2.PAL:subMode=Mode$2.ALPHA;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$2.ALPHA;break;}}
break;case Mode$2.ALPHA_SHIFT:subMode=priorToShiftMode;if(subModeCh<26){ch=String.fromCharCode(65+subModeCh);}
else{switch(subModeCh){case 26:ch=' ';break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$2.ALPHA;break;}}
break;case Mode$2.PUNCT_SHIFT:subMode=priorToShiftMode;if(subModeCh<DecodedBitStreamParser$2.PAL){ch=DecodedBitStreamParser$2.PUNCT_CHARS[subModeCh];}
else{switch(subModeCh){case DecodedBitStreamParser$2.PAL:subMode=Mode$2.ALPHA;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$2.ALPHA;break;}}
break;}
if(ch!==''){result.append(ch);}
i++;}}
static byteCompaction(mode,codewords,encoding,codeIndex,result){let decodedBytes=new ByteArrayOutputStream();let count=0;let value=0;let end=false;switch(mode){case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:let byteCompactedCodewords=new Int32Array(6);let nextCode=codewords[codeIndex++];while((codeIndex<codewords[0])&&!end){byteCompactedCodewords[count++]=nextCode;value=900*value+nextCode;nextCode=codewords[codeIndex++];switch(nextCode){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:codeIndex--;end=true;break;default:if((count%5===0)&&(count>0)){for(let j=0;j<6;++j){decodedBytes.write(Number(createBigInt(value)>>createBigInt(8*(5-j))));}
value=0;count=0;}
break;}}
if(codeIndex===codewords[0]&&nextCode<DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH){byteCompactedCodewords[count++]=nextCode;}
for(let i=0;i<count;i++){decodedBytes.write(byteCompactedCodewords[i]);}
break;case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:while(codeIndex<codewords[0]&&!end){let code=codewords[codeIndex++];if(code<DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH){count++;value=900*value+code;}
else{switch(code){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:codeIndex--;end=true;break;}}
if((count%5===0)&&(count>0)){for(let j=0;j<6;++j){decodedBytes.write(Number(createBigInt(value)>>createBigInt(8*(5-j))));}
value=0;count=0;}}
break;}
result.append(StringEncoding.decode(decodedBytes.toByteArray(),encoding));return codeIndex;}
static numericCompaction(codewords,codeIndex,result){let count=0;let end=false;let numericCodewords=new Int32Array(DecodedBitStreamParser$2.MAX_NUMERIC_CODEWORDS);while(codeIndex<codewords[0]&&!end){let code=codewords[codeIndex++];if(codeIndex===codewords[0]){end=true;}
if(code<DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH){numericCodewords[count]=code;count++;}
else{switch(code){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:codeIndex--;end=true;break;}}
if((count%DecodedBitStreamParser$2.MAX_NUMERIC_CODEWORDS===0||code===DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH||end)&&count>0){result.append(DecodedBitStreamParser$2.decodeBase900toBase10(numericCodewords,count));count=0;}}
return codeIndex;}
static decodeBase900toBase10(codewords,count){let result=createBigInt(0);for(let i=0;i<count;i++){result+=DecodedBitStreamParser$2.EXP900[count-i-1]*createBigInt(codewords[i]);}
let resultString=result.toString();if(resultString.charAt(0)!=='1'){throw new FormatException();}
return resultString.substring(1);}}
DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH=900;DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH=901;DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH=902;DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6=924;DecodedBitStreamParser$2.ECI_USER_DEFINED=925;DecodedBitStreamParser$2.ECI_GENERAL_PURPOSE=926;DecodedBitStreamParser$2.ECI_CHARSET=927;DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928;DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923;DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR=922;DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913;DecodedBitStreamParser$2.MAX_NUMERIC_CODEWORDS=15;DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0;DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1;DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2;DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3;DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4;DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5;DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6;DecodedBitStreamParser$2.PL=25;DecodedBitStreamParser$2.LL=27;DecodedBitStreamParser$2.AS=27;DecodedBitStreamParser$2.ML=28;DecodedBitStreamParser$2.AL=28;DecodedBitStreamParser$2.PS=29;DecodedBitStreamParser$2.PAL=29;DecodedBitStreamParser$2.PUNCT_CHARS=';<>@[\\]_`~!\r\t,:\n-.$/"|*()?{}\'';DecodedBitStreamParser$2.MIXED_CHARS='0123456789&\r\t,:#-.$/+%*=^';DecodedBitStreamParser$2.EXP900=getBigIntConstructor()?getEXP900():[];DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS=2;class PDF417ScanningDecoder{constructor(){}
static decode(image,imageTopLeft,imageBottomLeft,imageTopRight,imageBottomRight,minCodewordWidth,maxCodewordWidth){let boundingBox=new BoundingBox(image,imageTopLeft,imageBottomLeft,imageTopRight,imageBottomRight);let leftRowIndicatorColumn=null;let rightRowIndicatorColumn=null;let detectionResult;for(let firstPass=true;;firstPass=false){if(imageTopLeft!=null){leftRowIndicatorColumn=PDF417ScanningDecoder.getRowIndicatorColumn(image,boundingBox,imageTopLeft,true,minCodewordWidth,maxCodewordWidth);}
if(imageTopRight!=null){rightRowIndicatorColumn=PDF417ScanningDecoder.getRowIndicatorColumn(image,boundingBox,imageTopRight,false,minCodewordWidth,maxCodewordWidth);}
detectionResult=PDF417ScanningDecoder.merge(leftRowIndicatorColumn,rightRowIndicatorColumn);if(detectionResult==null){throw NotFoundException.getNotFoundInstance();}
let resultBox=detectionResult.getBoundingBox();if(firstPass&&resultBox!=null&&(resultBox.getMinY()<boundingBox.getMinY()||resultBox.getMaxY()>boundingBox.getMaxY())){boundingBox=resultBox;}
else{break;}}
detectionResult.setBoundingBox(boundingBox);let maxBarcodeColumn=detectionResult.getBarcodeColumnCount()+1;detectionResult.setDetectionResultColumn(0,leftRowIndicatorColumn);detectionResult.setDetectionResultColumn(maxBarcodeColumn,rightRowIndicatorColumn);let leftToRight=leftRowIndicatorColumn!=null;for(let barcodeColumnCount=1;barcodeColumnCount<=maxBarcodeColumn;barcodeColumnCount++){let barcodeColumn=leftToRight?barcodeColumnCount:maxBarcodeColumn-barcodeColumnCount;if(detectionResult.getDetectionResultColumn(barcodeColumn)!==undefined){continue;}
let detectionResultColumn;if(barcodeColumn===0||barcodeColumn===maxBarcodeColumn){detectionResultColumn=new DetectionResultRowIndicatorColumn(boundingBox,barcodeColumn===0);}
else{detectionResultColumn=new DetectionResultColumn(boundingBox);}
detectionResult.setDetectionResultColumn(barcodeColumn,detectionResultColumn);let startColumn=-1;let previousStartColumn=startColumn;for(let imageRow=boundingBox.getMinY();imageRow<=boundingBox.getMaxY();imageRow++){startColumn=PDF417ScanningDecoder.getStartColumn(detectionResult,barcodeColumn,imageRow,leftToRight);if(startColumn<0||startColumn>boundingBox.getMaxX()){if(previousStartColumn===-1){continue;}
startColumn=previousStartColumn;}
let codeword=PDF417ScanningDecoder.detectCodeword(image,boundingBox.getMinX(),boundingBox.getMaxX(),leftToRight,startColumn,imageRow,minCodewordWidth,maxCodewordWidth);if(codeword!=null){detectionResultColumn.setCodeword(imageRow,codeword);previousStartColumn=startColumn;minCodewordWidth=Math.min(minCodewordWidth,codeword.getWidth());maxCodewordWidth=Math.max(maxCodewordWidth,codeword.getWidth());}}}
return PDF417ScanningDecoder.createDecoderResult(detectionResult);}
static merge(leftRowIndicatorColumn,rightRowIndicatorColumn){if(leftRowIndicatorColumn==null&&rightRowIndicatorColumn==null){return null;}
let barcodeMetadata=PDF417ScanningDecoder.getBarcodeMetadata(leftRowIndicatorColumn,rightRowIndicatorColumn);if(barcodeMetadata==null){return null;}
let boundingBox=BoundingBox.merge(PDF417ScanningDecoder.adjustBoundingBox(leftRowIndicatorColumn),PDF417ScanningDecoder.adjustBoundingBox(rightRowIndicatorColumn));return new DetectionResult(barcodeMetadata,boundingBox);}
static adjustBoundingBox(rowIndicatorColumn){if(rowIndicatorColumn==null){return null;}
let rowHeights=rowIndicatorColumn.getRowHeights();if(rowHeights==null){return null;}
let maxRowHeight=PDF417ScanningDecoder.getMax(rowHeights);let missingStartRows=0;for(let rowHeight of rowHeights){missingStartRows+=maxRowHeight-rowHeight;if(rowHeight>0){break;}}
let codewords=rowIndicatorColumn.getCodewords();for(let row=0;missingStartRows>0&&codewords[row]==null;row++){missingStartRows--;}
let missingEndRows=0;for(let row=rowHeights.length-1;row>=0;row--){missingEndRows+=maxRowHeight-rowHeights[row];if(rowHeights[row]>0){break;}}
for(let row=codewords.length-1;missingEndRows>0&&codewords[row]==null;row--){missingEndRows--;}
return rowIndicatorColumn.getBoundingBox().addMissingRows(missingStartRows,missingEndRows,rowIndicatorColumn.isLeft());}
static getMax(values){let maxValue=-1;for(let value of values){maxValue=Math.max(maxValue,value);}
return maxValue;}
static getBarcodeMetadata(leftRowIndicatorColumn,rightRowIndicatorColumn){let leftBarcodeMetadata;if(leftRowIndicatorColumn==null||(leftBarcodeMetadata=leftRowIndicatorColumn.getBarcodeMetadata())==null){return rightRowIndicatorColumn==null?null:rightRowIndicatorColumn.getBarcodeMetadata();}
let rightBarcodeMetadata;if(rightRowIndicatorColumn==null||(rightBarcodeMetadata=rightRowIndicatorColumn.getBarcodeMetadata())==null){return leftBarcodeMetadata;}
if(leftBarcodeMetadata.getColumnCount()!==rightBarcodeMetadata.getColumnCount()&&leftBarcodeMetadata.getErrorCorrectionLevel()!==rightBarcodeMetadata.getErrorCorrectionLevel()&&leftBarcodeMetadata.getRowCount()!==rightBarcodeMetadata.getRowCount()){return null;}
return leftBarcodeMetadata;}
static getRowIndicatorColumn(image,boundingBox,startPoint,leftToRight,minCodewordWidth,maxCodewordWidth){let rowIndicatorColumn=new DetectionResultRowIndicatorColumn(boundingBox,leftToRight);for(let i=0;i<2;i++){let increment=i===0?1:-1;let startColumn=Math.trunc(Math.trunc(startPoint.getX()));for(let imageRow=Math.trunc(Math.trunc(startPoint.getY()));imageRow<=boundingBox.getMaxY()&&imageRow>=boundingBox.getMinY();imageRow+=increment){let codeword=PDF417ScanningDecoder.detectCodeword(image,0,image.getWidth(),leftToRight,startColumn,imageRow,minCodewordWidth,maxCodewordWidth);if(codeword!=null){rowIndicatorColumn.setCodeword(imageRow,codeword);if(leftToRight){startColumn=codeword.getStartX();}
else{startColumn=codeword.getEndX();}}}}
return rowIndicatorColumn;}
static adjustCodewordCount(detectionResult,barcodeMatrix){let barcodeMatrix01=barcodeMatrix[0][1];let numberOfCodewords=barcodeMatrix01.getValue();let calculatedNumberOfCodewords=detectionResult.getBarcodeColumnCount()*detectionResult.getBarcodeRowCount()-
PDF417ScanningDecoder.getNumberOfECCodeWords(detectionResult.getBarcodeECLevel());if(numberOfCodewords.length===0){if(calculatedNumberOfCodewords<1||calculatedNumberOfCodewords>PDF417Common.MAX_CODEWORDS_IN_BARCODE){throw NotFoundException.getNotFoundInstance();}
barcodeMatrix01.setValue(calculatedNumberOfCodewords);}
else if(numberOfCodewords[0]!==calculatedNumberOfCodewords){barcodeMatrix01.setValue(calculatedNumberOfCodewords);}}
static createDecoderResult(detectionResult){let barcodeMatrix=PDF417ScanningDecoder.createBarcodeMatrix(detectionResult);PDF417ScanningDecoder.adjustCodewordCount(detectionResult,barcodeMatrix);let erasures=new Array();let codewords=new Int32Array(detectionResult.getBarcodeRowCount()*detectionResult.getBarcodeColumnCount());let ambiguousIndexValuesList=[];let ambiguousIndexesList=new Array();for(let row=0;row<detectionResult.getBarcodeRowCount();row++){for(let column=0;column<detectionResult.getBarcodeColumnCount();column++){let values=barcodeMatrix[row][column+1].getValue();let codewordIndex=row*detectionResult.getBarcodeColumnCount()+column;if(values.length===0){erasures.push(codewordIndex);}
else if(values.length===1){codewords[codewordIndex]=values[0];}
else{ambiguousIndexesList.push(codewordIndex);ambiguousIndexValuesList.push(values);}}}
let ambiguousIndexValues=new Array(ambiguousIndexValuesList.length);for(let i=0;i<ambiguousIndexValues.length;i++){ambiguousIndexValues[i]=ambiguousIndexValuesList[i];}
return PDF417ScanningDecoder.createDecoderResultFromAmbiguousValues(detectionResult.getBarcodeECLevel(),codewords,PDF417Common.toIntArray(erasures),PDF417Common.toIntArray(ambiguousIndexesList),ambiguousIndexValues);}
static createDecoderResultFromAmbiguousValues(ecLevel,codewords,erasureArray,ambiguousIndexes,ambiguousIndexValues){let ambiguousIndexCount=new Int32Array(ambiguousIndexes.length);let tries=100;while(tries-->0){for(let i=0;i<ambiguousIndexCount.length;i++){codewords[ambiguousIndexes[i]]=ambiguousIndexValues[i][ambiguousIndexCount[i]];}
try{return PDF417ScanningDecoder.decodeCodewords(codewords,ecLevel,erasureArray);}
catch(err){let ignored=err instanceof ChecksumException;if(!ignored){throw err;}}
if(ambiguousIndexCount.length===0){throw ChecksumException.getChecksumInstance();}
for(let i=0;i<ambiguousIndexCount.length;i++){if(ambiguousIndexCount[i]<ambiguousIndexValues[i].length-1){ambiguousIndexCount[i]++;break;}
else{ambiguousIndexCount[i]=0;if(i===ambiguousIndexCount.length-1){throw ChecksumException.getChecksumInstance();}}}}
throw ChecksumException.getChecksumInstance();}
static createBarcodeMatrix(detectionResult){let barcodeMatrix=Array.from({length:detectionResult.getBarcodeRowCount()},()=>new Array(detectionResult.getBarcodeColumnCount()+2));for(let row=0;row<barcodeMatrix.length;row++){for(let column=0;column<barcodeMatrix[row].length;column++){barcodeMatrix[row][column]=new BarcodeValue();}}
let column=0;for(let detectionResultColumn of detectionResult.getDetectionResultColumns()){if(detectionResultColumn!=null){for(let codeword of detectionResultColumn.getCodewords()){if(codeword!=null){let rowNumber=codeword.getRowNumber();if(rowNumber>=0){if(rowNumber>=barcodeMatrix.length){continue;}
barcodeMatrix[rowNumber][column].setValue(codeword.getValue());}}}}
column++;}
return barcodeMatrix;}
static isValidBarcodeColumn(detectionResult,barcodeColumn){return barcodeColumn>=0&&barcodeColumn<=detectionResult.getBarcodeColumnCount()+1;}
static getStartColumn(detectionResult,barcodeColumn,imageRow,leftToRight){let offset=leftToRight?1:-1;let codeword=null;if(PDF417ScanningDecoder.isValidBarcodeColumn(detectionResult,barcodeColumn-offset)){codeword=detectionResult.getDetectionResultColumn(barcodeColumn-offset).getCodeword(imageRow);}
if(codeword!=null){return leftToRight?codeword.getEndX():codeword.getStartX();}
codeword=detectionResult.getDetectionResultColumn(barcodeColumn).getCodewordNearby(imageRow);if(codeword!=null){return leftToRight?codeword.getStartX():codeword.getEndX();}
if(PDF417ScanningDecoder.isValidBarcodeColumn(detectionResult,barcodeColumn-offset)){codeword=detectionResult.getDetectionResultColumn(barcodeColumn-offset).getCodewordNearby(imageRow);}
if(codeword!=null){return leftToRight?codeword.getEndX():codeword.getStartX();}
let skippedColumns=0;while(PDF417ScanningDecoder.isValidBarcodeColumn(detectionResult,barcodeColumn-offset)){barcodeColumn-=offset;for(let previousRowCodeword of detectionResult.getDetectionResultColumn(barcodeColumn).getCodewords()){if(previousRowCodeword!=null){return(leftToRight?previousRowCodeword.getEndX():previousRowCodeword.getStartX())+
offset*skippedColumns*(previousRowCodeword.getEndX()-previousRowCodeword.getStartX());}}
skippedColumns++;}
return leftToRight?detectionResult.getBoundingBox().getMinX():detectionResult.getBoundingBox().getMaxX();}
static detectCodeword(image,minColumn,maxColumn,leftToRight,startColumn,imageRow,minCodewordWidth,maxCodewordWidth){startColumn=PDF417ScanningDecoder.adjustCodewordStartColumn(image,minColumn,maxColumn,leftToRight,startColumn,imageRow);let moduleBitCount=PDF417ScanningDecoder.getModuleBitCount(image,minColumn,maxColumn,leftToRight,startColumn,imageRow);if(moduleBitCount==null){return null;}
let endColumn;let codewordBitCount=MathUtils.sum(moduleBitCount);if(leftToRight){endColumn=startColumn+codewordBitCount;}
else{for(let i=0;i<moduleBitCount.length/2;i++){let tmpCount=moduleBitCount[i];moduleBitCount[i]=moduleBitCount[moduleBitCount.length-1-i];moduleBitCount[moduleBitCount.length-1-i]=tmpCount;}
endColumn=startColumn;startColumn=endColumn-codewordBitCount;}
if(!PDF417ScanningDecoder.checkCodewordSkew(codewordBitCount,minCodewordWidth,maxCodewordWidth)){return null;}
let decodedValue=PDF417CodewordDecoder.getDecodedValue(moduleBitCount);let codeword=PDF417Common.getCodeword(decodedValue);if(codeword===-1){return null;}
return new Codeword(startColumn,endColumn,PDF417ScanningDecoder.getCodewordBucketNumber(decodedValue),codeword);}
static getModuleBitCount(image,minColumn,maxColumn,leftToRight,startColumn,imageRow){let imageColumn=startColumn;let moduleBitCount=new Int32Array(8);let moduleNumber=0;let increment=leftToRight?1:-1;let previousPixelValue=leftToRight;while((leftToRight?imageColumn<maxColumn:imageColumn>=minColumn)&&moduleNumber<moduleBitCount.length){if(image.get(imageColumn,imageRow)===previousPixelValue){moduleBitCount[moduleNumber]++;imageColumn+=increment;}
else{moduleNumber++;previousPixelValue=!previousPixelValue;}}
if(moduleNumber===moduleBitCount.length||((imageColumn===(leftToRight?maxColumn:minColumn))&&moduleNumber===moduleBitCount.length-1)){return moduleBitCount;}
return null;}
static getNumberOfECCodeWords(barcodeECLevel){return 2<<barcodeECLevel;}
static adjustCodewordStartColumn(image,minColumn,maxColumn,leftToRight,codewordStartColumn,imageRow){let correctedStartColumn=codewordStartColumn;let increment=leftToRight?-1:1;for(let i=0;i<2;i++){while((leftToRight?correctedStartColumn>=minColumn:correctedStartColumn<maxColumn)&&leftToRight===image.get(correctedStartColumn,imageRow)){if(Math.abs(codewordStartColumn-correctedStartColumn)>PDF417ScanningDecoder.CODEWORD_SKEW_SIZE){return codewordStartColumn;}
correctedStartColumn+=increment;}
increment=-increment;leftToRight=!leftToRight;}
return correctedStartColumn;}
static checkCodewordSkew(codewordSize,minCodewordWidth,maxCodewordWidth){return minCodewordWidth-PDF417ScanningDecoder.CODEWORD_SKEW_SIZE<=codewordSize&&codewordSize<=maxCodewordWidth+PDF417ScanningDecoder.CODEWORD_SKEW_SIZE;}
static decodeCodewords(codewords,ecLevel,erasures){if(codewords.length===0){throw FormatException.getFormatInstance();}
let numECCodewords=1<<(ecLevel+1);let correctedErrorsCount=PDF417ScanningDecoder.correctErrors(codewords,erasures,numECCodewords);PDF417ScanningDecoder.verifyCodewordCount(codewords,numECCodewords);let decoderResult=DecodedBitStreamParser$2.decode(codewords,''+ecLevel);decoderResult.setErrorsCorrected(correctedErrorsCount);decoderResult.setErasures(erasures.length);return decoderResult;}
static correctErrors(codewords,erasures,numECCodewords){if(erasures!=null&&erasures.length>numECCodewords/2+PDF417ScanningDecoder.MAX_ERRORS||numECCodewords<0||numECCodewords>PDF417ScanningDecoder.MAX_EC_CODEWORDS){throw ChecksumException.getChecksumInstance();}
return PDF417ScanningDecoder.errorCorrection.decode(codewords,numECCodewords,erasures);}
static verifyCodewordCount(codewords,numECCodewords){if(codewords.length<4){throw FormatException.getFormatInstance();}
let numberOfCodewords=codewords[0];if(numberOfCodewords>codewords.length){throw FormatException.getFormatInstance();}
if(numberOfCodewords===0){if(numECCodewords<codewords.length){codewords[0]=codewords.length-numECCodewords;}
else{throw FormatException.getFormatInstance();}}}
static getBitCountForCodeword(codeword){let result=new Int32Array(8);let previousValue=0;let i=result.length-1;while(true){if((codeword&0x1)!==previousValue){previousValue=codeword&0x1;i--;if(i<0){break;}}
result[i]++;codeword>>=1;}
return result;}
static getCodewordBucketNumber(codeword){if(codeword instanceof Int32Array){return this.getCodewordBucketNumber_Int32Array(codeword);}
return this.getCodewordBucketNumber_number(codeword);}
static getCodewordBucketNumber_number(codeword){return PDF417ScanningDecoder.getCodewordBucketNumber(PDF417ScanningDecoder.getBitCountForCodeword(codeword));}
static getCodewordBucketNumber_Int32Array(moduleBitCount){return(moduleBitCount[0]-moduleBitCount[2]+moduleBitCount[4]-moduleBitCount[6]+9)%9;}
static toString(barcodeMatrix){let formatter=new Formatter();for(let row=0;row<barcodeMatrix.length;row++){formatter.format('Row %2d: ',row);for(let column=0;column<barcodeMatrix[row].length;column++){let barcodeValue=barcodeMatrix[row][column];if(barcodeValue.getValue().length===0){formatter.format('        ',null);}
else{formatter.format('%4d(%2d)',barcodeValue.getValue()[0],barcodeValue.getConfidence(barcodeValue.getValue()[0]));}}
formatter.format('%n');}
return formatter.toString();}}
PDF417ScanningDecoder.CODEWORD_SKEW_SIZE=2;PDF417ScanningDecoder.MAX_ERRORS=3;PDF417ScanningDecoder.MAX_EC_CODEWORDS=512;PDF417ScanningDecoder.errorCorrection=new ErrorCorrection();class PDF417Reader{decode(image,hints=null){let result=PDF417Reader.decode(image,hints,false);if(result==null||result.length===0||result[0]==null){throw NotFoundException.getNotFoundInstance();}
return result[0];}
decodeMultiple(image,hints=null){try{return PDF417Reader.decode(image,hints,true);}
catch(ignored){if(ignored instanceof FormatException||ignored instanceof ChecksumException){throw NotFoundException.getNotFoundInstance();}
throw ignored;}}
static decode(image,hints,multiple){const results=new Array();const detectorResult=Detector$3.detectMultiple(image,hints,multiple);for(const points of detectorResult.getPoints()){const decoderResult=PDF417ScanningDecoder.decode(detectorResult.getBits(),points[4],points[5],points[6],points[7],PDF417Reader.getMinCodewordWidth(points),PDF417Reader.getMaxCodewordWidth(points));const result=new Result(decoderResult.getText(),decoderResult.getRawBytes(),undefined,points,BarcodeFormat$1.PDF_417);result.putMetadata(ResultMetadataType$1.ERROR_CORRECTION_LEVEL,decoderResult.getECLevel());const pdf417ResultMetadata=decoderResult.getOther();if(pdf417ResultMetadata!=null){result.putMetadata(ResultMetadataType$1.PDF417_EXTRA_METADATA,pdf417ResultMetadata);}
results.push(result);}
return results.map(x=>x);}
static getMaxWidth(p1,p2){if(p1==null||p2==null){return 0;}
return Math.trunc(Math.abs(p1.getX()-p2.getX()));}
static getMinWidth(p1,p2){if(p1==null||p2==null){return Integer.MAX_VALUE;}
return Math.trunc(Math.abs(p1.getX()-p2.getX()));}
static getMaxCodewordWidth(p){return Math.floor(Math.max(Math.max(PDF417Reader.getMaxWidth(p[0],p[4]),PDF417Reader.getMaxWidth(p[6],p[2])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN),Math.max(PDF417Reader.getMaxWidth(p[1],p[5]),PDF417Reader.getMaxWidth(p[7],p[3])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN)));}
static getMinCodewordWidth(p){return Math.floor(Math.min(Math.min(PDF417Reader.getMinWidth(p[0],p[4]),PDF417Reader.getMinWidth(p[6],p[2])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN),Math.min(PDF417Reader.getMinWidth(p[1],p[5]),PDF417Reader.getMinWidth(p[7],p[3])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN)));}
reset(){}}
class ReaderException extends Exception{}
ReaderException.kind='ReaderException';class MultiFormatReader{decode(image,hints){this.setHints(hints);return this.decodeInternal(image);}
decodeWithState(image){if(this.readers===null||this.readers===undefined){this.setHints(null);}
return this.decodeInternal(image);}
setHints(hints){this.hints=hints;const tryHarder=hints!==null&&hints!==undefined&&undefined!==hints.get(DecodeHintType$1.TRY_HARDER);const formats=hints===null||hints===undefined?null:hints.get(DecodeHintType$1.POSSIBLE_FORMATS);const readers=new Array();if(formats!==null&&formats!==undefined){const addOneDReader=formats.some(f=>f===BarcodeFormat$1.UPC_A||f===BarcodeFormat$1.UPC_E||f===BarcodeFormat$1.EAN_13||f===BarcodeFormat$1.EAN_8||f===BarcodeFormat$1.CODABAR||f===BarcodeFormat$1.CODE_39||f===BarcodeFormat$1.CODE_93||f===BarcodeFormat$1.CODE_128||f===BarcodeFormat$1.ITF||f===BarcodeFormat$1.RSS_14||f===BarcodeFormat$1.RSS_EXPANDED);if(addOneDReader&&!tryHarder){readers.push(new MultiFormatOneDReader(hints));}
if(formats.includes(BarcodeFormat$1.QR_CODE)){readers.push(new QRCodeReader());}
if(formats.includes(BarcodeFormat$1.DATA_MATRIX)){readers.push(new DataMatrixReader());}
if(formats.includes(BarcodeFormat$1.AZTEC)){readers.push(new AztecReader());}
if(formats.includes(BarcodeFormat$1.PDF_417)){readers.push(new PDF417Reader());}
if(addOneDReader&&tryHarder){readers.push(new MultiFormatOneDReader(hints));}}
if(readers.length===0){if(!tryHarder){readers.push(new MultiFormatOneDReader(hints));}
readers.push(new QRCodeReader());readers.push(new DataMatrixReader());readers.push(new AztecReader());readers.push(new PDF417Reader());if(tryHarder){readers.push(new MultiFormatOneDReader(hints));}}
this.readers=readers;}
reset(){if(this.readers!==null){for(const reader of this.readers){reader.reset();}}}
decodeInternal(image){if(this.readers===null){throw new ReaderException('No readers where selected, nothing can be read.');}
for(const reader of this.readers){try{return reader.decode(image,this.hints);}
catch(ex){if(ex instanceof ReaderException){continue;}}}
throw new NotFoundException('No MultiFormat Readers were able to detect the code.');}}
class BrowserMultiFormatReader extends BrowserCodeReader{constructor(hints=null,timeBetweenScansMillis=500){const reader=new MultiFormatReader();reader.setHints(hints);super(reader,timeBetweenScansMillis);}
decodeBitmap(binaryBitmap){return this.reader.decodeWithState(binaryBitmap);}}
class BrowserPDF417Reader extends BrowserCodeReader{constructor(timeBetweenScansMillis=500){super(new PDF417Reader(),timeBetweenScansMillis);}}
class BrowserQRCodeReader extends BrowserCodeReader{constructor(timeBetweenScansMillis=500){super(new QRCodeReader(),timeBetweenScansMillis);}}
var EncodeHintType;(function(EncodeHintType){EncodeHintType[EncodeHintType["ERROR_CORRECTION"]=0]="ERROR_CORRECTION";EncodeHintType[EncodeHintType["CHARACTER_SET"]=1]="CHARACTER_SET";EncodeHintType[EncodeHintType["DATA_MATRIX_SHAPE"]=2]="DATA_MATRIX_SHAPE";EncodeHintType[EncodeHintType["MIN_SIZE"]=3]="MIN_SIZE";EncodeHintType[EncodeHintType["MAX_SIZE"]=4]="MAX_SIZE";EncodeHintType[EncodeHintType["MARGIN"]=5]="MARGIN";EncodeHintType[EncodeHintType["PDF417_COMPACT"]=6]="PDF417_COMPACT";EncodeHintType[EncodeHintType["PDF417_COMPACTION"]=7]="PDF417_COMPACTION";EncodeHintType[EncodeHintType["PDF417_DIMENSIONS"]=8]="PDF417_DIMENSIONS";EncodeHintType[EncodeHintType["AZTEC_LAYERS"]=9]="AZTEC_LAYERS";EncodeHintType[EncodeHintType["QR_VERSION"]=10]="QR_VERSION";})(EncodeHintType||(EncodeHintType={}));var EncodeHintType$1=EncodeHintType;class ReedSolomonEncoder{constructor(field){this.field=field;this.cachedGenerators=[];this.cachedGenerators.push(new GenericGFPoly(field,Int32Array.from([1])));}
buildGenerator(degree){const cachedGenerators=this.cachedGenerators;if(degree>=cachedGenerators.length){let lastGenerator=cachedGenerators[cachedGenerators.length-1];const field=this.field;for(let d=cachedGenerators.length;d<=degree;d++){const nextGenerator=lastGenerator.multiply(new GenericGFPoly(field,Int32Array.from([1,field.exp(d-1+field.getGeneratorBase())])));cachedGenerators.push(nextGenerator);lastGenerator=nextGenerator;}}
return cachedGenerators[degree];}
encode(toEncode,ecBytes){if(ecBytes===0){throw new IllegalArgumentException('No error correction bytes');}
const dataBytes=toEncode.length-ecBytes;if(dataBytes<=0){throw new IllegalArgumentException('No data bytes provided');}
const generator=this.buildGenerator(ecBytes);const infoCoefficients=new Int32Array(dataBytes);System.arraycopy(toEncode,0,infoCoefficients,0,dataBytes);let info=new GenericGFPoly(this.field,infoCoefficients);info=info.multiplyByMonomial(ecBytes,1);const remainder=info.divide(generator)[1];const coefficients=remainder.getCoefficients();const numZeroCoefficients=ecBytes-coefficients.length;for(let i=0;i<numZeroCoefficients;i++){toEncode[dataBytes+i]=0;}
System.arraycopy(coefficients,0,toEncode,dataBytes+numZeroCoefficients,coefficients.length);}}
class MaskUtil{constructor(){}
static applyMaskPenaltyRule1(matrix){return MaskUtil.applyMaskPenaltyRule1Internal(matrix,true)+MaskUtil.applyMaskPenaltyRule1Internal(matrix,false);}
static applyMaskPenaltyRule2(matrix){let penalty=0;const array=matrix.getArray();const width=matrix.getWidth();const height=matrix.getHeight();for(let y=0;y<height-1;y++){const arrayY=array[y];for(let x=0;x<width-1;x++){const value=arrayY[x];if(value===arrayY[x+1]&&value===array[y+1][x]&&value===array[y+1][x+1]){penalty++;}}}
return MaskUtil.N2*penalty;}
static applyMaskPenaltyRule3(matrix){let numPenalties=0;const array=matrix.getArray();const width=matrix.getWidth();const height=matrix.getHeight();for(let y=0;y<height;y++){for(let x=0;x<width;x++){const arrayY=array[y];if(x+6<width&&arrayY[x]===1&&arrayY[x+1]===0&&arrayY[x+2]===1&&arrayY[x+3]===1&&arrayY[x+4]===1&&arrayY[x+5]===0&&arrayY[x+6]===1&&(MaskUtil.isWhiteHorizontal(arrayY,x-4,x)||MaskUtil.isWhiteHorizontal(arrayY,x+7,x+11))){numPenalties++;}
if(y+6<height&&array[y][x]===1&&array[y+1][x]===0&&array[y+2][x]===1&&array[y+3][x]===1&&array[y+4][x]===1&&array[y+5][x]===0&&array[y+6][x]===1&&(MaskUtil.isWhiteVertical(array,x,y-4,y)||MaskUtil.isWhiteVertical(array,x,y+7,y+11))){numPenalties++;}}}
return numPenalties*MaskUtil.N3;}
static isWhiteHorizontal(rowArray,from,to){from=Math.max(from,0);to=Math.min(to,rowArray.length);for(let i=from;i<to;i++){if(rowArray[i]===1){return false;}}
return true;}
static isWhiteVertical(array,col,from,to){from=Math.max(from,0);to=Math.min(to,array.length);for(let i=from;i<to;i++){if(array[i][col]===1){return false;}}
return true;}
static applyMaskPenaltyRule4(matrix){let numDarkCells=0;const array=matrix.getArray();const width=matrix.getWidth();const height=matrix.getHeight();for(let y=0;y<height;y++){const arrayY=array[y];for(let x=0;x<width;x++){if(arrayY[x]===1){numDarkCells++;}}}
const numTotalCells=matrix.getHeight()*matrix.getWidth();const fivePercentVariances=Math.floor(Math.abs(numDarkCells*2-numTotalCells)*10/numTotalCells);return fivePercentVariances*MaskUtil.N4;}
static getDataMaskBit(maskPattern,x,y){let intermediate;let temp;switch(maskPattern){case 0:intermediate=(y+x)&0x1;break;case 1:intermediate=y&0x1;break;case 2:intermediate=x%3;break;case 3:intermediate=(y+x)%3;break;case 4:intermediate=(Math.floor(y/2)+Math.floor(x/3))&0x1;break;case 5:temp=y*x;intermediate=(temp&0x1)+(temp%3);break;case 6:temp=y*x;intermediate=((temp&0x1)+(temp%3))&0x1;break;case 7:temp=y*x;intermediate=((temp%3)+((y+x)&0x1))&0x1;break;default:throw new IllegalArgumentException('Invalid mask pattern: '+maskPattern);}
return intermediate===0;}
static applyMaskPenaltyRule1Internal(matrix,isHorizontal){let penalty=0;const iLimit=isHorizontal?matrix.getHeight():matrix.getWidth();const jLimit=isHorizontal?matrix.getWidth():matrix.getHeight();const array=matrix.getArray();for(let i=0;i<iLimit;i++){let numSameBitCells=0;let prevBit=-1;for(let j=0;j<jLimit;j++){const bit=isHorizontal?array[i][j]:array[j][i];if(bit===prevBit){numSameBitCells++;}
else{if(numSameBitCells>=5){penalty+=MaskUtil.N1+(numSameBitCells-5);}
numSameBitCells=1;prevBit=bit;}}
if(numSameBitCells>=5){penalty+=MaskUtil.N1+(numSameBitCells-5);}}
return penalty;}}
MaskUtil.N1=3;MaskUtil.N2=3;MaskUtil.N3=40;MaskUtil.N4=10;class ByteMatrix{constructor(width,height){this.width=width;this.height=height;const bytes=new Array(height);for(let i=0;i!==height;i++){bytes[i]=new Uint8Array(width);}
this.bytes=bytes;}
getHeight(){return this.height;}
getWidth(){return this.width;}
get(x,y){return this.bytes[y][x];}
getArray(){return this.bytes;}
setNumber(x,y,value){this.bytes[y][x]=value;}
setBoolean(x,y,value){this.bytes[y][x]=(value?1:0);}
clear(value){for(const aByte of this.bytes){Arrays.fill(aByte,value);}}
equals(o){if(!(o instanceof ByteMatrix)){return false;}
const other=o;if(this.width!==other.width){return false;}
if(this.height!==other.height){return false;}
for(let y=0,height=this.height;y<height;++y){const bytesY=this.bytes[y];const otherBytesY=other.bytes[y];for(let x=0,width=this.width;x<width;++x){if(bytesY[x]!==otherBytesY[x]){return false;}}}
return true;}
toString(){const result=new StringBuilder();for(let y=0,height=this.height;y<height;++y){const bytesY=this.bytes[y];for(let x=0,width=this.width;x<width;++x){switch(bytesY[x]){case 0:result.append(' 0');break;case 1:result.append(' 1');break;default:result.append('  ');break;}}
result.append('\n');}
return result.toString();}}
class QRCode{constructor(){this.maskPattern=-1;}
getMode(){return this.mode;}
getECLevel(){return this.ecLevel;}
getVersion(){return this.version;}
getMaskPattern(){return this.maskPattern;}
getMatrix(){return this.matrix;}
toString(){const result=new StringBuilder();result.append('<<\n');result.append(' mode: ');result.append(this.mode?this.mode.toString():'null');result.append('\n ecLevel: ');result.append(this.ecLevel?this.ecLevel.toString():'null');result.append('\n version: ');result.append(this.version?this.version.toString():'null');result.append('\n maskPattern: ');result.append(this.maskPattern.toString());if(this.matrix){result.append('\n matrix:\n');result.append(this.matrix.toString());}
else{result.append('\n matrix: null\n');}
result.append('>>\n');return result.toString();}
setMode(value){this.mode=value;}
setECLevel(value){this.ecLevel=value;}
setVersion(version){this.version=version;}
setMaskPattern(value){this.maskPattern=value;}
setMatrix(value){this.matrix=value;}
static isValidMaskPattern(maskPattern){return maskPattern>=0&&maskPattern<QRCode.NUM_MASK_PATTERNS;}}
QRCode.NUM_MASK_PATTERNS=8;class WriterException extends Exception{}
WriterException.kind='WriterException';class MatrixUtil{constructor(){}
static clearMatrix(matrix){matrix.clear(255);}
static buildMatrix(dataBits,ecLevel,version,maskPattern,matrix){MatrixUtil.clearMatrix(matrix);MatrixUtil.embedBasicPatterns(version,matrix);MatrixUtil.embedTypeInfo(ecLevel,maskPattern,matrix);MatrixUtil.maybeEmbedVersionInfo(version,matrix);MatrixUtil.embedDataBits(dataBits,maskPattern,matrix);}
static embedBasicPatterns(version,matrix){MatrixUtil.embedPositionDetectionPatternsAndSeparators(matrix);MatrixUtil.embedDarkDotAtLeftBottomCorner(matrix);MatrixUtil.maybeEmbedPositionAdjustmentPatterns(version,matrix);MatrixUtil.embedTimingPatterns(matrix);}
static embedTypeInfo(ecLevel,maskPattern,matrix){const typeInfoBits=new BitArray();MatrixUtil.makeTypeInfoBits(ecLevel,maskPattern,typeInfoBits);for(let i=0,size=typeInfoBits.getSize();i<size;++i){const bit=typeInfoBits.get(typeInfoBits.getSize()-1-i);const coordinates=MatrixUtil.TYPE_INFO_COORDINATES[i];const x1=coordinates[0];const y1=coordinates[1];matrix.setBoolean(x1,y1,bit);if(i<8){const x2=matrix.getWidth()-i-1;const y2=8;matrix.setBoolean(x2,y2,bit);}
else{const x2=8;const y2=matrix.getHeight()-7+(i-8);matrix.setBoolean(x2,y2,bit);}}}
static maybeEmbedVersionInfo(version,matrix){if(version.getVersionNumber()<7){return;}
const versionInfoBits=new BitArray();MatrixUtil.makeVersionInfoBits(version,versionInfoBits);let bitIndex=6*3-1;for(let i=0;i<6;++i){for(let j=0;j<3;++j){const bit=versionInfoBits.get(bitIndex);bitIndex--;matrix.setBoolean(i,matrix.getHeight()-11+j,bit);matrix.setBoolean(matrix.getHeight()-11+j,i,bit);}}}
static embedDataBits(dataBits,maskPattern,matrix){let bitIndex=0;let direction=-1;let x=matrix.getWidth()-1;let y=matrix.getHeight()-1;while(x>0){if(x===6){x-=1;}
while(y>=0&&y<matrix.getHeight()){for(let i=0;i<2;++i){const xx=x-i;if(!MatrixUtil.isEmpty(matrix.get(xx,y))){continue;}
let bit;if(bitIndex<dataBits.getSize()){bit=dataBits.get(bitIndex);++bitIndex;}
else{bit=false;}
if(maskPattern!==255&&MaskUtil.getDataMaskBit(maskPattern,xx,y)){bit=!bit;}
matrix.setBoolean(xx,y,bit);}
y+=direction;}
direction=-direction;y+=direction;x-=2;}
if(bitIndex!==dataBits.getSize()){throw new WriterException('Not all bits consumed: '+bitIndex+'/'+dataBits.getSize());}}
static findMSBSet(value){return 32-Integer.numberOfLeadingZeros(value);}
static calculateBCHCode(value,poly){if(poly===0){throw new IllegalArgumentException('0 polynomial');}
const msbSetInPoly=MatrixUtil.findMSBSet(poly);value<<=msbSetInPoly-1;while(MatrixUtil.findMSBSet(value)>=msbSetInPoly){value^=poly<<(MatrixUtil.findMSBSet(value)-msbSetInPoly);}
return value;}
static makeTypeInfoBits(ecLevel,maskPattern,bits){if(!QRCode.isValidMaskPattern(maskPattern)){throw new WriterException('Invalid mask pattern');}
const typeInfo=(ecLevel.getBits()<<3)|maskPattern;bits.appendBits(typeInfo,5);const bchCode=MatrixUtil.calculateBCHCode(typeInfo,MatrixUtil.TYPE_INFO_POLY);bits.appendBits(bchCode,10);const maskBits=new BitArray();maskBits.appendBits(MatrixUtil.TYPE_INFO_MASK_PATTERN,15);bits.xor(maskBits);if(bits.getSize()!==15){throw new WriterException('should not happen but we got: '+bits.getSize());}}
static makeVersionInfoBits(version,bits){bits.appendBits(version.getVersionNumber(),6);const bchCode=MatrixUtil.calculateBCHCode(version.getVersionNumber(),MatrixUtil.VERSION_INFO_POLY);bits.appendBits(bchCode,12);if(bits.getSize()!==18){throw new WriterException('should not happen but we got: '+bits.getSize());}}
static isEmpty(value){return value===255;}
static embedTimingPatterns(matrix){for(let i=8;i<matrix.getWidth()-8;++i){const bit=(i+1)%2;if(MatrixUtil.isEmpty(matrix.get(i,6))){matrix.setNumber(i,6,bit);}
if(MatrixUtil.isEmpty(matrix.get(6,i))){matrix.setNumber(6,i,bit);}}}
static embedDarkDotAtLeftBottomCorner(matrix){if(matrix.get(8,matrix.getHeight()-8)===0){throw new WriterException();}
matrix.setNumber(8,matrix.getHeight()-8,1);}
static embedHorizontalSeparationPattern(xStart,yStart,matrix){for(let x=0;x<8;++x){if(!MatrixUtil.isEmpty(matrix.get(xStart+x,yStart))){throw new WriterException();}
matrix.setNumber(xStart+x,yStart,0);}}
static embedVerticalSeparationPattern(xStart,yStart,matrix){for(let y=0;y<7;++y){if(!MatrixUtil.isEmpty(matrix.get(xStart,yStart+y))){throw new WriterException();}
matrix.setNumber(xStart,yStart+y,0);}}
static embedPositionAdjustmentPattern(xStart,yStart,matrix){for(let y=0;y<5;++y){const patternY=MatrixUtil.POSITION_ADJUSTMENT_PATTERN[y];for(let x=0;x<5;++x){matrix.setNumber(xStart+x,yStart+y,patternY[x]);}}}
static embedPositionDetectionPattern(xStart,yStart,matrix){for(let y=0;y<7;++y){const patternY=MatrixUtil.POSITION_DETECTION_PATTERN[y];for(let x=0;x<7;++x){matrix.setNumber(xStart+x,yStart+y,patternY[x]);}}}
static embedPositionDetectionPatternsAndSeparators(matrix){const pdpWidth=MatrixUtil.POSITION_DETECTION_PATTERN[0].length;MatrixUtil.embedPositionDetectionPattern(0,0,matrix);MatrixUtil.embedPositionDetectionPattern(matrix.getWidth()-pdpWidth,0,matrix);MatrixUtil.embedPositionDetectionPattern(0,matrix.getWidth()-pdpWidth,matrix);const hspWidth=8;MatrixUtil.embedHorizontalSeparationPattern(0,hspWidth-1,matrix);MatrixUtil.embedHorizontalSeparationPattern(matrix.getWidth()-hspWidth,hspWidth-1,matrix);MatrixUtil.embedHorizontalSeparationPattern(0,matrix.getWidth()-hspWidth,matrix);const vspSize=7;MatrixUtil.embedVerticalSeparationPattern(vspSize,0,matrix);MatrixUtil.embedVerticalSeparationPattern(matrix.getHeight()-vspSize-1,0,matrix);MatrixUtil.embedVerticalSeparationPattern(vspSize,matrix.getHeight()-vspSize,matrix);}
static maybeEmbedPositionAdjustmentPatterns(version,matrix){if(version.getVersionNumber()<2){return;}
const index=version.getVersionNumber()-1;const coordinates=MatrixUtil.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[index];for(let i=0,length=coordinates.length;i!==length;i++){const y=coordinates[i];if(y>=0){for(let j=0;j!==length;j++){const x=coordinates[j];if(x>=0&&MatrixUtil.isEmpty(matrix.get(x,y))){MatrixUtil.embedPositionAdjustmentPattern(x-2,y-2,matrix);}}}}}}
MatrixUtil.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1]),]);MatrixUtil.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1]),]);MatrixUtil.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170]),]);MatrixUtil.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8]),]);MatrixUtil.VERSION_INFO_POLY=0x1f25;MatrixUtil.TYPE_INFO_POLY=0x537;MatrixUtil.TYPE_INFO_MASK_PATTERN=0x5412;class BlockPair{constructor(dataBytes,errorCorrectionBytes){this.dataBytes=dataBytes;this.errorCorrectionBytes=errorCorrectionBytes;}
getDataBytes(){return this.dataBytes;}
getErrorCorrectionBytes(){return this.errorCorrectionBytes;}}
class Encoder{constructor(){}
static calculateMaskPenalty(matrix){return MaskUtil.applyMaskPenaltyRule1(matrix)
+MaskUtil.applyMaskPenaltyRule2(matrix)
+MaskUtil.applyMaskPenaltyRule3(matrix)
+MaskUtil.applyMaskPenaltyRule4(matrix);}
static encode(content,ecLevel,hints=null){let encoding=Encoder.DEFAULT_BYTE_MODE_ENCODING;const hasEncodingHint=hints!==null&&undefined!==hints.get(EncodeHintType$1.CHARACTER_SET);if(hasEncodingHint){encoding=hints.get(EncodeHintType$1.CHARACTER_SET).toString();}
const mode=this.chooseMode(content,encoding);const headerBits=new BitArray();if(mode===Mode$1.BYTE&&(hasEncodingHint||Encoder.DEFAULT_BYTE_MODE_ENCODING!==encoding)){const eci=CharacterSetECI.getCharacterSetECIByName(encoding);if(eci!==undefined){this.appendECI(eci,headerBits);}}
this.appendModeInfo(mode,headerBits);const dataBits=new BitArray();this.appendBytes(content,mode,dataBits,encoding);let version;if(hints!==null&&undefined!==hints.get(EncodeHintType$1.QR_VERSION)){const versionNumber=Number.parseInt(hints.get(EncodeHintType$1.QR_VERSION).toString(),10);version=Version$1.getVersionForNumber(versionNumber);const bitsNeeded=this.calculateBitsNeeded(mode,headerBits,dataBits,version);if(!this.willFit(bitsNeeded,version,ecLevel)){throw new WriterException('Data too big for requested version');}}
else{version=this.recommendVersion(ecLevel,mode,headerBits,dataBits);}
const headerAndDataBits=new BitArray();headerAndDataBits.appendBitArray(headerBits);const numLetters=mode===Mode$1.BYTE?dataBits.getSizeInBytes():content.length;this.appendLengthInfo(numLetters,version,mode,headerAndDataBits);headerAndDataBits.appendBitArray(dataBits);const ecBlocks=version.getECBlocksForLevel(ecLevel);const numDataBytes=version.getTotalCodewords()-ecBlocks.getTotalECCodewords();this.terminateBits(numDataBytes,headerAndDataBits);const finalBits=this.interleaveWithECBytes(headerAndDataBits,version.getTotalCodewords(),numDataBytes,ecBlocks.getNumBlocks());const qrCode=new QRCode();qrCode.setECLevel(ecLevel);qrCode.setMode(mode);qrCode.setVersion(version);const dimension=version.getDimensionForVersion();const matrix=new ByteMatrix(dimension,dimension);const maskPattern=this.chooseMaskPattern(finalBits,ecLevel,version,matrix);qrCode.setMaskPattern(maskPattern);MatrixUtil.buildMatrix(finalBits,ecLevel,version,maskPattern,matrix);qrCode.setMatrix(matrix);return qrCode;}
static recommendVersion(ecLevel,mode,headerBits,dataBits){const provisionalBitsNeeded=this.calculateBitsNeeded(mode,headerBits,dataBits,Version$1.getVersionForNumber(1));const provisionalVersion=this.chooseVersion(provisionalBitsNeeded,ecLevel);const bitsNeeded=this.calculateBitsNeeded(mode,headerBits,dataBits,provisionalVersion);return this.chooseVersion(bitsNeeded,ecLevel);}
static calculateBitsNeeded(mode,headerBits,dataBits,version){return headerBits.getSize()+mode.getCharacterCountBits(version)+dataBits.getSize();}
static getAlphanumericCode(code){if(code<Encoder.ALPHANUMERIC_TABLE.length){return Encoder.ALPHANUMERIC_TABLE[code];}
return-1;}
static chooseMode(content,encoding=null){if(CharacterSetECI.SJIS.getName()===encoding&&this.isOnlyDoubleByteKanji(content)){return Mode$1.KANJI;}
let hasNumeric=false;let hasAlphanumeric=false;for(let i=0,length=content.length;i<length;++i){const c=content.charAt(i);if(Encoder.isDigit(c)){hasNumeric=true;}
else if(this.getAlphanumericCode(c.charCodeAt(0))!==-1){hasAlphanumeric=true;}
else{return Mode$1.BYTE;}}
if(hasAlphanumeric){return Mode$1.ALPHANUMERIC;}
if(hasNumeric){return Mode$1.NUMERIC;}
return Mode$1.BYTE;}
static isOnlyDoubleByteKanji(content){let bytes;try{bytes=StringEncoding.encode(content,CharacterSetECI.SJIS);}
catch(ignored){return false;}
const length=bytes.length;if(length%2!==0){return false;}
for(let i=0;i<length;i+=2){const byte1=bytes[i]&0xFF;if((byte1<0x81||byte1>0x9F)&&(byte1<0xE0||byte1>0xEB)){return false;}}
return true;}
static chooseMaskPattern(bits,ecLevel,version,matrix){let minPenalty=Number.MAX_SAFE_INTEGER;let bestMaskPattern=-1;for(let maskPattern=0;maskPattern<QRCode.NUM_MASK_PATTERNS;maskPattern++){MatrixUtil.buildMatrix(bits,ecLevel,version,maskPattern,matrix);let penalty=this.calculateMaskPenalty(matrix);if(penalty<minPenalty){minPenalty=penalty;bestMaskPattern=maskPattern;}}
return bestMaskPattern;}
static chooseVersion(numInputBits,ecLevel){for(let versionNum=1;versionNum<=40;versionNum++){const version=Version$1.getVersionForNumber(versionNum);if(Encoder.willFit(numInputBits,version,ecLevel)){return version;}}
throw new WriterException('Data too big');}
static willFit(numInputBits,version,ecLevel){const numBytes=version.getTotalCodewords();const ecBlocks=version.getECBlocksForLevel(ecLevel);const numEcBytes=ecBlocks.getTotalECCodewords();const numDataBytes=numBytes-numEcBytes;const totalInputBytes=(numInputBits+7)/8;return numDataBytes>=totalInputBytes;}
static terminateBits(numDataBytes,bits){const capacity=numDataBytes*8;if(bits.getSize()>capacity){throw new WriterException('data bits cannot fit in the QR Code'+bits.getSize()+' > '+
capacity);}
for(let i=0;i<4&&bits.getSize()<capacity;++i){bits.appendBit(false);}
const numBitsInLastByte=bits.getSize()&0x07;if(numBitsInLastByte>0){for(let i=numBitsInLastByte;i<8;i++){bits.appendBit(false);}}
const numPaddingBytes=numDataBytes-bits.getSizeInBytes();for(let i=0;i<numPaddingBytes;++i){bits.appendBits((i&0x01)===0?0xEC:0x11,8);}
if(bits.getSize()!==capacity){throw new WriterException('Bits size does not equal capacity');}}
static getNumDataBytesAndNumECBytesForBlockID(numTotalBytes,numDataBytes,numRSBlocks,blockID,numDataBytesInBlock,numECBytesInBlock){if(blockID>=numRSBlocks){throw new WriterException('Block ID too large');}
const numRsBlocksInGroup2=numTotalBytes%numRSBlocks;const numRsBlocksInGroup1=numRSBlocks-numRsBlocksInGroup2;const numTotalBytesInGroup1=Math.floor(numTotalBytes/numRSBlocks);const numTotalBytesInGroup2=numTotalBytesInGroup1+1;const numDataBytesInGroup1=Math.floor(numDataBytes/numRSBlocks);const numDataBytesInGroup2=numDataBytesInGroup1+1;const numEcBytesInGroup1=numTotalBytesInGroup1-numDataBytesInGroup1;const numEcBytesInGroup2=numTotalBytesInGroup2-numDataBytesInGroup2;if(numEcBytesInGroup1!==numEcBytesInGroup2){throw new WriterException('EC bytes mismatch');}
if(numRSBlocks!==numRsBlocksInGroup1+numRsBlocksInGroup2){throw new WriterException('RS blocks mismatch');}
if(numTotalBytes!==((numDataBytesInGroup1+numEcBytesInGroup1)*numRsBlocksInGroup1)+
((numDataBytesInGroup2+numEcBytesInGroup2)*numRsBlocksInGroup2)){throw new WriterException('Total bytes mismatch');}
if(blockID<numRsBlocksInGroup1){numDataBytesInBlock[0]=numDataBytesInGroup1;numECBytesInBlock[0]=numEcBytesInGroup1;}
else{numDataBytesInBlock[0]=numDataBytesInGroup2;numECBytesInBlock[0]=numEcBytesInGroup2;}}
static interleaveWithECBytes(bits,numTotalBytes,numDataBytes,numRSBlocks){if(bits.getSizeInBytes()!==numDataBytes){throw new WriterException('Number of bits and data bytes does not match');}
let dataBytesOffset=0;let maxNumDataBytes=0;let maxNumEcBytes=0;const blocks=new Array();for(let i=0;i<numRSBlocks;++i){const numDataBytesInBlock=new Int32Array(1);const numEcBytesInBlock=new Int32Array(1);Encoder.getNumDataBytesAndNumECBytesForBlockID(numTotalBytes,numDataBytes,numRSBlocks,i,numDataBytesInBlock,numEcBytesInBlock);const size=numDataBytesInBlock[0];const dataBytes=new Uint8Array(size);bits.toBytes(8*dataBytesOffset,dataBytes,0,size);const ecBytes=Encoder.generateECBytes(dataBytes,numEcBytesInBlock[0]);blocks.push(new BlockPair(dataBytes,ecBytes));maxNumDataBytes=Math.max(maxNumDataBytes,size);maxNumEcBytes=Math.max(maxNumEcBytes,ecBytes.length);dataBytesOffset+=numDataBytesInBlock[0];}
if(numDataBytes!==dataBytesOffset){throw new WriterException('Data bytes does not match offset');}
const result=new BitArray();for(let i=0;i<maxNumDataBytes;++i){for(const block of blocks){const dataBytes=block.getDataBytes();if(i<dataBytes.length){result.appendBits(dataBytes[i],8);}}}
for(let i=0;i<maxNumEcBytes;++i){for(const block of blocks){const ecBytes=block.getErrorCorrectionBytes();if(i<ecBytes.length){result.appendBits(ecBytes[i],8);}}}
if(numTotalBytes!==result.getSizeInBytes()){throw new WriterException('Interleaving error: '+numTotalBytes+' and '+
result.getSizeInBytes()+' differ.');}
return result;}
static generateECBytes(dataBytes,numEcBytesInBlock){const numDataBytes=dataBytes.length;const toEncode=new Int32Array(numDataBytes+numEcBytesInBlock);for(let i=0;i<numDataBytes;i++){toEncode[i]=dataBytes[i]&0xFF;}
new ReedSolomonEncoder(GenericGF.QR_CODE_FIELD_256).encode(toEncode,numEcBytesInBlock);const ecBytes=new Uint8Array(numEcBytesInBlock);for(let i=0;i<numEcBytesInBlock;i++){ecBytes[i]=toEncode[numDataBytes+i];}
return ecBytes;}
static appendModeInfo(mode,bits){bits.appendBits(mode.getBits(),4);}
static appendLengthInfo(numLetters,version,mode,bits){const numBits=mode.getCharacterCountBits(version);if(numLetters>=(1<<numBits)){throw new WriterException(numLetters+' is bigger than '+((1<<numBits)-1));}
bits.appendBits(numLetters,numBits);}
static appendBytes(content,mode,bits,encoding){switch(mode){case Mode$1.NUMERIC:Encoder.appendNumericBytes(content,bits);break;case Mode$1.ALPHANUMERIC:Encoder.appendAlphanumericBytes(content,bits);break;case Mode$1.BYTE:Encoder.append8BitBytes(content,bits,encoding);break;case Mode$1.KANJI:Encoder.appendKanjiBytes(content,bits);break;default:throw new WriterException('Invalid mode: '+mode);}}
static getDigit(singleCharacter){return singleCharacter.charCodeAt(0)-48;}
static isDigit(singleCharacter){const cn=Encoder.getDigit(singleCharacter);return cn>=0&&cn<=9;}
static appendNumericBytes(content,bits){const length=content.length;let i=0;while(i<length){const num1=Encoder.getDigit(content.charAt(i));if(i+2<length){const num2=Encoder.getDigit(content.charAt(i+1));const num3=Encoder.getDigit(content.charAt(i+2));bits.appendBits(num1*100+num2*10+num3,10);i+=3;}
else if(i+1<length){const num2=Encoder.getDigit(content.charAt(i+1));bits.appendBits(num1*10+num2,7);i+=2;}
else{bits.appendBits(num1,4);i++;}}}
static appendAlphanumericBytes(content,bits){const length=content.length;let i=0;while(i<length){const code1=Encoder.getAlphanumericCode(content.charCodeAt(i));if(code1===-1){throw new WriterException();}
if(i+1<length){const code2=Encoder.getAlphanumericCode(content.charCodeAt(i+1));if(code2===-1){throw new WriterException();}
bits.appendBits(code1*45+code2,11);i+=2;}
else{bits.appendBits(code1,6);i++;}}}
static append8BitBytes(content,bits,encoding){let bytes;try{bytes=StringEncoding.encode(content,encoding);}
catch(uee){throw new WriterException(uee);}
for(let i=0,length=bytes.length;i!==length;i++){const b=bytes[i];bits.appendBits(b,8);}}
static appendKanjiBytes(content,bits){let bytes;try{bytes=StringEncoding.encode(content,CharacterSetECI.SJIS);}
catch(uee){throw new WriterException(uee);}
const length=bytes.length;for(let i=0;i<length;i+=2){const byte1=bytes[i]&0xFF;const byte2=bytes[i+1]&0xFF;const code=((byte1<<8)&0xFFFFFFFF)|byte2;let subtracted=-1;if(code>=0x8140&&code<=0x9ffc){subtracted=code-0x8140;}
else if(code>=0xe040&&code<=0xebbf){subtracted=code-0xc140;}
if(subtracted===-1){throw new WriterException('Invalid byte sequence');}
const encoded=((subtracted>>8)*0xc0)+(subtracted&0xff);bits.appendBits(encoded,13);}}
static appendECI(eci,bits){bits.appendBits(Mode$1.ECI.getBits(),4);bits.appendBits(eci.getValue(),8);}}
Encoder.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1,]);Encoder.DEFAULT_BYTE_MODE_ENCODING=CharacterSetECI.UTF8.getName();class BrowserQRCodeSvgWriter{write(contents,width,height,hints=null){if(contents.length===0){throw new IllegalArgumentException('Found empty contents');}
if(width<0||height<0){throw new IllegalArgumentException('Requested dimensions are too small: '+width+'x'+height);}
let errorCorrectionLevel=ErrorCorrectionLevel.L;let quietZone=BrowserQRCodeSvgWriter.QUIET_ZONE_SIZE;if(hints!==null){if(undefined!==hints.get(EncodeHintType$1.ERROR_CORRECTION)){errorCorrectionLevel=ErrorCorrectionLevel.fromString(hints.get(EncodeHintType$1.ERROR_CORRECTION).toString());}
if(undefined!==hints.get(EncodeHintType$1.MARGIN)){quietZone=Number.parseInt(hints.get(EncodeHintType$1.MARGIN).toString(),10);}}
const code=Encoder.encode(contents,errorCorrectionLevel,hints);return this.renderResult(code,width,height,quietZone);}
writeToDom(containerElement,contents,width,height,hints=null){if(typeof containerElement==='string'){containerElement=document.querySelector(containerElement);}
const svgElement=this.write(contents,width,height,hints);if(containerElement)
containerElement.appendChild(svgElement);}
renderResult(code,width,height,quietZone){const input=code.getMatrix();if(input===null){throw new IllegalStateException();}
const inputWidth=input.getWidth();const inputHeight=input.getHeight();const qrWidth=inputWidth+(quietZone*2);const qrHeight=inputHeight+(quietZone*2);const outputWidth=Math.max(width,qrWidth);const outputHeight=Math.max(height,qrHeight);const multiple=Math.min(Math.floor(outputWidth/qrWidth),Math.floor(outputHeight/qrHeight));const leftPadding=Math.floor((outputWidth-(inputWidth*multiple))/2);const topPadding=Math.floor((outputHeight-(inputHeight*multiple))/2);const svgElement=this.createSVGElement(outputWidth,outputHeight);for(let inputY=0,outputY=topPadding;inputY<inputHeight;inputY++,outputY+=multiple){for(let inputX=0,outputX=leftPadding;inputX<inputWidth;inputX++,outputX+=multiple){if(input.get(inputX,inputY)===1){const svgRectElement=this.createSvgRectElement(outputX,outputY,multiple,multiple);svgElement.appendChild(svgRectElement);}}}
return svgElement;}
createSVGElement(w,h){const svgElement=document.createElementNS(BrowserQRCodeSvgWriter.SVG_NS,'svg');svgElement.setAttributeNS(null,'height',w.toString());svgElement.setAttributeNS(null,'width',h.toString());return svgElement;}
createSvgRectElement(x,y,w,h){const rect=document.createElementNS(BrowserQRCodeSvgWriter.SVG_NS,'rect');rect.setAttributeNS(null,'x',x.toString());rect.setAttributeNS(null,'y',y.toString());rect.setAttributeNS(null,'height',w.toString());rect.setAttributeNS(null,'width',h.toString());rect.setAttributeNS(null,'fill','#000000');return rect;}}
BrowserQRCodeSvgWriter.QUIET_ZONE_SIZE=4;BrowserQRCodeSvgWriter.SVG_NS='http://www.w3.org/2000/svg';class QRCodeWriter{encode(contents,format,width,height,hints){if(contents.length===0){throw new IllegalArgumentException('Found empty contents');}
if(format!==BarcodeFormat$1.QR_CODE){throw new IllegalArgumentException('Can only encode QR_CODE, but got '+format);}
if(width<0||height<0){throw new IllegalArgumentException(`Requested dimensions are too small: ${width}x${height}`);}
let errorCorrectionLevel=ErrorCorrectionLevel.L;let quietZone=QRCodeWriter.QUIET_ZONE_SIZE;if(hints!==null){if(undefined!==hints.get(EncodeHintType$1.ERROR_CORRECTION)){errorCorrectionLevel=ErrorCorrectionLevel.fromString(hints.get(EncodeHintType$1.ERROR_CORRECTION).toString());}
if(undefined!==hints.get(EncodeHintType$1.MARGIN)){quietZone=Number.parseInt(hints.get(EncodeHintType$1.MARGIN).toString(),10);}}
const code=Encoder.encode(contents,errorCorrectionLevel,hints);return QRCodeWriter.renderResult(code,width,height,quietZone);}
static renderResult(code,width,height,quietZone){const input=code.getMatrix();if(input===null){throw new IllegalStateException();}
const inputWidth=input.getWidth();const inputHeight=input.getHeight();const qrWidth=inputWidth+(quietZone*2);const qrHeight=inputHeight+(quietZone*2);const outputWidth=Math.max(width,qrWidth);const outputHeight=Math.max(height,qrHeight);const multiple=Math.min(Math.floor(outputWidth/qrWidth),Math.floor(outputHeight/qrHeight));const leftPadding=Math.floor((outputWidth-(inputWidth*multiple))/2);const topPadding=Math.floor((outputHeight-(inputHeight*multiple))/2);const output=new BitMatrix(outputWidth,outputHeight);for(let inputY=0,outputY=topPadding;inputY<inputHeight;inputY++,outputY+=multiple){for(let inputX=0,outputX=leftPadding;inputX<inputWidth;inputX++,outputX+=multiple){if(input.get(inputX,inputY)===1){output.setRegion(outputX,outputY,multiple,multiple);}}}
return output;}}
QRCodeWriter.QUIET_ZONE_SIZE=4;class MultiFormatWriter{encode(contents,format,width,height,hints){let writer;switch(format){case BarcodeFormat$1.QR_CODE:writer=new QRCodeWriter();break;default:throw new IllegalArgumentException('No encoder available for format '+format);}
return writer.encode(contents,format,width,height,hints);}}
class PlanarYUVLuminanceSource extends LuminanceSource{constructor(yuvData,dataWidth,dataHeight,left,top,width,height,reverseHorizontal){super(width,height);this.yuvData=yuvData;this.dataWidth=dataWidth;this.dataHeight=dataHeight;this.left=left;this.top=top;if(left+width>dataWidth||top+height>dataHeight){throw new IllegalArgumentException('Crop rectangle does not fit within image data.');}
if(reverseHorizontal){this.reverseHorizontal(width,height);}}
getRow(y,row){if(y<0||y>=this.getHeight()){throw new IllegalArgumentException('Requested row is outside the image: '+y);}
const width=this.getWidth();if(row===null||row===undefined||row.length<width){row=new Uint8ClampedArray(width);}
const offset=(y+this.top)*this.dataWidth+this.left;System.arraycopy(this.yuvData,offset,row,0,width);return row;}
getMatrix(){const width=this.getWidth();const height=this.getHeight();if(width===this.dataWidth&&height===this.dataHeight){return this.yuvData;}
const area=width*height;const matrix=new Uint8ClampedArray(area);let inputOffset=this.top*this.dataWidth+this.left;if(width===this.dataWidth){System.arraycopy(this.yuvData,inputOffset,matrix,0,area);return matrix;}
for(let y=0;y<height;y++){const outputOffset=y*width;System.arraycopy(this.yuvData,inputOffset,matrix,outputOffset,width);inputOffset+=this.dataWidth;}
return matrix;}
isCropSupported(){return true;}
crop(left,top,width,height){return new PlanarYUVLuminanceSource(this.yuvData,this.dataWidth,this.dataHeight,this.left+left,this.top+top,width,height,false);}
renderThumbnail(){const width=this.getWidth()/PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR;const height=this.getHeight()/PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR;const pixels=new Int32Array(width*height);const yuv=this.yuvData;let inputOffset=this.top*this.dataWidth+this.left;for(let y=0;y<height;y++){const outputOffset=y*width;for(let x=0;x<width;x++){const grey=yuv[inputOffset+x*PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR]&0xff;pixels[outputOffset+x]=0xFF000000|(grey*0x00010101);}
inputOffset+=this.dataWidth*PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR;}
return pixels;}
getThumbnailWidth(){return this.getWidth()/PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR;}
getThumbnailHeight(){return this.getHeight()/PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR;}
reverseHorizontal(width,height){const yuvData=this.yuvData;for(let y=0,rowStart=this.top*this.dataWidth+this.left;y<height;y++,rowStart+=this.dataWidth){const middle=rowStart+width/2;for(let x1=rowStart,x2=rowStart+width-1;x1<middle;x1++,x2--){const temp=yuvData[x1];yuvData[x1]=yuvData[x2];yuvData[x2]=temp;}}}
invert(){return new InvertedLuminanceSource(this);}}
PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR=2;class RGBLuminanceSource extends LuminanceSource{constructor(luminances,width,height,dataWidth,dataHeight,left,top){super(width,height);this.dataWidth=dataWidth;this.dataHeight=dataHeight;this.left=left;this.top=top;if(luminances.BYTES_PER_ELEMENT===4){const size=width*height;const luminancesUint8Array=new Uint8ClampedArray(size);for(let offset=0;offset<size;offset++){const pixel=luminances[offset];const r=(pixel>>16)&0xff;const g2=(pixel>>7)&0x1fe;const b=pixel&0xff;luminancesUint8Array[offset]=((r+g2+b)/4)&0xFF;}
this.luminances=luminancesUint8Array;}
else{this.luminances=luminances;}
if(undefined===dataWidth){this.dataWidth=width;}
if(undefined===dataHeight){this.dataHeight=height;}
if(undefined===left){this.left=0;}
if(undefined===top){this.top=0;}
if(this.left+width>this.dataWidth||this.top+height>this.dataHeight){throw new IllegalArgumentException('Crop rectangle does not fit within image data.');}}
getRow(y,row){if(y<0||y>=this.getHeight()){throw new IllegalArgumentException('Requested row is outside the image: '+y);}
const width=this.getWidth();if(row===null||row===undefined||row.length<width){row=new Uint8ClampedArray(width);}
const offset=(y+this.top)*this.dataWidth+this.left;System.arraycopy(this.luminances,offset,row,0,width);return row;}
getMatrix(){const width=this.getWidth();const height=this.getHeight();if(width===this.dataWidth&&height===this.dataHeight){return this.luminances;}
const area=width*height;const matrix=new Uint8ClampedArray(area);let inputOffset=this.top*this.dataWidth+this.left;if(width===this.dataWidth){System.arraycopy(this.luminances,inputOffset,matrix,0,area);return matrix;}
for(let y=0;y<height;y++){const outputOffset=y*width;System.arraycopy(this.luminances,inputOffset,matrix,outputOffset,width);inputOffset+=this.dataWidth;}
return matrix;}
isCropSupported(){return true;}
crop(left,top,width,height){return new RGBLuminanceSource(this.luminances,width,height,this.dataWidth,this.dataHeight,this.left+left,this.top+top);}
invert(){return new InvertedLuminanceSource(this);}}
class Charset extends CharacterSetECI{static forName(name){return this.getCharacterSetECIByName(name);}}
class StandardCharsets{}
StandardCharsets.ISO_8859_1=CharacterSetECI.ISO8859_1;class AztecCode{isCompact(){return this.compact;}
setCompact(compact){this.compact=compact;}
getSize(){return this.size;}
setSize(size){this.size=size;}
getLayers(){return this.layers;}
setLayers(layers){this.layers=layers;}
getCodeWords(){return this.codeWords;}
setCodeWords(codeWords){this.codeWords=codeWords;}
getMatrix(){return this.matrix;}
setMatrix(matrix){this.matrix=matrix;}}
class Collections{static singletonList(item){return[item];}
static min(collection,comparator){return collection.sort(comparator)[0];}}
class Token{constructor(previous){this.previous=previous;}
getPrevious(){return this.previous;}}
class SimpleToken extends Token{constructor(previous,value,bitCount){super(previous);this.value=value;this.bitCount=bitCount;}
appendTo(bitArray,text){bitArray.appendBits(this.value,this.bitCount);}
add(value,bitCount){return new SimpleToken(this,value,bitCount);}
addBinaryShift(start,byteCount){console.warn('addBinaryShift on SimpleToken, this simply returns a copy of this token');return new SimpleToken(this,start,byteCount);}
toString(){let value=this.value&((1<<this.bitCount)-1);value|=1<<this.bitCount;return'<'+Integer.toBinaryString(value|(1<<this.bitCount)).substring(1)+'>';}}
class BinaryShiftToken extends SimpleToken{constructor(previous,binaryShiftStart,binaryShiftByteCount){super(previous,0,0);this.binaryShiftStart=binaryShiftStart;this.binaryShiftByteCount=binaryShiftByteCount;}
appendTo(bitArray,text){for(let i=0;i<this.binaryShiftByteCount;i++){if(i===0||(i===31&&this.binaryShiftByteCount<=62)){bitArray.appendBits(31,5);if(this.binaryShiftByteCount>62){bitArray.appendBits(this.binaryShiftByteCount-31,16);}
else if(i===0){bitArray.appendBits(Math.min(this.binaryShiftByteCount,31),5);}
else{bitArray.appendBits(this.binaryShiftByteCount-31,5);}}
bitArray.appendBits(text[this.binaryShiftStart+i],8);}}
addBinaryShift(start,byteCount){return new BinaryShiftToken(this,start,byteCount);}
toString(){return'<'+this.binaryShiftStart+'::'+(this.binaryShiftStart+this.binaryShiftByteCount-1)+'>';}}
function addBinaryShift(token,start,byteCount){return new BinaryShiftToken(token,start,byteCount);}
function add(token,value,bitCount){return new SimpleToken(token,value,bitCount);}
const MODE_NAMES=['UPPER','LOWER','DIGIT','MIXED','PUNCT'];const MODE_UPPER=0;const MODE_LOWER=1;const MODE_DIGIT=2;const MODE_MIXED=3;const MODE_PUNCT=4;const EMPTY_TOKEN=new SimpleToken(null,0,0);const LATCH_TABLE=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,(10<<16)+(29<<5)+30]),Int32Array.from([(9<<16)+(30<<4)+14,0,(5<<16)+30,(5<<16)+29,(10<<16)+(29<<5)+30]),Int32Array.from([(4<<16)+14,(9<<16)+(14<<5)+28,0,(9<<16)+(14<<5)+29,(14<<16)+(14<<10)+(29<<5)+30]),Int32Array.from([(5<<16)+29,(5<<16)+28,(10<<16)+(29<<5)+30,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,(10<<16)+(31<<5)+28,(10<<16)+(31<<5)+30,(10<<16)+(31<<5)+29,0])];function static_SHIFT_TABLE(SHIFT_TABLE){for(let table of SHIFT_TABLE){Arrays.fill(table,-1);}
SHIFT_TABLE[MODE_UPPER][MODE_PUNCT]=0;SHIFT_TABLE[MODE_LOWER][MODE_PUNCT]=0;SHIFT_TABLE[MODE_LOWER][MODE_UPPER]=28;SHIFT_TABLE[MODE_MIXED][MODE_PUNCT]=0;SHIFT_TABLE[MODE_DIGIT][MODE_PUNCT]=0;SHIFT_TABLE[MODE_DIGIT][MODE_UPPER]=15;return SHIFT_TABLE;}
const SHIFT_TABLE=static_SHIFT_TABLE(Arrays.createInt32Array(6,6));class State{constructor(token,mode,binaryBytes,bitCount){this.token=token;this.mode=mode;this.binaryShiftByteCount=binaryBytes;this.bitCount=bitCount;}
getMode(){return this.mode;}
getToken(){return this.token;}
getBinaryShiftByteCount(){return this.binaryShiftByteCount;}
getBitCount(){return this.bitCount;}
latchAndAppend(mode,value){let bitCount=this.bitCount;let token=this.token;if(mode!==this.mode){let latch=LATCH_TABLE[this.mode][mode];token=add(token,latch&0xffff,latch>>16);bitCount+=latch>>16;}
let latchModeBitCount=mode===MODE_DIGIT?4:5;token=add(token,value,latchModeBitCount);return new State(token,mode,0,bitCount+latchModeBitCount);}
shiftAndAppend(mode,value){let token=this.token;let thisModeBitCount=this.mode===MODE_DIGIT?4:5;token=add(token,SHIFT_TABLE[this.mode][mode],thisModeBitCount);token=add(token,value,5);return new State(token,this.mode,0,this.bitCount+thisModeBitCount+5);}
addBinaryShiftChar(index){let token=this.token;let mode=this.mode;let bitCount=this.bitCount;if(this.mode===MODE_PUNCT||this.mode===MODE_DIGIT){let latch=LATCH_TABLE[mode][MODE_UPPER];token=add(token,latch&0xffff,latch>>16);bitCount+=latch>>16;mode=MODE_UPPER;}
let deltaBitCount=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8;let result=new State(token,mode,this.binaryShiftByteCount+1,bitCount+deltaBitCount);if(result.binaryShiftByteCount===2047+31){result=result.endBinaryShift(index+1);}
return result;}
endBinaryShift(index){if(this.binaryShiftByteCount===0){return this;}
let token=this.token;token=addBinaryShift(token,index-this.binaryShiftByteCount,this.binaryShiftByteCount);return new State(token,this.mode,0,this.bitCount);}
isBetterThanOrEqualTo(other){let newModeBitCount=this.bitCount+(LATCH_TABLE[this.mode][other.mode]>>16);if(this.binaryShiftByteCount<other.binaryShiftByteCount){newModeBitCount+=State.calculateBinaryShiftCost(other)-
State.calculateBinaryShiftCost(this);}
else if(this.binaryShiftByteCount>other.binaryShiftByteCount&&other.binaryShiftByteCount>0){newModeBitCount+=10;}
return newModeBitCount<=other.bitCount;}
toBitArray(text){let symbols=[];for(let token=this.endBinaryShift(text.length).token;token!==null;token=token.getPrevious()){symbols.unshift(token);}
let bitArray=new BitArray();for(const symbol of symbols){symbol.appendTo(bitArray,text);}
return bitArray;}
toString(){return StringUtils.format('%s bits=%d bytes=%d',MODE_NAMES[this.mode],this.bitCount,this.binaryShiftByteCount);}
static calculateBinaryShiftCost(state){if(state.binaryShiftByteCount>62){return 21;}
if(state.binaryShiftByteCount>31){return 20;}
if(state.binaryShiftByteCount>0){return 10;}
return 0;}}
State.INITIAL_STATE=new State(EMPTY_TOKEN,MODE_UPPER,0,0);function static_CHAR_MAP(CHAR_MAP){const spaceCharCode=StringUtils.getCharCode(' ');const pointCharCode=StringUtils.getCharCode('.');const commaCharCode=StringUtils.getCharCode(',');CHAR_MAP[MODE_UPPER][spaceCharCode]=1;const zUpperCharCode=StringUtils.getCharCode('Z');const aUpperCharCode=StringUtils.getCharCode('A');for(let c=aUpperCharCode;c<=zUpperCharCode;c++){CHAR_MAP[MODE_UPPER][c]=c-aUpperCharCode+2;}
CHAR_MAP[MODE_LOWER][spaceCharCode]=1;const zLowerCharCode=StringUtils.getCharCode('z');const aLowerCharCode=StringUtils.getCharCode('a');for(let c=aLowerCharCode;c<=zLowerCharCode;c++){CHAR_MAP[MODE_LOWER][c]=c-aLowerCharCode+2;}
CHAR_MAP[MODE_DIGIT][spaceCharCode]=1;const nineCharCode=StringUtils.getCharCode('9');const zeroCharCode=StringUtils.getCharCode('0');for(let c=zeroCharCode;c<=nineCharCode;c++){CHAR_MAP[MODE_DIGIT][c]=c-zeroCharCode+2;}
CHAR_MAP[MODE_DIGIT][commaCharCode]=12;CHAR_MAP[MODE_DIGIT][pointCharCode]=13;const mixedTable=['\x00',' ','\x01','\x02','\x03','\x04','\x05','\x06','\x07','\b','\t','\n','\x0b','\f','\r','\x1b','\x1c','\x1d','\x1e','\x1f','@','\\','^','_','`','|','~','\x7f'];for(let i=0;i<mixedTable.length;i++){CHAR_MAP[MODE_MIXED][StringUtils.getCharCode(mixedTable[i])]=i;}
const punctTable=['\x00','\r','\x00','\x00','\x00','\x00','!','\'','#','$','%','&','\'','(',')','*','+',',','-','.','/',':',';','<','=','>','?','[',']','{','}'];for(let i=0;i<punctTable.length;i++){if(StringUtils.getCharCode(punctTable[i])>0){CHAR_MAP[MODE_PUNCT][StringUtils.getCharCode(punctTable[i])]=i;}}
return CHAR_MAP;}
const CHAR_MAP=static_CHAR_MAP(Arrays.createInt32Array(5,256));class HighLevelEncoder{constructor(text){this.text=text;}
encode(){const spaceCharCode=StringUtils.getCharCode(' ');const lineBreakCharCode=StringUtils.getCharCode('\n');let states=Collections.singletonList(State.INITIAL_STATE);for(let index=0;index<this.text.length;index++){let pairCode;let nextChar=index+1<this.text.length?this.text[index+1]:0;switch(this.text[index]){case StringUtils.getCharCode('\r'):pairCode=nextChar===lineBreakCharCode?2:0;break;case StringUtils.getCharCode('.'):pairCode=nextChar===spaceCharCode?3:0;break;case StringUtils.getCharCode(','):pairCode=nextChar===spaceCharCode?4:0;break;case StringUtils.getCharCode(':'):pairCode=nextChar===spaceCharCode?5:0;break;default:pairCode=0;}
if(pairCode>0){states=HighLevelEncoder.updateStateListForPair(states,index,pairCode);index++;}
else{states=this.updateStateListForChar(states,index);}}
const minState=Collections.min(states,(a,b)=>{return a.getBitCount()-b.getBitCount();});return minState.toBitArray(this.text);}
updateStateListForChar(states,index){const result=[];for(let state of states){this.updateStateForChar(state,index,result);}
return HighLevelEncoder.simplifyStates(result);}
updateStateForChar(state,index,result){let ch=(this.text[index]&0xff);let charInCurrentTable=CHAR_MAP[state.getMode()][ch]>0;let stateNoBinary=null;for(let mode=0;mode<=MODE_PUNCT;mode++){let charInMode=CHAR_MAP[mode][ch];if(charInMode>0){if(stateNoBinary==null){stateNoBinary=state.endBinaryShift(index);}
if(!charInCurrentTable||mode===state.getMode()||mode===MODE_DIGIT){const latchState=stateNoBinary.latchAndAppend(mode,charInMode);result.push(latchState);}
if(!charInCurrentTable&&SHIFT_TABLE[state.getMode()][mode]>=0){const shiftState=stateNoBinary.shiftAndAppend(mode,charInMode);result.push(shiftState);}}}
if(state.getBinaryShiftByteCount()>0||CHAR_MAP[state.getMode()][ch]===0){let binaryState=state.addBinaryShiftChar(index);result.push(binaryState);}}
static updateStateListForPair(states,index,pairCode){const result=[];for(let state of states){this.updateStateForPair(state,index,pairCode,result);}
return this.simplifyStates(result);}
static updateStateForPair(state,index,pairCode,result){let stateNoBinary=state.endBinaryShift(index);result.push(stateNoBinary.latchAndAppend(MODE_PUNCT,pairCode));if(state.getMode()!==MODE_PUNCT){result.push(stateNoBinary.shiftAndAppend(MODE_PUNCT,pairCode));}
if(pairCode===3||pairCode===4){let digitState=stateNoBinary.latchAndAppend(MODE_DIGIT,16-pairCode).latchAndAppend(MODE_DIGIT,1);result.push(digitState);}
if(state.getBinaryShiftByteCount()>0){let binaryState=state.addBinaryShiftChar(index).addBinaryShiftChar(index+1);result.push(binaryState);}}
static simplifyStates(states){let result=[];for(const newState of states){let add=true;for(const oldState of result){if(oldState.isBetterThanOrEqualTo(newState)){add=false;break;}
if(newState.isBetterThanOrEqualTo(oldState)){result=result.filter(x=>x!==oldState);}}
if(add){result.push(newState);}}
return result;}}
class Encoder$1{constructor(){}
static encodeBytes(data){return Encoder$1.encode(data,Encoder$1.DEFAULT_EC_PERCENT,Encoder$1.DEFAULT_AZTEC_LAYERS);}
static encode(data,minECCPercent,userSpecifiedLayers){let bits=new HighLevelEncoder(data).encode();let eccBits=Integer.truncDivision((bits.getSize()*minECCPercent),100)+11;let totalSizeBits=bits.getSize()+eccBits;let compact;let layers;let totalBitsInLayer;let wordSize;let stuffedBits;if(userSpecifiedLayers!==Encoder$1.DEFAULT_AZTEC_LAYERS){compact=userSpecifiedLayers<0;layers=Math.abs(userSpecifiedLayers);if(layers>(compact?Encoder$1.MAX_NB_BITS_COMPACT:Encoder$1.MAX_NB_BITS)){throw new IllegalArgumentException(StringUtils.format('Illegal value %s for layers',userSpecifiedLayers));}
totalBitsInLayer=Encoder$1.totalBitsInLayer(layers,compact);wordSize=Encoder$1.WORD_SIZE[layers];let usableBitsInLayers=totalBitsInLayer-(totalBitsInLayer%wordSize);stuffedBits=Encoder$1.stuffBits(bits,wordSize);if(stuffedBits.getSize()+eccBits>usableBitsInLayers){throw new IllegalArgumentException('Data to large for user specified layer');}
if(compact&&stuffedBits.getSize()>wordSize*64){throw new IllegalArgumentException('Data to large for user specified layer');}}
else{wordSize=0;stuffedBits=null;for(let i=0;;i++){if(i>Encoder$1.MAX_NB_BITS){throw new IllegalArgumentException('Data too large for an Aztec code');}
compact=i<=3;layers=compact?i+1:i;totalBitsInLayer=Encoder$1.totalBitsInLayer(layers,compact);if(totalSizeBits>totalBitsInLayer){continue;}
if(stuffedBits==null||wordSize!==Encoder$1.WORD_SIZE[layers]){wordSize=Encoder$1.WORD_SIZE[layers];stuffedBits=Encoder$1.stuffBits(bits,wordSize);}
let usableBitsInLayers=totalBitsInLayer-(totalBitsInLayer%wordSize);if(compact&&stuffedBits.getSize()>wordSize*64){continue;}
if(stuffedBits.getSize()+eccBits<=usableBitsInLayers){break;}}}
let messageBits=Encoder$1.generateCheckWords(stuffedBits,totalBitsInLayer,wordSize);let messageSizeInWords=stuffedBits.getSize()/wordSize;let modeMessage=Encoder$1.generateModeMessage(compact,layers,messageSizeInWords);let baseMatrixSize=(compact?11:14)+layers*4;let alignmentMap=new Int32Array(baseMatrixSize);let matrixSize;if(compact){matrixSize=baseMatrixSize;for(let i=0;i<alignmentMap.length;i++){alignmentMap[i]=i;}}
else{matrixSize=baseMatrixSize+1+2*Integer.truncDivision((Integer.truncDivision(baseMatrixSize,2)-1),15);let origCenter=Integer.truncDivision(baseMatrixSize,2);let center=Integer.truncDivision(matrixSize,2);for(let i=0;i<origCenter;i++){let newOffset=i+Integer.truncDivision(i,15);alignmentMap[origCenter-i-1]=center-newOffset-1;alignmentMap[origCenter+i]=center+newOffset+1;}}
let matrix=new BitMatrix(matrixSize);for(let i=0,rowOffset=0;i<layers;i++){let rowSize=(layers-i)*4+(compact?9:12);for(let j=0;j<rowSize;j++){let columnOffset=j*2;for(let k=0;k<2;k++){if(messageBits.get(rowOffset+columnOffset+k)){matrix.set(alignmentMap[i*2+k],alignmentMap[i*2+j]);}
if(messageBits.get(rowOffset+rowSize*2+columnOffset+k)){matrix.set(alignmentMap[i*2+j],alignmentMap[baseMatrixSize-1-i*2-k]);}
if(messageBits.get(rowOffset+rowSize*4+columnOffset+k)){matrix.set(alignmentMap[baseMatrixSize-1-i*2-k],alignmentMap[baseMatrixSize-1-i*2-j]);}
if(messageBits.get(rowOffset+rowSize*6+columnOffset+k)){matrix.set(alignmentMap[baseMatrixSize-1-i*2-j],alignmentMap[i*2+k]);}}}
rowOffset+=rowSize*8;}
Encoder$1.drawModeMessage(matrix,compact,matrixSize,modeMessage);if(compact){Encoder$1.drawBullsEye(matrix,Integer.truncDivision(matrixSize,2),5);}
else{Encoder$1.drawBullsEye(matrix,Integer.truncDivision(matrixSize,2),7);for(let i=0,j=0;i<Integer.truncDivision(baseMatrixSize,2)-1;i+=15,j+=16){for(let k=Integer.truncDivision(matrixSize,2)&1;k<matrixSize;k+=2){matrix.set(Integer.truncDivision(matrixSize,2)-j,k);matrix.set(Integer.truncDivision(matrixSize,2)+j,k);matrix.set(k,Integer.truncDivision(matrixSize,2)-j);matrix.set(k,Integer.truncDivision(matrixSize,2)+j);}}}
let aztec=new AztecCode();aztec.setCompact(compact);aztec.setSize(matrixSize);aztec.setLayers(layers);aztec.setCodeWords(messageSizeInWords);aztec.setMatrix(matrix);return aztec;}
static drawBullsEye(matrix,center,size){for(let i=0;i<size;i+=2){for(let j=center-i;j<=center+i;j++){matrix.set(j,center-i);matrix.set(j,center+i);matrix.set(center-i,j);matrix.set(center+i,j);}}
matrix.set(center-size,center-size);matrix.set(center-size+1,center-size);matrix.set(center-size,center-size+1);matrix.set(center+size,center-size);matrix.set(center+size,center-size+1);matrix.set(center+size,center+size-1);}
static generateModeMessage(compact,layers,messageSizeInWords){let modeMessage=new BitArray();if(compact){modeMessage.appendBits(layers-1,2);modeMessage.appendBits(messageSizeInWords-1,6);modeMessage=Encoder$1.generateCheckWords(modeMessage,28,4);}
else{modeMessage.appendBits(layers-1,5);modeMessage.appendBits(messageSizeInWords-1,11);modeMessage=Encoder$1.generateCheckWords(modeMessage,40,4);}
return modeMessage;}
static drawModeMessage(matrix,compact,matrixSize,modeMessage){let center=Integer.truncDivision(matrixSize,2);if(compact){for(let i=0;i<7;i++){let offset=center-3+i;if(modeMessage.get(i)){matrix.set(offset,center-5);}
if(modeMessage.get(i+7)){matrix.set(center+5,offset);}
if(modeMessage.get(20-i)){matrix.set(offset,center+5);}
if(modeMessage.get(27-i)){matrix.set(center-5,offset);}}}
else{for(let i=0;i<10;i++){let offset=center-5+i+Integer.truncDivision(i,5);if(modeMessage.get(i)){matrix.set(offset,center-7);}
if(modeMessage.get(i+10)){matrix.set(center+7,offset);}
if(modeMessage.get(29-i)){matrix.set(offset,center+7);}
if(modeMessage.get(39-i)){matrix.set(center-7,offset);}}}}
static generateCheckWords(bitArray,totalBits,wordSize){let messageSizeInWords=bitArray.getSize()/wordSize;let rs=new ReedSolomonEncoder(Encoder$1.getGF(wordSize));let totalWords=Integer.truncDivision(totalBits,wordSize);let messageWords=Encoder$1.bitsToWords(bitArray,wordSize,totalWords);rs.encode(messageWords,totalWords-messageSizeInWords);let startPad=totalBits%wordSize;let messageBits=new BitArray();messageBits.appendBits(0,startPad);for(const messageWord of Array.from(messageWords)){messageBits.appendBits(messageWord,wordSize);}
return messageBits;}
static bitsToWords(stuffedBits,wordSize,totalWords){let message=new Int32Array(totalWords);let i;let n;for(i=0,n=stuffedBits.getSize()/wordSize;i<n;i++){let value=0;for(let j=0;j<wordSize;j++){value|=stuffedBits.get(i*wordSize+j)?(1<<wordSize-j-1):0;}
message[i]=value;}
return message;}
static getGF(wordSize){switch(wordSize){case 4:return GenericGF.AZTEC_PARAM;case 6:return GenericGF.AZTEC_DATA_6;case 8:return GenericGF.AZTEC_DATA_8;case 10:return GenericGF.AZTEC_DATA_10;case 12:return GenericGF.AZTEC_DATA_12;default:throw new IllegalArgumentException('Unsupported word size '+wordSize);}}
static stuffBits(bits,wordSize){let out=new BitArray();let n=bits.getSize();let mask=(1<<wordSize)-2;for(let i=0;i<n;i+=wordSize){let word=0;for(let j=0;j<wordSize;j++){if(i+j>=n||bits.get(i+j)){word|=1<<(wordSize-1-j);}}
if((word&mask)===mask){out.appendBits(word&mask,wordSize);i--;}
else if((word&mask)===0){out.appendBits(word|1,wordSize);i--;}
else{out.appendBits(word,wordSize);}}
return out;}
static totalBitsInLayer(layers,compact){return((compact?88:112)+16*layers)*layers;}}
Encoder$1.DEFAULT_EC_PERCENT=33;Encoder$1.DEFAULT_AZTEC_LAYERS=0;Encoder$1.MAX_NB_BITS=32;Encoder$1.MAX_NB_BITS_COMPACT=4;Encoder$1.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class AztecWriter{encode(contents,format,width,height){return this.encodeWithHints(contents,format,width,height,null);}
encodeWithHints(contents,format,width,height,hints){let charset=StandardCharsets.ISO_8859_1;let eccPercent=Encoder$1.DEFAULT_EC_PERCENT;let layers=Encoder$1.DEFAULT_AZTEC_LAYERS;if(hints!=null){if(hints.has(EncodeHintType$1.CHARACTER_SET)){charset=Charset.forName(hints.get(EncodeHintType$1.CHARACTER_SET).toString());}
if(hints.has(EncodeHintType$1.ERROR_CORRECTION)){eccPercent=Integer.parseInt(hints.get(EncodeHintType$1.ERROR_CORRECTION).toString());}
if(hints.has(EncodeHintType$1.AZTEC_LAYERS)){layers=Integer.parseInt(hints.get(EncodeHintType$1.AZTEC_LAYERS).toString());}}
return AztecWriter.encodeLayers(contents,format,width,height,charset,eccPercent,layers);}
static encodeLayers(contents,format,width,height,charset,eccPercent,layers){if(format!==BarcodeFormat$1.AZTEC){throw new IllegalArgumentException('Can only encode AZTEC, but got '+format);}
let aztec=Encoder$1.encode(StringUtils.getBytes(contents,charset),eccPercent,layers);return AztecWriter.renderResult(aztec,width,height);}
static renderResult(code,width,height){let input=code.getMatrix();if(input==null){throw new IllegalStateException();}
let inputWidth=input.getWidth();let inputHeight=input.getHeight();let outputWidth=Math.max(width,inputWidth);let outputHeight=Math.max(height,inputHeight);let multiple=Math.min(outputWidth/inputWidth,outputHeight/inputHeight);let leftPadding=(outputWidth-(inputWidth*multiple))/2;let topPadding=(outputHeight-(inputHeight*multiple))/2;let output=new BitMatrix(outputWidth,outputHeight);for(let inputY=0,outputY=topPadding;inputY<inputHeight;inputY++,outputY+=multiple){for(let inputX=0,outputX=leftPadding;inputX<inputWidth;inputX++,outputX+=multiple){if(input.get(inputX,inputY)){output.setRegion(outputX,outputY,multiple,multiple);}}}
return output;}}
exports.AbstractExpandedDecoder=AbstractExpandedDecoder;exports.ArgumentException=ArgumentException;exports.ArithmeticException=ArithmeticException;exports.AztecCode=AztecCode;exports.AztecCodeReader=AztecReader;exports.AztecCodeWriter=AztecWriter;exports.AztecDecoder=Decoder;exports.AztecDetector=Detector;exports.AztecDetectorResult=AztecDetectorResult;exports.AztecEncoder=Encoder$1;exports.AztecHighLevelEncoder=HighLevelEncoder;exports.AztecPoint=Point;exports.BarcodeFormat=BarcodeFormat$1;exports.Binarizer=Binarizer;exports.BinaryBitmap=BinaryBitmap;exports.BitArray=BitArray;exports.BitMatrix=BitMatrix;exports.BitSource=BitSource;exports.BrowserAztecCodeReader=BrowserAztecCodeReader;exports.BrowserBarcodeReader=BrowserBarcodeReader;exports.BrowserCodeReader=BrowserCodeReader;exports.BrowserDatamatrixCodeReader=BrowserDatamatrixCodeReader;exports.BrowserMultiFormatReader=BrowserMultiFormatReader;exports.BrowserPDF417Reader=BrowserPDF417Reader;exports.BrowserQRCodeReader=BrowserQRCodeReader;exports.BrowserQRCodeSvgWriter=BrowserQRCodeSvgWriter;exports.CharacterSetECI=CharacterSetECI;exports.ChecksumException=ChecksumException;exports.Code128Reader=Code128Reader;exports.Code39Reader=Code39Reader;exports.DataMatrixDecodedBitStreamParser=DecodedBitStreamParser;exports.DataMatrixReader=DataMatrixReader;exports.DecodeHintType=DecodeHintType$1;exports.DecoderResult=DecoderResult;exports.DefaultGridSampler=DefaultGridSampler;exports.DetectorResult=DetectorResult;exports.EAN13Reader=EAN13Reader;exports.EncodeHintType=EncodeHintType$1;exports.Exception=Exception;exports.FormatException=FormatException;exports.GenericGF=GenericGF;exports.GenericGFPoly=GenericGFPoly;exports.GlobalHistogramBinarizer=GlobalHistogramBinarizer;exports.GridSampler=GridSampler;exports.GridSamplerInstance=GridSamplerInstance;exports.HTMLCanvasElementLuminanceSource=HTMLCanvasElementLuminanceSource;exports.HybridBinarizer=HybridBinarizer;exports.ITFReader=ITFReader;exports.IllegalArgumentException=IllegalArgumentException;exports.IllegalStateException=IllegalStateException;exports.InvertedLuminanceSource=InvertedLuminanceSource;exports.LuminanceSource=LuminanceSource;exports.MathUtils=MathUtils;exports.MultiFormatOneDReader=MultiFormatOneDReader;exports.MultiFormatReader=MultiFormatReader;exports.MultiFormatWriter=MultiFormatWriter;exports.NotFoundException=NotFoundException;exports.OneDReader=OneDReader;exports.PDF417DecodedBitStreamParser=DecodedBitStreamParser$2;exports.PDF417DecoderErrorCorrection=ErrorCorrection;exports.PDF417Reader=PDF417Reader;exports.PDF417ResultMetadata=PDF417ResultMetadata;exports.PerspectiveTransform=PerspectiveTransform;exports.PlanarYUVLuminanceSource=PlanarYUVLuminanceSource;exports.QRCodeByteMatrix=ByteMatrix;exports.QRCodeDataMask=DataMask;exports.QRCodeDecodedBitStreamParser=DecodedBitStreamParser$1;exports.QRCodeDecoderErrorCorrectionLevel=ErrorCorrectionLevel;exports.QRCodeDecoderFormatInformation=FormatInformation;exports.QRCodeEncoder=Encoder;exports.QRCodeEncoderQRCode=QRCode;exports.QRCodeMaskUtil=MaskUtil;exports.QRCodeMatrixUtil=MatrixUtil;exports.QRCodeMode=Mode$1;exports.QRCodeReader=QRCodeReader;exports.QRCodeVersion=Version$1;exports.QRCodeWriter=QRCodeWriter;exports.RGBLuminanceSource=RGBLuminanceSource;exports.RSS14Reader=RSS14Reader;exports.RSSExpandedReader=RSSExpandedReader;exports.ReaderException=ReaderException;exports.ReedSolomonDecoder=ReedSolomonDecoder;exports.ReedSolomonEncoder=ReedSolomonEncoder;exports.ReedSolomonException=ReedSolomonException;exports.Result=Result;exports.ResultMetadataType=ResultMetadataType$1;exports.ResultPoint=ResultPoint;exports.StringUtils=StringUtils;exports.UnsupportedOperationException=UnsupportedOperationException;exports.VideoInputDevice=VideoInputDevice;exports.WhiteRectangleDetector=WhiteRectangleDetector;exports.WriterException=WriterException;exports.ZXingArrays=Arrays;exports.ZXingCharset=Charset;exports.ZXingInteger=Integer;exports.ZXingStandardCharsets=StandardCharsets;exports.ZXingStringBuilder=StringBuilder;exports.ZXingStringEncoding=StringEncoding;exports.ZXingSystem=System;exports.createAbstractExpandedDecoder=createDecoder;Object.defineProperty(exports,'__esModule',{value:true});})));;

/* /web/static/src/env.js */
odoo.define('@web/env',['@web/core/registry','@web/core/assets','@odoo/owl','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{templates}=require("@web/core/assets");const{App,EventBus}=require("@odoo/owl");const{_t}=require("@web/core/l10n/translation");__exports.makeEnv=makeEnv;function makeEnv(){return{bus:new EventBus(),services:{},debug:odoo.debug,get isSmall(){throw new Error("UI service not initialized!");},};}
const serviceRegistry=registry.category("services");const SERVICES_METADATA=__exports.SERVICES_METADATA={};let startServicesPromise=null;__exports.startServices=startServices;async function startServices(env){await Promise.resolve();const toStart=new Set();serviceRegistry.addEventListener("UPDATE",async(ev)=>{await Promise.resolve();const{operation,key:name,value:service}=ev.detail;if(operation==="delete"){return;}
if(toStart.size){const namedService=Object.assign(Object.create(service),{name});toStart.add(namedService);}else{await _startServices(env,toStart);}});await _startServices(env,toStart);}
async function _startServices(env,toStart){if(startServicesPromise){return startServicesPromise.then(()=>_startServices(env,toStart));}
const services=env.services;for(const[name,service]of serviceRegistry.getEntries()){if(!(name in services)){const namedService=Object.assign(Object.create(service),{name});toStart.add(namedService);}}
async function start(){let service=null;const proms=[];while((service=findNext())){const name=service.name;toStart.delete(service);const entries=(service.dependencies||[]).map((dep)=>[dep,services[dep]]);const dependencies=Object.fromEntries(entries);let value;try{value=service.start(env,dependencies);}catch(e){value=e;console.error(e);}
if("async"in service){SERVICES_METADATA[name]=service.async;}
if(value instanceof Promise){proms.push(new Promise((resolve)=>{value.then((val)=>{services[name]=val||null;}).catch((error)=>{services[name]=error;console.error("Can't load service '"+name+"' because:",error);}).finally(resolve);}));}else{services[service.name]=value||null;}}
await Promise.all(proms);if(proms.length){return start();}}
startServicesPromise=start();await startServicesPromise;startServicesPromise=null;if(toStart.size){const names=[...toStart].map((s)=>s.name);const missingDeps=new Set();[...toStart].forEach((s)=>s.dependencies.forEach((dep)=>{if(!(dep in services)&&!names.includes(dep)){missingDeps.add(dep);}}));const depNames=[...missingDeps].join(", ");throw new Error(`Some services could not be started: ${names}. Missing dependencies: ${depNames}`);}
function findNext(){for(const s of toStart){if(s.dependencies){if(s.dependencies.every((d)=>d in services)){return s;}}else{return s;}}
return null;}}
__exports.mountComponent=mountComponent;async function mountComponent(component,target,appConfig={}){let{env}=appConfig;const isRoot=!env;if(isRoot){env=await makeEnv();await startServices(env);}
const app=new App(component,{env,templates,dev:env.debug,warnIfNoStaticProps:true,name:component.constructor.name,translatableAttributes:["data-tooltip"],translateFn:_t,...appConfig,});const root=await app.mount(target);if(isRoot){odoo.__WOWL_DEBUG__={root};}
return app;}
return __exports;});;

/* /web/static/src/session.js */
odoo.define('@web/session',[],function(require){'use strict';let __exports={};const session=__exports.session=odoo.__session_info__||{};delete odoo.__session_info__;return __exports;});;

/* /web/static/src/core/action_swiper/action_swiper.js */
odoo.define('@web/core/action_swiper/action_swiper',['@web/core/browser/browser','@web/core/l10n/localization','@web/core/utils/numbers','@odoo/owl','@web/core/utils/concurrency'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{localization}=require("@web/core/l10n/localization");const{clamp}=require("@web/core/utils/numbers");const{Component,onMounted,onWillUnmount,useRef,useState}=require("@odoo/owl");const{Deferred}=require("@web/core/utils/concurrency");const isScrollSwipable=(scrollables)=>{return{left:!scrollables.filter((e)=>e.scrollLeft!==0).length,right:!scrollables.filter((e)=>e.scrollLeft+Math.round(e.getBoundingClientRect().width)!==e.scrollWidth).length,};};const ActionSwiper=__exports.ActionSwiper=class ActionSwiper extends Component{setup(){this.actionTimeoutId=null;this.resetTimeoutId=null;this.defaultState={containerStyle:"",isSwiping:false,width:undefined,};this.root=useRef("root");this.targetContainer=useRef("targetContainer");this.state=useState({...this.defaultState});this.scrollables=undefined;this.startX=undefined;this.swipedDistance=0;this.isScrollValidated=false;onMounted(()=>{if(this.targetContainer.el){this.state.width=this.targetContainer.el.getBoundingClientRect().width;}
if(this.props.onLeftSwipe||this.props.onRightSwipe){const classes=new Set(this.root.el.classList);classes.delete("o_actionswiper");for(const className of classes){this.targetContainer.el.firstChild.classList.add(className);this.root.el.classList.remove(className);}}});onWillUnmount(()=>{browser.clearTimeout(this.actionTimeoutId);browser.clearTimeout(this.resetTimeoutId);});}
get localizedProps(){return{onLeftSwipe:localization.direction==="rtl"?this.props.onRightSwipe:this.props.onLeftSwipe,onRightSwipe:localization.direction==="rtl"?this.props.onLeftSwipe:this.props.onRightSwipe,};}
_onTouchEndSwipe(){if(this.state.isSwiping){this.state.isSwiping=false;if(this.localizedProps.onRightSwipe&&this.swipedDistance>this.state.width/this.props.swipeDistanceRatio){this.swipedDistance=this.state.width;this.handleSwipe(this.localizedProps.onRightSwipe.action);}else if(this.localizedProps.onLeftSwipe&&this.swipedDistance<-this.state.width/this.props.swipeDistanceRatio){this.swipedDistance=-this.state.width;this.handleSwipe(this.localizedProps.onLeftSwipe.action);}else{this.state.containerStyle="";}}}
_onTouchMoveSwipe(ev){if(this.state.isSwiping){if(this.props.swipeInvalid&&this.props.swipeInvalid()){this.state.isSwiping=false;return;}
const{onLeftSwipe,onRightSwipe}=this.localizedProps;this.swipedDistance=clamp(ev.touches[0].clientX-this.startX,onLeftSwipe?-this.state.width:0,onRightSwipe?this.state.width:0);if(Math.abs(this.swipedDistance)>40){ev.preventDefault();}
if(!this.isScrollValidated&&this.scrollables&&!isScrollSwipable(this.scrollables)[this.swipedDistance>0?"left":"right"]){return this._reset();}
this.isScrollValidated=true;if(this.props.animationOnMove){this.state.containerStyle=`transform: translateX(${this.swipedDistance}px)`;}}}
_onTouchStartSwipe(ev){this.scrollables=ev.composedPath().filter((e)=>e.nodeType===1&&this.targetContainer.el.contains(e)&&e.scrollWidth>e.getBoundingClientRect().width&&["auto","scroll"].includes(window.getComputedStyle(e)["overflow-x"]));if(!this.state.width){this.state.width=this.targetContainer&&this.targetContainer.el.getBoundingClientRect().width;}
this.state.isSwiping=true;this.isScrollValidated=false;this.startX=ev.touches[0].clientX;}
_reset(){Object.assign(this.state,{...this.defaultState});this.scrollables=undefined;this.startX=undefined;this.swipedDistance=0;this.isScrollValidated=false;}
handleSwipe(action){if(this.props.animationType==="bounce"){this.state.containerStyle=`transform: translateX(${this.swipedDistance}px)`;this.actionTimeoutId=browser.setTimeout(()=>{action(Promise.resolve());this._reset();},500);}else if(this.props.animationType==="forwards"){this.state.containerStyle=`transform: translateX(${this.swipedDistance}px)`;this.actionTimeoutId=browser.setTimeout(()=>{const prom=new Deferred();action(prom);this.state.isSwiping=true;this.state.containerStyle=`transform: translateX(${-this.swipedDistance}px)`;this.resetTimeoutId=browser.setTimeout(()=>{prom.resolve();this._reset();},100);},100);}else{return action(Promise.resolve());}}}
ActionSwiper.props={onLeftSwipe:{type:Object,args:{action:Function,icon:String,bgColor:String,},optional:true,},onRightSwipe:{type:Object,args:{action:Function,icon:String,bgColor:String,},optional:true,},slots:Object,animationOnMove:{type:Boolean,optional:true},animationType:{type:String,optional:true},swipeDistanceRatio:{type:Number,optional:true},swipeInvalid:{type:Function,optional:true},};ActionSwiper.defaultProps={onLeftSwipe:undefined,onRightSwipe:undefined,animationOnMove:true,animationType:"bounce",swipeDistanceRatio:2,};ActionSwiper.template="web.ActionSwiper";return __exports;});;

/* /web/static/src/core/assets.js */
odoo.define('@web/core/assets',['@web/core/utils/functions','@web/core/browser/browser','@web/core/registry','@web/session','@odoo/owl'],function(require){'use strict';let __exports={};const{memoize}=require("@web/core/utils/functions");const{browser}=require("@web/core/browser/browser");const{registry}=require("@web/core/registry");const{session}=require("@web/session");const{Component,xml,onWillStart,App}=require("@odoo/owl");const assets=__exports.assets={retries:{count:3,delay:5000,extraDelay:2500,},};class AssetsLoadingError extends Error{}
assets.loadJS=memoize(function loadJS(url){if(document.querySelector(`script[src="${url}"]`)){return Promise.resolve();}
const scriptEl=document.createElement("script");scriptEl.type="text/javascript";scriptEl.src=url;document.head.appendChild(scriptEl);return new Promise((resolve,reject)=>{scriptEl.addEventListener("load",()=>resolve(true));scriptEl.addEventListener("error",()=>{reject(new AssetsLoadingError(`The loading of ${url} failed`));});});});assets.loadCSS=memoize(function loadCSS(url,retryCount=0){if(document.querySelector(`link[href="${url}"]`)){return Promise.resolve();}
const linkEl=document.createElement("link");linkEl.type="text/css";linkEl.rel="stylesheet";linkEl.href=url;const promise=new Promise((resolve,reject)=>{linkEl.addEventListener("load",()=>resolve(true));linkEl.addEventListener("error",async()=>{if(retryCount<assets.retries.count){await new Promise((resolve)=>setTimeout(resolve,assets.retries.delay+assets.retries.extraDelay*retryCount));linkEl.remove();loadCSS(url,retryCount+1).then(resolve).catch(reject);}else{reject(new AssetsLoadingError(`The loading of ${url} failed`));}});});document.head.appendChild(linkEl);return promise;});assets.getBundle=memoize(async function getBundle(bundleName){const url=new URL(`/web/bundle/${bundleName}`,location.origin);for(const[key,value]of Object.entries(session.bundle_params||{})){url.searchParams.set(key,value);}
const response=await browser.fetch(url.href);const json=await response.json();const assets={cssLibs:[],cssContents:[],jsLibs:[],jsContents:[],};for(const key in json){const file=json[key];if(file.type==="link"){assets.cssLibs.push(file.src);}else if(file.type==="style"){assets.cssContents.push(file.content);}else{if(file.src){assets.jsLibs.push(file.src);}else{assets.jsContents.push(file.content);}}}
return assets;});assets.loadBundle=async function loadBundle(desc){if(typeof desc==="string"){desc=await assets.getBundle(desc);}
const promiseCSS=Promise.all((desc.cssLibs||[]).map(assets.loadCSS)).then(()=>{if(desc.cssContents&&desc.cssContents.length){const style=document.createElement("style");style.textContent=desc.cssContents.join("\n");document.head.appendChild(style);}});for(const urlData of desc.jsLibs||[]){if(typeof urlData==="string"){await assets.loadJS(urlData);}else{await Promise.all(urlData.map(loadJS));}}
if(desc.jsContents&&desc.jsContents.length){const script=document.createElement("script");script.type="text/javascript";script.textContent=desc.jsContents.join("\n");document.head.appendChild(script);}
await promiseCSS;for(const bundleName of desc.assetLibs||[]){if(typeof bundleName==="string"){await assets.loadBundle(bundleName);}else{await Promise.all(bundleName.map(async(bundleName)=>{return assets.loadBundle(bundleName);}));}}
odoo.loader.checkAndReportErrors();};const loadJS=__exports.loadJS=function(url){return assets.loadJS(url);};const loadCSS=__exports.loadCSS=function(url){return assets.loadCSS(url);};const getBundle=__exports.getBundle=function(bundleName){return assets.getBundle(bundleName);};const loadBundle=__exports.loadBundle=function(desc){return assets.loadBundle(desc);};const templates=__exports.templates=new DOMParser().parseFromString("<odoo/>","text/xml");registry.category("xml_templates").addEventListener("UPDATE",(ev)=>{const{operation,value}=ev.detail;if(operation==="add"){const doc=new DOMParser().parseFromString(value,"text/xml");if(doc.querySelector("parsererror")){let strError="";const nodes=doc.querySelectorAll("parsererror");for(const node of nodes){strError+=node.textContent.trim()+"\n";}
throw new Error(strError);}
for(const element of doc.querySelectorAll("templates > [t-name]")){templates.documentElement.appendChild(element);}
for(const app of App.apps){app.addTemplates(templates,app);}}});const LazyComponent=__exports.LazyComponent=class LazyComponent extends Component{setup(){onWillStart(async()=>{await loadBundle(this.props.bundle);this.Component=registry.category("lazy_components").get(this.props.Component);});}}
LazyComponent.template=xml`<t t-component="Component" t-props="props.props"/>`;LazyComponent.props={Component:String,bundle:String,props:{type:Object,optional:true},};return __exports;});;

/* /web/static/src/core/autocomplete/autocomplete.js */
odoo.define('@web/core/autocomplete/autocomplete',['@web/core/utils/concurrency','@web/core/utils/hooks','@web/core/utils/timing','@web/core/hotkeys/hotkey_service','@web/core/position_hook','@odoo/owl'],function(require){'use strict';let __exports={};const{Deferred}=require("@web/core/utils/concurrency");const{useAutofocus,useForwardRefToParent,useService}=require("@web/core/utils/hooks");const{useDebounced}=require("@web/core/utils/timing");const{getActiveHotkey}=require("@web/core/hotkeys/hotkey_service");const{usePosition}=require("@web/core/position_hook");const{Component,onWillUpdateProps,useExternalListener,useRef,useState}=require("@odoo/owl");const AutoComplete=__exports.AutoComplete=class AutoComplete extends Component{setup(){this.nextSourceId=0;this.nextOptionId=0;this.sources=[];this.inEdition=false;this.state=useState({navigationRev:0,optionsRev:0,open:false,activeSourceOption:null,value:this.props.value,});this.inputRef=useForwardRefToParent("input");if(this.props.autofocus){useAutofocus({refName:"input"});}
this.root=useRef("root");this.debouncedProcessInput=useDebounced(async()=>{const currentPromise=this.pendingPromise;this.pendingPromise=null;this.props.onInput({inputValue:this.inputRef.el.value,});try{await this.open(true);currentPromise.resolve();}catch{currentPromise.reject();}finally{if(currentPromise===this.loadingPromise){this.loadingPromise=null;}}},this.constructor.timeout);useExternalListener(window,"scroll",this.externalClose,true);useExternalListener(window,"pointerdown",this.externalClose,true);this.hotkey=useService("hotkey");this.hotkeysToRemove=[];onWillUpdateProps((nextProps)=>{if(this.props.value!==nextProps.value||this.forceValFromProp){this.forceValFromProp=false;if(!this.inEdition){this.state.value=nextProps.value;this.inputRef.el.value=nextProps.value;}
this.close();}});if(this.props.dropdown){usePosition("sourcesList",()=>this.targetDropdown,this.dropdownOptions);}else{this.open(false);}}
get targetDropdown(){return this.inputRef.el;}
get activeSourceOptionId(){if(!this.isOpened||!this.state.activeSourceOption){return undefined;}
const[sourceIndex,optionIndex]=this.state.activeSourceOption;const source=this.sources[sourceIndex];return`${this.props.id || "autocomplete"}_${sourceIndex}_${source.isLoading ? "loading" : optionIndex}`;}
get dropdownOptions(){return{position:"bottom-start",};}
get isOpened(){return this.state.open;}
get hasOptions(){for(const source of this.sources){if(source.isLoading||source.options.length){return true;}}
return false;}
open(useInput=false){this.state.open=true;return this.loadSources(useInput);}
close(){this.state.open=false;this.state.activeSourceOption=null;}
cancel(){if(this.inputRef.el.value.length){if(this.props.autoSelect){this.inputRef.el.value=this.props.value;this.props.onCancel();}}
this.close();}
async loadSources(useInput){this.sources=[];this.state.activeSourceOption=null;const proms=[];for(const pSource of this.props.sources){const source=this.makeSource(pSource);this.sources.push(source);const options=this.loadOptions(pSource.options,useInput?this.inputRef.el.value.trim():"");if(options instanceof Promise){source.isLoading=true;const prom=options.then((options)=>{source.options=options.map((option)=>this.makeOption(option));source.isLoading=false;this.state.optionsRev++;});proms.push(prom);}else{source.options=options.map((option)=>this.makeOption(option));}}
await Promise.all(proms);this.navigate(0);}
get displayOptions(){return!this.props.dropdown||(this.isOpened&&this.hasOptions);}
loadOptions(options,request){if(typeof options==="function"){return options(request);}else{return options;}}
makeOption(option){return Object.assign(Object.create(option),{id:++this.nextOptionId,});}
makeSource(source){return{id:++this.nextSourceId,options:[],isLoading:false,placeholder:source.placeholder,optionTemplate:source.optionTemplate,};}
isActiveSourceOption([sourceIndex,optionIndex]){return(this.state.activeSourceOption&&this.state.activeSourceOption[0]===sourceIndex&&this.state.activeSourceOption[1]===optionIndex);}
selectOption(indices,params={}){const option=this.sources[indices[0]].options[indices[1]];this.inEdition=false;if(option.unselectable){this.inputRef.el.value="";this.close();return;}
if(this.props.resetOnSelect){this.inputRef.el.value="";}
this.forceValFromProp=true;this.props.onSelect(option,{...params,input:this.inputRef.el,});this.close();}
navigate(direction){let step=Math.sign(direction);if(!step){this.state.activeSourceOption=null;step=1;}else{this.state.navigationRev++;}
if(this.state.activeSourceOption){let[sourceIndex,optionIndex]=this.state.activeSourceOption;let source=this.sources[sourceIndex];optionIndex+=step;if(0>optionIndex||optionIndex>=source.options.length){sourceIndex+=step;source=this.sources[sourceIndex];while(source&&source.isLoading){sourceIndex+=step;source=this.sources[sourceIndex];}
if(source){optionIndex=step<0?source.options.length-1:0;}}
this.state.activeSourceOption=source?[sourceIndex,optionIndex]:null;}else{let sourceIndex=step<0?this.sources.length-1:0;let source=this.sources[sourceIndex];while(source&&source.isLoading){sourceIndex+=step;source=this.sources[sourceIndex];}
if(source){const optionIndex=step<0?source.options.length-1:0;if(optionIndex<source.options.length){this.state.activeSourceOption=[sourceIndex,optionIndex];}}}}
onInputBlur(){if(this.ignoreBlur){this.ignoreBlur=false;return;}
this.props.onBlur({inputValue:this.inputRef.el.value,});this.inEdition=false;}
onInputClick(){if(!this.isOpened){this.open(this.inputRef.el.value.trim()!==this.props.value);}else{this.close();}}
onInputChange(ev){if(this.ignoreBlur){ev.stopImmediatePropagation();}
this.props.onChange({inputValue:this.inputRef.el.value,});}
async onInput(){this.inEdition=true;this.pendingPromise=this.pendingPromise||new Deferred();this.loadingPromise=this.pendingPromise;this.debouncedProcessInput();}
onInputFocus(ev){this.inputRef.el.setSelectionRange(0,this.inputRef.el.value.length);this.props.onFocus(ev);}
get autoCompleteRootClass(){let classList="";if(this.props.class){classList+=this.props.class;}
if(this.props.dropdown){classList+=" dropdown";}
return classList;}
get ulDropdownClass(){let classList="";if(this.props.dropdown){classList+=" dropdown-menu ui-autocomplete";}else{classList+=" list-group";}
return classList;}
async onInputKeydown(ev){const hotkey=getActiveHotkey(ev);const isSelectKey=hotkey==="enter"||hotkey==="tab";if(this.loadingPromise&&isSelectKey){if(hotkey==="enter"){ev.stopPropagation();ev.preventDefault();}
await this.loadingPromise;}
switch(hotkey){case"enter":if(!this.isOpened||!this.state.activeSourceOption){return;}
this.selectOption(this.state.activeSourceOption);break;case"escape":if(!this.isOpened){return;}
this.cancel();break;case"tab":if(!this.isOpened){return;}
if(this.props.autoSelect&&this.state.activeSourceOption&&(this.state.navigationRev>0||this.inputRef.el.value.length>0)){this.selectOption(this.state.activeSourceOption);}
this.close();return;case"arrowup":this.navigate(-1);if(!this.isOpened){this.open(true);}
break;case"arrowdown":this.navigate(+1);if(!this.isOpened){this.open(true);}
break;default:return;}
ev.stopPropagation();ev.preventDefault();}
onOptionMouseEnter(indices){this.state.activeSourceOption=indices;}
onOptionMouseLeave(){this.state.activeSourceOption=null;}
onOptionClick(indices){this.selectOption(indices);this.inputRef.el.focus();}
externalClose(ev){if(this.isOpened&&!this.root.el.contains(ev.target)){this.cancel();}}}
Object.assign(AutoComplete,{template:"web.AutoComplete",props:{value:{type:String,optional:true},id:{type:String,optional:true},onSelect:{type:Function},sources:{type:Array,element:{type:Object,shape:{placeholder:{type:String,optional:true},optionTemplate:{type:String,optional:true},options:[Array,Function],},},},placeholder:{type:String,optional:true},autoSelect:{type:Boolean,optional:true},resetOnSelect:{type:Boolean,optional:true},onCancel:{type:Function,optional:true},onInput:{type:Function,optional:true},onChange:{type:Function,optional:true},onBlur:{type:Function,optional:true},onFocus:{type:Function,optional:true},input:{type:Function,optional:true},dropdown:{type:Boolean,optional:true},autofocus:{type:Boolean,optional:true},class:{type:String,optional:true},},defaultProps:{value:"",placeholder:"",autoSelect:false,dropdown:true,onCancel:()=>{},onInput:()=>{},onChange:()=>{},onBlur:()=>{},onFocus:()=>{},},timeout:250,});return __exports;});;

/* /web/static/src/core/browser/browser.js */
odoo.define('@web/core/browser/browser',[],function(require){'use strict';let __exports={};let sessionStorage=window.sessionStorage;let localStorage=window.localStorage;try{localStorage.setItem("__localStorage__","true");localStorage.removeItem("__localStorage__");}catch{localStorage=makeRAMLocalStorage();sessionStorage=makeRAMLocalStorage();}
const browser=__exports.browser={addEventListener:window.addEventListener.bind(window),dispatchEvent:window.dispatchEvent.bind(window),AnalyserNode:window.AnalyserNode,Audio:window.Audio,AudioBufferSourceNode:window.AudioBufferSourceNode,AudioContext:window.AudioContext,AudioWorkletNode:window.AudioWorkletNode,BeforeInstallPromptEvent:window.BeforeInstallPromptEvent?.bind(window),GainNode:window.GainNode,MediaStreamAudioSourceNode:window.MediaStreamAudioSourceNode,removeEventListener:window.removeEventListener.bind(window),setTimeout:window.setTimeout.bind(window),clearTimeout:window.clearTimeout.bind(window),setInterval:window.setInterval.bind(window),clearInterval:window.clearInterval.bind(window),performance:window.performance,requestAnimationFrame:window.requestAnimationFrame.bind(window),cancelAnimationFrame:window.cancelAnimationFrame.bind(window),console:window.console,history:window.history,matchMedia:window.matchMedia.bind(window),navigator,Notification:window.Notification,open:window.open.bind(window),SharedWorker:window.SharedWorker,Worker:window.Worker,XMLHttpRequest:window.XMLHttpRequest,localStorage,sessionStorage,fetch:window.fetch.bind(window),innerHeight:window.innerHeight,innerWidth:window.innerWidth,ontouchstart:window.ontouchstart,BroadcastChannel:window.BroadcastChannel,};Object.defineProperty(browser,"location",{set(val){window.location=val;},get(){return window.location;},configurable:true,});Object.defineProperty(browser,"innerHeight",{get:()=>window.innerHeight,configurable:true,});Object.defineProperty(browser,"innerWidth",{get:()=>window.innerWidth,configurable:true,});__exports.makeRAMLocalStorage=makeRAMLocalStorage;function makeRAMLocalStorage(){let store={};return{setItem(key,value){const newValue=String(value);store[key]=newValue;window.dispatchEvent(new StorageEvent("storage",{key,newValue}));},getItem(key){return store[key];},clear(){store={};},removeItem(key){delete store[key];window.dispatchEvent(new StorageEvent("storage",{key,newValue:null}));},get length(){return Object.keys(store).length;},key(){return"";},};}
return __exports;});;

/* /web/static/src/core/browser/cookie.js */
odoo.define('@web/core/browser/cookie',[],function(require){'use strict';let __exports={};const COOKIE_TTL=24*60*60*365;const cookie=__exports.cookie={get _cookieMonster(){return document.cookie;},set _cookieMonster(value){document.cookie=value;},get(str){const parts=this._cookieMonster.split("; ");for(const part of parts){const[key,value]=part.split(/=(.*)/);if(key===str){return value||"";}}},set(key,value,ttl=COOKIE_TTL){let fullCookie=[];if(value!==undefined){fullCookie.push(`${key}=${value}`);}
fullCookie=fullCookie.concat(["path=/",`max-age=${ttl}`]);this._cookieMonster=fullCookie.join("; ");},delete(key){this.set(key,"kill",0);},};return __exports;});;

/* /web/static/src/core/browser/feature_detection.js */
odoo.define('@web/core/browser/feature_detection',['@web/core/browser/browser'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");__exports.isBrowserChrome=isBrowserChrome;function isBrowserChrome(){return/Chrome/i.test(browser.navigator.userAgent);}
__exports.isBrowserFirefox=isBrowserFirefox;function isBrowserFirefox(){return/Firefox/i.test(browser.navigator.userAgent);}
__exports.isBrowserSafari=isBrowserSafari;function isBrowserSafari(){return!isBrowserChrome()&&browser.navigator.userAgent.includes("Safari");}
__exports.isAndroid=isAndroid;function isAndroid(){return/Android/i.test(browser.navigator.userAgent);}
__exports.isIOS=isIOS;function isIOS(){return(/(iPad|iPhone|iPod)/i.test(browser.navigator.userAgent)||(browser.navigator.platform==="MacIntel"&&maxTouchPoints()>1));}
__exports.isOtherMobileOS=isOtherMobileOS;function isOtherMobileOS(){return/(webOS|BlackBerry|Windows Phone)/i.test(browser.navigator.userAgent);}
__exports.isMacOS=isMacOS;function isMacOS(){return/Mac/i.test(browser.navigator.userAgent);}
__exports.isMobileOS=isMobileOS;function isMobileOS(){return isAndroid()||isIOS()||isOtherMobileOS();}
__exports.isIosApp=isIosApp;function isIosApp(){return/OdooMobile \(iOS\)/i.test(browser.navigator.userAgent);}
__exports.isAndroidApp=isAndroidApp;function isAndroidApp(){return/OdooMobile.+Android/i.test(browser.navigator.userAgent);}
__exports.isDisplayStandalone=isDisplayStandalone;function isDisplayStandalone(){return browser.matchMedia("(display-mode: standalone)").matches;}
__exports.hasTouch=hasTouch;function hasTouch(){return browser.ontouchstart!==undefined||browser.matchMedia("(pointer:coarse)").matches;}
__exports.maxTouchPoints=maxTouchPoints;function maxTouchPoints(){return browser.navigator.maxTouchPoints||1;}
return __exports;});;

/* /web/static/src/core/browser/router_service.js */
odoo.define('@web/core/browser/router_service',['@web/core/registry','@web/core/utils/objects','@web/core/utils/urls','@web/core/browser/browser'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{shallowEqual}=require("@web/core/utils/objects");const{objectToUrlEncodedString}=require("@web/core/utils/urls");const{browser}=require("@web/core/browser/browser");function cast(value){return!value||isNaN(value)?value:Number(value);}
function parseString(str){const parts=str.split("&");const result={};for(const part of parts){const[key,value]=part.split("=");const decoded=decodeURIComponent(value||"");result[key]=cast(decoded);}
return result;}
function applyLocking(lockedKeys,hash,currentHash,options={}){const newHash={};for(const key in hash){if("lock"in options){options.lock?lockedKeys.add(key):lockedKeys.delete(key);}else if(lockedKeys.has(key)){continue;}
newHash[key]=hash[key];}
for(const key in currentHash){if(lockedKeys.has(key)&&!(key in newHash)){newHash[key]=currentHash[key];}}
return newHash;}
function computeNewRoute(hash,replace,currentRoute){if(!replace){hash=Object.assign({},currentRoute.hash,hash);}
hash=sanitizeHash(hash);if(!shallowEqual(currentRoute.hash,hash)){return Object.assign({},currentRoute,{hash});}
return false;}
function sanitizeHash(hash){return Object.fromEntries(Object.entries(hash).filter(([,v])=>v!==undefined).map(([k,v])=>[k,cast(v)]));}
__exports.parseHash=parseHash;function parseHash(hash){return hash&&hash!=="#"?parseString(hash.slice(1)):{};}
__exports.parseSearchQuery=parseSearchQuery;function parseSearchQuery(search){return search?parseString(search.slice(1)):{};}
__exports.routeToUrl=routeToUrl;function routeToUrl(route){const search=objectToUrlEncodedString(route.search);const hash=objectToUrlEncodedString(route.hash);return route.pathname+(search?"?"+search:"")+(hash?"#"+hash:"");}
function getRoute(urlObj){const{pathname,search,hash}=urlObj;const searchQuery=parseSearchQuery(search);const hashQuery=parseHash(hash);return{pathname,search:searchQuery,hash:hashQuery};}
function makeRouter(env){const bus=env.bus;const lockedKeys=new Set();let current=getRoute(browser.location);let pushTimeout;browser.addEventListener("hashchange",(ev)=>{browser.clearTimeout(pushTimeout);const loc=new URL(ev.newURL);current=getRoute(loc);bus.trigger("ROUTE_CHANGE");});function makeDebouncedPush(mode){let allPushArgs=[];function doPush(){const replace=allPushArgs.some(([,options])=>options&&options.replace);const newHash=allPushArgs.reduce((finalHash,[hash,options])=>{hash=applyLocking(lockedKeys,hash,current.hash,options);if(finalHash){hash=applyLocking(lockedKeys,hash,finalHash,options);}
return Object.assign(finalHash||{},hash);},null);const newRoute=computeNewRoute(newHash,replace,current);if(!newRoute){return;}
const url=browser.location.origin+routeToUrl(newRoute);if(mode==="push"){browser.history.pushState({},"",url);}else{browser.history.replaceState({},"",url);}
current=getRoute(browser.location);}
return function pushOrReplaceState(hash,options){allPushArgs.push([hash,options]);browser.clearTimeout(pushTimeout);pushTimeout=browser.setTimeout(()=>{doPush();pushTimeout=null;allPushArgs=[];});};}
return{get current(){return current;},pushState:makeDebouncedPush("push"),replaceState:makeDebouncedPush("replace"),cancelPushes:()=>browser.clearTimeout(pushTimeout),};}
const routerService=__exports.routerService={start(env){return makeRouter(env);},};__exports.objectToQuery=objectToQuery;function objectToQuery(obj){const query={};Object.entries(obj).forEach(([k,v])=>{query[k]=v?String(v):v;});return query;}
registry.category("services").add("router",routerService);return __exports;});;

/* /web/static/src/core/browser/title_service.js */
odoo.define('@web/core/browser/title_service',['@web/core/registry'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const titleService=__exports.titleService={start(){const titleParts={};function getParts(){return Object.assign({},titleParts);}
function setParts(parts){for(const key in parts){const val=parts[key];if(!val){delete titleParts[key];}else{titleParts[key]=val;}}
document.title=Object.values(titleParts).join(" - ");}
return{get current(){return document.title;},getParts,setParts,};},};registry.category("services").add("title",titleService);return __exports;});;

/* /web/static/src/core/checkbox/checkbox.js */
odoo.define('@web/core/checkbox/checkbox',['@web/core/hotkeys/hotkey_hook','@odoo/owl'],function(require){'use strict';let __exports={};const{useHotkey}=require("@web/core/hotkeys/hotkey_hook");const{Component,useRef}=require("@odoo/owl");const CheckBox=__exports.CheckBox=class CheckBox extends Component{setup(){this.id=`checkbox-comp-${CheckBox.nextId++}`;this.rootRef=useRef("root");useHotkey("Enter",({area})=>{const oldValue=area.querySelector("input").checked;this.props.onChange(!oldValue);},{area:()=>this.rootRef.el,bypassEditableProtection:true});}
onClick(ev){if(ev.composedPath().find((el)=>["INPUT","LABEL"].includes(el.tagName))){ev.stopPropagation();return;}
const input=this.rootRef.el.querySelector("input");input.focus();if(!this.props.disabled){ev.stopPropagation();input.checked=!input.checked;this.props.onChange(input.checked);}}
onChange(ev){if(!this.props.disabled){this.props.onChange(ev.target.checked);}}}
CheckBox.template="web.CheckBox";CheckBox.nextId=1;CheckBox.defaultProps={onChange:()=>{},};CheckBox.props={id:{type:true,optional:true,},disabled:{type:Boolean,optional:true,},value:{type:Boolean,optional:true,},slots:{type:Object,optional:true,},onChange:{type:Function,optional:true,},className:{type:String,optional:true,},name:{type:String,optional:true,},};return __exports;});;

/* /web/static/src/core/code_editor/code_editor.js */
odoo.define('@web/core/code_editor/code_editor',['@odoo/owl','@web/core/assets','@web/core/utils/timing'],function(require){'use strict';let __exports={};const{Component,onWillDestroy,onWillStart,useEffect,useRef}=require("@odoo/owl");const{loadBundle}=require("@web/core/assets");const{useDebounced}=require("@web/core/utils/timing");function onResized(ref,callback){const _ref=typeof ref==="string"?useRef(ref):ref;const resizeObserver=new ResizeObserver(callback);useEffect((el)=>{if(el){resizeObserver.observe(el);return()=>resizeObserver.unobserve(el);}},()=>[_ref.el]);onWillDestroy(()=>{resizeObserver.disconnect();});}
const CodeEditor=__exports.CodeEditor=class CodeEditor extends Component{static template="web.CodeEditor";static components={};static props={mode:{type:String,optional:true,validate:(mode)=>CodeEditor.MODES.includes(mode),},value:{validate:(v)=>typeof v==="string",optional:true},readonly:{type:Boolean,optional:true},onChange:{type:Function,optional:true},onBlur:{type:Function,optional:true},class:{type:String,optional:true},theme:{type:String,optional:true,validate:(theme)=>CodeEditor.THEMES.includes(theme),},maxLines:{type:Number,optional:true},sessionId:{type:[Number,String],optional:true},};static defaultProps={readonly:false,value:"",onChange:()=>{},class:"",theme:"",sessionId:1,};static MODES=["js","xml","qweb","scss","python"];static THEMES=["","monokai"];setup(){this.editorRef=useRef("editorRef");onWillStart(async()=>await loadBundle("web.ace_lib"));const sessions={};let ignoredAceChange=false;useEffect((el)=>{if(!el){return;}
const aceEditor=window.ace.edit(el);this.aceEditor=aceEditor;this.aceEditor.setOptions({maxLines:this.props.maxLines,showPrintMargin:false,useWorker:false,});this.aceEditor.$blockScrolling=true;const session=aceEditor.getSession();if(!sessions[this.props.sessionId]){sessions[this.props.sessionId]=session;}
session.setValue(this.props.value);session.on("change",()=>{if(this.props.onChange&&!ignoredAceChange){this.props.onChange(this.aceEditor.getValue());}});this.aceEditor.on("blur",()=>{if(this.props.onBlur){this.props.onBlur();}});return()=>{aceEditor.destroy();};},()=>[this.editorRef.el]);useEffect((theme)=>this.aceEditor.setTheme(theme?`ace/theme/${theme}`:""),()=>[this.props.theme]);useEffect((readonly)=>{this.aceEditor.setOptions({readOnly:readonly,highlightActiveLine:!readonly,highlightGutterLine:!readonly,});this.aceEditor.renderer.setOptions({displayIndentGuides:!readonly,showGutter:!readonly,});this.aceEditor.renderer.$cursorLayer.element.style.display=readonly?"none":"block";},()=>[this.props.readonly]);useEffect((sessionId,mode,value)=>{let session=sessions[sessionId];if(session){if(session.getValue()!==value){ignoredAceChange=true;session.setValue(value);ignoredAceChange=false;}}else{session=new window.ace.EditSession(value);session.setUndoManager(new window.ace.UndoManager());session.setOptions({useWorker:false,tabSize:2,useSoftTabs:true,});session.on("change",()=>{if(this.props.onChange&&!ignoredAceChange){this.props.onChange(this.aceEditor.getValue());}});sessions[sessionId]=session;}
session.setMode(mode?`ace/mode/${mode}`:"");this.aceEditor.setSession(session);},()=>[this.props.sessionId,this.props.mode,this.props.value]);const debouncedResize=useDebounced(()=>{if(this.aceEditor){this.aceEditor.resize();}},250);onResized(this.editorRef,debouncedResize);}}
return __exports;});;

/* /web/static/src/core/colorlist/colorlist.js */
odoo.define('@web/core/colorlist/colorlist',['@web/core/l10n/translation','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{Component,useRef,useState,useExternalListener}=require("@odoo/owl");const ColorList=__exports.ColorList=class ColorList extends Component{setup(){this.colorlistRef=useRef("colorlist");this.state=useState({isExpanded:this.props.isExpanded});useExternalListener(window,"click",this.onOutsideClick);}
get colors(){return this.constructor.COLORS;}
onColorSelected(id){this.props.onColorSelected(id);if(!this.props.forceExpanded){this.state.isExpanded=false;}}
onOutsideClick(ev){if(this.colorlistRef.el.contains(ev.target)||this.props.forceExpanded){return;}
this.state.isExpanded=false;}
onToggle(ev){if(this.props.canToggle){ev.preventDefault();ev.stopPropagation();this.state.isExpanded=!this.state.isExpanded;this.colorlistRef.el.firstElementChild.focus();}}}
ColorList.COLORS=[_t("No color"),_t("Red"),_t("Orange"),_t("Yellow"),_t("Cyan"),_t("Purple"),_t("Almond"),_t("Teal"),_t("Blue"),_t("Raspberry"),_t("Green"),_t("Violet"),];ColorList.template="web.ColorList";ColorList.defaultProps={forceExpanded:false,isExpanded:false,};ColorList.props={canToggle:{type:Boolean,optional:true},colors:Array,forceExpanded:{type:Boolean,optional:true},isExpanded:{type:Boolean,optional:true},onColorSelected:Function,selectedColor:{type:Number,optional:true},};return __exports;});;

/* /web/static/src/core/colorpicker/colorpicker.js */
odoo.define('@web/core/colorpicker/colorpicker',['@web/core/utils/colors','@web/core/utils/functions','@web/core/utils/numbers','@web/core/utils/timing','@odoo/owl'],function(require){'use strict';let __exports={};const{convertCSSColorToRgba,convertRgbaToCSSColor,convertRgbToHsl,convertHslToRgb,}=require("@web/core/utils/colors");const{uniqueId}=require("@web/core/utils/functions");const{clamp}=require("@web/core/utils/numbers");const{throttleForAnimation}=require("@web/core/utils/timing");const{Component,useRef,onWillStart,onMounted,onWillUpdateProps,onWillDestroy,}=require("@odoo/owl");const Colorpicker=__exports.Colorpicker=class Colorpicker extends Component{static template="web.Colorpicker";static props={document:{type:true,optional:true},defaultColor:{type:String,optional:true},selectedColor:{type:String,optional:true},noTransparency:{type:Boolean,optional:true},colorPreview:{type:Boolean,optional:true},stopClickPropagation:{type:Boolean,optional:true},onColorSelect:{type:Function,optional:true},onColorPreview:{type:Function,optional:true},onInputEnter:{type:Function,optional:true},};static defaultProps={document:window.document,defaultColor:"#FF0000",noTransparency:false,colorPreview:false,stopClickPropagation:false,onColorSelect:()=>{},onColorPreview:()=>{},onInputEnter:()=>{},};elRef=useRef("el");setup(){onWillStart(()=>{this.init();});onMounted(async()=>{if(!this.elRef.el){await new Promise((resolve)=>{const observer=new MutationObserver(()=>{if(this.elRef.el){observer.disconnect();resolve();}});observer.observe(document.body,{childList:true,subtree:true});});}
this.el=this.elRef.el;this.$el=$(this.el);this.$el.on("click",this._onClick.bind(this));this.$el.on("keypress",this._onKeypress.bind(this));this.$el.on("mousedown",".o_color_pick_area",this._onMouseDownPicker.bind(this));this.$el.on("mousedown",".o_color_slider",this._onMouseDownSlider.bind(this));this.$el.on("mousedown",".o_opacity_slider",this._onMouseDownOpacitySlider.bind(this));this.$el.on("change",".o_color_picker_inputs",this._onChangeInputs.bind(this));this.start();});onWillUpdateProps((newProps)=>{if(!this.el){return;}
if(newProps.selectedColor){this.setSelectedColor(newProps.selectedColor);}});onWillDestroy(()=>{this.destroy();});}
init(){this.pickerFlag=false;this.sliderFlag=false;this.opacitySliderFlag=false;this.colorComponents={};this.uniqueId=uniqueId("colorpicker");this.selectedHexValue="";}
start(){this.$colorpickerArea=this.$el.find(".o_color_pick_area");this.$colorpickerPointer=this.$el.find(".o_picker_pointer");this.$colorSlider=this.$el.find(".o_color_slider");this.$colorSliderPointer=this.$el.find(".o_slider_pointer");this.$opacitySlider=this.$el.find(".o_opacity_slider");this.$opacitySliderPointer=this.$el.find(".o_opacity_pointer");const rgba=convertCSSColorToRgba(this.props.defaultColor);if(rgba){this._updateRgba(rgba.red,rgba.green,rgba.blue,rgba.opacity);}
Object.entries(this.colorComponents).forEach(([component,value])=>{const input=this.el.querySelector(`.o_${component}_input`);if(input){input.value=value;}});const resizeObserver=new window.ResizeObserver(()=>{this._updateUI();});resizeObserver.observe(this.el);this.$documents=$([window.top,...Array.from(window.top.frames).filter((frame)=>{try{const document=frame.document;return!!document;}catch{return false;}}),].map((w)=>w.document));this.throttleOnMouseMove=throttleForAnimation((ev)=>{this._onMouseMovePicker(ev);this._onMouseMoveSlider(ev);this._onMouseMoveOpacitySlider(ev);});this.$documents.on(`mousemove.${this.uniqueId}`,this.throttleOnMouseMove);this.$documents.on(`mouseup.${this.uniqueId}`,()=>{if(this.pickerFlag||this.sliderFlag||this.opacitySliderFlag){this._colorSelected();}
this.pickerFlag=false;this.sliderFlag=false;this.opacitySliderFlag=false;});this.previewActive=true;}
destroy(){if(this.throttleOnMouseMove){this.$documents.off(`.${this.uniqueId}`);this.throttleOnMouseMove.cancel();}}
setSelectedColor(color){const rgba=convertCSSColorToRgba(color);if(rgba){const oldPreviewActive=this.previewActive;this.previewActive=false;this._updateRgba(rgba.red,rgba.green,rgba.blue,rgba.opacity);this.previewActive=oldPreviewActive;this._updateUI();}}
_updateUI(){for(const[color,value]of Object.entries(this.colorComponents)){this.$el.find(`.o_${color}_input`).val(value);}
this.$el.find(".o_color_preview").css("background-color",this.colorComponents.cssColor);this.$colorpickerArea.css("background-color",`hsl(${this.colorComponents.hue}, 100%, 50%)`);const top=((100-this.colorComponents.lightness)*this.$colorpickerArea.height())/100;const left=(this.colorComponents.saturation*this.$colorpickerArea.width())/100;this.$colorpickerPointer.css({top:top-5+"px",left:left-5+"px",});const height=this.$colorSlider.height();const y=(this.colorComponents.hue*height)/360;this.$colorSliderPointer.css("top",Math.round(y-2));if(!this.props.noTransparency){const heightOpacity=this.$opacitySlider.height();const z=heightOpacity*(1-this.colorComponents.opacity/100.0);this.$opacitySliderPointer.css("top",Math.round(z-2));this.$opacitySlider.css("background","linear-gradient("+this.colorComponents.hex+" 0%, transparent 100%)");}}
_updateHex(hex){const rgb=convertCSSColorToRgba(hex);if(!rgb){return;}
Object.assign(this.colorComponents,{hex:hex},rgb,convertRgbToHsl(rgb.red,rgb.green,rgb.blue));this._updateCssColor();}
_updateRgba(r,g,b,a){const opacity=a||this.colorComponents.opacity;if(opacity<0.1&&(r>0.1||g>0.1||b>0.1)){a=100;}
const hex=convertRgbaToCSSColor(r,g,b);if(!hex){return;}
Object.assign(this.colorComponents,{red:r,green:g,blue:b},a===undefined?{}:{opacity:a},{hex:hex},convertRgbToHsl(r,g,b));this._updateCssColor();}
_updateHsl(h,s,l){let a=this.colorComponents.opacity;if(a<0.1&&l>0.1){a=100;}
const rgb=convertHslToRgb(h,s,l);if(!rgb){return;}
const hex=convertRgbaToCSSColor(rgb.red,rgb.green,rgb.blue);Object.assign(this.colorComponents,{hue:h,saturation:s,lightness:l},rgb,{hex:hex},{opacity:a});this._updateCssColor();}
_updateOpacity(a){if(a<0||a>100){return;}
Object.assign(this.colorComponents,{opacity:a});this._updateCssColor();}
_colorSelected(){this.props.onColorSelect(this.colorComponents);}
_updateCssColor(){const r=this.colorComponents.red;const g=this.colorComponents.green;const b=this.colorComponents.blue;const a=this.colorComponents.opacity;Object.assign(this.colorComponents,{cssColor:convertRgbaToCSSColor(r,g,b,a)});if(this.previewActive){this.props.onColorPreview(this.colorComponents);}}
_onKeypress(ev){if(ev.key==="Enter"){if(ev.target.tagName==="INPUT"){this._onChangeInputs(ev);}
ev.preventDefault();this.props.onInputEnter(ev);}}
_onClick(ev){if(this.props.stopClickPropagation){ev.stopPropagation();}
ev.originalEvent.__isColorpickerClick=true;$(ev.target).find("> .o_opacity_pointer, > .o_slider_pointer, > .o_picker_pointer").addBack(".o_opacity_pointer, .o_slider_pointer, .o_picker_pointer").focus();if(ev.target.dataset.colorMethod==="hex"&&!this.selectedHexValue){ev.target.select();this.selectedHexValue=ev.target.value;return;}
this.selectedHexValue="";}
_onMouseDownPicker(ev){this.pickerFlag=true;ev.preventDefault();this._onMouseMovePicker(ev);}
_onMouseMovePicker(ev){if(!this.pickerFlag){return;}
const offset=this.$colorpickerArea.offset();const top=ev.pageY-offset.top;const left=ev.pageX-offset.left;let saturation=Math.round((100*left)/this.$colorpickerArea.width());let lightness=Math.round((100*(this.$colorpickerArea.height()-top))/this.$colorpickerArea.height());saturation=clamp(saturation,0,100);lightness=clamp(lightness,0,100);this._updateHsl(this.colorComponents.hue,saturation,lightness);this._updateUI();}
_onMouseDownSlider(ev){this.sliderFlag=true;ev.preventDefault();this._onMouseMoveSlider(ev);}
_onMouseMoveSlider(ev){if(!this.sliderFlag){return;}
const y=ev.pageY-this.$colorSlider.offset().top;let hue=Math.round((360*y)/this.$colorSlider.height());hue=clamp(hue,0,360);this._updateHsl(hue,this.colorComponents.saturation,this.colorComponents.lightness);this._updateUI();}
_onMouseDownOpacitySlider(ev){this.opacitySliderFlag=true;ev.preventDefault();this._onMouseMoveOpacitySlider(ev);}
_onMouseMoveOpacitySlider(ev){if(!this.opacitySliderFlag||this.props.noTransparency){return;}
const y=ev.pageY-this.$opacitySlider.offset().top;let opacity=Math.round(100*(1-y/this.$opacitySlider.height()));opacity=clamp(opacity,0,100);this._updateOpacity(opacity);this._updateUI();}
_onChangeInputs(ev){switch($(ev.target).data("colorMethod")){case"hex":return;case"rgb":this._updateRgba(parseInt(this.$el.find(".o_red_input").val()),parseInt(this.$el.find(".o_green_input").val()),parseInt(this.$el.find(".o_blue_input").val()));break;case"hsl":this._updateHsl(parseInt(this.$el.find(".o_hue_input").val()),parseInt(this.$el.find(".o_saturation_input").val()),parseInt(this.$el.find(".o_lightness_input").val()));break;case"opacity":this._updateOpacity(parseInt(this.$el.find(".o_opacity_input").val()));break;}
this._updateUI();this._colorSelected();}
_onHexColorInput(ev){const hexColorValue=ev.target.value.replaceAll("#","");if(hexColorValue.length===6){this._updateHex(`#${hexColorValue}`);this._updateUI();this._colorSelected();}}}
return __exports;});;

/* /web/static/src/core/colors/colors.js */
odoo.define('@web/core/colors/colors',[],function(require){'use strict';let __exports={};const COLORS_BRIGHT=["#1f77b4","#ff7f0e","#aec7e8","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#875a7b","#c49c94","#e377c2","#dcd0d9","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#a5d8d7",];const COLORS_DARK=["#00ffff","#ff6347","#00ced1","#ffd700","#29ef29","#c5fabb","#fe4b4c","#ffb6c1","#ba87e9","#eadbf6","#c568af","#ecc1b8","#fda9e3","#BB86FC","#808080","#f2e8e8","#fcfe2d","#f8f8bc","#17becf","#10efed",];__exports.getColors=getColors;function getColors(colorScheme){return colorScheme==="dark"?COLORS_DARK:COLORS_BRIGHT;}
__exports.getColor=getColor;function getColor(index,colorScheme){const colors=getColors(colorScheme);return colors[index%colors.length];}
const DEFAULT_BG=__exports.DEFAULT_BG="#d3d3d3";__exports.getBorderWhite=getBorderWhite;function getBorderWhite(colorScheme){return colorScheme==="dark"?"rgba(0, 0, 0, 0.6)":"rgba(255,255,255,0.6)";}
const RGB_REGEX=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;__exports.hexToRGBA=hexToRGBA;function hexToRGBA(hex,opacity){const rgb=RGB_REGEX.exec(hex).slice(1,4).map((n)=>parseInt(n,16)).join(",");return`rgba(${rgb},${opacity})`;}
return __exports;});;

/* /web/static/src/core/commands/command_category.js */
odoo.define('@web/core/commands/command_category',['@web/core/registry'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const commandCategoryRegistry=registry.category("command_categories");commandCategoryRegistry.add("app",{},{sequence:10}).add("smart_action",{},{sequence:15}).add("actions",{},{sequence:30}).add("default",{},{sequence:50}).add("view_switcher",{},{sequence:100}).add("debug",{},{sequence:110}).add("disabled",{});return __exports;});;

/* /web/static/src/core/commands/command_hook.js */
odoo.define('@web/core/commands/command_hook',['@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{useEffect}=require("@odoo/owl");__exports.useCommand=useCommand;function useCommand(name,action,options={}){const commandService=useService("command");useEffect(()=>commandService.add(name,action,options),()=>[]);}
return __exports;});;

/* /web/static/src/core/commands/command_palette.js */
odoo.define('@web/core/commands/command_palette',['@web/core/dialog/dialog','@web/core/hotkeys/hotkey_hook','@web/core/l10n/translation','@web/core/utils/concurrency','@web/core/utils/hooks','@web/core/utils/scrolling','@web/core/utils/search','@web/core/utils/timing','@web/core/browser/feature_detection','@web/core/utils/strings','@odoo/owl'],function(require){'use strict';let __exports={};const{Dialog}=require("@web/core/dialog/dialog");const{useHotkey}=require("@web/core/hotkeys/hotkey_hook");const{_t}=require("@web/core/l10n/translation");const{KeepLast,Race}=require("@web/core/utils/concurrency");const{useAutofocus,useService}=require("@web/core/utils/hooks");const{scrollTo}=require("@web/core/utils/scrolling");const{fuzzyLookup}=require("@web/core/utils/search");const{debounce}=require("@web/core/utils/timing");const{isMacOS,isMobileOS}=require("@web/core/browser/feature_detection");const{escapeRegExp}=require("@web/core/utils/strings");const{Component,onWillStart,onWillDestroy,EventBus,useRef,useState,markRaw,useExternalListener,}=require("@odoo/owl");const DEFAULT_PLACEHOLDER=_t("Search...");const DEFAULT_EMPTY_MESSAGE=_t("No result found");const FUZZY_NAMESPACES=["default"];function commandsWithinCategory(categoryName,categories){return(cmd)=>{const inCurrentCategory=categoryName===cmd.category;const fallbackCategory=categoryName==="default"&&!categories.includes(cmd.category);return inCurrentCategory||fallbackCategory;};}
__exports.splitCommandName=splitCommandName;function splitCommandName(name,searchValue){if(name){const splitName=name.split(new RegExp(`(${escapeRegExp(searchValue)})`,"ig"));return searchValue.length&&splitName.length>1?splitName:[name];}
return[];}
const DefaultCommandItem=__exports.DefaultCommandItem=class DefaultCommandItem extends Component{}
DefaultCommandItem.template="web.DefaultCommandItem";DefaultCommandItem.props={slots:{type:Object,optional:true},hotkey:{type:String,optional:true},hotkeyOptions:{type:String,optional:true},name:{type:String,optional:true},searchValue:{type:String,optional:true},executeCommand:{type:Function,optional:true},};const CommandPalette=__exports.CommandPalette=class CommandPalette extends Component{setup(){if(this.props.bus){const setConfig=({detail})=>this.setCommandPaletteConfig(detail);this.props.bus.addEventListener(`SET-CONFIG`,setConfig);onWillDestroy(()=>this.props.bus.removeEventListener(`SET-CONFIG`,setConfig));}
this.keyId=1;this.race=new Race();this.keepLast=new KeepLast();this._sessionId=CommandPalette.lastSessionId++;this.DefaultCommandItem=DefaultCommandItem;this.activeElement=useService("ui").activeElement;this.inputRef=useAutofocus();useHotkey("Enter",()=>this.executeSelectedCommand(),{bypassEditableProtection:true});useHotkey("Control+Enter",()=>this.executeSelectedCommand(true),{bypassEditableProtection:true,});useHotkey("ArrowUp",()=>this.selectCommandAndScrollTo("PREV"),{bypassEditableProtection:true,allowRepeat:true,});useHotkey("ArrowDown",()=>this.selectCommandAndScrollTo("NEXT"),{bypassEditableProtection:true,allowRepeat:true,});useExternalListener(window,"mousedown",this.onWindowMouseDown);this.state=useState({});this.root=useRef("root");this.listboxRef=useRef("listbox");onWillStart(()=>this.setCommandPaletteConfig(this.props.config));}
get commandsByCategory(){const categories=[];for(const category of this.categoryKeys){const commands=this.state.commands.filter(commandsWithinCategory(category,this.categoryKeys));if(commands.length){categories.push({commands,name:this.categoryNames[category],keyId:category,});}}
return categories;}
async setCommandPaletteConfig(config){this.configByNamespace=config.configByNamespace||{};this.state.FooterComponent=config.FooterComponent;this.providersByNamespace={default:[]};for(const provider of config.providers){const namespace=provider.namespace||"default";if(namespace in this.providersByNamespace){this.providersByNamespace[namespace].push(provider);}else{this.providersByNamespace[namespace]=[provider];}}
const{namespace,searchValue}=this.processSearchValue(config.searchValue||"");this.switchNamespace(namespace);this.state.searchValue=searchValue;await this.race.add(this.search(searchValue));}
async setCommands(namespace,options={}){this.categoryKeys=["default"];this.categoryNames={};const proms=this.providersByNamespace[namespace].map((provider)=>{const{provide}=provider;const result=provide(this.env,options);return result;});let commands=(await this.keepLast.add(Promise.all(proms))).flat();const namespaceConfig=this.configByNamespace[namespace]||{};if(options.searchValue&&FUZZY_NAMESPACES.includes(namespace)){commands=fuzzyLookup(options.searchValue,commands,(c)=>c.name);}else{if(namespaceConfig.categories){let commandsSorted=[];this.categoryKeys=namespaceConfig.categories;this.categoryNames=namespaceConfig.categoryNames||{};if(!this.categoryKeys.includes("default")){this.categoryKeys.push("default");}
for(const category of this.categoryKeys){commandsSorted=commandsSorted.concat(commands.filter(commandsWithinCategory(category,this.categoryKeys)));}
commands=commandsSorted;}}
this.state.commands=markRaw(commands.slice(0,100).map((command)=>({...command,keyId:this.keyId++,splitName:splitCommandName(command.name,options.searchValue),})));this.selectCommand(this.state.commands.length?0:-1);this.mouseSelectionActive=false;this.state.emptyMessage=(namespaceConfig.emptyMessage||DEFAULT_EMPTY_MESSAGE).toString();}
selectCommand(index){if(index===-1||index>=this.state.commands.length){this.state.selectedCommand=null;return;}
this.state.selectedCommand=markRaw(this.state.commands[index]);}
selectCommandAndScrollTo(type){this.mouseSelectionActive=false;const index=this.state.commands.indexOf(this.state.selectedCommand);if(index===-1){return;}
let nextIndex;if(type==="NEXT"){nextIndex=index<this.state.commands.length-1?index+1:0;}else if(type==="PREV"){nextIndex=index>0?index-1:this.state.commands.length-1;}
this.selectCommand(nextIndex);const command=this.listboxRef.el.querySelector(`#o_command_${nextIndex}`);scrollTo(command,{scrollable:this.listboxRef.el});}
onCommandClicked(event,index){event.preventDefault();this.selectCommand(index);const ctrlKey=isMacOS()?event.metaKey:event.ctrlKey;this.executeSelectedCommand(ctrlKey);}
async executeCommand(command){const config=await command.action();if(config){this.setCommandPaletteConfig(config);}else{this.props.close();}}
async executeSelectedCommand(ctrlKey){await this.searchValuePromise;const selectedCommand=this.state.selectedCommand;if(selectedCommand){if(!ctrlKey){this.executeCommand(selectedCommand);}else if(selectedCommand.href){window.open(selectedCommand.href,"_blank");}}}
onCommandMouseEnter(index){if(this.mouseSelectionActive){this.selectCommand(index);}else{this.mouseSelectionActive=true;}}
async search(searchValue){await this.setCommands(this.state.namespace,{searchValue,activeElement:this.activeElement,sessionId:this._sessionId,});if(this.inputRef.el){this.inputRef.el.focus();}}
debounceSearch(value){const{namespace,searchValue}=this.processSearchValue(value);if(namespace!=="default"&&this.state.namespace!==namespace){this.switchNamespace(namespace);}
this.state.searchValue=searchValue;this.searchValuePromise=this.lastDebounceSearch(searchValue).catch(()=>{this.searchValuePromise=null;});}
onSearchInput(ev){this.debounceSearch(ev.target.value);}
onKeyDown(ev){if(ev.key.toLowerCase()==="backspace"&&!ev.target.value.length&&!ev.repeat){this.switchNamespace("default");this.state.searchValue="";this.searchValuePromise=this.lastDebounceSearch("").catch(()=>{this.searchValuePromise=null;});}}
onWindowMouseDown(ev){if(!this.root.el.contains(ev.target)){this.props.close();}}
switchNamespace(namespace){if(this.lastDebounceSearch){this.lastDebounceSearch.cancel();}
const namespaceConfig=this.configByNamespace[namespace]||{};this.lastDebounceSearch=debounce((value)=>this.search(value),namespaceConfig.debounceDelay||0);this.state.namespace=namespace;this.state.placeholder=namespaceConfig.placeholder||DEFAULT_PLACEHOLDER.toString();}
processSearchValue(searchValue){let namespace="default";if(searchValue.length&&this.providersByNamespace[searchValue[0]]){namespace=searchValue[0];searchValue=searchValue.slice(1);}
return{namespace,searchValue};}
get isMacOS(){return isMacOS();}
get isMobileOS(){return isMobileOS();}}
CommandPalette.lastSessionId=0;CommandPalette.props={bus:{type:EventBus,optional:true},close:Function,config:Object,closeMe:{type:Function,optional:true},};CommandPalette.template="web.CommandPalette";CommandPalette.components={Dialog};return __exports;});;

/* /web/static/src/core/commands/command_service.js */
odoo.define('@web/core/commands/command_service',['@web/core/registry','@web/core/commands/command_palette','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{CommandPalette}=require("@web/core/commands/command_palette");const{Component,EventBus}=require("@odoo/owl");const commandCategoryRegistry=registry.category("command_categories");const commandProviderRegistry=registry.category("command_provider");const commandSetupRegistry=registry.category("command_setup");class DefaultFooter extends Component{setup(){this.elements=commandSetupRegistry.getEntries().map((el)=>({namespace:el[0],name:el[1].name})).filter((el)=>el.name);}
onClick(namespace){this.props.switchNamespace(namespace);}}
DefaultFooter.template="web.DefaultFooter";const commandService=__exports.commandService={dependencies:["dialog","hotkey","ui"],start(env,{dialog,hotkey:hotkeyService,ui}){const registeredCommands=new Map();let nextToken=0;let isPaletteOpened=false;const bus=new EventBus();hotkeyService.add("control+k",openMainPalette,{bypassEditableProtection:true,global:true,});function openMainPalette(config={},onClose){const configByNamespace={};for(const provider of commandProviderRegistry.getAll()){const namespace=provider.namespace||"default";if(!configByNamespace[namespace]){configByNamespace[namespace]={categories:[],categoryNames:{},};}}
for(const[category,el]of commandCategoryRegistry.getEntries()){const namespace=el.namespace||"default";const name=el.name;if(namespace in configByNamespace){configByNamespace[namespace].categories.push(category);configByNamespace[namespace].categoryNames[category]=name;}}
for(const[namespace,{emptyMessage,debounceDelay,placeholder},]of commandSetupRegistry.getEntries()){if(namespace in configByNamespace){if(emptyMessage){configByNamespace[namespace].emptyMessage=emptyMessage;}
if(debounceDelay!==undefined){configByNamespace[namespace].debounceDelay=debounceDelay;}
if(placeholder){configByNamespace[namespace].placeholder=placeholder;}}}
config=Object.assign({configByNamespace,FooterComponent:DefaultFooter,providers:commandProviderRegistry.getAll(),},config);return openPalette(config,onClose);}
function openPalette(config,onClose){if(isPaletteOpened){bus.trigger("SET-CONFIG",config);return;}
isPaletteOpened=true;dialog.add(CommandPalette,{config,bus,},{onClose:()=>{isPaletteOpened=false;if(onClose){onClose();}},});}
function registerCommand(command,options){if(!command.name||!command.action||typeof command.action!=="function"){throw new Error("A Command must have a name and an action function.");}
const registration=Object.assign({},command,options);if(registration.identifier){const commandsArray=Array.from(registeredCommands.values());const sameName=commandsArray.find((com)=>com.name===registration.name);if(sameName){if(registration.identifier!==sameName.identifier){registration.name+=` (${registration.identifier})`;sameName.name+=` (${sameName.identifier})`;}}else{const sameFullName=commandsArray.find((com)=>com.name===registration.name+`(${registration.identifier})`);if(sameFullName){registration.name+=` (${registration.identifier})`;}}}
if(registration.hotkey){const action=async()=>{const commandService=env.services.command;const config=await command.action();if(!isPaletteOpened&&config){commandService.openPalette(config);}};registration.removeHotkey=hotkeyService.add(registration.hotkey,action,{...options.hotkeyOptions,global:registration.global,isAvailable:(...args)=>{let available=true;if(registration.isAvailable){available=registration.isAvailable(...args);}
if(available&&options.hotkeyOptions?.isAvailable){available=options.hotkeyOptions?.isAvailable(...args);}
return available;},});}
const token=nextToken++;registeredCommands.set(token,registration);if(!options.activeElement){Promise.resolve().then(()=>{registration.activeElement=ui.activeElement;});}
return token;}
function unregisterCommand(token){const cmd=registeredCommands.get(token);if(cmd&&cmd.removeHotkey){cmd.removeHotkey();}
registeredCommands.delete(token);}
return{add(name,action,options={}){const token=registerCommand({name,action},options);return()=>{unregisterCommand(token);};},getCommands(activeElement){return[...registeredCommands.values()].filter((command)=>command.activeElement===activeElement||command.global);},openMainPalette,openPalette,};},};registry.category("services").add("command",commandService);return __exports;});;

/* /web/static/src/core/commands/default_providers.js */
odoo.define('@web/core/commands/default_providers',['@web/core/browser/feature_detection','@web/core/hotkeys/hotkey_hook','@web/core/l10n/translation','@web/core/registry','@web/core/utils/strings','@web/core/utils/ui','@web/core/commands/command_palette','@odoo/owl'],function(require){'use strict';let __exports={};const{isMacOS}=require("@web/core/browser/feature_detection");const{useHotkey}=require("@web/core/hotkeys/hotkey_hook");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{capitalize}=require("@web/core/utils/strings");const{getVisibleElements}=require("@web/core/utils/ui");const{DefaultCommandItem}=require("@web/core/commands/command_palette");const{Component}=require("@odoo/owl");const commandSetupRegistry=registry.category("command_setup");commandSetupRegistry.add("default",{emptyMessage:_t("No command found"),placeholder:_t("Search for a command..."),});const HotkeyCommandItem=__exports.HotkeyCommandItem=class HotkeyCommandItem extends Component{setup(){useHotkey(this.props.hotkey,this.props.executeCommand);}
getKeysToPress(command){const{hotkey}=command;let result=hotkey.split("+");if(isMacOS()){result=result.map((x)=>x.replace("control","command")).map((x)=>x.replace("alt","control"));}
return result.map((key)=>key.toUpperCase());}}
HotkeyCommandItem.template="web.HotkeyCommandItem";const commandCategoryRegistry=registry.category("command_categories");const commandProviderRegistry=registry.category("command_provider");commandProviderRegistry.add("command",{provide:(env,options={})=>{const commands=env.services.command.getCommands(options.activeElement).map((cmd)=>{cmd.category=commandCategoryRegistry.contains(cmd.category)?cmd.category:"default";return cmd;}).filter((command)=>command.isAvailable===undefined||command.isAvailable());const uniqueCommands=commands.filter((obj,index)=>{return(index===commands.findIndex((o)=>obj.name===o.name&&obj.category===o.category));});return uniqueCommands.map((command)=>({Component:command.hotkey?HotkeyCommandItem:DefaultCommandItem,action:command.action,category:command.category,name:command.name,props:{hotkey:command.hotkey,hotkeyOptions:command.hotkeyOptions,},}));},});commandProviderRegistry.add("data-hotkeys",{provide:(env,options={})=>{const commands=[];const overlayModifier=registry.category("services").get("hotkey").overlayModifier;for(const el of getVisibleElements(options.activeElement,"[data-hotkey]:not(:disabled)")){const closest=el.closest("[data-command-category]");const category=closest?closest.dataset.commandCategory:"default";if(category==="disabled"){continue;}
const description=el.title||el.dataset.bsOriginalTitle||el.dataset.tooltip||el.placeholder||(el.innerText&&`${el.innerText.slice(0, 50)}${el.innerText.length > 50 ? "..." : ""}`)||_t("no description provided");commands.push({Component:HotkeyCommandItem,action:()=>{el.focus();el.click();},category,name:capitalize(description.trim().toLowerCase()),props:{hotkey:`${overlayModifier}+${el.dataset.hotkey}`,},});}
return commands;},});return __exports;});;

/* /web/static/src/core/confirmation_dialog/confirmation_dialog.js */
odoo.define('@web/core/confirmation_dialog/confirmation_dialog',['@web/core/dialog/dialog','@web/core/l10n/translation','@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{Dialog}=require("@web/core/dialog/dialog");const{_t}=require("@web/core/l10n/translation");const{useChildRef}=require("@web/core/utils/hooks");const{Component}=require("@odoo/owl");const deleteConfirmationMessage=__exports.deleteConfirmationMessage=_t(`Ready to make your record disappear into thin air? Are you sure?
It will be gone forever!

Think twice before you click that 'Delete' button!`);const ConfirmationDialog=__exports.ConfirmationDialog=class ConfirmationDialog extends Component{setup(){this.env.dialogData.dismiss=()=>this._dismiss();this.modalRef=useChildRef();this.isProcess=false;}
async _cancel(){return this.execButton(this.props.cancel);}
async _confirm(){return this.execButton(this.props.confirm);}
async _dismiss(){return this.execButton(this.props.dismiss||this.props.cancel);}
setButtonsDisabled(disabled){this.isProcess=disabled;if(!this.modalRef.el){return;}
for(const button of[...this.modalRef.el.querySelectorAll(".modal-footer button")]){button.disabled=disabled;}}
async execButton(callback){if(this.isProcess){return;}
this.setButtonsDisabled(true);if(callback){let shouldClose;try{shouldClose=await callback();}catch(e){this.props.close();throw e;}
if(shouldClose===false){this.setButtonsDisabled(false);return;}}
this.props.close();}}
ConfirmationDialog.template="web.ConfirmationDialog";ConfirmationDialog.components={Dialog};ConfirmationDialog.props={close:Function,title:{validate:(m)=>{return(typeof m==="string"||(typeof m==="object"&&typeof m.toString==="function"));},optional:true,},body:String,confirm:{type:Function,optional:true},confirmLabel:{type:String,optional:true},confirmClass:{type:String,optional:true},cancel:{type:Function,optional:true},cancelLabel:{type:String,optional:true},dismiss:{type:Function,optional:true},};ConfirmationDialog.defaultProps={confirmLabel:_t("Ok"),cancelLabel:_t("Cancel"),confirmClass:"btn-primary",title:_t("Confirmation"),};const AlertDialog=__exports.AlertDialog=class AlertDialog extends ConfirmationDialog{}
AlertDialog.template="web.AlertDialog";AlertDialog.props={...ConfirmationDialog.props,contentClass:{type:String,optional:true},};AlertDialog.defaultProps={...ConfirmationDialog.defaultProps,title:_t("Alert"),};return __exports;});;

/* /web/static/src/core/context.js */
odoo.define('@web/core/context',['@web/core/py_js/py','@web/core/py_js/py_interpreter'],function(require){'use strict';let __exports={};const{evaluateExpr,parseExpr}=require("@web/core/py_js/py");const{evaluate}=require("@web/core/py_js/py_interpreter");__exports.makeContext=makeContext;function makeContext(contexts,initialEvaluationContext){const evaluationContext=Object.assign({},initialEvaluationContext);const context={};for(let ctx of contexts){if(ctx!==""){ctx=typeof ctx==="string"?evaluateExpr(ctx,evaluationContext):ctx;Object.assign(context,ctx);Object.assign(evaluationContext,context);}}
return context;}
__exports.evalPartialContext=evalPartialContext;function evalPartialContext(_context,evaluationContext={}){const ast=parseExpr(_context);const context={};for(const key in ast.value){const value=ast.value[key];try{context[key]=evaluate(value,evaluationContext);}catch{}}
return context;}
return __exports;});;

/* /web/static/src/core/currency.js */
odoo.define('@web/core/currency',['@web/core/utils/numbers','@web/session','@web/core/utils/strings'],function(require){'use strict';let __exports={};const{formatFloat,humanNumber}=require("@web/core/utils/numbers");const{session}=require("@web/session");const{nbsp}=require("@web/core/utils/strings");const currencies=__exports.currencies=session.currencies||{};delete session.currencies;__exports.getCurrency=getCurrency;function getCurrency(id){return currencies[id];}
__exports.formatCurrency=formatCurrency;function formatCurrency(amount,currencyId,options={}){const currency=getCurrency(currencyId);const digits=options.digits||(currency&&currency.digits);let formattedAmount;if(options.humanReadable){formattedAmount=humanNumber(amount,{decimals:digits?digits[1]:2});}else{formattedAmount=formatFloat(amount,{digits});}
if(!currency||options.noSymbol){return formattedAmount;}
const formatted=[currency.symbol,formattedAmount];if(currency.position==="after"){formatted.reverse();}
return formatted.join(nbsp);}
return __exports;});;

/* /web/static/src/core/datetime/datetime_hook.js */
odoo.define('@web/core/datetime/datetime_hook',['@odoo/owl','@web/core/popover/popover_hook','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{onPatched,onWillRender,useEffect,useRef}=require("@odoo/owl");const{usePopover}=require("@web/core/popover/popover_hook");const{useService}=require("@web/core/utils/hooks");__exports.useDateTimePicker=useDateTimePicker;function useDateTimePicker(hookParams){const datetimePicker=useService("datetime_picker");if(typeof hookParams.target==="string"){const target=useRef(hookParams.target);Object.defineProperty(hookParams,"target",{get(){return target.el;},});}
const inputRefs=[useRef("start-date"),useRef("end-date")];const{computeBasePickerProps,state,open,focusIfNeeded,enable}=datetimePicker.create(hookParams,()=>inputRefs.map((ref)=>ref?.el),usePopover);onWillRender(computeBasePickerProps);useEffect(enable);onPatched(focusIfNeeded);return{state,open};}
return __exports;});;

/* /web/static/src/core/datetime/datetime_input.js */
odoo.define('@web/core/datetime/datetime_input',['@odoo/owl','@web/core/utils/objects','@web/core/datetime/datetime_hook','@web/core/datetime/datetime_picker'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{omit}=require("@web/core/utils/objects");const{useDateTimePicker}=require("@web/core/datetime/datetime_hook");const{DateTimePicker}=require("@web/core/datetime/datetime_picker");const dateTimeInputOwnProps={format:{type:String,optional:true},id:{type:String,optional:true},onChange:{type:Function,optional:true},onApply:{type:Function,optional:true},placeholder:{type:String,optional:true},};const DateTimeInput=__exports.DateTimeInput=class DateTimeInput extends Component{static props={...DateTimePicker.props,...dateTimeInputOwnProps,};static template="web.DateTimeInput";setup(){const getPickerProps=()=>omit(this.props,...Object.keys(dateTimeInputOwnProps));useDateTimePicker({format:this.props.format,get pickerProps(){return getPickerProps();},onApply:(...args)=>this.props.onApply?.(...args),onChange:(...args)=>this.props.onChange?.(...args),});}}
return __exports;});;

/* /web/static/src/core/datetime/datetime_picker.js */
odoo.define('@web/core/datetime/datetime_picker',['@odoo/owl','@web/core/l10n/translation','@web/core/l10n/dates','@web/core/l10n/localization','@web/core/utils/arrays'],function(require){'use strict';let __exports={};const{Component,onWillRender,onWillUpdateProps,useState}=require("@odoo/owl");const{_t}=require("@web/core/l10n/translation");const{MAX_VALID_DATE,MIN_VALID_DATE,clampDate,is24HourFormat,isInRange,isMeridiemFormat,today,}=require("@web/core/l10n/dates");const{localization}=require("@web/core/l10n/localization");const{ensureArray}=require("@web/core/utils/arrays");const{DateTime,Info}=luxon;const earliest=(date1,date2)=>(date1<date2?date1:date2);const getStartOfDecade=(date)=>Math.floor(date.year/10)*10;const getStartOfCentury=(date)=>Math.floor(date.year/100)*100;const getStartOfWeek=(date)=>{const{weekStart}=localization;return date.set({weekday:date.weekday<weekStart?weekStart-7:weekStart});};const latest=(date1,date2)=>(date1>date2?date1:date2);const numberRange=(min,max)=>[...Array(max-min)].map((_,i)=>i+min);const parseLimitDate=(value,defaultValue)=>clampDate(value==="today"?today():value||defaultValue,MIN_VALID_DATE,MAX_VALID_DATE);const toDateItem=({isOutOfRange=false,isValid=true,label,range,extraClass})=>({id:range[0].toISODate(),includesToday:isInRange(today(),range),isOutOfRange,isValid,label:String(range[0][label]),range,extraClass,});const toWeekItem=(weekDayItems)=>({number:weekDayItems[3].range[0].weekNumber,days:weekDayItems,});const HOURS=numberRange(0,24).map((hour)=>[hour,String(hour)]);const MINUTES=numberRange(0,60).map((minute)=>[minute,String(minute||0).padStart(2,"0")]);const SECONDS=[...MINUTES];const MERIDIEMS=["AM","PM"];const PRECISION_LEVELS=new Map().set("days",{mainTitle:_t("Select month"),nextTitle:_t("Next month"),prevTitle:_t("Previous month"),step:{month:1},getTitle:(date,{additionalMonth})=>{const titles=[`${date.monthLong} ${date.year}`];if(additionalMonth){const next=date.plus({month:1});titles.push(`${next.monthLong} ${next.year}`);}
return titles;},getItems:(date,{additionalMonth,maxDate,minDate,showWeekNumbers,isDateValid,dayCellClass})=>{const startDates=[date];if(additionalMonth){startDates.push(date.plus({month:1}));}
return startDates.map((date,i)=>{const monthRange=[date.startOf("month"),date.endOf("month")];const weeks=[];let startOfNextWeek=getStartOfWeek(monthRange[0]);for(let w=0;w<6;w++){const weekDayItems=[];for(let d=0;d<7;d++){const day=startOfNextWeek.plus({day:d});const range=[day,day.endOf("day")];const dayItem=toDateItem({isOutOfRange:!isInRange(day,monthRange),isValid:isInRange(range,[minDate,maxDate])&&isDateValid?.(day),label:"day",range,extraClass:dayCellClass?.(day)||"",});weekDayItems.push(dayItem);if(d===6){startOfNextWeek=day.plus({day:1});}}
weeks.push(toWeekItem(weekDayItems));}
const daysOfWeek=weeks[0].days.map((d)=>[d.range[0].weekdayShort,d.range[0].weekdayLong,Info.weekdays("narrow",{locale:d.range[0].locale})[d.range[0].weekday-1],]);if(showWeekNumbers){daysOfWeek.unshift(["#",_t("Week numbers"),"#"]);}
return{id:`__month__${i}`,number:monthRange[0].month,daysOfWeek,weeks,};});},}).set("months",{mainTitle:_t("Select year"),nextTitle:_t("Next year"),prevTitle:_t("Previous year"),step:{year:1},getTitle:(date)=>String(date.year),getItems:(date,{maxDate,minDate})=>{const startOfYear=date.startOf("year");return numberRange(0,12).map((i)=>{const startOfMonth=startOfYear.plus({month:i});const range=[startOfMonth,startOfMonth.endOf("month")];return toDateItem({isValid:isInRange(range,[minDate,maxDate]),label:"monthShort",range,});});},}).set("years",{mainTitle:_t("Select decade"),nextTitle:_t("Next decade"),prevTitle:_t("Previous decade"),step:{year:10},getTitle:(date)=>`${getStartOfDecade(date) - 1} - ${getStartOfDecade(date) + 10}`,getItems:(date,{maxDate,minDate})=>{const startOfDecade=date.startOf("year").set({year:getStartOfDecade(date)});return numberRange(-GRID_MARGIN,GRID_COUNT+GRID_MARGIN).map((i)=>{const startOfYear=startOfDecade.plus({year:i});const range=[startOfYear,startOfYear.endOf("year")];return toDateItem({isOutOfRange:i<0||i>=GRID_COUNT,isValid:isInRange(range,[minDate,maxDate]),label:"year",range,});});},}).set("decades",{mainTitle:_t("Select century"),nextTitle:_t("Next century"),prevTitle:_t("Previous century"),step:{year:100},getTitle:(date)=>`${getStartOfCentury(date) - 10} - ${getStartOfCentury(date) + 100}`,getItems:(date,{maxDate,minDate})=>{const startOfCentury=date.startOf("year").set({year:getStartOfCentury(date)});return numberRange(-GRID_MARGIN,GRID_COUNT+GRID_MARGIN).map((i)=>{const startOfDecade=startOfCentury.plus({year:i*10});const range=[startOfDecade,startOfDecade.plus({year:10,millisecond:-1})];return toDateItem({label:"year",isOutOfRange:i<0||i>=GRID_COUNT,isValid:isInRange(range,[minDate,maxDate]),range,});});},});const GRID_COUNT=10;const GRID_MARGIN=1;const NULLABLE_DATETIME_PROPERTY=[DateTime,{value:false},{value:null}];const DateTimePicker=__exports.DateTimePicker=class DateTimePicker extends Component{static props={focusedDateIndex:{type:Number,optional:true},showWeekNumbers:{type:Boolean,optional:true},daysOfWeekFormat:{type:String,optional:true},maxDate:{type:[NULLABLE_DATETIME_PROPERTY,{value:"today"}],optional:true},maxPrecision:{type:[...PRECISION_LEVELS.keys()].map((value)=>({value})),optional:true,},minDate:{type:[NULLABLE_DATETIME_PROPERTY,{value:"today"}],optional:true},minPrecision:{type:[...PRECISION_LEVELS.keys()].map((value)=>({value})),optional:true,},onSelect:{type:Function,optional:true},range:{type:Boolean,optional:true},rounding:{type:Number,optional:true},slots:{type:Object,shape:{bottom_left:{type:Object,optional:true},buttons:{type:Object,optional:true},},optional:true,},type:{type:[{value:"date"},{value:"datetime"}],optional:true},value:{type:[NULLABLE_DATETIME_PROPERTY,{type:Array,element:NULLABLE_DATETIME_PROPERTY},],optional:true,},isDateValid:{type:Function,optional:true},dayCellClass:{type:Function,optional:true},};static defaultProps={focusedDateIndex:0,daysOfWeekFormat:"short",maxPrecision:"decades",minPrecision:"days",rounding:5,type:"datetime",};static template="web.DateTimePicker";get activePrecisionLevel(){return PRECISION_LEVELS.get(this.state.precision);}
get isLastPrecisionLevel(){return(this.allowedPrecisionLevels.indexOf(this.state.precision)===this.allowedPrecisionLevels.length-1);}
get titles(){return ensureArray(this.title);}
setup(){this.availableHours=HOURS;this.availableMinutes=MINUTES;this.allowedPrecisionLevels=[];this.items=[];this.title="";this.shouldAdjustFocusDate=false;this.state=useState({focusDate:null,hoveredDate:null,timeValues:[],precision:this.props.minPrecision,});this.onPropsUpdated(this.props);onWillUpdateProps((nextProps)=>this.onPropsUpdated(nextProps));onWillRender(()=>this.onWillRender());}
onPropsUpdated(props){this.values=ensureArray(props.value).map((value)=>value&&!value.isValid?null:value);this.availableHours=HOURS;this.availableMinutes=MINUTES.filter((minute)=>!(minute[0]%props.rounding));this.availableSeconds=props.rounding?[]:SECONDS;this.allowedPrecisionLevels=this.filterPrecisionLevels(props.minPrecision,props.maxPrecision);this.additionalMonth=props.range&&!this.env.isSmall;this.maxDate=parseLimitDate(props.maxDate,MAX_VALID_DATE);this.minDate=parseLimitDate(props.minDate,MIN_VALID_DATE);if(this.props.type==="date"){this.maxDate=this.maxDate.endOf("day");this.minDate=this.minDate.startOf("day");}
if(this.maxDate<this.minDate){throw new Error(`DateTimePicker error: given "maxDate" comes before "minDate".`);}
const timeValues=this.values.map((val)=>[(val||DateTime.local()).hour,val?.minute||0,val?.second||0,]);if(props.range){this.state.timeValues=timeValues;}else{this.state.timeValues=[];this.state.timeValues[props.focusedDateIndex]=timeValues[props.focusedDateIndex];}
this.shouldAdjustFocusDate=!props.range;this.adjustFocus(this.values,props.focusedDateIndex);this.handle12HourSystem();this.state.timeValues=this.state.timeValues.map((timeValue)=>timeValue.map(String));}
onWillRender(){const{hoveredDate}=this.state;const precision=this.activePrecisionLevel;const getterParams={additionalMonth:this.additionalMonth,maxDate:this.maxDate,minDate:this.minDate,showWeekNumbers:this.props.showWeekNumbers??!this.props.range,isDateValid:this.props.isDateValid,dayCellClass:this.props.dayCellClass,};const referenceDate=this.state.focusDate;this.title=precision.getTitle(referenceDate,getterParams);this.items=precision.getItems(referenceDate,getterParams);this.selectedRange=[...this.values];this.highlightedRange=[...this.values];if(hoveredDate){[this.selectedRange]=this.applyValueAtIndex(hoveredDate,this.props.focusedDateIndex);if(this.props.range&&this.selectedRange.every(Boolean)){this.highlightedRange=[earliest(this.selectedRange[0],this.values[0]),latest(this.selectedRange[1],this.values[1]),];}}}
adjustFocus(values,focusedDateIndex){if(!this.shouldAdjustFocusDate&&this.state.focusDate&&focusedDateIndex===this.props.focusedDateIndex){return;}
let dateToFocus=values[focusedDateIndex]||values[focusedDateIndex===1?0:1]||today();if(this.additionalMonth&&focusedDateIndex===1&&values[0]&&values[1]&&values[0].month!==values[1].month){dateToFocus=dateToFocus.minus({month:1});}
this.shouldAdjustFocusDate=false;this.state.focusDate=this.clamp(dateToFocus.startOf("month"));}
applyValueAtIndex(value,valueIndex){const result=[...this.values];if(this.props.range){if(result[0]&&value.endOf("day")<result[0].startOf("day")){valueIndex=0;}else if(result[1]&&result[1].endOf("day")<value.startOf("day")){valueIndex=1;}}
result[valueIndex]=value;return[result,valueIndex];}
clamp(value){return clampDate(value,this.minDate,this.maxDate);}
filterPrecisionLevels(minPrecision,maxPrecision){const levels=[...PRECISION_LEVELS.keys()];return levels.slice(levels.indexOf(minPrecision),levels.indexOf(maxPrecision)+1);}
getActiveRangeInfo({isOutOfRange,range}){const result={isSelected:!isOutOfRange&&isInRange(this.selectedRange,range),isSelectStart:false,isSelectEnd:false,isHighlighted:!isOutOfRange&&isInRange(this.highlightedRange,range),isHighlightStart:false,isHighlightEnd:false,isCurrent:false,};if(this.props.range){if(result.isSelected){const[selectStart,selectEnd]=this.selectedRange;result.isSelectStart=!selectStart||isInRange(selectStart,range);result.isSelectEnd=!selectEnd||isInRange(selectEnd,range);}
if(result.isHighlighted){const[currentStart,currentEnd]=this.highlightedRange;result.isHighlightStart=!currentStart||isInRange(currentStart,range);result.isHighlightEnd=!currentEnd||isInRange(currentEnd,range);}
result.isCurrent=!isOutOfRange&&(isInRange(this.values[0],range)||isInRange(this.values[1],range));}else{result.isSelectStart=result.isSelectEnd=result.isSelected;result.isHighlightStart=result.isHighlightEnd=result.isHighlighted;}
return result;}
getTimeValues(valueIndex){let[hour,minute,second]=this.state.timeValues[valueIndex].map(Number);if(this.is12HourFormat&&this.meridiems&&this.state.timeValues[valueIndex][3]==="PM"){hour+=12;}
return[hour,minute,second];}
handle12HourSystem(){if(isMeridiemFormat()){this.meridiems=MERIDIEMS.map((m)=>[m,m]);for(const timeValues of this.state.timeValues){if(timeValues){timeValues.push(MERIDIEMS[Math.floor(timeValues[0]/12)||0]);}}}
this.is12HourFormat=!is24HourFormat();if(this.is12HourFormat){this.availableHours=[[0,HOURS[12][1]],...HOURS.slice(1,12)];for(const timeValues of this.state.timeValues){if(timeValues){timeValues[0]%=12;}}}}
isSelectedDate({range}){return this.values.some((value)=>isInRange(value,range));}
next(ev){ev.preventDefault();const{step}=this.activePrecisionLevel;this.state.focusDate=this.clamp(this.state.focusDate.plus(step));}
previous(ev){ev.preventDefault();const{step}=this.activePrecisionLevel;this.state.focusDate=this.clamp(this.state.focusDate.minus(step));}
selectTime(valueIndex){const value=this.values[valueIndex]||today();this.validateAndSelect(value,valueIndex);}
validateAndSelect(value,valueIndex){if(!this.props.onSelect){return false;}
const[result,finalIndex]=this.applyValueAtIndex(value,valueIndex);if(this.props.type==="datetime"){const[hour,minute,second]=this.getTimeValues(finalIndex);result[finalIndex]=result[finalIndex].set({hour,minute,second});}
if(!isInRange(result[finalIndex],[this.minDate,this.maxDate])){return false;}
this.props.onSelect(result.length===2?result:result[0]);return true;}
zoomIn(date){const index=this.allowedPrecisionLevels.indexOf(this.state.precision)-1;if(index in this.allowedPrecisionLevels){this.state.focusDate=this.clamp(date);this.state.precision=this.allowedPrecisionLevels[index];return true;}
return false;}
zoomOut(){const index=this.allowedPrecisionLevels.indexOf(this.state.precision)+1;if(index in this.allowedPrecisionLevels){this.state.precision=this.allowedPrecisionLevels[index];return true;}
return false;}
zoomOrSelect(dateItem){if(!dateItem.isValid){return;}
if(this.zoomIn(dateItem.range[0])){return;}
const[value]=dateItem.range;const valueIndex=this.props.focusedDateIndex;const isValid=this.validateAndSelect(value,valueIndex);this.shouldAdjustFocusDate=isValid&&!this.props.range;}}
return __exports;});;

/* /web/static/src/core/datetime/datetime_picker_popover.js */
odoo.define('@web/core/datetime/datetime_picker_popover',['@odoo/owl','@web/core/hotkeys/hotkey_hook','@web/core/datetime/datetime_picker'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{useHotkey}=require("@web/core/hotkeys/hotkey_hook");const{DateTimePicker}=require("@web/core/datetime/datetime_picker");const DateTimePickerPopover=__exports.DateTimePickerPopover=class DateTimePickerPopover extends Component{static components={DateTimePicker};static props={close:Function,pickerProps:{type:Object,shape:DateTimePicker.props},};static template="web.DateTimePickerPopover";get isDateTimeRange(){return(this.props.pickerProps.type==="datetime"||Array.isArray(this.props.pickerProps.value));}
setup(){useHotkey("enter",()=>this.props.close());}}
return __exports;});;

/* /web/static/src/core/datetime/datetimepicker_service.js */
odoo.define('@web/core/datetime/datetimepicker_service',['@odoo/owl','@web/core/l10n/dates','@web/core/popover/popover_hook','@web/core/registry','@web/core/utils/arrays','@web/core/utils/objects','@web/core/datetime/datetime_picker','@web/core/datetime/datetime_picker_popover'],function(require){'use strict';let __exports={};const{markRaw,reactive}=require("@odoo/owl");const{areDatesEqual,formatDate,formatDateTime,parseDate,parseDateTime}=require("@web/core/l10n/dates");const{makePopover}=require("@web/core/popover/popover_hook");const{registry}=require("@web/core/registry");const{ensureArray,zip,zipWith}=require("@web/core/utils/arrays");const{deepCopy,shallowEqual}=require("@web/core/utils/objects");const{DateTimePicker}=require("@web/core/datetime/datetime_picker");const{DateTimePickerPopover}=require("@web/core/datetime/datetime_picker_popover");const arePropsEqual=(obj1,obj2)=>shallowEqual(obj1,obj2,(a,b)=>areDatesEqual(a,b)||shallowEqual(a,b));const FOCUS_CLASSNAME="text-primary";const formatters={date:formatDate,datetime:formatDateTime,};const parsers={date:parseDate,datetime:parseDateTime,};const datetimePickerService=__exports.datetimePickerService={dependencies:["popover"],start(env,{popover:popoverService}){return{create:(hookParams,getInputs=()=>[hookParams.target,null],createPopover=(...args)=>makePopover(popoverService,...args))=>{const popover=createPopover(DateTimePickerPopover,{onClose:()=>{if(!allowOnClose){return;}
updateValueFromInputs();apply();setFocusClass(null);if(restoreTargetMargin){restoreTargetMargin();restoreTargetMargin=null;}},});const apply=()=>{if(areDatesEqual(lastInitialProps?.value,deepCopy(pickerProps.value))){return;}
inputsChanged=ensureArray(pickerProps.value).map(()=>false);hookParams.onApply?.(pickerProps.value);};const computeBasePickerProps=()=>{const nextInitialProps=markValuesRaw(hookParams.pickerProps);const propsCopy=deepCopy(nextInitialProps);if(lastInitialProps&&arePropsEqual(lastInitialProps,propsCopy)){return;}
lastInitialProps=propsCopy;inputsChanged=ensureArray(lastInitialProps.value).map(()=>false);for(const[key,value]of Object.entries(nextInitialProps)){if(pickerProps[key]!==value&&!areDatesEqual(pickerProps[key],value)){pickerProps[key]=value;}}};const focusActiveInput=()=>{const inputEl=getInput(pickerProps.focusedDateIndex);if(!inputEl){shouldFocus=true;return;}
const{activeElement}=inputEl.ownerDocument;if(activeElement!==inputEl){inputEl.focus();}
setInputFocus(inputEl);};const getInput=(valueIndex)=>{const el=getInputs()[valueIndex];if(el&&document.body.contains(el)){return el;}
return null;};const getPopoverTarget=()=>{if(hookParams.target){return hookParams.target;}
if(pickerProps.range){let parentElement=getInput(0).parentElement;const inputEls=getInputs();while(parentElement&&!inputEls.every((inputEl)=>parentElement.contains(inputEl))){parentElement=parentElement.parentElement;}
return parentElement||getInput(0);}else{return getInput(0);}};const markValuesRaw=(obj)=>{const copy={};for(const[key,value]of Object.entries(obj)){if(value&&typeof value==="object"){copy[key]=markRaw(value);}else{copy[key]=value;}}
return copy;};const onInputChange=(ev)=>{updateValueFromInputs();inputsChanged[ev.target===getInput(1)?1:0]=true;if(!popover.isOpen||inputsChanged.every(Boolean)){saveAndClose();}};const onInputClick=({target})=>{openPicker(target===getInput(1)?1:0);};const onInputFocus=({target})=>{pickerProps.focusedDateIndex=target===getInput(1)?1:0;setInputFocus(target);};const onInputKeydown=(ev)=>{switch(ev.key){case"Enter":case"Escape":{return saveAndClose();}
case"Tab":{if(!getInput(0)||!getInput(1)||ev.target!==getInput(ev.shiftKey?1:0)){return saveAndClose();}}}};const openPicker=(inputIndex)=>{pickerProps.focusedDateIndex=inputIndex;if(!popover.isOpen){const popoverTarget=getPopoverTarget();if(env.isSmall){const{marginBottom}=popoverTarget.style;popoverTarget.style.marginBottom=`100vh`;popoverTarget.scrollIntoView(true);restoreTargetMargin=async()=>{popoverTarget.style.marginBottom=marginBottom;};}
popover.open(popoverTarget,{pickerProps});}
focusActiveInput();};const safeConvert=(operation,value)=>{const{type}=pickerProps;const convertFn=(operation==="format"?formatters:parsers)[type];try{return[convertFn(value,{format:hookParams.format}),null];}catch(error){if(error?.name==="ConversionError"){return[null,error];}else{throw error;}}};const saveAndClose=()=>{if(popover.isOpen){popover.close();}else{apply();}};const setFocusClass=(input)=>{for(const el of getInputs()){if(el){el.classList.toggle(FOCUS_CLASSNAME,popover.isOpen&&el===input);}}};const setInputFocus=(inputEl)=>{inputEl.selectionStart=0;inputEl.selectionEnd=inputEl.value.length;setFocusClass(inputEl);shouldFocus=false;};const updateInput=(el,value)=>{if(!el){return;}
const[formattedValue]=safeConvert("format",value);el.value=formattedValue||"";};const updateValue=(value)=>{const previousValue=pickerProps.value;pickerProps.value=value;if(areDatesEqual(previousValue,pickerProps.value)){return;}
if(pickerProps.range){const[prevStart,prevEnd]=ensureArray(previousValue);const[nextStart,nextEnd]=ensureArray(pickerProps.value);if((pickerProps.focusedDateIndex===0&&areDatesEqual(prevEnd,nextEnd))||(pickerProps.focusedDateIndex===1&&areDatesEqual(prevStart,nextStart))){pickerProps.focusedDateIndex=pickerProps.focusedDateIndex===1?0:1;}}
hookParams.onChange?.(pickerProps.value);};const updateValueFromInputs=()=>{const values=zipWith(getInputs(),ensureArray(pickerProps.value),(el,currentValue)=>{if(!el){return currentValue;}
const[parsedValue,error]=safeConvert("parse",el.value);if(error){updateInput(el,currentValue);return currentValue;}else{return parsedValue;}});updateValue(values.length===2?values:values[0]);};const rawPickerProps={...DateTimePicker.defaultProps,onSelect:(value)=>{value&&=markRaw(value);updateValue(value);if(!pickerProps.range&&pickerProps.type==="date"){saveAndClose();}},...markValuesRaw(hookParams.pickerProps),};const pickerProps=reactive(rawPickerProps,()=>{const currentIsRange=pickerProps.range;if(popover.isOpen&&lastIsRange!==currentIsRange){allowOnClose=false;popover.open(getPopoverTarget(),{pickerProps});allowOnClose=true;}
lastIsRange=currentIsRange;for(const[el,value]of zip(getInputs(),ensureArray(pickerProps.value),true)){if(el){updateInput(el,value);}}
shouldFocus=true;});let allowOnClose=true;let inputsChanged=[];let lastInitialProps=null;let lastIsRange=pickerProps.range;let restoreTargetMargin=null;let shouldFocus=false;const addListener=(el,type,listener)=>{el.addEventListener(type,listener);return()=>el.removeEventListener(type,listener);};return{state:pickerProps,open:openPicker,computeBasePickerProps,focusIfNeeded(){if(popover.isOpen&&shouldFocus){focusActiveInput();}},enable(){let editableInputs=0;const cleanups=[];for(const[el,value]of zip(getInputs(),ensureArray(pickerProps.value),true)){updateInput(el,value);if(el&&!el.disabled&&!el.readOnly){cleanups.push(addListener(el,"change",onInputChange));cleanups.push(addListener(el,"click",onInputClick));cleanups.push(addListener(el,"focus",onInputFocus));cleanups.push(addListener(el,"keydown",onInputKeydown));editableInputs++;}}
const calendarIconGroupEl=getInput(0)?.parentElement.querySelector(".input-group-text .fa-calendar")?.parentElement;if(calendarIconGroupEl){calendarIconGroupEl.classList.remove("pe-none");calendarIconGroupEl.classList.add("cursor-pointer");cleanups.push(addListener(calendarIconGroupEl,"click",()=>{openPicker(0);}));}
if(!editableInputs&&popover.isOpen){saveAndClose();}
return()=>cleanups.forEach((cleanup)=>cleanup());},get isOpen(){return popover.isOpen;},};},};},};registry.category("services").add("datetime_picker",datetimePickerService);return __exports;});;

/* /web/static/src/core/debug/debug_context.js */
odoo.define('@web/core/debug/debug_context',['@web/core/registry','@web/core/utils/functions','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{memoize}=require("@web/core/utils/functions");const{useEffect,useEnv,useSubEnv}=require("@odoo/owl");const debugRegistry=registry.category("debug");const getAccessRights=memoize(async function getAccessRights(orm){const rightsToCheck={"ir.ui.view":"write","ir.rule":"read","ir.model.access":"read",};const proms=Object.entries(rightsToCheck).map(([model,operation])=>{return orm.call(model,"check_access_rights",[],{operation,raise_exception:false,});});const[canEditView,canSeeRecordRules,canSeeModelAccess]=await Promise.all(proms);const accessRights={canEditView,canSeeRecordRules,canSeeModelAccess};return accessRights;});class DebugContext{constructor(env,defaultCategories){this.orm=env.services.orm;this.categories=new Map(defaultCategories.map((cat)=>[cat,[{}]]));}
activateCategory(category,context){const contexts=this.categories.get(category)||new Set();contexts.add(context);this.categories.set(category,contexts);return()=>{contexts.delete(context);if(contexts.size===0){this.categories.delete(category);}};}
async getItems(env){const accessRights=await getAccessRights(this.orm);return[...this.categories.entries()].flatMap(([category,contexts])=>{return debugRegistry.category(category).getAll().map((factory)=>factory(Object.assign({env,accessRights},...contexts)));}).filter(Boolean).sort((x,y)=>{const xSeq=x.sequence||1000;const ySeq=y.sequence||1000;return xSeq-ySeq;});}}
const debugContextSymbol=Symbol("debugContext");__exports.createDebugContext=createDebugContext;function createDebugContext(env,{categories=[]}={}){return{[debugContextSymbol]:new DebugContext(env,categories)};}
__exports.useOwnDebugContext=useOwnDebugContext;function useOwnDebugContext({categories=[]}={}){useSubEnv(createDebugContext(useEnv(),{categories}));}
__exports.useEnvDebugContext=useEnvDebugContext;function useEnvDebugContext(){const debugContext=useEnv()[debugContextSymbol];if(!debugContext){throw new Error("There is no debug context available in the current environment.");}
return debugContext;}
__exports.useDebugCategory=useDebugCategory;function useDebugCategory(category,context={}){const env=useEnv();if(env.debug){const debugContext=useEnvDebugContext();useEffect(()=>debugContext.activateCategory(category,context),()=>[]);}}
return __exports;});;

/* /web/static/src/core/debug/debug_menu.js */
odoo.define('@web/core/debug/debug_menu',['@web/core/l10n/translation','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/debug/debug_menu_basic','@web/core/commands/command_hook','@web/core/utils/hooks','@web/core/debug/debug_context'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{DebugMenuBasic}=require("@web/core/debug/debug_menu_basic");const{useCommand}=require("@web/core/commands/command_hook");const{useService}=require("@web/core/utils/hooks");const{useEnvDebugContext}=require("@web/core/debug/debug_context");const DebugMenu=__exports.DebugMenu=class DebugMenu extends DebugMenuBasic{setup(){super.setup();const debugContext=useEnvDebugContext();this.command=useService("command");useCommand(_t("Debug tools..."),async()=>{const items=await debugContext.getItems(this.env);let index=0;const defaultCategories=items.filter((item)=>item.type==="separator").map(()=>(index+=1));const provider={async provide(){const categories=[...defaultCategories];let category=categories.shift();const result=[];items.forEach((item)=>{if(item.type==="item"){result.push({name:item.description.toString(),action:item.callback,category,});}else if(item.type==="separator"){category=categories.shift();}});return result;},};const configByNamespace={default:{categories:defaultCategories,emptyMessage:_t("No debug command found"),placeholder:_t("Choose a debug command..."),},};const commandPaletteConfig={configByNamespace,providers:[provider],};return commandPaletteConfig;},{category:"debug",});}}
DebugMenu.components={Dropdown,DropdownItem};DebugMenu.props={};return __exports;});;

/* /web/static/src/core/debug/debug_menu_basic.js */
odoo.define('@web/core/debug/debug_menu_basic',['@web/core/debug/debug_context','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@odoo/owl'],function(require){'use strict';let __exports={};const{useEnvDebugContext}=require("@web/core/debug/debug_context");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{Component}=require("@odoo/owl");const DebugMenuBasic=__exports.DebugMenuBasic=class DebugMenuBasic extends Component{setup(){const debugContext=useEnvDebugContext();this.getElements=async()=>{this.elements=await debugContext.getItems(this.env);};}}
DebugMenuBasic.components={Dropdown,DropdownItem,};DebugMenuBasic.template="web.DebugMenu";return __exports;});;

/* /web/static/src/core/debug/debug_menu_items.js */
odoo.define('@web/core/debug/debug_menu_items',['@web/core/l10n/translation','@web/core/browser/browser','@web/core/browser/router_service','@web/core/registry'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{browser}=require("@web/core/browser/browser");const{routeToUrl}=require("@web/core/browser/router_service");const{registry}=require("@web/core/registry");function activateAssetsDebugging({env}){return{type:"item",description:_t("Activate Assets Debugging"),callback:()=>{browser.location.search="?debug=assets";},sequence:410,};}
function activateTestsAssetsDebugging({env}){return{type:"item",description:_t("Activate Tests Assets Debugging"),callback:()=>{browser.location.search="?debug=assets,tests";},sequence:420,};}
__exports.regenerateAssets=regenerateAssets;function regenerateAssets({env}){return{type:"item",description:_t("Regenerate Assets Bundles"),callback:async()=>{await env.services.orm.call("ir.attachment","regenerate_assets_bundles",);browser.location.reload();},sequence:430,};}
function becomeSuperuser({env}){const becomeSuperuserURL=browser.location.origin+"/web/become";return{type:"item",description:_t("Become Superuser"),hide:!env.services.user.isAdmin,href:becomeSuperuserURL,callback:()=>{browser.open(becomeSuperuserURL,"_self");},sequence:440,};}
function leaveDebugMode({env}){return{type:"item",description:_t("Leave the Developer Tools"),callback:()=>{const route=env.services.router.current;route.search.debug="";browser.location.href=browser.location.origin+routeToUrl(route);},sequence:450,};}
registry.category("debug").category("default").add("activateAssetsDebugging",activateAssetsDebugging).add("regenerateAssets",regenerateAssets).add("becomeSuperuser",becomeSuperuser).add("leaveDebugMode",leaveDebugMode).add("activateTestsAssetsDebugging",activateTestsAssetsDebugging);return __exports;});;

/* /web/static/src/core/debug/debug_providers.js */
odoo.define('@web/core/debug/debug_providers',['@web/core/l10n/translation','@web/core/registry','@web/core/browser/browser','@web/core/browser/router_service'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{browser}=require("@web/core/browser/browser");const{routeToUrl}=require("@web/core/browser/router_service");const commandProviderRegistry=registry.category("command_provider");commandProviderRegistry.add("debug",{provide:(env,options)=>{const result=[];if(env.debug){if(!env.debug.includes("assets")){result.push({action(){browser.location.search="?debug=assets";},category:"debug",name:_t("Activate debug mode (with assets)"),});}
result.push({action(){const route=env.services.router.current;route.search.debug="";browser.location.href=browser.location.origin+routeToUrl(route);},category:"debug",name:_t("Deactivate debug mode"),});result.push({action(){const runTestsURL=browser.location.origin+"/web/tests?debug=assets";browser.open(runTestsURL);},category:"debug",name:_t("Run JS Tests"),});result.push({action(){const runTestsURL=browser.location.origin+"/web/tests/mobile?debug=assets";browser.open(runTestsURL);},category:"debug",name:_t("Run JS Mobile Tests"),});}else{const debugKey="debug";if(options.searchValue.toLowerCase()===debugKey){result.push({action(){browser.location.search="?debug=assets";},category:"debug",name:`${_t("Activate debug mode (with assets)")} (${debugKey})`,});}}
return result;},});return __exports;});;

/* /web/static/src/core/debug/debug_utils.js */
odoo.define('@web/core/debug/debug_utils',[],function(require){'use strict';let __exports={};__exports.editModelDebug=editModelDebug;function editModelDebug(env,title,model,id){return env.services.action.doAction({res_model:model,res_id:id,name:title,type:"ir.actions.act_window",views:[[false,"form"]],view_mode:"form",target:"current",});}
return __exports;});;

/* /web/static/src/core/debug/profiling/profiling_item.js */
odoo.define('@web/core/debug/profiling/profiling_item',['@web/core/dropdown/dropdown_item','@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{useBus,useService}=require("@web/core/utils/hooks");const{Component,EventBus}=require("@odoo/owl");const ProfilingItem=__exports.ProfilingItem=class ProfilingItem extends Component{setup(){this.profiling=useService("profiling");useBus(this.props.bus,"UPDATE",this.render);}
changeParam(param,ev){this.profiling.setParam(param,ev.target.value);}
toggleParam(param){const value=this.profiling.state.params.execution_context_qweb;this.profiling.setParam(param,!value);}
openProfiles(){if(this.env.services.action){this.env.services.action.doAction("base.action_menu_ir_profile");}else{window.location="/web/#action=base.action_menu_ir_profile";}}}
ProfilingItem.components={DropdownItem};ProfilingItem.template="web.DebugMenu.ProfilingItem";ProfilingItem.props={bus:{type:EventBus},};return __exports;});;

/* /web/static/src/core/debug/profiling/profiling_qweb.js */
odoo.define('@web/core/debug/profiling/profiling_qweb',['@web/core/registry','@web/core/utils/hooks','@web/core/assets','@web/core/utils/render','@web/core/utils/timing','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{loadBundle}=require("@web/core/assets");const{renderToString}=require("@web/core/utils/render");const{useDebounced}=require("@web/core/utils/timing");const{Component,useState,useRef,onWillStart,onMounted,onWillUnmount}=require("@odoo/owl");class MenuItem extends Component{static template="web.ProfilingQwebView.menuitem";}
function processValue(value){const data=JSON.parse(value);for(const line of data[0].results.data){line.xpath=line.xpath.replace(/([^\]])\//g,"$1[1]/").replace(/([^\]])$/g,"$1[1]");}
return data;}
const ProfilingQwebView=__exports.ProfilingQwebView=class ProfilingQwebView extends Component{static template="web.ProfilingQwebView";static components={MenuItem};setup(){super.setup();this.orm=useService("orm");this.ace=useRef("ace");this.selector=useRef("selector");this.value=processValue(this.props.record.data[this.props.name]);this.state=useState({viewID:this.profile.data.length?this.profile.data[0].view_id:0,view:null,});this.renderProfilingInformation=useDebounced(this.renderProfilingInformation,100);onWillStart(async()=>{await loadBundle({jsLibs:["/web/static/lib/ace/ace.js",["/web/static/lib/ace/mode-python.js","/web/static/lib/ace/mode-xml.js","/web/static/lib/ace/mode-qweb.js",],],});await this._fetchViewData();this.state.view=this.viewObjects.find((view)=>view.id===this.state.viewID);});onMounted(()=>{this._startAce(this.ace.el);this._renderView();});onWillUnmount(()=>{if(this.aceEditor){this.aceEditor.destroy();}
this._unmoutInfo();});}
get profile(){return this.value?this.value[0].results:{archs:{},data:[]};}
async _fetchViewData(){const viewIDs=Array.from(new Set(this.profile.data.map((line)=>line.view_id)));const viewObjects=await this.orm.call("ir.ui.view","search_read",[],{fields:["id","display_name","key"],domain:[["id","in",viewIDs]],});for(const view of viewObjects){view.delay=0;view.query=0;const lines=this.profile.data.filter((l)=>l.view_id===view.id);const root=lines.find((l)=>l.xpath==="");if(root){view.delay+=root.delay;view.query+=root.query;}else{view.delay=lines.map((l)=>l.delay).reduce((a,b)=>a+b);view.query=lines.map((l)=>l.query).reduce((a,b)=>a+b);}
view.delay=Math.ceil(view.delay*10)/10;}
this.viewObjects=viewObjects;}
_formatDelay(delay){return delay?(Math.ceil(delay*10)/10).toFixed(1):".";}
_startAce(node){this.aceEditor=window.ace.edit(node);this.aceEditor.setOptions({maxLines:Infinity,showPrintMargin:false,highlightActiveLine:false,highlightGutterLine:true,readOnly:true,});this.aceEditor.renderer.setOptions({displayIndentGuides:true,showGutter:true,});this.aceEditor.renderer.$cursorLayer.element.style.display="none";this.aceEditor.$blockScrolling=true;this.aceSession=this.aceEditor.getSession();this.aceSession.setOptions({useWorker:false,mode:"ace/mode/qweb",tabSize:2,useSoftTabs:true,});this.aceEditor.renderer.on("afterRender",this.renderProfilingInformation.bind(this));}
renderProfilingInformation(){this._unmoutInfo();const flat={};const arch=[{xpath:"",children:[]}];const rows=this.ace.el.querySelectorAll(".ace_gutter .ace_gutter-cell");const elems=this.ace.el.querySelectorAll(".ace_tag-open, .ace_end-tag-close, .ace_end-tag-open, .ace_qweb");elems.forEach((node)=>{const parent=arch[arch.length-1];let xpath=parent.xpath;if(node.classList.contains("ace_end-tag-close")){let previous=node;while((previous=previous.previousElementSibling)){if(previous&&previous.classList.contains("ace_tag-name")){break;}}
const tag=previous&&previous.textContent;if(parent.tag===tag){arch.pop();}}else if(node.classList.contains("ace_end-tag-open")){const tag=node.nextElementSibling&&node.nextElementSibling.textContent;if(parent.tag===tag){arch.pop();}}else if(node.classList.contains("ace_qweb")){const directive=node.textContent;parent.directive.push({el:node,directive:directive,});let delay=0;let query=0;for(const line of this.profile.data){if(line.view_id===this.state.viewID&&line.xpath===xpath&&line.directive.includes(directive)){delay+=line.delay;query+=line.query;}}
if((delay||query)&&!node.querySelector(".o_info")){this._renderHover(delay,query,node);}}else if(node.classList.contains("ace_tag-open")){const nodeTagName=node.nextElementSibling;const aceLine=nodeTagName.parentNode;const index=[].indexOf.call(aceLine.parentNode.children,aceLine);const row=rows[index];xpath+="/"+nodeTagName.textContent;let i=1;while(flat[xpath+"["+i+"]"]){i++;}
xpath+="["+i+"]";flat[xpath]={xpath:xpath,tag:nodeTagName.textContent,children:[],directive:[],};arch.push(flat[xpath]);parent.children.push(flat[xpath]);const closed=!!row.querySelector(".ace_closed");const delays=[];const querys=[];const groups={};let displayDetail=false;for(const line of this.profile.data){if(line.view_id===this.state.viewID&&(closed?line.xpath.startsWith(xpath):line.xpath===xpath)){delays.push(line.delay);querys.push(line.query);const directive=line.directive.split("=")[0];if(!groups[directive]){groups[directive]={delays:[],querys:[],};}else{displayDetail=true;}
groups[directive].delays.push(this._formatDelay(line.delay));groups[directive].querys.push(line.query);}}
if(delays.length&&!row.querySelector(".o_info")){this._renderInfo(delays,querys,displayDetail,groups,row);}}
node.setAttribute("data-xpath",xpath);});}
_renderView(){const view=this.viewObjects.find((view)=>view.id===this.state.viewID);if(view){const arch=this.profile.archs[view.id]||"";if(this.aceSession.getValue()!==arch){this.aceSession.setValue(arch);}}else{this.aceSession.setValue("");}
this.state.view=view;}
_unmoutInfo(){if(this.hover){if(this.ace.el.querySelector(".o_ace_hover")){this.ace.el.querySelector(".o_ace_hover").remove();}}
if(this.info){if(this.ace.el.querySelector(".o_ace_info")){this.ace.el.querySelector(".o_ace_info").remove();}}}
_renderHover(delay,query,node){const xml=renderToString("web.ProfilingQwebView.hover",{delay:this._formatDelay(delay),query:query,});const div=new DOMParser().parseFromString(xml,"text/html").querySelector("div");node.insertBefore(div,node.firstChild);}
_renderInfo(delays,querys,displayDetail,groups,node){const xml=renderToString("web.ProfilingQwebView.info",{delay:this._formatDelay(delays.reduce((a,b)=>a+b,0)),query:querys.reduce((a,b)=>a+b,0)||".",displayDetail:displayDetail,groups:groups,});const div=new DOMParser().parseFromString(xml,"text/html").querySelector("div");node.insertBefore(div,node.firstChild);}
_onSelectView(ev){this.state.viewID=+ev.currentTarget.dataset.id;this._renderView();}}
const profilingQwebView=__exports.profilingQwebView={component:ProfilingQwebView,};registry.category("fields").add("profiling_qweb_view",profilingQwebView);return __exports;});;

/* /web/static/src/core/debug/profiling/profiling_service.js */
odoo.define('@web/core/debug/profiling/profiling_service',['@web/core/registry','@web/core/debug/profiling/profiling_item','@web/session','@web/core/debug/profiling/profiling_systray_item','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{ProfilingItem}=require("@web/core/debug/profiling/profiling_item");const{session}=require("@web/session");const{profilingSystrayItem}=require("@web/core/debug/profiling/profiling_systray_item");const{EventBus,reactive}=require("@odoo/owl");const systrayRegistry=registry.category("systray");const profilingService={dependencies:["orm"],start(env,{orm}){if(!env.debug){return;}
function notify(){if(systrayRegistry.contains("web.profiling")&&state.isEnabled===false){systrayRegistry.remove("web.profiling",profilingSystrayItem);}
if(!systrayRegistry.contains("web.profiling")&&state.isEnabled===true){systrayRegistry.add("web.profiling",profilingSystrayItem,{sequence:99});}
bus.trigger("UPDATE");}
const state=reactive({session:session.profile_session||false,collectors:session.profile_collectors||["sql","traces_async"],params:session.profile_params||{},get isEnabled(){return Boolean(state.session);},},notify);const bus=new EventBus();notify();async function setProfiling(params){const kwargs=Object.assign({collectors:state.collectors,params:state.params,profile:state.isEnabled,},params);const resp=await orm.call("ir.profile","set_profiling",[],kwargs);if(resp.type){env.services.action.doAction(resp);}else{state.session=resp.session;state.collectors=resp.collectors;state.params=resp.params;}}
function profilingSeparator(){return{type:"separator",sequence:500,};}
function profilingItem(){return{type:"component",Component:ProfilingItem,props:{bus},sequence:510,};}
registry.category("debug").category("default").add("profilingSeparator",profilingSeparator).add("profilingItem",profilingItem);return{state,async toggleProfiling(){await setProfiling({profile:!state.isEnabled});},async toggleCollector(collector){const nextCollectors=state.collectors.slice();const index=nextCollectors.indexOf(collector);if(index>=0){nextCollectors.splice(index,1);}else{nextCollectors.push(collector);}
await setProfiling({collectors:nextCollectors});},async setParam(key,value){const nextParams=Object.assign({},state.params);nextParams[key]=value;await setProfiling({params:nextParams});},isCollectorEnabled(collector){return state.collectors.includes(collector);},};},};registry.category("services").add("profiling",profilingService);return __exports;});;

/* /web/static/src/core/debug/profiling/profiling_systray_item.js */
odoo.define('@web/core/debug/profiling/profiling_systray_item',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");class ProfilingSystrayItem extends Component{}
ProfilingSystrayItem.template="web.ProfilingSystrayItem";const profilingSystrayItem=__exports.profilingSystrayItem={Component:ProfilingSystrayItem,};return __exports;});;

/* /web/static/src/core/dialog/dialog.js */
odoo.define('@web/core/dialog/dialog',['@web/core/hotkeys/hotkey_hook','@web/core/ui/ui_service','@web/core/utils/hooks','@odoo/owl','@web/core/utils/timing','@web/core/utils/draggable_hook_builder_owl'],function(require){'use strict';let __exports={};const{useHotkey}=require("@web/core/hotkeys/hotkey_hook");const{useActiveElement}=require("@web/core/ui/ui_service");const{useForwardRefToParent}=require("@web/core/utils/hooks");const{Component,onWillDestroy,useChildSubEnv,useExternalListener,useState}=require("@odoo/owl");const{throttleForAnimation}=require("@web/core/utils/timing");const{makeDraggableHook}=require("@web/core/utils/draggable_hook_builder_owl");const useDialogDraggable=makeDraggableHook({name:"useDialogDraggable",onWillStartDrag({ctx,addCleanup,addStyle,getRect}){const{height,width}=getRect(ctx.current.element);ctx.current.container=document.createElement("div");addStyle(ctx.current.container,{position:"fixed",top:"0",bottom:`${70 - height}px`,left:`${70 - width}px`,right:`${70 - width}px`,});ctx.current.element.after(ctx.current.container);addCleanup(()=>ctx.current.container.remove());},onDrop({ctx,getRect}){const{top,left}=getRect(ctx.current.element);return{left:left-ctx.current.elementRect.left,top:top-ctx.current.elementRect.top,};},});const Dialog=__exports.Dialog=class Dialog extends Component{setup(){this.modalRef=useForwardRefToParent("modalRef");useActiveElement("modalRef");this.data=useState(this.env.dialogData);useHotkey("escape",()=>this.onEscape());useHotkey("control+enter",()=>{const btns=document.querySelectorAll(".o_dialog:not(.o_inactive_modal) .modal-footer button");const firstVisibleBtn=Array.from(btns).find((btn)=>{const styles=getComputedStyle(btn);return styles.display!=="none";});if(firstVisibleBtn){firstVisibleBtn.click();}},{bypassEditableProtection:true});this.id=`dialog_${this.data.id}`;useChildSubEnv({inDialog:true,dialogId:this.id});this.position=useState({left:0,top:0});useDialogDraggable({enable:()=>!this.env.isSmall,ref:this.modalRef,elements:".modal-content",handle:".modal-header",ignore:"button",edgeScrolling:{enabled:false},onDrop:({top,left})=>{this.position.left+=left;this.position.top+=top;},});const throttledResize=throttleForAnimation(this.onResize.bind(this));useExternalListener(window,"resize",throttledResize);onWillDestroy(()=>{if(this.env.isSmall){this.data.scrollToOrigin();}});}
get isFullscreen(){return this.props.fullscreen||this.env.isSmall;}
get contentStyle(){return`top: ${this.position.top}px; left: ${this.position.left}px;`;}
onResize(){this.position.left=0;this.position.top=0;}
onEscape(){return this.dismiss();}
async dismiss(){if(this.data.dismiss){await this.data.dismiss();}
return this.data.close();}}
Dialog.template="web.Dialog";Dialog.props={contentClass:{type:String,optional:true},bodyClass:{type:String,optional:true},fullscreen:{type:Boolean,optional:true},footer:{type:Boolean,optional:true},header:{type:Boolean,optional:true},size:{type:String,optional:true,validate:(s)=>["sm","md","lg","xl","fs"].includes(s),},technical:{type:Boolean,optional:true},title:{type:String,optional:true},modalRef:{type:Function,optional:true},slots:{type:Object,shape:{default:Object,header:{type:Object,optional:true},footer:{type:Object,optional:true},},},withBodyPadding:{type:Boolean,optional:true},};Dialog.defaultProps={contentClass:"",bodyClass:"",fullscreen:false,footer:true,header:true,size:"lg",technical:true,title:"Odoo",withBodyPadding:true,};return __exports;});;

/* /web/static/src/core/dialog/dialog_service.js */
odoo.define('@web/core/dialog/dialog_service',['@web/core/registry','@odoo/owl','@web/core/utils/components'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{Component,markRaw,reactive,xml}=require("@odoo/owl");const{WithEnv}=require("@web/core/utils/components");class DialogWrapper extends Component{static template=xml`
        <WithEnv env="{ dialogData: props.subEnv }">
            <t t-component="props.subComponent" t-props="props.subProps" />
        </WithEnv>
    `;static components={WithEnv};static props=["*"];}
const dialogService=__exports.dialogService={dependencies:["overlay"],start(env,{overlay}){const stack=[];let nextId=0;const deactivate=()=>{for(const subEnv of stack){subEnv.isActive=false;}};const add=(dialogClass,props,options={})=>{const id=nextId++;const close=()=>remove();const subEnv=reactive({id,close,isActive:true,});deactivate();stack.push(subEnv);document.body.classList.add("modal-open");const scrollOrigin={top:window.scrollY,left:window.scrollX};subEnv.scrollToOrigin=()=>{if(!stack.length){window.scrollTo(scrollOrigin);}};const remove=overlay.add(DialogWrapper,{subComponent:dialogClass,subProps:markRaw({...props,close}),subEnv,},{onRemove:()=>{stack.pop();deactivate();if(stack.length){stack.at(-1).isActive=true;}else{document.body.classList.remove("modal-open");}
options.onClose?.();},});return remove;};function closeAll(){for(const dialog of[...stack].reverse()){dialog.close();}}
return{add,closeAll};},};registry.category("services").add("dialog",dialogService);return __exports;});;

/* /web/static/src/core/domain.js */
odoo.define('@web/core/domain',['@web/core/utils/arrays','@web/core/py_js/py','@web/core/py_js/py_utils','@web/core/utils/strings'],function(require){'use strict';let __exports={};const{shallowEqual}=require("@web/core/utils/arrays");const{evaluate,formatAST,parseExpr}=require("@web/core/py_js/py");const{toPyValue}=require("@web/core/py_js/py_utils");const{escapeRegExp}=require("@web/core/utils/strings");const InvalidDomainError=__exports.InvalidDomainError=class InvalidDomainError extends Error{}
const Domain=__exports.Domain=class Domain{static combine(domains,operator){if(domains.length===0){return new Domain([]);}
const domain1=domains[0]instanceof Domain?domains[0]:new Domain(domains[0]);if(domains.length===1){return domain1;}
const domain2=Domain.combine(domains.slice(1),operator);const result=new Domain([]);const astValues1=domain1.ast.value;const astValues2=domain2.ast.value;const op=operator==="AND"?"&":"|";const combinedAST={type:4,value:astValues1.concat(astValues2)};result.ast=normalizeDomainAST(combinedAST,op);return result;}
static and(domains){return Domain.combine(domains,"AND");}
static or(domains){return Domain.combine(domains,"OR");}
static not(domain){const result=new Domain(domain);result.ast.value.unshift({type:1,value:"!"});return result;}
static removeDomainLeaves(domain,keysToRemove){function processLeaf(elements,idx,operatorCtx,newDomain){const leaf=elements[idx];if(leaf.type===10){if(keysToRemove.includes(leaf.value[0].value)){if(operatorCtx==="&"){newDomain.ast.value.push(...Domain.TRUE.ast.value);}else if(operatorCtx==="|"){newDomain.ast.value.push(...Domain.FALSE.ast.value);}}else{newDomain.ast.value.push(leaf);}
return 1;}else if(leaf.type===1){if(leaf.value==="|"&&elements[idx+1].type===10&&elements[idx+2].type===10&&keysToRemove.includes(elements[idx+1].value[0].value)&&keysToRemove.includes(elements[idx+2].value[0].value)){newDomain.ast.value.push(...Domain.TRUE.ast.value);return 3;}
newDomain.ast.value.push(leaf);if(leaf.value==="!"){return 1+processLeaf(elements,idx+1,"&",newDomain);}
const firstLeafSkip=processLeaf(elements,idx+1,leaf.value,newDomain);const secondLeafSkip=processLeaf(elements,idx+1+firstLeafSkip,leaf.value,newDomain);return 1+firstLeafSkip+secondLeafSkip;}
return 0;}
domain=new Domain(domain);if(domain.ast.value.length===0){return domain;}
const newDomain=new Domain([]);processLeaf(domain.ast.value,0,"&",newDomain);return newDomain;}
constructor(descr=[]){if(descr instanceof Domain){return new Domain(descr.toString());}else{let rawAST;try{rawAST=typeof descr==="string"?parseExpr(descr):toAST(descr);}catch(error){throw new InvalidDomainError(`Invalid domain representation: ${descr.toString()}`,{cause:error,});}
this.ast=normalizeDomainAST(rawAST);}}
contains(record){const expr=evaluate(this.ast,record);return matchDomain(record,expr);}
toString(){return formatAST(this.ast);}
toList(context){return evaluate(this.ast,context);}
toJson(){try{const evaluatedAsList=this.toList({});const evaluatedDomain=new Domain(evaluatedAsList);if(evaluatedDomain.toString()===this.toString()){return evaluatedAsList;}
return this.toString();}catch{return this.toString();}}}
__exports.evalDomain=evalDomain;function evalDomain(modifier,evalContext){if(modifier&&typeof modifier!=="boolean"){modifier=new Domain(modifier).contains(evalContext);}
return Boolean(modifier);}
const TRUE_LEAF=[1,"=",1];const FALSE_LEAF=[0,"=",1];const TRUE_DOMAIN=new Domain([TRUE_LEAF]);const FALSE_DOMAIN=new Domain([FALSE_LEAF]);Domain.TRUE=TRUE_DOMAIN;Domain.FALSE=FALSE_DOMAIN;function toAST(domain){const elems=domain.map((elem)=>{switch(elem){case"!":case"&":case"|":return{type:1,value:elem};default:return{type:10,value:elem.map(toPyValue),};}});return{type:4,value:elems};}
function normalizeDomainAST(domain,op="&"){if(domain.type!==4){if(domain.type===10){const value=domain.value;if(value.findIndex((e)=>e.type===10)===-1||!value.every((e)=>e.type===10||e.type===1)){throw new InvalidDomainError("Invalid domain AST");}}else{throw new InvalidDomainError("Invalid domain AST");}}
if(domain.value.length===0){return domain;}
let expected=1;for(const child of domain.value){switch(child.type){case 1:if(child.value==="&"||child.value==="|"){expected++;}else if(child.value!=="!"){throw new InvalidDomainError("Invalid domain AST");}
break;case 4:case 10:if(child.value.length===3){expected--;break;}
throw new InvalidDomainError("Invalid domain AST");default:throw new InvalidDomainError("Invalid domain AST");}}
const values=domain.value.slice();while(expected<0){expected++;values.unshift({type:1,value:op});}
if(expected>0){throw new InvalidDomainError(`invalid domain ${formatAST(domain)} (missing ${expected} segment(s))`);}
return{type:4,value:values};}
function matchCondition(record,condition){if(typeof condition==="boolean"){return condition;}
const[field,operator,value]=condition;if(typeof field==="string"){const names=field.split(".");if(names.length>=2){return matchCondition(record[names[0]],[names.slice(1).join("."),operator,value]);}}
let likeRegexp,ilikeRegexp;if(["like","not like","ilike","not ilike"].includes(operator)){likeRegexp=new RegExp(`(.*)${escapeRegExp(value).replaceAll("%", "(.*)")}(.*)`,"g");ilikeRegexp=new RegExp(`(.*)${escapeRegExp(value).replaceAll("%", "(.*)")}(.*)`,"gi");}
const fieldValue=typeof field==="number"?field:record[field];switch(operator){case"=?":if([false,null].includes(value)){return true;}
case"=":case"==":if(Array.isArray(fieldValue)&&Array.isArray(value)){return shallowEqual(fieldValue,value);}
return fieldValue===value;case"!=":case"<>":return!matchCondition(record,[field,"==",value]);case"<":return fieldValue<value;case"<=":return fieldValue<=value;case">":return fieldValue>value;case">=":return fieldValue>=value;case"in":{const val=Array.isArray(value)?value:[value];const fieldVal=Array.isArray(fieldValue)?fieldValue:[fieldValue];return fieldVal.some((fv)=>val.includes(fv));}
case"not in":{const val=Array.isArray(value)?value:[value];const fieldVal=Array.isArray(fieldValue)?fieldValue:[fieldValue];return!fieldVal.some((fv)=>val.includes(fv));}
case"like":if(fieldValue===false){return false;}
return Boolean(fieldValue.match(likeRegexp));case"not like":if(fieldValue===false){return false;}
return Boolean(!fieldValue.match(likeRegexp));case"=like":if(fieldValue===false){return false;}
return new RegExp(escapeRegExp(value).replace(/%/g,".*")).test(fieldValue);case"ilike":if(fieldValue===false){return false;}
return Boolean(fieldValue.match(ilikeRegexp));case"not ilike":if(fieldValue===false){return false;}
return Boolean(!fieldValue.match(ilikeRegexp));case"=ilike":if(fieldValue===false){return false;}
return new RegExp(escapeRegExp(value).replace(/%/g,".*"),"i").test(fieldValue);}
throw new InvalidDomainError("could not match domain");}
function makeOperators(record){const match=matchCondition.bind(null,record);return{"!":(x)=>!match(x),"&":(a,b)=>match(a)&&match(b),"|":(a,b)=>match(a)||match(b),};}
function matchDomain(record,domain){if(domain.length===0){return true;}
const operators=makeOperators(record);const reversedDomain=Array.from(domain).reverse();const condStack=[];for(const item of reversedDomain){const operator=typeof item==="string"&&operators[item];if(operator){const operands=condStack.splice(-operator.length);condStack.push(operator(...operands));}else{condStack.push(item);}}
return matchCondition(record,condStack.pop());}
return __exports;});;

/* /web/static/src/core/domain_selector/domain_selector.js */
odoo.define('@web/core/domain_selector/domain_selector',['@web/core/domain_selector/utils','@odoo/owl','@web/core/domain','@web/core/tree_editor/tree_editor','@web/core/tree_editor/condition_tree','@web/core/model_field_selector/utils','@web/core/checkbox/checkbox','@web/core/utils/objects','@web/core/domain_selector/domain_selector_operator_editor','@web/core/tree_editor/tree_editor_operator_editor','@web/core/l10n/translation','@web/core/model_field_selector/model_field_selector'],function(require){'use strict';let __exports={};const{extractPathsFromDomain,useGetDefaultCondition}=require("@web/core/domain_selector/utils");const{Component,onWillStart,onWillUpdateProps}=require("@odoo/owl");const{Domain}=require("@web/core/domain");const{TreeEditor}=require("@web/core/tree_editor/tree_editor");const{domainFromTree,treeFromDomain,formatValue,condition,}=require("@web/core/tree_editor/condition_tree");const{useLoadFieldInfo}=require("@web/core/model_field_selector/utils");const{CheckBox}=require("@web/core/checkbox/checkbox");const{deepEqual}=require("@web/core/utils/objects");const{getDomainDisplayedOperators}=require("@web/core/domain_selector/domain_selector_operator_editor");const{getOperatorEditorInfo}=require("@web/core/tree_editor/tree_editor_operator_editor");const{_t}=require("@web/core/l10n/translation");const{ModelFieldSelector}=require("@web/core/model_field_selector/model_field_selector");const ARCHIVED_CONDITION=condition("active","in",[true,false]);const ARCHIVED_DOMAIN=`[("active", "in", [True, False])]`;const DomainSelector=__exports.DomainSelector=class DomainSelector extends Component{static template="web.DomainSelector";static components={TreeEditor,CheckBox};static props={domain:String,resModel:String,className:{type:String,optional:true},defaultConnector:{type:[{value:"&"},{value:"|"}],optional:true},isDebugMode:{type:Boolean,optional:true},readonly:{type:Boolean,optional:true},update:{type:Function,optional:true},};static defaultProps={isDebugMode:false,readonly:true,update:()=>{},};setup(){this.loadFieldInfo=useLoadFieldInfo();this.getDefaultCondition=useGetDefaultCondition();this.tree=null;this.defaultCondition=null;this.fieldDefs={};this.showArchivedCheckbox=false;this.includeArchived=false;onWillStart(()=>this.onPropsUpdated(this.props));onWillUpdateProps((np)=>this.onPropsUpdated(np));}
async onPropsUpdated(p){let domain;let isSupported=true;try{domain=new Domain(p.domain);}catch{isSupported=false;}
if(!isSupported){this.tree=null;this.defaultCondition=null;this.fieldDefs={};this.showArchivedCheckbox=false;this.includeArchived=false;return;}
const paths=new Set([...extractPathsFromDomain(domain),"active"]);await this.loadFieldDefs(p.resModel,paths);const[defaultCondition]=await Promise.all([this.getDefaultCondition(p.resModel),this.loadFieldDefs(p.resModel,paths),]);this.tree=treeFromDomain(domain,{getFieldDef:this.getFieldDef.bind(this),distributeNot:!p.isDebugMode,});this.defaultCondition=defaultCondition;this.showArchivedCheckbox=Boolean(this.fieldDefs.active);this.includeArchived=false;if(this.showArchivedCheckbox){if(this.tree.value==="&"){this.tree.children=this.tree.children.filter((child)=>{if(deepEqual(child,ARCHIVED_CONDITION)){this.includeArchived=true;return false;}
return true;});if(this.tree.children.length===1){this.tree=this.tree.children[0];}}else if(deepEqual(this.tree,ARCHIVED_CONDITION)){this.includeArchived=true;this.tree=treeFromDomain(`[]`);}}}
getFieldDef(path){if(typeof path==="string"){return this.fieldDefs[path];}
return null;}
getDefaultOperator(fieldDef){return getDomainDisplayedOperators(fieldDef)[0];}
getOperatorEditorInfo(node){const fieldDef=this.getFieldDef(node.path);const operators=getDomainDisplayedOperators(fieldDef);return getOperatorEditorInfo(operators);}
getPathEditorInfo(){const{resModel,isDebugMode}=this.props;return{component:ModelFieldSelector,extractProps:({update,value:path})=>{return{path,update,resModel,isDebugMode,readonly:false,};},isSupported:(path)=>[0,1].includes(path)||typeof path==="string",defaultValue:()=>"id",stringify:(path)=>formatValue(path),message:_t("Invalid field chain"),};}
async loadFieldDefs(resModel,paths){const promises=[];const fieldDefs={};for(const path of paths){if(typeof path==="string"){promises.push(this.loadFieldInfo(resModel,path).then(({fieldDef})=>{fieldDefs[path]=fieldDef;}));}}
await Promise.all(promises);this.fieldDefs=fieldDefs;}
toggleIncludeArchived(){this.includeArchived=!this.includeArchived;this.update(this.tree);}
resetDomain(){this.props.update("[]");}
onDomainChange(domain){this.props.update(domain,true);}
update(tree){const archiveDomain=this.includeArchived?ARCHIVED_DOMAIN:`[]`;const domain=tree?Domain.and([domainFromTree(tree),archiveDomain]).toString():archiveDomain;this.props.update(domain);}}
return __exports;});;

/* /web/static/src/core/domain_selector/domain_selector_operator_editor.js */
odoo.define('@web/core/domain_selector/domain_selector_operator_editor',[],function(require){'use strict';let __exports={};__exports.getDomainDisplayedOperators=getDomainDisplayedOperators;function getDomainDisplayedOperators(fieldDef){if(!fieldDef){fieldDef={};}
const{type,is_property}=fieldDef;if(is_property){switch(type){case"many2many":case"tags":return["in","not in","set","not_set"];case"many2one":case"selection":return["=","!=","set","not_set"];}}
switch(type){case"boolean":return["is","is_not"];case"selection":return["=","!=","in","not in","set","not_set"];case"char":case"text":case"html":return["=","!=","ilike","not ilike","in","not in","set","not_set"];case"date":case"datetime":return["=","!=",">",">=","<","<=","between","set","not_set"];case"integer":case"float":case"monetary":return["=","!=",">",">=","<","<=","between","ilike","not ilike","set","not_set",];case"many2one":case"many2many":case"one2many":return["in","not in","=","!=","ilike","not ilike","set","not_set"];case"json":return["=","!=","ilike","not ilike","set","not_set"];case"properties":return["set","not_set"];case undefined:return["="];default:return["=","!=",">",">=","<","<=","ilike","not ilike","like","not like","=like","=ilike","child_of","parent_of","in","not in","set","not_set",];}}
return __exports;});;

/* /web/static/src/core/domain_selector/utils.js */
odoo.define('@web/core/domain_selector/utils',['@web/core/domain','@web/core/tree_editor/tree_editor_value_editors','@web/core/domain_selector/domain_selector_operator_editor','@web/core/utils/hooks','@web/core/l10n/translation','@web/core/tree_editor/condition_tree','@web/core/model_field_selector/utils','@web/core/tree_editor/utils'],function(require){'use strict';let __exports={};const{Domain}=require("@web/core/domain");const{getDefaultValue}=require("@web/core/tree_editor/tree_editor_value_editors");const{getDomainDisplayedOperators}=require("@web/core/domain_selector/domain_selector_operator_editor");const{useService}=require("@web/core/utils/hooks");const{_t}=require("@web/core/l10n/translation");const{toValue,domainFromTree,normalizeValue,formatValue:toString,createVirtualOperators,condition,}=require("@web/core/tree_editor/condition_tree");const{useLoadFieldInfo,useLoadPathDescription}=require("@web/core/model_field_selector/utils");const{extractIdsFromTree,getDefaultPath,getPathsInTree,leafToString,useLoadDisplayNames,}=require("@web/core/tree_editor/utils");__exports.extractPathsFromDomain=extractPathsFromDomain;function extractPathsFromDomain(domain){domain=new Domain(domain);const paths=new Set();for(const node of domain.ast.value){if([4,10].includes(node.type)){paths.add(toValue(node.value[0]));}}
return[...paths];}
function getDefaultCondition(fieldDefs){const defaultPath=getDefaultPath(fieldDefs);const fieldDef=fieldDefs[defaultPath];const operator=getDomainDisplayedOperators(fieldDef)[0];const value=getDefaultValue(fieldDef,operator);return condition(fieldDef.name,operator,value);}
function getDefaultDomain(fieldDefs){return domainFromTree(getDefaultCondition(fieldDefs));}
__exports.useGetDefaultCondition=useGetDefaultCondition;function useGetDefaultCondition(){const fieldService=useService("field");return async(resModel)=>{const fieldDefs=await fieldService.loadFields(resModel);return getDefaultCondition(fieldDefs);};}
__exports.useGetDefaultLeafDomain=useGetDefaultLeafDomain;function useGetDefaultLeafDomain(){const fieldService=useService("field");return async(resModel)=>{const fieldDefs=await fieldService.loadFields(resModel);return getDefaultDomain(fieldDefs);};}
function simplifyTree(tree){if(tree.type==="condition"){return tree;}
const processedChildren=tree.children.map(simplifyTree);if(tree.value==="&"){return{...tree,children:processedChildren};}
const children=[];const childrenByPath={};for(const child of processedChildren){if(child.type==="connector"||typeof child.path!=="string"||!["=","in"].includes(child.operator)){children.push(child);}else{if(!childrenByPath[child.path]){childrenByPath[child.path]=[];}
childrenByPath[child.path].push(child);}}
for(const path in childrenByPath){if(childrenByPath[path].length===1){children.push(childrenByPath[path][0]);continue;}
const value=[];for(const child of childrenByPath[path]){if(child.operator==="="){value.push(child.value);}else{value.push(...child.value);}}
children.push(condition(path,"in",normalizeValue(value)));}
if(children.length===1){return{...children[0]};}
return{...tree,children};}
__exports.getDomainTreeDescription=getDomainTreeDescription;function getDomainTreeDescription(tree,getFieldDef,getDescription,displayNames,isSubExpression=true){if(tree.type==="connector"){const childDescriptions=tree.children.map((c)=>getDomainTreeDescription(c,getFieldDef,getDescription,displayNames));const separator=tree.value==="&"?_t("and"):_t("or");let description=childDescriptions.join(` ${separator} `);if(isSubExpression||tree.negate){description=`( ${description} )`;}
if(tree.negate){description=`! ${description}`;}
return description;}
const{path}=tree;const fieldDef=getFieldDef(path);const{operatorDescription,valueDescription}=leafToString(tree,fieldDef,displayNames[fieldDef?.relation||fieldDef?.comodel]);let description=`${getDescription(path)} ${operatorDescription} `;if(valueDescription){const{values,join,addParenthesis}=valueDescription;const jointedValues=values.join(` ${join} `);description+=addParenthesis?`( ${jointedValues} )`:jointedValues;}
return description;}
__exports.useGetDomainTreeDescription=useGetDomainTreeDescription;function useGetDomainTreeDescription(fieldService,nameService){fieldService||=useService("field");nameService||=useService("name");const loadFieldInfo=useLoadFieldInfo(fieldService);const loadPathDescription=useLoadPathDescription(fieldService);const loadDisplayNames=useLoadDisplayNames(nameService);return async(resModel,tree)=>{tree=simplifyTree(tree);const paths=getPathsInTree(tree);const promises=[];const pathFieldDefs={};const pathDescriptions={};for(const path of paths){promises.push(loadPathDescription(resModel,path).then(({displayNames})=>{pathDescriptions[toString(path)]=displayNames.join("  ");}),loadFieldInfo(resModel,path).then(({fieldDef})=>{pathFieldDefs[toString(path)]=fieldDef;}));}
await Promise.all(promises);const getFieldDef=(path)=>pathFieldDefs[toString(path)];const getDescription=(path)=>pathDescriptions[toString(path)];const idsByModel=extractIdsFromTree(tree,getFieldDef);const treeWithVirtualOperators=createVirtualOperators(tree,{getFieldDef});const displayNames=await loadDisplayNames(idsByModel);return getDomainTreeDescription(treeWithVirtualOperators,getFieldDef,getDescription,displayNames,false);};}
return __exports;});;

/* /web/static/src/core/domain_selector_dialog/domain_selector_dialog.js */
odoo.define('@web/core/domain_selector_dialog/domain_selector_dialog',['@web/core/l10n/translation','@odoo/owl','@web/core/dialog/dialog','@web/core/domain','@web/core/domain_selector/domain_selector','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{Component,useRef,useState}=require("@odoo/owl");const{Dialog}=require("@web/core/dialog/dialog");const{Domain}=require("@web/core/domain");const{DomainSelector}=require("@web/core/domain_selector/domain_selector");const{useService}=require("@web/core/utils/hooks");const DomainSelectorDialog=__exports.DomainSelectorDialog=class DomainSelectorDialog extends Component{static template="web.DomainSelectorDialog";static components={Dialog,DomainSelector,};static props={close:Function,onConfirm:Function,resModel:String,className:{type:String,optional:true},defaultConnector:{type:[{value:"&"},{value:"|"}],optional:true},domain:String,isDebugMode:{type:Boolean,optional:true},readonly:{type:Boolean,optional:true},text:{type:String,optional:true},confirmButtonText:{type:String,optional:true},disableConfirmButton:{type:Function,optional:true},discardButtonText:{type:String,optional:true},title:{type:String,optional:true},context:{type:Object,optional:true},};static defaultProps={isDebugMode:false,readonly:false,context:{},};setup(){this.notification=useService("notification");this.rpc=useService("rpc");this.orm=useService("orm");this.user=useService("user");this.state=useState({domain:this.props.domain});this.confirmButtonRef=useRef("confirm");}
get confirmButtonText(){return this.props.confirmButtonText||_t("Confirm");}
get dialogTitle(){return this.props.title||_t("Domain");}
get disabled(){if(this.props.disableConfirmButton){return this.props.disableConfirmButton(this.state.domain);}
return false;}
get discardButtonText(){return this.props.discardButtonText||_t("Discard");}
get domainSelectorProps(){return{className:this.props.className,resModel:this.props.resModel,readonly:this.props.readonly,isDebugMode:this.props.isDebugMode,defaultConnector:this.props.defaultConnector,domain:this.state.domain,update:(domain)=>{this.state.domain=domain;},};}
async onConfirm(){this.confirmButtonRef.el.disabled=true;let domain;let isValid;try{const evalContext={...this.user.context,...this.props.context};domain=new Domain(this.state.domain).toList(evalContext);}catch{isValid=false;}
if(isValid===undefined){isValid=await this.rpc("/web/domain/validate",{model:this.props.resModel,domain,});}
if(!isValid){if(this.confirmButtonRef.el){this.confirmButtonRef.el.disabled=false;}
this.notification.add(_t("Domain is invalid. Please correct it"),{type:"danger",});return;}
this.props.onConfirm(this.state.domain);this.props.close();}
onDiscard(){this.props.close();}}
return __exports;});;

/* /web/static/src/core/dropdown/accordion_item.js */
odoo.define('@web/core/dropdown/accordion_item',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component,onPatched,useState}=require("@odoo/owl");const ACCORDION=__exports.ACCORDION=Symbol("Accordion");const AccordionItem=__exports.AccordionItem=class AccordionItem extends Component{static template="web.AccordionItem";static components={};static props={slots:{type:Object,shape:{default:{},},},description:String,selected:{type:Boolean,optional:true,},class:{type:String,optional:true,},};static defaultProps={class:"",selected:false,};setup(){this.state=useState({open:false,});this.parentComponent=this.env[ACCORDION];onPatched(()=>{this.parentComponent?.accordionStateChanged?.();});}}
return __exports;});;

/* /web/static/src/core/dropdown/checkbox_item.js */
odoo.define('@web/core/dropdown/checkbox_item',['@web/core/dropdown/dropdown_item'],function(require){'use strict';let __exports={};const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const CheckboxItem=__exports.CheckboxItem=class CheckboxItem extends DropdownItem{}
CheckboxItem.template="web.CheckboxItem";CheckboxItem.props={...DropdownItem.props,checked:{type:Boolean,optional:false,},};return __exports;});;

/* /web/static/src/core/dropdown/dropdown.js */
odoo.define('@web/core/dropdown/dropdown',['@web/core/utils/hooks','@web/core/position_hook','@web/core/dropdown/dropdown_navigation_hook','@web/core/l10n/localization','@odoo/owl'],function(require){'use strict';let __exports={};const{useBus,useService}=require("@web/core/utils/hooks");const{usePosition}=require("@web/core/position_hook");const{useDropdownNavigation}=require("@web/core/dropdown/dropdown_navigation_hook");const{localization}=require("@web/core/l10n/localization");const{Component,EventBus,onWillStart,status,useEffect,useExternalListener,useRef,useState,useChildSubEnv,}=require("@odoo/owl");const DIRECTION_CARET_CLASS={bottom:"dropdown",top:"dropup",left:"dropstart",right:"dropend",};const DROPDOWN=__exports.DROPDOWN=Symbol("Dropdown");const Dropdown=__exports.Dropdown=class Dropdown extends Component{setup(){this.state=useState({open:this.props.startOpen,groupIsOpen:this.props.startOpen,directionCaretClass:null,});this.rootRef=useRef("root");onWillStart(()=>{if(this.state.open&&this.props.beforeOpen){return this.props.beforeOpen();}});useExternalListener(window,"click",this.onWindowClicked,{capture:true});useBus(Dropdown.bus,"state-changed",({detail})=>this.onDropdownStateChanged(detail));this.ui=useService("ui");useEffect(()=>{Promise.resolve().then(()=>{this.myActiveEl=this.ui.activeElement;});},()=>[]);this.parentDropdown=this.env[DROPDOWN];useChildSubEnv({[DROPDOWN]:{close:this.close.bind(this),closeAllParents:()=>{this.close();if(this.parentDropdown){this.parentDropdown.closeAllParents();}},},});useDropdownNavigation();const position=this.props.position||(this.parentDropdown?"right-start":"bottom-start");let[direction]=position.split("-");if(["left","right"].includes(direction)&&localization.direction==="rtl"){direction=direction==="left"?"right":"left";}
this.defaultDirection=direction;const positioningOptions={position,onPositioned:(el,{direction})=>{this.state.directionCaretClass=DIRECTION_CARET_CLASS[direction];},};if(this.props.container){positioningOptions.container=()=>typeof this.props.container==="function"?this.props.container():this.props.container;}
this.state.directionCaretClass=DIRECTION_CARET_CLASS[direction];this.togglerRef=useRef("togglerRef");if(this.props.toggler==="parent"){useEffect(()=>{const onClick=(ev)=>{if(this.rootRef.el.contains(ev.target)){return;}
this.toggle();};if(this.rootRef.el.parentElement.tabIndex===-1){this.rootRef.el.parentElement.tabIndex=-1;}
this.rootRef.el.parentElement.addEventListener("click",onClick);return()=>{this.rootRef.el.parentElement.removeEventListener("click",onClick);};},()=>[]);useEffect((open)=>{this.rootRef.el.parentElement.ariaExpanded=open?"true":"false";},()=>[this.state.open]);this.position=usePosition("menuRef",()=>this.rootRef.el.parentElement,positioningOptions);}else{const togglerRef=useRef("togglerRef");this.position=usePosition("menuRef",()=>togglerRef.el,positioningOptions);}
useEffect((isOpen)=>{if(isOpen){this.props.onOpened();}else{this.position.unlock();}},()=>[this.state.open]);}
async changeStateAndNotify(stateSlice){if(stateSlice.open&&this.props.beforeOpen){await this.props.beforeOpen();if(status(this)==="destroyed"){return;}}
if(!stateSlice.open){this.state.directionCaretClass=DIRECTION_CARET_CLASS[this.defaultDirection];}
Object.assign(this.state,stateSlice);const stateChangedPayload={emitter:this,newState:{...this.state},};Dropdown.bus.trigger("state-changed",stateChangedPayload);this.props.onStateChanged({...this.state});}
close(){return this.changeStateAndNotify({open:false,groupIsOpen:false});}
open(){return this.changeStateAndNotify({open:true,groupIsOpen:this.props.autoOpen});}
toggle(){const toggled=!this.state.open;return this.changeStateAndNotify({open:toggled,groupIsOpen:toggled&&this.props.autoOpen,});}
get showCaret(){return this.props.showCaret===undefined?this.parentDropdown:this.props.showCaret;}
onDropdownStateChanged(args){if(!this.rootRef.el||this.rootRef.el.contains(args.emitter.rootRef.el)||args.emitter.myActiveEl!==this.myActiveEl){return;}
if(args.emitter.rootRef.el.parentElement===this.rootRef.el.parentElement){this.state.groupIsOpen=args.newState.groupIsOpen&&this.props.autoOpen;if(this.state.open&&args.newState.open){this.state.open=false;}}else{if(this.state.open&&args.newState.open){this.close();}}}
onTogglerClick(){this.toggle();}
onTogglerMouseEnter(){if(this.state.groupIsOpen&&!this.state.open){this.togglerRef.el.focus();this.open();}}
isInActiveElement(){return this.ui.activeElement===this.myActiveEl;}
onWindowClicked(ev){if(!this.state.open){return;}
if(!this.isInActiveElement()){return;}
if(ev.target.closest(".o_datetime_picker")){return;}
const rootEl=this.props.toggler==="parent"?this.rootRef.el.parentElement:this.rootRef.el;const gotClickedInside=rootEl.contains(ev.target);if(!gotClickedInside){this.close();}}}
Dropdown.bus=new EventBus();Dropdown.defaultProps={menuDisplay:"d-block",autoOpen:true,holdOnHover:false,onOpened:()=>{},onStateChanged:()=>{},onScroll:()=>{},};Dropdown.props={class:{type:String,optional:true,},disabled:{type:Boolean,optional:true,},toggler:{type:String,optional:true,validate:(prop)=>["parent"].includes(prop),},skipTogglerTabbing:{type:Boolean,optional:true,},startOpen:{type:Boolean,optional:true,},autoOpen:{type:Boolean,optional:true,},menuClass:{type:String,optional:true,},menuDisplay:{type:String,optional:true,},beforeOpen:{type:Function,optional:true,},onOpened:{type:Function,optional:true,},onScroll:{type:Function,optional:true,},onStateChanged:{type:Function,optional:true,},togglerClass:{type:String,optional:true,},hotkey:{type:String,optional:true,},tooltip:{type:String,optional:true,},title:{type:String,optional:true,},position:{type:String,optional:true,},slots:{type:Object,optional:true,},showCaret:{type:Boolean,optional:true,},holdOnHover:{type:Boolean,optional:true,},container:{type:[Element,Function],optional:true,},};Dropdown.template="web.Dropdown";return __exports;});;

/* /web/static/src/core/dropdown/dropdown_item.js */
odoo.define('@web/core/dropdown/dropdown_item',['@web/core/dropdown/dropdown','@odoo/owl'],function(require){'use strict';let __exports={};const{DROPDOWN}=require("@web/core/dropdown/dropdown");const{Component}=require("@odoo/owl");const ParentClosingMode={None:"none",ClosestParent:"closest",AllParents:"all",};const DropdownItem=__exports.DropdownItem=class DropdownItem extends Component{onClick(ev){const{href,onSelected,parentClosingMode}=this.props;if(href){ev.preventDefault();}
if(onSelected){onSelected();}
const dropdown=this.env[DROPDOWN];if(!dropdown){return;}
const{ClosestParent,AllParents}=ParentClosingMode;switch(parentClosingMode){case ClosestParent:dropdown.close();break;case AllParents:dropdown.closeAllParents();break;}}
get dataAttributes(){const{dataset}=this.props;if(this.props.dataset){const attributes=Object.entries(dataset).map(([key,value])=>{return[`data-${key.replace(/[A-Z]/g, (char) => `-${char.toLowerCase()}`)}`,value];});return Object.fromEntries(attributes);}
return{};}}
DropdownItem.template="web.DropdownItem";DropdownItem.props={onSelected:{type:Function,optional:true,},class:{type:[String,Object],optional:true,},parentClosingMode:{type:ParentClosingMode,optional:true,},hotkey:{type:String,optional:true,},href:{type:String,optional:true,},slots:{type:Object,optional:true,},title:{type:String,optional:true,},dataset:{type:Object,optional:true,},};DropdownItem.defaultProps={parentClosingMode:ParentClosingMode.AllParents,};return __exports;});;

/* /web/static/src/core/dropdown/dropdown_navigation_hook.js */
odoo.define('@web/core/dropdown/dropdown_navigation_hook',['@web/core/utils/hooks','@web/core/browser/browser','@web/core/l10n/localization','@web/core/utils/scrolling','@odoo/owl','@web/core/dropdown/accordion_item'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{browser}=require("@web/core/browser/browser");const{localization}=require("@web/core/l10n/localization");const{scrollTo}=require("@web/core/utils/scrolling");const{useChildSubEnv,useComponent,useEffect,useRef}=require("@odoo/owl");const{ACCORDION}=require("@web/core/dropdown/accordion_item");const ACTIVE_MENU_ELEMENT_CLASS="focus";const MENU_ELEMENTS_SELECTORS=[":scope > .dropdown-item",":scope > .dropdown",":scope > .o_accordion > .dropdown-item",":scope > .o_accordion > .o_accordion_values > .dropdown-item",":scope > .o_dropdown_container > .dropdown-item",":scope > .o_dropdown_container > .dropdown",":scope > .o_dropdown_container > .o_accordion > .dropdown-item",":scope > .o_dropdown_container > .o_accordion > .o_accordion_values > .dropdown-item",];const NEXT_ACTIVE_INDEX_FNS={FIRST:()=>0,LAST:(list)=>list.length-1,NEXT:(list,prevActiveIndex)=>(prevActiveIndex+1)%list.length,PREV:(list,prevActiveIndex)=>(prevActiveIndex<=0?list.length:prevActiveIndex)-1,};__exports.useDropdownNavigation=useDropdownNavigation;function useDropdownNavigation(){const comp=useComponent();if(comp.parentDropdown&&comp.props.toggler==="parent"){throw new Error("A nested Dropdown must use its standard toggler");}
const originalOnTogglerClick=comp.onTogglerClick.bind(comp);comp.onTogglerClick=(ev)=>{if(comp.parentDropdown&&!ev.__fromDropdownNavigation){return;}
originalOnTogglerClick();};const originalOnTogglerMouseEnter=comp.onTogglerMouseEnter.bind(comp);comp.onTogglerMouseEnter=()=>{if(comp.parentDropdown){return;}
originalOnTogglerMouseEnter();};let mouseSelectionActive=true;const menuRef=useRef("menuRef");let menuElements=[];let cleanupMenuElements;const refreshMenuElements=()=>{if(!comp.state.open){return;}
const addedListeners=[];const queryResult=menuRef.el.querySelectorAll(MENU_ELEMENTS_SELECTORS.join());for(const el of queryResult){const isSubDropdown=el.classList.contains("dropdown");const isSubDropdownOpen=()=>el.classList.contains("show");const navTarget=isSubDropdown?el.querySelector(":scope > .dropdown-toggle"):el;let subDropdownTimeout;const closeSubDropdown=()=>{browser.clearTimeout(subDropdownTimeout);subDropdownTimeout=browser.setTimeout(()=>{if(isSubDropdownOpen()){const ev=new MouseEvent("click",{bubbles:false});ev.__fromDropdownNavigation=true;navTarget.dispatchEvent(ev);}},200);};const openSubDropdown=(immediate=false)=>{browser.clearTimeout(subDropdownTimeout);subDropdownTimeout=browser.setTimeout(()=>{if(!isSubDropdownOpen()){const ev=new MouseEvent("click",{bubbles:false});ev.__fromDropdownNavigation=true;navTarget.dispatchEvent(ev);}},immediate?0:200);};const makeOnlyActive=()=>{for(const menuElement of menuElements){if(menuElement.el===el){continue;}
menuElement.navTarget.classList.remove(ACTIVE_MENU_ELEMENT_CLASS);if(menuElement.isSubDropdown){menuElement.closeSubDropdown();}}
navTarget.classList.add(ACTIVE_MENU_ELEMENT_CLASS);navTarget.focus();};const menuElement={el,get isActive(){return navTarget.classList.contains(ACTIVE_MENU_ELEMENT_CLASS);},makeOnlyActive,navTarget,get isSubDropdownOpen(){return isSubDropdownOpen();},isSubDropdown,closeSubDropdown,openSubDropdown,};menuElements.push(menuElement);const elementListeners={mouseenter:()=>{if(!mouseSelectionActive){mouseSelectionActive=true;}else{makeOnlyActive();if(isSubDropdown){openSubDropdown();}}},};for(const[eventType,listener]of Object.entries(elementListeners)){navTarget.addEventListener(eventType,listener);}
addedListeners.push([navTarget,elementListeners]);}
cleanupMenuElements=()=>{menuElements=[];mouseSelectionActive=true;for(const[navTarget,listeners]of addedListeners){for(const[eventType,listener]of Object.entries(listeners)){navTarget.removeEventListener(eventType,listener);}}};return()=>cleanupMenuElements();};useEffect(refreshMenuElements);useChildSubEnv({[ACCORDION]:{accordionStateChanged:()=>{cleanupMenuElements?.();refreshMenuElements();},},});const getActiveMenuElement=()=>{return menuElements.find((menuElement)=>menuElement.isActive);};const setActiveMenuElement=(menuElement)=>{if(menuElements.length){if(typeof menuElement==="string"){const prevIndex=menuElements.indexOf(getActiveMenuElement());const nextIndex=NEXT_ACTIVE_INDEX_FNS[menuElement](menuElements,prevIndex);menuElement=menuElements[nextIndex];}
menuElement.makeOnlyActive();scrollTo(menuElement.el,{scrollable:menuElement.el.parentElement});}};useEffect((open)=>{if(open&&comp.parentDropdown){setActiveMenuElement("FIRST");}},()=>[comp.state.open]);const hotkeyService=useService("hotkey");const closeAndRefocus=()=>{const toFocus=comp.props.toggler==="parent"?comp.rootRef.el.parentElement:comp.rootRef.el.querySelector(":scope > .dropdown-toggle");comp.close().then(()=>{toFocus.focus();});};const closeSubDropdown=comp.parentDropdown?closeAndRefocus:()=>{};const openSubDropdown=()=>{const menuElement=getActiveMenuElement();if(menuElement&&menuElement.isSubDropdown){menuElement.openSubDropdown(true);}};const selectActiveMenuElement=()=>{const menuElement=getActiveMenuElement();if(menuElement){if(menuElement.isSubDropdown){menuElement.openSubDropdown(true);}else{menuElement.navTarget.click();}}};let hotkeyRemoves=[];const hotkeyCallbacks={home:()=>setActiveMenuElement("FIRST"),end:()=>setActiveMenuElement("LAST"),tab:()=>setActiveMenuElement("NEXT"),"shift+tab":()=>setActiveMenuElement("PREV"),arrowdown:()=>setActiveMenuElement("NEXT"),arrowup:()=>setActiveMenuElement("PREV"),arrowleft:localization.direction==="rtl"?openSubDropdown:closeSubDropdown,arrowright:localization.direction==="rtl"?closeSubDropdown:openSubDropdown,enter:selectActiveMenuElement,escape:closeAndRefocus,};useEffect((open)=>{if(!open){return;}
for(const[hotkey,callback]of Object.entries(hotkeyCallbacks)){const callbackWrapper=()=>{const hasOpenedSubDropdown=menuElements.some((m)=>m.isSubDropdownOpen);if(!hasOpenedSubDropdown){mouseSelectionActive=false;callback.call(comp);}};hotkeyRemoves.push(hotkeyService.add(hotkey,callbackWrapper,{allowRepeat:true}));}
return()=>{for(const removeHotkey of hotkeyRemoves){removeHotkey();}
hotkeyRemoves=[];};},()=>[comp.state.open]);}
return __exports;});;

/* /web/static/src/core/effects/effect_service.js */
odoo.define('@web/core/effects/effect_service',['@web/core/l10n/translation','@web/core/registry','@web/core/effects/rainbow_man'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{RainbowMan}=require("@web/core/effects/rainbow_man");const effectRegistry=registry.category("effects");function rainbowMan(env,params={}){let message=params.message;if(message instanceof jQuery){console.log("Providing a jQuery element to an effect is deprecated. Note that all event handlers will be lost.");message=message.html();}else if(message instanceof Element){console.log("Providing an HTML element to an effect is deprecated. Note that all event handlers will be lost.");message=message.outerHTML;}else if(!message){message=_t("Well Done!");}
if(env.services.user.showEffect){const props={imgUrl:params.img_url||"/web/static/img/smile.svg",fadeout:params.fadeout||"medium",message,Component:params.Component,props:params.props,};return{Component:RainbowMan,props};}
env.services.notification.add(message);}
effectRegistry.add("rainbow_man",rainbowMan);const effectService=__exports.effectService={dependencies:["overlay"],start(env,{overlay}){const add=(params={})=>{const type=params.type||"rainbow_man";const effect=effectRegistry.get(type);const{Component,props}=effect(env,params)||{};if(Component){const remove=overlay.add(Component,{...props,close:()=>remove(),});}};return{add};},};registry.category("services").add("effect",effectService);return __exports;});;

/* /web/static/src/core/effects/rainbow_man.js */
odoo.define('@web/core/effects/rainbow_man',['@web/core/browser/browser','@odoo/owl'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{Component,useEffect,useExternalListener,useState}=require("@odoo/owl");const RainbowMan=__exports.RainbowMan=class RainbowMan extends Component{setup(){useExternalListener(document.body,"click",this.closeRainbowMan);this.state=useState({isFading:false});this.delay=RainbowMan.rainbowFadeouts[this.props.fadeout];if(this.delay){useEffect(()=>{const timeout=browser.setTimeout(()=>{this.state.isFading=true;},this.delay);return()=>browser.clearTimeout(timeout);},()=>[]);}}
onAnimationEnd(ev){if(this.delay&&ev.animationName==="reward-fading-reverse"){ev.stopPropagation();this.closeRainbowMan();}}
closeRainbowMan(){this.props.close();}}
RainbowMan.template="web.RainbowMan";RainbowMan.props={fadeout:String,close:Function,message:String,imgUrl:String,Component:{type:Function,optional:true},props:{type:Object,optional:true},};RainbowMan.rainbowFadeouts={slow:4500,medium:3500,fast:2000,no:false};return __exports;});;

/* /web/static/src/core/emoji_picker/emoji_picker.js */
odoo.define('@web/core/emoji_picker/emoji_picker',['@web/core/utils/misc','@odoo/owl','@web/core/assets','@web/core/browser/browser','@web/core/l10n/translation','@web/core/popover/popover_hook','@web/core/utils/search','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{markEventHandled}=require("@web/core/utils/misc");const{Component,onMounted,onPatched,onWillDestroy,onWillPatch,onWillStart,onWillUnmount,useEffect,useRef,useState,}=require("@odoo/owl");const{loadBundle}=require("@web/core/assets");const{browser}=require("@web/core/browser/browser");const{_t}=require("@web/core/l10n/translation");const{usePopover}=require("@web/core/popover/popover_hook");const{fuzzyLookup}=require("@web/core/utils/search");const{useAutofocus,useService}=require("@web/core/utils/hooks");__exports.useEmojiPicker=useEmojiPicker;function useEmojiPicker(ref,props,options={}){const targets=[];const popover=usePopover(EmojiPicker,{...options,animation:false});props.storeScroll={scrollValue:0,set:(value)=>{props.storeScroll.scrollValue=value;},get:()=>{return props.storeScroll.scrollValue;},};function add(ref,onSelect,{show=false}={}){const toggler=()=>toggle(ref,onSelect);targets.push([ref,toggler]);if(!ref.el){return;}
ref.el.addEventListener("click",toggler);ref.el.addEventListener("mouseenter",loadEmoji);if(show){ref.el.click();}}
function toggle(ref,onSelect=props.onSelect){if(popover.isOpen){popover.close();}else{popover.open(ref.el,{...props,onSelect});}}
if(ref){add(ref);}
onMounted(()=>{for(const[ref,toggle]of targets){if(!ref.el){continue;}
ref.el.addEventListener("click",toggle);ref.el.addEventListener("mouseenter",loadEmoji);}});onWillPatch(()=>{for(const[ref,toggle]of targets){if(!ref.el){continue;}
ref.el.removeEventListener("click",toggle);ref.el.removeEventListener("mouseenter",loadEmoji);}});onPatched(()=>{for(const[ref,toggle]of targets){if(!ref.el){continue;}
ref.el.addEventListener("click",toggle);ref.el.addEventListener("mouseenter",loadEmoji);}});return{add,get isOpen(){return popover.isOpen;},};}
const loader=__exports.loader={loadEmoji:()=>loadBundle("web.assets_emoji"),};__exports.loadEmoji=loadEmoji;async function loadEmoji(){try{await loader.loadEmoji();return odoo.loader.modules.get("@web/core/emoji_picker/emoji_data");}catch{return{emojis:[],categories:[]};}}
const EMOJI_PER_ROW=__exports.EMOJI_PER_ROW=9;const EmojiPicker=__exports.EmojiPicker=class EmojiPicker extends Component{static props=["close?","onClose?","onSelect","state?","storeScroll?"];static template="web.EmojiPicker";categories=null;emojis=null;shouldScrollElem=null;lastSearchTerm;setup(){this.gridRef=useRef("emoji-grid");this.ui=useState(useService("ui"));this.state=useState({activeEmojiIndex:0,categoryId:null,recent:JSON.parse(browser.localStorage.getItem("web.emoji.frequent")||"{}"),searchTerm:"",});const onStorage=(ev)=>{if(ev.key==="web.emoji.frequent"){this.state.recent=ev.newValue?JSON.parse(ev.newValue):{};}else if(ev.key===null){this.state.recent={};}};browser.addEventListener("storage",onStorage);onWillDestroy(()=>{browser.removeEventListener("storage",onStorage);});useAutofocus();onWillStart(async()=>{const{categories,emojis}=await loadEmoji();this.categories=categories;this.emojis=emojis;this.emojiByCodepoints=Object.fromEntries(this.emojis.map((emoji)=>[emoji.codepoints,emoji]));this.state.categoryId=this.categories[0]?.sortId;this.recentCategory={name:"Frequently used",displayName:_t("Frequently used"),title:"",sortId:0,};});onMounted(()=>{if(this.emojis.length===0){return;}
this.highlightActiveCategory();if(this.props.storeScroll){this.gridRef.el.scrollTop=this.props.storeScroll.get();}});onPatched(()=>{if(this.emojis.length===0){return;}
if(this.shouldScrollElem){this.shouldScrollElem=false;const getElement=()=>this.gridRef.el.querySelector(`.o-EmojiPicker-category[data-category="${this.state.categoryId}"`);const elem=getElement();if(elem){elem.scrollIntoView();}else{this.shouldScrollElem=getElement;}}});useEffect(()=>{if(this.searchTerm){this.gridRef.el.scrollTop=0;this.state.categoryId=null;}else{if(this.lastSearchTerm){this.gridRef.el.scrollTop=0;}
this.highlightActiveCategory();}
this.lastSearchTerm=this.searchTerm;},()=>[this.searchTerm]);onWillUnmount(()=>{if(!this.gridRef.el){return;}
if(this.props.storeScroll){this.props.storeScroll.set(this.gridRef.el.scrollTop);}});}
get searchTerm(){return this.props.state?this.props.state.searchTerm:this.state.searchTerm;}
set searchTerm(value){if(this.props.state){this.props.state.searchTerm=value;}else{this.state.searchTerm=value;}}
get itemsNumber(){return this.recentEmojis.length+this.getEmojis().length;}
get recentEmojis(){return Object.entries(this.state.recent).sort(([,usage_1],[,usage_2])=>usage_2-usage_1).slice(0,42).map(([codepoints])=>this.emojiByCodepoints[codepoints]);}
onClick(ev){markEventHandled(ev,"emoji.selectEmoji");}
onKeydown(ev){switch(ev.key){case"ArrowUp":{const newIndex=this.state.activeEmojiIndex-EMOJI_PER_ROW;if(newIndex>=0){this.state.activeEmojiIndex=newIndex;}
break;}
case"ArrowDown":{const newIndex=this.state.activeEmojiIndex+EMOJI_PER_ROW;if(newIndex<this.itemsNumber){this.state.activeEmojiIndex=newIndex;}
break;}
case"ArrowRight":{if(this.state.activeEmojiIndex+1===this.itemsNumber){break;}
this.state.activeEmojiIndex++;ev.preventDefault();break;}
case"ArrowLeft":{const newIndex=Math.max(this.state.activeEmojiIndex-1,0);if(newIndex!==this.state.activeEmojiIndex){this.state.activeEmojiIndex=newIndex;ev.preventDefault();}
break;}
case"Enter":ev.preventDefault();this.gridRef.el.querySelector(`.o-EmojiPicker-content .o-Emoji[data-index="${this.state.activeEmojiIndex}"]`)?.click();break;case"Escape":this.props.close?.();this.props.onClose?.();ev.stopPropagation();}}
getEmojis(){if(this.searchTerm.length>1){return fuzzyLookup(this.searchTerm,this.emojis,(emoji)=>[emoji.name,...emoji.keywords,...emoji.emoticons,...emoji.shortcodes].join(" "));}
return this.emojis;}
selectCategory(ev){const id=Number(ev.currentTarget.dataset.id);this.searchTerm="";this.state.categoryId=id;this.shouldScrollElem=true;}
selectEmoji(ev){const codepoints=ev.currentTarget.dataset.codepoints;const resetOnSelect=!ev.shiftKey&&!this.ui.isSmall;this.props.onSelect(codepoints,resetOnSelect);this.state.recent[codepoints]??=0;this.state.recent[codepoints]++;browser.localStorage.setItem("web.emoji.frequent",JSON.stringify(this.state.recent));if(resetOnSelect){this.gridRef.el.scrollTop=0;this.props.close?.();this.props.onClose?.();}}
highlightActiveCategory(){if(!this.gridRef||!this.gridRef.el){return;}
const coords=this.gridRef.el.getBoundingClientRect();const res=document.elementFromPoint(coords.x,coords.y+1);if(!res){return;}
this.state.categoryId=parseInt(res.dataset.category);}}
return __exports;});;

/* /web/static/src/core/errors/error_dialogs.js */
odoo.define('@web/core/errors/error_dialogs',['@web/core/browser/browser','@web/core/dialog/dialog','@web/core/l10n/translation','@web/core/registry','@web/core/utils/hooks','@web/core/utils/strings','@odoo/owl'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{Dialog}=require("@web/core/dialog/dialog");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{capitalize}=require("@web/core/utils/strings");const{Component,useState,markup}=require("@odoo/owl");const standardErrorDialogProps=__exports.standardErrorDialogProps={traceback:{type:[String,{value:null}],optional:true},message:{type:String,optional:true},name:{type:String,optional:true},exceptionName:{type:[String,{value:null}],optional:true},data:{type:[Object,{value:null}],optional:true},subType:{type:[String,{value:null}],optional:true},code:{type:[Number,String,{value:null}],optional:true},type:{type:[String,{value:null}],optional:true},close:Function,};const odooExceptionTitleMap=__exports.odooExceptionTitleMap=new Map(Object.entries({"odoo.addons.base.models.ir_mail_server.MailDeliveryException":_t("MailDeliveryException"),"odoo.exceptions.AccessDenied":_t("Access Denied"),"odoo.exceptions.MissingError":_t("Missing Record"),"odoo.exceptions.UserError":_t("Invalid Operation"),"odoo.exceptions.ValidationError":_t("Validation Error"),"odoo.exceptions.AccessError":_t("Access Error"),"odoo.exceptions.Warning":_t("Warning"),}));const ErrorDialog=__exports.ErrorDialog=class ErrorDialog extends Component{setup(){this.state=useState({showTraceback:false,});}
onClickClipboard(){browser.navigator.clipboard.writeText(`${this.props.name}\n${this.props.message}\n${this.props.traceback}`);}}
ErrorDialog.template="web.ErrorDialog";ErrorDialog.components={Dialog};ErrorDialog.title=_t("Odoo Error");ErrorDialog.props={...standardErrorDialogProps};const ClientErrorDialog=__exports.ClientErrorDialog=class ClientErrorDialog extends ErrorDialog{}
ClientErrorDialog.title=_t("Odoo Client Error");const NetworkErrorDialog=__exports.NetworkErrorDialog=class NetworkErrorDialog extends ErrorDialog{}
NetworkErrorDialog.title=_t("Odoo Network Error");const RPCErrorDialog=__exports.RPCErrorDialog=class RPCErrorDialog extends ErrorDialog{setup(){super.setup();this.inferTitle();this.traceback=this.props.traceback;if(this.props.data&&this.props.data.debug){this.traceback=`${this.props.data.debug}\nThe above server error caused the following client error:\n${this.traceback}`;}}
inferTitle(){if(this.props.exceptionName&&odooExceptionTitleMap.has(this.props.exceptionName)){this.title=odooExceptionTitleMap.get(this.props.exceptionName).toString();return;}
if(!this.props.type){return;}
switch(this.props.type){case"server":this.title=_t("Odoo Server Error");break;case"script":this.title=_t("Odoo Client Error");break;case"network":this.title=_t("Odoo Network Error");break;}}
onClickClipboard(){browser.navigator.clipboard.writeText(`${this.props.name}\n${this.props.message}\n${this.traceback}`);}}
const WarningDialog=__exports.WarningDialog=class WarningDialog extends Component{setup(){this.title=this.inferTitle();const{data,message}=this.props;if(data&&data.arguments&&data.arguments.length>0){this.message=data.arguments[0];}else{this.message=message;}}
inferTitle(){if(this.props.exceptionName&&odooExceptionTitleMap.has(this.props.exceptionName)){return odooExceptionTitleMap.get(this.props.exceptionName).toString();}
return this.props.title||_t("Odoo Warning");}}
WarningDialog.template="web.WarningDialog";WarningDialog.components={Dialog};WarningDialog.props={...standardErrorDialogProps,title:{type:String,optional:true},};const RedirectWarningDialog=__exports.RedirectWarningDialog=class RedirectWarningDialog extends Component{setup(){this.actionService=useService("action");const{data,subType}=this.props;const[message,actionId,buttonText,additionalContext]=data.arguments;this.title=capitalize(subType)||_t("Odoo Warning");this.message=message;this.actionId=actionId;this.buttonText=buttonText;this.additionalContext=additionalContext;}
async onClick(){const options={};if(this.additionalContext){options.additionalContext=this.additionalContext;}
if(this.actionId.help){this.actionId.help=markup(this.actionId.help);}
await this.actionService.doAction(this.actionId,options);this.props.close();}}
RedirectWarningDialog.template="web.RedirectWarningDialog";RedirectWarningDialog.components={Dialog};RedirectWarningDialog.props={...standardErrorDialogProps};const Error504Dialog=__exports.Error504Dialog=class Error504Dialog extends Component{}
Error504Dialog.template="web.Error504Dialog";Error504Dialog.components={Dialog};Error504Dialog.title=_t("Request timeout");Error504Dialog.props={...standardErrorDialogProps};const SessionExpiredDialog=__exports.SessionExpiredDialog=class SessionExpiredDialog extends Component{onClick(){browser.location.reload();}}
SessionExpiredDialog.template="web.SessionExpiredDialog";SessionExpiredDialog.components={Dialog};SessionExpiredDialog.title=_t("Odoo Session Expired");SessionExpiredDialog.props={...standardErrorDialogProps};registry.category("error_dialogs").add("odoo.exceptions.AccessDenied",WarningDialog).add("odoo.exceptions.AccessError",WarningDialog).add("odoo.exceptions.MissingError",WarningDialog).add("odoo.exceptions.UserError",WarningDialog).add("odoo.exceptions.ValidationError",WarningDialog).add("odoo.exceptions.RedirectWarning",RedirectWarningDialog).add("odoo.http.SessionExpiredException",SessionExpiredDialog).add("werkzeug.exceptions.Forbidden",SessionExpiredDialog).add("504",Error504Dialog);return __exports;});;

/* /web/static/src/core/errors/error_service.js */
odoo.define('@web/core/errors/error_service',['@web/core/browser/feature_detection','@web/core/browser/browser','@web/core/registry','@web/core/errors/error_utils'],function(require){'use strict';let __exports={};const{isBrowserFirefox}=require("@web/core/browser/feature_detection");const{browser}=require("@web/core/browser/browser");const{registry}=require("@web/core/registry");const{completeUncaughtError,getErrorTechnicalName}=require("@web/core/errors/error_utils");const UncaughtError=__exports.UncaughtError=class UncaughtError extends Error{constructor(message){super(message);this.name=getErrorTechnicalName(this);this.traceback=null;}}
const UncaughtClientError=__exports.UncaughtClientError=class UncaughtClientError extends UncaughtError{constructor(message="Uncaught Javascript Error"){super(message);}}
const UncaughtPromiseError=__exports.UncaughtPromiseError=class UncaughtPromiseError extends UncaughtError{constructor(message="Uncaught Promise"){super(message);this.unhandledRejectionEvent=null;}}
const UncaughtCorsError=__exports.UncaughtCorsError=class UncaughtCorsError extends UncaughtError{constructor(message="Uncaught CORS Error"){super(message);}}
const errorService=__exports.errorService={start(env){function handleError(uncaughtError,retry=true){let originalError=uncaughtError;while(originalError instanceof Error&&"cause"in originalError){originalError=originalError.cause;}
for(const[name,handler]of registry.category("error_handlers").getEntries()){try{if(handler(env,uncaughtError,originalError)){break;}}catch(e){console.error(`A crash occured in error handler ${name} while handling ${uncaughtError}:`,e);return;}}
if(uncaughtError.event&&!uncaughtError.event.defaultPrevented&&uncaughtError.traceback){uncaughtError.event.preventDefault();console.error(uncaughtError.traceback);}}
browser.addEventListener("error",async(ev)=>{const{colno,error,filename,lineno,message}=ev;const errorsToIgnore=["ResizeObserver loop completed with undelivered notifications.","ResizeObserver loop limit exceeded",];if(!error&&errorsToIgnore.includes(message)){return;}
const isRedactedError=!filename&&!lineno&&!colno;const isThirdPartyScriptError=isRedactedError||(isBrowserFirefox()&&new URL(filename).origin!==window.location.origin);if(isThirdPartyScriptError&&!odoo.debug){return;}
let uncaughtError;if(isRedactedError){uncaughtError=new UncaughtCorsError();uncaughtError.traceback=`Unknown CORS error\n\n`+`An unknown CORS error occured.\n`+`The error probably originates from a JavaScript file served from a different origin.\n`+`(Opening your browser console might give you a hint on the error.)`;}else{uncaughtError=new UncaughtClientError();uncaughtError.event=ev;if(error instanceof Error){error.errorEvent=ev;const annotated=env.debug&&env.debug.includes("assets");await completeUncaughtError(uncaughtError,error,annotated);}}
uncaughtError.cause=error;handleError(uncaughtError);});browser.addEventListener("unhandledrejection",async(ev)=>{const error=ev.reason;const uncaughtError=new UncaughtPromiseError();uncaughtError.unhandledRejectionEvent=ev;uncaughtError.event=ev;if(error instanceof Error){error.errorEvent=ev;const annotated=env.debug&&env.debug.includes("assets");await completeUncaughtError(uncaughtError,error,annotated);}
uncaughtError.cause=error;handleError(uncaughtError);});},};registry.category("services").add("error",errorService,{sequence:1});return __exports;});;

/* /web/static/src/core/errors/error_utils.js */
odoo.define('@web/core/errors/error_utils',['@web/core/assets'],function(require){'use strict';let __exports={};const{loadJS}=require("@web/core/assets");function combineErrorNames(uncaughtError,originalError){const originalErrorName=getErrorTechnicalName(originalError);const uncaughtErrorName=getErrorTechnicalName(uncaughtError);if(originalErrorName===Error.name){return uncaughtErrorName;}else{return`${uncaughtErrorName} > ${originalErrorName}`;}}
__exports.fullTraceback=fullTraceback;function fullTraceback(error){let traceback=formatTraceback(error);let current=error.cause;while(current){traceback+=`\n\nCaused by: ${
            current instanceof Error ? formatTraceback(current) : current
        }`;current=current.cause;}
return traceback;}
__exports.fullAnnotatedTraceback=fullAnnotatedTraceback;async function fullAnnotatedTraceback(error){if(error.annotatedTraceback){return error.annotatedTraceback;}
if(error.errorEvent){error.errorEvent.preventDefault();}
let traceback;try{traceback=await annotateTraceback(error);let current=error.cause;while(current){traceback+=`\n\nCaused by: ${
                current instanceof Error ? await annotateTraceback(current) : current
            }`;current=current.cause;}}catch(e){console.warn("Failed to annotate traceback for error:",error,"failure reason:",e);traceback=fullTraceback(error);}
error.annotatedTraceback=traceback;if(error.errorEvent){throw error;}
return traceback;}
__exports.completeUncaughtError=completeUncaughtError;async function completeUncaughtError(uncaughtError,originalError,annotated=false){uncaughtError.name=combineErrorNames(uncaughtError,originalError);if(annotated){uncaughtError.traceback=await fullAnnotatedTraceback(originalError);}else{uncaughtError.traceback=fullTraceback(originalError);}
if(originalError.message){uncaughtError.message=`${uncaughtError.message} > ${originalError.message}`;}
uncaughtError.cause=originalError;}
__exports.getErrorTechnicalName=getErrorTechnicalName;function getErrorTechnicalName(error){return error.name!==Error.name?error.name:error.constructor.name;}
__exports.formatTraceback=formatTraceback;function formatTraceback(error){let traceback=error.stack;const errorName=getErrorTechnicalName(error);const descriptionLine=`${errorName}: ${error.message}`;if(error.stack.split("\n")[0].trim()!==descriptionLine){traceback=`${descriptionLine}\n${error.stack}`.replace(/\n/g,"\n    ");}
return traceback;}
__exports.annotateTraceback=annotateTraceback;async function annotateTraceback(error){const traceback=formatTraceback(error);try{await loadJS("/web/static/lib/stacktracejs/stacktrace.js");}catch{return traceback;}
if(error.stack){const regex=/ line (\d*) > (Function):(\d*)/gm;const subst=`:$1`;error.stack=error.stack.replace(regex,subst);}
let frames;try{frames=await StackTrace.fromError(error);}catch(e){console.warn("The following error could not be annotated:",error,e);return traceback;}
const lines=traceback.split("\n");if(lines[lines.length-1].trim()===""){lines.splice(-1);}
let lineIndex=0;let frameIndex=0;while(frameIndex<frames.length){const line=lines[lineIndex];if(!line.match(/:\d+:\d+\)?$/)){lineIndex++;continue;}
const frame=frames[frameIndex];const info=` (${frame.fileName}:${frame.lineNumber})`;lines[lineIndex]=line+info;lineIndex++;frameIndex++;}
return lines.join("\n");}
return __exports;});;

/* /web/static/src/core/errors/scss_error_dialog.js */
odoo.define('@web/core/errors/scss_error_dialog',['@web/core/browser/browser','@web/core/registry','@web/core/l10n/translation','@web/core/utils/urls'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{registry}=require("@web/core/registry");const{_t,translationIsReady}=require("@web/core/l10n/translation");const{getOrigin}=require("@web/core/utils/urls");const scssErrorNotificationService={dependencies:["notification"],start(env,{notification}){const origin=getOrigin();const assets=[...document.styleSheets].filter((sheet)=>{return(sheet.href?.includes("/web")&&sheet.href?.includes("/assets/")&&new URL(sheet.href,browser.location.origin).origin===origin);});translationIsReady.then(()=>{for(const asset of assets){let cssRules;try{cssRules=asset.cssRules;}catch{continue;}
const lastRule=cssRules?.[cssRules?.length-1];if(lastRule?.selectorText==="css_error_message"){const message=_t("The style compilation failed. This is an administrator or developer error that must be fixed for the entire database before continuing working. See browser console or server logs for details.");notification.add(message,{title:_t("Style error"),sticky:true,type:"danger",});console.log(lastRule.style.content.replaceAll("\\a","\n").replaceAll("\\*","*").replaceAll(`\\"`,`"`));}}});},};registry.category("services").add("scss_error_display",scssErrorNotificationService);return __exports;});;

/* /web/static/src/core/expression_editor/expression_editor.js */
odoo.define('@web/core/expression_editor/expression_editor',['@odoo/owl','@web/core/expression_editor/expression_editor_operator_editor','@web/core/tree_editor/condition_tree','@web/core/tree_editor/tree_editor','@web/core/tree_editor/tree_editor_operator_editor','@web/core/tree_editor/tree_editor_value_editors','@web/core/tree_editor/utils','@web/core/model_field_selector/model_field_selector','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{Component,onWillStart,onWillUpdateProps}=require("@odoo/owl");const{getExpressionDisplayedOperators}=require("@web/core/expression_editor/expression_editor_operator_editor");const{condition,expressionFromTree,treeFromExpression,}=require("@web/core/tree_editor/condition_tree");const{TreeEditor}=require("@web/core/tree_editor/tree_editor");const{getOperatorEditorInfo}=require("@web/core/tree_editor/tree_editor_operator_editor");const{getDefaultValue}=require("@web/core/tree_editor/tree_editor_value_editors");const{getDefaultPath}=require("@web/core/tree_editor/utils");const{ModelFieldSelector}=require("@web/core/model_field_selector/model_field_selector");const{_t}=require("@web/core/l10n/translation");function getDefaultCondition(fieldDefs){const defaultPath=getDefaultPath(fieldDefs);const fieldDef=fieldDefs[defaultPath];const operator=getExpressionDisplayedOperators(fieldDef)[0];const value=getDefaultValue(fieldDef,operator);return condition(fieldDef.name,operator,value);}
const ExpressionEditor=__exports.ExpressionEditor=class ExpressionEditor extends Component{static template="web.ExpressionEditor";static components={TreeEditor};static props={resModel:String,fields:Object,expression:String,update:Function,};setup(){onWillStart(()=>this.onPropsUpdated(this.props));onWillUpdateProps((nextProps)=>this.onPropsUpdated(nextProps));}
async onPropsUpdated(props){this.filteredFields=Object.fromEntries(Object.entries(props.fields).filter(([_,fieldDef])=>fieldDef.type!=="properties"));this.defaultCondition=getDefaultCondition(this.filteredFields);try{this.tree=treeFromExpression(props.expression,{getFieldDef:(name)=>this.getFieldDef(name,props),distributeNot:!this.isDebugMode,});}catch{this.tree=null;}}
getFieldDef(name,props=this.props){if(typeof name==="string"){return props.fields[name]||null;}
return null;}
getDefaultOperator(fieldDef){return getExpressionDisplayedOperators(fieldDef)[0];}
getOperatorEditorInfo(node){const fieldDef=this.getFieldDef(node.path);const operators=getExpressionDisplayedOperators(fieldDef);return getOperatorEditorInfo(operators);}
getPathEditorInfo(){return{component:ModelFieldSelector,extractProps:({value,update})=>({path:value,update,resModel:this.props.resModel,readonly:false,filter:(fieldDef)=>fieldDef.name in this.filteredFields,showDebugInput:false,followRelations:false,isDebugMode:this.isDebugMode,}),isSupported:(value)=>[0,1].includes(value)||value in this.filteredFields,stringify:(value)=>this.props.fields[value].string,defaultValue:()=>this.defaultCondition.path,message:_t("Field properties not supported"),};}
get isDebugMode(){return!!this.env.debug;}
onExpressionChange(expression){this.props.update(expression);}
resetExpression(){this.props.update("True");}
update(tree){const expression=expressionFromTree(tree,{getFieldDef:(name)=>this.getFieldDef(name),});this.props.update(expression);}}
return __exports;});;

/* /web/static/src/core/expression_editor/expression_editor_operator_editor.js */
odoo.define('@web/core/expression_editor/expression_editor_operator_editor',['@web/core/domain_selector/domain_selector_operator_editor'],function(require){'use strict';let __exports={};const{getDomainDisplayedOperators}=require("@web/core/domain_selector/domain_selector_operator_editor");const EXPRESSION_VALID_OPERATORS=["<","<=",">",">=","between","in","not in","=","!=","set","not_set","is","is_not",];__exports.getExpressionDisplayedOperators=getExpressionDisplayedOperators;function getExpressionDisplayedOperators(fieldDef){const operators=getDomainDisplayedOperators(fieldDef);return operators.filter((operator)=>EXPRESSION_VALID_OPERATORS.includes(operator));}
return __exports;});;

/* /web/static/src/core/expression_editor_dialog/expression_editor_dialog.js */
odoo.define('@web/core/expression_editor_dialog/expression_editor_dialog',['@odoo/owl','@web/core/dialog/dialog','@web/core/expression_editor/expression_editor','@web/core/py_js/py','@web/core/utils/hooks','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{Component,useRef,useState}=require("@odoo/owl");const{Dialog}=require("@web/core/dialog/dialog");const{ExpressionEditor}=require("@web/core/expression_editor/expression_editor");const{evaluateExpr}=require("@web/core/py_js/py");const{useService}=require("@web/core/utils/hooks");const{_t}=require("@web/core/l10n/translation");const ExpressionEditorDialog=__exports.ExpressionEditorDialog=class ExpressionEditorDialog extends Component{static components={Dialog,ExpressionEditor};static template="web.ExpressionEditorDialog";static props={close:Function,resModel:String,fields:Object,expression:String,onConfirm:Function,};setup(){this.notification=useService("notification");this.user=useService("user");this.state=useState({expression:this.props.expression,});this.confirmButtonRef=useRef("confirm");}
get expressionEditorProps(){return{resModel:this.props.resModel,fields:this.props.fields,expression:this.state.expression,update:(expression)=>{this.state.expression=expression;},};}
makeDefaultRecord(){const record={};for(const[name,{type}]of Object.entries(this.props.fields)){switch(type){case"integer":case"float":case"monetary":record[name]=name==="id"?false:0;break;case"one2many":case"many2many":record[name]=[];break;default:record[name]=false;}}
return record;}
async onConfirm(){this.confirmButtonRef.el.disabled=true;const record=this.makeDefaultRecord();const evalContext={...this.user.context,...record};try{evaluateExpr(this.state.expression,evalContext);}catch{if(this.confirmButtonRef.el){this.confirmButtonRef.el.disabled=false;}
this.notification.add(_t("Expression is invalid. Please correct it"),{type:"danger",});return;}
this.props.onConfirm(this.state.expression);this.props.close();}
onDiscard(){this.props.close();}}
return __exports;});;

/* /web/static/src/core/field_service.js */
odoo.define('@web/core/field_service',['@web/core/utils/cache','@web/core/domain','@web/core/registry'],function(require){'use strict';let __exports={};const{Cache}=require("@web/core/utils/cache");const{Domain}=require("@web/core/domain");const{registry}=require("@web/core/registry");const fieldService=__exports.fieldService={dependencies:["orm"],async:["loadFields","loadPath","loadPropertyDefinitions"],start(env,{orm}){const cache=new Cache((resModel,options)=>{return orm.call(resModel,"fields_get",[options.fieldNames,options.attributes]).catch((error)=>{cache.clear(resModel,options);return Promise.reject(error);});},(resModel,options)=>JSON.stringify([resModel,options.fieldNames,options.attributes]));env.bus.addEventListener("CLEAR-CACHES",()=>cache.invalidate());async function loadFields(resModel,options={}){if(typeof resModel!=="string"||!resModel){throw new Error(`Invalid model name: ${resModel}`);}
return cache.read(resModel,options);}
async function _loadPropertyDefinitions(fieldDefs,name,domain=[]){const{definition_record:definitionRecord,definition_record_field:definitionRecordField,}=fieldDefs[name];const definitionRecordModel=fieldDefs[definitionRecord].relation;domain=Domain.and([[[definitionRecordField,"!=",false]],domain]).toList();const result=await orm.webSearchRead(definitionRecordModel,domain,{specification:{display_name:{},[definitionRecordField]:{},},});const definitions={};for(const record of result.records){for(const definition of record[definitionRecordField]){definitions[definition.name]={is_property:true,searchable:true,record_id:record.id,record_name:record.display_name,...definition,};}}
return definitions;}
async function loadPropertyDefinitions(resModel,fieldName,domain){const fieldDefs=await loadFields(resModel);return _loadPropertyDefinitions(fieldDefs,fieldName,domain);}
async function _loadPath(resModel,fieldDefs,names){if(!fieldDefs){return{isInvalid:"path",names,modelsInfo:[]};}
const[name,...remainingNames]=names;const modelsInfo=[{resModel,fieldDefs}];if(resModel==="*"&&remainingNames.length){return{isInvalid:"path",names,modelsInfo};}
const fieldDef=fieldDefs[name];if((name!=="*"&&!fieldDef)||(name==="*"&&remainingNames.length)){return{isInvalid:"path",names,modelsInfo};}
if(!remainingNames.length){return{names,modelsInfo};}
let subResult;if(fieldDef.relation){subResult=await _loadPath(fieldDef.relation,await loadFields(fieldDef.relation),remainingNames);}else if(fieldDef.type==="properties"){subResult=await _loadPath("*",await _loadPropertyDefinitions(fieldDefs,name),remainingNames);}
if(subResult){const result={names,modelsInfo:[...modelsInfo,...subResult.modelsInfo],};if(subResult.isInvalid){result.isInvalid="path";}
return result;}
return{isInvalid:"path",names,modelsInfo};}
async function loadPath(resModel,path="*"){const fieldDefs=await loadFields(resModel);if(typeof path!=="string"||!path){throw new Error(`Invalid path: ${path}`);}
return _loadPath(resModel,fieldDefs,path.split("."));}
return{loadFields,loadPath,loadPropertyDefinitions};},};registry.category("services").add("field",fieldService);return __exports;});;

/* /web/static/src/core/file_input/file_input.js */
odoo.define('@web/core/file_input/file_input',['@web/core/utils/hooks','@odoo/owl','@web/core/utils/files'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{Component,onMounted,useRef,useState}=require("@odoo/owl");const{checkFileSize}=require("@web/core/utils/files");const FileInput=__exports.FileInput=class FileInput extends Component{setup(){this.http=useService("http");this.notification=useService("notification");this.fileInputRef=useRef("file-input");this.state=useState({isDisable:false,});onMounted(()=>{if(this.props.autoOpen){this.onTriggerClicked();}});}
get httpParams(){const{resId,resModel}=this.props;const params={csrf_token:odoo.csrf_token,ufile:[...this.fileInputRef.el.files],};if(resModel){params.model=resModel;}
if(resId!==undefined){params.id=resId;}
return params;}
async uploadFiles(params){if((params.ufile&&params.ufile.length)||params.file){const fileSize=(params.ufile&&params.ufile[0].size)||params.file.size;if(!checkFileSize(fileSize,this.notification)){return null;}}
const fileData=await this.http.post(this.props.route,params,"text");const parsedFileData=JSON.parse(fileData);if(parsedFileData.error){throw new Error(parsedFileData.error);}
return parsedFileData;}
async onFileInputChange(){this.state.isDisable=true;const parsedFileData=await this.uploadFiles(this.httpParams);if(parsedFileData){this.props.onUpload(parsedFileData,this.fileInputRef.el?this.fileInputRef.el.files:[]);this.fileInputRef.el.value=null;}
this.state.isDisable=false;}
async onTriggerClicked(){if(await this.props.beforeOpen()){this.fileInputRef.el.click();}}}
FileInput.defaultProps={acceptedFileExtensions:"*",hidden:false,multiUpload:false,onUpload:()=>{},route:"/web/binary/upload_attachment",beforeOpen:async()=>true,};FileInput.props={acceptedFileExtensions:{type:String,optional:true},autoOpen:{type:Boolean,optional:true},hidden:{type:Boolean,optional:true},multiUpload:{type:Boolean,optional:true},onUpload:{type:Function,optional:true},beforeOpen:{type:Function,optional:true},resId:{type:Number,optional:true},resModel:{type:String,optional:true},route:{type:String,optional:true},"*":true,};FileInput.template="web.FileInput";return __exports;});;

/* /web/static/src/core/file_upload/file_upload_progress_bar.js */
odoo.define('@web/core/file_upload/file_upload_progress_bar',['@web/core/l10n/translation','@web/core/utils/hooks','@web/core/confirmation_dialog/confirmation_dialog','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{useService}=require("@web/core/utils/hooks");const{ConfirmationDialog}=require("@web/core/confirmation_dialog/confirmation_dialog");const{Component}=require("@odoo/owl");const FileUploadProgressBar=__exports.FileUploadProgressBar=class FileUploadProgressBar extends Component{setup(){this.dialogService=useService("dialog");}
onCancel(){if(!this.props.fileUpload.xhr){return;}
this.dialogService.add(ConfirmationDialog,{body:_t("Do you really want to cancel the upload of %s?",this.props.fileUpload.title),confirm:()=>{this.props.fileUpload.xhr.abort();},});}}
FileUploadProgressBar.props={fileUpload:{type:Object},};FileUploadProgressBar.template="web.FileUploadProgressBar";return __exports;});;

/* /web/static/src/core/file_upload/file_upload_progress_container.js */
odoo.define('@web/core/file_upload/file_upload_progress_container',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const FileUploadProgressContainer=__exports.FileUploadProgressContainer=class FileUploadProgressContainer extends Component{}
FileUploadProgressContainer.template="web.FileUploadProgressContainer";FileUploadProgressContainer.props={Component:{optional:false},shouldDisplay:{type:Function,optional:true},fileUploads:{type:Object},};return __exports;});;

/* /web/static/src/core/file_upload/file_upload_progress_record.js */
odoo.define('@web/core/file_upload/file_upload_progress_record',['@web/core/l10n/translation','@web/core/file_upload/file_upload_progress_bar','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{FileUploadProgressBar}=require("@web/core/file_upload/file_upload_progress_bar");const{Component}=require("@odoo/owl");const FileUploadProgressRecord=__exports.FileUploadProgressRecord=class FileUploadProgressRecord extends Component{getProgressTexts(){const fileUpload=this.props.fileUpload;const percent=Math.round(fileUpload.progress*100);if(percent===100){return{left:_t("Processing..."),right:"",};}else{const mbLoaded=Math.round(fileUpload.loaded/1000000);const mbTotal=Math.round(fileUpload.total/1000000);return{left:_t("Uploading... (%s%)",percent),right:_t("(%s/%sMB)",mbLoaded,mbTotal),};}}}
FileUploadProgressRecord.components={FileUploadProgressBar,};const FileUploadProgressKanbanRecord=__exports.FileUploadProgressKanbanRecord=class FileUploadProgressKanbanRecord extends FileUploadProgressRecord{}
FileUploadProgressKanbanRecord.template="web.FileUploadProgressKanbanRecord";const FileUploadProgressDataRow=__exports.FileUploadProgressDataRow=class FileUploadProgressDataRow extends FileUploadProgressRecord{}
FileUploadProgressDataRow.template="web.FileUploadProgressDataRow";return __exports;});;

/* /web/static/src/core/file_upload/file_upload_service.js */
odoo.define('@web/core/file_upload/file_upload_service',['@web/core/l10n/translation','@web/core/registry','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{EventBus,reactive}=require("@odoo/owl");const fileUploadService=__exports.fileUploadService={dependencies:["notification"],createXhr(){return new window.XMLHttpRequest();},start(env,{notificationService}){const uploads=reactive({});let nextId=1;const bus=new EventBus();const upload=async(route,files,params={})=>{const xhr=this.createXhr();xhr.open("POST",route);const formData=new FormData();formData.append("csrf_token",odoo.csrf_token);for(const file of files){formData.append("ufile",file);}
if(params.buildFormData){params.buildFormData(formData);}
const upload=reactive({id:nextId++,xhr,data:formData,progress:0,loaded:0,total:0,state:"pending",title:files.length===1?files[0].name:_t("%s Files",files.length),type:files.length===1?files[0].type:undefined,});uploads[upload.id]=upload;xhr.upload.addEventListener("progress",async(ev)=>{upload.progress=ev.loaded/ev.total;upload.loaded=ev.loaded;upload.total=ev.total;upload.state="loading";});xhr.addEventListener("load",()=>{delete uploads[upload.id];upload.state="loaded";bus.trigger("FILE_UPLOAD_LOADED",{upload});});xhr.addEventListener("error",async()=>{delete uploads[upload.id];upload.state="error";if(params.displayErrorNotification!==undefined&&params.displayErrorNotification){notificationService.add(_t("An error occured while uploading."),{title:_t("Error"),sticky:true,});}
bus.trigger("FILE_UPLOAD_ERROR",{upload});});xhr.addEventListener("abort",async()=>{delete uploads[upload.id];upload.state="abort";bus.trigger("FILE_UPLOAD_ERROR",{upload});});xhr.send(formData);bus.trigger("FILE_UPLOAD_ADDED",{upload});return upload;};return{bus,upload,uploads};},};registry.category("services").add("file_upload",fileUploadService);return __exports;});;

/* /web/static/src/core/file_viewer/file_model.js */
odoo.define('@web/core/file_viewer/file_model',['@web/core/utils/urls'],function(require){'use strict';let __exports={};const{url}=require("@web/core/utils/urls");const FileModelMixin=__exports.FileModelMixin=T=>class extends T{accessToken;checksum;extension;filename;id;mimetype;name;type;tmpUrl;url;uploading;get defaultSource(){const route=url(this.urlRoute,this.urlQueryParams);const encodedRoute=encodeURIComponent(route);if(this.isPdf){return`/web/static/lib/pdfjs/web/viewer.html?file=${encodedRoute}#pagemode=none`;}
if(this.isUrlYoutube){const urlArr=this.url.split("/");let token=urlArr[urlArr.length-1];if(token.includes("watch")){token=token.split("v=")[1];const amp=token.indexOf("&");if(amp!==-1){token=token.substring(0,amp);}}
return`https://www.youtube.com/embed/${token}`;}
return route;}
get displayName(){return this.name||this.filename;}
get downloadUrl(){return url(this.urlRoute,{...this.urlQueryParams,download:true});}
get isImage(){const imageMimetypes=["image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/tiff","image/x-icon","image/webp",];return imageMimetypes.includes(this.mimetype);}
get isPdf(){return this.mimetype&&this.mimetype.startsWith("application/pdf");}
get isText(){const textMimeType=["application/javascript","application/json","text/css","text/html","text/plain",];return textMimeType.includes(this.mimetype);}
get isUrl(){return this.type==="url"&&this.url;}
get isUrlYoutube(){return!!this.url&&this.url.includes("youtu");}
get isVideo(){const videoMimeTypes=["audio/mpeg","video/x-matroska","video/mp4","video/webm"];return videoMimeTypes.includes(this.mimetype);}
get isViewable(){return((this.isText||this.isImage||this.isVideo||this.isPdf||this.isUrlYoutube)&&!this.uploading);}
get urlQueryParams(){if(this.uploading&&this.tmpUrl){return{};}
const params={access_token:this.accessToken,filename:this.name,unique:this.checksum,};for(const prop in params){if(!params[prop]){delete params[prop];}}
return params;}
get urlRoute(){if(this.isUrl){return this.url;}
if(this.uploading&&this.tmpUrl){return this.tmpUrl;}
return this.isImage?`/web/image/${this.id}`:`/web/content/${this.id}`;}}
const FileModel=__exports.FileModel=class FileModel extends FileModelMixin(Object){}
return __exports;});;

/* /web/static/src/core/file_viewer/file_viewer.js */
odoo.define('@web/core/file_viewer/file_viewer',['@odoo/owl','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{Component,useRef,useState}=require("@odoo/owl");const{useAutofocus,useService}=require("@web/core/utils/hooks");const FileViewer=__exports.FileViewer=class FileViewer extends Component{static template="web.FileViewer";static components={};static props=["files","startIndex","close?","modal?"];static defaultProps={modal:true,};setup(){useAutofocus();this.imageRef=useRef("image");this.zoomerRef=useRef("zoomer");this.isDragging=false;this.dragStartX=0;this.dragStartY=0;this.scrollZoomStep=0.1;this.zoomStep=0.5;this.minScale=0.5;this.translate={dx:0,dy:0,x:0,y:0,};this.state=useState({index:this.props.startIndex,file:this.props.files[this.props.startIndex],imageLoaded:false,scale:1,angle:0,});this.ui=useState(useService("ui"));}
onImageLoaded(){this.state.imageLoaded=true;}
close(){this.props.close&&this.props.close();}
next(){const last=this.props.files.length-1;this.activateFile(this.state.index===last?0:this.state.index+1);}
previous(){const last=this.props.files.length-1;this.activateFile(this.state.index===0?last:this.state.index-1);}
activateFile(index){this.state.index=index;this.state.file=this.props.files[index];}
onKeydown(ev){switch(ev.key){case"ArrowRight":this.next();break;case"ArrowLeft":this.previous();break;case"Escape":this.close();break;case"q":this.close();break;}
if(this.state.file.isImage){switch(ev.key){case"r":this.rotate();break;case"+":this.zoomIn();break;case"-":this.zoomOut();break;case"0":this.resetZoom();break;}}}
onWheelImage(ev){if(ev.deltaY>0){this.zoomOut({scroll:true});}else{this.zoomIn({scroll:true});}}
onMousedownImage(ev){if(this.isDragging){return;}
if(ev.button!==0){return;}
this.isDragging=true;this.dragStartX=ev.clientX;this.dragStartY=ev.clientY;}
onMouseupImage(){if(!this.isDragging){return;}
this.isDragging=false;this.translate.x+=this.translate.dx;this.translate.y+=this.translate.dy;this.translate.dx=0;this.translate.dy=0;this.updateZoomerStyle();}
onMousemoveView(ev){if(!this.isDragging){return;}
this.translate.dx=ev.clientX-this.dragStartX;this.translate.dy=ev.clientY-this.dragStartY;this.updateZoomerStyle();}
resetZoom(){this.state.scale=1;this.updateZoomerStyle();}
rotate(){this.state.angle+=90;}
zoomIn({scroll=false}={}){this.state.scale=this.state.scale+(scroll?this.scrollZoomStep:this.zoomStep);this.updateZoomerStyle();}
zoomOut({scroll=false}={}){if(this.state.scale===this.minScale){return;}
const unflooredAdaptedScale=this.state.scale-(scroll?this.scrollZoomStep:this.zoomStep);this.state.scale=Math.max(this.minScale,unflooredAdaptedScale);this.updateZoomerStyle();}
updateZoomerStyle(){const tx=this.imageRef.el.offsetWidth*this.state.scale>this.zoomerRef.el.offsetWidth?this.translate.x+this.translate.dx:0;const ty=this.imageRef.el.offsetHeight*this.state.scale>this.zoomerRef.el.offsetHeight?this.translate.y+this.translate.dy:0;if(tx===0){this.translate.x=0;}
if(ty===0){this.translate.y=0;}
this.zoomerRef.el.style="transform: "+`translate(${tx}px, ${ty}px)`;}
get imageStyle(){let style="transform: "+`scale3d(${this.state.scale}, ${this.state.scale}, 1) `+`rotate(${this.state.angle}deg);`;if(this.state.angle%180!==0){style+=`max-height: ${window.innerWidth}px; max-width: ${window.innerHeight}px;`;}else{style+="max-height: 100%; max-width: 100%;";}
return style;}
onClickPrint(){const printWindow=window.open("about:blank","_new");printWindow.document.open();printWindow.document.write(`
                <html>
                    <head>
                        <script>
                            function onloadImage() {
                                setTimeout('printImage()', 10);
                            }
                            function printImage() {
                                window.print();
                                window.close();
                            }
                        </script>
                    </head>
                    <body onload='onloadImage()'>
                        <img src="${this.state.file.defaultSource}" alt=""/>
                    </body>
                </html>`);printWindow.document.close();}}
return __exports;});;

/* /web/static/src/core/file_viewer/file_viewer_hook.js */
odoo.define('@web/core/file_viewer/file_viewer_hook',['@odoo/owl','@web/core/registry','@web/core/file_viewer/file_viewer'],function(require){'use strict';let __exports={};const{onWillDestroy}=require("@odoo/owl");const{registry}=require("@web/core/registry");const{FileViewer}=require("@web/core/file_viewer/file_viewer");let id=1;__exports.useFileViewer=useFileViewer;function useFileViewer(){const fileViewerId=`web.file_viewer${id++}`;function open(file,files=[file]){if(!file.isViewable){return;}
if(files.length>0){const viewableFiles=files.filter((file)=>file.isViewable);const index=viewableFiles.indexOf(file);registry.category("main_components").add(fileViewerId,{Component:FileViewer,props:{files:viewableFiles,startIndex:index,close},});}}
function close(){registry.category("main_components").remove(fileViewerId);}
onWillDestroy(close);return{open,close};}
return __exports;});;

/* /web/static/src/core/hotkeys/hotkey_hook.js */
odoo.define('@web/core/hotkeys/hotkey_hook',['@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{useEffect}=require("@odoo/owl");__exports.useHotkey=useHotkey;function useHotkey(hotkey,callback,options={}){const hotkeyService=useService("hotkey");useEffect(()=>hotkeyService.add(hotkey,callback,options),()=>[]);}
return __exports;});;

/* /web/static/src/core/hotkeys/hotkey_service.js */
odoo.define('@web/core/hotkeys/hotkey_service',['@web/core/browser/feature_detection','@web/core/registry','@web/core/browser/browser','@web/core/utils/ui'],function(require){'use strict';let __exports={};const{isMacOS}=require("@web/core/browser/feature_detection");const{registry}=require("@web/core/registry");const{browser}=require("@web/core/browser/browser");const{getVisibleElements}=require("@web/core/utils/ui");const ALPHANUM_KEYS="abcdefghijklmnopqrstuvwxyz0123456789".split("");const NAV_KEYS=["arrowleft","arrowright","arrowup","arrowdown","pageup","pagedown","home","end","backspace","enter","tab","delete","space",];const MODIFIERS=["alt","control","shift"];const AUTHORIZED_KEYS=[...ALPHANUM_KEYS,...NAV_KEYS,"escape"];__exports.getActiveHotkey=getActiveHotkey;function getActiveHotkey(ev){if(!ev.key){return"";}
if(ev.isComposing){return"";}
const hotkey=[];if(isMacOS()?ev.ctrlKey:ev.altKey){hotkey.push("alt");}
if(isMacOS()?ev.metaKey:ev.ctrlKey){hotkey.push("control");}
if(ev.shiftKey){hotkey.push("shift");}
let key=ev.key.toLowerCase();if(key===" "){key="space";}
if(ev.code&&ev.code.indexOf("Digit")===0){key=ev.code.slice(-1);}
if(!AUTHORIZED_KEYS.includes(key)&&ev.code&&ev.code.indexOf("Key")===0){key=ev.code.slice(-1).toLowerCase();}
if(!MODIFIERS.includes(key)){hotkey.push(key);}
return hotkey.join("+");}
const hotkeyService=__exports.hotkeyService={dependencies:["ui"],overlayModifier:"alt",start(env,{ui}){const registrations=new Map();let nextToken=0;let overlaysVisible=false;addListeners(browser);function addListeners(target){target.addEventListener("keydown",onKeydown);target.addEventListener("keyup",removeHotkeyOverlays);target.addEventListener("blur",removeHotkeyOverlays);target.addEventListener("click",removeHotkeyOverlays);}
function onKeydown(event){if(event.code&&event.code.indexOf("Numpad")===0&&/^\d$/.test(event.key)){return;}
const hotkey=getActiveHotkey(event);if(!hotkey){return;}
const{activeElement,isBlocked}=ui;if(isBlocked){return;}
const elementsWithAccessKey=document.querySelectorAll("[accesskey]");for(const el of elementsWithAccessKey){if(el instanceof HTMLElement){el.dataset.hotkey=el.accessKey;el.removeAttribute("accesskey");}}
if(!overlaysVisible&&hotkey===hotkeyService.overlayModifier){addHotkeyOverlays(activeElement);event.preventDefault();return;}
const singleKey=hotkey.split("+").pop();if(!AUTHORIZED_KEYS.includes(singleKey)){return;}
const targetIsEditable=event.target instanceof HTMLElement&&(/input|textarea/i.test(event.target.tagName)||event.target.isContentEditable)&&!event.target.matches("input[type=checkbox], input[type=radio]");const shouldProtectEditable=targetIsEditable&&!event.target.dataset.allowHotkeys&&singleKey!=="escape";const infos={activeElement,hotkey,isRepeated:event.repeat,target:event.target,shouldProtectEditable,};const dispatched=dispatch(infos);if(dispatched){event.preventDefault();event.stopImmediatePropagation();}
if(overlaysVisible){removeHotkeyOverlays();event.preventDefault();}}
function dispatch(infos){const{activeElement,hotkey,isRepeated,target,shouldProtectEditable}=infos;const reversedRegistrations=Array.from(registrations.values()).reverse();const domRegistrations=getDomRegistrations(hotkey,activeElement);const allRegistrations=reversedRegistrations.concat(domRegistrations);const candidates=allRegistrations.filter((reg)=>reg.hotkey===hotkey&&(reg.allowRepeat||!isRepeated)&&(reg.bypassEditableProtection||!shouldProtectEditable)&&(reg.global||reg.activeElement===activeElement)&&(!reg.isAvailable||reg.isAvailable())&&(!reg.area||(target instanceof Node&&reg.area()&&reg.area().contains(target))));let winner=candidates.shift();if(winner&&winner.area){for(const candidate of candidates.filter((c)=>Boolean(c.area))){if(candidate.area()&&winner.area().contains(candidate.area())){winner=candidate;}}}
if(winner){winner.callback({area:winner.area&&winner.area(),target,});return true;}
return false;}
function getDomRegistrations(hotkey,activeElement){const overlayModParts=hotkeyService.overlayModifier.split("+");if(!overlayModParts.every((el)=>hotkey.includes(el))){return[];}
const cleanHotkey=hotkey.split("+").filter((key)=>!overlayModParts.includes(key)).join("+");const elems=getVisibleElements(activeElement,`[data-hotkey='${cleanHotkey}' i]`);return elems.map((el)=>({hotkey,activeElement,bypassEditableProtection:true,callback:()=>{el.focus();el.click();},}));}
function addHotkeyOverlays(activeElement){for(const el of getVisibleElements(activeElement,"[data-hotkey]:not(:disabled)")){const hotkey=el.dataset.hotkey;const overlay=document.createElement("div");overlay.classList.add("o_web_hotkey_overlay","position-absolute","top-0","bottom-0","start-0","end-0","d-flex","justify-content-center","align-items-center","m-0","bg-black-50","h6");const overlayKbd=document.createElement("kbd");overlayKbd.className="small";overlayKbd.appendChild(document.createTextNode(hotkey.toUpperCase()));overlay.appendChild(overlayKbd);let overlayParent;if(el.tagName.toUpperCase()==="INPUT"){overlayParent=el.parentElement;}else{overlayParent=el;}
if(overlayParent.style.position!=="absolute"){overlayParent.style.position="relative";}
overlayParent.appendChild(overlay);}
overlaysVisible=true;}
function removeHotkeyOverlays(){for(const overlay of document.querySelectorAll(".o_web_hotkey_overlay")){overlay.remove();}
overlaysVisible=false;}
function registerHotkey(hotkey,callback,options={}){if(!hotkey||hotkey.length===0){throw new Error("You must specify an hotkey when registering a registration.");}
if(!callback||typeof callback!=="function"){throw new Error("You must specify a callback function when registering a registration.");}
const keys=hotkey.toLowerCase().split("+").filter((k)=>!MODIFIERS.includes(k));if(keys.some((k)=>!AUTHORIZED_KEYS.includes(k))){throw new Error(`You are trying to subscribe for an hotkey ('${hotkey}')
            that contains parts not whitelisted: ${keys.join(", ")}`);}else if(keys.length>1){throw new Error(`You are trying to subscribe for an hotkey ('${hotkey}')
            that contains more than one single key part: ${keys.join("+")}`);}
const token=nextToken++;const registration={hotkey:hotkey.toLowerCase(),callback,activeElement:null,allowRepeat:options&&options.allowRepeat,bypassEditableProtection:options&&options.bypassEditableProtection,global:options&&options.global,area:options&&options.area,isAvailable:options&&options.isAvailable,};Promise.resolve().then(()=>{registration.activeElement=ui.activeElement;});registrations.set(token,registration);return token;}
function unregisterHotkey(token){registrations.delete(token);}
return{add(hotkey,callback,options={}){const token=registerHotkey(hotkey,callback,options);return()=>{unregisterHotkey(token);};},registerIframe(iframe){addListeners(iframe.contentWindow);},};},};registry.category("services").add("hotkey",hotkeyService);return __exports;});;

/* /web/static/src/core/install_prompt/install_prompt.js */
odoo.define('@web/core/install_prompt/install_prompt',['@odoo/owl','@web/core/dialog/dialog','@web/core/browser/feature_detection'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{Dialog}=require("@web/core/dialog/dialog");const{isIOS}=require("@web/core/browser/feature_detection");const InstallPrompt=__exports.InstallPrompt=class InstallPrompt extends Component{static props={close:true,onClose:{type:Function},};static components={Dialog,};static template="web.InstallPrompt";get isMobileSafari(){return isIOS();}
onClose(){this.props.close();this.props.onClose();}}
return __exports;});;

/* /web/static/src/core/install_prompt/install_prompt_service.js */
odoo.define('@web/core/install_prompt/install_prompt_service',['@odoo/owl','@web/core/browser/browser','@web/core/browser/feature_detection','@web/core/registry','@web/core/install_prompt/install_prompt'],function(require){'use strict';let __exports={};const{reactive}=require("@odoo/owl");const{browser}=require("@web/core/browser/browser");const{isDisplayStandalone,isIOS,isMacOS,isBrowserSafari,}=require("@web/core/browser/feature_detection");const{registry}=require("@web/core/registry");const{InstallPrompt}=require("@web/core/install_prompt/install_prompt");const serviceRegistry=registry.category("services");const installPromptService={dependencies:["dialog"],start(env,{dialog}){let nativePrompt;const state=reactive({canPromptToInstall:false,decline,show,});const canBeInstalled=browser.BeforeInstallPromptEvent!==undefined||(isBrowserSafari()&&!isDisplayStandalone()&&(isIOS()||(isMacOS()&&browser.navigator.userAgent.match(/Version\/(\d+)/)[1]>=17)));const installationState=browser.localStorage.getItem("pwa.installationState");const isDeclined=installationState==="dismissed";if(canBeInstalled&&!isDeclined){browser.addEventListener("beforeinstallprompt",(ev)=>{ev.preventDefault();nativePrompt=ev;if(installationState==="accepted"){browser.localStorage.removeItem("pwa.installationState");}
state.canPromptToInstall=true;});if(isBrowserSafari()){state.canPromptToInstall=installationState!=="accepted";}}
async function show(){if(!state.canPromptToInstall){return;}
if(nativePrompt){const res=await nativePrompt.prompt();browser.localStorage.setItem("pwa.installationState",res.outcome);state.canPromptToInstall=false;}else if(isBrowserSafari()){dialog.add(InstallPrompt,{onClose:()=>this.decline(),});}}
function decline(){browser.localStorage.setItem("pwa.installationState","dismissed");state.canPromptToInstall=false;}
return state;},};serviceRegistry.add("installPrompt",installPromptService);return __exports;});;

/* /web/static/src/core/l10n/dates.js */
odoo.define('@web/core/l10n/dates',['@web/core/l10n/localization','@web/core/l10n/translation','@web/core/utils/functions','@web/core/utils/arrays'],function(require){'use strict';let __exports={};const{localization}=require("@web/core/l10n/localization");const{_t}=require("@web/core/l10n/translation");const{memoize}=require("@web/core/utils/functions");const{ensureArray}=require("@web/core/utils/arrays");const{DateTime,Settings}=luxon;const MIN_VALID_DATE=__exports.MIN_VALID_DATE=DateTime.fromObject({year:1000});const MAX_VALID_DATE=__exports.MAX_VALID_DATE=DateTime.fromObject({year:9999}).endOf("year");const SERVER_DATE_FORMAT="yyyy-MM-dd";const SERVER_TIME_FORMAT="HH:mm:ss";const SERVER_DATETIME_FORMAT=`${SERVER_DATE_FORMAT} ${SERVER_TIME_FORMAT}`;const nonAlphaRegex=/[^a-z]/gi;const nonDigitRegex=/[^\d]/g;const normalizeFormatTable={a:"ccc",A:"cccc",b:"MMM",B:"MMMM",d:"dd",H:"HH",I:"hh",j:"o",m:"MM",M:"mm",p:"a",S:"ss",W:"WW",w:"c",y:"yy",Y:"yyyy",c:"ccc MMM d HH:mm:ss yyyy",x:"MM/dd/yy",X:"HH:mm:ss",};const smartDateUnits={d:"days",m:"months",w:"weeks",y:"years",};const smartDateRegex=new RegExp(["^","([+-])","(\\d+)",`([${Object.keys(smartDateUnits).join("")}]?)`,"$"].join("\\s*"),"i");const dateCache=new WeakMap();const dateTimeCache=new WeakMap();const ConversionError=__exports.ConversionError=class ConversionError extends Error{name="ConversionError";}
__exports.areDatesEqual=areDatesEqual;function areDatesEqual(d1,d2){if(Array.isArray(d1)||Array.isArray(d2)){d1=ensureArray(d1);d2=ensureArray(d2);return d1.length===d2.length&&d1.every((d1Val,i)=>areDatesEqual(d1Val,d2[i]));}
if(d1 instanceof DateTime&&d2 instanceof DateTime&&d1!==d2){return d1.equals(d2);}else{return d1===d2;}}
__exports.clampDate=clampDate;function clampDate(desired,minDate,maxDate){if(maxDate<desired){return maxDate;}
if(minDate>desired){return minDate;}
return desired;}
__exports.is24HourFormat=is24HourFormat;function is24HourFormat(format){return/H/.test(format||localization.timeFormat);}
__exports.isInRange=isInRange;function isInRange(value,range){if(!value||!range){return false;}
if(Array.isArray(value)){const actualValues=value.filter(Boolean);if(actualValues.length<2){return isInRange(actualValues[0],range);}
return((value[0]<=range[0]&&range[0]<=value[1])||(range[0]<=value[0]&&value[0]<=range[1]));}else{return range[0]<=value&&value<=range[1];}}
__exports.isMeridiemFormat=isMeridiemFormat;function isMeridiemFormat(format){return/a/.test(format||localization.timeFormat);}
function isValidDate(date){return date&&date.isValid&&isInRange(date,[MIN_VALID_DATE,MAX_VALID_DATE]);}
function parseSmartDateInput(value){const match=value.match(smartDateRegex);if(match){let date=DateTime.local();const offset=parseInt(match[2],10);const unit=smartDateUnits[(match[3]||"d").toLowerCase()];if(match[1]==="+"){date=date.plus({[unit]:offset});}else{date=date.minus({[unit]:offset});}
return date;}
return false;}
const stripAlphaDupes=memoize(function stripAlphaDupes(str){return str.replace(/[a-z]/gi,(letter,index,str)=>letter===str[index-1]?"":letter);});const strftimeToLuxonFormat=__exports.strftimeToLuxonFormat=memoize(function strftimeToLuxonFormat(format){const output=[];let inToken=false;for(let index=0;index<format.length;++index){let character=format[index];if(character==="%"&&!inToken){inToken=true;continue;}
if(/[a-z]/gi.test(character)){if(inToken&&normalizeFormatTable[character]!==undefined){character=normalizeFormatTable[character];}else{character=`'${character}'`;}}
output.push(character);inToken=false;}
return output.join("");});__exports.today=today;function today(){return DateTime.local().startOf("day");}
__exports.formatDate=formatDate;function formatDate(value,options={}){if(!value){return"";}
const format=options.format||localization.dateFormat;return value.toFormat(format);}
__exports.formatDateTime=formatDateTime;function formatDateTime(value,options={}){if(!value){return"";}
const format=options.format||localization.dateTimeFormat;return value.setZone("default").toFormat(format);}
__exports.formatDuration=formatDuration;function formatDuration(seconds,showFullDuration){const displayStyle=showFullDuration?"long":"narrow";const numberOfValuesToDisplay=showFullDuration?2:1;const durationKeys=["years","months","days","hours","minutes"];if(seconds<60){seconds=60;}
seconds-=seconds%60;let duration=luxon.Duration.fromObject({seconds:seconds}).shiftTo(...durationKeys);duration=duration.shiftTo(...durationKeys.filter((key)=>duration.get(key)));const durationSplit=duration.toHuman({unitDisplay:displayStyle}).split(",");if(!showFullDuration&&duration.loc.locale.includes("en")&&duration.months>0){durationSplit[0]=durationSplit[0].replace("m","M");}
return durationSplit.slice(0,numberOfValuesToDisplay).join(",");}
__exports.serializeDate=serializeDate;function serializeDate(value){if(!dateCache.has(value)){dateCache.set(value,value.toFormat(SERVER_DATE_FORMAT,{numberingSystem:"latn"}));}
return dateCache.get(value);}
__exports.serializeDateTime=serializeDateTime;function serializeDateTime(value){if(!dateTimeCache.has(value)){dateTimeCache.set(value,value.setZone("utc").toFormat(SERVER_DATETIME_FORMAT,{numberingSystem:"latn"}));}
return dateTimeCache.get(value);}
__exports.parseDate=parseDate;function parseDate(value,options={}){const parsed=parseDateTime(value,{...options,format:options.format||localization.dateFormat});return parsed&&parsed.startOf("day");}
__exports.parseDateTime=parseDateTime;function parseDateTime(value,options={}){if(!value){return false;}
const fmt=options.format||localization.dateTimeFormat;const parseOpts={setZone:true,zone:"default",};const switchToLatin=Settings.defaultNumberingSystem!=="latn"&&/[0-9]/.test(value);if(switchToLatin){parseOpts.numberingSystem="latn";}
let result=DateTime.fromFormat(value,fmt,parseOpts);if(!isValidDate(result)){result=parseSmartDateInput(value);}
if(!isValidDate(result)){const fmtWoZero=stripAlphaDupes(fmt);result=DateTime.fromFormat(value,fmtWoZero,parseOpts);}
if(!isValidDate(result)){const digitList=value.split(nonDigitRegex).filter(Boolean);const fmtList=fmt.split(nonAlphaRegex).filter(Boolean);const valWoSeps=digitList.join("");let carry=0;const fmtWoSeps=fmtList.map((part,i)=>{const digitLength=(digitList[i]||"").length;const actualPart=part.slice(0,digitLength+carry);carry+=digitLength-actualPart.length;return actualPart;}).join("");result=DateTime.fromFormat(valWoSeps,fmtWoSeps,parseOpts);}
if(!isValidDate(result)){const valueDigits=value.replace(nonDigitRegex,"");if(valueDigits.length>4){result=DateTime.fromISO(value,parseOpts);if(!isValidDate(result)){result=DateTime.fromSQL(value,parseOpts);}}}
if(!isValidDate(result)){throw new ConversionError(_t("'%s' is not a correct date or datetime",value));}
if(switchToLatin){result=result.reconfigure({numberingSystem:Settings.defaultNumberingSystem,});}
return result.setZone("default");}
__exports.deserializeDate=deserializeDate;function deserializeDate(value){return DateTime.fromSQL(value,{numberingSystem:"latn",zone:"default"}).reconfigure({numberingSystem:Settings.defaultNumberingSystem,});}
__exports.deserializeDateTime=deserializeDateTime;function deserializeDateTime(value){return DateTime.fromSQL(value,{numberingSystem:"latn",zone:"utc"}).setZone("default").reconfigure({numberingSystem:Settings.defaultNumberingSystem,});}
return __exports;});;

/* /web/static/src/core/l10n/localization.js */
odoo.define('@web/core/l10n/localization',[],function(require){'use strict';let __exports={};const notReadyError=new Error("Localization parameters not ready yet. Maybe add 'localization' to your dependencies?");const localization=__exports.localization={dateFormat:notReadyError,dateTimeFormat:notReadyError,timeFormat:notReadyError,decimalPoint:notReadyError,direction:notReadyError,grouping:notReadyError,multiLang:notReadyError,thousandsSep:notReadyError,weekStart:notReadyError,code:notReadyError,};return __exports;});;

/* /web/static/src/core/l10n/localization_service.js */
odoo.define('@web/core/l10n/localization_service',['@web/session','@web/core/browser/browser','@web/core/registry','@web/core/l10n/dates','@web/core/l10n/localization','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{session}=require("@web/session");const{browser}=require("@web/core/browser/browser");const{registry}=require("@web/core/registry");const{strftimeToLuxonFormat}=require("@web/core/l10n/dates");const{localization}=require("@web/core/l10n/localization");const{translatedTerms,translationLoaded,translationIsReady}=require("@web/core/l10n/translation");const{Settings}=luxon;const NUMBERING_SYSTEMS=[[/^ar-(sa|sy|001)$/i,"arab"],[/^bn/i,"beng"],[/^bo/i,"tibt"],[/^pa-in/i,"guru"],[/^ta/i,"tamldec"],[/.*/i,"latn"],];const localizationService=__exports.localizationService={dependencies:["user"],start:async(env,{user})=>{const cacheHashes=session.cache_hashes||{};const translationsHash=cacheHashes.translations||new Date().getTime().toString();const lang=user.lang||document.documentElement.getAttribute("lang")?.replace(/-/g,"_");const translationURL=session.translationURL||"/web/webclient/translations";let url=`${translationURL}/${translationsHash}`;if(lang){url+=`?lang=${lang}`;}
const response=await browser.fetch(url);if(!response.ok){throw new Error("Error while fetching translations");}
const{lang_parameters:userLocalization,modules:modules,multi_lang:multiLang,}=await response.json();const terms={};for(const addon of Object.keys(modules)){for(const message of modules[addon].messages){terms[message.id]=message.string;}}
Object.assign(translatedTerms,terms);translatedTerms[translationLoaded]=true;translationIsReady.resolve(true);const language=lang||browser.navigator.language;const locale=language==="sr@latin"?"sr-Latn-RS":language.replace(/_/g,"-");Settings.defaultLocale=locale;for(const[re,numberingSystem]of NUMBERING_SYSTEMS){if(re.test(locale)){Settings.defaultNumberingSystem=numberingSystem;break;}}
const dateFormat=strftimeToLuxonFormat(userLocalization.date_format);const timeFormat=strftimeToLuxonFormat(userLocalization.time_format);const dateTimeFormat=`${dateFormat} ${timeFormat}`;const grouping=JSON.parse(userLocalization.grouping);Object.assign(localization,{dateFormat,timeFormat,dateTimeFormat,decimalPoint:userLocalization.decimal_point,direction:userLocalization.direction,grouping,multiLang,thousandsSep:userLocalization.thousands_sep,weekStart:userLocalization.week_start,code:language,});return localization;},};registry.category("services").add("localization",localizationService);return __exports;});;

/* /web/static/src/core/l10n/translation.js */
odoo.define('@web/core/l10n/translation',['@web/core/utils/concurrency','@web/core/utils/strings'],function(require){'use strict';let __exports={};const{Deferred}=require("@web/core/utils/concurrency");const{sprintf}=require("@web/core/utils/strings");const translationLoaded=__exports.translationLoaded=Symbol("translationLoaded");const translatedTerms=__exports.translatedTerms={[translationLoaded]:false,};const translationIsReady=__exports.translationIsReady=new Deferred();__exports._t=_t;function _t(term,...values){if(translatedTerms[translationLoaded]){const translation=translatedTerms[term]??term;if(values.length===0){return translation;}
return sprintf(translation,...values);}else{return new LazyTranslatedString(term,...values);}}
const _lt=__exports._lt=(term,...values)=>_t(term,...values);class LazyTranslatedString extends String{constructor(term,...values){super(term);this.values=values;}
valueOf(){const term=super.valueOf();if(translatedTerms[translationLoaded]){const translation=translatedTerms[term]??term;if(this.values.length===0){return translation;}
return sprintf(translation,...this.values);}else{throw new Error(`translation error`);}}
toString(){return this.valueOf();}}
_t("less than a minute ago");_t("about a minute ago");_t("%d minutes ago");_t("about an hour ago");_t("%d hours ago");_t("a day ago");_t("%d days ago");_t("about a month ago");_t("%d months ago");_t("about a year ago");_t("%d years ago");__exports.loadLanguages=loadLanguages;async function loadLanguages(orm){if(!loadLanguages.installedLanguages){loadLanguages.installedLanguages=await orm.call("res.lang","get_installed");}
return loadLanguages.installedLanguages;}
return __exports;});;

/* /web/static/src/core/l10n/utils.js */
odoo.define('@web/core/l10n/utils',[],function(require){'use strict';let __exports={};__exports.pyToJsLocale=pyToJsLocale;function pyToJsLocale(locale){if(!locale){return"";}
const match=locale.match(/^([a-z]+)(_[A-Z\d]+)?(@.+)?$/);if(!match){return locale;}
const[,language,territory,modifier]=match;const subtags=[language];if(modifier==="@latin"){subtags.push("Latn");}
if(territory){subtags.push(territory.slice(1));}
return subtags.join("-");}
return __exports;});;

/* /web/static/src/core/macro.js */
odoo.define('@web/core/macro',['@web/core/browser/browser','@web/core/utils/ui','@web/core/utils/concurrency'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{isVisible}=require("@web/core/utils/ui");const{Mutex}=require("@web/core/utils/concurrency");const ACTION_HELPERS=__exports.ACTION_HELPERS={click(el,_step){el.dispatchEvent(new MouseEvent("mouseover"));el.dispatchEvent(new MouseEvent("mouseenter"));el.dispatchEvent(new MouseEvent("mousedown"));el.dispatchEvent(new MouseEvent("mouseup"));el.click();el.dispatchEvent(new MouseEvent("mouseout"));el.dispatchEvent(new MouseEvent("mouseleave"));},text(el,step){this.click(el,step);el.value=step.value;el.dispatchEvent(new InputEvent("input",{bubbles:true}));el.dispatchEvent(new InputEvent("change",{bubbles:true}));},};const mutex=new Mutex();class TimeoutError extends Error{}
class Macro{constructor(descr){this.name=descr.name||"anonymous";this.timeoutDuration=descr.timeout||0;this.timeout=null;this.currentIndex=0;this.checkDelay=descr.checkDelay||0;this.isComplete=false;this.steps=descr.steps;this.onStep=descr.onStep||(()=>{});this.onError=descr.onError;this.onTimeout=descr.onTimeout;this.setTimer();}
async advance(){if(this.isComplete){return;}
const step=this.steps[this.currentIndex];const[proceedToAction,el]=this.checkTrigger(step);if(proceedToAction){this.safeCall(this.onStep,el,step);const actionResult=await this.performAction(el,step);if(!actionResult){this.currentIndex++;if(this.currentIndex===this.steps.length){this.isComplete=true;browser.clearTimeout(this.timeout);}else{this.setTimer();await this.advance();}}}}
checkTrigger({trigger}){let el;if(!trigger){return[true,el];}
if(typeof trigger==="function"){el=this.safeCall(trigger);}else if(typeof trigger==="string"){const triggerEl=document.querySelector(trigger);el=isVisible(triggerEl)&&triggerEl;}else{throw new Error(`Trigger can only be string or function.`);}
if(el){return[true,el];}else{return[false,el];}}
async performAction(el,step){const action=step.action;let actionResult;if(action in ACTION_HELPERS){actionResult=ACTION_HELPERS[action](el,step);}else if(typeof action==="function"){actionResult=await this.safeCall(action,el,step);}
return actionResult;}
safeCall(fn,...args){if(this.isComplete){return;}
try{return fn(...args);}catch(e){this.handleError(e);}}
setTimer(){if(this.timeoutDuration){browser.clearTimeout(this.timeout);this.timeout=browser.setTimeout(()=>{if(this.onTimeout){const index=this.currentIndex;const step=this.steps[index];this.safeCall(this.onTimeout,step,index);}else{const error=new TimeoutError("Step timeout");this.handleError(error);}},this.timeoutDuration);}}
handleError(error){this.isComplete=true;browser.clearTimeout(this.timeout);if(this.onError){const index=this.currentIndex;const step=this.steps[index];this.onError(error,step,index);}else{console.error(error);}}}
const MacroEngine=__exports.MacroEngine=class MacroEngine{constructor(params={}){this.isRunning=false;this.timeout=null;this.target=params.target||document.body;this.defaultCheckDelay=params.defaultCheckDelay??750;this.macros=new Set();this.observerOptions={attributes:true,childList:true,subtree:true,characterData:true,};this.observer=new MutationObserver(this.delayedCheck.bind(this));this.iframeObserver=new MutationObserver(()=>{const iframeEl=document.querySelector("iframe.o_iframe");if(iframeEl){iframeEl.addEventListener("load",()=>{if(iframeEl.contentDocument){this.observer.observe(iframeEl.contentDocument,this.observerOptions);}});if(!iframeEl.src){if(iframeEl.contentDocument){this.observer.observe(iframeEl.contentDocument,this.observerOptions);}}}});}
async activate(descr,exclusive=false){if(this.exclusive){return;}
this.exclusive=exclusive;await Promise.resolve();const macro=new Macro(descr);if(exclusive){this.macros=new Set([macro]);}else{this.macros.add(macro);}
this.start();}
start(){if(!this.isRunning){this.isRunning=true;this.observer.observe(this.target,this.observerOptions);this.iframeObserver.observe(this.target,{childList:true,subtree:true});}
this.delayedCheck();}
stop(){if(this.isRunning){this.isRunning=false;browser.clearTimeout(this.timeout);this.timeout=null;this.observer.disconnect();this.iframeObserver.disconnect();}}
delayedCheck(){if(this.timeout){browser.clearTimeout(this.timeout);}
this.timeout=browser.setTimeout(()=>mutex.exec(this.advanceMacros.bind(this)),this.getCheckDelay()||this.defaultCheckDelay);}
getCheckDelay(){return[...this.macros].map((m)=>m.checkDelay).filter((delay)=>delay>0).reduce((m,v)=>Math.min(m,v),this.defaultCheckDelay);}
async advanceMacros(){await Promise.all([...this.macros].map((macro)=>macro.advance()));for(const macro of this.macros){if(macro.isComplete){this.macros.delete(macro);}}
if(this.macros.size===0){this.stop();}}}
return __exports;});;

/* /web/static/src/core/main_components_container.js */
odoo.define('@web/core/main_components_container',['@web/core/registry','@web/core/utils/components','@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{ErrorHandler}=require("@web/core/utils/components");const{useBus}=require("@web/core/utils/hooks");const{Component,xml}=require("@odoo/owl");const MainComponentsContainer=__exports.MainComponentsContainer=class MainComponentsContainer extends Component{setup(){const mainComponents=registry.category("main_components");this.Components=mainComponents.getEntries();useBus(mainComponents,"UPDATE",()=>{this.Components=mainComponents.getEntries();this.render();});}
handleComponentError(error,C){this.Components.splice(this.Components.indexOf(C),1);this.render();Promise.resolve().then(()=>{throw error;});}}
MainComponentsContainer.template=xml`
<div class="o-main-components-container">
    <t t-foreach="Components" t-as="C" t-key="C[0]">
        <ErrorHandler onError="error => this.handleComponentError(error, C)">
            <t t-component="C[1].Component" t-props="C[1].props"/>
        </ErrorHandler>
    </t>
</div>
`;MainComponentsContainer.components={ErrorHandler};MainComponentsContainer.props={};return __exports;});;

/* /web/static/src/core/model_field_selector/model_field_selector.js */
odoo.define('@web/core/model_field_selector/model_field_selector',['@odoo/owl','@web/core/utils/concurrency','@web/core/model_field_selector/model_field_selector_popover','@web/core/model_field_selector/utils','@web/core/popover/popover_hook'],function(require){'use strict';let __exports={};const{Component,onWillStart,onWillUpdateProps,useState}=require("@odoo/owl");const{KeepLast}=require("@web/core/utils/concurrency");const{ModelFieldSelectorPopover}=require("@web/core/model_field_selector/model_field_selector_popover");const{useLoadFieldInfo,useLoadPathDescription}=require("@web/core/model_field_selector/utils");const{usePopover}=require("@web/core/popover/popover_hook");const ModelFieldSelector=__exports.ModelFieldSelector=class ModelFieldSelector extends Component{static template="web._ModelFieldSelector";static components={Popover:ModelFieldSelectorPopover,};static props={resModel:String,path:{optional:true},allowEmpty:{type:Boolean,optional:true},readonly:{type:Boolean,optional:true},showSearchInput:{type:Boolean,optional:true},isDebugMode:{type:Boolean,optional:true},update:{type:Function,optional:true},filter:{type:Function,optional:true},followRelations:{type:Boolean,optional:true},showDebugInput:{type:Boolean,optional:true},};static defaultProps={readonly:true,allowEmpty:false,isDebugMode:false,showSearchInput:true,update:()=>{},followRelations:true,};setup(){this.loadPathDescription=useLoadPathDescription();const loadFieldInfo=useLoadFieldInfo();this.popover=usePopover(this.constructor.components.Popover,{popoverClass:"o_popover_field_selector",onClose:async()=>{if(this.newPath!==null){const fieldInfo=await loadFieldInfo(this.props.resModel,this.newPath);this.props.update(this.newPath,fieldInfo);}},});this.keepLast=new KeepLast();this.state=useState({isInvalid:false,displayNames:[]});onWillStart(()=>this.updateState(this.props));onWillUpdateProps((nextProps)=>this.updateState(nextProps));}
openPopover(currentTarget){if(this.props.readonly){return;}
this.newPath=null;this.popover.open(currentTarget,{resModel:this.props.resModel,path:this.props.path,update:(path,debug=false)=>{this.newPath=path;if(!debug){this.updateState({...this.props,path},true);}},showSearchInput:this.props.showSearchInput,isDebugMode:this.props.isDebugMode,filter:this.props.filter,followRelations:this.props.followRelations,showDebugInput:this.props.showDebugInput,});}
async updateState(params,isConcurrent){const{resModel,path,allowEmpty}=params;let prom=this.loadPathDescription(resModel,path,allowEmpty);if(isConcurrent){prom=this.keepLast.add(prom);}
const state=await prom;Object.assign(this.state,state);}
clear(){if(this.popover.isOpen){this.newPath="";this.popover.close();return;}
this.props.update("",{resModel:this.props.resModel,fieodDef:null});}}
return __exports;});;

/* /web/static/src/core/model_field_selector/model_field_selector_popover.js */
odoo.define('@web/core/model_field_selector/model_field_selector_popover',['@odoo/owl','@web/core/utils/timing','@web/core/utils/search','@web/core/utils/concurrency','@web/core/utils/arrays','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{Component,onWillStart,useEffect,useRef,useState}=require("@odoo/owl");const{debounce}=require("@web/core/utils/timing");const{fuzzyLookup}=require("@web/core/utils/search");const{KeepLast}=require("@web/core/utils/concurrency");const{sortBy}=require("@web/core/utils/arrays");const{useService}=require("@web/core/utils/hooks");class Page{constructor(resModel,fieldDefs,options={}){this.resModel=resModel;this.fieldDefs=fieldDefs;const{previousPage=null,selectedName=null,isDebugMode}=options;this.previousPage=previousPage;this.selectedName=selectedName;this.isDebugMode=isDebugMode;this.sortedFieldNames=sortBy(Object.keys(fieldDefs),(key)=>fieldDefs[key].string);this.fieldNames=this.sortedFieldNames;this.query="";this.focusedFieldName=null;this.resetFocusedFieldName();}
get path(){const previousPath=this.previousPage?.path||"";if(this.selectedName){if(previousPath){return`${previousPath}.${this.selectedName}`;}else{return this.selectedName;}}
return previousPath;}
get selectedField(){return this.fieldDefs[this.selectedName];}
get title(){const prefix=this.previousPage?.previousPage?"... > ":"";const title=this.previousPage?.selectedField.string||"";return`${prefix}${title}`;}
focus(direction){if(!this.fieldNames.length){return;}
const index=this.fieldNames.indexOf(this.focusedFieldName);if(direction==="previous"){if(index===0){this.focusedFieldName=this.fieldNames[this.fieldNames.length-1];}else{this.focusedFieldName=this.fieldNames[index-1];}}else{if(index===this.fieldNames.length-1){this.focusedFieldName=this.fieldNames[0];}else{this.focusedFieldName=this.fieldNames[index+1];}}}
resetFocusedFieldName(){if(this.selectedName&&this.fieldNames.includes(this.selectedName)){this.focusedFieldName=this.selectedName;}else{this.focusedFieldName=this.fieldNames.length?this.fieldNames[0]:null;}}
searchFields(query=""){this.query=query;this.fieldNames=this.sortedFieldNames;if(query){this.fieldNames=fuzzyLookup(query,this.fieldNames,(key)=>{const vals=[this.fieldDefs[key].string];if(this.isDebugMode){vals.push(key);}
return vals;});}
this.resetFocusedFieldName();}}
const ModelFieldSelectorPopover=__exports.ModelFieldSelectorPopover=class ModelFieldSelectorPopover extends Component{static template="web.ModelFieldSelectorPopover";static props={close:Function,filter:{type:Function,optional:true},followRelations:{type:Boolean,optional:true},showDebugInput:{type:Boolean,optional:true},isDebugMode:{type:Boolean,optional:true},path:{optional:true},resModel:String,showSearchInput:{type:Boolean,optional:true},update:Function,};static defaultProps={filter:(fieldDef)=>fieldDef.searchable,isDebugMode:false,followRelations:true,};setup(){this.fieldService=useService("field");this.state=useState({page:null});this.keepLast=new KeepLast();this.debouncedSearchFields=debounce(this.searchFields.bind(this),250);onWillStart(async()=>{this.state.page=await this.loadPages(this.props.resModel,this.props.path);});const rootRef=useRef("root");useEffect(()=>{const focusedElement=rootRef.el.querySelector(".o_model_field_selector_popover_item.active");if(focusedElement){focusedElement.scrollIntoView({block:"center"});}});useEffect(()=>{if(this.props.showSearchInput){const searchInput=rootRef.el.querySelector(".o_model_field_selector_popover_search .o_input");searchInput.focus();}},()=>[this.state.page]);}
get showDebugInput(){return this.props.showDebugInput??this.props.isDebugMode;}
filter(fieldDefs,path){const filteredKeys=Object.keys(fieldDefs).filter((k)=>this.props.filter(fieldDefs[k],path));return Object.fromEntries(filteredKeys.map((k)=>[k,fieldDefs[k]]));}
async followRelation(fieldDef){const{modelsInfo}=await this.keepLast.add(this.fieldService.loadPath(this.state.page.resModel,`${fieldDef.name}.*`));this.state.page.selectedName=fieldDef.name;const{resModel,fieldDefs}=modelsInfo.at(-1);this.openPage(new Page(resModel,this.filter(fieldDefs,this.state.page.path),{previousPage:this.state.page,isDebugMode:this.props.isDebugMode,}));}
goToPreviousPage(){this.keepLast.add(Promise.resolve());this.openPage(this.state.page.previousPage);}
async loadNewPath(path){const newPage=await this.keepLast.add(this.loadPages(this.props.resModel,path));this.openPage(newPage);}
async loadPages(resModel,path){if(typeof path!=="string"||!path.length){const fieldDefs=await this.fieldService.loadFields(resModel);return new Page(resModel,this.filter(fieldDefs,path),{isDebugMode:this.props.isDebugMode,});}
const{isInvalid,modelsInfo,names}=await this.fieldService.loadPath(resModel,path);switch(isInvalid){case"model":throw new Error(`Invalid model name: ${resModel}`);case"path":{const{resModel,fieldDefs}=modelsInfo[0];return new Page(resModel,this.filter(fieldDefs,path),{selectedName:path,isDebugMode:this.props.isDebugMode,});}
default:{let page=null;for(let index=0;index<names.length;index++){const name=names[index];const{resModel,fieldDefs}=modelsInfo[index];page=new Page(resModel,this.filter(fieldDefs,path),{previousPage:page,selectedName:name,isDebugMode:this.props.isDebugMode,});}
return page;}}}
openPage(page){this.state.page=page;this.state.page.searchFields();this.props.update(page.path);}
searchFields(query){this.state.page.searchFields(query);}
selectField(field){if(field.type==="properties"){return this.followRelation(field);}
this.keepLast.add(Promise.resolve());this.state.page.selectedName=field.name;this.props.update(this.state.page.path);this.props.close();}
onDebugInputKeydown(ev){switch(ev.key){case"Enter":{ev.preventDefault();ev.stopPropagation();this.loadNewPath(ev.currentTarget.value);break;}}}
async onInputKeydown(ev){const{page}=this.state;switch(ev.key){case"ArrowUp":{if(ev.target.selectionStart===0){page.focus("previous");}
break;}
case"ArrowDown":{if(ev.target.selectionStart===page.query.length){page.focus("next");}
break;}
case"ArrowLeft":{if(ev.target.selectionStart===0&&page.previousPage){this.goToPreviousPage();}
break;}
case"ArrowRight":{if(ev.target.selectionStart===page.query.length){const focusedFieldName=this.state.page.focusedFieldName;if(focusedFieldName){const fieldDef=this.state.page.fieldDefs[focusedFieldName];if(fieldDef.relation||fieldDef.type==="properties"){this.followRelation(fieldDef);}}}
break;}
case"Enter":{const focusedFieldName=this.state.page.focusedFieldName;if(focusedFieldName){const fieldDef=this.state.page.fieldDefs[focusedFieldName];this.selectField(fieldDef);}else{ev.preventDefault();ev.stopPropagation();}
break;}
case"Escape":{ev.preventDefault();ev.stopPropagation();this.props.close();break;}}}}
return __exports;});;

/* /web/static/src/core/model_field_selector/utils.js */
odoo.define('@web/core/model_field_selector/utils',['@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");function makeString(value){return String(value??"-");}
__exports.useLoadFieldInfo=useLoadFieldInfo;function useLoadFieldInfo(fieldService){fieldService||=useService("field");return async(resModel,path)=>{if(typeof path!=="string"||!path){return{resModel,fieldDef:null};}
const{isInvalid,names,modelsInfo}=await fieldService.loadPath(resModel,path);if(isInvalid){return{resModel,fieldDef:null};}
const name=names.at(-1);const modelInfo=modelsInfo.at(-1);return{resModel:modelInfo.resModel,fieldDef:modelInfo.fieldDefs[name]};};}
__exports.useLoadPathDescription=useLoadPathDescription;function useLoadPathDescription(fieldService){fieldService||=useService("field");return async(resModel,path,allowEmpty)=>{if([0,1].includes(path)){return{isInvalid:false,displayNames:[makeString(path)]};}
if(allowEmpty&&!path){return{isInvalid:false,displayNames:[]};}
if(typeof path!=="string"||!path){return{isInvalid:true,displayNames:[makeString()]};}
const{isInvalid,modelsInfo,names}=await fieldService.loadPath(resModel,path);const result={isInvalid:!!isInvalid,displayNames:[]};if(!isInvalid){const lastName=names.at(-1);const lastFieldDef=modelsInfo.at(-1).fieldDefs[lastName];if(["properties","properties_definition"].includes(lastFieldDef.type)){result.isInvalid=true;}}
for(let index=0;index<names.length;index++){const name=names[index];const fieldDef=modelsInfo[index]?.fieldDefs[name];result.displayNames.push(fieldDef?.string||makeString(name));}
return result;};}
return __exports;});;

/* /web/static/src/core/model_selector/model_selector.js */
odoo.define('@web/core/model_selector/model_selector',['@web/core/autocomplete/autocomplete','@web/core/utils/hooks','@web/core/utils/search','@web/core/l10n/translation','@odoo/owl'],function(require){'use strict';let __exports={};const{AutoComplete}=require("@web/core/autocomplete/autocomplete");const{useService}=require("@web/core/utils/hooks");const{fuzzyLookup}=require("@web/core/utils/search");const{_t}=require("@web/core/l10n/translation");const{Component,onWillStart}=require("@odoo/owl");const ModelSelector=__exports.ModelSelector=class ModelSelector extends Component{setup(){this.orm=useService("orm");onWillStart(async()=>{if(!this.props.models){this.models=await this._fetchAvailableModels();}else{this.models=await this.orm.call("ir.model","display_name_for",[this.props.models,]);}
this.models=this.models.map((record)=>({label:record.display_name,technical:record.model,classList:{[`o_model_selector_${record.model}`]:1,},}));});}
get placeholder(){return _t("Type a model here...");}
get sources(){return[this.optionsSource];}
get optionsSource(){return{placeholder:_t("Loading..."),options:this.loadOptionsSource.bind(this),};}
onSelect(option){this.props.onModelSelected({label:option.label,technical:option.technical,});}
filterModels(name){if(!name){const visibleModels=this.models.slice(0,8);if(this.models.length-visibleModels.length>0){visibleModels.push({label:_t("Start typing..."),unselectable:true,classList:"o_m2o_start_typing",});}
return visibleModels;}
return fuzzyLookup(name,this.models,(model)=>model.technical+model.label);}
loadOptionsSource(request){const options=this.filterModels(request);if(!options.length){options.push({label:_t("No records"),classList:"o_m2o_no_result",unselectable:true,});}
return options;}
async _fetchAvailableModels(){const result=await this.orm.call("ir.model","get_available_models");return result||[];}}
ModelSelector.template="web.ModelSelector";ModelSelector.components={AutoComplete};ModelSelector.props={onModelSelected:Function,id:{type:String,optional:true},value:{type:String,optional:true},models:{type:Array,optional:true},};return __exports;});;

/* /web/static/src/core/name_service.js */
odoo.define('@web/core/name_service',['@web/core/registry','@web/core/utils/arrays','@web/core/utils/concurrency'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{unique,zip}=require("@web/core/utils/arrays");const{Deferred}=require("@web/core/utils/concurrency");const ERROR_INACCESSIBLE_OR_MISSING=__exports.ERROR_INACCESSIBLE_OR_MISSING=Symbol("INACCESSIBLE OR MISSING RECORD ID");function isId(val){return Number.isInteger(val)&&val>=1;}
const nameService=__exports.nameService={dependencies:["orm"],async:["loadDisplayNames"],start(env,{orm}){let cache={};const batches={};function clearCache(){cache={};}
env.bus.addEventListener("ACTION_MANAGER:UPDATE",clearCache);function getMapping(resModel){if(!cache[resModel]){cache[resModel]={};}
return cache[resModel];}
function addDisplayNames(resModel,displayNames){const mapping=getMapping(resModel);for(const resId in displayNames){mapping[resId]=new Deferred();mapping[resId].resolve(displayNames[resId]);}}
async function loadDisplayNames(resModel,resIds){const mapping=getMapping(resModel);const proms=[];const resIdsToFetch=[];for(const resId of unique(resIds)){if(!isId(resId)){throw new Error(`Invalid ID: ${resId}`);}
if(!(resId in mapping)){mapping[resId]=new Deferred();resIdsToFetch.push(resId);}
proms.push(mapping[resId]);}
if(resIdsToFetch.length){if(batches[resModel]){batches[resModel].push(...resIdsToFetch);}else{batches[resModel]=resIdsToFetch;await Promise.resolve();const idsInBatch=unique(batches[resModel]);delete batches[resModel];const specification={display_name:{}};orm.silent.webSearchRead(resModel,[["id","in",idsInBatch]],{specification}).then(({records})=>{const displayNames=Object.fromEntries(records.map((rec)=>[rec.id,rec.display_name]));for(const resId of idsInBatch){mapping[resId].resolve(resId in displayNames?displayNames[resId]:ERROR_INACCESSIBLE_OR_MISSING);}});}}
const names=await Promise.all(proms);return Object.fromEntries(zip(resIds,names));}
return{addDisplayNames,clearCache,loadDisplayNames};},};registry.category("services").add("name",nameService);return __exports;});;

/* /web/static/src/core/network/download.js */
odoo.define('@web/core/network/download',['@web/core/l10n/translation','@web/core/network/rpc_service','@web/core/browser/browser'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{makeErrorFromResponse,ConnectionLostError}=require("@web/core/network/rpc_service");const{browser}=require("@web/core/browser/browser");const HEX_ESCAPE_REPLACE_REGEXP=/%([0-9A-Fa-f]{2})/g;const NON_LATIN1_REGEXP=/[^\x20-\x7e\xa0-\xff]/g;const QESC_REGEXP=/\\([\u0000-\u007f])/g;const PARAM_REGEXP=/;[\x09\x20]*([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*=[\x09\x20]*("(?:[\x20!\x23-\x5b\x5d-\x7e\x80-\xff]|\\[\x20-\x7e])*"|[!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*/g;const EXT_VALUE_REGEXP=/^([A-Za-z0-9!#$%&+\-^_`{}~]+)'(?:[A-Za-z]{2,3}(?:-[A-Za-z]{3}){0,3}|[A-Za-z]{4,8}|)'((?:%[0-9A-Fa-f]{2}|[A-Za-z0-9!#$&+.^_`|~-])+)$/;const DISPOSITION_TYPE_REGEXP=/^([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*(?:$|;)/;function decodefield(str){const match=EXT_VALUE_REGEXP.exec(str);if(!match){throw new TypeError("invalid extended field value");}
const charset=match[1].toLowerCase();const encoded=match[2];switch(charset){case"iso-8859-1":return encoded.replace(HEX_ESCAPE_REPLACE_REGEXP,pdecode).replace(NON_LATIN1_REGEXP,"?");case"utf-8":return decodeURIComponent(encoded);default:throw new TypeError("unsupported charset in extended field");}}
function parse(string){if(!string||typeof string!=="string"){throw new TypeError("argument string is required");}
let match=DISPOSITION_TYPE_REGEXP.exec(string);if(!match){throw new TypeError("invalid type format");}
let index=match[0].length;const type=match[1].toLowerCase();let key;const names=[];const params={};let value;index=PARAM_REGEXP.lastIndex=match[0].substr(-1)===";"?index-1:index;while((match=PARAM_REGEXP.exec(string))){if(match.index!==index){throw new TypeError("invalid parameter format");}
index+=match[0].length;key=match[1].toLowerCase();value=match[2];if(names.indexOf(key)!==-1){throw new TypeError("invalid duplicate parameter");}
names.push(key);if(key.indexOf("*")+1===key.length){key=key.slice(0,-1);value=decodefield(value);params[key]=value;continue;}
if(typeof params[key]==="string"){continue;}
if(value[0]==='"'){value=value.substr(1,value.length-2).replace(QESC_REGEXP,"$1");}
params[key]=value;}
if(index!==-1&&index!==string.length){throw new TypeError("invalid parameter format");}
return new ContentDisposition(type,params);}
function pdecode(str,hex){return String.fromCharCode(parseInt(hex,16));}
function ContentDisposition(type,parameters){this.type=type;this.parameters=parameters;}
function _download(data,filename,mimetype){let self=window,defaultMime="application/octet-stream",mimeType=mimetype||defaultMime,payload=data,url=!filename&&!mimetype&&payload,anchor=document.createElement("a"),toString=function(a){return String(a);},myBlob=self.Blob||self.MozBlob||self.WebKitBlob||toString,fileName=filename||"download",blob,reader;myBlob=myBlob.call?myBlob.bind(self):Blob;if(String(this)==="true"){payload=[payload,mimeType];mimeType=payload[0];payload=payload[1];}
if(url&&url.length<2048){fileName=url.split("/").pop().split("?")[0];anchor.href=url;if(anchor.href.indexOf(url)!==-1){return new Promise((resolve,reject)=>{let xhr=new browser.XMLHttpRequest();xhr.open("GET",url,true);configureBlobDownloadXHR(xhr,{onSuccess:resolve,onFailure:reject,url});xhr.send();});}}
if(/^data:[\w+\-]+\/[\w+\-]+[,;]/.test(payload)){if(payload.length>1024*1024*1.999&&myBlob!==toString){payload=dataUrlToBlob(payload);mimeType=payload.type||defaultMime;}else{return navigator.msSaveBlob?navigator.msSaveBlob(dataUrlToBlob(payload),fileName):saver(payload);}}
blob=payload instanceof myBlob?payload:new myBlob([payload],{type:mimeType});function dataUrlToBlob(strUrl){let parts=strUrl.split(/[:;,]/),type=parts[1],decoder=parts[2]==="base64"?atob:decodeURIComponent,binData=decoder(parts.pop()),mx=binData.length,i=0,uiArr=new Uint8Array(mx);for(i;i<mx;++i){uiArr[i]=binData.charCodeAt(i);}
return new myBlob([uiArr],{type});}
function saver(url,winMode){if("download"in anchor){anchor.href=url;anchor.setAttribute("download",fileName);anchor.className="download-js-link";anchor.innerText=_t("downloading...");anchor.style.display="none";document.body.appendChild(anchor);setTimeout(()=>{anchor.click();document.body.removeChild(anchor);if(winMode===true){setTimeout(()=>{self.URL.revokeObjectURL(anchor.href);},250);}},66);return true;}
if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent)){url=url.replace(/^data:([\w\/\-+]+)/,defaultMime);if(!window.open(url)){if(confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")){location.href=url;}}
return true;}
let f=document.createElement("iframe");document.body.appendChild(f);if(!winMode){url=`data:${url.replace(/^data:([\w\/\-+]+)/, defaultMime)}`;}
f.src=url;setTimeout(()=>{document.body.removeChild(f);},333);}
if(navigator.msSaveBlob){return navigator.msSaveBlob(blob,fileName);}
if(self.URL){saver(self.URL.createObjectURL(blob),true);}else{if(typeof blob==="string"||blob.constructor===toString){try{return saver(`data:${mimeType};base64,${self.btoa(blob)}`);}catch{return saver(`data:${mimeType},${encodeURIComponent(blob)}`);}}
reader=new FileReader();reader.onload=function(){saver(this.result);};reader.readAsDataURL(blob);}
return true;}
__exports.downloadFile=downloadFile;function downloadFile(data,filename,mimetype){return downloadFile._download(data,filename,mimetype)}
downloadFile._download=_download;__exports.download=download;function download(options){return download._download(options);}
download._download=(options)=>{return new Promise((resolve,reject)=>{const xhr=new browser.XMLHttpRequest();let data;if(Object.prototype.hasOwnProperty.call(options,"form")){xhr.open(options.form.method,options.form.action);data=new FormData(options.form);}else{xhr.open("POST",options.url);data=new FormData();Object.entries(options.data).forEach((entry)=>{const[key,value]=entry;data.append(key,value);});}
data.append("token","dummy-because-api-expects-one");if(odoo.csrf_token){data.append("csrf_token",odoo.csrf_token);}
configureBlobDownloadXHR(xhr,{onSuccess:resolve,onFailure:reject,url:options.url,});xhr.send(data);});};__exports.configureBlobDownloadXHR=configureBlobDownloadXHR;function configureBlobDownloadXHR(xhr,{onSuccess=()=>{},onFailure=()=>{},url}={}){xhr.responseType="blob";xhr.onload=()=>{const mimetype=xhr.response.type;const header=(xhr.getResponseHeader("Content-Disposition")||"").replace(/;$/,"");const filename=header?parse(header).parameters.filename:null;if(xhr.status===200&&(mimetype!=="text/html"||filename)){_download(xhr.response,filename,mimetype);onSuccess(filename);}else if(xhr.status===502){onFailure(new ConnectionLostError(url));}else{const decoder=new FileReader();decoder.onload=()=>{const contents=decoder.result;const doc=new DOMParser().parseFromString(contents,"text/html");const nodes=doc.body.children.length===0?[doc.body]:doc.body.children;let error;try{const node=nodes[1]||nodes[0];error=JSON.parse(node.textContent);}catch{error={message:"Arbitrary Uncaught Python Exception",data:{debug:`${xhr.status}`+`\n`+`${nodes.length > 0 ? nodes[0].textContent : ""}
                                ${nodes.length > 1 ? nodes[1].textContent : ""}`,},};}
error=makeErrorFromResponse(error);onFailure(error);};decoder.readAsText(xhr.response);}};xhr.onerror=()=>{onFailure(new ConnectionLostError(url));};}
return __exports;});;

/* /web/static/src/core/network/http_service.js */
odoo.define('@web/core/network/http_service',['@web/core/browser/browser','@web/core/registry'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{registry}=require("@web/core/registry");function checkResponseStatus(response){if(response.status===502){throw new Error("Failed to fetch");}}
__exports.get=get;async function get(route,readMethod="json"){const response=await browser.fetch(route,{method:"GET"});checkResponseStatus(response);return response[readMethod]();}
__exports.post=post;async function post(route,params={},readMethod="json"){let formData=params;if(!(formData instanceof FormData)){formData=new FormData();for(const key in params){const value=params[key];if(Array.isArray(value)&&value.length){for(const val of value){formData.append(key,val);}}else{formData.append(key,value);}}}
const response=await browser.fetch(route,{body:formData,method:"POST",});checkResponseStatus(response);return response[readMethod]();}
const httpService=__exports.httpService={start(){return{get,post};},};registry.category("services").add("http",httpService);return __exports;});;

/* /web/static/src/core/network/rpc_service.js */
odoo.define('@web/core/network/rpc_service',['@web/core/browser/browser','@web/core/registry'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{registry}=require("@web/core/registry");const RPCError=__exports.RPCError=class RPCError extends Error{constructor(){super(...arguments);this.name="RPC_ERROR";this.type="server";this.code=null;this.data=null;this.exceptionName=null;this.subType=null;}}
const ConnectionLostError=__exports.ConnectionLostError=class ConnectionLostError extends Error{constructor(url,...args){super(`Connection to "${url}" couldn't be established or was interrupted`,...args);this.url=url;}}
const ConnectionAbortedError=__exports.ConnectionAbortedError=class ConnectionAbortedError extends Error{}
__exports.makeErrorFromResponse=makeErrorFromResponse;function makeErrorFromResponse(reponse){const{code,data:errorData,message,type:subType}=reponse;const error=new RPCError();error.exceptionName=errorData.name;error.subType=subType;error.data=errorData;error.message=message;error.code=code;return error;}
let rpcId=0;__exports.jsonrpc=jsonrpc;function jsonrpc(url,params={},settings={}){const bus=settings.bus;const XHR=browser.XMLHttpRequest;const data={id:rpcId++,jsonrpc:"2.0",method:"call",params:params,};const request=settings.xhr||new XHR();let rejectFn;const promise=new Promise((resolve,reject)=>{rejectFn=reject;bus?.trigger("RPC:REQUEST",{data,url,settings});request.addEventListener("load",()=>{if(request.status===502){const error=new ConnectionLostError(url);bus?.trigger("RPC:RESPONSE",{data,settings,error});reject(error);return;}
let params;try{params=JSON.parse(request.response);}catch{const error=new ConnectionLostError(url);bus?.trigger("RPC:RESPONSE",{data,settings,error});return reject(error);}
const{error:responseError,result:responseResult}=params;if(!params.error){bus?.trigger("RPC:RESPONSE",{data,settings,result:params.result});return resolve(responseResult);}
const error=makeErrorFromResponse(responseError);bus?.trigger("RPC:RESPONSE",{data,settings,error});reject(error);});request.addEventListener("error",()=>{const error=new ConnectionLostError(url);bus?.trigger("RPC:RESPONSE",{data,settings,error});reject(error);});request.open("POST",url);request.setRequestHeader("Content-Type","application/json");request.send(JSON.stringify(data));});promise.abort=function(rejectError=true){if(request.abort){request.abort();}
const error=new ConnectionAbortedError("XmlHttpRequestError abort");bus?.trigger("RPC:RESPONSE",{data,settings,error});if(rejectError){rejectFn(error);}};return promise;}
const rpcService=__exports.rpcService={async:true,start(env){return function rpc(route,params={},settings={}){return jsonrpc(route,params,{bus:env.bus,...settings});};},};registry.category("services").add("rpc",rpcService);return __exports;});;

/* /web/static/src/core/notebook/notebook.js */
odoo.define('@web/core/notebook/notebook',['@web/core/utils/scrolling','@odoo/owl'],function(require){'use strict';let __exports={};const{scrollTo}=require("@web/core/utils/scrolling");const{Component,onWillDestroy,onWillUpdateProps,useEffect,useRef,useState,}=require("@odoo/owl");const Notebook=__exports.Notebook=class Notebook extends Component{setup(){this.activePane=useRef("activePane");this.anchorTarget=null;this.pages=this.computePages(this.props);this.state=useState({currentPage:null});this.state.currentPage=this.computeActivePage(this.props.defaultPage,true);const onAnchorClicked=this.onAnchorClicked.bind(this);this.env.bus.addEventListener("SCROLLER:ANCHOR_LINK_CLICKED",onAnchorClicked);useEffect(()=>{this.props.onPageUpdate(this.state.currentPage);if(this.anchorTarget){const matchingEl=this.activePane.el.querySelector(`#${this.anchorTarget}`);scrollTo(matchingEl,{isAnchor:true});this.anchorTarget=null;}},()=>[this.state.currentPage]);onWillUpdateProps((nextProps)=>{const activateDefault=this.props.defaultPage!==nextProps.defaultPage||!this.defaultVisible;this.pages=this.computePages(nextProps);this.state.currentPage=this.computeActivePage(nextProps.defaultPage,activateDefault);});onWillDestroy(()=>{this.env.bus.removeEventListener("SCROLLER:ANCHOR_LINK_CLICKED",onAnchorClicked);});}
get navItems(){return this.pages.filter((e)=>e[1].isVisible);}
get page(){const page=this.pages.find((e)=>e[0]===this.state.currentPage)[1];return page.Component&&page;}
onAnchorClicked(ev){if(!this.props.anchors){return;}
const id=ev.detail.detail.id.substring(1);if(this.props.anchors[id]){if(this.state.currentPage!==this.props.anchors[id].target){ev.preventDefault();ev.detail.detail.originalEv.preventDefault();this.anchorTarget=id;this.state.currentPage=this.props.anchors[id].target;}}}
activatePage(pageIndex){if(!this.disabledPages.includes(pageIndex)){this.state.currentPage=pageIndex;}}
computePages(props){if(!props.slots&&!props.pages){return[];}
if(props.pages){for(const page of props.pages){page.isVisible=true;}}
this.disabledPages=[];const pages=[];const pagesWithIndex=[];for(const[k,v]of Object.entries({...props.slots,...props.pages})){const id=v.id||k;if(v.index){pagesWithIndex.push([id,v]);}else{pages.push([id,v]);}
if(v.isDisabled){this.disabledPages.push(k);}}
for(const page of pagesWithIndex){pages.splice(page[1].index,0,page);}
return pages;}
computeActivePage(defaultPage,activateDefault){if(!this.pages.length){return null;}
const pages=this.pages.filter((e)=>e[1].isVisible).map((e)=>e[0]);if(defaultPage){if(!pages.includes(defaultPage)){this.defaultVisible=false;}else{this.defaultVisible=true;if(activateDefault){return defaultPage;}}}
const current=this.state.currentPage;if(!current||(current&&!pages.includes(current))){return pages[0];}
return current;}}
Notebook.template="web.Notebook";Notebook.defaultProps={className:"",orientation:"horizontal",onPageUpdate:()=>{},};Notebook.props={slots:{type:Object,optional:true},pages:{type:Object,optional:true},class:{optional:true},className:{type:String,optional:true},anchors:{type:Object,optional:true},defaultPage:{type:String,optional:true},orientation:{type:String,optional:true},icons:{type:Object,optional:true},onPageUpdate:{type:Function,optional:true},};return __exports;});;

/* /web/static/src/core/notifications/notification.js */
odoo.define('@web/core/notifications/notification',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const Notification=__exports.Notification=class Notification extends Component{}
Notification.template="web.NotificationWowl";Notification.props={message:{validate:(m)=>{return(typeof m==="string"||(typeof m==="object"&&typeof m.toString==="function"));},},title:{type:[String,Boolean,{toString:Function}],optional:true},type:{type:String,optional:true,validate:(t)=>["warning","danger","success","info"].includes(t),},className:{type:String,optional:true},buttons:{type:Array,element:{type:Object,shape:{name:{type:String},icon:{type:String,optional:true},primary:{type:Boolean,optional:true},onClick:Function,},},optional:true,},close:{type:Function},refresh:{type:Function},freeze:{type:Function},};Notification.defaultProps={buttons:[],className:"",type:"warning",};return __exports;});;

/* /web/static/src/core/notifications/notification_container.js */
odoo.define('@web/core/notifications/notification_container',['@web/core/notifications/notification','@web/core/transition','@odoo/owl'],function(require){'use strict';let __exports={};const{Notification}=require("@web/core/notifications/notification");const{Transition}=require("@web/core/transition");const{Component,xml,useState}=require("@odoo/owl");const NotificationContainer=__exports.NotificationContainer=class NotificationContainer extends Component{setup(){this.notifications=useState(this.props.notifications);}}
NotificationContainer.props={notifications:Object,};NotificationContainer.template=xml`
    <div class="o_notification_manager">
        <t t-foreach="notifications" t-as="notification" t-key="notification">
            <Transition leaveDuration="0" name="'o_notification_fade'" t-slot-scope="transition">
                <Notification t-props="notification_value.props" className="(notification_value.props.className || '') + ' ' + transition.className"/>
            </Transition>
        </t>
    </div>`;NotificationContainer.components={Notification,Transition};return __exports;});;

/* /web/static/src/core/notifications/notification_service.js */
odoo.define('@web/core/notifications/notification_service',['@web/core/browser/browser','@web/core/registry','@web/core/notifications/notification_container','@odoo/owl'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{registry}=require("@web/core/registry");const{NotificationContainer}=require("@web/core/notifications/notification_container");const{reactive}=require("@odoo/owl");const AUTOCLOSE_DELAY=4000;const notificationService=__exports.notificationService={notificationContainer:NotificationContainer,start(){let notifId=0;const notifications=reactive({});registry.category("main_components").add(this.notificationContainer.name,{Component:this.notificationContainer,props:{notifications},},{sequence:100});function add(message,options={}){const id=++notifId;const closeFn=()=>close(id);const props=Object.assign({},options,{message,close:closeFn});const sticky=props.sticky;delete props.sticky;delete props.onClose;let closeTimeout;const refresh=sticky?()=>{}:()=>{closeTimeout=browser.setTimeout(closeFn,AUTOCLOSE_DELAY);};const freeze=sticky?()=>{}:()=>{browser.clearTimeout(closeTimeout);};props.refresh=refreshAll;props.freeze=freezeAll;const notification={id,props,onClose:options.onClose,refresh,freeze,};notifications[id]=notification;if(!sticky){closeTimeout=browser.setTimeout(closeFn,AUTOCLOSE_DELAY);}
return closeFn;}
function refreshAll(){for(const id in notifications){notifications[id].refresh();}}
function freezeAll(){for(const id in notifications){notifications[id].freeze();}}
function close(id){if(notifications[id]){const notification=notifications[id];if(notification.onClose){notification.onClose();}
delete notifications[id];}}
return{add};},};registry.category("services").add("notification",notificationService);return __exports;});;

/* /web/static/src/core/orm_service.js */
odoo.define('@web/core/orm_service',['@web/core/registry'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const x2ManyCommands=__exports.x2ManyCommands={CREATE:0,create(virtualID,values){delete values.id;return[x2ManyCommands.CREATE,virtualID||false,values];},UPDATE:1,update(id,values){delete values.id;return[x2ManyCommands.UPDATE,id,values];},DELETE:2,delete(id){return[x2ManyCommands.DELETE,id,false];},UNLINK:3,unlink(id){return[x2ManyCommands.UNLINK,id,false];},LINK:4,link(id){return[x2ManyCommands.LINK,id,false];},CLEAR:5,clear(){return[x2ManyCommands.CLEAR,false,false];},SET:6,set(ids){return[x2ManyCommands.SET,false,ids];},};function validateModel(value){if(typeof value!=="string"||value.length===0){throw new Error(`Invalid model name: ${value}`);}}
function validatePrimitiveList(name,type,value){if(!Array.isArray(value)||value.some((val)=>typeof val!==type)){throw new Error(`Invalid ${name} list: ${value}`);}}
function validateObject(name,obj){if(typeof obj!=="object"||obj===null||Array.isArray(obj)){throw new Error(`${name} should be an object`);}}
function validateArray(name,array){if(!Array.isArray(array)){throw new Error(`${name} should be an array`);}}
const UPDATE_METHODS=__exports.UPDATE_METHODS=["unlink","create","write","web_save","action_archive","action_unarchive",];const ORM=__exports.ORM=class ORM{constructor(rpc,user){this.rpc=rpc;this.user=user;this._silent=false;}
get silent(){return Object.assign(Object.create(this),{_silent:true});}
call(model,method,args=[],kwargs={}){validateModel(model);const url=`/web/dataset/call_kw/${model}/${method}`;const fullContext=Object.assign({},this.user.context,kwargs.context||{});const fullKwargs=Object.assign({},kwargs,{context:fullContext});const params={model,method,args,kwargs:fullKwargs,};return this.rpc(url,params,{silent:this._silent});}
create(model,records,kwargs={}){validateArray("records",records);for(const record of records){validateObject("record",record);}
return this.call(model,"create",[records],kwargs);}
read(model,ids,fields,kwargs={}){validatePrimitiveList("ids","number",ids);if(fields){validatePrimitiveList("fields","string",fields);}
if(!ids.length){return Promise.resolve([]);}
return this.call(model,"read",[ids,fields],kwargs);}
readGroup(model,domain,fields,groupby,kwargs={}){validateArray("domain",domain);validatePrimitiveList("fields","string",fields);validatePrimitiveList("groupby","string",groupby);groupby=[...new Set(groupby)];return this.call(model,"read_group",[],{...kwargs,domain,fields,groupby});}
search(model,domain,kwargs={}){validateArray("domain",domain);return this.call(model,"search",[domain],kwargs);}
searchRead(model,domain,fields,kwargs={}){validateArray("domain",domain);if(fields){validatePrimitiveList("fields","string",fields);}
return this.call(model,"search_read",[],{...kwargs,domain,fields});}
searchCount(model,domain,kwargs={}){validateArray("domain",domain);return this.call(model,"search_count",[domain],kwargs);}
unlink(model,ids,kwargs={}){validatePrimitiveList("ids","number",ids);if(!ids.length){return Promise.resolve(true);}
return this.call(model,"unlink",[ids],kwargs);}
webReadGroup(model,domain,fields,groupby,kwargs={}){validateArray("domain",domain);validatePrimitiveList("fields","string",fields);validatePrimitiveList("groupby","string",groupby);return this.call(model,"web_read_group",[],{...kwargs,groupby,domain,fields,});}
webRead(model,ids,kwargs={}){validatePrimitiveList("ids","number",ids);return this.call(model,"web_read",[ids],kwargs);}
webSearchRead(model,domain,kwargs={}){validateArray("domain",domain);return this.call(model,"web_search_read",[],{...kwargs,domain});}
write(model,ids,data,kwargs={}){validatePrimitiveList("ids","number",ids);validateObject("data",data);return this.call(model,"write",[ids,data],kwargs);}
webSave(model,ids,data,kwargs={}){validatePrimitiveList("ids","number",ids);validateObject("data",data);return this.call(model,"web_save",[ids,data],kwargs);}}
const ormService=__exports.ormService={dependencies:["rpc","user"],async:["call","create","nameGet","read","readGroup","search","searchRead","unlink","webSearchRead","write",],start(env,{rpc,user}){return new ORM(rpc,user);},};registry.category("services").add("orm",ormService);return __exports;});;

/* /web/static/src/core/overlay/overlay_container.js */
odoo.define('@web/core/overlay/overlay_container',['@odoo/owl','@web/core/utils/arrays','@web/core/utils/components'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{sortBy}=require("@web/core/utils/arrays");const{ErrorHandler}=require("@web/core/utils/components");const OverlayContainer=__exports.OverlayContainer=class OverlayContainer extends Component{static template="web.OverlayContainer";static components={ErrorHandler};static props={overlays:Object};get sortedOverlays(){return sortBy(Object.values(this.props.overlays),(overlay)=>overlay.sequence);}
handleError(overlay,error){overlay.remove();Promise.resolve().then(()=>{throw error;});}}
return __exports;});;

/* /web/static/src/core/overlay/overlay_service.js */
odoo.define('@web/core/overlay/overlay_service',['@odoo/owl','@web/core/registry','@web/core/overlay/overlay_container'],function(require){'use strict';let __exports={};const{reactive}=require("@odoo/owl");const{registry}=require("@web/core/registry");const{OverlayContainer}=require("@web/core/overlay/overlay_container");const mainComponents=registry.category("main_components");const services=registry.category("services");const overlayService=__exports.overlayService={start(){let nextId=0;const overlays=reactive({});mainComponents.add("OverlayContainer",{Component:OverlayContainer,props:{overlays},});const remove=(id,onRemove=()=>{})=>{if(id in overlays){onRemove();delete overlays[id];}};const add=(component,props,options={})=>{const id=++nextId;const removeCurrentOverlay=()=>remove(id,options.onRemove);overlays[id]={id,component,props,remove:removeCurrentOverlay,sequence:options.sequence??50,};return removeCurrentOverlay;};return{add,overlays};},};services.add("overlay",overlayService);return __exports;});;

/* /web/static/src/core/pager/pager.js */
odoo.define('@web/core/pager/pager',['@web/core/utils/hooks','@web/core/utils/numbers','@odoo/owl'],function(require){'use strict';let __exports={};const{useAutofocus}=require("@web/core/utils/hooks");const{clamp}=require("@web/core/utils/numbers");const{Component,useExternalListener,useState}=require("@odoo/owl");const Pager=__exports.Pager=class Pager extends Component{setup(){this.state=useState({isEditing:false,isDisabled:false,});this.inputRef=useAutofocus();useExternalListener(document,"mousedown",this.onClickAway,{capture:true});}
get minimum(){return this.props.offset+1;}
get maximum(){return Math.min(this.props.offset+this.props.limit,this.props.total);}
get value(){const parts=[this.minimum];if(this.props.limit>1){parts.push(this.maximum);}
return parts.join("-");}
get isSinglePage(){return!this.props.updateTotal&&this.minimum===1&&this.maximum===this.props.total;}
async navigate(direction){let minimum=this.props.offset+this.props.limit*direction;let total=this.props.total;if(this.props.updateTotal&&minimum<0){total=await this.props.updateTotal();}
if(minimum>=total){if(!this.props.updateTotal){minimum=0;}}else if(minimum<0&&this.props.limit===1){minimum=total-1;}else if(minimum<0&&this.props.limit>1){minimum=total-(total%this.props.limit||this.props.limit);}
this.update(minimum,this.props.limit,true);}
async parse(value){let[minimum,maximum]=value.trim().split(/\s*[-\s,;]\s*/);minimum=parseInt(minimum,10);maximum=maximum?parseInt(maximum,10):minimum;if(this.props.updateTotal){return{minimum:minimum-1,maximum};}
return{minimum:clamp(minimum,1,this.props.total)-1,maximum:clamp(maximum,1,this.props.total),};}
async setValue(value){const{minimum,maximum}=await this.parse(value);if(!isNaN(minimum)&&!isNaN(maximum)&&minimum<maximum){this.update(minimum,maximum-minimum);}}
async update(offset,limit,hasNavigated){this.state.isDisabled=true;await this.props.onUpdate({offset,limit},hasNavigated);this.state.isDisabled=false;this.state.isEditing=false;}
async updateTotal(){if(!this.state.isDisabled){this.state.isDisabled=true;await this.props.updateTotal();this.state.isDisabled=false;}}
onClickAway(ev){if(ev.target!==this.inputRef.el){this.state.isEditing=false;}}
onInputBlur(){this.state.isEditing=false;}
onInputChange(ev){this.setValue(ev.target.value);if(!this.state.isDisabled){ev.preventDefault();}}
onInputKeydown(ev){switch(ev.key){case"Enter":ev.preventDefault();ev.stopPropagation();this.setValue(ev.currentTarget.value);break;case"Escape":ev.preventDefault();ev.stopPropagation();this.state.isEditing=false;break;}}
onValueClick(){if(this.props.isEditable&&!this.state.isEditing&&!this.state.isDisabled){if(this.inputRef.el){this.inputRef.el.focus();}
this.state.isEditing=true;}}}
Pager.template="web.Pager";Pager.defaultProps={isEditable:true,withAccessKey:true,};Pager.props={offset:Number,limit:Number,total:Number,onUpdate:Function,isEditable:{type:Boolean,optional:true},withAccessKey:{type:Boolean,optional:true},updateTotal:{type:Function,optional:true},};return __exports;});;

/* /web/static/src/core/popover/popover.js */
odoo.define('@web/core/popover/popover',['@odoo/owl','@web/core/utils/hooks','@web/core/position_hook','@web/core/ui/ui_service'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{useForwardRefToParent}=require("@web/core/utils/hooks");const{usePosition}=require("@web/core/position_hook");const{useActiveElement}=require("@web/core/ui/ui_service");const Popover=__exports.Popover=class Popover extends Component{static animationTime=200;setup(){useActiveElement("ref");useForwardRefToParent("ref");this.shouldAnimate=this.props.animation;this.position=usePosition("ref",()=>this.props.target,{onPositioned:(el,solution)=>{(this.props.onPositioned||this.onPositioned.bind(this))(el,solution);if(this.props.fixedPosition){this.position.lock();}},position:this.props.position,});}
onPositioned(el,{direction,variant}){const position=`${direction[0]}${variant[0]}`;const directionMap={top:"top",bottom:"bottom",left:"start",right:"end",};el.classList=["o_popover popover mw-100",`bs-popover-${directionMap[direction]}`,`o-popover-${direction}`,`o-popover--${position}`,].join(" ");if(this.props.class){el.classList.add(...this.props.class.split(" "));}
if(this.props.arrow){const arrowEl=el.querySelector(":scope > .popover-arrow");arrowEl.className="popover-arrow";switch(position){case"tm":case"bm":case"tf":case"bf":arrowEl.classList.add("start-0","end-0","mx-auto");break;case"lm":case"rm":case"lf":case"rf":arrowEl.classList.add("top-0","bottom-0","my-auto");break;case"ts":case"bs":arrowEl.classList.add("end-auto");break;case"te":case"be":arrowEl.classList.add("start-auto");break;case"ls":case"rs":arrowEl.classList.add("bottom-auto");break;case"le":case"re":arrowEl.classList.add("top-auto");break;}}
if(this.shouldAnimate){this.shouldAnimate=false;const transform={top:["translateY(-5%)","translateY(0)"],right:["translateX(5%)","translateX(0)"],bottom:["translateY(5%)","translateY(0)"],left:["translateX(-5%)","translateX(0)"],}[direction];this.position.lock();const animation=el.animate({opacity:[0,1],transform},this.constructor.animationTime);animation.finished.then(this.position.unlock);}}}
Popover.template="web.PopoverWowl";Popover.defaultProps={position:"bottom",class:"",fixedPosition:false,arrow:true,animation:true,};Popover.props={ref:{type:Function,optional:true,},class:{optional:true,type:String,},position:{type:String,validate:(p)=>{const[d,v="middle"]=p.split("-");return(["top","bottom","left","right"].includes(d)&&["start","middle","end","fit"].includes(v));},optional:true,},onPositioned:{type:Function,optional:true,},fixedPosition:{type:Boolean,optional:true,},arrow:{type:Boolean,optional:true,},animation:{type:Boolean,optional:true,},target:{validate:(target)=>{const Element=target?.ownerDocument?.defaultView?.Element;return((Boolean(Element)&&(target instanceof Element||target instanceof window.Element))||(typeof target==="object"&&target?.constructor?.name?.endsWith("Element")));},},slots:{type:Object,optional:true,shape:{default:{optional:true},},},};return __exports;});;

/* /web/static/src/core/popover/popover_controller.js */
odoo.define('@web/core/popover/popover_controller',['@odoo/owl','@web/core/hotkeys/hotkey_hook','@web/core/utils/hooks','@web/core/popover/popover'],function(require){'use strict';let __exports={};const{Component,onWillDestroy,useExternalListener,useSubEnv,xml}=require("@odoo/owl");const{useHotkey}=require("@web/core/hotkeys/hotkey_hook");const{useChildRef}=require("@web/core/utils/hooks");const{Popover}=require("@web/core/popover/popover");const POPOVER_SYMBOL=__exports.POPOVER_SYMBOL=Symbol("popover");const PopoverController=__exports.PopoverController=class PopoverController extends Component{static template=xml`
        <Popover t-props="props.popoverProps" ref="popoverRef">
            <t t-component="props.component" t-props="props.componentProps" close="props.close"/>
        </Popover>
    `;static components={Popover};static props=["target","close","closeOnClickAway","component","componentProps","popoverProps","subPopovers?",];setup(){this.props.subPopovers?.add(this);this.subPopovers=new Set();useSubEnv({[POPOVER_SYMBOL]:this.subPopovers});if(this.props.target.isConnected){this.popoverRef=useChildRef();useExternalListener(window,"pointerdown",this.onClickAway,{capture:true});useHotkey("escape",()=>this.props.close());const targetObserver=new MutationObserver(this.onTargetMutate.bind(this));targetObserver.observe(this.props.target.parentElement,{childList:true});onWillDestroy(()=>{targetObserver.disconnect();this.props.subPopovers?.delete(this);});}else{this.props.close();}}
isInside(target){if(this.props.target.contains(target)||this.popoverRef.el.contains(target)){return true;}
return[...this.subPopovers].some((p)=>p.isInside(target));}
onClickAway(ev){const target=ev.composedPath()[0];if(this.props.closeOnClickAway(target)&&!this.isInside(target)){this.props.close();}}
onTargetMutate(){if(!this.props.target.isConnected){this.props.close();}}}
return __exports;});;

/* /web/static/src/core/popover/popover_hook.js */
odoo.define('@web/core/popover/popover_hook',['@web/core/utils/hooks','@odoo/owl','@web/core/popover/popover_controller'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{onWillUnmount,status,useComponent,useEnv}=require("@odoo/owl");const{POPOVER_SYMBOL}=require("@web/core/popover/popover_controller");__exports.makePopover=makePopover;function makePopover(popoverService,component,options){let removeFn=null;function close(){removeFn?.();}
return{open(target,props){close();const newOptions=Object.create(options);newOptions.onClose=()=>{removeFn=null;options.onClose?.();};removeFn=popoverService.add(target,component,props,newOptions);},close,get isOpen(){return Boolean(removeFn);},};}
__exports.usePopover=usePopover;function usePopover(component,options={}){const env=useEnv();const popoverService=useService("popover");const owner=useComponent();const newOptions=Object.create(options);newOptions[POPOVER_SYMBOL]=env[POPOVER_SYMBOL];newOptions.onClose=()=>{if(status(owner)!=="destroyed"){options.onClose?.();}};const popover=makePopover(popoverService,component,newOptions);onWillUnmount(popover.close);return popover;}
return __exports;});;

/* /web/static/src/core/popover/popover_service.js */
odoo.define('@web/core/popover/popover_service',['@odoo/owl','@web/core/registry','@web/core/popover/popover_controller'],function(require){'use strict';let __exports={};const{markRaw}=require("@odoo/owl");const{registry}=require("@web/core/registry");const{POPOVER_SYMBOL,PopoverController}=require("@web/core/popover/popover_controller");const popoverService=__exports.popoverService={dependencies:["overlay"],start(_,{overlay}){const add=(target,component,props,options={})=>{const closeOnClickAway=typeof options.closeOnClickAway==="function"?options.closeOnClickAway:()=>options.closeOnClickAway??true;const remove=overlay.add(PopoverController,{target,close:()=>remove(),closeOnClickAway,subPopovers:options[POPOVER_SYMBOL],component,componentProps:markRaw(props),popoverProps:{target,class:options.popoverClass,animation:options.animation,arrow:options.arrow,position:options.position,onPositioned:options.onPositioned,fixedPosition:options.fixedPosition,},},{onRemove:options.onClose});return remove;};return{add};},};registry.category("services").add("popover",popoverService);return __exports;});;

/* /web/static/src/core/position_hook.js */
odoo.define('@web/core/position_hook',['@web/core/utils/timing','@odoo/owl','@web/core/l10n/localization'],function(require){'use strict';let __exports={};const{useThrottleForAnimation}=require("@web/core/utils/timing");const{EventBus,onWillDestroy,useChildSubEnv,useComponent,useEffect,useRef,}=require("@odoo/owl");const{localization}=require("@web/core/l10n/localization");const DIRECTIONS={t:"top",r:"right",b:"bottom",l:"left"};const VARIANTS={s:"start",m:"middle",e:"end",f:"fit"};const DIRECTION_FLIP_ORDER={top:"tbrl",right:"rltb",bottom:"btrl",left:"lrbt"};const VARIANT_FLIP_ORDER={start:"sme",middle:"mse",end:"ems",fit:"f"};const FIT_FLIP_ORDER={top:"tb",right:"rl",bottom:"bt",left:"lr"};const DEFAULTS={margin:0,position:"bottom",};function getIFrame(popperEl,targetEl){return[...popperEl.ownerDocument.getElementsByTagName("iframe")].find((iframe)=>iframe.contentDocument?.contains(targetEl));}
function getBestPosition(popper,target,{container,margin,position},iframe){const[directionKey,variantKey="middle"]=position.split("-");const directions=variantKey==="fit"?FIT_FLIP_ORDER[directionKey]:DIRECTION_FLIP_ORDER[directionKey];const variants=VARIANT_FLIP_ORDER[variantKey];if(!container){container=popper.ownerDocument.documentElement;}else if(typeof container==="function"){container=container();}
const popperStyle=getComputedStyle(popper);const{marginTop,marginLeft,marginRight,marginBottom}=popperStyle;const popMargins={top:parseFloat(marginTop),left:parseFloat(marginLeft),right:parseFloat(marginRight),bottom:parseFloat(marginBottom),};const popBox=popper.getBoundingClientRect();const targetBox=target.getBoundingClientRect();const contBox=container.getBoundingClientRect();const shouldAccountForIFrame=iframe&&popper.ownerDocument!==target.ownerDocument;const iframeBox=shouldAccountForIFrame?iframe.getBoundingClientRect():{top:0,left:0};const containerIsHTMLNode=container===container.ownerDocument.firstElementChild;const directionsData={t:iframeBox.top+targetBox.top-popMargins.bottom-margin-popBox.height,b:iframeBox.top+targetBox.bottom+popMargins.top+margin,r:iframeBox.left+targetBox.right+popMargins.left+margin,l:iframeBox.left+targetBox.left-popMargins.right-margin-popBox.width,};const variantsData={vf:iframeBox.left+targetBox.left,vs:iframeBox.left+targetBox.left+popMargins.left,vm:iframeBox.left+targetBox.left+targetBox.width/2-popBox.width/2,ve:iframeBox.left+targetBox.right-popMargins.right-popBox.width,hf:iframeBox.top+targetBox.top,hs:iframeBox.top+targetBox.top+popMargins.top,hm:iframeBox.top+targetBox.top+targetBox.height/2-popBox.height/2,he:iframeBox.top+targetBox.bottom-popMargins.bottom-popBox.height,};function getPositioningData(d=directions[0],v=variants[0],containerRestricted=false){const vertical=["t","b"].includes(d);const variantPrefix=vertical?"v":"h";const directionValue=directionsData[d];const variantValue=variantsData[variantPrefix+v];if(containerRestricted){const[directionSize,variantSize]=vertical?[popBox.height,popBox.width]:[popBox.width,popBox.height];let[directionMin,directionMax]=vertical?[contBox.top,contBox.bottom]:[contBox.left,contBox.right];let[variantMin,variantMax]=vertical?[contBox.left,contBox.right]:[contBox.top,contBox.bottom];if(containerIsHTMLNode){if(vertical){directionMin+=container.scrollTop;directionMax+=container.scrollTop;}else{variantMin+=container.scrollTop;variantMax+=container.scrollTop;}}
const directionOverflow=Math.ceil(directionValue)<Math.floor(directionMin)||Math.floor(directionValue+directionSize)>Math.ceil(directionMax);const variantOverflow=Math.ceil(variantValue)<Math.floor(variantMin)||Math.floor(variantValue+variantSize)>Math.ceil(variantMax);if(directionOverflow||variantOverflow){return null;}}
const positioning=vertical?{top:directionValue,left:variantValue,}:{top:variantValue,left:directionValue,};return{top:positioning.top-popBox.top,left:positioning.left-popBox.left,direction:DIRECTIONS[d],variant:VARIANTS[v],};}
for(const d of directions){for(const v of variants){const match=getPositioningData(d,v,true);if(match){return match;}}}
return getPositioningData();}
__exports.reposition=reposition;function reposition(popper,target,options,iframe){let[directionKey,variantKey="middle"]=options.position.split("-");if(localization.direction==="rtl"){if(["bottom","top"].includes(directionKey)){if(variantKey!=="middle"){variantKey=variantKey==="start"?"end":"start";}}else{directionKey=directionKey==="left"?"right":"left";}}
options.position=[directionKey,variantKey].join("-");popper.style.position="fixed";popper.style.top="0px";popper.style.left="0px";const position=getBestPosition(popper,target,options,iframe);const{top,left,direction,variant}=position;popper.style.top=`${top}px`;popper.style.left=`${left}px`;if(variant==="fit"){const styleProperty=["top","bottom"].includes(direction)?"width":"height";popper.style[styleProperty]=target.getBoundingClientRect()[styleProperty]+"px";}
options.onPositioned?.(popper,position);}
const POSITION_BUS=Symbol("position-bus");__exports.usePosition=usePosition;function usePosition(refName,getTarget,options={}){const ref=useRef(refName);let lock=false;const update=()=>{const targetEl=getTarget();if(!ref.el||!targetEl||lock){return;}
const iframe=getIFrame(ref.el,targetEl);reposition(ref.el,targetEl,{...DEFAULTS,...options},iframe);};const component=useComponent();const bus=component.env[POSITION_BUS]||new EventBus();let executingUpdate=false;const batchedUpdate=async()=>{if(!executingUpdate){executingUpdate=true;update();await Promise.resolve();executingUpdate=false;}};bus.addEventListener("update",batchedUpdate);onWillDestroy(()=>bus.removeEventListener("update",batchedUpdate));const isTopmost=!(POSITION_BUS in component.env);if(isTopmost){useChildSubEnv({[POSITION_BUS]:bus});}
const throttledUpdate=useThrottleForAnimation(()=>bus.trigger("update"));useEffect(()=>{bus.trigger("update");if(isTopmost){const scrollListener=(e)=>{if(ref.el?.contains(e.target)){return;}
throttledUpdate();};const targetDocument=getTarget()?.ownerDocument;targetDocument?.addEventListener("scroll",scrollListener,{capture:true});targetDocument?.addEventListener("load",throttledUpdate,{capture:true});window.addEventListener("resize",throttledUpdate);return()=>{targetDocument?.removeEventListener("scroll",scrollListener,{capture:true});targetDocument?.removeEventListener("load",throttledUpdate,{capture:true});window.removeEventListener("resize",throttledUpdate);};}});return{lock:()=>{lock=true;},unlock:()=>{lock=false;bus.trigger("update");},};}
return __exports;});;

/* /web/static/src/core/py_js/py.js */
odoo.define('@web/core/py_js/py',['@web/core/py_js/py_interpreter','@web/core/py_js/py_parser','@web/core/py_js/py_tokenizer','@web/core/py_js/py_utils'],function(require){'use strict';let __exports={};const{evaluate}=require("@web/core/py_js/py_interpreter");const{parse}=require("@web/core/py_js/py_parser");const{tokenize}=require("@web/core/py_js/py_tokenizer");{const{evaluate}=require("@web/core/py_js/py_interpreter");Object.assign(__exports,{evaluate})};{const{parse}=require("@web/core/py_js/py_parser");Object.assign(__exports,{parse})};{const{tokenize}=require("@web/core/py_js/py_tokenizer");Object.assign(__exports,{tokenize})};{const{formatAST}=require("@web/core/py_js/py_utils");Object.assign(__exports,{formatAST})};__exports.parseExpr=parseExpr;function parseExpr(expr){const tokens=tokenize(expr);return parse(tokens);}
__exports.evaluateExpr=evaluateExpr;function evaluateExpr(expr,context={}){let ast;try{ast=parseExpr(expr);}catch(error){throw new EvalError(`Can not parse python expression: (${expr})\nError: ${error.message}`);}
try{return evaluate(ast,context);}catch(error){throw new EvalError(`Can not evaluate python expression: (${expr})\nError: ${error.message}`);}}
__exports.evaluateBooleanExpr=evaluateBooleanExpr;function evaluateBooleanExpr(expr,context={}){if(!expr||expr==='False'||expr==='0'){return false;}
if(expr==='True'||expr==='1'){return true;}
return evaluateExpr(`bool(${expr})`,context);}
return __exports;});;

/* /web/static/src/core/py_js/py_builtin.js */
odoo.define('@web/core/py_js/py_builtin',['@web/core/py_js/py_date'],function(require){'use strict';let __exports={};const{PyDate,PyDateTime,PyRelativeDelta,PyTime,PyTimeDelta}=require("@web/core/py_js/py_date");const EvaluationError=__exports.EvaluationError=class EvaluationError extends Error{}
__exports.execOnIterable=execOnIterable;function execOnIterable(iterable,func){if(iterable===null){throw new EvaluationError(`value not iterable`);}
if(typeof iterable==="object"&&!Array.isArray(iterable)&&!(iterable instanceof Set)){iterable=Object.keys(iterable);}
if(typeof iterable?.[Symbol.iterator]!=="function"){throw new EvaluationError(`value not iterable`);}
return func(iterable);}
const BUILTINS=__exports.BUILTINS={bool(value){switch(typeof value){case"number":return value!==0;case"string":return value!=="";case"boolean":return value;case"object":if(value===null||value===undefined){return false;}
if(value.isTrue){return value.isTrue();}
if(value instanceof Array){return!!value.length;}
if(value instanceof Set){return!!value.size;}
return Object.keys(value).length!==0;}
return true;},set(iterable){if(arguments.length>2){throw new EvaluationError(`set expected at most 1 argument, got (${arguments.length - 1}`);}
return execOnIterable(iterable,(iterable)=>{return new Set(iterable);});},time:{strftime(format){return PyDateTime.now().strftime(format);},},context_today(){return PyDate.today();},get current_date(){return this.today;},get today(){return PyDate.today().strftime("%Y-%m-%d");},get now(){return PyDateTime.now().strftime("%Y-%m-%d %H:%M:%S");},datetime:{time:PyTime,timedelta:PyTimeDelta,datetime:PyDateTime,date:PyDate,},relativedelta:PyRelativeDelta,true:true,false:false,};return __exports;});;

/* /web/static/src/core/py_js/py_date.js */
odoo.define('@web/core/py_js/py_date',['@web/core/py_js/py_parser'],function(require){'use strict';let __exports={};const{parseArgs}=require("@web/core/py_js/py_parser");const AssertionError=__exports.AssertionError=class AssertionError extends Error{}
const ValueError=__exports.ValueError=class ValueError extends Error{}
const NotSupportedError=__exports.NotSupportedError=class NotSupportedError extends Error{}
function fmt2(n){return String(n).padStart(2,"0");}
function fmt4(n){return String(n).padStart(4,"0");}
function divmod(a,b,fn){let mod=a%b;if((mod>0&&b<0)||(mod<0&&b>0)){mod+=b;}
return fn(Math.floor(a/b),mod);}
function assert(bool,message="AssertionError"){if(!bool){throw new AssertionError(message);}}
const DAYS_IN_MONTH=[null,31,28,31,30,31,30,31,31,30,31,30,31];const DAYS_BEFORE_MONTH=[null];for(let dbm=0,i=1;i<DAYS_IN_MONTH.length;++i){DAYS_BEFORE_MONTH.push(dbm);dbm+=DAYS_IN_MONTH[i];}
function daysInMonth(year,month){if(month===2&&isLeap(year)){return 29;}
return DAYS_IN_MONTH[month];}
function isLeap(year){return year%4===0&&(year%100!==0||year%400===0);}
function daysBeforeYear(year){const y=year-1;return y*365+Math.floor(y/4)-Math.floor(y/100)+Math.floor(y/400);}
function daysBeforeMonth(year,month){const postLeapFeb=month>2&&isLeap(year);return DAYS_BEFORE_MONTH[month]+(postLeapFeb?1:0);}
function ymd2ord(year,month,day){const dim=daysInMonth(year,month);if(!(1<=day&&day<=dim)){throw new ValueError(`day must be in 1..${dim}`);}
return daysBeforeYear(year)+daysBeforeMonth(year,month)+day;}
const DI400Y=daysBeforeYear(401);const DI100Y=daysBeforeYear(101);const DI4Y=daysBeforeYear(5);function ord2ymd(n){--n;let n400,n100,n4,n1,n0;divmod(n,DI400Y,function(_n400,n){n400=_n400;divmod(n,DI100Y,function(_n100,n){n100=_n100;divmod(n,DI4Y,function(_n4,n){n4=_n4;divmod(n,365,function(_n1,n){n1=_n1;n0=n;});});});});n=n0;const year=n400*400+1+n100*100+n4*4+n1;if(n1==4||n100==100){assert(n0===0);return{year:year-1,month:12,day:31,};}
const leapyear=n1===3&&(n4!==24||n100==3);assert(leapyear==isLeap(year));let month=(n+50)>>5;let preceding=DAYS_BEFORE_MONTH[month]+(month>2&&leapyear?1:0);if(preceding>n){--month;preceding-=DAYS_IN_MONTH[month]+(month===2&&leapyear?1:0);}
n-=preceding;return{year:year,month:month,day:n+1,};}
function tmxxx(year,month,day,hour,minute,second,microsecond){hour=hour||0;minute=minute||0;second=second||0;microsecond=microsecond||0;if(microsecond<0||microsecond>999999){divmod(microsecond,1000000,function(carry,ms){microsecond=ms;second+=carry;});}
if(second<0||second>59){divmod(second,60,function(carry,s){second=s;minute+=carry;});}
if(minute<0||minute>59){divmod(minute,60,function(carry,m){minute=m;hour+=carry;});}
if(hour<0||hour>23){divmod(hour,24,function(carry,h){hour=h;day+=carry;});}
if(month<1||month>12){divmod(month-1,12,function(carry,m){month=m+1;year+=carry;});}
const dim=daysInMonth(year,month);if(day<1||day>dim){if(day===0){--month;if(month>0){day=daysInMonth(year,month);}else{--year;month=12;day=31;}}else if(day==dim+1){++month;day=1;if(month>12){month=1;++year;}}else{const r=ord2ymd(ymd2ord(year,month,1)+(day-1));year=r.year;month=r.month;day=r.day;}}
return{year:year,month:month,day:day,hour:hour,minute:minute,second:second,microsecond:microsecond,};}
const PyDate=__exports.PyDate=class PyDate{static today(){return this.convertDate(new Date());}
static convertDate(date){const year=date.getFullYear();const month=date.getMonth()+1;const day=date.getDate();return new PyDate(year,month,day);}
constructor(year,month,day){this.year=year;this.month=month;this.day=day;}
static create(...args){const{year,month,day}=parseArgs(args,["year","month","day"]);return new PyDate(year,month,day);}
add(timedelta){const s=tmxxx(this.year,this.month,this.day+timedelta.days);return new PyDate(s.year,s.month,s.day);}
isEqual(other){if(!(other instanceof PyDate)){return false;}
return this.year===other.year&&this.month===other.month&&this.day===other.day;}
strftime(format){return format.replace(/%([A-Za-z])/g,(m,c)=>{switch(c){case"Y":return fmt4(this.year);case"m":return fmt2(this.month);case"d":return fmt2(this.day);}
throw new ValueError(`No known conversion for ${m}`);});}
substract(other){if(other instanceof PyTimeDelta){return this.add(other.negate());}
if(other instanceof PyDate){return PyTimeDelta.create(this.toordinal()-other.toordinal());}
throw NotSupportedError();}
toJSON(){return this.strftime("%Y-%m-%d");}
toordinal(){return ymd2ord(this.year,this.month,this.day);}}
const PyDateTime=__exports.PyDateTime=class PyDateTime{static now(){return this.convertDate(new Date());}
static convertDate(date){const year=date.getFullYear();const month=date.getMonth()+1;const day=date.getDate();const hour=date.getHours();const minute=date.getMinutes();const second=date.getSeconds();return new PyDateTime(year,month,day,hour,minute,second,0);}
static create(...args){const namedArgs=parseArgs(args,["year","month","day","hour","minute","second","microsecond",]);const year=namedArgs.year;const month=namedArgs.month;const day=namedArgs.day;const hour=namedArgs.hour||0;const minute=namedArgs.minute||0;const second=namedArgs.second||0;const ms=namedArgs.micro/1000||0;return new PyDateTime(year,month,day,hour,minute,second,ms);}
static combine(...args){const{date,time}=parseArgs(args,["date","time"]);return PyDateTime.create(date.year,date.month,date.day,time.hour,time.minute,time.second);}
constructor(year,month,day,hour,minute,second,microsecond){this.year=year;this.month=month;this.day=day;this.hour=hour;this.minute=minute;this.second=second;this.microsecond=microsecond;}
add(timedelta){const s=tmxxx(this.year,this.month,this.day+timedelta.days,this.hour,this.minute,this.second+timedelta.seconds,this.microsecond+timedelta.microseconds);return new PyDateTime(s.year,s.month,s.day,s.hour,s.minute,s.second,s.microsecond);}
isEqual(other){if(!(other instanceof PyDateTime)){return false;}
return(this.year===other.year&&this.month===other.month&&this.day===other.day&&this.hour===other.hour&&this.minute===other.minute&&this.second===other.second&&this.microsecond===other.microsecond);}
strftime(format){return format.replace(/%([A-Za-z])/g,(m,c)=>{switch(c){case"Y":return fmt4(this.year);case"m":return fmt2(this.month);case"d":return fmt2(this.day);case"H":return fmt2(this.hour);case"M":return fmt2(this.minute);case"S":return fmt2(this.second);}
throw new ValueError(`No known conversion for ${m}`);});}
substract(timedelta){return this.add(timedelta.negate());}
toJSON(){return this.strftime("%Y-%m-%d %H:%M:%S");}
to_utc(){const d=new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second);const timedelta=PyTimeDelta.create({minutes:d.getTimezoneOffset()});return this.add(timedelta);}}
const PyTime=__exports.PyTime=class PyTime extends PyDate{static create(...args){const namedArgs=parseArgs(args,["hour","minute","second"]);const hour=namedArgs.hour||0;const minute=namedArgs.minute||0;const second=namedArgs.second||0;return new PyTime(hour,minute,second);}
constructor(hour,minute,second){const now=new Date();const year=now.getFullYear();const month=now.getMonth();const day=now.getDate();super(year,month,day);this.hour=hour;this.minute=minute;this.second=second;}
strftime(format){return format.replace(/%([A-Za-z])/g,(m,c)=>{switch(c){case"Y":return fmt4(this.year);case"m":return fmt2(this.month+1);case"d":return fmt2(this.day);case"H":return fmt2(this.hour);case"M":return fmt2(this.minute);case"S":return fmt2(this.second);}
throw new ValueError(`No known conversion for ${m}`);});}
toJSON(){return this.strftime("%H:%M:%S");}}
const DAYS_IN_YEAR=[31,59,90,120,151,181,212,243,273,304,334,366];const TIME_PERIODS=["hour","minute","second"];const PERIODS=["year","month","day",...TIME_PERIODS];const RELATIVE_KEYS="years months weeks days hours minutes seconds microseconds leapdays".split(" ");const ABSOLUTE_KEYS="year month day hour minute second microsecond weekday nlyearday yearday".split(" ");const argsSpec=["dt1","dt2"];const PyRelativeDelta=__exports.PyRelativeDelta=class PyRelativeDelta{static create(...args){const params=parseArgs(args,argsSpec);if("dt1"in params){throw new Error("relativedelta(dt1, dt2) is not supported for now");}
for(const period of PERIODS){if(period in params){const val=params[period];assert(val>=0,`${period} ${val} is out of range`);}}
for(const key of RELATIVE_KEYS){params[key]=params[key]||0;}
for(const key of ABSOLUTE_KEYS){params[key]=key in params?params[key]:null;}
params.days+=7*params.weeks;let yearDay=0;if(params.nlyearday){yearDay=params.nlyearday;}else if(params.yearday){yearDay=params.yearday;if(yearDay>59){params.leapDays=-1;}}
if(yearDay){for(let monthIndex=0;monthIndex<DAYS_IN_YEAR.length;monthIndex++){if(yearDay<=DAYS_IN_YEAR[monthIndex]){params.month=monthIndex+1;if(monthIndex===0){params.day=yearDay;}else{params.day=yearDay-DAYS_IN_YEAR[monthIndex-1];}
break;}}}
return new PyRelativeDelta(params);}
static add(date,delta){if(!(date instanceof PyDate||date instanceof PyDateTime)){throw NotSupportedError();}
const s=tmxxx((delta.year||date.year)+delta.years,(delta.month||date.month)+delta.months,delta.day||date.day,delta.hour||date.hour||0,delta.minute||date.minute||0,delta.second||date.seconds||0,delta.microseconds||date.microseconds||0);const newDateTime=new PyDateTime(s.year,s.month,s.day,s.hour,s.minute,s.second,s.microsecond);let leapDays=0;if(delta.leapDays&&newDateTime.month>2&&isLeap(newDateTime.year)){leapDays=delta.leapDays;}
const temp=newDateTime.add(PyTimeDelta.create({days:delta.days+leapDays,hours:delta.hours,minutes:delta.minutes,seconds:delta.seconds,microseconds:delta.microseconds,}));const hasTime=Boolean(temp.hour||temp.minute||temp.second||temp.microsecond);const returnDate=!hasTime&&date instanceof PyDate?new PyDate(temp.year,temp.month,temp.day):temp;if(delta.weekday!==null){const wantedDow=delta.weekday+1;const _date=new Date(returnDate.year,returnDate.month-1,returnDate.day);const days=(7-_date.getDay()+wantedDow)%7;return returnDate.add(new PyTimeDelta(days,0,0));}
return returnDate;}
static substract(date,delta){return PyRelativeDelta.add(date,delta.negate());}
constructor(params={},sign=+1){this.years=sign*params.years;this.months=sign*params.months;this.days=sign*params.days;this.hours=sign*params.hours;this.minutes=sign*params.minutes;this.seconds=sign*params.seconds;this.microseconds=sign*params.microseconds;this.leapDays=params.leapDays;this.year=params.year;this.month=params.month;this.day=params.day;this.hour=params.hour;this.minute=params.minute;this.second=params.second;this.microsecond=params.microsecond;this.weekday=params.weekday;}
negate(){return new PyRelativeDelta(this,-1);}
isEqual(other){throw new NotSupportedError();}}
const TIME_DELTA_KEYS="weeks days hours minutes seconds milliseconds microseconds".split(" ");function modf(x){const mod=x%1;return[mod<0?mod+1:mod,Math.floor(x)];}
const PyTimeDelta=__exports.PyTimeDelta=class PyTimeDelta{static create(...args){const namedArgs=parseArgs(args,["days","seconds","microseconds"]);for(const key of TIME_DELTA_KEYS){namedArgs[key]=namedArgs[key]||0;}
let d=0;let s=0;let us=0;const days=namedArgs.days+namedArgs.weeks*7;let seconds=namedArgs.seconds+60*namedArgs.minutes+3600*namedArgs.hours;let microseconds=namedArgs.microseconds+1000*namedArgs.milliseconds;const[dFrac,dInt]=modf(days);d=dInt;let daysecondsfrac=0;if(dFrac){const[dsFrac,dsInt]=modf(dFrac*24*3600);s=dsInt;daysecondsfrac=dsFrac;}
const[sFrac,sInt]=modf(seconds);seconds=sInt;const secondsfrac=sFrac+daysecondsfrac;divmod(seconds,24*3600,(days,seconds)=>{d+=days;s+=seconds;});microseconds+=secondsfrac*1e6;divmod(microseconds,1000000,(seconds,microseconds)=>{divmod(seconds,24*3600,(days,seconds)=>{d+=days;s+=seconds;us+=Math.round(microseconds);});});return new PyTimeDelta(d,s,us);}
constructor(days,seconds,microseconds){this.days=days;this.seconds=seconds;this.microseconds=microseconds;}
add(other){return PyTimeDelta.create({days:this.days+other.days,seconds:this.seconds+other.seconds,microseconds:this.microseconds+other.microseconds,});}
divide(n){const us=(this.days*24*3600+this.seconds)*1e6+this.microseconds;return PyTimeDelta.create({microseconds:Math.floor(us/n)});}
isEqual(other){if(!(other instanceof PyTimeDelta)){return false;}
return(this.days===other.days&&this.seconds===other.seconds&&this.microseconds===other.microseconds);}
isTrue(){return this.days!==0||this.seconds!==0||this.microseconds!==0;}
multiply(n){return PyTimeDelta.create({days:n*this.days,seconds:n*this.seconds,microseconds:n*this.microseconds,});}
negate(){return PyTimeDelta.create({days:-this.days,seconds:-this.seconds,microseconds:-this.microseconds,});}
substract(other){return PyTimeDelta.create({days:this.days-other.days,seconds:this.seconds-other.seconds,microseconds:this.microseconds-other.microseconds,});}
total_seconds(){return this.days*86400+this.seconds+this.microseconds/1000000;}}
return __exports;});;

/* /web/static/src/core/py_js/py_interpreter.js */
odoo.define('@web/core/py_js/py_interpreter',['@web/core/py_js/py_builtin','@web/core/py_js/py_date','@web/core/py_js/py_utils','@web/core/py_js/py_parser'],function(require){'use strict';let __exports={};const{BUILTINS,EvaluationError,execOnIterable}=require("@web/core/py_js/py_builtin");const{NotSupportedError,PyDate,PyDateTime,PyRelativeDelta,PyTime,PyTimeDelta,}=require("@web/core/py_js/py_date");const{PY_DICT,toPyDict}=require("@web/core/py_js/py_utils");const{parseArgs}=require("@web/core/py_js/py_parser");const isTrue=BUILTINS.bool;function applyUnaryOp(ast,context){const value=evaluate(ast.right,context);switch(ast.op){case"-":if(value instanceof Object&&value.negate){return value.negate();}
return-value;case"+":return value;case"not":return!isTrue(value);}
throw new EvaluationError(`Unknown unary operator: ${ast.op}`);}
function pytypeIndex(val){switch(typeof val){case"object":return val===null?1:Array.isArray(val)?5:3;case"number":return 2;case"string":return 4;}
throw new EvaluationError(`Unknown type: ${typeof val}`);}
function isConstructor(obj){return!!obj.prototype&&!!obj.prototype.constructor.name;}
function isLess(left,right){if(typeof left==="number"&&typeof right==="number"){return left<right;}
if(typeof left==="boolean"){left=left?1:0;}
if(typeof right==="boolean"){right=right?1:0;}
const leftIndex=pytypeIndex(left);const rightIndex=pytypeIndex(right);if(leftIndex===rightIndex){return left<right;}
return leftIndex<rightIndex;}
function isEqual(left,right){if(typeof left!==typeof right){if(typeof left==="boolean"&&typeof right==="number"){return right===(left?1:0);}
if(typeof left==="number"&&typeof right==="boolean"){return left===(right?1:0);}
return false;}
if(left instanceof Object&&left.isEqual){return left.isEqual(right);}
return left===right;}
function isIn(left,right){if(Array.isArray(right)){return right.includes(left);}
if(typeof right==="string"&&typeof left==="string"){return right.includes(left);}
if(typeof right==="object"){return left in right;}
return false;}
function applyBinaryOp(ast,context){const left=evaluate(ast.left,context);const right=evaluate(ast.right,context);switch(ast.op){case"+":{const relativeDeltaOnLeft=left instanceof PyRelativeDelta;const relativeDeltaOnRight=right instanceof PyRelativeDelta;if(relativeDeltaOnLeft||relativeDeltaOnRight){const date=relativeDeltaOnLeft?right:left;const delta=relativeDeltaOnLeft?left:right;return PyRelativeDelta.add(date,delta);}
const timeDeltaOnLeft=left instanceof PyTimeDelta;const timeDeltaOnRight=right instanceof PyTimeDelta;if(timeDeltaOnLeft&&timeDeltaOnRight){return left.add(right);}
if(timeDeltaOnLeft){if(right instanceof PyDate||right instanceof PyDateTime){return right.add(left);}else{throw NotSupportedError();}}
if(timeDeltaOnRight){if(left instanceof PyDate||left instanceof PyDateTime){return left.add(right);}else{throw NotSupportedError();}}
if(left instanceof Array&&right instanceof Array){return[...left,...right];}
return left+right;}
case"-":{const isRightDelta=right instanceof PyRelativeDelta;if(isRightDelta){return PyRelativeDelta.substract(left,right);}
const timeDeltaOnRight=right instanceof PyTimeDelta;if(timeDeltaOnRight){if(left instanceof PyTimeDelta){return left.substract(right);}else if(left instanceof PyDate||left instanceof PyDateTime){return left.substract(right);}else{throw NotSupportedError();}}
if(left instanceof PyDate){return left.substract(right);}
return left-right;}
case"*":{const timeDeltaOnLeft=left instanceof PyTimeDelta;const timeDeltaOnRight=right instanceof PyTimeDelta;if(timeDeltaOnLeft||timeDeltaOnRight){const number=timeDeltaOnLeft?right:left;const delta=timeDeltaOnLeft?left:right;return delta.multiply(number);}
return left*right;}
case"/":return left/right;case"%":return left%right;case"//":if(left instanceof PyTimeDelta){return left.divide(right);}
return Math.floor(left/right);case"**":return left**right;case"==":return isEqual(left,right);case"<>":case"!=":return!isEqual(left,right);case"<":return isLess(left,right);case">":return isLess(right,left);case">=":return isEqual(left,right)||isLess(right,left);case"<=":return isEqual(left,right)||isLess(left,right);case"in":return isIn(left,right);case"not in":return!isIn(left,right);}
throw new EvaluationError(`Unknown binary operator: ${ast.op}`);}
const DICT={get(...args){const{key,defValue}=parseArgs(args,["key","defValue"]);if(key in this){return this[key];}else if(defValue){return defValue;}
return null;},};const STRING={lower(){return this.toLowerCase();},upper(){return this.toUpperCase();},};function applyFunc(key,func,set,...args){if(args.length===1){return new Set(set);}
if(args.length>2){throw new EvaluationError(`${key}: py_js supports at most 1 argument, got (${args.length - 1})`);}
return execOnIterable(args[0],func);}
const SET={intersection(...args){return applyFunc("intersection",(iterable)=>{const intersection=new Set();for(const i of iterable){if(this.has(i)){intersection.add(i);}}
return intersection;},this,...args);},difference(...args){return applyFunc("difference",(iterable)=>{iterable=new Set(iterable);const difference=new Set();for(const e of this){if(!iterable.has(e)){difference.add(e);}}
return difference;},this,...args);},union(...args){return applyFunc("union",(iterable)=>{return new Set([...this,...iterable]);},this,...args);},};function methods(_class){return Object.getOwnPropertyNames(_class.prototype).map((prop)=>_class.prototype[prop]);}
const allowedFns=new Set([BUILTINS.time.strftime,BUILTINS.set,BUILTINS.bool,BUILTINS.context_today,BUILTINS.datetime.datetime.now,BUILTINS.datetime.datetime.combine,BUILTINS.datetime.date.today,...methods(BUILTINS.relativedelta),...Object.values(BUILTINS.datetime).flatMap((obj)=>methods(obj)),...Object.values(SET),...Object.values(DICT),...Object.values(STRING),]);const unboundFn=Symbol("unbound function");__exports.evaluate=evaluate;function evaluate(ast,context={}){const dicts=new Set();let pyContext;const evalContext=Object.create(context);if(!evalContext.context){Object.defineProperty(evalContext,"context",{get(){if(!pyContext){pyContext=toPyDict(context);}
return pyContext;},});}
function _innerEvaluate(ast){switch(ast.type){case 0:case 1:return ast.value;case 5:if(ast.value in evalContext){return evalContext[ast.value];}else if(ast.value in BUILTINS){return BUILTINS[ast.value];}else{throw new EvaluationError(`Name '${ast.value}' is not defined`);}
case 3:return null;case 2:return ast.value;case 6:return applyUnaryOp(ast,evalContext);case 7:return applyBinaryOp(ast,evalContext);case 14:{const left=_evaluate(ast.left);if(ast.op==="and"){return isTrue(left)?_evaluate(ast.right):left;}else{return isTrue(left)?left:_evaluate(ast.right);}}
case 4:case 10:return ast.value.map(_evaluate);case 11:{const dict={};for(const key in ast.value){dict[key]=_evaluate(ast.value[key]);}
dicts.add(dict);return dict;}
case 8:{const fnValue=_evaluate(ast.fn);const args=ast.args.map(_evaluate);const kwargs={};for(const kwarg in ast.kwargs){kwargs[kwarg]=_evaluate(ast.kwargs[kwarg]);}
if(fnValue===PyDate||fnValue===PyDateTime||fnValue===PyTime||fnValue===PyRelativeDelta||fnValue===PyTimeDelta){return fnValue.create(...args,kwargs);}
return fnValue(...args,kwargs);}
case 12:{const dict=_evaluate(ast.target);const key=_evaluate(ast.key);return dict[key];}
case 13:{if(isTrue(_evaluate(ast.condition))){return _evaluate(ast.ifTrue);}else{return _evaluate(ast.ifFalse);}}
case 15:{let left=_evaluate(ast.obj);let result;if(dicts.has(left)||Object.isPrototypeOf.call(PY_DICT,left)){result=DICT[ast.key];}else if(typeof left==="string"){result=STRING[ast.key];}else if(left instanceof Set){result=SET[ast.key];}else if(ast.key=="get"&&typeof left==="object"){result=DICT[ast.key];left=toPyDict(left);}else{result=left[ast.key];}
if(typeof result==="function"){if(!isConstructor(result)){const bound=result.bind(left);bound[unboundFn]=result;return bound;}}
return result;}}
throw new EvaluationError(`AST of type ${ast.type} cannot be evaluated`);}
function _evaluate(ast){const val=_innerEvaluate(ast);if(typeof val==="function"&&!allowedFns.has(val)&&!allowedFns.has(val[unboundFn])){throw new Error("Invalid Function Call");}
return val;}
return _evaluate(ast);}
return __exports;});;

/* /web/static/src/core/py_js/py_parser.js */
odoo.define('@web/core/py_js/py_parser',['@web/core/py_js/py_tokenizer'],function(require){'use strict';let __exports={};const{binaryOperators,comparators}=require("@web/core/py_js/py_tokenizer");const ParserError=__exports.ParserError=class ParserError extends Error{}
const chainedOperators=new Set(comparators);const infixOperators=new Set(binaryOperators.concat(comparators));__exports.bp=bp;function bp(symbol){switch(symbol){case"=":return 10;case"if":return 20;case"in":case"not in":case"is":case"is not":case"<":case"<=":case">":case">=":case"<>":case"==":case"!=":return 60;case"or":return 30;case"and":return 40;case"not":return 50;case"|":return 70;case"^":return 80;case"&":return 90;case"<<":case">>":return 100;case"+":case"-":return 110;case"*":case"/":case"//":case"%":return 120;case"**":return 140;case".":case"(":case"[":return 150;}
return 0;}
function bindingPower(token){return token.type===2?bp(token.value):0;}
function isSymbol(token,value){return token.type===2&&token.value===value;}
function parsePrefix(current,tokens){switch(current.type){case 0:return{type:0,value:current.value};case 1:return{type:1,value:current.value};case 4:if(current.value==="None"){return{type:3};}else{return{type:2,value:current.value==="True"};}
case 3:return{type:5,value:current.value};case 2:switch(current.value){case"-":case"+":case"~":return{type:6,op:current.value,right:_parse(tokens,130),};case"not":return{type:6,op:current.value,right:_parse(tokens,50),};case"(":{const content=[];let isTuple=false;while(tokens[0]&&!isSymbol(tokens[0],")")){content.push(_parse(tokens,0));if(tokens[0]){if(tokens[0]&&isSymbol(tokens[0],",")){isTuple=true;tokens.shift();}else if(!isSymbol(tokens[0],")")){throw new ParserError("parsing error");}}else{throw new ParserError("parsing error");}}
if(!tokens[0]||!isSymbol(tokens[0],")")){throw new ParserError("parsing error");}
tokens.shift();isTuple=isTuple||content.length===0;return isTuple?{type:10,value:content}:content[0];}
case"[":{const value=[];while(tokens[0]&&!isSymbol(tokens[0],"]")){value.push(_parse(tokens,0));if(tokens[0]){if(isSymbol(tokens[0],",")){tokens.shift();}else if(!isSymbol(tokens[0],"]")){throw new ParserError("parsing error");}}}
if(!tokens[0]||!isSymbol(tokens[0],"]")){throw new ParserError("parsing error");}
tokens.shift();return{type:4,value};}
case"{":{const dict={};while(tokens[0]&&!isSymbol(tokens[0],"}")){const key=_parse(tokens,0);if((key.type!==1&&key.type!==0)||!tokens[0]||!isSymbol(tokens[0],":")){throw new ParserError("parsing error");}
tokens.shift();const value=_parse(tokens,0);dict[key.value]=value;if(isSymbol(tokens[0],",")){tokens.shift();}}
if(!tokens.shift()){throw new ParserError("parsing error");}
return{type:11,value:dict};}}}
throw new ParserError("Token cannot be parsed");}
function parseInfix(left,current,tokens){switch(current.type){case 2:if(infixOperators.has(current.value)){let right=_parse(tokens,bindingPower(current));if(current.value==="and"||current.value==="or"){return{type:14,op:current.value,left,right,};}else if(current.value==="."){if(right.type===5){return{type:15,obj:left,key:right.value,};}else{throw new ParserError("invalid obj lookup");}}
let op={type:7,op:current.value,left,right,};while(chainedOperators.has(current.value)&&tokens[0]&&tokens[0].type===2&&chainedOperators.has(tokens[0].value)){const nextToken=tokens.shift();op={type:14,op:"and",left:op,right:{type:7,op:nextToken.value,left:right,right:_parse(tokens,bindingPower(nextToken)),},};right=op.right.right;}
return op;}
switch(current.value){case"(":{const args=[];const kwargs={};while(tokens[0]&&!isSymbol(tokens[0],")")){const arg=_parse(tokens,0);if(arg.type===9){kwargs[arg.name.value]=arg.value;}else{args.push(arg);}
if(tokens[0]&&isSymbol(tokens[0],",")){tokens.shift();}}
if(!tokens[0]||!isSymbol(tokens[0],")")){throw new ParserError("parsing error");}
tokens.shift();return{type:8,fn:left,args,kwargs};}
case"=":if(left.type===5){return{type:9,name:left,value:_parse(tokens,10),};}
break;case"[":{const key=_parse(tokens);if(!tokens[0]||!isSymbol(tokens[0],"]")){throw new ParserError("parsing error");}
tokens.shift();return{type:12,target:left,key:key,};}
case"if":{const condition=_parse(tokens);if(!tokens[0]||!isSymbol(tokens[0],"else")){throw new ParserError("parsing error");}
tokens.shift();const ifFalse=_parse(tokens);return{type:13,condition,ifTrue:left,ifFalse,};}}}
throw new ParserError("Token cannot be parsed");}
function _parse(tokens,bp=0){const token=tokens.shift();let expr=parsePrefix(token,tokens);while(tokens[0]&&bindingPower(tokens[0])>bp){expr=parseInfix(expr,tokens.shift(),tokens);}
return expr;}
__exports.parse=parse;function parse(tokens){if(tokens.length){return _parse(tokens,0);}
throw new ParserError("Missing token");}
__exports.parseArgs=parseArgs;function parseArgs(args,spec){const last=args[args.length-1];const unnamedArgs=typeof last==="object"?args.slice(0,-1):args;const kwargs=typeof last==="object"?last:{};for(const[index,val]of unnamedArgs.entries()){kwargs[spec[index]]=val;}
return kwargs;}
return __exports;});;

/* /web/static/src/core/py_js/py_tokenizer.js */
odoo.define('@web/core/py_js/py_tokenizer',[],function(require){'use strict';let __exports={};const TokenizerError=__exports.TokenizerError=class TokenizerError extends Error{}
const directMap={"\\":"\\",'"':'"',"'":"'",a:"\x07",b:"\x08",f:"\x0c",n:"\n",r:"\r",t:"\t",v:"\v",};function decodeStringLiteral(str,unicode){const out=[];let code;for(var i=0;i<str.length;++i){if(str[i]!=="\\"){out.push(str[i]);continue;}
var escape=str[i+1];if(escape in directMap){out.push(directMap[escape]);++i;continue;}
switch(escape){case"\n":++i;continue;case"N":if(!unicode){break;}
throw new TokenizerError("SyntaxError: \\N{} escape not implemented");case"u":if(!unicode){break;}
var uni=str.slice(i+2,i+6);if(!/[0-9a-f]{4}/i.test(uni)){throw new TokenizerError(["SyntaxError: (unicode error) 'unicodeescape' codec"," can't decode bytes in position ",i,"-",i+4,": truncated \\uXXXX escape",].join(""));}
code=parseInt(uni,16);out.push(String.fromCharCode(code));i+=5;continue;case"U":if(!unicode){break;}
throw new TokenizerError("SyntaxError: \\U escape not implemented");case"x":var hex=str.slice(i+2,i+4);if(!/[0-9a-f]{2}/i.test(hex)){if(!unicode){throw new TokenizerError("ValueError: invalid \\x escape");}
throw new TokenizerError(["SyntaxError: (unicode error) 'unicodeescape'"," codec can't decode bytes in position ",i,"-",i+2,": truncated \\xXX escape",].join(""));}
code=parseInt(hex,16);out.push(String.fromCharCode(code));i+=3;continue;default:if(!/[0-8]/.test(escape)){break;}
var r=/[0-8]{1,3}/g;r.lastIndex=i+1;var m=r.exec(str);var oct=m[0];code=parseInt(oct,8);out.push(String.fromCharCode(code));i+=oct.length;continue;}
out.push("\\");}
return out.join("");}
const constants=new Set(["None","False","True"]);const comparators=__exports.comparators=["in","not","not in","is","is not","<","<=",">",">=","<>","!=","==",];const binaryOperators=__exports.binaryOperators=["or","and","|","^","&","<<",">>","+","-","*","/","//","%","~","**",".",];const unaryOperators=__exports.unaryOperators=["-"];const symbols=new Set([...["(",")","[","]","{","}",":",","],...["if","else","lambda","="],...comparators,...binaryOperators,...unaryOperators,]);function group(...args){return"("+args.join("|")+")";}
const Name="[a-zA-Z_]\\w*";const Whitespace="[ \\f\\t]*";const DecNumber="\\d+(L|l)?";const IntNumber=DecNumber;const Exponent="[eE][+-]?\\d+";const PointFloat=group(`\\d+\\.\\d*(${Exponent})?`,`\\.\\d+(${Exponent})?`);const FloatNumber=group(PointFloat,`\\d+${Exponent}`);const Number=group(FloatNumber,IntNumber);const Operator=group("\\*\\*=?",">>=?","<<=?","<>","!=","//=?","[+\\-*/%&|^=<>]=?","~");const Bracket="[\\[\\]\\(\\)\\{\\}]";const Special="[:;.,`@]";const Funny=group(Operator,Bracket,Special);const ContStr=group("([uU])?'([^\n'\\\\]*(?:\\\\.[^\n'\\\\]*)*)'",'([uU])?"([^\n"\\\\]*(?:\\\\.[^\n"\\\\]*)*)"');const PseudoToken=Whitespace+group(Number,Funny,ContStr,Name);const NumberPattern=new RegExp("^"+Number+"$");const StringPattern=new RegExp("^"+ContStr+"$");const NamePattern=new RegExp("^"+Name+"$");const strip=new RegExp("^"+Whitespace);__exports.tokenize=tokenize;function tokenize(str){const tokens=[];const max=str.length;let start=0;let end=0;const pseudoprog=new RegExp(PseudoToken,"g");while(pseudoprog.lastIndex<max){const pseudomatch=pseudoprog.exec(str);if(!pseudomatch){if(/^\s+$/.test(str.slice(end))){break;}
throw new TokenizerError("Failed to tokenize <<"+
str+">> at index "+
(end||0)+"; parsed so far: "+
tokens);}
if(pseudomatch.index>end){if(str.slice(end,pseudomatch.index).trim()){throw new TokenizerError("Invalid expression");}}
start=pseudomatch.index;end=pseudoprog.lastIndex;let token=str.slice(start,end).replace(strip,"");if(NumberPattern.test(token)){tokens.push({type:0,value:parseFloat(token),});}else if(StringPattern.test(token)){var m=StringPattern.exec(token);tokens.push({type:1,value:decodeStringLiteral(m[3]!==undefined?m[3]:m[5],!!(m[2]||m[4])),});}else if(symbols.has(token)){if(token==="in"&&tokens.length>0&&tokens[tokens.length-1].value==="not"){token="not in";tokens.pop();}else if(token==="not"&&tokens.length>0&&tokens[tokens.length-1].value==="is"){token="is not";tokens.pop();}
tokens.push({type:2,value:token,});}else if(constants.has(token)){tokens.push({type:4,value:token,});}else if(NamePattern.test(token)){tokens.push({type:3,value:token,});}else{throw new TokenizerError("Invalid expression");}}
return tokens;}
return __exports;});;

/* /web/static/src/core/py_js/py_utils.js */
odoo.define('@web/core/py_js/py_utils',['@web/core/py_js/py_parser','@web/core/py_js/py_date'],function(require){'use strict';let __exports={};const{bp}=require("@web/core/py_js/py_parser");const{PyDate,PyDateTime}=require("@web/core/py_js/py_date");__exports.toPyValue=toPyValue;function toPyValue(value){switch(typeof value){case"string":return{type:1,value};case"number":return{type:0,value};case"boolean":return{type:2,value};case"object":if(Array.isArray(value)){return{type:4,value:value.map(toPyValue)};}else if(value===null){return{type:3};}else if(value instanceof Date){return{type:1,value:PyDateTime.convertDate(value)};}else if(value instanceof PyDate||value instanceof PyDateTime){return{type:1,value};}else{const content={};for(const key in value){content[key]=toPyValue(value[key]);}
return{type:11,value:content};}
default:throw new Error("Invalid type");}}
__exports.formatAST=formatAST;function formatAST(ast,lbp=0){switch(ast.type){case 3:return"None";case 1:return JSON.stringify(ast.value);case 0:return String(ast.value);case 2:return ast.value?"True":"False";case 4:return`[${ast.value.map(formatAST).join(", ")}]`;case 6:if(ast.op==="not"){return`not `+formatAST(ast.right,50);}
return ast.op+formatAST(ast.right,130);case 7:{const abp=bp(ast.op);const str=`${formatAST(ast.left, abp)} ${ast.op} ${formatAST(ast.right, abp)}`;return abp<lbp?`(${str})`:str;}
case 11:{const pairs=[];for(const k in ast.value){pairs.push(`"${k}": ${formatAST(ast.value[k])}`);}
return`{`+pairs.join(", ")+`}`;}
case 10:return`(${ast.value.map(formatAST).join(", ")})`;case 5:return ast.value;case 12:{return`${formatAST(ast.target)}[${formatAST(ast.key)}]`;}
case 13:{const{ifTrue,condition,ifFalse}=ast;return`${formatAST(ifTrue)} if ${formatAST(condition)} else ${formatAST(ifFalse)}`;}
case 14:{const abp=bp(ast.op);const str=`${formatAST(ast.left, abp)} ${ast.op} ${formatAST(ast.right, abp)}`;return abp<lbp?`(${str})`:str;}
case 15:return`${formatAST(ast.obj, 150)}.${ast.key}`;case 8:{const args=ast.args.map(formatAST);const kwargs=[];for(const kwarg in ast.kwargs){kwargs.push(`${kwarg} = ${formatAST(ast.kwargs[kwarg])}`);}
const argStr=args.concat(kwargs).join(", ");return`${formatAST(ast.fn)}(${argStr})`;}}
throw new Error("invalid expression: "+ast);}
const PY_DICT=__exports.PY_DICT=Object.create(null);__exports.toPyDict=toPyDict;function toPyDict(obj){return new Proxy(obj,{getPrototypeOf(){return PY_DICT;},});}
return __exports;});;

/* /web/static/src/core/record_selectors/multi_record_selector.js */
odoo.define('@web/core/record_selectors/multi_record_selector',['@odoo/owl','@web/core/tags_list/tags_list','@web/core/utils/hooks','@web/core/record_selectors/record_autocomplete','@web/core/l10n/translation','@web/core/record_selectors/tag_navigation_hook'],function(require){'use strict';let __exports={};const{Component,onWillStart,onWillUpdateProps}=require("@odoo/owl");const{TagsList}=require("@web/core/tags_list/tags_list");const{useService}=require("@web/core/utils/hooks");const{RecordAutocomplete}=require("@web/core/record_selectors/record_autocomplete");const{_t}=require("@web/core/l10n/translation");const{useTagNavigation}=require("@web/core/record_selectors/tag_navigation_hook");const MultiRecordSelector=__exports.MultiRecordSelector=class MultiRecordSelector extends Component{static props={resIds:{type:Array,element:Number},resModel:String,update:Function,domain:{type:Array,optional:true},context:{type:Object,optional:true},fieldString:{type:String,optional:true},placeholder:{type:String,optional:true},};static components={RecordAutocomplete,TagsList};static template="web.MultiRecordSelector";setup(){this.nameService=useService("name");this.onTagKeydown=useTagNavigation("multiRecordSelector",this.deleteTag.bind(this));onWillStart(()=>this.computeDerivedParams());onWillUpdateProps((nextProps)=>this.computeDerivedParams(nextProps));}
async computeDerivedParams(props=this.props){const displayNames=await this.getDisplayNames(props);this.tags=this.getTags(props,displayNames);}
async getDisplayNames(props){const ids=this.getIds(props);return this.nameService.loadDisplayNames(props.resModel,ids);}
get placeholder(){return this.getIds().length?"":this.props.placeholder;}
getIds(props=this.props){return props.resIds;}
getTags(props,displayNames){return props.resIds.map((id,index)=>{const text=typeof displayNames[id]==="string"?displayNames[id]:_t("Inaccessible/missing record ID: %s",id);return{text,onDelete:()=>{this.deleteTag(index);},onKeydown:this.onTagKeydown,};});}
deleteTag(index){this.props.update([...this.props.resIds.slice(0,index),...this.props.resIds.slice(index+1),]);}
update(resIds){this.props.update([...this.props.resIds,...resIds]);}}
return __exports;});;

/* /web/static/src/core/record_selectors/record_autocomplete.js */
odoo.define('@web/core/record_selectors/record_autocomplete',['@odoo/owl','@web/core/autocomplete/autocomplete','@web/core/l10n/translation','@web/core/domain','@web/core/registry','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{AutoComplete}=require("@web/core/autocomplete/autocomplete");const{_t}=require("@web/core/l10n/translation");const{Domain}=require("@web/core/domain");const{registry}=require("@web/core/registry");const{useOwnedDialogs,useService}=require("@web/core/utils/hooks");const SEARCH_LIMIT=7;const SEARCH_MORE_LIMIT=320;const RecordAutocomplete=__exports.RecordAutocomplete=class RecordAutocomplete extends Component{static props={resModel:String,update:Function,multiSelect:Boolean,getIds:Function,value:String,domain:{type:Array,optional:true},context:{type:Object,optional:true},className:{type:String,optional:true},fieldString:{type:String,optional:true},placeholder:{type:String,optional:true},};static components={AutoComplete};static template="web.RecordAutocomplete";setup(){this.orm=useService("orm");this.nameService=useService("name");this.addDialog=useOwnedDialogs();this.sources=[{placeholder:_t("Loading..."),options:this.loadOptionsSource.bind(this),},];}
addNames(options){const displayNames=Object.fromEntries(options);this.nameService.addDisplayNames(this.props.resModel,displayNames);}
getIds(){return this.props.getIds();}
async loadOptionsSource(name){if(this.lastProm){this.lastProm.abort(false);}
this.lastProm=this.search(name,SEARCH_LIMIT+1);const nameGets=(await this.lastProm).map(([id,label])=>([id,label?label.split("\n")[0]:_t("Unnamed")]));this.addNames(nameGets);const options=nameGets.map(([value,label])=>({value,label}));if(SEARCH_LIMIT<nameGets.length){options.push({label:_t("Search More..."),action:this.onSearchMore.bind(this,name),classList:"o_m2o_dropdown_option",});}
if(options.length===0){options.push({label:_t("(no result)"),unselectable:true});}
return options;}
async onSearchMore(name){const{fieldString,multiSelect,resModel}=this.props;let operator;const ids=[];if(name){const nameGets=await this.search(name,SEARCH_MORE_LIMIT);this.addNames(nameGets);operator="in";ids.push(...nameGets.map((nameGet)=>nameGet[0]));}else{operator="not in";ids.push(...this.getIds());}
const dynamicFilters=ids.length?[{description:_t("Quick search: %s",name),domain:[["id",operator,ids]],},]:undefined;const SelectCreateDialog=registry.category("dialogs").get("select_create");this.addDialog(SelectCreateDialog,{title:_t("Search: %s",fieldString),dynamicFilters,resModel,noCreate:true,multiSelect,context:this.props.context||{},onSelected:(resId)=>{const resIds=Array.isArray(resId)?resId:[resId];this.props.update([...resIds]);},});}
getDomain(){const domainIds=Domain.not([["id","in",this.getIds()]]);if(this.props.domain){return Domain.and([this.props.domain,domainIds]).toList();}
return domainIds.toList();}
onSelect({value:resId,action},params){if(action){return action(params);}
this.props.update([resId]);}
search(name,limit){const domain=this.getDomain();return this.orm.call(this.props.resModel,"name_search",[],{name,args:domain,limit,context:this.props.context||{},});}
onChange({inputValue}){if(!inputValue.length){this.props.update([]);}}}
return __exports;});;

/* /web/static/src/core/record_selectors/record_selector.js */
odoo.define('@web/core/record_selectors/record_selector',['@odoo/owl','@web/core/utils/hooks','@web/core/record_selectors/record_autocomplete','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{Component,onWillStart,onWillUpdateProps}=require("@odoo/owl");const{useService}=require("@web/core/utils/hooks");const{RecordAutocomplete}=require("@web/core/record_selectors/record_autocomplete");const{_t}=require("@web/core/l10n/translation");const RecordSelector=__exports.RecordSelector=class RecordSelector extends Component{static props={resId:[Number,{value:false}],resModel:String,update:Function,domain:{type:Array,optional:true},context:{type:Object,optional:true},fieldString:{type:String,optional:true},placeholder:{type:String,optional:true},};static components={RecordAutocomplete};static template="web.RecordSelector";setup(){this.nameService=useService("name");onWillStart(()=>this.computeDerivedParams());onWillUpdateProps((nextProps)=>this.computeDerivedParams(nextProps));}
async computeDerivedParams(props=this.props){const displayNames=await this.getDisplayNames(props);this.displayName=this.getDisplayName(props,displayNames);}
async getDisplayNames(props){const ids=this.getIds(props);return this.nameService.loadDisplayNames(props.resModel,ids);}
getDisplayName(props=this.props,displayNames){const{resId}=props;if(resId===false){return"";}
return typeof displayNames[resId]==="string"?displayNames[resId]:_t("Inaccessible/missing record ID: %s",resId);}
getIds(props=this.props){if(props.resId){return[props.resId];}
return[];}
update(resIds){this.props.update(resIds[0]||false);this.render(true);}}
return __exports;});;

/* /web/static/src/core/record_selectors/tag_navigation_hook.js */
odoo.define('@web/core/record_selectors/tag_navigation_hook',['@web/core/hotkeys/hotkey_service','@odoo/owl'],function(require){'use strict';let __exports={};const{getActiveHotkey}=require("@web/core/hotkeys/hotkey_service");const{useEffect,useRef}=require("@odoo/owl");__exports.useTagNavigation=useTagNavigation;function useTagNavigation(refName,deleteTag){const ref=useRef(refName);useEffect((autocomplete)=>{if(!autocomplete){return;}
autocomplete.addEventListener("keydown",onAutoCompleteKeydown);return()=>{autocomplete.removeEventListener("keydown",onAutoCompleteKeydown);};},()=>[ref.el?.querySelector(".o-autocomplete")]);function focusTag(index){const tags=ref.el.getElementsByClassName("o_tag");if(tags.length){if(index===undefined){tags[tags.length-1].focus();}else{tags[index].focus();}}}
function onAutoCompleteKeydown(ev){if(ev.isComposing){return;}
const hotkey=getActiveHotkey(ev);const input=ev.target.closest(".o-autocomplete--input");const autoCompleteMenuOpened=!!ref.el.querySelector(".o-autocomplete--dropdown-menu");switch(hotkey){case"arrowleft":{if(input.selectionStart||autoCompleteMenuOpened){return;}
focusTag();break;}
case"arrowright":{if(input.selectionStart!==input.value.length||autoCompleteMenuOpened){return;}
focusTag(0);break;}
case"backspace":{if(input.value){return;}
const tags=ref.el.getElementsByClassName("o_tag");if(tags.length){deleteTag(tags.length-1);}
break;}
default:return;}
ev.preventDefault();ev.stopPropagation();}
function onTagKeydown(ev){const hotkey=getActiveHotkey(ev);const tags=[...ref.el.getElementsByClassName("o_tag")];const closestTag=ev.target.closest(".o_tag");const tagIndex=tags.indexOf(closestTag);const input=ref.el.querySelector(".o-autocomplete--input");switch(hotkey){case"arrowleft":{if(tagIndex===0){input.focus();}else{focusTag(tagIndex-1);}
break;}
case"arrowright":{if(tagIndex===tags.length-1){input.focus();}else{focusTag(tagIndex+1);}
break;}
case"backspace":{input.focus();deleteTag(tagIndex);break;}
default:return;}
ev.preventDefault();ev.stopPropagation();}
return onTagKeydown;}
return __exports;});;

/* /web/static/src/core/registry.js */
odoo.define('@web/core/registry',['@odoo/owl'],function(require){'use strict';let __exports={};const{EventBus}=require("@odoo/owl");const KeyNotFoundError=__exports.KeyNotFoundError=class KeyNotFoundError extends Error{}
const DuplicatedKeyError=__exports.DuplicatedKeyError=class DuplicatedKeyError extends Error{}
const Registry=__exports.Registry=class Registry extends EventBus{constructor(){super();this.content={};this.subRegistries={};this.elements=null;this.entries=null;this.addEventListener("UPDATE",()=>{this.elements=null;this.entries=null;});}
add(key,value,{force,sequence}={}){if(!force&&key in this.content){throw new DuplicatedKeyError(`Cannot add '${key}' in this registry: it already exists`);}
let previousSequence;if(force){const elem=this.content[key];previousSequence=elem&&elem[0];}
sequence=sequence===undefined?previousSequence||50:sequence;this.content[key]=[sequence,value];const payload={operation:"add",key,value};this.trigger("UPDATE",payload);return this;}
get(key,defaultValue){if(arguments.length<2&&!(key in this.content)){throw new KeyNotFoundError(`Cannot find ${key} in this registry!`);}
const info=this.content[key];return info?info[1]:defaultValue;}
contains(key){return key in this.content;}
getAll(){if(!this.elements){const content=Object.values(this.content).sort((el1,el2)=>el1[0]-el2[0]);this.elements=content.map((elem)=>elem[1]);}
return this.elements.slice();}
getEntries(){if(!this.entries){const entries=Object.entries(this.content).sort((el1,el2)=>el1[1][0]-el2[1][0]);this.entries=entries.map(([str,elem])=>[str,elem[1]]);}
return this.entries.slice();}
remove(key){const value=this.content[key];delete this.content[key];const payload={operation:"delete",key,value};this.trigger("UPDATE",payload);}
category(subcategory){if(!(subcategory in this.subRegistries)){this.subRegistries[subcategory]=new Registry();}
return this.subRegistries[subcategory];}}
const registry=__exports.registry=new Registry();return __exports;});;

/* /web/static/src/core/resizable_panel/resizable_panel.js */
odoo.define('@web/core/resizable_panel/resizable_panel',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component,onMounted,onWillUpdateProps,onWillUnmount,useEffect,useExternalListener,useRef,useComponent,}=require("@odoo/owl");function useResizable({containerRef,handleRef,initialWidth=400,getMinWidth=()=>400,onResize=()=>{},getResizeSide=()=>"end",}){containerRef=typeof containerRef=="string"?useRef(containerRef):containerRef;handleRef=typeof handleRef=="string"?useRef(handleRef):handleRef;const props=useComponent().props;let minWidth=getMinWidth(props);let resizeSide=getResizeSide(props);let isChangingSize=false;useExternalListener(document,"mouseup",()=>onMouseUp());useExternalListener(document,"mousemove",(ev)=>onMouseMove(ev));useExternalListener(window,"resize",()=>{const limit=getLimitWidth();if(getContainerRect().width>=limit){resize(computeFinalWidth(limit));}});let docDirection;useEffect((container)=>{if(container){docDirection=getComputedStyle(container).direction;}},()=>[containerRef.el]);onMounted(()=>{if(handleRef.el){resize(initialWidth);handleRef.el.addEventListener("mousedown",onMouseDown);}});onWillUpdateProps((nextProps)=>{minWidth=getMinWidth(nextProps);resizeSide=getResizeSide(nextProps);});onWillUnmount(()=>{if(handleRef.el){handleRef.el.removeEventListener("mousedown",onMouseDown);}});function onMouseDown(){isChangingSize=true;document.body.classList.add("pe-none","user-select-none");}
function onMouseUp(){isChangingSize=false;document.body.classList.remove("pe-none","user-select-none");}
function onMouseMove(ev){if(!isChangingSize||!containerRef.el){return;}
const direction=(docDirection==="ltr"&&resizeSide==="end")||(docDirection==="rtl"&&resizeSide==="start")?1:-1;const fixedSide=direction===1?"left":"right";const containerRect=getContainerRect();const newWidth=(ev.clientX-containerRect[fixedSide])*direction;resize(computeFinalWidth(newWidth));}
function computeFinalWidth(targetContainerWidth){const handlerSpacing=handleRef.el?handleRef.el.offsetWidth/2:10;const w=Math.max(minWidth,targetContainerWidth+handlerSpacing);const limit=getLimitWidth();return Math.min(w,limit-handlerSpacing);}
function getContainerRect(){const container=containerRef.el;const offsetParent=container.offsetParent;let containerRect={};if(!offsetParent){containerRect=container.getBoundingClientRect();}else{containerRect.left=container.offsetLeft;containerRect.right=container.offsetLeft+container.offsetWidth;containerRect.width=container.offsetWidth;}
return containerRect;}
function getLimitWidth(){const offsetParent=containerRef.el.offsetParent;return offsetParent?offsetParent.offsetWidth:window.innerWidth;}
function resize(width){containerRef.el.style.setProperty("width",`${width}px`);onResize(width);}}
const ResizablePanel=__exports.ResizablePanel=class ResizablePanel extends Component{static template="web_studio.ResizablePanel";static components={};static props={onResize:{type:Function,optional:true},initialWidth:{type:Number,optional:true},minWidth:{type:Number,optional:true},class:{type:String,optional:true},slots:{type:Object},handleSide:{validate:(val)=>["start","end"].includes(val),optional:true,},};static defaultProps={onResize:()=>{},width:400,minWidth:400,class:"",handleSide:"end",};setup(){useResizable({containerRef:"containerRef",handleRef:"handleRef",onResize:this.props.onResize,initialWidth:this.props.initialWidth,getMinWidth:(props)=>props.minWidth,getResizeSide:(props)=>props.handleSide,});}
get class(){const classes=this.props.class.split(" ");if(!classes.some((cls)=>cls.startsWith("position-"))){classes.push("position-relative");}
return classes.join(" ");}}
return __exports;});;

/* /web/static/src/core/scroller_service.js */
odoo.define('@web/core/scroller_service',['@web/core/browser/browser','@web/core/registry','@web/core/utils/scrolling'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{registry}=require("@web/core/registry");const{scrollTo}=require("@web/core/utils/scrolling");const scrollerService=__exports.scrollerService={start(env){browser.addEventListener("click",(ev)=>{const link=ev.target.closest("a");if(!link){return;}
const disableAnchor=link.attributes.getNamedItem("disable_anchor");if(disableAnchor&&disableAnchor.value==="true"){return;}
const href=link.attributes.getNamedItem("href");if(href){if(href.value[0]==="#"){if(href.value.length===1){ev.preventDefault();return;}
let matchingEl=null;try{matchingEl=document.querySelector(`.o_content #${href.value.substr(1)}`);}catch{}
const triggerEv=new CustomEvent("anchor-link-clicked",{detail:{element:matchingEl,id:href.value,originalEv:ev,},});env.bus.trigger("SCROLLER:ANCHOR_LINK_CLICKED",triggerEv);if(matchingEl&&!triggerEv.defaultPrevented){ev.preventDefault();scrollTo(matchingEl,{isAnchor:true});}}}});},};registry.category("services").add("scroller",scrollerService);return __exports;});;

/* /web/static/src/core/select_menu/select_menu.js */
odoo.define('@web/core/select_menu/select_menu',['@odoo/owl','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/l10n/translation','@web/core/utils/timing','@web/core/utils/scrolling','@web/core/utils/search','@web/core/tags_list/tags_list','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{Component,useState,useRef,onWillUpdateProps,useEffect}=require("@odoo/owl");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{_t}=require("@web/core/l10n/translation");const{useDebounced}=require("@web/core/utils/timing");const{scrollTo}=require("@web/core/utils/scrolling");const{fuzzyLookup}=require("@web/core/utils/search");const{TagsList}=require("@web/core/tags_list/tags_list");const{useAutofocus}=require("@web/core/utils/hooks");const SelectMenu=__exports.SelectMenu=class SelectMenu extends Component{static template="web.SelectMenu";static choiceItemTemplate="web.SelectMenu.ChoiceItem";static components={Dropdown,DropdownItem,TagsList};static defaultProps={value:undefined,class:"",togglerClass:"",multiSelect:false,onSelect:()=>{},required:false,searchable:true,autoSort:true,searchPlaceholder:_t("Search..."),choices:[],groups:[],};static props={choices:{optional:true,type:Array,element:{type:Object,shape:{value:true,label:{type:String},},},},groups:{type:Array,optional:true,element:{type:Object,shape:{label:{type:String,optional:true},choices:{type:Array,element:{type:Object,shape:{value:true,label:{type:String},},},},},},},class:{type:String,optional:true},togglerClass:{type:String,optional:true},required:{type:Boolean,optional:true},searchable:{type:Boolean,optional:true},autoSort:{type:Boolean,optional:true},searchPlaceholder:{type:String,optional:true},value:{optional:true},multiSelect:{type:Boolean,optional:true},onInput:{type:Function,optional:true},onSelect:{type:Function,optional:true},slots:{type:Object,optional:true},};static SCROLL_SETTINGS={defaultCount:500,increaseAmount:300,distanceBeforeReload:500,};setup(){this.state=useState({choices:[],displayedOptions:[],searchValue:"",});this.inputRef=useRef("inputRef");this.debouncedOnInput=useDebounced(()=>this.onInput(this.inputRef.el?this.inputRef.el.value.trim():""),250);this.isOpen=false;this.selectedChoice=this.getSelectedChoice(this.props);onWillUpdateProps((nextProps)=>{if(this.props.value!==nextProps.value){this.selectedChoice=this.getSelectedChoice(nextProps);}});useEffect(()=>{if(this.isOpen){const groups=[{choices:this.props.choices},...this.props.groups];this.filterOptions(this.state.searchValue,groups);}},()=>[this.props.choices,this.props.groups]);useAutofocus({refName:"inputRef"});}
get displayValue(){return this.selectedChoice?this.selectedChoice.label:"";}
get canDeselect(){return!this.props.required&&this.selectedChoice!==undefined;}
get multiSelectChoices(){const choices=[...this.props.choices,...this.props.groups.flatMap((g)=>g.choices),].filter((c)=>this.props.value.includes(c.value));return choices.map((c)=>{return{id:c.value,text:c.label,onDelete:()=>{const values=[...this.props.value];values.splice(values.indexOf(c.value),1);this.props.onSelect(values);},};});}
async onBeforeOpen(){if(this.state.searchValue.length){this.state.searchValue="";if(this.props.onInput){await this.executeOnInput("");}}
this.filterOptions();}
onStateChanged({open}){this.isOpen=open;if(open){const selectedElement=document.querySelector(".o_select_active");if(selectedElement){scrollTo(selectedElement);}}}
isOptionSelected(choice){if(this.props.multiSelect){return this.props.value.includes(choice.value);}
return this.props.value===choice.value;}
getItemClass(choice){if(this.isOptionSelected(choice)){return"o_select_menu_item mb-1 o_select_active bg-primary fw-bolder fst-italic";}else{return"o_select_menu_item mb-1";}}
async executeOnInput(searchString){await this.props.onInput(searchString);}
onInput(searchString){this.filterOptions(searchString);this.state.searchValue=searchString;const inputEl=this.inputRef.el;if(inputEl&&inputEl.parentNode){inputEl.parentNode.scrollTo(0,0);}
if(this.props.onInput){this.executeOnInput(searchString);}}
onSearchKeydown(ev){if(ev.key==="ArrowDown"||ev.key==="Enter"){const target=ev.target.parentElement.querySelector(".o_select_menu_item");ev.target.classList.remove("focus");target?.classList.add("focus");target?.focus();ev.preventDefault();}
if(ev.key==="Enter"&&this.state.choices.length===1){ev.target.parentElement.querySelector(".o_select_menu_item").click();}}
getSelectedChoice(props){const choices=[...props.choices,...props.groups.flatMap((g)=>g.choices)];return choices.find((c)=>c.value===props.value);}
onItemSelected(value){if(this.props.multiSelect){const values=[...this.props.value];const valueIndex=values.indexOf(value);if(valueIndex!==-1){values.splice(valueIndex,1);this.props.onSelect(values);}else{this.props.onSelect([...this.props.value,value]);}}else if(!this.selectedChoice||this.selectedChoice.value!==value){this.props.onSelect(value);}}
filterOptions(searchString="",groups){const groupsList=groups||[{choices:this.props.choices},...this.props.groups];this.state.choices=[];for(const group of groupsList){let filteredOptions=[];if(searchString){filteredOptions=fuzzyLookup(searchString,group.choices,(choice)=>choice.label);}else{filteredOptions=group.choices;if(this.props.autoSort){filteredOptions.sort((optionA,optionB)=>optionA.label.localeCompare(optionB.label));}}
if(filteredOptions.length===0){continue;}
if(group.label){this.state.choices.push({...group,isGroup:true});}
this.state.choices.push(...filteredOptions);}
this.sliceDisplayedOptions();}
getGroupsIndex(choices){if(choices.length===0){return[];}
return choices.flatMap((choice,index)=>(index===0?0:choice.isGroup?index:[]));}
onScroll(event){const el=event.target;const hasReachMax=this.state.displayedOptions.length>=this.state.choices.length;const remainingDistance=el.scrollHeight-el.scrollTop;const distanceToReload=el.clientHeight+this.constructor.SCROLL_SETTINGS.distanceBeforeReload;if(!hasReachMax&&remainingDistance<distanceToReload){const displayCount=this.state.displayedOptions.length+
this.constructor.SCROLL_SETTINGS.increaseAmount;this.state.displayedOptions=this.state.choices.slice(0,displayCount);}}
sliceDisplayedOptions(){const selectedIndex=this.getSelectedOptionIndex();const defaultCount=this.constructor.SCROLL_SETTINGS.defaultCount;if(selectedIndex===-1){this.state.displayedOptions=this.state.choices.slice(0,defaultCount);}else{const endIndex=Math.max(selectedIndex+this.constructor.SCROLL_SETTINGS.increaseAmount,defaultCount);this.state.displayedOptions=this.state.choices.slice(0,endIndex);}}
getSelectedOptionIndex(){let selectedIndex=-1;for(let i=0;i<this.state.choices.length;i++){if(this.isOptionSelected(this.state.choices[i])){selectedIndex=i;}}
return selectedIndex;}}
return __exports;});;

/* /web/static/src/core/signature/name_and_signature.js */
odoo.define('@web/core/signature/name_and_signature',['@web/core/assets','@web/core/browser/feature_detection','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/utils/hooks','@web/core/utils/objects','@web/core/utils/render','@web/core/utils/urls','@odoo/owl'],function(require){'use strict';let __exports={};const{loadJS}=require("@web/core/assets");const{isMobileOS}=require("@web/core/browser/feature_detection");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{useService,useAutofocus}=require("@web/core/utils/hooks");const{pick}=require("@web/core/utils/objects");const{renderToString}=require("@web/core/utils/render");const{getDataURLFromFile}=require("@web/core/utils/urls");const{Component,useState,onWillStart,useRef,useEffect}=require("@odoo/owl");let htmlId=0;const NameAndSignature=__exports.NameAndSignature=class NameAndSignature extends Component{setup(){this.rpc=useService("rpc");this.htmlId=htmlId++;this.defaultName=this.props.signature.name||"";this.currentFont=0;this.drawTimeout=null;this.state=useState({signMode:this.props.mode||(this.props.noInputName&&!this.defaultName?"draw":"auto"),showSignatureArea:!!(this.props.noInputName||this.defaultName),showFontList:false,});this.signNameInputRef=useRef("signNameInput");this.signInputLoad=useRef("signInputLoad");useAutofocus({refName:"signNameInput"});useEffect((el)=>{if(el){el.click();}},()=>[this.signInputLoad.el]);onWillStart(async()=>{this.fonts=await this.rpc(`/web/sign/get_fonts/${this.props.defaultFont}`);});onWillStart(async()=>{await loadJS("/web/static/lib/jSignature/jSignatureCustom.js");await loadJS("/web/static/src/libs/jSignatureCustom.js");});this.signatureRef=useRef("signature");useEffect((el)=>{if(el){this.$signatureField=$(".o_web_sign_signature");this.$signatureField.on("change",()=>{this.props.signature.isSignatureEmpty=this.isSignatureEmpty;});this.jSignature();this.resetSignature();this.props.signature.getSignatureImage=()=>this.jSignature("getData","image");this.props.signature.resetSignature=()=>this.resetSignature();if(this.state.signMode==="auto"){this.drawCurrentName();}}},()=>[this.signatureRef.el]);}
drawCurrentName(){const font=this.fonts[this.currentFont];const text=this.getCleanedName();const canvas=this.signatureRef.el.querySelector("canvas");const img=this.getSVGText(font,text,canvas.width,canvas.height);this.printImage(img);}
focusName(){if(!isMobileOS()&&this.signNameInputRef.el){this.signNameInputRef.el.focus();}}
getCleanedName(){const text=this.props.signature.name;if(this.props.signatureType==="initial"&&text){return(text.split(" ").map(function(w){return w[0];}).join(".")+".");}
return text;}
getSVGText(font,text,width,height){const svg=renderToString("web.sign_svg_text",{width:width,height:height,font:font,text:text,type:this.props.signatureType,color:this.props.fontColor,});return"data:image/svg+xml,"+encodeURI(svg);}
getSVGTextFont(font){const height=100;const width=parseInt(height*this.props.displaySignatureRatio);return this.getSVGText(font,this.getCleanedName(),width,height);}
jSignature(){return this.$signatureField.jSignature(...arguments);}
uploadFile(){this.signInputLoad.el?.click();}
async onChangeSignLoadInput(ev){var file=ev.target.files[0];if(file===undefined){return false;}
if(file.type.substr(0,5)!=="image"){this.jSignature("reset");this.state.loadIsInvalid=true;return false;}
this.state.loadIsInvalid=false;const result=await getDataURLFromFile(file);this.printImage(result);}
onClickSignAutoSelectStyle(){this.state.showFontList=true;}
onClickSignDrawClear(){this.jSignature("reset");}
onClickSignLoad(){this.setMode("load");}
onClickSignAuto(){this.setMode("auto");}
onInputSignName(ev){this.props.signature.name=ev.target.value;if(!this.state.showSignatureArea&&this.getCleanedName()){this.state.showSignatureArea=true;return;}
if(this.state.signMode==="auto"){this.drawCurrentName();}}
onSelectFont(index){this.currentFont=index;this.drawCurrentName();}
printImage(imgSrc){const image=new Image();image.onload=()=>{clearTimeout(this.drawTimeout);this.drawTimeout=setTimeout(()=>{let width=0;let height=0;const ratio=image.width/image.height;const signatureEl=this.signatureRef.el;if(!signatureEl){return;}
const canvas=signatureEl.querySelector("canvas");const context=canvas.getContext("2d");if(image.width/canvas.width>image.height/canvas.height){width=canvas.width;height=parseInt(width/ratio);}else{height=canvas.height;width=parseInt(height*ratio);}
this.jSignature("reset");const ignoredContext=pick(context,"shadowOffsetX","shadowOffsetY");Object.assign(context,{shadowOffsetX:0,shadowOffsetY:0});context.drawImage(image,0,0,image.width,image.height,(canvas.width-width)/2,(canvas.height-height)/2,width,height);Object.assign(context,ignoredContext);this.props.signature.isSignatureEmpty=this.isSignatureEmpty;return this.isSignatureEmpty;},0);};image.src=imgSrc;}
resetSignature(){const{width,height}=this.resizeSignature();this.$signatureField.empty().jSignature({"decor-color":"#D1D0CE","background-color":"rgba(255,255,255,0)","show-stroke":false,color:this.props.fontColor,lineWidth:2,width:width,height:height,});this.emptySignature=this.jSignature("getData");this.setMode(this.state.signMode,true);this.focusName();}
resizeSignature(){this.signatureRef.el.style.width="unset";const width=this.signatureRef.el.clientWidth;const height=parseInt(width/this.props.displaySignatureRatio);this.state.signature={width,height,};Object.assign(this.signatureRef.el.querySelector("canvas").style,{width,height});return{width,height};}
async setMode(mode,reset){if(reset!==true&&mode===this.signMode){return;}
this.state.signMode=mode;this.jSignature(this.state.signMode==="draw"?"enable":"disable");this.jSignature("reset");if(this.state.signMode==="auto"){this.drawCurrentName();}}
get isSignatureEmpty(){const signature=this.jSignature("getData");return signature&&this.emptySignature?this.emptySignature===signature:true;}
get loadIsInvalid(){return this.state.signMode==="load"&&this.state.loadIsInvalid;}
get signatureStyle(){const{signature}=this.state;return signature?`width: ${signature.width}px; height: ${signature.height}px`:"";}}
NameAndSignature.template="web.NameAndSignature";NameAndSignature.components={Dropdown,DropdownItem};NameAndSignature.props={signature:{type:Object},defaultFont:{type:String,optional:true},displaySignatureRatio:{type:Number,optional:true},fontColor:{type:String,optional:true},signatureType:{type:String,optional:true},noInputName:{type:Boolean,optional:true},mode:{type:String,optional:true},};NameAndSignature.defaultProps={defaultFont:"",displaySignatureRatio:3.0,fontColor:"DarkBlue",signatureType:"signature",noInputName:false,};return __exports;});;

/* /web/static/src/core/signature/signature_dialog.js */
odoo.define('@web/core/signature/signature_dialog',['@web/core/l10n/translation','@web/core/dialog/dialog','@web/core/signature/name_and_signature','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{Dialog}=require("@web/core/dialog/dialog");const{NameAndSignature}=require("@web/core/signature/name_and_signature");const{Component,useState}=require("@odoo/owl");const SignatureDialog=__exports.SignatureDialog=class SignatureDialog extends Component{setup(){this.title=_t("Adopt Your Signature");this.signature=useState({name:this.props.defaultName,isSignatureEmpty:true,});}
onClickConfirm(){this.props.uploadSignature({name:this.signature.name,signatureImage:this.signature.getSignatureImage(),});this.props.close();}
get nameAndSignatureProps(){return{...this.props.nameAndSignatureProps,signature:this.signature,};}}
SignatureDialog.template="web.SignatureDialog";SignatureDialog.components={Dialog,NameAndSignature};SignatureDialog.defaultProps={defaultName:"",};return __exports;});;

/* /web/static/src/core/tags_list/tags_list.js */
odoo.define('@web/core/tags_list/tags_list',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const TagsList=__exports.TagsList=class TagsList extends Component{static template="web.TagsList";static defaultProps={displayText:true,};static props={displayText:{type:Boolean,optional:true},itemsVisible:{type:Number,optional:true},tags:{type:Object},};get visibleTagsCount(){return this.props.itemsVisible-1;}
get visibleTags(){if(this.props.itemsVisible&&this.props.tags.length>this.props.itemsVisible){return this.props.tags.slice(0,this.visibleTagsCount);}
return this.props.tags;}
get otherTags(){if(!this.props.itemsVisible||this.props.tags.length<=this.props.itemsVisible){return[];}
return this.props.tags.slice(this.visibleTagsCount);}
get tooltipInfo(){return JSON.stringify({tags:this.otherTags.map((tag)=>({text:tag.text,id:tag.id,})),});}}
return __exports;});;

/* /web/static/src/core/tooltip/tooltip.js */
odoo.define('@web/core/tooltip/tooltip',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const Tooltip=__exports.Tooltip=class Tooltip extends Component{}
Tooltip.template="web.Tooltip";Tooltip.props={close:Function,tooltip:{type:String,optional:true},template:{type:String,optional:true},info:{optional:true},};return __exports;});;

/* /web/static/src/core/tooltip/tooltip_hook.js */
odoo.define('@web/core/tooltip/tooltip_hook',['@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{useEffect,useRef}=require("@odoo/owl");__exports.useTooltip=useTooltip;function useTooltip(refName,params){const tooltip=useService("tooltip");const ref=useRef(refName);useEffect((el)=>tooltip.add(el,params),()=>[ref.el]);}
return __exports;});;

/* /web/static/src/core/tooltip/tooltip_service.js */
odoo.define('@web/core/tooltip/tooltip_service',['@web/core/browser/browser','@web/core/registry','@web/core/tooltip/tooltip','@web/core/browser/feature_detection','@odoo/owl'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{registry}=require("@web/core/registry");const{Tooltip}=require("@web/core/tooltip/tooltip");const{hasTouch}=require("@web/core/browser/feature_detection");const{whenReady}=require("@odoo/owl");const OPEN_DELAY=400;const CLOSE_DELAY=200;const tooltipService=__exports.tooltipService={dependencies:["popover"],start(env,{popover}){let openTooltipTimeout;let closeTooltip;let target=null;let touchPressed;let mouseEntered;const elementsWithTooltips=new Map();function cleanup(){browser.clearTimeout(openTooltipTimeout);if(closeTooltip){closeTooltip();}}
function shouldCleanup(){if(!target){return false;}
if(!document.body.contains(target)){return true;}
if(hasTouch()&&!mouseEntered){return!touchPressed;}
return false;}
function openTooltip(el,{tooltip="",template,info,position,delay=OPEN_DELAY}){target=el;cleanup();if(!tooltip&&!template){return;}
openTooltipTimeout=browser.setTimeout(()=>{if(target.isConnected){closeTooltip=popover.add(target,Tooltip,{tooltip,template,info},{position});target.title="";}},delay);}
function openElementsTooltip(el){if(el.nodeType===Node.TEXT_NODE){return;}
if(elementsWithTooltips.has(el)){openTooltip(el,elementsWithTooltips.get(el));}else if(el.matches("[data-tooltip], [data-tooltip-template]")){const dataset=el.dataset;const params={tooltip:dataset.tooltip,template:dataset.tooltipTemplate,position:dataset.tooltipPosition,};if(dataset.tooltipInfo){params.info=JSON.parse(dataset.tooltipInfo);}
if(dataset.tooltipDelay){params.delay=parseInt(dataset.tooltipDelay,10);}
openTooltip(el,params);}}
function onMouseenter(ev){mouseEntered=true;openElementsTooltip(ev.target);}
function onMouseleave(ev){if(target===ev.target){mouseEntered=false;cleanup();}}
function onTouchStart(ev){touchPressed=true;openElementsTooltip(ev.target);}
whenReady(()=>{browser.setInterval(()=>{if(shouldCleanup()){cleanup();}},CLOSE_DELAY);if(hasTouch()){document.body.addEventListener("touchstart",onTouchStart);document.body.addEventListener("touchend",(ev)=>{if(ev.target.matches("[data-tooltip], [data-tooltip-template]")){if(!ev.target.dataset.tooltipTouchTapToShow){touchPressed=false;}}});document.body.addEventListener("touchcancel",(ev)=>{if(ev.target.matches("[data-tooltip], [data-tooltip-template]")){if(!ev.target.dataset.tooltipTouchTapToShow){touchPressed=false;}}});}
document.body.addEventListener("mouseenter",onMouseenter,{capture:true});document.body.addEventListener("mouseleave",onMouseleave,{capture:true});});return{add(el,params){elementsWithTooltips.set(el,params);return()=>{elementsWithTooltips.delete(el);if(target===el){cleanup();}};},};},};registry.category("services").add("tooltip",tooltipService);return __exports;});;

/* /web/static/src/core/transition.js */
odoo.define('@web/core/transition',['@web/core/browser/browser','@odoo/owl'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{Component,useState,useEffect,xml,onWillUpdateProps,useComponent}=require("@odoo/owl");const config=__exports.config={disabled:false,};__exports.useTransition=useTransition;function useTransition({name,initialVisibility=true,leaveDuration=500,onLeave=()=>{},}){const component=useComponent();const state=useState({shouldMount:initialVisibility,stage:initialVisibility?"enter":"leave",});if(config.disabled){return{get shouldMount(){return state.shouldMount;},set shouldMount(val){state.shouldMount=val;},get className(){return`${name} ${name}-enter-active`;},get stage(){return"enter-active";},};}
let onNextPatch=null;useEffect(()=>{if(onNextPatch){onNextPatch();onNextPatch=null;}});let prevState,timer;const transition={get shouldMount(){return state.shouldMount;},set shouldMount(newState){if(newState===prevState){return;}
browser.clearTimeout(timer);prevState=newState;if(newState){state.stage="enter";state.shouldMount=true;component.render();onNextPatch=()=>{state.stage="enter-active";};}else{state.stage="leave";timer=browser.setTimeout(()=>{state.shouldMount=false;onLeave();},leaveDuration);}},get className(){return`${name} ${name}-${state.stage}`;},get stage(){return state.stage;},};transition.shouldMount=initialVisibility;return transition;}
const Transition=__exports.Transition=class Transition extends Component{setup(){const{visible,leaveDuration,name,onLeave}=this.props;this.transition=useTransition({initialVisibility:visible,leaveDuration,name,onLeave,});onWillUpdateProps(({visible=true})=>{this.transition.shouldMount=visible;});}}
Transition.template=xml`<t t-slot="default" t-if="transition.shouldMount" className="transition.className"/>`;Transition.props={name:String,visible:{type:Boolean,optional:true},leaveDuration:{type:Number,optional:true},onLeave:{type:Function,optional:true},slots:Object,};return __exports;});;

/* /web/static/src/core/tree_editor/condition_tree.js */
odoo.define('@web/core/tree_editor/condition_tree',['@web/core/domain','@web/core/py_js/py','@web/core/py_js/py_utils'],function(require){'use strict';let __exports={};const{Domain}=require("@web/core/domain");const{formatAST,parseExpr}=require("@web/core/py_js/py");const{toPyValue}=require("@web/core/py_js/py_utils");const TERM_OPERATORS_NEGATION=__exports.TERM_OPERATORS_NEGATION={"<":">=",">":"<=","<=":">",">=":"<","=":"!=","!=":"=",in:"not in",like:"not like",ilike:"not ilike","not in":"in","not like":"like","not ilike":"ilike",};const TERM_OPERATORS_NEGATION_EXTENDED={...TERM_OPERATORS_NEGATION,is:"is not","is not":"is","==":"!=","!=":"==",};const EXCHANGE={"<":">","<=":">=",">":"<",">=":"<=","=":"=","!=":"!=",};const COMPARATORS=["<","<=",">",">=","in","not in","==","is","!=","is not"];const Expression=__exports.Expression=class Expression{constructor(ast){if(typeof ast==="string"){ast=parseExpr(ast);}
this._ast=ast;this._expr=formatAST(ast);}
toAST(){return this._ast;}
toString(){return this._expr;}}
__exports.expression=expression;function expression(expr){return new Expression(expr);}
__exports.connector=connector;function connector(value,children=[],negate=false){return{type:"connector",value,children,negate};}
__exports.condition=condition;function condition(path,operator,value,negate=false){return{type:"condition",path,operator,value,negate};}
__exports.complexCondition=complexCondition;function complexCondition(value){parseExpr(value);return{type:"complex_condition",value};}
function cloneValue(value){if(value instanceof Expression){return new Expression(value.toAST());}
if(Array.isArray(value)){return value.map(cloneValue);}
return value;}
__exports.cloneTree=cloneTree;function cloneTree(tree){const clone={};for(const key in tree){clone[key]=cloneValue(tree[key]);}
return clone;}
__exports.formatValue=formatValue;function formatValue(value){return formatAST(toAST(value));}
__exports.normalizeValue=normalizeValue;function normalizeValue(value){return toValue(toAST(value));}
__exports.toValue=toValue;function toValue(ast,isWithinArray=false){if([4,10].includes(ast.type)&&!isWithinArray){return ast.value.map((v)=>toValue(v,true));}else if([0,1,2].includes(ast.type)){return ast.value;}else if(ast.type===6&&ast.op==="-"&&ast.right.type===0){return-ast.right.value;}else if(ast.type===5&&["false","true"].includes(ast.value)){return JSON.parse(ast.value);}else{return new Expression(ast);}}
function toAST(value){if(value instanceof Expression){return value.toAST();}
if(Array.isArray(value)){return{type:4,value:value.map(toAST)};}
return toPyValue(value);}
function addChild(parent,child){if(child.type==="connector"&&!child.negate&&child.value===parent.value){parent.children.push(...child.children);}else{parent.children.push(child);}}
function getNormalizedCondition(condition){let{operator,negate}=condition;if(negate&&typeof operator==="string"&&TERM_OPERATORS_NEGATION[operator]){operator=TERM_OPERATORS_NEGATION[operator];negate=false;}
return{...condition,operator,negate};}
function normalizeCondition(condition){Object.assign(condition,getNormalizedCondition(condition));}
function _construcTree(ASTs,distributeNot,negate=false){const[firstAST,...tailASTs]=ASTs;if(firstAST.type===1&&firstAST.value==="!"){return _construcTree(tailASTs,distributeNot,!negate);}
const tree={type:firstAST.type===1?"connector":"condition"};if(tree.type==="connector"){tree.value=firstAST.value;if(distributeNot&&negate){tree.value=tree.value==="&"?"|":"&";tree.negate=false;}else{tree.negate=negate;}
tree.children=[];}else{const[pathAST,operatorAST,valueAST]=firstAST.value;tree.path=toValue(pathAST);tree.negate=negate;tree.operator=toValue(operatorAST);tree.value=toValue(valueAST);normalizeCondition(tree);}
let remaimingASTs=tailASTs;if(tree.type==="connector"){for(let i=0;i<2;i++){const{tree:child,remaimingASTs:otherASTs}=_construcTree(remaimingASTs,distributeNot,distributeNot&&negate);remaimingASTs=otherASTs;addChild(tree,child);}}
return{tree,remaimingASTs};}
function construcTree(initialASTs,options){if(!initialASTs.length){return connector("&");}
const{tree}=_construcTree(initialASTs,options.distributeNot);return tree;}
function getASTs(tree){const ASTs=[];if(tree.type==="condition"){if(tree.negate){ASTs.push(toAST("!"));}
ASTs.push({type:10,value:[tree.path,tree.operator,tree.value].map(toAST),});return ASTs;}
const length=tree.children.length;if(length&&tree.negate){ASTs.push(toAST("!"));}
for(let i=0;i<length-1;i++){ASTs.push(toAST(tree.value));}
for(const child of tree.children){ASTs.push(...getASTs(child));}
return ASTs;}
function not(ast){if(isNot(ast)){return ast.right;}
if(ast.type===2){return{...ast,value:!ast.value};}
if(ast.type===7&&COMPARATORS.includes(ast.op)){return{...ast,op:TERM_OPERATORS_NEGATION_EXTENDED[ast.op]};}
return{type:6,op:"not",right:isBool(ast)?ast.args[0]:ast};}
function bool(ast){if(isBool(ast)||isNot(ast)||ast.type===2){return ast;}
return{type:8,fn:{type:5,value:"bool"},args:[ast],kwargs:{}};}
function name(value){return{type:5,value};}
function or(left,right){return{type:14,op:"or",left,right};}
function and(left,right){return{type:14,op:"and",left,right};}
function isNot(ast){return ast.type===6&&ast.op==="not";}
function is(oneParamFunc,ast){return(ast.type===8&&ast.fn.type===5&&ast.fn.value===oneParamFunc&&ast.args.length===1);}
function isSet(ast){return ast.type===8&&ast.fn.type===5&&ast.fn.value==="set"&&ast.args.length<=1;}
function isBool(ast){return is("bool",ast);}
function isValidPath(ast,options){const getFieldDef=options.getFieldDef||(()=>null);if(ast.type===5){return getFieldDef(ast.value)!==null;}
return false;}
function isX2Many(ast,options){if(isValidPath(ast,options)){const fieldDef=options.getFieldDef(ast.value);return["many2many","one2many"].includes(fieldDef.type);}
return false;}
function _getConditionFromComparator(ast,options){if(["is","is not"].includes(ast.op)){return null;}
let operator=ast.op;if(operator==="=="){operator="=";}
let left=ast.left;let right=ast.right;if(isValidPath(left,options)==isValidPath(right,options)){return null;}
if(!isValidPath(left,options)){if(operator in EXCHANGE){const temp=left;left=right;right=temp;operator=EXCHANGE[operator];}else{return null;}}
return condition(left.value,operator,toValue(right));}
function isValidPath2(ast,options){if(!ast){return null;}
if([4,10].includes(ast.type)&&ast.value.length===1){return isValidPath(ast.value[0],options);}
return isValidPath(ast,options);}
function _getConditionFromIntersection(ast,options,negate=false){let left=ast.fn.obj.args[0];let right=ast.args[0];if(!left){return condition(negate?1:0,"=",1);}
if(isValidPath2(left,options)==isValidPath2(right,options)){return null;}
if(!isValidPath2(left,options)){const temp=left;left=right;right=temp;}
if([4,10].includes(left.type)&&left.value.length===1){left=left.value[0];}
if(!right){return condition(left.value,negate?"=":"!=",false);}
if(isSet(right)){if(!right.args[0]){right={type:4,value:[]};}
if([4,10].includes(right.args[0].type)){right=right.args[0];}}
if(![4,10].includes(right.type)){return null;}
return condition(left.value,negate?"not in":"in",toValue(right));}
function _leafFromAST(ast,options,negate=false){if(isNot(ast)){return _treeFromAST(ast.right,options,!negate);}
if(ast.type===5&&isValidPath(ast,options)){return condition(ast.value,negate?"=":"!=",false);}
const astValue=toValue(ast);if(["boolean","number","string"].includes(typeof astValue)){return condition(astValue?1:0,"=",1);}
if(ast.type===8&&ast.fn.type===15&&isSet(ast.fn.obj)&&ast.fn.key==="intersection"){const tree=_getConditionFromIntersection(ast,options,negate);if(tree){return tree;}}
if(ast.type===7&&COMPARATORS.includes(ast.op)){if(negate){return _leafFromAST(not(ast),options);}
const tree=_getConditionFromComparator(ast,options);if(tree){return tree;}}
return complexCondition(formatAST(negate?not(ast):ast));}
function _treeFromAST(ast,options,negate=false){if(isNot(ast)){return _treeFromAST(ast.right,options,!negate);}
if(ast.type===14){const tree=connector(ast.op==="and"?"&":"|");if(options.distributeNot&&negate){tree.value=tree.value==="&"?"|":"&";}else{tree.negate=negate;}
const subASTs=[ast.left,ast.right];for(const subAST of subASTs){const child=_treeFromAST(subAST,options,options.distributeNot&&negate);addChild(tree,child);}
return tree;}
if(ast.type===13){const newAST=or(and(ast.condition,ast.ifTrue),and(not(ast.condition),ast.ifFalse));return _treeFromAST(newAST,options,negate);}
return _leafFromAST(ast,options,negate);}
function _expressionFromTree(tree,options,isRoot=false){if(tree.type==="connector"&&tree.value==="|"&&tree.children.length===2){const isSimpleAnd=(tree)=>tree.type==="connector"&&tree.value==="&"&&tree.children.length===2;if(tree.children.every((c)=>isSimpleAnd(c))){const[c1,c2]=tree.children;for(let i=0;i<2;i++){const c1Child=c1.children[i];const str1=_expressionFromTree({...c1Child},options);for(let j=0;j<2;j++){const c2Child=c2.children[j];const str2=_expressionFromTree(c2Child,options);if(str1===`not ${str2}`||`not ${str1}`===str2){const others=[c1.children[1-i],c2.children[1-j]];const str=_expressionFromTree(c1Child,options);const strs=others.map((c)=>_expressionFromTree(c,options));return`${strs[0]} if ${str} else ${strs[1]}`;}}}}}
if(tree.type==="connector"){const connector=tree.value==="&"?"and":"or";const subExpressions=tree.children.map((c)=>_expressionFromTree(c,options));if(!subExpressions.length){return connector==="and"?"1":"0";}
let expression=subExpressions.join(` ${connector} `);if(!isRoot||tree.negate){expression=`( ${expression} )`;}
if(tree.negate){expression=`not ${expression}`;}
return expression;}
if(tree.type==="complex_condition"){return tree.value;}
tree=getNormalizedCondition(tree);const{path,operator,value}=tree;const op=operator==="="?"==":operator;if(typeof op!=="string"||!COMPARATORS.includes(op)){throw new Error("Invalid operator");}
if([0,1].includes(path)){if(operator!=="="||value!==1){return new Error("Invalid condition");}
return formatAST({type:2,value:Boolean(path)});}
const pathAST=toAST(path);if(typeof path=="string"&&isValidPath(name(path),options)){pathAST.type=5;}
if(value===false&&["=","!="].includes(operator)){return formatAST(operator==="="?not(pathAST):pathAST);}
let valueAST=toAST(value);if(["in","not in"].includes(operator)&&!(value instanceof Expression)&&![4,10].includes(valueAST.type)){valueAST={type:4,value:[valueAST]};}
if(pathAST.type===5&&isX2Many(pathAST,options)&&["in","not in"].includes(operator)){const ast={type:8,fn:{type:15,obj:{args:[pathAST],type:8,fn:{type:5,value:"set",},},key:"intersection",},args:[valueAST],};return formatAST(operator==="not in"?not(ast):ast);}
return formatAST({type:7,op,left:pathAST,right:valueAST,});}
function createBetweenOperators(tree){if(["condition","complex_condition"].includes(tree.type)){return tree;}
const processedChildren=tree.children.map(createBetweenOperators);if(tree.value==="|"){return{...tree,children:processedChildren};}
const children=[];for(let i=0;i<processedChildren.length;i++){const child1=processedChildren[i];const child2=processedChildren[i+1];if(child1.type==="condition"&&child2&&child2.type==="condition"&&formatValue(child1.path)===formatValue(child2.path)&&child1.operator===">="&&child2.operator==="<="){children.push(condition(child1.path,"between",normalizeValue([child1.value,child2.value])));i+=1;}else{children.push(child1);}}
if(children.length===1){return{...children[0]};}
return{...tree,children};}
__exports.removeBetweenOperators=removeBetweenOperators;function removeBetweenOperators(tree){if(tree.type==="complex_condition"){return tree;}
if(tree.type==="condition"){if(tree.operator!=="between"){return tree;}
const{negate,path,value}=tree;return connector("&",[condition(path,">=",value[0]),condition(path,"<=",value[1])],negate);}
const processedChildren=tree.children.map(removeBetweenOperators);if(tree.value==="|"){return{...tree,children:processedChildren};}
const newTree={...tree,children:[]};for(let i=0;i<processedChildren.length;i++){addChild(newTree,processedChildren[i]);}
return newTree;}
__exports.createVirtualOperators=createVirtualOperators;function createVirtualOperators(tree,options={}){if(tree.type==="condition"){const{path,operator,value}=tree;if(["=","!="].includes(operator)){const fieldDef=options.getFieldDef?.(path)||null;if(fieldDef){if(fieldDef.type==="boolean"){return{...tree,operator:operator==="="?"is":"is_not"};}else if(!["many2one","date","datetime"].includes(fieldDef?.type)&&value===false){return{...tree,operator:operator==="="?"not_set":"set"};}}}
return tree;}
if(tree.type==="complex_condition"){return tree;}
const processedChildren=tree.children.map((c)=>createVirtualOperators(c,options));return{...tree,children:processedChildren};}
__exports.removeVirtualOperators=removeVirtualOperators;function removeVirtualOperators(tree){if(tree.type==="condition"){const{operator}=tree;if(["is","is_not"].includes(operator)){return{...tree,operator:operator==="is"?"=":"!="};}
if(["set","not_set"].includes(operator)){return{...tree,operator:operator==="set"?"!=":"="};}
return tree;}
if(tree.type==="complex_condition"){return tree;}
const processedChildren=tree.children.map((c)=>removeVirtualOperators(c));return{...tree,children:processedChildren};}
function createComplexConditions(tree){if(tree.type==="condition"){if(tree.path instanceof Expression&&tree.operator==="="&&tree.value===1){return complexCondition(String(tree.path));}
return cloneTree(tree);}
if(tree.type==="complex_condition"){return cloneTree(tree);}
return{...tree,children:tree.children.map((child)=>createComplexConditions(child)),};}
function removeComplexConditions(tree){if(tree.type==="condition"){return cloneTree(tree);}
if(tree.type==="complex_condition"){const ast=parseExpr(tree.value);return condition(new Expression(bool(ast)),"=",1);}
return{...tree,children:tree.children.map((child)=>removeComplexConditions(child)),};}
__exports.treeFromExpression=treeFromExpression;function treeFromExpression(expression,options={}){const ast=parseExpr(expression);const tree=_treeFromAST(ast,options);return createVirtualOperators(createBetweenOperators(tree),options);}
__exports.expressionFromTree=expressionFromTree;function expressionFromTree(tree,options={}){const simplifiedTree=createComplexConditions(removeBetweenOperators(removeVirtualOperators(tree)));return _expressionFromTree(simplifiedTree,options,true);}
__exports.domainFromTree=domainFromTree;function domainFromTree(tree){const simplifiedTree=removeBetweenOperators(removeVirtualOperators(removeComplexConditions(tree)));const domainAST={type:4,value:getASTs(simplifiedTree),};return formatAST(domainAST);}
__exports.treeFromDomain=treeFromDomain;function treeFromDomain(domain,options={}){domain=new Domain(domain);const domainAST=domain.ast;const tree=construcTree(domainAST.value,options);return createVirtualOperators(createBetweenOperators(tree),options);}
__exports.expressionFromDomain=expressionFromDomain;function expressionFromDomain(domain,options={}){const tree=treeFromDomain(domain,options);return expressionFromTree(tree,options);}
__exports.domainFromExpression=domainFromExpression;function domainFromExpression(expression,options={}){const tree=treeFromExpression(expression,options);return domainFromTree(tree);}
return __exports;});;

/* /web/static/src/core/tree_editor/tree_editor.js */
odoo.define('@web/core/tree_editor/tree_editor',['@web/core/tree_editor/utils','@odoo/owl','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/tree_editor/condition_tree','@web/core/tree_editor/tree_editor_value_editors','@web/core/model_field_selector/model_field_selector','@web/core/model_field_selector/utils','@web/core/utils/objects'],function(require){'use strict';let __exports={};const{leafToString,useLoadDisplayNames,extractIdsFromTree,getPathsInTree,getResModel,}=require("@web/core/tree_editor/utils");const{Component,onWillStart,onWillUpdateProps}=require("@odoo/owl");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{condition,cloneTree,formatValue,removeVirtualOperators,connector,}=require("@web/core/tree_editor/condition_tree");const{getDefaultValue,getValueEditorInfo,}=require("@web/core/tree_editor/tree_editor_value_editors");const{ModelFieldSelector}=require("@web/core/model_field_selector/model_field_selector");const{useLoadFieldInfo}=require("@web/core/model_field_selector/utils");const{deepEqual,shallowEqual}=require("@web/core/utils/objects");const TRUE_TREE=condition(1,"=",1);const DEFAULT_CONDITION=condition("id","=",1);function collectDifferences(tree,otherTree){if(tree.type!==otherTree.type){return[{type:"other"}];}
if(tree.negate!==otherTree.negate){return[{type:"other"}];}
if(tree.type==="condition"){if(formatValue(tree.path)!==formatValue(otherTree.path)){return[{type:"other"}];}
if(formatValue(tree.value)!==formatValue(otherTree.value)){return[{type:"other"}];}
if(formatValue(tree.operator)!==formatValue(otherTree.operator)){if(tree.operator==="!="&&otherTree.operator==="set"){return[{type:"replacement",tree,operator:"set"}];}else if(tree.operator==="="&&otherTree.operator==="not_set"){return[{type:"replacement",tree,operator:"not_set"}];}else{return[{type:"other"}];}}
return[];}
if(tree.value!==otherTree.value){return[{type:"other"}];}
if(tree.type==="complex_condition"){return[];}
if(tree.children.length!==otherTree.children.length){return[{type:"other"}];}
const diffs=[];for(let i=0;i<tree.children.length;i++){const child=tree.children[i];const otherChild=otherTree.children[i];const childDiffs=collectDifferences(child,otherChild);if(childDiffs.some((d)=>d.type!=="replacement")){return[{type:"other"}];}
diffs.push(...childDiffs);}
return diffs;}
function restoreVirtualOperators(tree,otherTree){const diffs=collectDifferences(tree,otherTree);if(diffs.some((d)=>d.type!=="replacement")){return;}
for(const{tree,operator}of diffs){tree.operator=operator;}}
const TreeEditor=__exports.TreeEditor=class TreeEditor extends Component{static template="web.TreeEditor";static components={Dropdown,DropdownItem,ModelFieldSelector,};static props={tree:Object,resModel:String,update:Function,getPathEditorInfo:Function,getOperatorEditorInfo:Function,getDefaultOperator:Function,readonly:{type:Boolean,optional:true},slots:{type:Object,optional:true},isDebugMode:{type:Boolean,optional:true},defaultConnector:{type:[{value:"&"},{value:"|"}],optional:true},defaultCondition:{type:Object,optional:true},};static defaultProps={defaultConnector:"&",defaultCondition:DEFAULT_CONDITION,readonly:false,};setup(){this.loadFieldInfo=useLoadFieldInfo();this.loadDisplayNames=useLoadDisplayNames();onWillStart(()=>this.onPropsUpdated(this.props));onWillUpdateProps((nextProps)=>this.onPropsUpdated(nextProps));}
async onPropsUpdated(props){this.tree=cloneTree(props.tree);if(shallowEqual(this.tree,TRUE_TREE)){this.tree=connector(props.defaultConnector);}else if(this.tree.type!=="connector"){this.tree=connector(props.defaultConnector,[this.tree]);}
if(this.previousTree){restoreVirtualOperators(this.tree,this.previousTree);this.previousTree=null;}
const paths=getPathsInTree(this.tree);await this.loadFieldDefs(props.resModel,paths);if(props.readonly){const idsByModel=extractIdsFromTree(this.tree,this.getFieldDef.bind(this));this.displayNames=await this.loadDisplayNames(idsByModel);}}
get className(){return`${this.props.readonly ? "o_read_mode" : "o_edit_mode"}`;}
get isDebugMode(){return this.props.isDebugMode!==undefined?this.props.isDebugMode:!!this.env.debug;}
getFieldDef(path){if(typeof path==="string"){return this.fieldDefs[path];}
return null;}
async loadFieldDefs(resModel,paths){const promises=[];const fieldDefs={};for(const path of paths){if(typeof path==="string"){promises.push(this.loadFieldInfo(resModel,path).then(({fieldDef})=>{fieldDefs[path]=fieldDef;}));}}
await Promise.all(promises);this.fieldDefs=fieldDefs;}
notifyChanges(){this.previousTree=cloneTree(this.tree);this.props.update(this.tree);}
updateConnector(node,value){node.value=value;node.negate=false;this.notifyChanges();}
updateComplexCondition(node,value){node.value=value;this.notifyChanges();}
createNewLeaf(){return cloneTree(this.props.defaultCondition);}
createNewBranch(value){return connector(value,[this.createNewLeaf(),this.createNewLeaf()]);}
insertRootLeaf(parent){parent.children.push(this.createNewLeaf());this.notifyChanges();}
insertLeaf(parent,node){const newNode=node.type!=="connector"?cloneTree(node):this.createNewLeaf();const index=parent.children.indexOf(node);parent.children.splice(index+1,0,newNode);this.notifyChanges();}
insertBranch(parent,node){const nextConnector=parent.value==="&"?"|":"&";const newNode=this.createNewBranch(nextConnector);const index=parent.children.indexOf(node);parent.children.splice(index+1,0,newNode);this.notifyChanges();}
delete(parent,node){const index=parent.children.indexOf(node);parent.children.splice(index,1);this.notifyChanges();}
getDescription(node){const fieldDef=this.getFieldDef(node.path);return leafToString(node,fieldDef,this.displayNames[getResModel(fieldDef)]);}
getValueEditorInfo(node){const fieldDef=this.getFieldDef(node.path);return getValueEditorInfo(fieldDef,node.operator);}
async updatePath(node,path){const{fieldDef}=await this.loadFieldInfo(this.props.resModel,path);node.path=path;node.negate=false;node.operator=this.props.getDefaultOperator(fieldDef);node.value=getDefaultValue(fieldDef,node.operator);this.notifyChanges();}
updateLeafOperator(node,operator,negate){const previousNode=cloneTree(node);const fieldDef=this.getFieldDef(node.path);node.negate=negate;node.operator=operator;node.value=getDefaultValue(fieldDef,operator,node.value);if(deepEqual(removeVirtualOperators(node),removeVirtualOperators(previousNode))){this.render();}
this.notifyChanges();}
updateLeafValue(node,value){node.value=value;this.notifyChanges();}
highlightNode(target){const nodeEl=target.closest(".o_tree_editor_node");nodeEl.classList.toggle("o_hovered_button");}}
return __exports;});;

/* /web/static/src/core/tree_editor/tree_editor_autocomplete.js */
odoo.define('@web/core/tree_editor/tree_editor_autocomplete',['@web/core/record_selectors/multi_record_selector','@web/core/l10n/translation','@web/core/py_js/py_utils','@web/core/tree_editor/condition_tree','@web/core/record_selectors/record_selector'],function(require){'use strict';let __exports={};const{MultiRecordSelector}=require("@web/core/record_selectors/multi_record_selector");const{_t}=require("@web/core/l10n/translation");const{formatAST,toPyValue}=require("@web/core/py_js/py_utils");const{Expression}=require("@web/core/tree_editor/condition_tree");const{RecordSelector}=require("@web/core/record_selectors/record_selector");const isId=__exports.isId=(val)=>Number.isInteger(val)&&val>=1;const getFormat=__exports.getFormat=(val,displayNames)=>{let text;let colorIndex;if(isId(val)){text=typeof displayNames[val]==="string"?displayNames[val]:_t("Inaccessible/missing record ID: %s",val);colorIndex=typeof displayNames[val]==="string"?0:2;}else{text=val instanceof Expression?String(val):_t("Invalid record ID: %s",formatAST(toPyValue(val)));colorIndex=val instanceof Expression?2:1;}
return{text,colorIndex};};const DomainSelectorAutocomplete=__exports.DomainSelectorAutocomplete=class DomainSelectorAutocomplete extends MultiRecordSelector{static props={...MultiRecordSelector.props,resIds:true,};getIds(props=this.props){return props.resIds.filter((val)=>isId(val));}
getTags(props,displayNames){return props.resIds.map((val,index)=>{const{text,colorIndex}=getFormat(val,displayNames);return{text,colorIndex,onDelete:()=>{this.props.update([...this.props.resIds.slice(0,index),...this.props.resIds.slice(index+1),]);},};});}}
const DomainSelectorSingleAutocomplete=__exports.DomainSelectorSingleAutocomplete=class DomainSelectorSingleAutocomplete extends RecordSelector{static props={...RecordSelector.props,resId:true,};getDisplayName(props=this.props,displayNames){const{resId}=props;if(resId===false){return"";}
const{text}=getFormat(resId,displayNames);return text;}
getIds(props=this.props){if(isId(props.resId)){return[props.resId];}
return[];}}
return __exports;});;

/* /web/static/src/core/tree_editor/tree_editor_components.js */
odoo.define('@web/core/tree_editor/tree_editor_components',['@odoo/owl','@web/core/tags_list/tags_list'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{TagsList}=require("@web/core/tags_list/tags_list");const Input=__exports.Input=class Input extends Component{static props=["value","update","startEmpty?"];static template="web.TreeEditor.Input";}
const Select=__exports.Select=class Select extends Component{static props=["value","update","options","addBlankOption?"];static template="web.TreeEditor.Select";deserialize(value){return JSON.parse(value);}
serialize(value){return JSON.stringify(value);}}
const Range=__exports.Range=class Range extends Component{static props=["value","update","editorInfo"];static template="web.TreeEditor.Range";update(index,newValue){const result=[...this.props.value];result[index]=newValue;return this.props.update(result);}}
const List=__exports.List=class List extends Component{static components={TagsList};static props=["value","update","editorInfo"];static template="web.TreeEditor.List";get tags(){const{isSupported,stringify}=this.props.editorInfo;return this.props.value.map((val,index)=>({text:stringify(val),colorIndex:isSupported(val)?0:2,onDelete:()=>{this.props.update([...this.props.value.slice(0,index),...this.props.value.slice(index+1),]);},}));}
update(newValue){return this.props.update([...this.props.value,newValue]);}}
return __exports;});;

/* /web/static/src/core/tree_editor/tree_editor_operator_editor.js */
odoo.define('@web/core/tree_editor/tree_editor_operator_editor',['@web/core/l10n/translation','@web/core/tree_editor/condition_tree','@web/core/utils/strings','@web/core/py_js/py','@web/core/tree_editor/tree_editor_components'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{formatValue,TERM_OPERATORS_NEGATION,toValue,}=require("@web/core/tree_editor/condition_tree");const{sprintf}=require("@web/core/utils/strings");const{parseExpr}=require("@web/core/py_js/py");const{Select}=require("@web/core/tree_editor/tree_editor_components");const OPERATOR_DESCRIPTIONS={"=":"=","!=":"!=","<=":"<=","<":"<",">":">",">=":">=","=?":"=?","=like":_t("=like"),"=ilike":_t("=ilike"),like:_t("like"),"not like":_t("not like"),ilike:_t("contains"),"not ilike":_t("does not contain"),in:_t("is in"),"not in":_t("is not in"),child_of:_t("child of"),parent_of:_t("parent of"),is:_t("is"),is_not:_t("is not"),set:_t("is set"),not_set:_t("is not set"),between:_t("is between"),};function toKey(operator,negate=false){if(!negate&&typeof operator==="string"&&operator in OPERATOR_DESCRIPTIONS){return operator;}
return JSON.stringify([formatValue(operator),negate]);}
function toOperator(key){if(!key.includes("[")){return[key,false];}
const[expr,negate]=JSON.parse(key);return[toValue(parseExpr(expr)),negate];}
__exports.getOperatorLabel=getOperatorLabel;function getOperatorLabel(operator,negate=false){let label;if(typeof operator==="string"&&operator in OPERATOR_DESCRIPTIONS){if(negate&&operator in TERM_OPERATORS_NEGATION){return OPERATOR_DESCRIPTIONS[TERM_OPERATORS_NEGATION[operator]];}
label=OPERATOR_DESCRIPTIONS[operator];}else{label=formatValue(operator);}
if(negate){return sprintf(`not %s`,label);}
return label;}
function getOperatorInfo(operator,negate=false){const key=toKey(operator,negate);const label=getOperatorLabel(operator,negate);return[key,label];}
__exports.getOperatorEditorInfo=getOperatorEditorInfo;function getOperatorEditorInfo(operators){const defaultOperator=operators[0];const operatorsInfo=operators.map((operator)=>getOperatorInfo(operator));return{component:Select,extractProps:({update,value:[operator,negate]})=>{const[operatorKey,operatorLabel]=getOperatorInfo(operator,negate);const options=[...operatorsInfo];if(!options.some(([key])=>key===operatorKey)){options.push([operatorKey,operatorLabel]);}
return{value:operatorKey,update:(operatorKey)=>update(...toOperator(operatorKey)),options,};},defaultValue:()=>defaultOperator,isSupported:([operator])=>typeof operator==="string"&&operator in OPERATOR_DESCRIPTIONS,message:_t("Operator not supported"),stringify:([operator,negate])=>getOperatorLabel(operator,negate),};}
return __exports;});;

/* /web/static/src/core/tree_editor/tree_editor_value_editors.js */
odoo.define('@web/core/tree_editor/tree_editor_value_editors',['@web/core/l10n/dates','@web/core/l10n/translation','@web/core/registry','@web/core/datetime/datetime_input','@web/core/tree_editor/tree_editor_autocomplete','@web/core/utils/arrays','@web/core/tree_editor/tree_editor_components','@web/core/tree_editor/condition_tree','@web/core/tree_editor/utils'],function(require){'use strict';let __exports={};const{deserializeDate,deserializeDateTime,serializeDate,serializeDateTime,}=require("@web/core/l10n/dates");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{DateTimeInput}=require("@web/core/datetime/datetime_input");const{DomainSelectorAutocomplete,DomainSelectorSingleAutocomplete,}=require("@web/core/tree_editor/tree_editor_autocomplete");const{unique}=require("@web/core/utils/arrays");const{Input,Select,List,Range}=require("@web/core/tree_editor/tree_editor_components");const{formatValue}=require("@web/core/tree_editor/condition_tree");const{getResModel,disambiguate,isId}=require("@web/core/tree_editor/utils");const{DateTime}=luxon;const formatters=registry.category("formatters");const parsers=registry.category("parsers");function parseValue(fieldType,value){const parser=parsers.get(fieldType,(value)=>value);try{return parser(value);}catch{return value;}}
function isParsable(fieldType,value){const parser=parsers.get(fieldType,(value)=>value);try{parser(value);}catch{return false;}
return true;}
function genericSerializeDate(type,value){return type==="date"?serializeDate(value):serializeDateTime(value);}
function genericDeserializeDate(type,value){return type==="date"?deserializeDate(value):deserializeDateTime(value);}
const STRING_EDITOR={component:Input,extractProps:({value,update})=>({value,update}),isSupported:(value)=>typeof value==="string",defaultValue:()=>"",};function makeSelectEditor(options,params={}){const getOption=(value)=>options.find(([v])=>v===value)||null;return{component:Select,extractProps:({value,update})=>({value,update,options,addBlankOption:params.addBlankOption,}),isSupported:(value)=>Boolean(getOption(value)),defaultValue:()=>options[0]?.[0]??false,stringify:(value,disambiguate)=>{const option=getOption(value);return option?option[1]:disambiguate?formatValue(value):String(value);},message:_t("Value not in selection"),};}
function makeAutoCompleteEditor(fieldDef){return{component:DomainSelectorAutocomplete,extractProps:({value,update})=>{return{resModel:getResModel(fieldDef),fieldString:fieldDef.string,update:(value)=>update(unique(value)),resIds:unique(value),};},isSupported:(value)=>Array.isArray(value),defaultValue:()=>[],};}
function getPartialValueEditorInfo(fieldDef,operator,params={}){switch(operator){case"set":case"not_set":return{component:null,extractProps:null,isSupported:(value)=>value===false,defaultValue:()=>false,};case"=like":case"=ilike":case"like":case"not like":case"ilike":case"not ilike":return STRING_EDITOR;case"between":{const editorInfo=getValueEditorInfo(fieldDef,"=");return{component:Range,extractProps:({value,update})=>({value,update,editorInfo,}),isSupported:(value)=>Array.isArray(value)&&value.length===2,defaultValue:()=>{const{defaultValue}=editorInfo;return[defaultValue(),defaultValue()];},};}
case"in":case"not in":{switch(fieldDef.type){case"tags":return STRING_EDITOR;case"many2one":case"many2many":case"one2many":return makeAutoCompleteEditor(fieldDef);default:{const editorInfo=getValueEditorInfo(fieldDef,"=",{addBlankOption:true,startEmpty:true,});return{component:List,extractProps:({value,update})=>{if(!disambiguate(value)){const{stringify}=editorInfo;editorInfo.stringify=(val)=>stringify(val,false);}
return{value,update,editorInfo,};},isSupported:(value)=>Array.isArray(value),defaultValue:()=>[],};}}}}
const{type}=fieldDef;switch(type){case"integer":case"float":case"monetary":{const formatType=type==="integer"?"integer":"float";return{component:Input,extractProps:({value,update})=>({value:String(value),update:(value)=>update(parseValue(formatType,value)),startEmpty:params.startEmpty,}),isSupported:()=>true,defaultValue:()=>1,shouldResetValue:(value)=>parseValue(formatType,value)===value,};}
case"date":case"datetime":return{component:DateTimeInput,extractProps:({value,update})=>({value:params.startEmpty||value===false?false:genericDeserializeDate(type,value),type,onApply:(value)=>{if(!params.startEmpty||value){update(genericSerializeDate(type,value||DateTime.local()));}},}),isSupported:(value)=>value===false||(typeof value==="string"&&isParsable(type,value)),defaultValue:()=>genericSerializeDate(type,DateTime.local()),stringify:(value)=>{if(value===false){return _t("False");}
if(typeof value==="string"&&isParsable(type,value)){const formatter=formatters.get(type,formatValue);return formatter(genericDeserializeDate(type,value));}
return formatValue(value);},message:_t("Not a valid %s",type),};case"char":case"html":case"text":return STRING_EDITOR;case"boolean":{if(["is","is_not"].includes(operator)){const options=[[true,_t("set")],[false,_t("not set")],];return makeSelectEditor(options,params);}
const options=[[true,_t("True")],[false,_t("False")],];return makeSelectEditor(options,params);}
case"many2one":{if(["=","!=","parent_of","child_of"].includes(operator)){return{component:DomainSelectorSingleAutocomplete,extractProps:({value,update})=>{return{resModel:getResModel(fieldDef),fieldString:fieldDef.string,update,resId:value,};},isSupported:()=>true,defaultValue:()=>false,shouldResetValue:(value)=>value!==false&&!isId(value),};}
break;}
case"many2many":case"one2many":if(["=","!="].includes(operator)){return makeAutoCompleteEditor(fieldDef);}
break;case"selection":{const options=fieldDef.selection||[];return makeSelectEditor(options,params);}
case undefined:{const options=[[1,"1"]];return makeSelectEditor(options,params);}}
return{component:Input,extractProps:({value,update})=>({value:String(value),update,}),isSupported:()=>true,defaultValue:()=>"",};}
__exports.getValueEditorInfo=getValueEditorInfo;function getValueEditorInfo(fieldDef,operator,options={}){const info=getPartialValueEditorInfo(fieldDef||{},operator,options);return{extractProps:({value,update})=>({value,update}),message:_t("Value not supported"),stringify:(val,disambiguate=true)=>{if(disambiguate){return formatValue(val);}
return String(val);},...info,};}
__exports.getDefaultValue=getDefaultValue;function getDefaultValue(fieldDef,operator,value=null){const{isSupported,shouldResetValue,defaultValue}=getValueEditorInfo(fieldDef,operator);if(value===null||!isSupported(value)||shouldResetValue?.(value)){return defaultValue();}
return value;}
return __exports;});;

/* /web/static/src/core/tree_editor/utils.js */
odoo.define('@web/core/tree_editor/utils',['@web/core/utils/arrays','@web/core/tree_editor/tree_editor_operator_editor','@web/core/tree_editor/condition_tree','@web/core/utils/hooks','@web/core/l10n/translation','@web/core/l10n/dates'],function(require){'use strict';let __exports={};const{unique,zip}=require("@web/core/utils/arrays");const{getOperatorLabel}=require("@web/core/tree_editor/tree_editor_operator_editor");const{Expression}=require("@web/core/tree_editor/condition_tree");const{useService}=require("@web/core/utils/hooks");const{_t}=require("@web/core/l10n/translation");const{deserializeDate,deserializeDateTime,formatDate,formatDateTime}=require("@web/core/l10n/dates");function formatValue(val,disambiguate,fieldDef,displayNames){if(val instanceof Expression){return val.toString();}
if(displayNames&&isId(val)){if(typeof displayNames[val]==="string"){val=displayNames[val];}else{return _t("Inaccessible/missing record ID: %s",val);}}
if(fieldDef?.type==="selection"){const[,label]=(fieldDef.selection||[]).find(([v])=>v===val)||[];if(label!==undefined){val=label;}}
if(typeof val==="string"){if(fieldDef?.type==="datetime"){return formatDateTime(deserializeDateTime(val));}
if(fieldDef?.type==="date"){return formatDate(deserializeDate(val));}}
if(disambiguate&&typeof val==="string"){return JSON.stringify(val);}
return val;}
__exports.isId=isId;function isId(value){return Number.isInteger(value)&&value>=1;}
__exports.disambiguate=disambiguate;function disambiguate(value,displayNames){if(!Array.isArray(value)){return value==="";}
let hasSomeString=false;let hasSomethingElse=false;for(const val of value){if(val===""){return true;}
if(typeof val==="string"||(displayNames&&isId(val))){hasSomeString=true;}else{hasSomethingElse=true;}}
return hasSomeString&&hasSomethingElse;}
__exports.leafToString=leafToString;function leafToString(tree,fieldDef,displayNames){const{operator,negate,value}=tree;const operatorLabel=getOperatorLabel(operator,negate);const description={operatorDescription:`${operatorLabel}`,valueDescription:null,};if(["set","not_set"].includes(operator)){return description;}
if(["is","is_not"].includes(operator)){description.valueDescription={values:[value?_t("set"):_t("not set")],join:"",addParenthesis:false,};return description;}
const dis=disambiguate(value,displayNames);const values=(Array.isArray(value)?value:[value]).map((val)=>formatValue(val,dis,fieldDef,displayNames));let join;let addParenthesis=Array.isArray(value);switch(operator){case"between":join=_t("and");addParenthesis=false;break;case"in":case"not in":join=",";break;default:join=_t("or");}
description.valueDescription={values,join,addParenthesis};return description;}
__exports.useLoadDisplayNames=useLoadDisplayNames;function useLoadDisplayNames(nameService){nameService||=useService("name");return async(resIdsByModel)=>{const proms=[];const resModels=[];for(const[resModel,resIds]of Object.entries(resIdsByModel)){resModels.push(resModel);proms.push(nameService.loadDisplayNames(resModel,resIds));}
return Object.fromEntries(zip(resModels,await Promise.all(proms)));};}
__exports.getResModel=getResModel;function getResModel(fieldDef){if(fieldDef){return fieldDef.is_property?fieldDef.comodel:fieldDef.relation;}
return null;}
__exports.extractIdsFromTree=extractIdsFromTree;function extractIdsFromTree(tree,getFieldDef){const idsByModel=_extractIdsRecursive(tree,getFieldDef,{});for(const resModel in idsByModel){idsByModel[resModel]=unique(idsByModel[resModel]);}
return idsByModel;}
function _extractIdsRecursive(tree,getFieldDef,idsByModel){if(tree.type==="condition"){const fieldDef=getFieldDef(tree.path);if(["many2one","many2many","one2many"].includes(fieldDef?.type)){const value=tree.value;const values=Array.isArray(value)?value:[value];const ids=values.filter((val)=>Number.isInteger(val)&&val>=1);const resModel=getResModel(fieldDef);if(ids.length){if(!idsByModel[resModel]){idsByModel[resModel]=[];}
idsByModel[resModel].push(...ids);}}}
if(tree.type==="connector"){for(const child of tree.children){_extractIdsRecursive(child,getFieldDef,idsByModel);}}
return idsByModel;}
__exports.getPathsInTree=getPathsInTree;function getPathsInTree(tree){const paths=[];if(tree.type==="condition"){paths.push(tree.path);}
if(tree.type==="connector"&&tree.children){for(const child of tree.children){paths.push(...getPathsInTree(child));}}
return paths;}
const SPECIAL_FIELDS=["country_id","user_id","partner_id","stage_id","id"];__exports.getDefaultPath=getDefaultPath;function getDefaultPath(fieldDefs){for(const name of SPECIAL_FIELDS){const fieldDef=fieldDefs[name];if(fieldDef){return fieldDef.name;}}
const name=Object.keys(fieldDefs)[0];if(name){return name;}
throw new Error(`No field found`);}
return __exports;});;

/* /web/static/src/core/ui/block_ui.js */
odoo.define('@web/core/ui/block_ui',['@web/core/l10n/translation','@web/core/browser/browser','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{browser}=require("@web/core/browser/browser");const{EventBus,Component,useState,xml}=require("@odoo/owl");const BlockUI=__exports.BlockUI=class BlockUI extends Component{setup(){this.messagesByDuration=[{time:20,l1:_t("Loading...")},{time:40,l1:_t("Still loading...")},{time:60,l1:_t("Still loading..."),l2:_t("Please be patient."),},{time:180,l1:_t("Don't leave yet,"),l2:_t("it's still loading..."),},{time:120,l1:_t("You may not believe it,"),l2:_t("but the application is actually loading..."),},{time:3180,l1:_t("Take a minute to get a coffee,"),l2:_t("because it's loading..."),},{time:null,l1:_t("Maybe you should consider reloading the application by pressing F5..."),},];this.state=useState({blockUI:false,line1:"",line2:"",});this.props.bus.addEventListener("BLOCK",this.block.bind(this));this.props.bus.addEventListener("UNBLOCK",this.unblock.bind(this));}
replaceMessage(index){const message=this.messagesByDuration[index];this.state.line1=message.l1;this.state.line2=message.l2||"";if(message.time!==null){this.msgTimer=browser.setTimeout(()=>{this.replaceMessage(index+1);},message.time*1000);}}
block(ev){this.state.blockUI=true;if(ev.detail?.message){this.state.line1=ev.detail.message;}else{this.replaceMessage(0);}}
unblock(){this.state.blockUI=false;clearTimeout(this.msgTimer);this.state.line1="";this.state.line2="";}}
BlockUI.props={bus:EventBus,};BlockUI.template=xml`
    <div t-att-class="state.blockUI ? 'o_blockUI fixed-top d-flex justify-content-center align-items-center flex-column vh-100' : ''">
      <t t-if="state.blockUI">
        <div class="o_spinner mb-4">
            <img src="/web/static/img/spin.svg" alt="Loading..."/>
        </div>
        <div class="o_message text-center px-4">
            <t t-esc="state.line1"/> <br/>
            <t t-esc="state.line2"/>
        </div>
      </t>
    </div>`;return __exports;});;

/* /web/static/src/core/ui/ui_service.js */
odoo.define('@web/core/ui/ui_service',['@web/core/utils/hooks','@web/core/registry','@web/core/utils/timing','@web/core/ui/block_ui','@web/core/browser/browser','@web/core/utils/ui','@web/core/hotkeys/hotkey_service','@odoo/owl'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{registry}=require("@web/core/registry");const{throttleForAnimation}=require("@web/core/utils/timing");const{BlockUI}=require("@web/core/ui/block_ui");const{browser}=require("@web/core/browser/browser");const{getTabableElements}=require("@web/core/utils/ui");const{getActiveHotkey}=require("@web/core/hotkeys/hotkey_service");const{EventBus,reactive,useEffect,useRef}=require("@odoo/owl");const SIZES=__exports.SIZES={XS:0,VSM:1,SM:2,MD:3,LG:4,XL:5,XXL:6};function getFirstAndLastTabableElements(el){const tabableEls=getTabableElements(el);return[tabableEls[0],tabableEls[tabableEls.length-1]];}
__exports.useActiveElement=useActiveElement;function useActiveElement(refName){if(!refName){throw new Error("refName not given to useActiveElement");}
const uiService=useService("ui");const ref=useRef(refName);function trapFocus(e){const hotkey=getActiveHotkey(e);if(!["tab","shift+tab"].includes(hotkey)){return;}
const el=e.currentTarget;const[firstTabableEl,lastTabableEl]=getFirstAndLastTabableElements(el);switch(hotkey){case"tab":if(document.activeElement===lastTabableEl){firstTabableEl.focus();e.preventDefault();e.stopPropagation();}
break;case"shift+tab":if(document.activeElement===firstTabableEl){lastTabableEl.focus();e.preventDefault();e.stopPropagation();}
break;}}
useEffect((el)=>{if(el){const[firstTabableEl]=getFirstAndLastTabableElements(el);if(!firstTabableEl){return;}
const oldActiveElement=document.activeElement;uiService.activateElement(el);el.addEventListener("keydown",trapFocus);if(!el.contains(document.activeElement)){firstTabableEl.focus();}
return()=>{uiService.deactivateElement(el);el.removeEventListener("keydown",trapFocus);if(el.contains(document.activeElement)||document.activeElement===document.body){oldActiveElement.focus();}};}},()=>[ref.el]);}
const MEDIAS_BREAKPOINTS=__exports.MEDIAS_BREAKPOINTS=[{maxWidth:474},{minWidth:475,maxWidth:575},{minWidth:576,maxWidth:767},{minWidth:768,maxWidth:991},{minWidth:992,maxWidth:1199},{minWidth:1200,maxWidth:1533},{minWidth:1534},];__exports.getMediaQueryLists=getMediaQueryLists;function getMediaQueryLists(){return MEDIAS_BREAKPOINTS.map(({minWidth,maxWidth})=>{if(!maxWidth){return window.matchMedia(`(min-width: ${minWidth}px)`);}
if(!minWidth){return window.matchMedia(`(max-width: ${maxWidth}px)`);}
return window.matchMedia(`(min-width: ${minWidth}px) and (max-width: ${maxWidth}px)`);});}
const MEDIAS=getMediaQueryLists();const utils=__exports.utils={getSize(){return MEDIAS.findIndex((media)=>media.matches);},isSmall(ui={}){return(ui.size||utils.getSize())<=SIZES.SM;},};const bus=new EventBus();__exports.listenSizeChange=listenSizeChange;function listenSizeChange(callback){bus.addEventListener("resize",callback);return()=>bus.removeEventListener("resize",callback);}
const uiService=__exports.uiService={start(env){registry.category("main_components").add("BlockUI",{Component:BlockUI,props:{bus}});let blockCount=0;function block(data){blockCount++;if(blockCount===1){bus.trigger("BLOCK",{message:data?.message,});}}
function unblock(){blockCount--;if(blockCount<0){console.warn("Unblock ui was called more times than block, you should only unblock the UI if you have previously blocked it.");blockCount=0;}
if(blockCount===0){bus.trigger("UNBLOCK");}}
let activeElems=[document];function activateElement(el){activeElems.push(el);bus.trigger("active-element-changed",el);}
function deactivateElement(el){activeElems=activeElems.filter((x)=>x!==el);bus.trigger("active-element-changed",ui.activeElement);}
function getActiveElementOf(el){for(const activeElement of[...activeElems].reverse()){if(activeElement.contains(el)){return activeElement;}}}
const ui=reactive({bus,size:utils.getSize(),get activeElement(){return activeElems[activeElems.length-1];},get isBlocked(){return blockCount>0;},isSmall:utils.isSmall(),block,unblock,activateElement,deactivateElement,getActiveElementOf,});const updateSize=()=>{const prevSize=ui.size;ui.size=utils.getSize();if(ui.size!==prevSize){ui.isSmall=utils.isSmall(ui);bus.trigger("resize");}};browser.addEventListener("resize",throttleForAnimation(updateSize));Object.defineProperty(env,"isSmall",{get(){return ui.isSmall;},});return ui;},};registry.category("services").add("ui",uiService);return __exports;});;

/* /web/static/src/core/user_service.js */
odoo.define('@web/core/user_service',['@web/core/registry','@web/session','@web/core/utils/cache'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{session}=require("@web/session");const{Cache}=require("@web/core/utils/cache");const userService=__exports.userService={dependencies:["rpc"],async:["hasGroup"],start(env,{rpc}){const groupCache=new Cache((group)=>{if(!context.uid){return Promise.resolve(false);}
return rpc("/web/dataset/call_kw/res.users/has_group",{model:"res.users",method:"has_group",args:[group],kwargs:{context},});});groupCache.cache["base.group_user"]=session.is_internal_user;groupCache.cache["base.group_system"]=session.is_system;const accessRightCache=new Cache((model,operation)=>{const url=`/web/dataset/call_kw/${model}/check_access_rights`;return rpc(url,{model,method:"check_access_rights",args:[operation,false],kwargs:{context},});});const context={...session.user_context,uid:session.uid||session.user_id,};let settings=session.user_settings;delete session.user_settings;return{get context(){return Object.assign({},context);},removeFromContext(key){delete context[key];},updateContext(update){Object.assign(context,update);},hasGroup(group){return groupCache.read(group);},async checkAccessRight(model,operation){return accessRightCache.read(model,operation);},get settings(){return settings;},async setUserSettings(key,value){const changedSettings=await env.services.orm.call("res.users.settings","set_res_users_settings",[[this.settings.id]],{new_settings:{[key]:value,},});Object.assign(settings,changedSettings);},name:session.name,userName:session.username,isAdmin:session.is_admin,isSystem:session.is_system,partnerId:session.partner_id,home_action_id:session.home_action_id,showEffect:session.show_effect,get userId(){return context.uid;},get lang(){return context.lang;},get tz(){return context.tz;},get db(){const res={name:session.db,};if("dbuuid"in session){res.uuid=session.dbuuid;}
return res;},};},};registry.category("services").add("user",userService);return __exports;});;

/* /web/static/src/core/utils/arrays.js */
odoo.define('@web/core/utils/arrays',['@web/core/utils/objects'],function(require){'use strict';let __exports={};const{shallowEqual:_shallowEqual}=require("@web/core/utils/objects");function _cartesian(){const args=Array.prototype.slice.call(arguments);if(args.length===0){return[undefined];}
const firstArray=args[0].map(function(elem){return[elem];});if(args.length===1){return firstArray;}
const productOfOtherArrays=_cartesian.apply(null,args.slice(1));return firstArray.reduce(function(acc,elem){return acc.concat(productOfOtherArrays.map(function(tuple){return elem.concat(tuple);}));},[]);}
function _getExtractorFrom(criterion){if(criterion){switch(typeof criterion){case"string":return(element)=>element[criterion];case"function":return criterion;default:throw new Error(`Expected criterion of type 'string' or 'function' and got '${typeof criterion}'`);}}else{return(element)=>element;}}
__exports.ensureArray=ensureArray;function ensureArray(value){return value&&typeof value==="object"&&value[Symbol.iterator]?[...value]:[value];}
__exports.intersection=intersection;function intersection(array1,array2){return array1.filter((v)=>array2.includes(v));}
__exports.groupBy=groupBy;function groupBy(array,criterion){const extract=_getExtractorFrom(criterion);const groups={};for(const element of array){const group=String(extract(element));if(!(group in groups)){groups[group]=[];}
groups[group].push(element);}
return groups;}
__exports.sortBy=sortBy;function sortBy(array,criterion,order="asc"){const extract=_getExtractorFrom(criterion);return array.slice().sort((elA,elB)=>{const a=extract(elA);const b=extract(elB);let result;if(isNaN(a)&&isNaN(b)){result=a>b?1:a<b?-1:0;}else{result=a-b;}
return order==="asc"?result:-result;});}
__exports.symmetricalDifference=symmetricalDifference;function symmetricalDifference(arrayA,arrayB){return arrayA.filter((id)=>!arrayB.includes(id)).concat(arrayB.filter((id)=>!arrayA.includes(id)));}
__exports.cartesian=cartesian;function cartesian(){const args=Array.prototype.slice.call(arguments);if(args.length===0){return[undefined];}else if(args.length===1){return args[0];}else{return _cartesian.apply(null,args);}}
const shallowEqual=__exports.shallowEqual=_shallowEqual;__exports.sections=sections;function sections(array){const sections=[];for(let i=0;i<array.length+1;i++){sections.push(array.slice(0,i));}
return sections;}
__exports.unique=unique;function unique(array){return Array.from(new Set(array));}
__exports.zip=zip;function zip(array1,array2,fill=false){const result=[];const getLength=fill?Math.max:Math.min;for(let i=0;i<getLength(array1.length,array2.length);i++){result.push([array1[i],array2[i]]);}
return result;}
__exports.zipWith=zipWith;function zipWith(array1,array2,func){return zip(array1,array2).map(([e1,e2])=>func(e1,e2));}
return __exports;});;

/* /web/static/src/core/utils/autoresize.js */
odoo.define('@web/core/utils/autoresize',['@odoo/owl','@web/core/browser/browser'],function(require){'use strict';let __exports={};const{useEffect}=require("@odoo/owl");const{browser}=require("@web/core/browser/browser");__exports.useAutoresize=useAutoresize;function useAutoresize(ref,options={}){let resize=null;useEffect((el)=>{if(el){resize=(el instanceof HTMLInputElement?resizeInput:resizeTextArea).bind(null,el,options);el.addEventListener("input",resize);return()=>{el.removeEventListener("input",resize);resize=null;};}},()=>[ref.el]);useEffect(()=>{if(resize){resize(ref.el,options);}});}
function resizeInput(input){input.style.width="100%";const maxWidth=input.clientWidth;const isSafari16=/Version\/16.+Safari/i.test(browser.navigator.userAgent);input.style.width="10px";if(input.value===""&&input.placeholder!==""){input.style.width="auto";return;}
if(input.scrollWidth+5+(isSafari16?8:0)>maxWidth){input.style.width="100%";return;}
input.style.width=input.scrollWidth+5+(isSafari16?8:0)+"px";}
__exports.resizeTextArea=resizeTextArea;function resizeTextArea(textarea,options={}){const minimumHeight=options.minimumHeight||0;let heightOffset=0;const style=window.getComputedStyle(textarea);if(style.boxSizing==="border-box"){const paddingHeight=parseFloat(style.paddingTop)+parseFloat(style.paddingBottom);const borderHeight=parseFloat(style.borderTopWidth)+parseFloat(style.borderBottomWidth);heightOffset=borderHeight+paddingHeight;}
const previousStyle={borderTopWidth:style.borderTopWidth,borderBottomWidth:style.borderBottomWidth,padding:style.padding,};Object.assign(textarea.style,{height:"auto",borderTopWidth:0,borderBottomWidth:0,paddingTop:0,paddingRight:style.paddingRight,paddingBottom:0,paddingLeft:style.paddingLeft,});textarea.style.height="auto";const height=Math.max(minimumHeight,textarea.scrollHeight+heightOffset);Object.assign(textarea.style,previousStyle,{height:`${height}px`});textarea.parentElement.style.height=`${height}px`;}
return __exports;});;

/* /web/static/src/core/utils/binary.js */
odoo.define('@web/core/utils/binary',['@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");__exports.isBinarySize=isBinarySize;function isBinarySize(value){return/^\d+(\.\d*)? [^0-9]+$/.test(value);}
__exports.toBase64Length=toBase64Length;function toBase64Length(maxBytes){return Math.ceil(maxBytes*4/3);}
__exports.humanSize=humanSize;function humanSize(size){const units=_t("Bytes|Kb|Mb|Gb|Tb|Pb|Eb|Zb|Yb").split("|");let i=0;while(size>=1024){size/=1024;++i;}
return`${size.toFixed(2)} ${units[i].trim()}`;}
return __exports;});;

/* /web/static/src/core/utils/cache.js */
odoo.define('@web/core/utils/cache',[],function(require){'use strict';let __exports={};const Cache=__exports.Cache=class Cache{constructor(getValue,getKey){this.cache={};this.getKey=getKey;this.getValue=getValue;}
_getCacheAndKey(...path){let cache=this.cache;let key;if(this.getKey){key=this.getKey(...path);}else{for(let i=0;i<path.length-1;i++){cache=cache[path[i]]=cache[path[i]]||{};}
key=path[path.length-1];}
return{cache,key};}
clear(...path){const{cache,key}=this._getCacheAndKey(...path);delete cache[key];}
invalidate(){this.cache={};}
read(...path){const{cache,key}=this._getCacheAndKey(...path);if(!(key in cache)){cache[key]=this.getValue(...path);}
return cache[key];}}
return __exports;});;

/* /web/static/src/core/utils/colors.js */
odoo.define('@web/core/utils/colors',[],function(require){'use strict';let __exports={};__exports.convertRgbToHsl=convertRgbToHsl;function convertRgbToHsl(r,g,b){if(typeof(r)!=='number'||isNaN(r)||r<0||r>255||typeof(g)!=='number'||isNaN(g)||g<0||g>255||typeof(b)!=='number'||isNaN(b)||b<0||b>255){return false;}
var red=r/255;var green=g/255;var blue=b/255;var maxColor=Math.max(red,green,blue);var minColor=Math.min(red,green,blue);var delta=maxColor-minColor;var hue=0;var saturation=0;var lightness=(maxColor+minColor)/2;if(delta){if(maxColor===red){hue=(green-blue)/delta;}
if(maxColor===green){hue=2+(blue-red)/delta;}
if(maxColor===blue){hue=4+(red-green)/delta;}
if(maxColor){saturation=delta/(1-Math.abs(2*lightness-1));}}
hue=60*hue;return{hue:hue<0?hue+360:hue,saturation:saturation*100,lightness:lightness*100,};};__exports.convertHslToRgb=convertHslToRgb;function convertHslToRgb(h,s,l){if(typeof(h)!=='number'||isNaN(h)||h<0||h>360||typeof(s)!=='number'||isNaN(s)||s<0||s>100||typeof(l)!=='number'||isNaN(l)||l<0||l>100){return false;}
var huePrime=h/60;var saturation=s/100;var lightness=l/100;var chroma=saturation*(1-Math.abs(2*lightness-1));var secondComponent=chroma*(1-Math.abs(huePrime%2-1));var lightnessAdjustment=lightness-chroma/2;var precision=255;chroma=Math.round((chroma+lightnessAdjustment)*precision);secondComponent=Math.round((secondComponent+lightnessAdjustment)*precision);lightnessAdjustment=Math.round((lightnessAdjustment)*precision);if(huePrime>=0&&huePrime<1){return{red:chroma,green:secondComponent,blue:lightnessAdjustment,};}
if(huePrime>=1&&huePrime<2){return{red:secondComponent,green:chroma,blue:lightnessAdjustment,};}
if(huePrime>=2&&huePrime<3){return{red:lightnessAdjustment,green:chroma,blue:secondComponent,};}
if(huePrime>=3&&huePrime<4){return{red:lightnessAdjustment,green:secondComponent,blue:chroma,};}
if(huePrime>=4&&huePrime<5){return{red:secondComponent,green:lightnessAdjustment,blue:chroma,};}
if(huePrime>=5&&huePrime<=6){return{red:chroma,green:lightnessAdjustment,blue:secondComponent,};}
return false;};__exports.convertRgbaToCSSColor=convertRgbaToCSSColor;function convertRgbaToCSSColor(r,g,b,a){if(typeof(r)!=='number'||isNaN(r)||r<0||r>255||typeof(g)!=='number'||isNaN(g)||g<0||g>255||typeof(b)!=='number'||isNaN(b)||b<0||b>255){return false;}
if(typeof(a)!=='number'||isNaN(a)||a<0||Math.abs(a-100)<Number.EPSILON){const rr=r<16?'0'+r.toString(16):r.toString(16);const gg=g<16?'0'+g.toString(16):g.toString(16);const bb=b<16?'0'+b.toString(16):b.toString(16);return(`#${rr}${gg}${bb}`).toUpperCase();}
return`rgba(${r}, ${g}, ${b}, ${parseFloat((a / 100.0).toFixed(3))})`;};__exports.convertCSSColorToRgba=convertCSSColorToRgba;function convertCSSColorToRgba(cssColor){const rgba=cssColor.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);if(rgba){if(rgba[4]===undefined){rgba[4]=1;}
return{red:parseInt(rgba[1]),green:parseInt(rgba[2]),blue:parseInt(rgba[3]),opacity:Math.round(parseFloat(rgba[4])*100),};}
if(/^#([0-9A-F]{6}|[0-9A-F]{8})$/i.test(cssColor)){return{red:parseInt(cssColor.substr(1,2),16),green:parseInt(cssColor.substr(3,2),16),blue:parseInt(cssColor.substr(5,2),16),opacity:(cssColor.length===9?(parseInt(cssColor.substr(7,2),16)/255):1)*100,};}
if(/color\(.+\)/.test(cssColor)){const canvasEl=document.createElement("canvas");canvasEl.height=1;canvasEl.width=1;const ctx=canvasEl.getContext("2d");ctx.fillStyle=cssColor;ctx.fillRect(0,0,1,1);const data=ctx.getImageData(0,0,1,1).data;return{red:data[0],green:data[1],blue:data[2],opacity:data[3]/2.55,};}
return false;};__exports.normalizeCSSColor=normalizeCSSColor;function normalizeCSSColor(cssColor){const rgba=convertCSSColorToRgba(cssColor);if(!rgba){return cssColor;}
return convertRgbaToCSSColor(rgba.red,rgba.green,rgba.blue,rgba.opacity);};__exports.isCSSColor=isCSSColor;function isCSSColor(cssColor){return convertCSSColorToRgba(cssColor)!==false;};__exports.mixCssColors=mixCssColors;function mixCssColors(cssColor1,cssColor2,weight){const rgba1=convertCSSColorToRgba(cssColor1);const rgba2=convertCSSColorToRgba(cssColor2);const rgb1=[rgba1.red,rgba1.green,rgba1.blue];const rgb2=[rgba2.red,rgba2.green,rgba2.blue];const[r,g,b]=rgb1.map((_,idx)=>Math.round(rgb2[idx]+(rgb1[idx]-rgb2[idx])*weight));return convertRgbaToCSSColor(r,g,b);};return __exports;});;

/* /web/static/src/core/utils/components.js */
odoo.define('@web/core/utils/components',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component,onError,xml,useSubEnv}=require("@odoo/owl");const ErrorHandler=__exports.ErrorHandler=class ErrorHandler extends Component{setup(){onError((error)=>{this.props.onError(error);});}}
ErrorHandler.template=xml`<t t-slot="default" />`;ErrorHandler.props=["onError","slots"];const WithEnv=__exports.WithEnv=class WithEnv extends Component{setup(){useSubEnv(this.props.env);}}
WithEnv.template=xml`<t t-slot="default"/>`;WithEnv.props=["env","slots"];return __exports;});;

/* /web/static/src/core/utils/concurrency.js */
odoo.define('@web/core/utils/concurrency',[],function(require){'use strict';let __exports={};__exports.delay=delay;function delay(wait){return new Promise(function(resolve){setTimeout(resolve,wait);});}
const KeepLast=__exports.KeepLast=class KeepLast{constructor(){this._id=0;}
add(promise){this._id++;const currentId=this._id;return new Promise((resolve,reject)=>{promise.then((value)=>{if(this._id===currentId){resolve(value);}}).catch((reason)=>{if(this._id===currentId){reject(reason);}});});}}
const Mutex=__exports.Mutex=class Mutex{constructor(){this._lock=Promise.resolve();this._queueSize=0;this._unlockedProm=undefined;this._unlock=undefined;}
async exec(action){this._queueSize++;if(!this._unlockedProm){this._unlockedProm=new Promise((resolve)=>{this._unlock=()=>{resolve();this._unlockedProm=undefined;};});}
const always=()=>{return Promise.resolve(action()).finally(()=>{if(--this._queueSize===0){this._unlock();}});};this._lock=this._lock.then(always,always);return this._lock;}
getUnlockedDef(){return this._unlockedProm||Promise.resolve();}}
const Race=__exports.Race=class Race{constructor(){this.currentProm=null;this.currentPromResolver=null;this.currentPromRejecter=null;}
add(promise){if(!this.currentProm){this.currentProm=new Promise((resolve,reject)=>{this.currentPromResolver=(value)=>{this.currentProm=null;this.currentPromResolver=null;this.currentPromRejecter=null;resolve(value);};this.currentPromRejecter=(error)=>{this.currentProm=null;this.currentPromResolver=null;this.currentPromRejecter=null;reject(error);};});}
promise.then(this.currentPromResolver).catch(this.currentPromRejecter);return this.currentProm;}
getCurrentProm(){return this.currentProm;}}
const Deferred=__exports.Deferred=class Deferred extends Promise{constructor(){let resolve;let reject;const prom=new Promise((res,rej)=>{resolve=res;reject=rej;});return Object.assign(prom,{resolve,reject});}}
return __exports;});;

/* /web/static/src/core/utils/draggable.js */
odoo.define('@web/core/utils/draggable',['@web/core/utils/draggable_hook_builder_owl','@web/core/utils/objects'],function(require){'use strict';let __exports={};const{makeDraggableHook}=require("@web/core/utils/draggable_hook_builder_owl");const{pick}=require("@web/core/utils/objects");const useDraggable=__exports.useDraggable=makeDraggableHook({name:"useDraggable",onWillStartDrag:({ctx})=>pick(ctx.current,"element"),onDragStart:({ctx})=>pick(ctx.current,"element"),onDrag:({ctx})=>pick(ctx.current,"element"),onDragEnd:({ctx})=>pick(ctx.current,"element"),onDrop:({ctx})=>pick(ctx.current,"element"),});return __exports;});;

/* /web/static/src/core/utils/draggable_hook_builder.js */
odoo.define('@web/core/utils/draggable_hook_builder',['@web/core/utils/numbers','@web/core/utils/scrolling','@web/core/utils/timing','@web/core/browser/browser','@web/core/browser/feature_detection'],function(require){'use strict';let __exports={};const{clamp}=require("@web/core/utils/numbers");const{closestScrollableX,closestScrollableY}=require("@web/core/utils/scrolling");const{setRecurringAnimationFrame}=require("@web/core/utils/timing");const{browser}=require("@web/core/browser/browser");const{hasTouch,isBrowserFirefox,isIOS}=require("@web/core/browser/feature_detection");const DRAGGABLE_CLASS="o_draggable";const DRAGGED_CLASS=__exports.DRAGGED_CLASS="o_dragged";const DEFAULT_ACCEPTED_PARAMS={enable:[Boolean,Function],preventDrag:[Function],ref:[Object],elements:[String],handle:[String,Function],ignore:[String,Function],cursor:[String],edgeScrolling:[Object,Function],delay:[Number],tolerance:[Number],iframeWindow:[Object,Function],};const DEFAULT_DEFAULT_PARAMS={elements:`.${DRAGGABLE_CLASS}`,enable:true,preventDrag:()=>false,edgeScrolling:{speed:10,threshold:30,},delay:0,tolerance:10,touch_delay:300,};const LEFT_CLICK=0;const MANDATORY_PARAMS=["ref"];const WHITE_LISTED_KEYS=["Alt","Control","Meta","Shift"];const elCache={};function camelToKebab(str){return str.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();}
function getReturnValue(valueOrFn){if(typeof valueOrFn==="function"){return valueOrFn();}
return valueOrFn;}
function getScrollParents(el){return[closestScrollableX(el),closestScrollableY(el)];}
function makeCleanupManager(defaultCleanupFn){const add=(cleanupFn)=>typeof cleanupFn==="function"&&cleanups.push(cleanupFn);const cleanup=()=>{while(cleanups.length){cleanups.pop()();}
add(defaultCleanupFn);};const cleanups=[];add(defaultCleanupFn);return{add,cleanup};}
function makeDOMHelpers(cleanup){const addClass=(el,...classNames)=>{if(!el||!classNames.length){return;}
cleanup.add(()=>el.classList.remove(...classNames));el.classList.add(...classNames);};const addListener=(el,event,callback,options={})=>{if(!el||!event||!callback){return;}
const{noAddedStyle}=options;delete options.noAddedStyle;el.addEventListener(event,callback,options);if(!noAddedStyle&&/mouse|pointer|touch/.test(event)){addStyle(el,{pointerEvents:"auto"});}
cleanup.add(()=>el.removeEventListener(event,callback,options));};const addStyle=(el,style)=>{if(!el||!style||!Object.keys(style).length){return;}
cleanup.add(saveAttribute(el,"style"));for(const key in style){const[value,priority]=String(style[key]).split(/\s*!\s*/);el.style.setProperty(camelToKebab(key),value,priority);}};const getRect=(el,options={})=>{if(!el){return{};}
const rect=el.getBoundingClientRect();if(options.adjust){const style=getComputedStyle(el);const[pl,pr,pt,pb]=["padding-left","padding-right","padding-top","padding-bottom",].map((prop)=>pixelValueToNumber(style.getPropertyValue(prop)));rect.x+=pl;rect.y+=pt;rect.width-=pl+pr;rect.height-=pt+pb;}
return rect;};const removeAttribute=(el,attribute)=>{if(!el||!attribute){return;}
cleanup.add(saveAttribute(el,attribute));el.removeAttribute(attribute);};const removeClass=(el,...classNames)=>{if(!el||!classNames.length){return;}
cleanup.add(saveAttribute(el,"class"));el.classList.remove(...classNames);};const removeStyle=(el,...properties)=>{if(!el||!properties.length){return;}
cleanup.add(saveAttribute(el,"style"));for(const key of properties){el.style.removeProperty(camelToKebab(key));}};const setAttribute=(el,attribute,value)=>{if(!el||!attribute){return;}
cleanup.add(saveAttribute(el,attribute));el.setAttribute(attribute,String(value));};return{addClass,addListener,addStyle,getRect,removeAttribute,removeClass,removeStyle,setAttribute,};}
function pixelValueToNumber(val){return Number(val.endsWith("px")?val.slice(0,-2):val);}
function safePrevent(ev,{stop}={}){if(ev.cancelable){ev.preventDefault();if(stop){ev.stopPropagation();}}}
function saveAttribute(el,attribute){const restoreAttribute=()=>{cache.delete(el);if(hasAttribute){el.setAttribute(attribute,originalValue);}else{el.removeAttribute(attribute);}};if(!(attribute in elCache)){elCache[attribute]=new Set();}
const cache=elCache[attribute];if(cache.has(el)){return;}
cache.add(el);const hasAttribute=el.hasAttribute(attribute);const originalValue=el.getAttribute(attribute);return restoreAttribute;}
function toFunction(value){return typeof value==="function"?value:()=>value;}
__exports.makeDraggableHook=makeDraggableHook;function makeDraggableHook(hookParams){hookParams=getReturnValue(hookParams);const hookName=hookParams.name||"useAnonymousDraggable";const{setupHooks}=hookParams;const allAcceptedParams={...DEFAULT_ACCEPTED_PARAMS,...hookParams.acceptedParams};const defaultParams={...DEFAULT_DEFAULT_PARAMS,...hookParams.defaultParams};const computeParams=(params)=>{const computedParams={enable:()=>true};for(const prop in allAcceptedParams){if(prop in params){if(prop==="enable"){computedParams[prop]=toFunction(params[prop]);}else if(allAcceptedParams[prop].length===1&&allAcceptedParams[prop][0]===Function){computedParams[prop]=params[prop];}else{computedParams[prop]=getReturnValue(params[prop]);}}}
return Object.entries(computedParams);};const makeError=(reason)=>new Error(`Error in hook ${hookName}: ${reason}.`);return{[hookName](params){const callBuildHandler=(hookHandlerName,arg)=>{if(typeof hookParams[hookHandlerName]!=="function"){return;}
const returnValue=hookParams[hookHandlerName]({ctx,...helpers,...arg});if(returnValue){callHandler(hookHandlerName,returnValue);}};const callHandler=(handlerName,arg)=>{if(typeof params[handlerName]!=="function"){return;}
try{params[handlerName]({...dom,...ctx.pointer,...arg});}catch(err){dragEnd(null,true);throw err;}};const canStartDrag=()=>{const{pointer,current:{initialPosition},}=ctx;return(!ctx.tolerance||Math.hypot(pointer.x-initialPosition.x,pointer.y-initialPosition.y)>=ctx.tolerance);};const dragStart=()=>{state.dragging=true;state.willDrag=false;[ctx.current.scrollParentX,ctx.current.scrollParentY]=getScrollParents(ctx.current.container);updateRects();const{x,y,width,height}=ctx.current.elementRect;ctx.current.offset={x:ctx.current.initialPosition.x-x,y:ctx.current.initialPosition.y-y,};if(ctx.followCursor){dom.addStyle(ctx.current.element,{width:`${width}px`,height:`${height}px`,position:"fixed !important",});updateElementPosition();}
dom.addClass(document.body,"pe-none","user-select-none");if(params.iframeWindow){dom.addClass(params.iframeWindow.body,"pe-none","user-select-none");}
if(ctx.cursor){dom.addStyle(document.body,{cursor:ctx.cursor});}
if((ctx.current.scrollParentX||ctx.current.scrollParentY)&&ctx.edgeScrolling.enabled){const cleanupFn=setRecurringAnimationFrame(handleEdgeScrolling);cleanup.add(cleanupFn);}
dom.addClass(ctx.current.element,DRAGGED_CLASS);callBuildHandler("onDragStart");};const dragEnd=(target,inErrorState)=>{if(state.dragging){if(!inErrorState){if(target){callBuildHandler("onDrop",{target});}
callBuildHandler("onDragEnd");}}
cleanup.cleanup();};const handleEdgeScrolling=(deltaTime)=>{updateRects();const eRect=ctx.current.elementRect;const xRect=ctx.current.scrollParentXRect;const yRect=ctx.current.scrollParentYRect;const{speed,threshold}=ctx.edgeScrolling;const correctedSpeed=(speed/16)*deltaTime;const diff={};if(xRect){const maxWidth=xRect.x+xRect.width;if(eRect.x-xRect.x<threshold){diff.x=[eRect.x-xRect.x,-1];}else if(maxWidth-eRect.x-eRect.width<threshold){diff.x=[maxWidth-eRect.x-eRect.width,1];}}
if(yRect){const maxHeight=yRect.y+yRect.height;if(eRect.y-yRect.y<threshold){diff.y=[eRect.y-yRect.y,-1];}else if(maxHeight-eRect.y-eRect.height<threshold){diff.y=[maxHeight-eRect.y-eRect.height,1];}}
const diffToScroll=([delta,sign])=>(1-clamp(delta,0,threshold)/threshold)*correctedSpeed*sign;if(diff.y){ctx.current.scrollParentY.scrollBy({top:diffToScroll(diff.y)});}
if(diff.x){ctx.current.scrollParentX.scrollBy({left:diffToScroll(diff.x)});}};const onKeyDown=(ev)=>{if(!state.dragging||!ctx.enable()){return;}
if(!WHITE_LISTED_KEYS.includes(ev.key)){safePrevent(ev,{stop:true});dragEnd(null);}};const onPointerCancel=()=>{dragEnd(null);};const onPointerDown=(ev)=>{updatePointerPosition(ev);const initiationDelay=ev.pointerType==="touch"?ctx.touch_delay:ctx.delay;dragEnd(null);const fullSelectorEl=ev.target.closest(ctx.fullSelector);if(ev.button!==LEFT_CLICK||!ctx.enable()||!fullSelectorEl||(ctx.ignoreSelector&&ev.target.closest(ctx.ignoreSelector))||ctx.preventDrag(fullSelectorEl)){return;}
safePrevent(ev);if(document.activeElement&&!document.activeElement.contains(ev.target)){document.activeElement.blur();}
const{currentTarget,pointerId,target}=ev;ctx.current.initialPosition={...ctx.pointer};if(target.hasPointerCapture(pointerId)){target.releasePointerCapture(pointerId);}
if(initiationDelay){if(hasTouch()){if(ev.pointerType==="touch"){dom.addClass(target.closest(ctx.elementSelector),"o_touch_bounce");}
if(isBrowserFirefox()){const links=[...currentTarget.querySelectorAll("[href")];if(currentTarget.hasAttribute("href")){links.unshift(currentTarget);}
for(const link of links){dom.removeAttribute(link,"href");}}
if(isIOS()){for(const image of currentTarget.getElementsByTagName("img")){dom.setAttribute(image,"draggable",false);}}}
ctx.current.timeout=browser.setTimeout(()=>{ctx.current.initialPosition={...ctx.pointer};willStartDrag(target);const{x:px,y:py}=ctx.pointer;const{x,y,width,height}=dom.getRect(ctx.current.element);if(px<x||x+width<px||py<y||y+height<py){dragEnd(null);}},initiationDelay);cleanup.add(()=>browser.clearTimeout(ctx.current.timeout));}else{willStartDrag(target);}};const onPointerMove=(ev)=>{updatePointerPosition(ev);if(!ctx.current.element||!ctx.enable()){return;}
safePrevent(ev);if(!state.dragging){if(!canStartDrag()){return;}
dragStart();}
if(ctx.followCursor){updateElementPosition();}
callBuildHandler("onDrag");};const onPointerUp=(ev)=>{updatePointerPosition(ev);dragEnd(ev.target);};const updateElementPosition=()=>{const{containerRect,element,elementRect,offset}=ctx.current;const{width:ew,height:eh}=elementRect;const{x:cx,y:cy,width:cw,height:ch}=containerRect;dom.addStyle(element,{left:`${clamp(ctx.pointer.x - offset.x, cx, cx + cw - ew)}px`,top:`${clamp(ctx.pointer.y - offset.y, cy, cy + ch - eh)}px`,});};const updatePointerPosition=(ev)=>{ctx.pointer.x=ev.clientX;ctx.pointer.y=ev.clientY;};const updateRects=()=>{const{current}=ctx;const{container,element,scrollParentX,scrollParentY}=current;current.containerRect=dom.getRect(container,{adjust:true});let iframeOffsetX=0;let iframeOffsetY=0;const iframeEl=container.ownerDocument.defaultView.frameElement;if(iframeEl&&!iframeEl.contentDocument.contains(element)){const{x,y}=dom.getRect(iframeEl);iframeOffsetX=x;iframeOffsetY=y;current.containerRect.x+=iframeOffsetX;current.containerRect.y+=iframeOffsetY;}
current.containerRect.width=container.scrollWidth;current.containerRect.height=container.scrollHeight;current.scrollParentXRect=null;current.scrollParentYRect=null;if(ctx.edgeScrolling.enabled){if(scrollParentX){current.scrollParentXRect=dom.getRect(scrollParentX,{adjust:true});current.scrollParentXRect.x+=iframeOffsetX;current.scrollParentXRect.y+=iframeOffsetY;const right=Math.min(current.containerRect.left+container.scrollWidth,current.scrollParentXRect.right);current.containerRect.x=Math.max(current.containerRect.x,current.scrollParentXRect.x);current.containerRect.width=right-current.containerRect.x;}
if(scrollParentY){current.scrollParentYRect=dom.getRect(scrollParentY,{adjust:true});current.scrollParentYRect.x+=iframeOffsetX;current.scrollParentYRect.y+=iframeOffsetY;const bottom=Math.min(current.containerRect.top+container.scrollHeight,current.scrollParentYRect.bottom);current.containerRect.y=Math.max(current.containerRect.y,current.scrollParentYRect.y);current.containerRect.height=bottom-current.containerRect.y;}}
ctx.current.elementRect=dom.getRect(element);};const willStartDrag=(target)=>{ctx.current.element=target.closest(ctx.elementSelector);ctx.current.container=ctx.ref.el;cleanup.add(()=>(ctx.current={}));state.willDrag=true;callBuildHandler("onWillStartDrag");if(hasTouch()){dom.addListener(window,"touchmove",safePrevent,{passive:false,noAddedStyle:true,});if(params.iframeWindow){dom.addListener(params.iframeWindow,"touchmove",safePrevent,{passive:false,noAddedStyle:true,});}}};const cleanup=makeCleanupManager(()=>(state.dragging=false));const effectCleanup=makeCleanupManager();const dom=makeDOMHelpers(cleanup);const helpers={...dom,addCleanup:cleanup.add,addEffectCleanup:effectCleanup.add,callHandler,};const state=setupHooks.wrapState({dragging:false});for(const prop in allAcceptedParams){const type=typeof params[prop];const acceptedTypes=allAcceptedParams[prop].map((t)=>t.name.toLowerCase());if(params[prop]){if(!acceptedTypes.includes(type)){throw makeError(`invalid type for property "${prop}" in parameters: expected { ${acceptedTypes.join(
                                ", "
                            )} } and got ${type}`);}}else if(MANDATORY_PARAMS.includes(prop)&&!defaultParams[prop]){throw makeError(`missing required property "${prop}" in parameters`);}}
const ctx={enable:()=>false,preventDrag:()=>false,ref:params.ref,ignoreSelector:null,fullSelector:null,followCursor:true,cursor:null,pointer:{x:0,y:0},edgeScrolling:{enabled:true},get dragging(){return state.dragging;},get willDrag(){return state.willDrag;},current:{},};setupHooks.setup((...deps)=>{const actualParams={...defaultParams,...Object.fromEntries(deps)};if(!ctx.ref.el){return;}
ctx.enable=actualParams.enable;if(actualParams.preventDrag){ctx.preventDrag=actualParams.preventDrag;}
ctx.elementSelector=actualParams.elements;if(!ctx.elementSelector){throw makeError(`no value found by "elements" selector: ${ctx.elementSelector}`);}
const allSelectors=[ctx.elementSelector];ctx.cursor=actualParams.cursor||null;if(actualParams.handle){allSelectors.push(actualParams.handle);}
if(actualParams.ignore){ctx.ignoreSelector=actualParams.ignore;}
ctx.fullSelector=allSelectors.join(" ");Object.assign(ctx.edgeScrolling,actualParams.edgeScrolling);ctx.delay=actualParams.delay;ctx.touch_delay=actualParams.delay||actualParams.touch_delay;ctx.tolerance=actualParams.tolerance;callBuildHandler("onComputeParams",{params:actualParams});return effectCleanup.cleanup;},()=>computeParams(params));const useMouseEvents=isBrowserFirefox()&&!hasTouch()&&params.iframeWindow;setupHooks.setup((el)=>{if(el){const{add,cleanup}=makeCleanupManager();const{addListener}=makeDOMHelpers({add});const event=useMouseEvents?"mousedown":"pointerdown";addListener(el,event,onPointerDown,{noAddedStyle:true});if(hasTouch()){addListener(el,"contextmenu",safePrevent);addListener(el,"touchstart",()=>{},{passive:false,noAddedStyle:true,});}
return cleanup;}},()=>[ctx.ref.el]);const addWindowListener=(type,listener,options)=>{if(params.iframeWindow){setupHooks.addListener(params.iframeWindow,type,listener,options);}
setupHooks.addListener(window,type,listener,options);};const throttledOnPointerMove=setupHooks.throttle(onPointerMove);addWindowListener(useMouseEvents?"mousemove":"pointermove",throttledOnPointerMove,{passive:false});addWindowListener(useMouseEvents?"mouseup":"pointerup",onPointerUp);addWindowListener("pointercancel",onPointerCancel);addWindowListener("keydown",onKeyDown,{capture:true});setupHooks.teardown(()=>dragEnd(null));return state;},}[hookName];}
return __exports;});;

/* /web/static/src/core/utils/draggable_hook_builder_owl.js */
odoo.define('@web/core/utils/draggable_hook_builder_owl',['@odoo/owl','@web/core/utils/timing','@web/core/utils/draggable_hook_builder'],function(require){'use strict';let __exports={};const{onWillUnmount,reactive,useEffect,useExternalListener}=require("@odoo/owl");const{useThrottleForAnimation}=require("@web/core/utils/timing");const{makeDraggableHook:nativeMakeDraggableHook}=require("@web/core/utils/draggable_hook_builder");__exports.makeDraggableHook=makeDraggableHook;function makeDraggableHook(params){return nativeMakeDraggableHook({...params,setupHooks:{addListener:useExternalListener,setup:useEffect,teardown:onWillUnmount,throttle:useThrottleForAnimation,wrapState:reactive,},});}
return __exports;});;

/* /web/static/src/core/utils/files.js */
odoo.define('@web/core/utils/files',['@web/core/utils/numbers','@web/session','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{humanNumber}=require("@web/core/utils/numbers");const{session}=require("@web/session");const{_t}=require("@web/core/l10n/translation");const DEFAULT_MAX_FILE_SIZE=128*1024*1024;__exports.checkFileSize=checkFileSize;function checkFileSize(fileSize,notificationService){const maxUploadSize=session.max_file_upload_size||DEFAULT_MAX_FILE_SIZE;if(fileSize>maxUploadSize){notificationService.add(_t("The selected file (%sB) is over the maximum allowed file size (%sB).",humanNumber(fileSize),humanNumber(maxUploadSize)),{type:"danger",});return false;}
return true;}
return __exports;});;

/* /web/static/src/core/utils/functions.js */
odoo.define('@web/core/utils/functions',[],function(require){'use strict';let __exports={};__exports.memoize=memoize;function memoize(func){const cache=new Map();const funcName=func.name?func.name+" (memoized)":"memoized";return{[funcName](...args){if(!cache.has(args[0])){cache.set(args[0],func(...args));}
return cache.get(...args);},}[funcName];}
__exports.uniqueId=uniqueId;function uniqueId(prefix=""){return`${prefix}${++uniqueId.nextId}`;}
uniqueId.nextId=0;return __exports;});;

/* /web/static/src/core/utils/hooks.js */
odoo.define('@web/core/utils/hooks',['@web/env','@web/core/browser/feature_detection','@odoo/owl'],function(require){'use strict';let __exports={};const{SERVICES_METADATA}=require("@web/env");const{hasTouch,isMobileOS}=require("@web/core/browser/feature_detection");const{status,useComponent,useEffect,useRef,onWillUnmount}=require("@odoo/owl");__exports.useAutofocus=useAutofocus;function useAutofocus({refName,selectAll,mobile}={}){const ref=useRef(refName||"autofocus");const uiService=useService("ui");if(!mobile&&hasTouch()){return ref;}
if(!mobile&&isMobileOS()){return ref;}
useEffect((el)=>{if(el&&(!uiService.activeElement||uiService.activeElement.contains(el))){el.focus();if(["INPUT","TEXTAREA"].includes(el.tagName)&&el.type!=="number"){el.selectionEnd=el.value.length;el.selectionStart=selectAll?0:el.value.length;}}},()=>[ref.el]);return ref;}
__exports.useBus=useBus;function useBus(bus,eventName,callback){const component=useComponent();useEffect(()=>{const listener=callback.bind(component);bus.addEventListener(eventName,listener);return()=>bus.removeEventListener(eventName,listener);},()=>[]);}
function _protectMethod(component,fn){return function(...args){if(status(component)==="destroyed"){return Promise.reject(new Error("Component is destroyed"));}
const prom=Promise.resolve(fn.call(this,...args));const protectedProm=prom.then((result)=>status(component)==="destroyed"?new Promise(()=>{}):result);return Object.assign(protectedProm,{abort:prom.abort,cancel:prom.cancel,});};}
__exports.useService=useService;function useService(serviceName){const component=useComponent();const{services}=component.env;if(!(serviceName in services)){throw new Error(`Service ${serviceName} is not available`);}
const service=services[serviceName];if(serviceName in SERVICES_METADATA){if(service instanceof Function){return _protectMethod(component,service);}else{const methods=SERVICES_METADATA[serviceName];const result=Object.create(service);for(const method of methods){result[method]=_protectMethod(component,service[method]);}
return result;}}
return service;}
__exports.useSpellCheck=useSpellCheck;function useSpellCheck({refName}={}){const elements=[];const ref=useRef(refName||"spellcheck");function toggleSpellcheck(ev){ev.target.spellcheck=document.activeElement===ev.target;}
useEffect((el)=>{if(el){const inputs=["INPUT","TEXTAREA"].includes(el.nodeName)||el.contenteditable?[el]:el.querySelectorAll("input, textarea, [contenteditable=true]");inputs.forEach((input)=>{if(input.spellcheck!==false){elements.push(input);input.addEventListener("focus",toggleSpellcheck);input.addEventListener("blur",toggleSpellcheck);}});}
return()=>{elements.forEach((input)=>{input.removeEventListener("focus",toggleSpellcheck);input.removeEventListener("blur",toggleSpellcheck);});};},()=>[ref.el]);}
__exports.useChildRef=useChildRef;function useChildRef(){let defined=false;let value;return function ref(v){value=v;if(defined){return;}
Object.defineProperty(ref,"el",{get(){return value.el;},});defined=true;};}
__exports.useForwardRefToParent=useForwardRefToParent;function useForwardRefToParent(refName){const component=useComponent();const ref=useRef(refName);if(component.props[refName]){component.props[refName](ref);}
return ref;}
__exports.useOwnedDialogs=useOwnedDialogs;function useOwnedDialogs(){const dialogService=useService("dialog");const cbs=[];onWillUnmount(()=>{cbs.forEach((cb)=>cb());});const addDialog=(...args)=>{const close=dialogService.add(...args);cbs.push(close);return close;};return addDialog;}
__exports.useRefListener=useRefListener;function useRefListener(ref,...listener){useEffect((el)=>{el?.addEventListener(...listener);return()=>el?.removeEventListener(...listener);},()=>[ref.el]);}
return __exports;});;

/* /web/static/src/core/utils/misc.js */
odoo.define('@web/core/utils/misc',[],function(require){'use strict';let __exports={};const eventHandledWeakMap=new WeakMap();__exports.isEventHandled=isEventHandled;function isEventHandled(ev,markName){if(!eventHandledWeakMap.get(ev)){return false;}
return eventHandledWeakMap.get(ev).includes(markName);}
__exports.markEventHandled=markEventHandled;function markEventHandled(ev,markName){if(!eventHandledWeakMap.get(ev)){eventHandledWeakMap.set(ev,[]);}
eventHandledWeakMap.get(ev).push(markName);}
return __exports;});;

/* /web/static/src/core/utils/nested_sortable.js */
odoo.define('@web/core/utils/nested_sortable',['@web/core/l10n/localization','@web/core/utils/draggable_hook_builder_owl'],function(require){'use strict';let __exports={};const{localization}=require("@web/core/l10n/localization");const{makeDraggableHook}=require("@web/core/utils/draggable_hook_builder_owl");const useNestedSortable=__exports.useNestedSortable=makeDraggableHook({name:"useNestedSortable",acceptedParams:{groups:[String,Function],connectGroups:[Boolean,Function],nest:[Boolean],listTagName:[String],nestInterval:[Number],maxLevels:[Number],isAllowed:[Function],useElementSize:[Boolean],},defaultParams:{connectGroups:false,currentGroup:null,cursor:"grabbing",edgeScrolling:{speed:20,threshold:60},elements:"li",groupSelector:null,nest:false,listTagName:"ul",nestInterval:15,maxLevels:0,isAllowed:(ctx)=>true,useElementSize:false,},onComputeParams({ctx,params}){ctx.groupSelector=params.groups||null;if(ctx.groupSelector){ctx.fullSelector=[ctx.groupSelector,ctx.fullSelector].join(" ");}
ctx.connectGroups=params.connectGroups;ctx.nest=params.nest;ctx.listTagName=params.listTagName;ctx.nestInterval=params.nestInterval;ctx.isRTL=localization.direction==="rtl";ctx.maxLevels=params.maxLevels||0;ctx.isAllowed=params.isAllowed??(()=>true);ctx.useElementSize=params.useElementSize;},onWillStartDrag({ctx,addCleanup}){if(ctx.groupSelector){ctx.currentGroup=ctx.current.element.closest(ctx.groupSelector);if(!ctx.connectGroups){ctx.current.container=ctx.currentGroup;}}
if(ctx.nest){ctx.prevNestX=ctx.pointer.x;}
ctx.current.placeHolder=ctx.current.element.cloneNode(false);ctx.current.placeHolder.classList.add("w-100","d-block");if(ctx.useElementSize){ctx.current.placeHolder.style.height=getComputedStyle(ctx.current.element).height;ctx.current.placeHolder.classList.add("o_nested_sortable_placeholder_realsize");}else{ctx.current.placeHolder.classList.add("o_nested_sortable_placeholder");}
addCleanup(()=>ctx.current.placeHolder.remove());},onDragStart({ctx,addStyle}){ctx.selectorX=ctx.isRTL?ctx.current.elementRect.left+1:ctx.current.elementRect.right-1;ctx.current.element.after(ctx.current.placeHolder);addStyle(ctx.current.element,{opacity:0.5});addStyle(document.body,{"pointer-events":"auto"});addStyle(document.querySelector(".o_navbar"),{"pointer-events":"none"});addStyle(document.querySelector(".o_action_manager"),{"pointer-events":"none"});addStyle(ctx.current.container,{"pointer-events":"auto"});return{element:ctx.current.element,group:ctx.currentGroup,};},_getDeepestChildLevel(ctx,node,depth=0){let result=0;const childSelector=`${ctx.listTagName} ${ctx.elementSelector}`;for(const childNode of node.querySelectorAll(childSelector)){result=Math.max(this._getDeepestChildLevel(ctx,childNode,depth+1),result);}
return depth?result+1:result;},_hasReachMaxAllowedLevel(ctx){if(!ctx.nest||ctx.maxLevels<1){return false;}
let level=this._getDeepestChildLevel(ctx,ctx.current.element);let list=ctx.current.placeHolder.closest(ctx.listTagName);while(list){level++;list=list.parentNode.closest(ctx.listTagName);}
return level>ctx.maxLevels;},_isAllowedNodeMove(ctx){return(!this._hasReachMaxAllowedLevel(ctx)&&ctx.isAllowed(ctx.current,ctx.elementSelector));},onDrag({ctx,callHandler}){const onMove=(prevPos)=>{if(!this._isAllowedNodeMove(ctx)){ctx.current.placeHolder.classList.add("d-none");return;}
ctx.current.placeHolder.classList.remove("d-none");callHandler("onMove",{element:ctx.current.element,previous:ctx.current.placeHolder.previousElementSibling,next:ctx.current.placeHolder.nextElementSibling,parent:ctx.nest?ctx.current.placeHolder.parentElement.closest(ctx.elementSelector):false,group:ctx.currentGroup,newGroup:ctx.connectGroups?ctx.current.placeHolder.closest(ctx.groupSelector):ctx.currentGroup,prevPos,placeholder:ctx.current.placeHolder,});};const getChildList=(el)=>{let list=el.querySelector(ctx.listTagName);if(!list){list=document.createElement(ctx.listTagName);el.appendChild(list);}
return list;};const position={previous:ctx.current.placeHolder.previousElementSibling,next:ctx.current.placeHolder.nextElementSibling,parent:ctx.nest?ctx.current.placeHolder.parentElement.closest(ctx.elementSelector):false,group:ctx.groupSelector?ctx.current.placeHolder.closest(ctx.groupSelector):false,};if(ctx.nest){const xInterval=ctx.prevNestX-ctx.pointer.x;if(ctx.nestInterval-(-1)**ctx.isRTL*xInterval<1){let nextElement=position.next;if(nextElement===ctx.current.element){nextElement=nextElement.nextElementSibling;}
if(!nextElement){const newSibling=position.parent;if(newSibling){newSibling.after(ctx.current.placeHolder);onMove(position);}}
ctx.prevNestX=ctx.pointer.x;return;}else if(ctx.nestInterval+(-1)**ctx.isRTL*xInterval<1){let parent=position.previous;if(parent===ctx.current.element){parent=parent.previousElementSibling;}
if(parent&&parent.matches(ctx.elementSelector)){getChildList(parent).appendChild(ctx.current.placeHolder);onMove(position);}
ctx.prevNestX=ctx.pointer.x;return;}}
const currentTop=ctx.pointer.y-ctx.current.offset.y;const closestEl=document.elementFromPoint(ctx.selectorX,currentTop);if(!closestEl){return;}
const element=closestEl.closest(ctx.elementSelector);if(element&&element!==ctx.current.placeHolder){const eRect=element.getBoundingClientRect();const pos=ctx.current.placeHolder.compareDocumentPosition(element);if(currentTop-eRect.y<10){if(pos===Node.DOCUMENT_POSITION_PRECEDING||pos===(Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINS)){element.before(ctx.current.placeHolder);onMove(position);ctx.prevNestX=ctx.pointer.x;}}else if(currentTop-eRect.y>15&&pos===Node.DOCUMENT_POSITION_FOLLOWING){if(ctx.nest){const elementChildList=getChildList(element);if(elementChildList.querySelector(ctx.elementSelector)){elementChildList.prepend(ctx.current.placeHolder);onMove(position);}else{element.after(ctx.current.placeHolder);onMove(position);}
ctx.prevNestX=ctx.pointer.x;}else{element.after(ctx.current.placeHolder);onMove(position);}}}else{const group=closestEl.closest(ctx.groupSelector);if(group&&group!==position.group){if(group.compareDocumentPosition(position.group)===Node.DOCUMENT_POSITION_PRECEDING){getChildList(group).prepend(ctx.current.placeHolder);onMove(position);}else{getChildList(group).appendChild(ctx.current.placeHolder);onMove(position);}
ctx.prevNestX=ctx.pointer.x;callHandler("onGroupEnter",{group,element:ctx.current.placeHolder});callHandler("onGroupLeave",{group:position.group,element:ctx.current.placeHolder,});}}},onDrop({ctx}){if(!this._isAllowedNodeMove(ctx)){return;}
const previous=ctx.current.placeHolder.previousElementSibling;const next=ctx.current.placeHolder.nextElementSibling;if(previous!==ctx.current.element&&next!==ctx.current.element){return{element:ctx.current.element,group:ctx.currentGroup,previous,next,newGroup:ctx.groupSelector&&ctx.current.placeHolder.closest(ctx.groupSelector),parent:ctx.current.placeHolder.parentElement.closest(ctx.elementSelector),placeholder:ctx.current.placeHolder,};}},onDragEnd({ctx}){return{element:ctx.current.element,group:ctx.currentGroup,};},});return __exports;});;

/* /web/static/src/core/utils/numbers.js */
odoo.define('@web/core/utils/numbers',['@web/core/l10n/localization','@web/core/l10n/translation','@web/core/utils/strings'],function(require){'use strict';let __exports={};const{localization:l10n}=require("@web/core/l10n/localization");const{_t}=require("@web/core/l10n/translation");const{intersperse}=require("@web/core/utils/strings");__exports.clamp=clamp;function clamp(num,min,max){return Math.max(Math.min(num,max),min);}
__exports.range=range;function range(start,stop,step=1){const array=[];const nsteps=Math.floor((stop-start)/step);for(let i=0;i<nsteps;i++){array.push(start+step*i);}
return array;}
__exports.roundPrecision=roundPrecision;function roundPrecision(value,precision){if(!value){return 0;}else if(!precision||precision<0){precision=1;}
let normalizedValue=value/precision;const epsilonMagnitude=Math.log2(Math.abs(normalizedValue));const epsilon=Math.pow(2,epsilonMagnitude-52);normalizedValue+=normalizedValue>=0?epsilon:-epsilon;const sign=normalizedValue<0?-1.0:1.0;const roundedValue=sign*Math.round(Math.abs(normalizedValue));return roundedValue*precision;}
__exports.roundDecimals=roundDecimals;function roundDecimals(value,decimals){return roundPrecision(value,parseFloat("1e"+-decimals));}
__exports.floatIsZero=floatIsZero;function floatIsZero(value,decimals){return roundDecimals(value,decimals)===0;}
__exports.insertThousandsSep=insertThousandsSep;function insertThousandsSep(number,thousandsSep=",",grouping=[]){const negative=number[0]==="-";number=negative?number.slice(1):number;return(negative?"-":"")+intersperse(number,grouping,thousandsSep);}
__exports.humanNumber=humanNumber;function humanNumber(number,options={decimals:0,minDigits:1}){const decimals=options.decimals||0;const minDigits=options.minDigits||1;const d2=Math.pow(10,decimals);const numberMagnitude=+number.toExponential().split("e+")[1];number=Math.round(number*d2)/d2;if(numberMagnitude>=21){number=Math.round(number*Math.pow(10,decimals-numberMagnitude))/d2;return`${number}e+${numberMagnitude}`;}
const unitSymbols=_t("kMGTPE").toString();const sign=Math.sign(number);number=Math.abs(number);let symbol="";for(let i=unitSymbols.length;i>0;i--){const s=Math.pow(10,i*3);if(s<=number/Math.pow(10,minDigits-1)){number=Math.round((number*d2)/s)/d2;symbol=unitSymbols[i-1];break;}}
const{decimalPoint,grouping,thousandsSep}=l10n;const decimalsToKeep=number>=1000?0:decimals;number=sign*number;const[integerPart,decimalPart]=number.toFixed(decimalsToKeep).split(".");const int=insertThousandsSep(integerPart,thousandsSep,grouping);if(!decimalPart){return int+symbol;}
return int+decimalPoint+decimalPart+symbol;}
__exports.formatFloat=formatFloat;function formatFloat(value,options={}){if(options.humanReadable){return humanNumber(value,options);}
const grouping=options.grouping||l10n.grouping;const thousandsSep="thousandsSep"in options?options.thousandsSep:l10n.thousandsSep;const decimalPoint="decimalPoint"in options?options.decimalPoint:l10n.decimalPoint;let precision;if(options.digits&&options.digits[1]!==undefined){precision=options.digits[1];}else{precision=2;}
const formatted=value.toFixed(precision).split(".");formatted[0]=insertThousandsSep(formatted[0],thousandsSep,grouping);if(options.trailingZeros===false&&formatted[1]){formatted[1]=formatted[1].replace(/0+$/,"");}
return formatted[1]?formatted.join(decimalPoint):formatted[0];}
return __exports;});;

/* /web/static/src/core/utils/objects.js */
odoo.define('@web/core/utils/objects',[],function(require){'use strict';let __exports={};__exports.shallowEqual=shallowEqual;function shallowEqual(obj1,obj2,comparisonFn=(a,b)=>a===b){if(!obj1||!obj2||typeof obj1!=="object"||typeof obj2!=="object"){return obj1===obj2;}
const obj1Keys=Object.keys(obj1);return(obj1Keys.length===Object.keys(obj2).length&&obj1Keys.every((key)=>comparisonFn(obj1[key],obj2[key])));}
const deepEqual=__exports.deepEqual=(obj1,obj2)=>shallowEqual(obj1,obj2,deepEqual);__exports.deepCopy=deepCopy;function deepCopy(obj){return JSON.parse(JSON.stringify(obj));}
__exports.omit=omit;function omit(object,...properties){const result={};const propertiesSet=new Set(properties);for(const key in object){if(!propertiesSet.has(key)){result[key]=object[key];}}
return result;}
__exports.pick=pick;function pick(object,...properties){return Object.fromEntries(properties.filter((prop)=>prop in object).map((prop)=>[prop,object[prop]]));}
return __exports;});;

/* /web/static/src/core/utils/patch.js */
odoo.define('@web/core/utils/patch',[],function(require){'use strict';let __exports={};const patchDescriptions=new WeakMap();function getPatchDescription(objToPatch){if(!patchDescriptions.has(objToPatch)){patchDescriptions.set(objToPatch,{originalProperties:new Map(),skeleton:Object.create(Object.getPrototypeOf(objToPatch)),extensions:new Set(),});}
return patchDescriptions.get(objToPatch);}
function isClassPrototype(objToPatch){return Object.hasOwn(objToPatch,"constructor")&&objToPatch.constructor?.prototype===objToPatch;}
function findAncestorPropertyDescriptor(objToPatch,key){let descriptor=null;let prototype=objToPatch;do{descriptor=Object.getOwnPropertyDescriptor(prototype,key);prototype=Object.getPrototypeOf(prototype);}while(!descriptor&&prototype);return descriptor;}
__exports.patch=patch;function patch(objToPatch,extension){if(typeof extension==="string"){throw new Error(`Patch "${extension}": Second argument is not the patch name anymore, it should be the object containing the patched properties`);}
const description=getPatchDescription(objToPatch);description.extensions.add(extension);const properties=Object.getOwnPropertyDescriptors(extension);for(const[key,newProperty]of Object.entries(properties)){const oldProperty=Object.getOwnPropertyDescriptor(objToPatch,key);if(oldProperty){Object.defineProperty(description.skeleton,key,oldProperty);}
if(!description.originalProperties.has(key)){description.originalProperties.set(key,oldProperty);}
if(isClassPrototype(objToPatch)){newProperty.enumerable=false;}
if((newProperty.get&&1)^(newProperty.set&&1)){const ancestorProperty=findAncestorPropertyDescriptor(objToPatch,key);newProperty.get=newProperty.get??ancestorProperty?.get;newProperty.set=newProperty.set??ancestorProperty?.set;}
Object.defineProperty(objToPatch,key,newProperty);}
description.skeleton=Object.setPrototypeOf(extension,description.skeleton);return()=>{patchDescriptions.delete(objToPatch);for(const[key,property]of description.originalProperties){if(property){Object.defineProperty(objToPatch,key,property);}else{delete objToPatch[key];}}
description.extensions.delete(extension);for(const extension of description.extensions){patch(objToPatch,extension);}};}
return __exports;});;

/* /web/static/src/core/utils/reactive.js */
odoo.define('@web/core/utils/reactive',['@odoo/owl'],function(require){'use strict';let __exports={};const{reactive}=require("@odoo/owl");const Reactive=__exports.Reactive=class Reactive{constructor(){return reactive(this);}}
__exports.effect=effect;function effect(cb,deps){const reactiveDeps=reactive(deps,()=>{cb(...reactiveDeps);});cb(...reactiveDeps);}
__exports.withComputedProperties=withComputedProperties;function withComputedProperties(obj,sources,descriptor){for(const[key,compute]of Object.entries(descriptor)){effect((obj,sources)=>{obj[key]=compute.call(obj,...sources);},[obj,sources]);}
return obj;}
return __exports;});;

/* /web/static/src/core/utils/render.js */
odoo.define('@web/core/utils/render',['@odoo/owl','@web/core/assets','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{App,blockDom,Component,markup}=require("@odoo/owl");const{templates}=require("@web/core/assets");const{_t}=require("@web/core/l10n/translation");__exports.renderToElement=renderToElement;function renderToElement(template,context={}){const el=render(template,context).firstElementChild;if(el?.nextElementSibling){throw new Error(`The rendered template '${template}' contains multiple root `+`nodes that will be ignored using renderToElement, you should `+`consider using renderToFragment or refactoring the template.`);}
el?.remove();return el;}
__exports.renderToFragment=renderToFragment;function renderToFragment(template,context={}){const frag=document.createDocumentFragment();for(const el of[...render(template,context).children]){frag.appendChild(el);}
return frag;}
__exports.renderToString=renderToString;function renderToString(template,context={}){return render(template,context).innerHTML;}
let app;Object.defineProperty(renderToString,"app",{get:()=>{if(!app){app=new App(Component,{name:"renderToString",templates,translatableAttributes:["data-tooltip"],translateFn:_t,});}
return app;},});function render(template,context={}){const app=renderToString.app;const templateFn=app.getTemplate(template);const bdom=templateFn(context,{});const div=document.createElement("div");blockDom.mount(bdom,div);return div;}
__exports.renderToMarkup=renderToMarkup;function renderToMarkup(template,context={}){return markup(renderToString(template,context));}
return __exports;});;

/* /web/static/src/core/utils/scrolling.js */
odoo.define('@web/core/utils/scrolling',[],function(require){'use strict';let __exports={};__exports.closestScrollableX=closestScrollableX;function closestScrollableX(el){if(!el){return null;}
if(el.scrollWidth>el.clientWidth&&el.clientWidth>0){const overflow=getComputedStyle(el).getPropertyValue("overflow-x");if(/\bauto\b|\bscroll\b/.test(overflow)){return el;}}
return closestScrollableX(el.parentElement);}
__exports.closestScrollableY=closestScrollableY;function closestScrollableY(el){if(!el){return null;}
if(el.scrollHeight>el.clientHeight&&el.clientHeight>0){const overflow=getComputedStyle(el).getPropertyValue("overflow-y");if(/\bauto\b|\bscroll\b/.test(overflow)){return el;}}
return closestScrollableY(el.parentElement);}
__exports.scrollTo=scrollTo;function scrollTo(element,options={behavior:"auto",scrollable:null,isAnchor:false}){const scrollable=closestScrollableY(options.scrollable||element.parentElement);if(scrollable){const scrollBottom=scrollable.getBoundingClientRect().bottom;const scrollTop=scrollable.getBoundingClientRect().top;const elementBottom=element.getBoundingClientRect().bottom;const elementTop=element.getBoundingClientRect().top;if(elementBottom>scrollBottom&&!options.isAnchor){scrollable.scrollTo({top:scrollable.scrollTop+
elementTop-
scrollBottom+
Math.ceil(element.getBoundingClientRect().height),behavior:options.behavior,});}else if(elementTop<scrollTop||options.isAnchor){scrollable.scrollTo({top:scrollable.scrollTop-scrollTop+elementTop,behavior:options.behavior,});if(options.isAnchor){const parentScrollable=closestScrollableY(scrollable.parentElement);if(parentScrollable){scrollTo(scrollable,{behavior:options.behavior,isAnchor:true,scrollable:parentScrollable,});}}}}}
return __exports;});;

/* /web/static/src/core/utils/search.js */
odoo.define('@web/core/utils/search',['@web/core/utils/strings'],function(require){'use strict';let __exports={};const{unaccent}=require("@web/core/utils/strings");function match(pattern,strs){if(!Array.isArray(strs)){strs=[strs];}
let globalScore=0;for(const str of strs){globalScore=Math.max(globalScore,_match(pattern,str));}
return globalScore;}
function _match(pattern,str){let totalScore=0;let currentScore=0;const len=str.length;let patternIndex=0;pattern=unaccent(pattern,false);str=unaccent(str,false);for(let i=0;i<len;i++){if(str[i]===pattern[patternIndex]){patternIndex++;currentScore+=100+currentScore-i/200;}else{currentScore=0;}
totalScore=totalScore+currentScore;}
return patternIndex===pattern.length?totalScore:0;}
__exports.fuzzyLookup=fuzzyLookup;function fuzzyLookup(pattern,list,fn){const results=[];list.forEach((data)=>{const score=match(pattern,fn(data));if(score>0){results.push({score,elem:data});}});results.sort((a,b)=>b.score-a.score);return results.map((r)=>r.elem);}
__exports.fuzzyTest=fuzzyTest;function fuzzyTest(pattern,string){return _match(pattern,string)!==0;}
return __exports;});;

/* /web/static/src/core/utils/sortable.js */
odoo.define('@web/core/utils/sortable',['@web/core/utils/draggable_hook_builder','@web/core/utils/objects'],function(require){'use strict';let __exports={};const{DRAGGED_CLASS,makeDraggableHook:nativeMakeDraggableHook,}=require("@web/core/utils/draggable_hook_builder");const{pick}=require("@web/core/utils/objects");const hookParams={name:"useSortable",acceptedParams:{groups:[String,Function],connectGroups:[Boolean,Function],clone:[Boolean],placeholderClasses:[Object],applyChangeOnDrop:[Boolean],followingElementClasses:[Object],},defaultParams:{connectGroups:false,edgeScrolling:{speed:20,threshold:60},groupSelector:null,clone:true,placeholderClasses:[],applyChangeOnDrop:false,followingElementClasses:[],},onComputeParams({ctx,params}){ctx.groupSelector=params.groups||null;if(ctx.groupSelector){ctx.fullSelector=[ctx.groupSelector,ctx.fullSelector].join(" ");}
ctx.connectGroups=params.connectGroups;ctx.placeholderClone=params.clone;ctx.placeholderClasses=params.placeholderClasses;ctx.applyChangeOnDrop=params.applyChangeOnDrop;ctx.followingElementClasses=params.followingElementClasses;},onDragStart({ctx,addListener,addStyle,callHandler}){const onElementPointerEnter=(ev)=>{const element=ev.currentTarget;if(connectGroups||!groupSelector||current.group===element.closest(groupSelector)){const pos=current.placeHolder.compareDocumentPosition(element);if(pos===Node.DOCUMENT_POSITION_PRECEDING){element.before(current.placeHolder);}else if(pos===Node.DOCUMENT_POSITION_FOLLOWING){element.after(current.placeHolder);}}
callHandler("onElementEnter",{element});};const onElementPointerLeave=(ev)=>{const element=ev.currentTarget;callHandler("onElementLeave",{element});};const onElementComplexPointerEnter=(ev)=>{if(ctx.haveAlreadyChanged){return;}
const element=ev.currentTarget;const siblingArray=[...element.parentElement.children].filter((el)=>el===current.placeHolder||(el.matches(elementSelector)&&!el.classList.contains(DRAGGED_CLASS)));const elementIndex=siblingArray.indexOf(element);const placeholderIndex=siblingArray.indexOf(current.placeHolder);const isDirectSibling=Math.abs(elementIndex-placeholderIndex)===1;if(connectGroups||!groupSelector||current.group===element.closest(groupSelector)){const pos=current.placeHolder.compareDocumentPosition(element);if(isDirectSibling){if(pos===Node.DOCUMENT_POSITION_PRECEDING){element.before(current.placeHolder);ctx.haveAlreadyChanged=true;}else if(pos===Node.DOCUMENT_POSITION_FOLLOWING){element.after(current.placeHolder);ctx.haveAlreadyChanged=true;}}else{if(pos===Node.DOCUMENT_POSITION_FOLLOWING){element.before(current.placeHolder);ctx.haveAlreadyChanged=true;}else if(pos===Node.DOCUMENT_POSITION_PRECEDING){element.after(current.placeHolder);ctx.haveAlreadyChanged=true;}}}
callHandler("onElementEnter",{element});};const onElementComplexPointerLeave=(ev)=>{if(ctx.haveAlreadyChanged){return;}
const element=ev.currentTarget;const elementRect=element.getBoundingClientRect();const relatedElement=ev.relatedTarget;const relatedElementRect=element.getBoundingClientRect();const siblingArray=[...element.parentElement.children].filter((el)=>el===current.placeHolder||(el.matches(elementSelector)&&!el.classList.contains(DRAGGED_CLASS)));const pointerOnSiblings=siblingArray.indexOf(relatedElement)>-1;const elementIndex=siblingArray.indexOf(element);const isFirst=elementIndex===0;const isAbove=relatedElementRect.top<=elementRect.top;const isLast=elementIndex===siblingArray.length-1;const isBelow=relatedElementRect.bottom>=elementRect.bottom;const pos=current.placeHolder.compareDocumentPosition(element);if(!pointerOnSiblings){if(isFirst&&isAbove&&pos===Node.DOCUMENT_POSITION_PRECEDING){element.before(current.placeHolder);ctx.haveAlreadyChanged=true;}else if(isLast&&isBelow&&pos===Node.DOCUMENT_POSITION_FOLLOWING){element.after(current.placeHolder);ctx.haveAlreadyChanged=true;}}
callHandler("onElementLeave",{element});};const onGroupPointerEnter=(ev)=>{const group=ev.currentTarget;group.appendChild(current.placeHolder);callHandler("onGroupEnter",{group});};const onGroupPointerLeave=(ev)=>{const group=ev.currentTarget;callHandler("onGroupLeave",{group});};const{connectGroups,current,elementSelector,groupSelector,ref}=ctx;if(ctx.placeholderClone){const{width,height}=current.elementRect;addStyle(current.placeHolder,{visibility:"hidden",display:"block",width:`${width}px`,height:`${height}px`,});}
if(connectGroups&&groupSelector){for(const siblingGroup of ref.el.querySelectorAll(groupSelector)){addListener(siblingGroup,"pointerenter",onGroupPointerEnter);addListener(siblingGroup,"pointerleave",onGroupPointerLeave);}}
for(const siblingEl of ref.el.querySelectorAll(elementSelector)){if(siblingEl!==current.element&&siblingEl!==current.placeHolder){if(ctx.placeholderClone){addListener(siblingEl,"pointerenter",onElementPointerEnter);addListener(siblingEl,"pointerleave",onElementPointerLeave);}else{addListener(siblingEl,"pointerenter",onElementComplexPointerEnter);addListener(siblingEl,"pointerleave",onElementComplexPointerLeave);}}}
current.element.after(current.placeHolder);return pick(current,"element","group");},onDrag({ctx}){ctx.haveAlreadyChanged=false;},onDragEnd({ctx}){return pick(ctx.current,"element","group");},onDrop({ctx}){const{current,groupSelector}=ctx;const previous=current.placeHolder.previousElementSibling;const next=current.placeHolder.nextElementSibling;if(previous!==current.element&&next!==current.element){const element=current.element;if(ctx.applyChangeOnDrop){if(previous){previous.after(element);}else if(next){next.before(element);}}
return{element,group:current.group,previous,next,parent:groupSelector&&current.placeHolder.closest(groupSelector),};}},onWillStartDrag({ctx,addCleanup}){const{connectGroups,current,groupSelector}=ctx;if(groupSelector){current.group=current.element.closest(groupSelector);if(!connectGroups){current.container=current.group;}}
if(ctx.placeholderClone){current.placeHolder=current.element.cloneNode(false);}else{current.placeHolder=document.createElement("div");}
current.placeHolder.classList.add(...ctx.placeholderClasses);current.element.classList.add(...ctx.followingElementClasses);addCleanup(()=>current.element.classList.remove(...ctx.followingElementClasses));addCleanup(()=>current.placeHolder.remove());return pick(current,"element","group");},};const useSortable=__exports.useSortable=(sortableParams)=>{const{setupHooks}=sortableParams;delete sortableParams.setupHooks;return nativeMakeDraggableHook({...hookParams,setupHooks})(sortableParams);};return __exports;});;

/* /web/static/src/core/utils/sortable_owl.js */
odoo.define('@web/core/utils/sortable_owl',['@odoo/owl','@web/core/utils/timing','@web/core/utils/sortable'],function(require){'use strict';let __exports={};const{onWillUnmount,reactive,useEffect,useExternalListener}=require("@odoo/owl");const{useThrottleForAnimation}=require("@web/core/utils/timing");const{useSortable:nativeUseSortable}=require("@web/core/utils/sortable");__exports.useSortable=useSortable;function useSortable(params){return nativeUseSortable({...params,setupHooks:{addListener:useExternalListener,setup:useEffect,teardown:onWillUnmount,throttle:useThrottleForAnimation,wrapState:reactive,},});}
return __exports;});;

/* /web/static/src/core/utils/sortable_service.js */
odoo.define('@web/core/utils/sortable_service',['@web/core/registry','@web/core/utils/sortable','@web/core/utils/timing','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{useSortable}=require("@web/core/utils/sortable");const{throttleForAnimation}=require("@web/core/utils/timing");const{reactive}=require("@odoo/owl");const DEFAULT_SORTABLE_ID=Symbol.for("defaultSortable");const sortableService=__exports.sortableService={start(){const boundElements=new Map();return{create:(hookParams)=>{const element=hookParams.ref.el;const sortableId=hookParams.sortableId??DEFAULT_SORTABLE_ID;if(boundElements.has(element)){const boundElement=boundElements.get(element);if(sortableId in boundElement){return{enable(){return{cleanup:boundElement[sortableId],};},};}}
const setupFunctions=new Map();const cleanupFunctions=[];const cleanup=()=>{const boundElement=boundElements.get(element);if(sortableId in boundElement){delete boundElement[sortableId];if(boundElement.length===0){boundElements.delete(element);}}
cleanupFunctions.forEach((fn)=>fn());};const setupHooks={wrapState:reactive,throttle:throttleForAnimation,addListener:(el,type,listener)=>{el.addEventListener(type,listener);cleanupFunctions.push(()=>el.removeEventListener(type,listener));},setup:(setupFn,dependenciesFn)=>setupFunctions.set(setupFn,dependenciesFn),teardown:(fn)=>cleanupFunctions.push(fn),};useSortable({setupHooks,...hookParams});const boundElement=boundElements.get(element);if(boundElement){boundElement[sortableId]=cleanup;}else{boundElements.set(element,{[sortableId]:cleanup});}
return{enable(){setupFunctions.forEach((dependenciesFn,setupFn)=>setupFn(...dependenciesFn()));return{cleanup,};},};},};},};registry.category("services").add("sortable",sortableService);return __exports;});;

/* /web/static/src/core/utils/strings.js */
odoo.define('@web/core/utils/strings',[],function(require){'use strict';let __exports={};const nbsp=__exports.nbsp="\u00a0";const escapeMethod=__exports.escapeMethod=Symbol("html");__exports.escape=escape;function escape(str){if(typeof str==="object"&&str[escapeMethod]){return str[escapeMethod]();}else{if(str===undefined){return"";}
if(typeof str==="number"){return String(str);}
[["&","&amp;"],["<","&lt;"],[">","&gt;"],["'","&#x27;"],['"',"&quot;"],["`","&#x60;"],].forEach((pairs)=>{str=String(str).replaceAll(pairs[0],pairs[1]);});return str;}}
__exports.escapeRegExp=escapeRegExp;function escapeRegExp(str){return str.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");}
__exports.intersperse=intersperse;function intersperse(str,indices,separator=""){separator=separator||"";const result=[];let last=str.length;for(let i=0;i<indices.length;++i){let section=indices[i];if(section===-1||last<=0){break;}else if(section===0&&i===0){break;}else if(section===0){section=indices[--i];}
result.push(str.substring(last-section,last));last-=section;}
const s=str.substring(0,last);if(s){result.push(s);}
return result.reverse().join(separator);}
__exports.sprintf=sprintf;function sprintf(s,...values){if(values.length===1&&Object.prototype.toString.call(values[0])==="[object Object]"){const valuesDict=values[0];s=s.replace(/%\(([^)]+)\)s/g,(match,value)=>valuesDict[value]);}else if(values.length>0){s=s.replace(/%s/g,()=>values.shift());}
return s;}
__exports.capitalize=capitalize;function capitalize(s){return s?s[0].toUpperCase()+s.slice(1):"";}
const diacriticsMap={'\u0041':'A','\u24B6':'A','\uFF21':'A','\u00C0':'A','\u00C1':'A','\u00C2':'A','\u1EA6':'A','\u1EA4':'A','\u1EAA':'A','\u1EA8':'A','\u00C3':'A','\u0100':'A','\u0102':'A','\u1EB0':'A','\u1EAE':'A','\u1EB4':'A','\u1EB2':'A','\u0226':'A','\u01E0':'A','\u00C4':'A','\u01DE':'A','\u1EA2':'A','\u00C5':'A','\u01FA':'A','\u01CD':'A','\u0200':'A','\u0202':'A','\u1EA0':'A','\u1EAC':'A','\u1EB6':'A','\u1E00':'A','\u0104':'A','\u023A':'A','\u2C6F':'A','\uA732':'AA','\u00C6':'AE','\u01FC':'AE','\u01E2':'AE','\uA734':'AO','\uA736':'AU','\uA738':'AV','\uA73A':'AV','\uA73C':'AY','\u0042':'B','\u24B7':'B','\uFF22':'B','\u1E02':'B','\u1E04':'B','\u1E06':'B','\u0243':'B','\u0182':'B','\u0181':'B','\u0043':'C','\u24B8':'C','\uFF23':'C','\u0106':'C','\u0108':'C','\u010A':'C','\u010C':'C','\u00C7':'C','\u1E08':'C','\u0187':'C','\u023B':'C','\uA73E':'C','\u0044':'D','\u24B9':'D','\uFF24':'D','\u1E0A':'D','\u010E':'D','\u1E0C':'D','\u1E10':'D','\u1E12':'D','\u1E0E':'D','\u0110':'D','\u018B':'D','\u018A':'D','\u0189':'D','\uA779':'D','\u01F1':'DZ','\u01C4':'DZ','\u01F2':'Dz','\u01C5':'Dz','\u0045':'E','\u24BA':'E','\uFF25':'E','\u00C8':'E','\u00C9':'E','\u00CA':'E','\u1EC0':'E','\u1EBE':'E','\u1EC4':'E','\u1EC2':'E','\u1EBC':'E','\u0112':'E','\u1E14':'E','\u1E16':'E','\u0114':'E','\u0116':'E','\u00CB':'E','\u1EBA':'E','\u011A':'E','\u0204':'E','\u0206':'E','\u1EB8':'E','\u1EC6':'E','\u0228':'E','\u1E1C':'E','\u0118':'E','\u1E18':'E','\u1E1A':'E','\u0190':'E','\u018E':'E','\u0046':'F','\u24BB':'F','\uFF26':'F','\u1E1E':'F','\u0191':'F','\uA77B':'F','\u0047':'G','\u24BC':'G','\uFF27':'G','\u01F4':'G','\u011C':'G','\u1E20':'G','\u011E':'G','\u0120':'G','\u01E6':'G','\u0122':'G','\u01E4':'G','\u0193':'G','\uA7A0':'G','\uA77D':'G','\uA77E':'G','\u0048':'H','\u24BD':'H','\uFF28':'H','\u0124':'H','\u1E22':'H','\u1E26':'H','\u021E':'H','\u1E24':'H','\u1E28':'H','\u1E2A':'H','\u0126':'H','\u2C67':'H','\u2C75':'H','\uA78D':'H','\u0049':'I','\u24BE':'I','\uFF29':'I','\u00CC':'I','\u00CD':'I','\u00CE':'I','\u0128':'I','\u012A':'I','\u012C':'I','\u0130':'I','\u00CF':'I','\u1E2E':'I','\u1EC8':'I','\u01CF':'I','\u0208':'I','\u020A':'I','\u1ECA':'I','\u012E':'I','\u1E2C':'I','\u0197':'I','\u004A':'J','\u24BF':'J','\uFF2A':'J','\u0134':'J','\u0248':'J','\u004B':'K','\u24C0':'K','\uFF2B':'K','\u1E30':'K','\u01E8':'K','\u1E32':'K','\u0136':'K','\u1E34':'K','\u0198':'K','\u2C69':'K','\uA740':'K','\uA742':'K','\uA744':'K','\uA7A2':'K','\u004C':'L','\u24C1':'L','\uFF2C':'L','\u013F':'L','\u0139':'L','\u013D':'L','\u1E36':'L','\u1E38':'L','\u013B':'L','\u1E3C':'L','\u1E3A':'L','\u0141':'L','\u023D':'L','\u2C62':'L','\u2C60':'L','\uA748':'L','\uA746':'L','\uA780':'L','\u01C7':'LJ','\u01C8':'Lj','\u004D':'M','\u24C2':'M','\uFF2D':'M','\u1E3E':'M','\u1E40':'M','\u1E42':'M','\u2C6E':'M','\u019C':'M','\u004E':'N','\u24C3':'N','\uFF2E':'N','\u01F8':'N','\u0143':'N','\u00D1':'N','\u1E44':'N','\u0147':'N','\u1E46':'N','\u0145':'N','\u1E4A':'N','\u1E48':'N','\u0220':'N','\u019D':'N','\uA790':'N','\uA7A4':'N','\u01CA':'NJ','\u01CB':'Nj','\u004F':'O','\u24C4':'O','\uFF2F':'O','\u00D2':'O','\u00D3':'O','\u00D4':'O','\u1ED2':'O','\u1ED0':'O','\u1ED6':'O','\u1ED4':'O','\u00D5':'O','\u1E4C':'O','\u022C':'O','\u1E4E':'O','\u014C':'O','\u1E50':'O','\u1E52':'O','\u014E':'O','\u022E':'O','\u0230':'O','\u00D6':'O','\u022A':'O','\u1ECE':'O','\u0150':'O','\u01D1':'O','\u020C':'O','\u020E':'O','\u01A0':'O','\u1EDC':'O','\u1EDA':'O','\u1EE0':'O','\u1EDE':'O','\u1EE2':'O','\u1ECC':'O','\u1ED8':'O','\u01EA':'O','\u01EC':'O','\u00D8':'O','\u01FE':'O','\u0186':'O','\u019F':'O','\uA74A':'O','\uA74C':'O','\u01A2':'OI','\uA74E':'OO','\u0222':'OU','\u0050':'P','\u24C5':'P','\uFF30':'P','\u1E54':'P','\u1E56':'P','\u01A4':'P','\u2C63':'P','\uA750':'P','\uA752':'P','\uA754':'P','\u0051':'Q','\u24C6':'Q','\uFF31':'Q','\uA756':'Q','\uA758':'Q','\u024A':'Q','\u0052':'R','\u24C7':'R','\uFF32':'R','\u0154':'R','\u1E58':'R','\u0158':'R','\u0210':'R','\u0212':'R','\u1E5A':'R','\u1E5C':'R','\u0156':'R','\u1E5E':'R','\u024C':'R','\u2C64':'R','\uA75A':'R','\uA7A6':'R','\uA782':'R','\u0053':'S','\u24C8':'S','\uFF33':'S','\u1E9E':'S','\u015A':'S','\u1E64':'S','\u015C':'S','\u1E60':'S','\u0160':'S','\u1E66':'S','\u1E62':'S','\u1E68':'S','\u0218':'S','\u015E':'S','\u2C7E':'S','\uA7A8':'S','\uA784':'S','\u0054':'T','\u24C9':'T','\uFF34':'T','\u1E6A':'T','\u0164':'T','\u1E6C':'T','\u021A':'T','\u0162':'T','\u1E70':'T','\u1E6E':'T','\u0166':'T','\u01AC':'T','\u01AE':'T','\u023E':'T','\uA786':'T','\uA728':'TZ','\u0055':'U','\u24CA':'U','\uFF35':'U','\u00D9':'U','\u00DA':'U','\u00DB':'U','\u0168':'U','\u1E78':'U','\u016A':'U','\u1E7A':'U','\u016C':'U','\u00DC':'U','\u01DB':'U','\u01D7':'U','\u01D5':'U','\u01D9':'U','\u1EE6':'U','\u016E':'U','\u0170':'U','\u01D3':'U','\u0214':'U','\u0216':'U','\u01AF':'U','\u1EEA':'U','\u1EE8':'U','\u1EEE':'U','\u1EEC':'U','\u1EF0':'U','\u1EE4':'U','\u1E72':'U','\u0172':'U','\u1E76':'U','\u1E74':'U','\u0244':'U','\u0056':'V','\u24CB':'V','\uFF36':'V','\u1E7C':'V','\u1E7E':'V','\u01B2':'V','\uA75E':'V','\u0245':'V','\uA760':'VY','\u0057':'W','\u24CC':'W','\uFF37':'W','\u1E80':'W','\u1E82':'W','\u0174':'W','\u1E86':'W','\u1E84':'W','\u1E88':'W','\u2C72':'W','\u0058':'X','\u24CD':'X','\uFF38':'X','\u1E8A':'X','\u1E8C':'X','\u0059':'Y','\u24CE':'Y','\uFF39':'Y','\u1EF2':'Y','\u00DD':'Y','\u0176':'Y','\u1EF8':'Y','\u0232':'Y','\u1E8E':'Y','\u0178':'Y','\u1EF6':'Y','\u1EF4':'Y','\u01B3':'Y','\u024E':'Y','\u1EFE':'Y','\u005A':'Z','\u24CF':'Z','\uFF3A':'Z','\u0179':'Z','\u1E90':'Z','\u017B':'Z','\u017D':'Z','\u1E92':'Z','\u1E94':'Z','\u01B5':'Z','\u0224':'Z','\u2C7F':'Z','\u2C6B':'Z','\uA762':'Z','\u0061':'a','\u24D0':'a','\uFF41':'a','\u1E9A':'a','\u00E0':'a','\u00E1':'a','\u00E2':'a','\u1EA7':'a','\u1EA5':'a','\u1EAB':'a','\u1EA9':'a','\u00E3':'a','\u0101':'a','\u0103':'a','\u1EB1':'a','\u1EAF':'a','\u1EB5':'a','\u1EB3':'a','\u0227':'a','\u01E1':'a','\u00E4':'a','\u01DF':'a','\u1EA3':'a','\u00E5':'a','\u01FB':'a','\u01CE':'a','\u0201':'a','\u0203':'a','\u1EA1':'a','\u1EAD':'a','\u1EB7':'a','\u1E01':'a','\u0105':'a','\u2C65':'a','\u0250':'a','\uA733':'aa','\u00E6':'ae','\u01FD':'ae','\u01E3':'ae','\uA735':'ao','\uA737':'au','\uA739':'av','\uA73B':'av','\uA73D':'ay','\u0062':'b','\u24D1':'b','\uFF42':'b','\u1E03':'b','\u1E05':'b','\u1E07':'b','\u0180':'b','\u0183':'b','\u0253':'b','\u0063':'c','\u24D2':'c','\uFF43':'c','\u0107':'c','\u0109':'c','\u010B':'c','\u010D':'c','\u00E7':'c','\u1E09':'c','\u0188':'c','\u023C':'c','\uA73F':'c','\u2184':'c','\u0064':'d','\u24D3':'d','\uFF44':'d','\u1E0B':'d','\u010F':'d','\u1E0D':'d','\u1E11':'d','\u1E13':'d','\u1E0F':'d','\u0111':'d','\u018C':'d','\u0256':'d','\u0257':'d','\uA77A':'d','\u01F3':'dz','\u01C6':'dz','\u0065':'e','\u24D4':'e','\uFF45':'e','\u00E8':'e','\u00E9':'e','\u00EA':'e','\u1EC1':'e','\u1EBF':'e','\u1EC5':'e','\u1EC3':'e','\u1EBD':'e','\u0113':'e','\u1E15':'e','\u1E17':'e','\u0115':'e','\u0117':'e','\u00EB':'e','\u1EBB':'e','\u011B':'e','\u0205':'e','\u0207':'e','\u1EB9':'e','\u1EC7':'e','\u0229':'e','\u1E1D':'e','\u0119':'e','\u1E19':'e','\u1E1B':'e','\u0247':'e','\u025B':'e','\u01DD':'e','\u0066':'f','\u24D5':'f','\uFF46':'f','\u1E1F':'f','\u0192':'f','\uA77C':'f','\u0067':'g','\u24D6':'g','\uFF47':'g','\u01F5':'g','\u011D':'g','\u1E21':'g','\u011F':'g','\u0121':'g','\u01E7':'g','\u0123':'g','\u01E5':'g','\u0260':'g','\uA7A1':'g','\u1D79':'g','\uA77F':'g','\u0068':'h','\u24D7':'h','\uFF48':'h','\u0125':'h','\u1E23':'h','\u1E27':'h','\u021F':'h','\u1E25':'h','\u1E29':'h','\u1E2B':'h','\u1E96':'h','\u0127':'h','\u2C68':'h','\u2C76':'h','\u0265':'h','\u0195':'hv','\u0069':'i','\u24D8':'i','\uFF49':'i','\u00EC':'i','\u00ED':'i','\u00EE':'i','\u0129':'i','\u012B':'i','\u012D':'i','\u00EF':'i','\u1E2F':'i','\u1EC9':'i','\u01D0':'i','\u0209':'i','\u020B':'i','\u1ECB':'i','\u012F':'i','\u1E2D':'i','\u0268':'i','\u0131':'i','\u006A':'j','\u24D9':'j','\uFF4A':'j','\u0135':'j','\u01F0':'j','\u0249':'j','\u006B':'k','\u24DA':'k','\uFF4B':'k','\u1E31':'k','\u01E9':'k','\u1E33':'k','\u0137':'k','\u1E35':'k','\u0199':'k','\u2C6A':'k','\uA741':'k','\uA743':'k','\uA745':'k','\uA7A3':'k','\u006C':'l','\u24DB':'l','\uFF4C':'l','\u0140':'l','\u013A':'l','\u013E':'l','\u1E37':'l','\u1E39':'l','\u013C':'l','\u1E3D':'l','\u1E3B':'l','\u017F':'l','\u0142':'l','\u019A':'l','\u026B':'l','\u2C61':'l','\uA749':'l','\uA781':'l','\uA747':'l','\u01C9':'lj','\u006D':'m','\u24DC':'m','\uFF4D':'m','\u1E3F':'m','\u1E41':'m','\u1E43':'m','\u0271':'m','\u026F':'m','\u006E':'n','\u24DD':'n','\uFF4E':'n','\u01F9':'n','\u0144':'n','\u00F1':'n','\u1E45':'n','\u0148':'n','\u1E47':'n','\u0146':'n','\u1E4B':'n','\u1E49':'n','\u019E':'n','\u0272':'n','\u0149':'n','\uA791':'n','\uA7A5':'n','\u01CC':'nj','\u006F':'o','\u24DE':'o','\uFF4F':'o','\u00F2':'o','\u00F3':'o','\u00F4':'o','\u1ED3':'o','\u1ED1':'o','\u1ED7':'o','\u1ED5':'o','\u00F5':'o','\u1E4D':'o','\u022D':'o','\u1E4F':'o','\u014D':'o','\u1E51':'o','\u1E53':'o','\u014F':'o','\u022F':'o','\u0231':'o','\u00F6':'o','\u022B':'o','\u1ECF':'o','\u0151':'o','\u01D2':'o','\u020D':'o','\u020F':'o','\u01A1':'o','\u1EDD':'o','\u1EDB':'o','\u1EE1':'o','\u1EDF':'o','\u1EE3':'o','\u1ECD':'o','\u1ED9':'o','\u01EB':'o','\u01ED':'o','\u00F8':'o','\u01FF':'o','\u0254':'o','\uA74B':'o','\uA74D':'o','\u0275':'o','\u01A3':'oi','\u0223':'ou','\uA74F':'oo','\u0070':'p','\u24DF':'p','\uFF50':'p','\u1E55':'p','\u1E57':'p','\u01A5':'p','\u1D7D':'p','\uA751':'p','\uA753':'p','\uA755':'p','\u0071':'q','\u24E0':'q','\uFF51':'q','\u024B':'q','\uA757':'q','\uA759':'q','\u0072':'r','\u24E1':'r','\uFF52':'r','\u0155':'r','\u1E59':'r','\u0159':'r','\u0211':'r','\u0213':'r','\u1E5B':'r','\u1E5D':'r','\u0157':'r','\u1E5F':'r','\u024D':'r','\u027D':'r','\uA75B':'r','\uA7A7':'r','\uA783':'r','\u0073':'s','\u24E2':'s','\uFF53':'s','\u00DF':'s','\u015B':'s','\u1E65':'s','\u015D':'s','\u1E61':'s','\u0161':'s','\u1E67':'s','\u1E63':'s','\u1E69':'s','\u0219':'s','\u015F':'s','\u023F':'s','\uA7A9':'s','\uA785':'s','\u1E9B':'s','\u0074':'t','\u24E3':'t','\uFF54':'t','\u1E6B':'t','\u1E97':'t','\u0165':'t','\u1E6D':'t','\u021B':'t','\u0163':'t','\u1E71':'t','\u1E6F':'t','\u0167':'t','\u01AD':'t','\u0288':'t','\u2C66':'t','\uA787':'t','\uA729':'tz','\u0075':'u','\u24E4':'u','\uFF55':'u','\u00F9':'u','\u00FA':'u','\u00FB':'u','\u0169':'u','\u1E79':'u','\u016B':'u','\u1E7B':'u','\u016D':'u','\u00FC':'u','\u01DC':'u','\u01D8':'u','\u01D6':'u','\u01DA':'u','\u1EE7':'u','\u016F':'u','\u0171':'u','\u01D4':'u','\u0215':'u','\u0217':'u','\u01B0':'u','\u1EEB':'u','\u1EE9':'u','\u1EEF':'u','\u1EED':'u','\u1EF1':'u','\u1EE5':'u','\u1E73':'u','\u0173':'u','\u1E77':'u','\u1E75':'u','\u0289':'u','\u0076':'v','\u24E5':'v','\uFF56':'v','\u1E7D':'v','\u1E7F':'v','\u028B':'v','\uA75F':'v','\u028C':'v','\uA761':'vy','\u0077':'w','\u24E6':'w','\uFF57':'w','\u1E81':'w','\u1E83':'w','\u0175':'w','\u1E87':'w','\u1E85':'w','\u1E98':'w','\u1E89':'w','\u2C73':'w','\u0078':'x','\u24E7':'x','\uFF58':'x','\u1E8B':'x','\u1E8D':'x','\u0079':'y','\u24E8':'y','\uFF59':'y','\u1EF3':'y','\u00FD':'y','\u0177':'y','\u1EF9':'y','\u0233':'y','\u1E8F':'y','\u00FF':'y','\u1EF7':'y','\u1E99':'y','\u1EF5':'y','\u01B4':'y','\u024F':'y','\u1EFF':'y','\u007A':'z','\u24E9':'z','\uFF5A':'z','\u017A':'z','\u1E91':'z','\u017C':'z','\u017E':'z','\u1E93':'z','\u1E95':'z','\u01B6':'z','\u0225':'z','\u0240':'z','\u2C6C':'z','\uA763':'z',};__exports.unaccent=unaccent;function unaccent(str,caseSensitive){str=str.replace(/[^\u0000-\u007E]/g,function(accented){return diacriticsMap[accented]||accented;});return caseSensitive?str:str.toLowerCase();}
__exports.isEmail=isEmail;function isEmail(value){const re=/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;return re.test(value);}
return __exports;});;

/* /web/static/src/core/utils/timing.js */
odoo.define('@web/core/utils/timing',['@web/core/browser/browser','@odoo/owl'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{onWillUnmount,useComponent}=require("@odoo/owl");__exports.batched=batched;function batched(callback,synchronize=()=>Promise.resolve()){let scheduled=false;return async(...args)=>{if(!scheduled){scheduled=true;await synchronize();scheduled=false;callback(...args);}};}
__exports.debounce=debounce;function debounce(func,delay,options){let handle;const funcName=func.name?func.name+" (debounce)":"debounce";const useAnimationFrame=delay==="animationFrame";const setFnName=useAnimationFrame?"requestAnimationFrame":"setTimeout";const clearFnName=useAnimationFrame?"cancelAnimationFrame":"clearTimeout";let lastArgs;let leading=false;let trailing=true;if(typeof options==="boolean"){leading=options;trailing=!options;}else if(options){leading=options.leading??leading;trailing=options.trailing??trailing;}
return Object.assign({[funcName](...args){return new Promise((resolve)=>{if(leading&&!handle){Promise.resolve(func.apply(this,args)).then(resolve);}else{lastArgs=args;}
browser[clearFnName](handle);handle=browser[setFnName](()=>{handle=null;if(trailing&&lastArgs){Promise.resolve(func.apply(this,lastArgs)).then(resolve);lastArgs=null;}},delay);});},}[funcName],{cancel(execNow=false){browser[clearFnName](handle);if(execNow&&lastArgs){func.apply(this,lastArgs);}},});}
__exports.setRecurringAnimationFrame=setRecurringAnimationFrame;function setRecurringAnimationFrame(callback){const handler=(timestamp)=>{callback(timestamp-lastTimestamp);lastTimestamp=timestamp;handle=browser.requestAnimationFrame(handler);};const stop=()=>{browser.cancelAnimationFrame(handle);};let lastTimestamp=browser.performance.now();let handle=browser.requestAnimationFrame(handler);return stop;}
__exports.throttleForAnimation=throttleForAnimation;function throttleForAnimation(func){let handle=null;const calls=new Set();const funcName=func.name?`${func.name} (throttleForAnimation)`:"throttleForAnimation";const pending=()=>{if(calls.size){handle=browser.requestAnimationFrame(pending);const{args,resolve}=[...calls].pop();calls.clear();Promise.resolve(func.apply(this,args)).then(resolve);}else{handle=null;}};return Object.assign({[funcName](...args){return new Promise((resolve)=>{const isNew=handle===null;if(isNew){handle=browser.requestAnimationFrame(pending);Promise.resolve(func.apply(this,args)).then(resolve);}else{calls.add({args,resolve});}});},}[funcName],{cancel(){browser.cancelAnimationFrame(handle);calls.clear();handle=null;},});}
__exports.useDebounced=useDebounced;function useDebounced(callback,delay,{execBeforeUnmount=false,immediate=false}={}){const component=useComponent();const debounced=debounce(callback.bind(component),delay,immediate);onWillUnmount(()=>debounced.cancel(execBeforeUnmount));return debounced;}
__exports.useThrottleForAnimation=useThrottleForAnimation;function useThrottleForAnimation(func){const component=useComponent();const throttledForAnimation=throttleForAnimation(func.bind(component));onWillUnmount(()=>throttledForAnimation.cancel());return throttledForAnimation;}
return __exports;});;

/* /web/static/src/core/utils/ui.js */
odoo.define('@web/core/utils/ui',[],function(require){'use strict';let __exports={};__exports.closest=closest;function closest(elements,targetPos){let closestEl=null;let closestDistance=Infinity;for(const el of elements){const rect=el.getBoundingClientRect();const distance=getQuadrance(rect,targetPos);if(!closestEl||distance<closestDistance){closestEl=el;closestDistance=distance;}}
return closestEl;}
__exports.isVisible=isVisible;function isVisible(el){if(el===document||el===window){return true;}
if(!el){return false;}
let _isVisible=false;if("offsetWidth"in el&&"offsetHeight"in el){_isVisible=el.offsetWidth>0&&el.offsetHeight>0;}else if("getBoundingClientRect"in el){const rect=el.getBoundingClientRect();_isVisible=rect.width>0&&rect.height>0;}
if(!_isVisible&&getComputedStyle(el).display==="contents"){for(const child of el.children){if(isVisible(child)){return true;}}}
return _isVisible;}
__exports._legacyIsVisible=_legacyIsVisible;function _legacyIsVisible(el){if(el===document||el===window){return true;}
if(!el){return false;}
let _isVisible=false;if("offsetWidth"in el&&"offsetHeight"in el){_isVisible=el.offsetWidth>0||el.offsetHeight>0;}else if("getBoundingClientRect"in el){const rect=el.getBoundingClientRect();_isVisible=rect.width>0||rect.height>0;}
if(!_isVisible&&getComputedStyle(el).display==="contents"){for(const child of el.children){if(isVisible(child)){return true;}}}
return _isVisible;}
__exports.getQuadrance=getQuadrance;function getQuadrance(rect,pos){let q=0;if(pos.x<rect.x){q+=(rect.x-pos.x)**2;}else if(rect.x+rect.width<pos.x){q+=(pos.x-(rect.x+rect.width))**2;}
if(pos.y<rect.y){q+=(rect.y-pos.y)**2;}else if(rect.y+rect.height<pos.y){q+=(pos.y-(rect.y+rect.height))**2;}
return q;}
__exports.getVisibleElements=getVisibleElements;function getVisibleElements(activeElement,selector){const visibleElements=[];const elements=activeElement.querySelectorAll(selector);for(const el of elements){if(isVisible(el)){visibleElements.push(el);}}
return visibleElements;}
__exports.touching=touching;function touching(elements,targetRect){const r1={x:0,y:0,width:0,height:0,...targetRect};return[...elements].filter((el)=>{const r2=el.getBoundingClientRect();return(r2.x+r2.width>=r1.x&&r2.x<=r1.x+r1.width&&r2.y+r2.height>=r1.y&&r2.y<=r1.y+r1.height);});}
const TABABLE_SELECTOR=["[tabindex]","a","area","button","frame","iframe","input","object","select","textarea","details > summary:nth-child(1)",].map((sel)=>`${sel}:not([tabindex="-1"]):not(:disabled)`).join(",");__exports.getTabableElements=getTabableElements;function getTabableElements(container=document.body){const elements=[...container.querySelectorAll(TABABLE_SELECTOR)].filter(isVisible);const byTabIndex={};for(const el of[...elements]){if(!byTabIndex[el.tabIndex]){byTabIndex[el.tabIndex]=[];}
byTabIndex[el.tabIndex].push(el);}
const withTabIndexZero=byTabIndex[0]||[];delete byTabIndex[0];return[...Object.values(byTabIndex).flat(),...withTabIndexZero];}
__exports.getNextTabableElement=getNextTabableElement;function getNextTabableElement(container=document.body){const tabableElements=getTabableElements(container);const index=tabableElements.indexOf(document.activeElement);return index===-1?tabableElements[0]:tabableElements[index+1]||null;}
__exports.getPreviousTabableElement=getPreviousTabableElement;function getPreviousTabableElement(container=document.body){const tabableElements=getTabableElements(container);const index=tabableElements.indexOf(document.activeElement);return index===-1?tabableElements[tabableElements.length-1]:tabableElements[index-1]||null;}
return __exports;});;

/* /web/static/src/core/utils/urls.js */
odoo.define('@web/core/utils/urls',['@web/session','@web/core/browser/browser'],function(require){'use strict';let __exports={};const{session}=require("@web/session");const{browser}=require("@web/core/browser/browser");const RedirectionError=__exports.RedirectionError=class RedirectionError extends Error{}
__exports.objectToUrlEncodedString=objectToUrlEncodedString;function objectToUrlEncodedString(obj){return Object.entries(obj).map(([k,v])=>`${encodeURIComponent(k)}=${encodeURIComponent(v || "")}`).join("&");}
__exports.getOrigin=getOrigin;function getOrigin(origin){if(origin){origin=origin.replace(/\/+$/,"");}else{const{host,protocol}=browser.location;origin=`${protocol}//${host}`;}
return origin;}
__exports.url=url;function url(route,queryParams,options={}){const origin=getOrigin(options.origin??session.origin);if(!route){return origin;}
let queryString=objectToUrlEncodedString(queryParams||{});queryString=queryString.length>0?`?${queryString}`:queryString;let prefix=["http://","https://","//"].some((el)=>route.length>=el.length&&route.slice(0,el.length)===el);prefix=prefix?"":origin;return`${prefix}${route}${queryString}`;}
__exports.getDataURLFromFile=getDataURLFromFile;function getDataURLFromFile(file){if(!file){return Promise.reject();}
return new Promise((resolve,reject)=>{const reader=new FileReader();reader.addEventListener("load",()=>{if(reader.result==="data:"){resolve(`data:${file.type};base64,`);}else{resolve(reader.result);}});reader.addEventListener("abort",reject);reader.addEventListener("error",reject);reader.readAsDataURL(file);});}
__exports.redirect=redirect;function redirect(url){const{origin,pathname}=browser.location;const _url=new URL(url,`${origin}${pathname}`);if(_url.origin!==origin){throw new RedirectionError("Can't redirect to another origin");}
browser.location=_url.href;}
return __exports;});;

/* /web/static/src/core/utils/xml.js */
odoo.define('@web/core/utils/xml',[],function(require){'use strict';let __exports={};const serializer=new XMLSerializer();const parser=new DOMParser();const xmlDocument=parser.parseFromString("<templates/>","text/xml");function hasParsingError(parsedDocument){return parsedDocument.getElementsByTagName("parsererror").length>0;}
__exports.parseXML=parseXML;function parseXML(str){const xml=parser.parseFromString(str,"text/xml");if(hasParsingError(xml)){throw new Error(`An error occured while parsing ${str}: ${xml.getElementsByTagName("parsererror")}`);}
return xml.documentElement;}
__exports.serializeXML=serializeXML;function serializeXML(xml){return serializer.serializeToString(xml);}
__exports.visitXML=visitXML;function visitXML(xml,callback){const visit=(el)=>{if(el){let didVisitChildren=false;const visitChildren=()=>{for(const child of el.children){visit(child);}
didVisitChildren=true;};const shouldVisitChildren=callback(el,visitChildren);if(shouldVisitChildren!==false&&!didVisitChildren){visitChildren();}}};const xmlDoc=typeof xml==="string"?parseXML(xml):xml;visit(xmlDoc);}
__exports.append=append;function append(parent,node){const nodes=Array.isArray(node)?node:[node];parent.append(...nodes.filter(Boolean));return parent;}
__exports.combineAttributes=combineAttributes;function combineAttributes(el,attr,parts,glue=" "){const allValues=[];if(el.hasAttribute(attr)){allValues.push(el.getAttribute(attr));}
parts=Array.isArray(parts)?parts:[parts];parts=parts.filter((part)=>!!part);allValues.push(...parts);el.setAttribute(attr,allValues.join(glue));}
__exports.createElement=createElement;function createElement(tagName,...args){const el=xmlDocument.createElement(tagName);for(const arg of args){if(!arg){continue;}
if(Symbol.iterator in arg){el.append(...arg);}else if(typeof arg==="object"){for(const name in arg){el.setAttribute(name,arg[name]);}}}
return el;}
__exports.createTextNode=createTextNode;function createTextNode(data){return xmlDocument.createTextNode(data);}
__exports.extractAttributes=extractAttributes;function extractAttributes(el,attributes){const attrs=Object.create(null);for(const attr of attributes){attrs[attr]=el.getAttribute(attr)||"";el.removeAttribute(attr);}
return attrs;}
__exports.getTag=getTag;function getTag(node,lower=false){const tag=(node&&node.nodeName)||"";return lower?tag.toLowerCase():tag;}
__exports.setAttributes=setAttributes;function setAttributes(node,attributes){for(const[name,value]of Object.entries(attributes)){node.setAttribute(name,value);}}
return __exports;});;

/* /web/static/src/core/virtual_hook.js */
odoo.define('@web/core/virtual_hook',['@odoo/owl','@web/core/utils/arrays','@web/core/utils/timing'],function(require){'use strict';let __exports={};const{onWillRender,onWillStart,toRaw,useEffect,useExternalListener,useState,}=require("@odoo/owl");const{shallowEqual}=require("@web/core/utils/arrays");const{useThrottleForAnimation}=require("@web/core/utils/timing");__exports.useVirtual=useVirtual;function useVirtual({getItems,scrollableRef,initialScroll,getItemHeight}){const computeVirtualItems=()=>{const{items,scroll}=current;const yStart=scroll.top-window.innerHeight;const yEnd=scroll.top+2*window.innerHeight;let[startIndex,endIndex]=[0,0];let currentTop=0;for(const item of items){const height=getItemHeight(item);if(currentTop+height<yStart){startIndex++;endIndex++;}else if(currentTop+height<=yEnd+height){endIndex++;}else{break;}
currentTop+=height;}
const prevItems=toRaw(virtualItems);const newItems=items.slice(startIndex,endIndex);if(!shallowEqual(prevItems,newItems)){virtualItems.length=0;virtualItems.push(...newItems);}};const current={items:getItems(),scroll:{top:0,...initialScroll},};const virtualItems=useState([]);onWillStart(computeVirtualItems);onWillRender(()=>{const previousItems=current.items;current.items=getItems();if(!shallowEqual(previousItems,current.items)){computeVirtualItems();}});const throttledCompute=useThrottleForAnimation(computeVirtualItems);const scrollListener=(ev)=>{current.scroll.top=ev.target.scrollTop;throttledCompute();};useExternalListener(window,"resize",throttledCompute);useEffect((el)=>{if(el){el.addEventListener("scroll",scrollListener);return()=>el.removeEventListener("scroll",scrollListener);}},()=>[scrollableRef.el]);return virtualItems;}
return __exports;});;

/* /web/static/src/views/fields/formatters.js */
odoo.define('@web/views/fields/formatters',['@web/core/l10n/dates','@web/core/l10n/localization','@web/core/l10n/translation','@web/core/registry','@web/core/utils/strings','@web/core/utils/binary','@web/core/utils/numbers','@odoo/owl','@web/core/currency'],function(require){'use strict';let __exports={};const{formatDate,formatDateTime}=require("@web/core/l10n/dates");const{localization:l10n}=require("@web/core/l10n/localization");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{escape}=require("@web/core/utils/strings");const{isBinarySize}=require("@web/core/utils/binary");const{formatFloat:formatFloatNumber,humanNumber,insertThousandsSep,}=require("@web/core/utils/numbers");const{markup}=require("@odoo/owl");const{formatCurrency}=require("@web/core/currency");function humanSize(value){if(!value){return"";}
const suffix=value<1024?" "+_t("Bytes"):"b";return(humanNumber(value,{decimals:2,})+suffix);}
__exports.formatBinary=formatBinary;function formatBinary(value){if(!isBinarySize(value)){return humanSize(value.length/1.37);}
return value;}
__exports.formatBoolean=formatBoolean;function formatBoolean(value){return markup(`
        <div class="o-checkbox d-inline-block me-2">
            <input id="boolean_checkbox" type="checkbox" class="form-check-input" disabled ${
                value ? "checked" : ""
            }/>
            <label for="boolean_checkbox" class="form-check-label"/>
        </div>`);}
__exports.formatChar=formatChar;function formatChar(value,options){if(options&&options.isPassword){return"*".repeat(value?value.length:0);}
if(options&&options.escape){value=escape(value);}
return value;}
__exports.formatFloat=formatFloat;function formatFloat(value,options={}){if(value===false){return"";}
return formatFloatNumber(value,options);}
__exports.formatFloatFactor=formatFloatFactor;function formatFloatFactor(value,options={}){if(value===false){return"";}
const factor=options.factor||1;return formatFloatNumber(value*factor,options);}
__exports.formatFloatTime=formatFloatTime;function formatFloatTime(value,options={}){if(value===false){return"";}
const isNegative=value<0;value=Math.abs(value);let hour=Math.floor(value);const milliSecLeft=Math.round(value*3600000)-hour*3600000;let min=milliSecLeft/60000;if(options.displaySeconds){min=Math.floor(min);}else{min=Math.round(min);}
if(min===60){min=0;hour=hour+1;}
min=String(min).padStart(2,"0");if(!options.noLeadingZeroHour){hour=String(hour).padStart(2,"0");}
let sec="";if(options.displaySeconds){sec=":"+String(Math.floor((milliSecLeft%60000)/1000)).padStart(2,"0");}
return`${isNegative ? "-" : ""}${hour}:${min}${sec}`;}
__exports.formatInteger=formatInteger;function formatInteger(value,options={}){if(value===false||value===null){return"";}
if(options.isPassword){return"*".repeat(value.length);}
if(options.humanReadable){return humanNumber(value,options);}
const grouping=options.grouping||l10n.grouping;const thousandsSep="thousandsSep"in options?options.thousandsSep:l10n.thousandsSep;return insertThousandsSep(value.toFixed(0),thousandsSep,grouping);}
__exports.formatMany2one=formatMany2one;function formatMany2one(value,options){if(!value){value="";}else if(value[1]){value=value[1];}else{value=_t("Unnamed");}
if(options&&options.escape){value=encodeURIComponent(value);}
return value;}
__exports.formatX2many=formatX2many;function formatX2many(value){const count=value.currentIds.length;if(count===0){return _t("No records");}else if(count===1){return _t("1 record");}else{return _t("%s records",count);}}
__exports.formatMonetary=formatMonetary;function formatMonetary(value,options={}){if(value===false){return"";}
let currencyId=options.currencyId;if(!currencyId&&options.data){const currencyField=options.currencyField||(options.field&&options.field.currency_field)||"currency_id";const dataValue=options.data[currencyField];currencyId=Array.isArray(dataValue)?dataValue[0]:dataValue;}
return formatCurrency(value,currencyId,options)}
__exports.formatPercentage=formatPercentage;function formatPercentage(value,options={}){value=value||0;options=Object.assign({trailingZeros:false,thousandsSep:""},options);const formatted=formatFloatNumber(value*100,options);return`${formatted}${options.noSymbol ? "" : "%"}`;}
function formatProperties(value,field){if(!value||!value.length){return"";}
return value.map((property)=>property["string"]).join(", ");}
__exports.formatReference=formatReference;function formatReference(value,options){return formatMany2one(value?[value.resId,value.displayName]:false,options);}
__exports.formatSelection=formatSelection;function formatSelection(value,options={}){const selection=options.selection||(options.field&&options.field.selection)||[];const option=selection.find((option)=>option[0]===value);return option?option[1]:"";}
__exports.formatText=formatText;function formatText(value){return value?value.toString():"";}
__exports.formatHtml=formatHtml;function formatHtml(value){return value;}
__exports.formatJson=formatJson;function formatJson(value){return(value&&JSON.stringify(value))||"";}
registry.category("formatters").add("binary",formatBinary).add("boolean",formatBoolean).add("char",formatChar).add("date",formatDate).add("datetime",formatDateTime).add("float",formatFloat).add("float_factor",formatFloatFactor).add("float_time",formatFloatTime).add("html",formatHtml).add("integer",formatInteger).add("json",formatJson).add("many2one",formatMany2one).add("many2one_reference",formatInteger).add("one2many",formatX2many).add("many2many",formatX2many).add("monetary",formatMonetary).add("percentage",formatPercentage).add("properties",formatProperties).add("properties_definition",formatProperties).add("reference",formatReference).add("selection",formatSelection).add("text",formatText);return __exports;});;

/* /barcodes/static/src/barcode_service.js */
odoo.define('@barcodes/barcode_service',['@web/core/browser/feature_detection','@web/core/registry','@web/session','@odoo/owl'],function(require){'use strict';let __exports={};const{isBrowserChrome,isMobileOS}=require("@web/core/browser/feature_detection");const{registry}=require("@web/core/registry");const{session}=require("@web/session");const{EventBus,whenReady}=require("@odoo/owl");function isEditable(element){return element.matches('input,textarea,[contenteditable="true"]');}
function makeBarcodeInput(){const inputEl=document.createElement('input');inputEl.setAttribute("style","position:fixed;top:50%;transform:translateY(-50%);z-index:-1;opacity:0");inputEl.setAttribute("autocomplete","off");inputEl.setAttribute("inputmode","none");inputEl.classList.add("o-barcode-input");inputEl.setAttribute('name','barcode');return inputEl;}
const barcodeService=__exports.barcodeService={maxTimeBetweenKeysInMs:session.max_time_between_keys_in_ms||100,isMobileChrome:isMobileOS()&&isBrowserChrome(),cleanBarcode:function(barcode){return barcode.replace(/Alt|Shift|Control/g,'');},start(){const bus=new EventBus();let timeout=null;let bufferedBarcode="";let currentTarget=null;let barcodeInput=null;function handleBarcode(barcode,target){bus.trigger('barcode_scanned',{barcode,target});if(target.getAttribute('barcode_events')==="true"){const barcodeScannedEvent=new CustomEvent("barcode_scanned",{detail:{barcode,target}});target.dispatchEvent(barcodeScannedEvent);}}
function checkBarcode(ev){let str=barcodeInput?barcodeInput.value:bufferedBarcode;str=barcodeService.cleanBarcode(str);if(str.length>=3){if(ev){ev.preventDefault();}
handleBarcode(str,currentTarget);}
if(barcodeInput){barcodeInput.value="";}
bufferedBarcode="";currentTarget=null;}
function keydownHandler(ev){if(!ev.key){return;}
const isSpecialKey=!['Control','Alt'].includes(ev.key)&&(ev.key.length>1||ev.metaKey);const isEndCharacter=ev.key.match(/(Enter|Tab)/);if(isSpecialKey&&!isEndCharacter){return;}
currentTarget=ev.target;if(currentTarget!==barcodeInput&&isEditable(currentTarget)&&!currentTarget.dataset.enableBarcode&&currentTarget.getAttribute("barcode_events")!=="true"){return;}
clearTimeout(timeout);if(isEndCharacter){checkBarcode(ev);}else{bufferedBarcode+=ev.key;timeout=setTimeout(checkBarcode,barcodeService.maxTimeBetweenKeysInMs);}}
function mobileChromeHandler(ev){if(ev.key==="Unidentified"){return;}
if($(document.activeElement).not('input:text, textarea, [contenteditable], '+'[type="email"], [type="number"], [type="password"], [type="tel"], [type="search"]').length){barcodeInput.focus();}
keydownHandler(ev);}
whenReady(()=>{const isMobileChrome=barcodeService.isMobileChrome;if(isMobileChrome){barcodeInput=makeBarcodeInput();document.body.appendChild(barcodeInput);}
const handler=isMobileChrome?mobileChromeHandler:keydownHandler;document.body.addEventListener('keydown',handler);});return{bus,};},};registry.category("services").add("barcode",barcodeService);return __exports;});;

/* /barcodes/static/src/js/barcode_parser.js */
odoo.define('@barcodes/js/barcode_parser',[],function(require){'use strict';let __exports={};const BarcodeParser=__exports.BarcodeParser=class BarcodeParser{static barcodeNomenclatureFields=["name","rule_ids","upc_ean_conv"];static barcodeRuleFields=["name","sequence","type","encoding","pattern","alias"];static async fetchNomenclature(orm,id){const[nomenclature]=await orm.read("barcode.nomenclature",[id],this.barcodeNomenclatureFields);let rules=await orm.searchRead("barcode.rule",[["barcode_nomenclature_id","=",id]],this.barcodeRuleFields);rules=rules.sort((a,b)=>{return a.sequence-b.sequence;});nomenclature.rules=rules;return nomenclature;}
constructor(){this.setup(...arguments);}
setup({nomenclature}){this.nomenclature=nomenclature;}
get_barcode_check_digit(numericBarcode){let oddsum=0,evensum=0,total=0;const code=numericBarcode.split('').reverse();code.shift();for(let i=0;i<code.length;i++){if(i%2===0){evensum+=parseInt(code[i]);}else{oddsum+=parseInt(code[i]);}}
total=evensum*3+oddsum;return(10-total%10)%10;}
check_encoding(barcode,encoding){if(encoding==='any'){return true;}
const barcodeSizes={ean8:8,ean13:13,upca:12,};return barcode.length===barcodeSizes[encoding]&&/^\d+$/.test(barcode)&&this.get_barcode_check_digit(barcode)===parseInt(barcode[barcode.length-1]);}
sanitize_ean(ean){ean=ean.substr(0,13);ean="0".repeat(13-ean.length)+ean;return ean.substr(0,12)+this.get_barcode_check_digit(ean);}
sanitize_upc(upc){return this.sanitize_ean(upc).substr(1,12);}
match_pattern(barcode,pattern,encoding){var match={value:0,base_code:barcode,match:false,};barcode=barcode.replace("\\","\\\\").replace("{",'\{').replace("}","\}").replace(".","\.");var numerical_content=pattern.match(/[{][N]*[D]*[}]/);var base_pattern=pattern;if(numerical_content){var num_start=numerical_content.index;var num_length=numerical_content[0].length;var value_string=barcode.substr(num_start,num_length-2);var whole_part_match=numerical_content[0].match("[{][N]*[D}]");var decimal_part_match=numerical_content[0].match("[{N][D]*[}]");var whole_part=value_string.substr(0,whole_part_match.index+whole_part_match[0].length-2);var decimal_part="0."+value_string.substr(decimal_part_match.index,decimal_part_match[0].length-1);if(whole_part===''){whole_part='0';}
match.value=parseInt(whole_part)+parseFloat(decimal_part);match.base_code=barcode.substr(0,num_start);base_pattern=pattern.substr(0,num_start);for(var i=0;i<(num_length-2);i++){match.base_code+="0";base_pattern+="0";}
match.base_code+=barcode.substr(num_start+num_length-2,barcode.length-1);base_pattern+=pattern.substr(num_start+num_length,pattern.length-1);match.base_code=match.base_code.replace("\\\\","\\").replace("\{","{").replace("\}","}").replace("\.",".");var base_code=match.base_code.split('');if(encoding==='ean13'){base_code[12]=''+this.get_barcode_check_digit(match.base_code);}else if(encoding==='ean8'){base_code[7]=''+this.get_barcode_check_digit(match.base_code);}else if(encoding==='upca'){base_code[11]=''+this.get_barcode_check_digit(match.base_code);}
match.base_code=base_code.join('');}
base_pattern=base_pattern.split('|').map(part=>part.startsWith('^')?part:'^'+part).join('|');match.match=match.base_code.match(base_pattern);return match;}
parse_barcode(barcode){var parsed_result={encoding:'',type:'error',code:barcode,base_code:barcode,value:0,};if(!this.nomenclature){return parsed_result;}
var rules=this.nomenclature.rules;for(var i=0;i<rules.length;i++){var rule=rules[i];var cur_barcode=barcode;if(rule.encoding==='ean13'&&this.check_encoding(barcode,'upca')&&this.nomenclature.upc_ean_conv in{'upc2ean':'','always':''}){cur_barcode='0'+cur_barcode;}else if(rule.encoding==='upca'&&this.check_encoding(barcode,'ean13')&&barcode[0]==='0'&&this.nomenclature.upc_ean_conv in{'ean2upc':'','always':''}){cur_barcode=cur_barcode.substr(1,12);}
if(!this.check_encoding(cur_barcode,rule.encoding)){continue;}
var match=this.match_pattern(cur_barcode,rules[i].pattern,rule.encoding);if(match.match){if(rules[i].type==='alias'){barcode=rules[i].alias;parsed_result.code=barcode;parsed_result.type='alias';}
else{parsed_result.encoding=rules[i].encoding;parsed_result.type=rules[i].type;parsed_result.value=match.value;parsed_result.code=cur_barcode;if(rules[i].encoding==="ean13"){parsed_result.base_code=this.sanitize_ean(match.base_code);}
else{parsed_result.base_code=match.base_code;}
return parsed_result;}}}
return parsed_result;}}
return __exports;});;

/* /barcodes_gs1_nomenclature/static/src/js/barcode_parser.js */
odoo.define('@barcodes_gs1_nomenclature/js/barcode_parser',['@web/core/utils/patch','@barcodes/js/barcode_parser','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{patch}=require("@web/core/utils/patch");const{BarcodeParser}=require("@barcodes/js/barcode_parser");const{_t}=require("@web/core/l10n/translation");const GS1BarcodeError=__exports.GS1BarcodeError=class GS1BarcodeError extends Error{};const FNC1_CHAR=__exports.FNC1_CHAR=String.fromCharCode(29);patch(BarcodeParser,{barcodeNomenclatureFields:[...BarcodeParser.barcodeNomenclatureFields,"is_gs1_nomenclature","gs1_separator_fnc1",],barcodeRuleFields:[...BarcodeParser.barcodeRuleFields,"gs1_content_type","gs1_decimal_usage","associated_uom_id",],});patch(BarcodeParser.prototype,{setup(attributes){super.setup(...arguments);const nomenclatureSeparator=this.nomenclature&&this.nomenclature.gs1_separator_fnc1;this.gs1SeparatorRegex=new RegExp(nomenclatureSeparator||'.^','g');},gs1_date_to_date(gs1Date){const now=new Date();const substractYear=parseInt(gs1Date.slice(0,2))-(now.getFullYear()%100);let century=Math.floor(now.getFullYear()/100);if(51<=substractYear&&substractYear<=99){century--;}else if(-99<=substractYear&&substractYear<=-50){century++;}
const year=century*100+parseInt(gs1Date.slice(0,2));const date=new Date(year,parseInt(gs1Date.slice(2,4)-1));if(gs1Date.slice(-2)==='00'){date.setDate(new Date(year,parseInt(gs1Date.slice(2,4)),0).getDate());}else{date.setDate(parseInt(gs1Date.slice(-2)));}
return date;},parse_gs1_rule_pattern(match,rule){const result={rule:Object.assign({},rule),ai:match[1],string_value:match[2],code:match[2],base_code:match[2],type:rule.type};if(rule.gs1_content_type==='measure'){let decimalPosition=0;if(rule.gs1_decimal_usage){decimalPosition=parseInt(match[1][match[1].length-1]);}
if(decimalPosition>0){const integral=match[2].slice(0,match[2].length-decimalPosition);const decimal=match[2].slice(match[2].length-decimalPosition);result.value=parseFloat(integral+"."+decimal);}else{result.value=parseInt(match[2]);}}else if(rule.gs1_content_type==='identifier'){if(parseInt(match[2][match[2].length-1])!==this.get_barcode_check_digit("0".repeat(18-match[2].length)+match[2])){throw new Error(_t("Invalid barcode: the check digit is incorrect"));}
result.value=match[2];}else if(rule.gs1_content_type==='date'){if(match[2].length!==6){throw new Error(_t("Invalid barcode: can't be formated as date"));}
result.value=this.gs1_date_to_date(match[2]);}else{result.value=match[2];}
return result;},gs1_decompose_extanded(barcode){const results=[];const rules=this.nomenclature.rules.filter(rule=>rule.encoding==='gs1-128');const separatorReg=`(?:${FNC1_CHAR}+)?`;barcode=this._convertGS1Separators(barcode);while(barcode.length>0){const barcodeLength=barcode.length;for(const rule of rules){const match=barcode.match("^"+rule.pattern+separatorReg);if(match&&match.length>=3){const res=this.parse_gs1_rule_pattern(match,rule);if(res){barcode=barcode.slice(match.index+match[0].length);results.push(res);if(barcode.length===0){return results;}}else{throw new GS1BarcodeError(_t("This barcode can't be parsed by any barcode rules."));}}}
if(barcodeLength===barcode.length){throw new GS1BarcodeError(_t("This barcode can't be partially or fully parsed."));}}
return results;},parse_barcode(barcode){if(this.nomenclature&&this.nomenclature.is_gs1_nomenclature){return this.gs1_decompose_extanded(barcode);}
return super.parse_barcode(...arguments);},_convertGS1Separators:function(barcode){barcode=barcode.replace(this.gs1SeparatorRegex,FNC1_CHAR);return barcode;},});return __exports;});;

/* /barcodes_gs1_nomenclature/static/src/js/barcode_service.js */
odoo.define('@barcodes_gs1_nomenclature/js/barcode_service',['@web/session','@web/core/utils/patch','@barcodes/barcode_service','@barcodes_gs1_nomenclature/js/barcode_parser'],function(require){'use strict';let __exports={};const{session}=require("@web/session");const{patch}=require("@web/core/utils/patch");const{barcodeService}=require('@barcodes/barcode_service');const{FNC1_CHAR}=require("@barcodes_gs1_nomenclature/js/barcode_parser");patch(barcodeService,{gs1SeparatorRegex:new RegExp(session.gs1_group_separator_encodings||'.^','g'),cleanBarcode(barcode){barcode=barcode.replace(barcodeService.gs1SeparatorRegex,FNC1_CHAR);return super.cleanBarcode(barcode);},});return __exports;});;

/* /web/static/src/views/fields/parsers.js */
odoo.define('@web/views/fields/parsers',['@web/core/l10n/dates','@web/core/l10n/localization','@web/core/py_js/py','@web/core/registry','@web/core/utils/strings'],function(require){'use strict';let __exports={};const{parseDate,parseDateTime}=require("@web/core/l10n/dates");const{localization}=require("@web/core/l10n/localization");const{evaluateExpr}=require("@web/core/py_js/py");const{registry}=require("@web/core/registry");const{escapeRegExp}=require("@web/core/utils/strings");function evaluateMathematicalExpression(expr,context={}){var val=expr.replace(new RegExp(/( )/g),"");var safeEvalString="";for(let v of val.split(new RegExp(/([-+*/()^])/g))){if(!["+","-","*","/","(",")","^"].includes(v)&&v.length){v=parseFloat(v);}
if(v==="^"){v="**";}
safeEvalString+=v;}
return evaluateExpr(safeEvalString,context);}
function parseNumber(value,options={}){if(value.startsWith("=")){value=evaluateMathematicalExpression(value.substring(1));if(options.truncate){value=Math.trunc(value);}}else{const thousandsSepRegex=options.thousandsSep.match(/\s+/)?/\s+/g:new RegExp(escapeRegExp(options.thousandsSep),"g")||",";value=value.replaceAll(thousandsSepRegex,"");value=value.replace(new RegExp(escapeRegExp(options.decimalPoint),"g")||".",".");}
return Number(value);}
const InvalidNumberError=__exports.InvalidNumberError=class InvalidNumberError extends Error{}
__exports.parseFloat=parseFloat;function parseFloat(value){const thousandsSepRegex=localization.thousandsSep||"";const decimalPointRegex=localization.decimalPoint;let parsed=parseNumber(value,{thousandsSep:thousandsSepRegex,decimalPoint:decimalPointRegex,});if(isNaN(parsed)){parsed=parseNumber(value,{thousandsSep:",",decimalPoint:".",});if(isNaN(parsed)){throw new InvalidNumberError(`"${value}" is not a correct number`);}}
return parsed;}
__exports.parseFloatTime=parseFloatTime;function parseFloatTime(value){let sign=1;if(value[0]==="-"){value=value.slice(1);sign=-1;}
const values=value.split(":");if(values.length>2){throw new InvalidNumberError(`"${value}" is not a correct number`);}
if(values.length===1){return sign*parseFloat(value);}
const hours=parseInteger(values[0]);const minutes=parseInteger(values[1]);return sign*(hours+minutes/60);}
__exports.parseInteger=parseInteger;function parseInteger(value){const thousandsSepRegex=localization.thousandsSep||"";const decimalPointRegex=localization.decimalPoint;let parsed=parseNumber(value,{thousandsSep:thousandsSepRegex,decimalPoint:decimalPointRegex,truncate:true,});if(!Number.isInteger(parsed)){parsed=parseNumber(value,{thousandsSep:",",decimalPoint:".",truncate:true,});if(!Number.isInteger(parsed)){throw new InvalidNumberError(`"${value}" is not a correct number`);}}
if(parsed<-2147483648||parsed>2147483647){throw new InvalidNumberError(`"${value}" is out of bounds (integers should be between -2,147,483,648 and 2,147,483,647)`);}
return parsed;}
__exports.parsePercentage=parsePercentage;function parsePercentage(value){if(value[value.length-1]==="%"){value=value.slice(0,value.length-1);}
return parseFloat(value)/100;}
__exports.parseMonetary=parseMonetary;function parseMonetary(value){value=value.trim();const startMatch=value.match(new RegExp(`[\\d\\-+=]|${escapeRegExp(localization.decimalPoint)}`));if(startMatch){value=value.substring(startMatch.index);}
value=value.replace(/\D*$/,"");return parseFloat(value);}
registry.category("parsers").add("date",parseDate).add("datetime",parseDateTime).add("float",parseFloat).add("float_time",parseFloatTime).add("integer",parseInteger).add("many2one_reference",parseInteger).add("monetary",parseMonetary).add("percentage",parsePercentage);return __exports;});;

/* /web/static/src/webclient/barcode/barcode_scanner.js */
odoo.define('@web/webclient/barcode/barcode_scanner',['@web/core/browser/browser','@web/core/dialog/dialog','@web/core/utils/concurrency','@web/core/assets','@web/webclient/barcode/ZXingBarcodeDetector','@web/webclient/barcode/crop_overlay','@odoo/owl','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{Dialog}=require("@web/core/dialog/dialog");const{delay}=require("@web/core/utils/concurrency");const{loadJS}=require("@web/core/assets");const{isVideoElementReady,buildZXingBarcodeDetector}=require("@web/webclient/barcode/ZXingBarcodeDetector");const{CropOverlay}=require("@web/webclient/barcode/crop_overlay");const{Component,onMounted,onWillStart,onWillUnmount,useRef,useState}=require("@odoo/owl");const{_t}=require("@web/core/l10n/translation");const BarcodeDialog=__exports.BarcodeDialog=class BarcodeDialog extends Component{setup(){this.videoPreviewRef=useRef("videoPreview");this.interval=null;this.stream=null;this.detector=null;this.overlayInfo={};this.zoomRatio=1;this.state=useState({isReady:false,});onWillStart(async()=>{let DetectorClass;if("BarcodeDetector"in window){DetectorClass=BarcodeDetector;}else{await loadJS("/web/static/lib/zxing-library/zxing-library.js");DetectorClass=buildZXingBarcodeDetector(window.ZXing);}
const formats=await DetectorClass.getSupportedFormats();this.detector=new DetectorClass({formats});});onMounted(async()=>{const constraints={video:{facingMode:this.props.facingMode},audio:false,};try{this.stream=await browser.navigator.mediaDevices.getUserMedia(constraints);}catch(err){const errors={NotFoundError:_t("No device can be found."),NotAllowedError:_t("Odoo needs your authorization first."),};const errorMessage=_t("Could not start scanning. ")+(errors[err.name]||err.message);this.onError(new Error(errorMessage));return;}
this.videoPreviewRef.el.srcObject=this.stream;await this.isVideoReady();const{height,width}=getComputedStyle(this.videoPreviewRef.el);const divWidth=width.slice(0,-2);const divHeight=height.slice(0,-2);const tracks=this.stream.getVideoTracks();if(tracks.length){const[track]=tracks;const settings=track.getSettings();this.zoomRatio=Math.min(divWidth/settings.width,divHeight/settings.height);}
this.interval=setInterval(this.detectCode.bind(this),100);});onWillUnmount(()=>{clearInterval(this.interval);this.interval=null;if(this.stream){this.stream.getTracks().forEach((track)=>track.stop());this.stream=null;}});}
isZXingBarcodeDetector(){return this.detector&&this.detector.__proto__.constructor.name==="ZXingBarcodeDetector";}
async isVideoReady(){while(!isVideoElementReady(this.videoPreviewRef.el)){await delay(10);}
this.state.isReady=true;}
onResize(overlayInfo){this.overlayInfo=overlayInfo;if(this.isZXingBarcodeDetector()){this.detector.setCropArea(this.adaptValuesWithRatio(this.overlayInfo,true));}}
onResult(result){this.props.close();this.props.onResult(result);}
onError(error){this.props.close();this.props.onError(error);}
async detectCode(){try{const codes=await this.detector.detect(this.videoPreviewRef.el);for(const code of codes){if(!this.isZXingBarcodeDetector()&&this.overlayInfo.x&&this.overlayInfo.y){const{x,y,width,height}=this.adaptValuesWithRatio(code.boundingBox);if(x<this.overlayInfo.x||x+width>this.overlayInfo.x+this.overlayInfo.width||y<this.overlayInfo.y||y+height>this.overlayInfo.y+this.overlayInfo.height){continue;}}
this.onResult(code.rawValue);break;}}catch(err){this.onError(err);}}
adaptValuesWithRatio(object,dividerRatio=false){const newObject=Object.assign({},object);for(const key of Object.keys(newObject)){if(dividerRatio){newObject[key]/=this.zoomRatio;}else{newObject[key]*=this.zoomRatio;}}
return newObject;}}
Object.assign(BarcodeDialog,{components:{Dialog,CropOverlay,},template:"web.BarcodeDialog",});__exports.isBarcodeScannerSupported=isBarcodeScannerSupported;function isBarcodeScannerSupported(){return browser.navigator.mediaDevices&&browser.navigator.mediaDevices.getUserMedia;}
__exports.scanBarcode=scanBarcode;async function scanBarcode(env,facingMode="environment"){let res;let rej;const promise=new Promise((resolve,reject)=>{res=resolve;rej=reject;});env.services.dialog.add(BarcodeDialog,{facingMode,onResult:(result)=>res(result),onError:(error)=>rej(error),});return promise;}
return __exports;});;

/* /web/static/src/webclient/barcode/ZXingBarcodeDetector.js */
odoo.define('@web/webclient/barcode/ZXingBarcodeDetector',[],function(require){'use strict';let __exports={};__exports.buildZXingBarcodeDetector=buildZXingBarcodeDetector;function buildZXingBarcodeDetector(ZXing){const ZXingFormats=new Map([["aztec",ZXing.BarcodeFormat.AZTEC],["code_39",ZXing.BarcodeFormat.CODE_39],["code_128",ZXing.BarcodeFormat.CODE_128],["data_matrix",ZXing.BarcodeFormat.DATA_MATRIX],["ean_8",ZXing.BarcodeFormat.EAN_8],["ean_13",ZXing.BarcodeFormat.EAN_13],["itf",ZXing.BarcodeFormat.ITF],["pdf417",ZXing.BarcodeFormat.PDF_417],["qr_code",ZXing.BarcodeFormat.QR_CODE],["upc_a",ZXing.BarcodeFormat.UPC_A],["upc_e",ZXing.BarcodeFormat.UPC_E],]);const allSupportedFormats=Array.from(ZXingFormats.keys());class ZXingBarcodeDetector{constructor(opts={}){const formats=opts.formats||allSupportedFormats;const hints=new Map([[ZXing.DecodeHintType.POSSIBLE_FORMATS,formats.map((format)=>ZXingFormats.get(format)),],[ZXing.DecodeHintType.TRY_HARDER,true],]);this.reader=new ZXing.MultiFormatReader();this.reader.setHints(hints);}
async detect(video){if(!(video instanceof HTMLVideoElement)){throw new DOMException("imageDataFrom() requires an HTMLVideoElement","InvalidArgumentError");}
if(!isVideoElementReady(video)){throw new DOMException("HTMLVideoElement is not ready","InvalidStateError");}
const canvas=document.createElement("canvas");let barcodeArea;if(this.cropArea&&(this.cropArea.x||this.cropArea.y)){barcodeArea=this.cropArea;}else{barcodeArea={x:0,y:0,width:video.videoWidth,height:video.videoHeight,};}
canvas.width=barcodeArea.width;canvas.height=barcodeArea.height;const ctx=canvas.getContext("2d");ctx.drawImage(video,barcodeArea.x,barcodeArea.y,barcodeArea.width,barcodeArea.height,0,0,barcodeArea.width,barcodeArea.height);const luminanceSource=new ZXing.HTMLCanvasElementLuminanceSource(canvas);const binaryBitmap=new ZXing.BinaryBitmap(new ZXing.HybridBinarizer(luminanceSource));try{const result=this.reader.decode(binaryBitmap);const{resultPoints}=result;const boundingBox=DOMRectReadOnly.fromRect({x:resultPoints[0].x,y:resultPoints[0].y,height:Math.max(1,Math.abs(resultPoints[1].y-resultPoints[0].y)),width:Math.max(1,Math.abs(resultPoints[1].x-resultPoints[0].x)),});const cornerPoints=resultPoints;const format=Array.from(ZXingFormats).find(([k,val])=>val===result.getBarcodeFormat());const rawValue=result.getText();return[{boundingBox,cornerPoints,format,rawValue,},];}catch(err){if(err.name==="NotFoundException"){return[];}
throw err;}}
setCropArea(cropArea){this.cropArea=cropArea;}}
ZXingBarcodeDetector.getSupportedFormats=async()=>allSupportedFormats;return ZXingBarcodeDetector;}
const HAVE_NOTHING=0;const HAVE_METADATA=1;__exports.isVideoElementReady=isVideoElementReady;function isVideoElementReady(video){return![HAVE_NOTHING,HAVE_METADATA].includes(video.readyState);}
return __exports;});;

/* /web/static/src/webclient/barcode/crop_overlay.js */
odoo.define('@web/webclient/barcode/crop_overlay',['@odoo/owl','@web/core/browser/browser','@web/core/utils/numbers'],function(require){'use strict';let __exports={};const{Component,useRef,onPatched}=require("@odoo/owl");const{browser}=require("@web/core/browser/browser");const{clamp}=require("@web/core/utils/numbers");const CropOverlay=__exports.CropOverlay=class CropOverlay extends Component{setup(){this.localStorageKey="o-barcode-scanner-overlay";this.cropContainerRef=useRef("crop-container");this.isMoving=false;this.boundaryOverlay={};this.relativePosition={x:0,y:0,};onPatched(()=>{this.setupCropRect();});}
setupCropRect(){if(!this.props.isReady){return;}
this.computeDefaultPoint();this.computeOverlayPosition();this.calculateAndSetTransparentRect();this.executeOnResizeCallback();}
boundPoint(pointValue,boundaryRect){return{x:clamp(pointValue.x,boundaryRect.left,boundaryRect.left+boundaryRect.width),y:clamp(pointValue.y,boundaryRect.top,boundaryRect.top+boundaryRect.height),};}
calculateAndSetTransparentRect(){const cropTransparentRect=this.getTransparentRec(this.relativePosition,this.boundaryOverlay);this.setCropValue(cropTransparentRect,this.relativePosition);}
computeOverlayPosition(){const cropOverlayElement=this.cropContainerRef.el.querySelector(".o_crop_overlay");this.boundaryOverlay=cropOverlayElement.getBoundingClientRect();}
executeOnResizeCallback(){const transparentRec=this.getTransparentRec(this.relativePosition,this.boundaryOverlay);browser.localStorage.setItem(this.localStorageKey,JSON.stringify(transparentRec));this.props.onResize({...transparentRec,width:this.boundaryOverlay.width-2*transparentRec.x,height:this.boundaryOverlay.height-2*transparentRec.y,});}
computeDefaultPoint(){const firstChildComputedStyle=getComputedStyle(this.cropContainerRef.el.firstChild);const elementWidth=firstChildComputedStyle.width.slice(0,-2);const elementHeight=firstChildComputedStyle.height.slice(0,-2);const stringSavedPoint=browser.localStorage.getItem(this.localStorageKey);if(stringSavedPoint){const savedPoint=JSON.parse(stringSavedPoint);this.relativePosition={x:clamp(savedPoint.x,0,elementWidth),y:clamp(savedPoint.y,0,elementHeight),};}else{const stepWidth=elementWidth/10;const width=stepWidth*8;const height=width/4;const startY=elementHeight/2-height/2;this.relativePosition={x:stepWidth+width,y:startY+height,};}}
getTransparentRec(point,rect){const middleX=rect.width/2;const middleY=rect.height/2;const newDeltaX=Math.abs(point.x-middleX);const newDeltaY=Math.abs(point.y-middleY);return{x:middleX-newDeltaX,y:middleY-newDeltaY,};}
setCropValue(point,iconPoint){if(!iconPoint){iconPoint=point;}
this.cropContainerRef.el.style.setProperty("--o-crop-x",`${point.x}px`);this.cropContainerRef.el.style.setProperty("--o-crop-y",`${point.y}px`);this.cropContainerRef.el.style.setProperty("--o-crop-icon-x",`${iconPoint.x}px`);this.cropContainerRef.el.style.setProperty("--o-crop-icon-y",`${iconPoint.y}px`);}
pointerDown(event){event.preventDefault();if(event.target.matches(".o_crop_icon")){this.computeOverlayPosition();this.isMoving=true;}}
pointerMove(event){if(!this.isMoving){return;}
let eventPosition;if(event.touches&&event.touches.length){eventPosition=event.touches[0];}else{eventPosition=event;}
const{clientX,clientY}=eventPosition;const restrictedPosition=this.boundPoint({x:clientX,y:clientY,},this.boundaryOverlay);this.relativePosition={x:restrictedPosition.x-this.boundaryOverlay.left,y:restrictedPosition.y-this.boundaryOverlay.top,};this.calculateAndSetTransparentRect(this.relativePosition);}
pointerUp(event){this.isMoving=false;this.executeOnResizeCallback();}}
CropOverlay.template="web.CropOverlay";CropOverlay.props={onResize:Function,isReady:Boolean,slots:{type:Object,shape:{default:{},},},};return __exports;});;

/* /bus/static/src/services/bus_service.js */
odoo.define('@bus/services/bus_service',['@web/core/browser/browser','@web/core/utils/concurrency','@web/core/registry','@web/session','@web/core/browser/feature_detection','@bus/workers/websocket_worker','@odoo/owl'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{Deferred}=require("@web/core/utils/concurrency");const{registry}=require("@web/core/registry");const{session}=require("@web/session");const{isIosApp}=require("@web/core/browser/feature_detection");const{WORKER_VERSION}=require("@bus/workers/websocket_worker");const{EventBus}=require("@odoo/owl");const busService=__exports.busService={dependencies:["bus.parameters","localization","multi_tab"],async:true,start(env,{multi_tab:multiTab,"bus.parameters":params}){const bus=new EventBus();const notificationBus=new EventBus();let worker;let isActive=false;let isInitialized=false;let isUsingSharedWorker=browser.SharedWorker&&!isIosApp();const startedAt=luxon.DateTime.now().set({milliseconds:0});const connectionInitializedDeferred=new Deferred();function send(action,data){if(!worker){return;}
const message={action,data};if(isUsingSharedWorker){worker.port.postMessage(message);}else{worker.postMessage(message);}}
function handleMessage(messageEv){const{type}=messageEv.data;let{data}=messageEv.data;if(type==="notification"){data.forEach((d)=>(d.message.id=d.id));multiTab.setSharedValue("last_notification_id",data[data.length-1].id);data=data.map((notification)=>notification.message);for(const{type,payload}of data){notificationBus.trigger(type,payload);}}else if(type==="initialized"){isInitialized=true;connectionInitializedDeferred.resolve();return;}
bus.trigger(type,data);}
function initializeWorkerConnection(){let uid=Array.isArray(session.user_id)?session.user_id[0]:session.user_id;if(!uid&&uid!==undefined){uid=false;}
send("initialize_connection",{websocketURL:`${params.serverURL.replace("http", "ws")}/websocket`,db:session.db,debug:odoo.debug,lastNotificationId:multiTab.getSharedValue("last_notification_id",0),uid,startTs:startedAt.valueOf(),});}
function startWorker(){let workerURL=`${params.serverURL}/bus/websocket_worker_bundle?v=${WORKER_VERSION}`;if(params.serverURL!==window.origin){const source=`importScripts("${workerURL}");`;workerURL="data:application/javascript;base64,"+window.btoa(source);}
const workerClass=isUsingSharedWorker?browser.SharedWorker:browser.Worker;worker=new workerClass(workerURL,{name:isUsingSharedWorker?"odoo:websocket_shared_worker":"odoo:websocket_worker",});worker.addEventListener("error",(e)=>{if(!isInitialized&&workerClass===browser.SharedWorker){console.warn('Error while loading "bus_service" SharedWorker, fallback on Worker.');isUsingSharedWorker=false;startWorker();}else if(!isInitialized){isInitialized=true;connectionInitializedDeferred.resolve();console.warn("Bus service failed to initialized.");}});if(isUsingSharedWorker){worker.port.start();worker.port.addEventListener("message",handleMessage);}else{worker.addEventListener("message",handleMessage);}
initializeWorkerConnection();}
browser.addEventListener("pagehide",({persisted})=>{if(!persisted){send("leave");}});browser.addEventListener("online",()=>{if(isActive){send("start");}});browser.addEventListener("offline",()=>send("stop"));return{addEventListener:bus.addEventListener.bind(bus),addChannel:async(channel)=>{if(!worker){startWorker();await connectionInitializedDeferred;}
send("add_channel",channel);send("start");isActive=true;},deleteChannel:(channel)=>send("delete_channel",channel),forceUpdateChannels:()=>send("force_update_channels"),trigger:bus.trigger.bind(bus),removeEventListener:bus.removeEventListener.bind(bus),send:(eventName,data)=>send("send",{event_name:eventName,data}),start:async()=>{if(!worker){startWorker();await connectionInitializedDeferred;}
send("start");isActive=true;},stop:()=>{send("leave");isActive=false;},get isActive(){return isActive;},subscribe(notificationType,callback){notificationBus.addEventListener(notificationType,({detail})=>callback(detail));},startedAt,};},};registry.category("services").add("bus_service",busService);return __exports;});;

/* /bus/static/src/bus_parameters_service.js */
odoo.define('@bus/bus_parameters_service',['@web/core/registry'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const busParametersService=__exports.busParametersService={start(){return{serverURL:window.origin,};},};registry.category("services").add("bus.parameters",busParametersService);return __exports;});;

/* /bus/static/src/multi_tab_service.js */
odoo.define('@bus/multi_tab_service',['@web/core/registry','@web/core/browser/browser','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{browser}=require("@web/core/browser/browser");const{EventBus}=require("@odoo/owl");let multiTabId=0;const multiTabService=__exports.multiTabService={start(){const bus=new EventBus();const TAB_HEARTBEAT_PERIOD=10000;const MAIN_TAB_HEARTBEAT_PERIOD=1500;const HEARTBEAT_OUT_OF_DATE_PERIOD=5000;const HEARTBEAT_KILL_OLD_PERIOD=15000;const PRIVATE_LOCAL_STORAGE_KEYS=["main","heartbeat"];let _isOnMainTab=false;let lastHeartbeat=0;let heartbeatTimeout;const sanitizedOrigin=location.origin.replace(/:\/{0,2}/g,"_");const localStoragePrefix=`${this.name}.${sanitizedOrigin}.`;const now=new Date().getTime();const tabId=`${this.name}${multiTabId++}:${now}`;function generateLocalStorageKey(baseKey){return localStoragePrefix+baseKey;}
function getItemFromStorage(key,defaultValue){const item=browser.localStorage.getItem(generateLocalStorageKey(key));try{return item?JSON.parse(item):defaultValue;}catch{return item;}}
function setItemInStorage(key,value){browser.localStorage.setItem(generateLocalStorageKey(key),JSON.stringify(value));}
function startElection(){if(_isOnMainTab){return;}
const now=new Date().getTime();const lastPresenceByTab=getItemFromStorage("lastPresenceByTab",{});const heartbeatKillOld=now-HEARTBEAT_KILL_OLD_PERIOD;let newMain;for(const[tab,lastPresence]of Object.entries(lastPresenceByTab)){if(lastPresence<heartbeatKillOld){continue;}
newMain=tab;break;}
if(newMain===tabId){lastHeartbeat=now;setItemInStorage("heartbeat",lastHeartbeat);setItemInStorage("main",true);_isOnMainTab=true;bus.trigger("become_main_tab");delete lastPresenceByTab[newMain];setItemInStorage("lastPresenceByTab",lastPresenceByTab);}}
function heartbeat(){const now=new Date().getTime();let heartbeatValue=getItemFromStorage("heartbeat",0);const lastPresenceByTab=getItemFromStorage("lastPresenceByTab",{});if(heartbeatValue+HEARTBEAT_OUT_OF_DATE_PERIOD<now){startElection();heartbeatValue=getItemFromStorage("heartbeat",0);}
if(_isOnMainTab){const cleanedTabs={};for(const[tabId,lastPresence]of Object.entries(lastPresenceByTab)){if(lastPresence+HEARTBEAT_KILL_OLD_PERIOD>now){cleanedTabs[tabId]=lastPresence;}}
if(heartbeatValue!==lastHeartbeat){_isOnMainTab=false;lastHeartbeat=0;lastPresenceByTab[tabId]=now;setItemInStorage("lastPresenceByTab",lastPresenceByTab);bus.trigger("no_longer_main_tab");}else{lastHeartbeat=now;setItemInStorage("heartbeat",now);setItemInStorage("lastPresenceByTab",cleanedTabs);}}else{lastPresenceByTab[tabId]=now;setItemInStorage("lastPresenceByTab",lastPresenceByTab);}
const hbPeriod=_isOnMainTab?MAIN_TAB_HEARTBEAT_PERIOD:TAB_HEARTBEAT_PERIOD;heartbeatTimeout=browser.setTimeout(heartbeat,hbPeriod);}
function onStorage({key,newValue}){if(key===generateLocalStorageKey("main")&&!newValue){startElection();}
if(PRIVATE_LOCAL_STORAGE_KEYS.includes(key)){return;}
if(key&&key.includes(localStoragePrefix)){const baseKey=key.replace(localStoragePrefix,"");bus.trigger("shared_value_updated",{key:baseKey,newValue});}}
function onPagehide(){clearTimeout(heartbeatTimeout);const lastPresenceByTab=getItemFromStorage("lastPresenceByTab",{});delete lastPresenceByTab[tabId];setItemInStorage("lastPresenceByTab",lastPresenceByTab);if(_isOnMainTab){_isOnMainTab=false;bus.trigger("no_longer_main_tab");browser.localStorage.removeItem(generateLocalStorageKey("main"));}}
browser.addEventListener("pagehide",onPagehide);browser.addEventListener("storage",onStorage);const lastPresenceByTab=getItemFromStorage("lastPresenceByTab",{});lastPresenceByTab[tabId]=now;setItemInStorage("lastPresenceByTab",lastPresenceByTab);if(!getItemFromStorage("main")){startElection();}
heartbeat();return{bus,get currentTabId(){return tabId;},isOnMainTab(){return _isOnMainTab;},getSharedValue(key,defaultValue){return getItemFromStorage(key,defaultValue);},setSharedValue(key,value){if(value===undefined){return this.removeSharedValue(key);}
setItemInStorage(key,value);},removeSharedValue(key){browser.localStorage.removeItem(generateLocalStorageKey(key));},};},};registry.category("services").add("multi_tab",multiTabService);return __exports;});;

/* /bus/static/src/workers/websocket_worker.js */
odoo.define('@bus/workers/websocket_worker',['@bus/workers/websocket_worker_utils'],function(require){'use strict';let __exports={};const{debounce}=require("@bus/workers/websocket_worker_utils");const WEBSOCKET_CLOSE_CODES=__exports.WEBSOCKET_CLOSE_CODES=Object.freeze({CLEAN:1000,GOING_AWAY:1001,PROTOCOL_ERROR:1002,INCORRECT_DATA:1003,ABNORMAL_CLOSURE:1006,INCONSISTENT_DATA:1007,MESSAGE_VIOLATING_POLICY:1008,MESSAGE_TOO_BIG:1009,EXTENSION_NEGOTIATION_FAILED:1010,SERVER_ERROR:1011,RESTART:1012,TRY_LATER:1013,BAD_GATEWAY:1014,SESSION_EXPIRED:4001,KEEP_ALIVE_TIMEOUT:4002,RECONNECTING:4003,});const WORKER_VERSION=__exports.WORKER_VERSION="1.0.7";const MAXIMUM_RECONNECT_DELAY=60000;const WebsocketWorker=__exports.WebsocketWorker=class WebsocketWorker{INITIAL_RECONNECT_DELAY=1000;RECONNECT_JITTER=1000;constructor(){this.newestStartTs=undefined;this.websocketURL="";this.currentUID=null;this.currentDB=null;this.isWaitingForNewUID=true;this.channelsByClient=new Map();this.connectRetryDelay=this.INITIAL_RECONNECT_DELAY;this.connectTimeout=null;this.debugModeByClient=new Map();this.isDebug=false;this.isReconnecting=false;this.lastChannelSubscription=null;this.lastNotificationId=0;this.messageWaitQueue=[];this._forceUpdateChannels=debounce(this._forceUpdateChannels,300);this._updateChannels=debounce(this._updateChannels,0);this._onWebsocketClose=this._onWebsocketClose.bind(this);this._onWebsocketError=this._onWebsocketError.bind(this);this._onWebsocketMessage=this._onWebsocketMessage.bind(this);this._onWebsocketOpen=this._onWebsocketOpen.bind(this);}
broadcast(type,data){for(const client of this.channelsByClient.keys()){client.postMessage({type,data});}}
registerClient(messagePort){messagePort.onmessage=(ev)=>{this._onClientMessage(messagePort,ev.data);};this.channelsByClient.set(messagePort,[]);}
sendToClient(client,type,data){client.postMessage({type,data});}
_onClientMessage(client,{action,data}){switch(action){case"send":return this._sendToServer(data);case"start":return this._start();case"stop":return this._stop();case"leave":return this._unregisterClient(client);case"add_channel":return this._addChannel(client,data);case"delete_channel":return this._deleteChannel(client,data);case"force_update_channels":return this._forceUpdateChannels();case"initialize_connection":return this._initializeConnection(client,data);}}
_addChannel(client,channel){const clientChannels=this.channelsByClient.get(client);if(!clientChannels.includes(channel)){clientChannels.push(channel);this.channelsByClient.set(client,clientChannels);this._updateChannels();}}
_deleteChannel(client,channel){const clientChannels=this.channelsByClient.get(client);if(!clientChannels){return;}
const channelIndex=clientChannels.indexOf(channel);if(channelIndex!==-1){clientChannels.splice(channelIndex,1);this._updateChannels();}}
_forceUpdateChannels(){this._updateChannels({force:true});}
_unregisterClient(client){this.channelsByClient.delete(client);this.debugModeByClient.delete(client);this.isDebug=Object.values(this.debugModeByClient).some((debugValue)=>debugValue!=="");this._updateChannels();}
_initializeConnection(client,{db,debug,lastNotificationId,uid,websocketURL,startTs}){if(this.newestStartTs&&this.newestStartTs>startTs){this.debugModeByClient[client]=debug;this.isDebug=Object.values(this.debugModeByClient).some((debugValue)=>debugValue!=="");this.sendToClient(client,"initialized");return;}
this.newestStartTs=startTs;this.websocketURL=websocketURL;this.lastNotificationId=lastNotificationId;this.debugModeByClient[client]=debug;this.isDebug=Object.values(this.debugModeByClient).some((debugValue)=>debugValue!=="");const isCurrentUserKnown=uid!==undefined;if(this.isWaitingForNewUID&&isCurrentUserKnown){this.isWaitingForNewUID=false;this.currentUID=uid;}
if((this.currentUID!==uid&&isCurrentUserKnown)||this.currentDB!==db){this.currentUID=uid;this.currentDB=db;if(this.websocket){this.websocket.close(WEBSOCKET_CLOSE_CODES.CLEAN);}
this.channelsByClient.forEach((_,key)=>this.channelsByClient.set(key,[]));}
this.sendToClient(client,"initialized");}
_isWebsocketConnected(){return this.websocket&&this.websocket.readyState===1;}
_isWebsocketConnecting(){return this.websocket&&this.websocket.readyState===0;}
_isWebsocketClosing(){return this.websocket&&this.websocket.readyState===2;}
_onWebsocketClose({code,reason}){if(this.isDebug){console.debug(`%c${new Date().toLocaleString()} - [onClose]`,"color: #c6e; font-weight: bold;",code,reason);}
this.lastChannelSubscription=null;if(this.isReconnecting){return;}
this.broadcast("disconnect",{code,reason});if(code===WEBSOCKET_CLOSE_CODES.CLEAN){return;}
this.broadcast("reconnecting",{closeCode:code});this.isReconnecting=true;if(code===WEBSOCKET_CLOSE_CODES.KEEP_ALIVE_TIMEOUT){this.connectRetryDelay=0;}
if(code===WEBSOCKET_CLOSE_CODES.SESSION_EXPIRED){this.isWaitingForNewUID=true;}
this._retryConnectionWithDelay();}
_onWebsocketError(){if(this.isDebug){console.debug(`%c${new Date().toLocaleString()} - [onError]`,"color: #c6e; font-weight: bold;");}
this._retryConnectionWithDelay();}
_onWebsocketMessage(messageEv){const notifications=JSON.parse(messageEv.data);if(this.isDebug){console.debug(`%c${new Date().toLocaleString()} - [onMessage]`,"color: #c6e; font-weight: bold;",notifications);}
this.lastNotificationId=notifications[notifications.length-1].id;this.broadcast("notification",notifications);}
_onWebsocketOpen(){if(this.isDebug){console.debug(`%c${new Date().toLocaleString()} - [onOpen]`,"color: #c6e; font-weight: bold;");}
this._updateChannels();this.messageWaitQueue.forEach((msg)=>this.websocket.send(msg));this.messageWaitQueue=[];this.broadcast(this.isReconnecting?"reconnect":"connect");this.connectRetryDelay=this.INITIAL_RECONNECT_DELAY;this.connectTimeout=null;this.isReconnecting=false;}
_retryConnectionWithDelay(){this.connectRetryDelay=Math.min(this.connectRetryDelay*1.5,MAXIMUM_RECONNECT_DELAY)+
this.RECONNECT_JITTER*Math.random();this.connectTimeout=setTimeout(this._start.bind(this),this.connectRetryDelay);}
_sendToServer(message){const payload=JSON.stringify(message);if(!this._isWebsocketConnected()){this.messageWaitQueue.push(payload);}else{this.websocket.send(payload);}}
_start(){if(this._isWebsocketConnected()||this._isWebsocketConnecting()){return;}
if(this.websocket){this.websocket.removeEventListener("open",this._onWebsocketOpen);this.websocket.removeEventListener("message",this._onWebsocketMessage);this.websocket.removeEventListener("error",this._onWebsocketError);this.websocket.removeEventListener("close",this._onWebsocketClose);}
if(this._isWebsocketClosing()){this.lastChannelSubscription=null;this.broadcast("disconnect",{code:WEBSOCKET_CLOSE_CODES.ABNORMAL_CLOSURE});}
this.websocket=new WebSocket(this.websocketURL);this.websocket.addEventListener("open",this._onWebsocketOpen);this.websocket.addEventListener("error",this._onWebsocketError);this.websocket.addEventListener("message",this._onWebsocketMessage);this.websocket.addEventListener("close",this._onWebsocketClose);}
_stop(){clearTimeout(this.connectTimeout);this.connectRetryDelay=this.INITIAL_RECONNECT_DELAY;this.isReconnecting=false;this.lastChannelSubscription=null;if(this.websocket){this.websocket.close();}}
_updateChannels({force=false}={}){const allTabsChannels=[...new Set([].concat.apply([],[...this.channelsByClient.values()])),].sort();const allTabsChannelsString=JSON.stringify(allTabsChannels);const shouldUpdateChannelSubscription=allTabsChannelsString!==this.lastChannelSubscription;if(force||shouldUpdateChannelSubscription){this.lastChannelSubscription=allTabsChannelsString;this._sendToServer({event_name:"subscribe",data:{channels:allTabsChannels,last:this.lastNotificationId},});}}}
return __exports;});;

/* /bus/static/src/workers/websocket_worker_script.js */
odoo.define('@bus/workers/websocket_worker_script',['@bus/workers/websocket_worker'],function(require){'use strict';let __exports={};const{WebsocketWorker}=require("@bus/workers/websocket_worker");(function(){const websocketWorker=new WebsocketWorker();if(self.name.includes("shared")){onconnect=function(ev){const currentClient=ev.ports[0];websocketWorker.registerClient(currentClient);};}else{websocketWorker.registerClient(self);}})();return __exports;});;

/* /bus/static/src/workers/websocket_worker_utils.js */
odoo.define('@bus/workers/websocket_worker_utils',[],function(require){'use strict';let __exports={};__exports.debounce=debounce;function debounce(func,wait,immediate){let timeout;return function(){const context=this;const args=arguments;function later(){timeout=null;if(!immediate){func.apply(context,args);}}
const callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow){func.apply(context,args);}};}
return __exports;});;

/* /web/static/src/webclient/actions/reports/utils.js */
odoo.define('@web/webclient/actions/reports/utils',['@web/core/l10n/translation','@web/core/network/download'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{download}=require("@web/core/network/download");__exports.getReportUrl=getReportUrl;function getReportUrl(action,type,userContext){let url=`/report/${type}/${action.report_name}`;const actionContext=action.context||{};if(action.data&&JSON.stringify(action.data)!=="{}"){const options=encodeURIComponent(JSON.stringify(action.data));const context=encodeURIComponent(JSON.stringify(actionContext));url+=`?options=${options}&context=${context}`;}else{if(actionContext.active_ids){url+=`/${actionContext.active_ids.join(",")}`;}
if(type==="html"){const context=encodeURIComponent(JSON.stringify(userContext));url+=`?context=${context}`;}}
return url;}
function getWKHTMLTOPDF_MESSAGES(status){const link='<br><br><a href="http://wkhtmltopdf.org/" target="_blank">wkhtmltopdf.org</a>';const _status={broken:_t("Your installation of Wkhtmltopdf seems to be broken. The report will be shown in html.")+link,install:_t("Unable to find Wkhtmltopdf on this system. The report will be shown in html.")+
link,upgrade:_t("You should upgrade your version of Wkhtmltopdf to at least 0.12.0 in order to get a correct display of headers and footers as well as support for table-breaking between pages.")+link,workers:_t("You need to start Odoo with at least two workers to print a pdf version of the reports."),};return _status[status];}
__exports.downloadReport=downloadReport;async function downloadReport(rpc,action,type,userContext){let message;if(type==="pdf"){downloadReport.wkhtmltopdfStatusProm||=rpc("/report/check_wkhtmltopdf");const status=await downloadReport.wkhtmltopdfStatusProm;message=getWKHTMLTOPDF_MESSAGES(status);if(!["upgrade","ok"].includes(status)){return{success:false,message};}}
const url=getReportUrl(action,type);await download({url:"/report/download",data:{data:JSON.stringify([url,action.report_type]),context:JSON.stringify(userContext),},});return{success:true,message};}
return __exports;});;

/* /point_of_sale/static/src/app/barcode/barcode_reader_hook.js */
odoo.define('@point_of_sale/app/barcode/barcode_reader_hook',['@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{useComponent,useEffect}=require("@odoo/owl");__exports.useBarcodeReader=useBarcodeReader;function useBarcodeReader(callbackMap,exclusive=false){const current=useComponent();const barcodeReader=useService("barcode_reader");if(barcodeReader){for(const[key,callback]of Object.entries(callbackMap)){callbackMap[key]=callback.bind(current);}
useEffect(()=>barcodeReader.register(callbackMap,exclusive),()=>[]);}}
return __exports;});;

/* /point_of_sale/static/src/app/barcode/barcode_reader_service.js */
odoo.define('@point_of_sale/app/barcode/barcode_reader_service',['@web/core/l10n/translation','@web/core/registry','@web/core/utils/concurrency','@web/session','@point_of_sale/app/errors/popups/error_popup','@point_of_sale/app/barcode/error_popup/barcode_error_popup','@barcodes/js/barcode_parser','@barcodes_gs1_nomenclature/js/barcode_parser'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{Mutex}=require("@web/core/utils/concurrency");const{session}=require("@web/session");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{ErrorBarcodePopup}=require("@point_of_sale/app/barcode/error_popup/barcode_error_popup");const{BarcodeParser}=require("@barcodes/js/barcode_parser");const{GS1BarcodeError}=require("@barcodes_gs1_nomenclature/js/barcode_parser");const BarcodeReader=__exports.BarcodeReader=class BarcodeReader{static serviceDependencies=["popup","hardware_proxy"];constructor(parser,{popup,hardware_proxy}){this.parser=parser;this.popup=popup;this.hardwareProxy=hardware_proxy;this.setup();}
setup(){this.mutex=new Mutex();this.cbMaps=new Set();this.exclusiveCbMap=null;this.remoteScanning=false;this.remoteActive=0;}
register(cbMap,exclusive){if(exclusive){this.exclusiveCbMap=cbMap;}else{this.cbMaps.add(cbMap);}
return()=>{if(exclusive){this.exclusiveCbMap=null;}else{this.cbMaps.delete(cbMap);}};}
scan(code){return this.mutex.exec(()=>this._scan(code));}
async _scan(code){if(!code){return;}
const cbMaps=this.exclusiveCbMap?[this.exclusiveCbMap]:[...this.cbMaps];let parseBarcode;try{parseBarcode=this.parser.parse_barcode(code);if(Array.isArray(parseBarcode)&&!parseBarcode.some(element=>element.type==='product')){throw new GS1BarcodeError('The GS1 barcode must contain a product.');}}catch(error){if(this.fallbackParser&&error instanceof GS1BarcodeError){parseBarcode=this.fallbackParser.parse_barcode(code);}else{throw error;}}
if(Array.isArray(parseBarcode)){cbMaps.map((cb)=>cb.gs1?.(parseBarcode));}else{const cbs=cbMaps.map((cbMap)=>cbMap[parseBarcode.type]).filter(Boolean);if(cbs.length===0){this.popup.add(ErrorBarcodePopup,{code:this.codeRepr(parseBarcode)});}
for(const cb of cbs){await cb(parseBarcode);}}}
codeRepr(parsedBarcode){if(parsedBarcode.code.length>32){return parsedBarcode.code.substring(0,29)+"...";}else{return parsedBarcode.code;}}
connectToProxy(){this.remoteScanning=true;if(this.remoteActive>=1){return;}
this.remoteActive=1;this.waitForBarcode();}
async waitForBarcode(){const barcode=await this.hardwareProxy.message("scanner").catch(()=>{});if(!this.remoteScanning){this.remoteActive=0;return;}
this.scan(barcode);this.waitForBarcode();}
disconnectFromProxy(){this.remoteScanning=false;}}
const barcodeReaderService=__exports.barcodeReaderService={dependencies:[...BarcodeReader.serviceDependencies,"popup","barcode","orm"],async start(env,deps){const{popup,barcode,orm}=deps;let barcodeReader=null;if(session.nomenclature_id){const nomenclature=await BarcodeParser.fetchNomenclature(orm,session.nomenclature_id);const parser=new BarcodeParser({nomenclature});barcodeReader=new BarcodeReader(parser,deps);}
if(session.fallback_nomenclature_id&&barcodeReader){const fallbackNomenclature=await BarcodeParser.fetchNomenclature(orm,session.fallback_nomenclature_id);barcodeReader.fallbackParser=new BarcodeParser({nomenclature:fallbackNomenclature,});}
barcode.bus.addEventListener("barcode_scanned",(ev)=>{if(barcodeReader){barcodeReader.scan(ev.detail.barcode);}else{popup.add(ErrorPopup,{title:_t("Unable to parse barcode"),body:_t("No barcode nomenclature has been configured. This can be changed in the configuration settings."),});}});return barcodeReader;},};registry.category("services").add("barcode_reader",barcodeReaderService);return __exports;});;

/* /point_of_sale/static/src/app/barcode/error_popup/barcode_error_popup.js */
odoo.define('@point_of_sale/app/barcode/error_popup/barcode_error_popup',['@point_of_sale/app/errors/popups/error_popup','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{_t}=require("@web/core/l10n/translation");const ErrorBarcodePopup=__exports.ErrorBarcodePopup=class ErrorBarcodePopup extends ErrorPopup{static template="point_of_sale.ErrorBarcodePopup";static defaultProps={confirmText:_t("Ok"),cancelText:_t("Cancel"),title:_t("Error"),body:"",message:_t("The Point of Sale could not find any product, customer, employee or action associated with the scanned barcode."),};get translatedMessage(){return _t(this.props.message);}}
return __exports;});;

/* /point_of_sale/static/src/app/bus/pos_bus_service.js */
odoo.define('@point_of_sale/app/bus/pos_bus_service',['@web/core/registry'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const PosBus=__exports.PosBus=class PosBus{static serviceDependencies=["pos","orm","bus_service"];constructor(...args){this.setup(...args);}
setup(env,{pos,orm,bus_service}){this.pos=pos;this.orm=orm;bus_service.addChannel(`pos_session-${pos.pos_session.id}-${pos.pos_session.access_token}`);bus_service.addEventListener("notification",({detail})=>{for(const message of detail){this.dispatch(message);}});}
dispatch(message){}}
const posBusService=__exports.posBusService={dependencies:PosBus.serviceDependencies,async start(env,deps){return new PosBus(env,deps);},};registry.category("services").add("pos_bus",posBusService);return __exports;});;

/* /point_of_sale/static/src/app/customer_display/customer_display_service.js */
odoo.define('@point_of_sale/app/customer_display/customer_display_service',['@web/core/utils/timing','@web/core/registry','@web/core/utils/objects','@web/core/utils/reactive'],function(require){'use strict';let __exports={};const{batched}=require("@web/core/utils/timing");const{registry}=require("@web/core/registry");const{pick}=require("@web/core/utils/objects");const{Reactive,effect}=require("@web/core/utils/reactive");const LocalDisplay=__exports.LocalDisplay=class LocalDisplay extends Reactive{status="success";constructor(){super();this.setup(...arguments);}
setup(pos){this.pos=pos;}
async connect(){if(this.popupWindow&&!this.popupWindow.closed){return;}
this.popupWindow=window.open("","Customer Display","height=600,width=900");if(this.popupWindow&&!this.popupWindow.closed){this.setPopupWindowLastStatus(true);this.popupWindow.addEventListener("beforeunload",()=>{this.setPopupWindowLastStatus(false);});this.update({refreshResources:true});}else{this.setPopupWindowLastStatus(false);}}
setPopupWindowLastStatus(open){if(open){window.localStorage.setItem("pos-customerdisplay-local-open","true");}else{window.localStorage.removeItem("pos-customerdisplay-local-open");}}
isPopupWindowLastStatusOpen(){return window.localStorage.getItem("pos-customerdisplay-local-open")==="true";}
async update({refreshResources=false,closeUI=false}={}){if(!this.popupWindow||this.popupWindow.closed){if(this.isPopupWindowLastStatusOpen()){this.connect();}
return;}
const{body:displayBody,head:displayHead}=this.popupWindow.document;const container=document.createElement("div");container.innerHTML=await this.pos.customerDisplayHTML(closeUI);if(!container.innerHTML||container.innerHTML==="undefined"){displayBody.textContent="";return;}
if(displayHead.innerHTML.trim().length==0||refreshResources){displayHead.textContent="";displayHead.appendChild(container.querySelector(".resources"));const scriptContent=displayHead.querySelector("script#old_browser_fix_auto_scroll").innerHTML;this.popupWindow.eval(scriptContent);}
displayBody.textContent="";displayBody.appendChild(container.querySelector(".pos-customer_facing_display"));setTimeout(()=>{this.popupWindow.fixScrollingIfNecessary();},0);}}
const RemoteDisplay=__exports.RemoteDisplay=class RemoteDisplay extends Reactive{static serviceDependencies=["hardware_proxy"];status="failure";constructor(){super();this.setup(...arguments);}
setup(pos,{hardware_proxy}){this.hardwareProxy=hardware_proxy;this.pos=pos;this.updateStatus();}
async connect(){const html=await this.pos.customerDisplayHTML();try{const{status}=await this.hardwareProxy.message("take_control",{html});this.status=status==="success"?"success":"warning";this.updateStatus();}catch(error){this.status=error===undefined?"failure":"not_found";}}
async update({closeUI=false}={}){const html=await this.pos.customerDisplayHTML(closeUI);if(this.isUpdatingStatus&&this.hardwareProxy.connectionInfo.status==="connected"){return this.hardwareProxy.message("customer_facing_display",{html});}}
async updateStatus(){if(!this.hardwareProxy.host||this.isUpdatingStatus){return;}
this.isUpdatingStatus=true;while(this.isUpdatingStatus){try{const{status}=await this.hardwareProxy.message("test_ownership");this.status=status==="OWNER"?"success":"warning";}catch(error){if(error===undefined){this.status="failure";}else{this.status="not_found";this.isUpdatingStatus=false;return;}}
await new Promise((resolve)=>setTimeout(resolve,3000));}}}
const customerDisplayService=__exports.customerDisplayService={get dependencies(){return["pos",...RemoteDisplay.serviceDependencies];},start(env,deps){const pos=deps.pos;const{iface_customer_facing_display:enabled,iface_customer_facing_display_via_proxy:proxy,}=pos.config;if(!enabled){return;}
const display=proxy?new RemoteDisplay(pos,pick(deps,...RemoteDisplay.serviceDependencies)):new LocalDisplay(pos);effect(batched((display)=>display.update()),[display]);return display;},};registry.category("services").add("customer_display",customerDisplayService);return __exports;});;

/* /point_of_sale/static/src/app/debug/debug_service.js */
odoo.define('@point_of_sale/app/debug/debug_service',['@odoo/owl','@web/core/registry','@web/core/utils/reactive','@point_of_sale/app/debug/debug_widget'],function(require){'use strict';let __exports={};const{reactive}=require("@odoo/owl");const{registry}=require("@web/core/registry");const{withComputedProperties}=require("@web/core/utils/reactive");const{DebugWidget}=require("@point_of_sale/app/debug/debug_widget");const debugService=__exports.debugService={start(env){const internalState=reactive({widgetOpen:false});const state=withComputedProperties(reactive({}),[internalState],{showWidget(internalState){return env.debug&&internalState.widgetOpen;},});registry.category("main_components").add("DebugWidget",{Component:DebugWidget,props:{state},});return{toggleWidget(){internalState.widgetOpen=!internalState.widgetOpen;},};},};registry.category("services").add("debug",debugService);return __exports;});;

/* /point_of_sale/static/src/app/debug/debug_widget.js */
odoo.define('@point_of_sale/app/debug/debug_widget',['@web/core/l10n/translation','@web/views/fields/parsers','@web/core/transition','@point_of_sale/app/utils/movable_hook','@point_of_sale/app/utils/confirm_popup/confirm_popup','@point_of_sale/app/debug/order_import_popup/order_import_popup','@web/core/utils/hooks','@odoo/owl','@point_of_sale/app/store/pos_hook','@web/core/l10n/dates'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{parseFloat}=require("@web/views/fields/parsers");const{Transition}=require("@web/core/transition");const{constrain,getLimits,useMovable}=require("@point_of_sale/app/utils/movable_hook");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{OrderImportPopup}=require("@point_of_sale/app/debug/order_import_popup/order_import_popup");const{useBus,useService}=require("@web/core/utils/hooks");const{useEffect,useRef,useState,Component}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{serializeDateTime}=require("@web/core/l10n/dates");const{DateTime}=luxon;const DebugWidget=__exports.DebugWidget=class DebugWidget extends Component{static components={Transition};static template="point_of_sale.DebugWidget";static props={state:{type:Object,shape:{showWidget:Boolean}}};setup(){this.pos=usePos();this.debug=useService("debug");this.popup=useService("popup");this.barcodeReader=useService("barcode_reader");this.hardwareProxy=useService("hardware_proxy");const numberBuffer=useService("number_buffer");useBus(numberBuffer,"buffer-update",this._onBufferUpdate);this.state=useState({barcodeInput:"",weightInput:"",isPaidOrdersReady:false,isUnpaidOrdersReady:false,buffer:numberBuffer.get(),});this.root=useRef("root");this.position=useState({left:null,top:null});useEffect((root)=>{this.position.left=root?.offsetLeft;this.position.top=root?.offsetTop;},()=>[this.root.el]);let posBeforeMove;useMovable({ref:this.root,onMoveStart:()=>{posBeforeMove={...this.position};},onMove:({dx,dy})=>{const{minX,minY,maxX,maxY}=getLimits(this.root.el,document.body);this.position.left=constrain(posBeforeMove.left+dx,minX,maxX);this.position.top=constrain(posBeforeMove.top+dy,minY,maxY);},});for(const eventName of["open_cashbox","print_receipt","scale_read"]){const ref=useRef(eventName);let animation;useBus(this.hardwareProxy,`send_message:${eventName}`,()=>{animation?.cancel();animation=ref.el?.animate({backgroundColor:["#6CD11D","#1E1E1E"]},2000);});}}
toggleWidget(){this.state.isShown=!this.state.isShown;}
setWeight(){var weightInKg=parseFloat(this.state.weightInput);if(!isNaN(weightInKg)){this.hardwareProxy.setDebugWeight(weightInKg);}}
resetWeight(){this.state.weightInput="";this.hardwareProxy.resetDebugWeight();}
async barcodeScan(){if(!this.barcodeReader){return;}
await this.barcodeReader.scan(this.state.barcodeInput);}
async barcodeScanEAN(){if(!this.barcodeReader){return;}
const ean=this.barcodeReader.parser.sanitize_ean(this.state.barcodeInput||"0");this.state.barcodeInput=ean;await this.barcodeReader.scan(ean);}
async deleteOrders(){const{confirmed}=await this.popup.add(ConfirmPopup,{title:_t("Delete Paid Orders?"),body:_t("This operation will permanently destroy all paid orders from the local storage. You will lose all the data. This operation cannot be undone."),});if(confirmed){this.pos.db.remove_all_orders();this.pos.set_synch("connected",0);}}
async deleteUnpaidOrders(){const{confirmed}=await this.popup.add(ConfirmPopup,{title:_t("Delete Unpaid Orders?"),body:_t("This operation will destroy all unpaid orders in the browser. You will lose all the unsaved data and exit the point of sale. This operation cannot be undone."),});if(confirmed){this.pos.db.remove_all_unpaid_orders();window.location="/";}}
_createBlob(contents){if(typeof contents!=="string"){contents=JSON.stringify(contents,null,2);}
return new Blob([contents]);}
preparePaidOrders(){try{this.paidOrdersBlob=this._createBlob(this.pos.export_paid_orders());this.state.isPaidOrdersReady=true;}catch(error){console.warn(error);}}
get paidOrdersFilename(){return`${_t("paid orders")} ${serializeDateTime(DateTime.now()).replace(
            /:|\s/gi,
            "-"
        )}.json`;}
get paidOrdersURL(){var URL=window.URL||window.webkitURL;return URL.createObjectURL(this.paidOrdersBlob);}
prepareUnpaidOrders(){try{this.unpaidOrdersBlob=this._createBlob(this.pos.export_unpaid_orders());this.state.isUnpaidOrdersReady=true;}catch(error){console.warn(error);}}
get unpaidOrdersFilename(){return`${_t("unpaid orders")} ${serializeDateTime(DateTime.now()).replace(
            /:|\s/gi,
            "-"
        )}.json`;}
get unpaidOrdersURL(){var URL=window.URL||window.webkitURL;return URL.createObjectURL(this.unpaidOrdersBlob);}
async importOrders(event){const file=event.target.files[0];if(file){const report=this.pos.import_orders(await file.text());await this.popup.add(OrderImportPopup,{report});}}
refreshDisplay(){this.hardwareProxy.message("display_refresh",{});}
_onBufferUpdate({detail:value}){this.state.buffer=value;}
get bufferRepr(){return`"${this.state.buffer}"`;}
get style(){const{left,top}=this.position;return top===null?"":`position: absolute; left: ${left}px; top: ${top}px;`;}}
return __exports;});;

/* /point_of_sale/static/src/app/debug/order_import_popup/order_import_popup.js */
odoo.define('@point_of_sale/app/debug/order_import_popup/order_import_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{_t}=require("@web/core/l10n/translation");const OrderImportPopup=__exports.OrderImportPopup=class OrderImportPopup extends AbstractAwaitablePopup{static template="point_of_sale.OrderImportPopup";static defaultProps={confirmText:_t("Ok"),cancelKey:false,body:"",};get unpaidSkipped(){return((this.props.report.unpaid_skipped_existing||0)+
(this.props.report.unpaid_skipped_session||0));}
getPayload(){}}
return __exports;});;

/* /point_of_sale/static/src/app/errors/error_handlers.js */
odoo.define('@point_of_sale/app/errors/error_handlers',['@web/core/registry','@web/core/errors/error_dialogs','@web/core/network/rpc_service','@point_of_sale/app/errors/popups/error_popup','@point_of_sale/app/errors/popups/error_traceback_popup','@point_of_sale/app/errors/popups/offline_error_popup','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{odooExceptionTitleMap}=require("@web/core/errors/error_dialogs");const{ConnectionLostError,RPCError}=require("@web/core/network/rpc_service");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{ErrorTracebackPopup}=require("@point_of_sale/app/errors/popups/error_traceback_popup");const{OfflineErrorPopup}=require("@point_of_sale/app/errors/popups/offline_error_popup");const{_t}=require("@web/core/l10n/translation");function rpcErrorHandler(env,error,originalError){const rpcError=error instanceof RPCError?error:(originalError instanceof RPCError?originalError:null);if(rpcError){const{message,data}=rpcError;if(odooExceptionTitleMap.has(rpcError.exceptionName)){const title=odooExceptionTitleMap.get(rpcError.exceptionName).toString();env.services.popup.add(ErrorPopup,{title,body:data.message});}else{env.services.popup.add(ErrorTracebackPopup,{title:message,body:data.message+"\n"+data.debug+"\n",});}
return true;}}
registry.category("error_handlers").add("rpcErrorHandler",rpcErrorHandler);function offlineErrorHandler(env,error,originalError){if(error instanceof ConnectionLostError||originalError instanceof ConnectionLostError){env.services.popup.add(OfflineErrorPopup);return true;}}
registry.category("error_handlers").add("offlineErrorHandler",offlineErrorHandler);function defaultErrorHandler(env,error,originalError){if(error instanceof Error){env.services.popup.add(ErrorTracebackPopup,{title:`${originalError.name}: ${originalError.message}`,body:error.traceback,});}else{env.services.popup.add(ErrorPopup,{title:_t("Unknown Error"),body:_t("Unable to show information about this error."),});}
return true;}
registry.category("error_handlers").add("defaultErrorHandler",defaultErrorHandler,{sequence:99});return __exports;});;

/* /point_of_sale/static/src/app/errors/popups/error_popup.js */
odoo.define('@point_of_sale/app/errors/popups/error_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@web/core/l10n/translation','@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{_t}=require("@web/core/l10n/translation");const{useService}=require("@web/core/utils/hooks");const{onMounted}=require("@odoo/owl");const ErrorPopup=__exports.ErrorPopup=class ErrorPopup extends AbstractAwaitablePopup{static template="point_of_sale.ErrorPopup";static defaultProps={confirmText:_t("Ok"),title:_t("Error"),cancelKey:false,sound:true,};setup(){super.setup();onMounted(this.onMounted);this.sound=useService("sound");}
onMounted(){if(this.sound){this.sound.play("error");}}}
return __exports;});;

/* /point_of_sale/static/src/app/errors/popups/error_traceback_popup.js */
odoo.define('@point_of_sale/app/errors/popups/error_traceback_popup',['@point_of_sale/app/errors/popups/error_popup','@web/core/l10n/translation','@point_of_sale/app/store/pos_hook','@web/core/l10n/dates'],function(require){'use strict';let __exports={};const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{_t}=require("@web/core/l10n/translation");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{serializeDateTime}=require("@web/core/l10n/dates");const{DateTime}=luxon;const ErrorTracebackPopup=__exports.ErrorTracebackPopup=class ErrorTracebackPopup extends ErrorPopup{static template="point_of_sale.ErrorTracebackPopup";static defaultProps={confirmText:_t("Ok"),cancelText:_t("Cancel"),confirmKey:false,title:_t("Error with Traceback"),body:"",exitButtonIsShown:false,exitButtonText:_t("Exit Pos"),};setup(){this.pos=usePos();}
get tracebackUrl(){const blob=new Blob([this.props.body]);const URL=window.URL||window.webkitURL;return URL.createObjectURL(blob);}
get tracebackFilename(){return`${_t("error")} ${serializeDateTime(DateTime.now()).replace(/:|\s/gi, "-")}.txt`;}
emailTraceback(){const address=this.pos.company.email;const subject=_t("IMPORTANT: Bug Report From Odoo Point Of Sale");window.open("mailto:"+
address+"?subject="+
(subject?window.encodeURIComponent(subject):"")+"&body="+
(this.props.body?window.encodeURIComponent(this.props.body):""));}}
return __exports;});;

/* /point_of_sale/static/src/app/errors/popups/offline_error_popup.js */
odoo.define('@point_of_sale/app/errors/popups/offline_error_popup',['@point_of_sale/app/store/pos_hook','@point_of_sale/app/errors/popups/error_popup','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{usePos}=require("@point_of_sale/app/store/pos_hook");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{_t}=require("@web/core/l10n/translation");const OfflineErrorPopup=__exports.OfflineErrorPopup=class OfflineErrorPopup extends ErrorPopup{static template="point_of_sale.OfflineErrorPopup";static dontShow=false;static defaultProps={confirmText:_t("Continue with limited functionalities"),title:_t("You're offline"),body:_t("Meanwhile connection is back, Odoo Point of Sale will operate limited operations. Check your connection or continue with limited functionalities"),};setup(){super.setup(...arguments);this.pos=usePos();if(!this.pos.showOfflineWarning){this.cancel();}else{this.pos.set_synch("disconnected");}}
confirm(){this.pos.showOfflineWarning=false;this.cancel();}}
return __exports;});;

/* /point_of_sale/static/src/app/generic_components/category_selector/category_selector.js */
odoo.define('@point_of_sale/app/generic_components/category_selector/category_selector',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const CategorySelector=__exports.CategorySelector=class CategorySelector extends Component{static template="point_of_sale.CategorySelector";static props={categories:{type:Array,element:Object,shape:{id:Number,name:{type:String,optional:true},icon:{type:String,optional:true},separator:{type:String,optional:true},showSeparator:{type:Boolean,optional:true},imageUrl:{type:[String,Boolean],optional:true},},},class:{type:String,optional:true},showImage:{type:Boolean,optional:true},onClick:{type:Function},};static defaultProps={class:"",showImage:true,showSeparator:false,};}
return __exports;});;

/* /point_of_sale/static/src/app/generic_components/centered_icon/centered_icon.js */
odoo.define('@point_of_sale/app/generic_components/centered_icon/centered_icon',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component,xml}=require("@odoo/owl");const CenteredIcon=__exports.CenteredIcon=class CenteredIcon extends Component{static props={icon:String,text:{type:String,optional:true},class:{type:String,optional:true},};static defaultProps={class:"",};static template=xml`
        <div t-attf-class="{{props.class}} d-flex flex-column align-items-center justify-content-center h-100 w-100  text-muted">
            <i t-attf-class="fa {{props.icon}}" role="img" />
            <h3 t-if="props.text" t-esc="props.text" class="w-75 mt-2 text-center"/>
        </div>
    `;}
return __exports;});;

/* /point_of_sale/static/src/app/generic_components/inputs/input/input.js */
odoo.define('@point_of_sale/app/generic_components/inputs/input/input',['@odoo/owl','@web/core/utils/hooks','@web/core/utils/timing','@point_of_sale/app/generic_components/inputs/t_model_input'],function(require){'use strict';let __exports={};const{useRef,useState}=require("@odoo/owl");const{useAutofocus}=require("@web/core/utils/hooks");const{debounce}=require("@web/core/utils/timing");const{TModelInput}=require("@point_of_sale/app/generic_components/inputs/t_model_input");const Input=__exports.Input=class Input extends TModelInput{static template="point_of_sale.input";static props={...super.props,isSmall:{type:Boolean,optional:true},debounceMillis:{type:Number,optional:true},icon:{type:Object,optional:true,shape:{type:String,value:String},},getRef:{type:Function,optional:true},autofocus:{type:Boolean,optional:true},autofocusMobile:{type:Boolean,optional:true},iconOnLeftSide:{type:Boolean,optional:true},isValid:{type:Function,optional:true},placeholder:{type:String,optional:true},class:{type:String,optional:true},callback:{type:Function,optional:true},};static defaultProps={class:"",isSmall:false,debounceMillis:0,icon:{},placeholder:"",autofocus:false,autofocusMobile:false,iconOnLeftSide:true,isValid:()=>true,};setup(){this.state=useState({isOpen:false});this.setValue=debounce(this.setValue,this.props.debounceMillis);this.props.getRef?.((this.props.autofocus&&useAutofocus({refName:"input",mobile:this.props.autofocusMobile}))||useRef("input"));}
setValue(newValue,tModel=this.props.tModel){super.setValue(newValue,tModel);this.props.callback?.(newValue);}}
return __exports;});;

/* /point_of_sale/static/src/app/generic_components/inputs/numeric_input/numeric_input.js */
odoo.define('@point_of_sale/app/generic_components/inputs/numeric_input/numeric_input',['@point_of_sale/app/generic_components/inputs/t_model_input'],function(require){'use strict';let __exports={};const{TModelInput}=require("@point_of_sale/app/generic_components/inputs/t_model_input");const NumericInput=__exports.NumericInput=class NumericInput extends TModelInput{static template="point_of_sale.NumericInput";static props={...super.props,class:{type:String,optional:true},min:{type:Number,optional:true},};static defaultProps={class:""};parseInt(value){return parseInt(value);}}
return __exports;});;

/* /point_of_sale/static/src/app/generic_components/inputs/t_model_input.js */
odoo.define('@point_of_sale/app/generic_components/inputs/t_model_input',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const TModelInput=__exports.TModelInput=class TModelInput extends Component{static props={tModel:Array};getValue(tModel=this.props.tModel){const[obj,key]=tModel;return obj[key];}
setValue(newValue,tModel=this.props.tModel){const[obj,key]=tModel;obj[key]=newValue;}}
return __exports;});;

/* /point_of_sale/static/src/app/generic_components/numpad/numpad.js */
odoo.define('@point_of_sale/app/generic_components/numpad/numpad',['@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{Component}=require("@odoo/owl");const Numpad=__exports.Numpad=class Numpad extends Component{static template="point_of_sale.Numpad";static props={class:{type:String,optional:true},onClick:{type:Function,optional:true},buttons:{type:Array,element:{type:Object,shape:{value:String,text:{type:String,optional:true},class:{type:String,optional:true},disabled:{type:Boolean,optional:true},},},},};static defaultProps={class:"",};setup(){if(!this.props.onClick){this.numberBuffer=useService("number_buffer");this.onClick=(buttonValue)=>this.numberBuffer.sendKey(buttonValue);}else{this.onClick=this.props.onClick;}}}
return __exports;});;

/* /point_of_sale/static/src/app/generic_components/odoo_logo/odoo_logo.js */
odoo.define('@point_of_sale/app/generic_components/odoo_logo/odoo_logo',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const OdooLogo=__exports.OdooLogo=class OdooLogo extends Component{static template="point_of_sale.OdooLogo";static props={class:{type:String,optional:true},style:{type:String,optional:true},monochrome:{type:Boolean,optional:true},};static defaultProps={class:"",style:"",monochrome:false,};}
return __exports;});;

/* /point_of_sale/static/src/app/generic_components/order_widget/order_widget.js */
odoo.define('@point_of_sale/app/generic_components/order_widget/order_widget',['@odoo/owl','@point_of_sale/app/generic_components/centered_icon/centered_icon','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{Component,useEffect,useRef}=require("@odoo/owl");const{CenteredIcon}=require("@point_of_sale/app/generic_components/centered_icon/centered_icon");const{_t}=require("@web/core/l10n/translation");const OrderWidget=__exports.OrderWidget=class OrderWidget extends Component{static template="point_of_sale.OrderWidget";static props={lines:{type:Array,element:Object},slots:{type:Object},total:{type:String,optional:true},tax:{type:String,optional:true},};static components={CenteredIcon};setup(){this.scrollableRef=useRef("scrollable");useEffect(()=>{this.scrollableRef.el?.querySelector(".orderline.selected")?.scrollIntoView({behavior:"smooth",block:"start"});});}
emptyCartText(){return _t("Start adding products");}}
return __exports;});;

/* /point_of_sale/static/src/app/generic_components/orderline/orderline.js */
odoo.define('@point_of_sale/app/generic_components/orderline/orderline',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const Orderline=__exports.Orderline=class Orderline extends Component{static template="point_of_sale.Orderline";static props={class:{type:Object,optional:true},line:{type:Object,shape:{productName:String,price:String,qty:String,unit:{type:String,optional:true},unitPrice:String,discount:{type:String,optional:true},comboParent:{type:String,optional:true},oldUnitPrice:{type:String,optional:true},customerNote:{type:String,optional:true},internalNote:{type:String,optional:true},attributes:{type:Array,optional:true},"*":true,},},slots:{type:Object,optional:true},};static defaultProps={class:{},};}
return __exports;});;

/* /point_of_sale/static/src/app/generic_components/product_card/product_card.js */
odoo.define('@point_of_sale/app/generic_components/product_card/product_card',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const ProductCard=__exports.ProductCard=class ProductCard extends Component{static template="point_of_sale.ProductCard";static props={class:{String,optional:true},name:String,productId:Number,price:String,imageUrl:[String,Boolean],productInfo:{Boolean,optional:true},onClick:{type:Function,optional:true},onProductInfoClick:{type:Function,optional:true},};static defaultProps={onClick:()=>{},class:"",};}
return __exports;});;

/* /point_of_sale/static/src/app/hardware_proxy/hardware_proxy_service.js */
odoo.define('@point_of_sale/app/hardware_proxy/hardware_proxy_service',['@point_of_sale/app/printer/hw_printer','@odoo/owl','@web/core/browser/browser','@web/core/registry','@point_of_sale/utils','@web/core/utils/reactive'],function(require){'use strict';let __exports={};const{HWPrinter}=require("@point_of_sale/app/printer/hw_printer");const{EventBus,reactive}=require("@odoo/owl");const{browser}=require("@web/core/browser/browser");const{registry}=require("@web/core/registry");const{deduceUrl}=require("@point_of_sale/utils");const{effect}=require("@web/core/utils/reactive");const HardwareProxy=__exports.HardwareProxy=class HardwareProxy extends EventBus{static serviceDependencies=["rpc"];constructor(){super();this.setup(...arguments);}
setup({rpc}){this.rpc=rpc;this.debugWeight=0;this.useDebugWeight=false;this.host="";this.keptalive=false;this.connectionInfo=reactive({status:"init",drivers:{}});effect((info)=>{if(info.status==="connected"&&this.printer){this.printer.printReceipt();}},[this.connectionInfo]);}
setConnectionInfo(info){Object.assign(this.connectionInfo,info);if(!info.drivers&&this.connectionInfo.status==="disconnected"){this.connectionInfo.drivers={};}}
disconnect(){if(this.connectionInfo.status!=="disconnected"){this.host=null;this.setConnectionInfo({status:"disconnected"});}}
async connect(){if(this.pos.config.iface_print_via_proxy){this.connectToPrinter();}
try{if(await this.message("handshake")){this.setConnectionInfo({status:"connected"});localStorage.hw_proxy_url=this.host;this.keepalive();}else{this.setConnectionInfo({status:"disconnected"});console.error("Connection refused by the Proxy");}}catch{this.setConnectionInfo({status:"disconnected"});console.error("Could not connect to the Proxy");}}
connectToPrinter(){this.printer=new HWPrinter({rpc:this.rpc,url:this.host});}
async autoconnect(options){this.setConnectionInfo({status:"connecting",drivers:{}});let url=options.force_ip||localStorage.hw_proxy_url;if(!url){return new Promise(()=>{});}
url=deduceUrl(url);if(await this.checkProxyAvailability(url)){this.host=url;return this.connect(url);}}
keepalive(){const status=()=>{const always=()=>setTimeout(status,5000);const xhr=new browser.XMLHttpRequest();xhr.timeout=2500;this.rpc(`${this.host}/hw_proxy/status_json`,{},{silent:true,xhr}).then((drivers)=>this.setConnectionInfo({status:"connected",drivers}),()=>{if(this.connectionInfo.status!=="connecting"){this.setConnectionInfo({status:"disconnected"});}}).then(always,always);};if(!this.keptalive){this.keptalive=true;status();}}
message(name,params){this.dispatchEvent(new CustomEvent(`send_message:${name}`));if(this.connectionInfo.status==="disconnected"){return Promise.reject();}
return this.rpc(`${this.host}/hw_proxy/${name}`,params,{silent:true});}
async checkProxyAvailability(url){this.setConnectionInfo({status:"connecting"});const maxRetries=3;for(let i=0;i<=maxRetries;i++){const timeoutController=new AbortController();setTimeout(()=>timeoutController.abort(),1000);const response=await browser.fetch(`${url}/hw_proxy/hello`,{signal:timeoutController.signal,}).catch(()=>({}));if(response.ok){return true;}}
this.setConnectionInfo({status:"disconnected"});return false;}
readScale(){if(this.useDebugWeight){return this.debugWeight;}
return this.message("scale_read").then(({weight})=>weight).catch(()=>0);}
setDebugWeight(weight){this.useDebugWeight=true;this.debugWeight=weight;}
resetDebugWeight(){this.useDebugWeight=false;this.debugWeight=0;}
log(){return this.message("log",{arguments:[...arguments]});}
async openCashbox(action=false){if(this.pos.config.iface_cashdrawer&&this.printer&&["connected","init"].includes(this.connectionInfo.status)){this.printer.openCashbox();if(action){this.pos.logEmployeeMessage(action,"CASH_DRAWER_ACTION");}}}}
const hardwareProxyService=__exports.hardwareProxyService={dependencies:HardwareProxy.serviceDependencies,start(env,deps){return new HardwareProxy(deps);},};registry.category("services").add("hardware_proxy",hardwareProxyService);return __exports;});;

/* /point_of_sale/static/src/app/loader/loader.js */
odoo.define('@point_of_sale/app/loader/loader',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component,useEffect}=require("@odoo/owl");const Loader=__exports.Loader=class Loader extends Component{static template="point_of_sale.Loader";static props={loader:{type:Object,shape:{isShown:Boolean}}};setup(){useEffect((isShown)=>{if(!isShown){setTimeout(()=>{this.__owl__.app.destroy();},1000);}},()=>[this.props.loader.isShown]);}}
return __exports;});;

/* /point_of_sale/static/src/app/navbar/back_button/back_button.js */
odoo.define('@point_of_sale/app/navbar/back_button/back_button',['@odoo/owl','@web/core/utils/hooks','@point_of_sale/app/store/pos_hook','@point_of_sale/app/screens/ticket_screen/ticket_screen'],function(require){'use strict';let __exports={};const{Component,useState}=require("@odoo/owl");const{useService}=require("@web/core/utils/hooks");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{TicketScreen}=require("@point_of_sale/app/screens/ticket_screen/ticket_screen");const BackButton=__exports.BackButton=class BackButton extends Component{static template="point_of_sale.BackButton";setup(){this.pos=usePos();this.ui=useState(useService("ui"));}
async onClick(){if(this.pos.mainScreen.component===TicketScreen){if(this.pos.ticket_screen_mobile_pane=="left"){this.pos.closeScreen();}else{this.pos.ticket_screen_mobile_pane="left";}}else{this.pos.mobile_pane="right";this.pos.showScreen("ProductScreen");}}}
return __exports;});;

/* /point_of_sale/static/src/app/navbar/cash_move_popup/cash_move_popup.js */
odoo.define('@point_of_sale/app/navbar/cash_move_popup/cash_move_popup',['@web/core/l10n/translation','@web/core/utils/hooks','@web/views/fields/parsers','@odoo/owl','@point_of_sale/app/store/pos_hook','@point_of_sale/app/popup/abstract_awaitable_popup','@point_of_sale/app/navbar/cash_move_popup/cash_move_receipt/cash_move_receipt','@point_of_sale/app/utils/hooks','@point_of_sale/app/generic_components/inputs/input/input'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{useService}=require("@web/core/utils/hooks");const{parseFloat}=require("@web/views/fields/parsers");const{useState}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{CashMoveReceipt}=require("@point_of_sale/app/navbar/cash_move_popup/cash_move_receipt/cash_move_receipt");const{useAsyncLockedMethod}=require("@point_of_sale/app/utils/hooks");const{Input}=require("@point_of_sale/app/generic_components/inputs/input/input");const CashMovePopup=__exports.CashMovePopup=class CashMovePopup extends AbstractAwaitablePopup{static template="point_of_sale.CashMovePopup";static components={Input};setup(){super.setup();this.notification=useService("pos_notification");this.popup=useService("popup");this.orm=useService("orm");this.pos=usePos();this.hardwareProxy=useService("hardware_proxy");this.printer=useService("printer");this.state=useState({type:"out",amount:"",reason:"",});this.confirm=useAsyncLockedMethod(this.confirm);}
async confirm(){const amount=parseFloat(this.state.amount);const formattedAmount=this.env.utils.formatCurrency(amount);if(!amount){this.notification.add(_t("Cash in/out of %s is ignored.",formattedAmount),3000);return this.props.close();}
const type=this.state.type;const translatedType=_t(type);const extras={formattedAmount,translatedType};const reason=this.state.reason.trim();await this.orm.call("pos.session","try_cash_in_out",[[this.pos.pos_session.id],type,amount,reason,extras,]);await this.pos.logEmployeeMessage(`${_t("Cash")} ${translatedType} - ${_t("Amount")}: ${formattedAmount}`,"CASH_DRAWER_ACTION");await this.printer.print(CashMoveReceipt,{reason,translatedType,formattedAmount,headerData:this.pos.getReceiptHeaderData(),date:new Date().toLocaleString(),});this.props.close();this.notification.add(_t("Successfully made a cash %s of %s.",type,formattedAmount),3000);}
_onAmountKeypress(event){if(["-","+"].includes(event.key)){event.preventDefault();}}
_onWindowKeyup(event){if(event.key===this.props.confirmKey&&!["TEXTAREA"].includes(event.target.tagName)){this.confirm();}else{super._onWindowKeyup(...arguments);}}
onClickButton(type){this.state.type=type;this.inputRef.el.focus();}
format(value){return this.env.utils.isValidFloat(value)?this.env.utils.formatCurrency(parseFloat(value)):"";}}
return __exports;});;

/* /point_of_sale/static/src/app/navbar/cash_move_popup/cash_move_receipt/cash_move_receipt.js */
odoo.define('@point_of_sale/app/navbar/cash_move_popup/cash_move_receipt/cash_move_receipt',['@odoo/owl','@point_of_sale/app/screens/receipt_screen/receipt/receipt_header/receipt_header'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{ReceiptHeader}=require("@point_of_sale/app/screens/receipt_screen/receipt/receipt_header/receipt_header");const CashMoveReceipt=__exports.CashMoveReceipt=class CashMoveReceipt extends Component{static template="point_of_sale.CashMoveReceipt";static components={ReceiptHeader};static props={reason:String,translatedType:String,formattedAmount:String,headerData:Object,date:String,};}
return __exports;});;

/* /point_of_sale/static/src/app/navbar/cashier_name/cashier_name.js */
odoo.define('@point_of_sale/app/navbar/cashier_name/cashier_name',['@odoo/owl','@point_of_sale/app/store/pos_hook','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{Component,useState}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{useService}=require("@web/core/utils/hooks");const CashierName=__exports.CashierName=class CashierName extends Component{static template="point_of_sale.CashierName";setup(){this.pos=usePos();this.ui=useState(useService("ui"));}
get username(){const{name}=this.pos.get_cashier();return name?name:"";}
get avatar(){const user_id=this.pos.get_cashier_user_id();const id=user_id?user_id:-1;return`/web/image/res.users/${id}/avatar_128`;}
get cssClass(){return{"not-clickable":true};}}
return __exports;});;

/* /point_of_sale/static/src/app/navbar/closing_popup/closing_popup.js */
odoo.define('@point_of_sale/app/navbar/closing_popup/closing_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@point_of_sale/app/navbar/sale_details_button/sale_details_button','@point_of_sale/app/utils/confirm_popup/confirm_popup','@point_of_sale/app/utils/money_details_popup/money_details_popup','@web/core/utils/hooks','@odoo/owl','@point_of_sale/app/errors/popups/error_popup','@web/core/network/rpc_service','@web/core/l10n/translation','@point_of_sale/app/store/pos_hook','@web/views/fields/parsers','@point_of_sale/app/generic_components/inputs/input/input','@point_of_sale/app/utils/hooks'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{SaleDetailsButton}=require("@point_of_sale/app/navbar/sale_details_button/sale_details_button");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{MoneyDetailsPopup}=require("@point_of_sale/app/utils/money_details_popup/money_details_popup");const{useService}=require("@web/core/utils/hooks");const{useState}=require("@odoo/owl");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{ConnectionLostError}=require("@web/core/network/rpc_service");const{_t}=require("@web/core/l10n/translation");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{parseFloat}=require("@web/views/fields/parsers");const{Input}=require("@point_of_sale/app/generic_components/inputs/input/input");const{useAsyncLockedMethod}=require("@point_of_sale/app/utils/hooks");const ClosePosPopup=__exports.ClosePosPopup=class ClosePosPopup extends AbstractAwaitablePopup{static components={SaleDetailsButton,Input};static template="point_of_sale.ClosePosPopup";static props=["orders_details","opening_notes","default_cash_details","other_payment_methods","is_manager","amount_authorized_diff","id","resolve","zIndex","close","confirmKey","cancelKey",];setup(){super.setup();this.pos=usePos();this.popup=useService("popup");this.orm=useService("orm");this.report=useService("report");this.hardwareProxy=useService("hardware_proxy");this.customerDisplay=useService("customer_display");this.state=useState(this.getInitialState());this.confirm=useAsyncLockedMethod(this.confirm);}
getInitialState(){const initialState={notes:"",payments:{}};if(this.pos.config.cash_control){initialState.payments[this.props.default_cash_details.id]={counted:"0",};}
this.props.other_payment_methods.forEach((pm)=>{if(pm.type==="bank"){initialState.payments[pm.id]={counted:this.env.utils.formatCurrency(pm.amount,false),};}});return initialState;}
async confirm(){if(!this.pos.config.cash_control||this.env.utils.floatIsZero(this.getMaxDifference())){await this.closeSession();return;}
if(this.hasUserAuthority()){const{confirmed}=await this.popup.add(ConfirmPopup,{title:_t("Payments Difference"),body:_t("Do you want to accept payments difference and post a profit/loss journal entry?"),});if(confirmed){await this.closeSession();}
return;}
await this.popup.add(ConfirmPopup,{title:_t("Payments Difference"),body:_t("The maximum difference allowed is %s.\nPlease contact your manager to accept the closing difference.",this.env.utils.formatCurrency(this.props.amount_authorized_diff)),confirmText:_t("OK"),});}
async cancel(){if(this.canCancel()){super.cancel();}}
canConfirm(){return Object.values(this.state.payments).map((v)=>v.counted).every(this.env.utils.isValidFloat);}
async openDetailsPopup(){const action=_t("Cash control - closing");this.hardwareProxy.openCashbox(action);const{confirmed,payload}=await this.popup.add(MoneyDetailsPopup,{moneyDetails:this.moneyDetails,action:action,});if(confirmed){const{total,moneyDetailsNotes,moneyDetails}=payload;this.state.payments[this.props.default_cash_details.id].counted=this.env.utils.formatCurrency(total,false);if(moneyDetailsNotes){this.state.notes=moneyDetailsNotes;}
this.moneyDetails=moneyDetails;}}
async downloadSalesReport(){return this.report.doAction("point_of_sale.sale_details_report",[this.pos.pos_session.id]);}
setManualCashInput(amount){if(this.env.utils.isValidFloat(amount)&&this.moneyDetails){this.state.notes="";this.moneyDetails=null;}}
getDifference(paymentId){const counted=this.state.payments[paymentId].counted;if(!this.env.utils.isValidFloat(counted)){return NaN;}
const expectedAmount=paymentId===this.props.default_cash_details?.id?this.props.default_cash_details.amount:this.props.other_payment_methods.find((pm)=>pm.id===paymentId).amount;return parseFloat(counted)-expectedAmount;}
getMaxDifference(){return Math.max(...Object.keys(this.state.payments).map((id)=>Math.abs(this.getDifference(parseInt(id)))));}
hasUserAuthority(){return(this.props.is_manager||this.props.amount_authorized_diff==null||this.getMaxDifference()<=this.props.amount_authorized_diff);}
canCancel(){return true;}
async closeSession(){this.customerDisplay?.update({closeUI:true});const syncSuccess=await this.pos.push_orders_with_closing_popup();if(!syncSuccess){return;}
if(this.pos.config.cash_control){const response=await this.orm.call("pos.session","post_closing_cash_details",[this.pos.pos_session.id],{counted_cash:parseFloat(this.state.payments[this.props.default_cash_details.id].counted),});if(!response.successful){return this.handleClosingError(response);}}
try{await this.orm.call("pos.session","update_closing_control_state_session",[this.pos.pos_session.id,this.state.notes,]);}catch(error){if(!error.data&&error.data.message!=="This session is already closed."){throw error;}}
try{const bankPaymentMethodDiffPairs=this.props.other_payment_methods.filter((pm)=>pm.type=="bank").map((pm)=>[pm.id,this.getDifference(pm.id)]);const response=await this.orm.call("pos.session","close_session_from_ui",[this.pos.pos_session.id,bankPaymentMethodDiffPairs,]);if(!response.successful){return this.handleClosingError(response);}
this.pos.redirectToBackend();}catch(error){if(error instanceof ConnectionLostError){throw error;}else{await this.popup.add(ErrorPopup,{title:_t("Closing session error"),body:_t("An error has occurred when trying to close the session.\n"+"You will be redirected to the back-end to manually close the session."),});this.pos.redirectToBackend();}}}
async handleClosingError(response){await this.popup.add(ErrorPopup,{title:response.title||"Error",body:response.message,sound:response.type!=="alert",});if(response.redirect){this.pos.redirectToBackend();}}}
return __exports;});;

/* /point_of_sale/static/src/app/navbar/customer_facing_display_button/customer_facing_display_button.js */
odoo.define('@point_of_sale/app/navbar/customer_facing_display_button/customer_facing_display_button',['@odoo/owl','@web/core/utils/hooks','@point_of_sale/app/store/pos_hook','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{Component,useState}=require("@odoo/owl");const{useService}=require("@web/core/utils/hooks");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{_t}=require("@web/core/l10n/translation");const CustomerFacingDisplayButton=__exports.CustomerFacingDisplayButton=class CustomerFacingDisplayButton extends Component{static template="point_of_sale.CustomerFacingDisplayButton";setup(){this.pos=usePos();this.customerDisplay=useState(useService("customer_display"));this.notification=useService("pos_notification");}
get message(){const msg={success:"",warning:_t("Connected, Not Owned"),failure:_t("Disconnected"),not_found:_t("Customer Screen Unsupported. Please upgrade the IoT Box"),}[this.customerDisplay.status];if(this.previousDisplayedStatus&&this.previousDisplayedStatus!=this.customerDisplay.status){this.displayMessage(msg);this.previousDisplayedStatus=this.customerDisplay.status;}
return msg;}
displayMessage(message){if(this.notification){if(message.length==0){message="Connected";}
this.notification.add("Customer Display : "+message,3000);}}}
return __exports;});;

/* /point_of_sale/static/src/app/navbar/navbar.js */
odoo.define('@point_of_sale/app/navbar/navbar',['@point_of_sale/app/store/pos_hook','@web/core/utils/hooks','@web/core/browser/feature_detection','@point_of_sale/app/navbar/cashier_name/cashier_name','@point_of_sale/app/navbar/customer_facing_display_button/customer_facing_display_button','@point_of_sale/app/navbar/proxy_status/proxy_status','@point_of_sale/app/navbar/sale_details_button/sale_details_button','@point_of_sale/app/navbar/sync_notification/sync_notification','@point_of_sale/app/navbar/cash_move_popup/cash_move_popup','@point_of_sale/app/screens/ticket_screen/ticket_screen','@point_of_sale/app/navbar/back_button/back_button','@odoo/owl','@point_of_sale/app/navbar/closing_popup/closing_popup','@web/core/l10n/translation','@point_of_sale/app/screens/product_screen/product_screen'],function(require){'use strict';let __exports={};const{usePos}=require("@point_of_sale/app/store/pos_hook");const{useService}=require("@web/core/utils/hooks");const{isMobileOS}=require("@web/core/browser/feature_detection");const{CashierName}=require("@point_of_sale/app/navbar/cashier_name/cashier_name");const{CustomerFacingDisplayButton}=require("@point_of_sale/app/navbar/customer_facing_display_button/customer_facing_display_button");const{ProxyStatus}=require("@point_of_sale/app/navbar/proxy_status/proxy_status");const{SaleDetailsButton}=require("@point_of_sale/app/navbar/sale_details_button/sale_details_button");const{SyncNotification}=require("@point_of_sale/app/navbar/sync_notification/sync_notification");const{CashMovePopup}=require("@point_of_sale/app/navbar/cash_move_popup/cash_move_popup");const{TicketScreen}=require("@point_of_sale/app/screens/ticket_screen/ticket_screen");const{BackButton}=require("@point_of_sale/app/navbar/back_button/back_button");const{Component,useState,useExternalListener}=require("@odoo/owl");const{ClosePosPopup}=require("@point_of_sale/app/navbar/closing_popup/closing_popup");const{_t}=require("@web/core/l10n/translation");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const Navbar=__exports.Navbar=class Navbar extends Component{static template="point_of_sale.Navbar";static components={CashierName,CustomerFacingDisplayButton,ProxyStatus,SaleDetailsButton,SyncNotification,BackButton,};static props={};setup(){this.pos=usePos();this.ui=useState(useService("ui"));this.debug=useService("debug");this.popup=useService("popup");this.notification=useService("pos_notification");this.hardwareProxy=useService("hardware_proxy");this.state=useState({isMenuOpened:false});useExternalListener(window,"mouseup",this.onOutsideClick);}
onOutsideClick(){if(this.state.isMenuOpened){this.state.isMenuOpened=false;}}
get customerFacingDisplayButtonIsShown(){return this.pos.config.iface_customer_facing_display&&!isMobileOS();}
get showCashMoveButton(){return Boolean(this.pos?.config?.cash_control&&this.pos?.config?.has_cash_move_permission);}
onCashMoveButtonClick(){this.hardwareProxy.openCashbox(_t("Cash in / out"));this.popup.add(CashMovePopup);}
async onTicketButtonClick(){if(this.isTicketScreenShown){this.pos.closeScreen();}else{if(this._shouldLoadOrders()){try{this.pos.setLoadingOrderState(true);const message=await this.pos._syncAllOrdersFromServer();if(message){this.notification.add(message,5000);}}finally{this.pos.setLoadingOrderState(false);this.pos.showScreen("TicketScreen");}}else{this.pos.showScreen("TicketScreen");}}}
_shouldLoadOrders(){return this.pos.config.trusted_config_ids.length>0;}
get isTicketScreenShown(){return this.pos.mainScreen.component===TicketScreen;}
get orderCount(){return this.pos.get_order_list().length;}
isBurgerMenuClosed(){return!this.state.isMenuOpened;}
closeMenu(){this.state.isMenuOpened=false;}
openMenu(){this.state.isMenuOpened=true;}
async closeSession(){const info=await this.pos.getClosePosInfo();this.popup.add(ClosePosPopup,{...info});}
showBackButton(){return this.pos.showBackButton()&&this.ui.isSmall;}
toggleProductView(){const newView=this.pos.productListView==="grid"?"list":"grid";window.localStorage.setItem("productListView",newView);this.pos.productListView=this.pos.productListView==="grid"?"list":"grid";}
get showToggleProductView(){return this.pos.mainScreen.component===ProductScreen&&this.ui.isSmall;}}
return __exports;});;

/* /point_of_sale/static/src/app/navbar/proxy_status/proxy_status.js */
odoo.define('@point_of_sale/app/navbar/proxy_status/proxy_status',['@odoo/owl','@point_of_sale/app/store/pos_hook','@web/core/utils/hooks','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{Component,useState}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{useService}=require("@web/core/utils/hooks");const{_t}=require("@web/core/l10n/translation");const ProxyStatus=__exports.ProxyStatus=class ProxyStatus extends Component{static template="point_of_sale.ProxyStatus";setup(){this.pos=usePos();this.ui=useState(useService("ui"));const hardwareProxy=useService("hardware_proxy");this.connectionInfo=useState(hardwareProxy.connectionInfo);}
get message(){if(this.connectionInfo.status==="connected"){const{drivers}=this.connectionInfo;const{iface_scan_via_proxy,iface_print_via_proxy,iface_cashdrawer,iface_electronic_scale,}=this.pos.config;const devices=[{name:_t("Scanner"),driver:drivers.scanner,enabled:iface_scan_via_proxy,},{name:_t("Printer"),driver:drivers.printer,enabled:iface_print_via_proxy||iface_cashdrawer,},{name:_t("Scale"),driver:drivers.scale,enabled:iface_electronic_scale,},];const disconnectedDevices=devices.filter(({enabled,driver})=>{return enabled&&!["connected","connecting"].includes(driver?.status);});if(disconnectedDevices.length){return`${disconnectedDevices.map((d) => d.name).join(" & ")} ${_t("Offline")}`;}
return"";}
return this.connectionInfo.message||"";}}
return __exports;});;

/* /point_of_sale/static/src/app/navbar/sale_details_button/sale_details_button.js */
odoo.define('@point_of_sale/app/navbar/sale_details_button/sale_details_button',['@web/core/utils/hooks','@web/core/utils/render','@point_of_sale/app/errors/popups/error_popup','@odoo/owl','@point_of_sale/app/store/pos_hook'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{renderToElement}=require("@web/core/utils/render");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{Component}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const SaleDetailsButton=__exports.SaleDetailsButton=class SaleDetailsButton extends Component{static template="point_of_sale.SaleDetailsButton";setup(){super.setup(...arguments);this.pos=usePos();this.popup=useService("popup");this.orm=useService("orm");this.hardwareProxy=useService("hardware_proxy");}
async onClick(){const saleDetails=await this.orm.call("report.point_of_sale.report_saledetails","get_sale_details",[false,false,false,[this.pos.pos_session.id]]);const report=renderToElement("point_of_sale.SaleDetailsReport",Object.assign({},saleDetails,{date:new Date().toLocaleString(),pos:this.pos,formatCurrency:this.env.utils.formatCurrency,}));const{successful,message}=await this.hardwareProxy.printer.printReceipt(report);if(!successful){await this.popup.add(ErrorPopup,{title:message.title,body:message.body,});}}}
return __exports;});;

/* /point_of_sale/static/src/app/navbar/sync_notification/sync_notification.js */
odoo.define('@point_of_sale/app/navbar/sync_notification/sync_notification',['@odoo/owl','@point_of_sale/app/store/pos_hook'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const SyncNotification=__exports.SyncNotification=class SyncNotification extends Component{static template="point_of_sale.SyncNotification";setup(){this.pos=usePos();}
get sync(){return this.pos.synch;}
onClick(){if(this.pos.synch.status!=="connected"){this.pos.showOfflineWarning=true;}
this.pos.push_orders({show_error:true});}}
return __exports;});;

/* /point_of_sale/static/src/app/notification/notification_service.js */
odoo.define('@point_of_sale/app/notification/notification_service',['@odoo/owl','@web/core/registry','@web/core/transition'],function(require){'use strict';let __exports={};const{reactive,Component}=require("@odoo/owl");const{registry}=require("@web/core/registry");const{Transition}=require("@web/core/transition");const TRANSITION_LEAVE_DURATION=200;class Notification extends Component{static template="point_of_sale.Notification";static props={message:String,close:Function,className:String};}
class NotificationContainer extends Component{static template="point_of_sale.NotificationContainer";static components={Transition,Notification};static props={notifications:Object,};leaveDuration=TRANSITION_LEAVE_DURATION;}
const notificationService=__exports.notificationService={start(){const notifications=reactive({});let notifId=0;registry.category("main_components").add("PosNotificationContainer",{Component:NotificationContainer,props:{notifications},});return{add(message,duration=2000){const id=++notifId;notifications[id]={message,visible:true,close(){notifications[id].visible=false;},delete(){delete notifications[id];},};setTimeout(()=>notifications?.[id]?.close(),duration);},};},};registry.category("services").add("pos_notification",notificationService);return __exports;});;

/* /point_of_sale/static/src/app/payment/payment_interface.js */
odoo.define('@point_of_sale/app/payment/payment_interface',[],function(require){'use strict';let __exports={};const PaymentInterface=__exports.PaymentInterface=class PaymentInterface{constructor(pos,payment_method){this.setup(pos,payment_method);}
setup(pos,payment_method){this.env=pos.env;this.pos=pos;this.payment_method=payment_method;this.supports_reversals=false;}
enable_reversals(){this.supports_reversals=true;}
send_payment_request(cid){}
send_payment_cancel(order,cid){}
send_payment_reversal(cid){}
close(){}}
return __exports;});;

/* /point_of_sale/static/src/app/popup/abstract_awaitable_popup.js */
odoo.define('@point_of_sale/app/popup/abstract_awaitable_popup',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component,useExternalListener}=require("@odoo/owl");const AbstractAwaitablePopup=__exports.AbstractAwaitablePopup=class AbstractAwaitablePopup extends Component{setup(){super.setup(...arguments);useExternalListener(window,"keyup",this._onWindowKeyup);}
_onWindowKeyup(event){const topPopupIndex=Object.values(this.env.services.popup.popups).pop()?.props.zIndex;if(this.props.zIndex!==topPopupIndex){return;}
if(event.key===this.props.cancelKey){this.cancel();return;}
if(["INPUT","TEXTAREA"].includes(event.target.tagName)){return;}
if(event.key===this.props.confirmKey){this.confirm();}}
async confirm(){this.props.close({confirmed:true,payload:await this.getPayload()});}
cancel(){this.props.close({confirmed:false,payload:null});}
async getPayload(){return null;}}
return __exports;});;

/* /point_of_sale/static/src/app/popup/popup_service.js */
odoo.define('@point_of_sale/app/popup/popup_service',['@odoo/owl','@web/core/registry'],function(require){'use strict';let __exports={};const{Component,reactive}=require("@odoo/owl");const{registry}=require("@web/core/registry");const PopupContainer=__exports.PopupContainer=class PopupContainer extends Component{static template="point_of_sale.PopupContainer";}
const popupService=__exports.popupService={start(){const popups=reactive({});registry.category("main_components").add("PopupContainer",{Component:PopupContainer,props:{popups},});let popupId=0;let zIndex=10000;return{add(component,props){return new Promise((resolve)=>{const id=++popupId;zIndex++;popups[id]={component,props:{zIndex,cancelKey:"Escape",confirmKey:"Enter",...component.defaultProps,...props,id,resolve,close(response){delete popups[id];resolve(response);},},};});},popups,};},};registry.category("services").add("popup",popupService);return __exports;});;

/* /point_of_sale/static/src/app/pos_app.js */
odoo.define('@point_of_sale/app/pos_app',['@web/core/utils/hooks','@web/core/transition','@web/core/main_components_container','@web/core/utils/components','@point_of_sale/app/navbar/navbar','@point_of_sale/app/store/pos_hook','@odoo/owl'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{Transition}=require("@web/core/transition");const{MainComponentsContainer}=require("@web/core/main_components_container");const{ErrorHandler}=require("@web/core/utils/components");const{Navbar}=require("@point_of_sale/app/navbar/navbar");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{reactive,Component,onMounted,onWillStart}=require("@odoo/owl");const Chrome=__exports.Chrome=class Chrome extends Component{static template="point_of_sale.Chrome";static components={Transition,MainComponentsContainer,ErrorHandler,Navbar};static props={disableLoader:Function};setup(){this.pos=usePos();this.popup=useService("popup");const reactivePos=reactive(this.pos);window.posmodel=reactivePos;document.addEventListener("keydown",(ev)=>{if(ev.key==="Backspace"&&!ev.target.matches("input, textarea")){ev.preventDefault();}});onWillStart(this.pos._loadFonts);onMounted(this.props.disableLoader);}
get showCashMoveButton(){return Boolean(this.pos?.config?.cash_control);}
onTempScreenError(err){this.pos.tempScreen=null;Promise.reject(err);}}
return __exports;});;

/* /point_of_sale/static/src/app/printer/base_printer.js */
odoo.define('@point_of_sale/app/printer/base_printer',['@web/core/l10n/translation','@point_of_sale/app/printer/render_service'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{htmlToCanvas}=require("@point_of_sale/app/printer/render_service");const BasePrinter=__exports.BasePrinter=class BasePrinter{constructor(){this.setup(...arguments);}
setup(){this.receiptQueue=[];}
async printReceipt(receipt){if(receipt){this.receiptQueue.push(receipt);}
let image,printResult;while(this.receiptQueue.length>0){receipt=this.receiptQueue.shift();image=this.processCanvas(await htmlToCanvas(receipt,{addClass:"pos-receipt-print"}));try{printResult=await this.sendPrintingJob(image);}catch{this.receiptQueue.length=0;return this.getActionError();}
if(!printResult||printResult.result===false){this.receiptQueue.length=0;return this.getResultsError(printResult);}}
return{successful:true};}
async sendPrintingJob(){throw new Error("Not implemented");}
openCashbox(){throw new Error("Not implemented");}
processCanvas(canvas){return canvas.toDataURL("image/jpeg").replace("data:image/jpeg;base64,","");}
getActionError(){return{successful:false,message:{title:_t("Connection to IoT Box failed"),body:_t("Please check if the IoT Box is still connected."),},};}
getResultsError(_printResult){return{successful:false,message:{title:_t("Connection to the printer failed"),body:_t("Please check if the printer is still connected. \n"+"Some browsers don't allow HTTP calls from websites to devices in the network (for security reasons). "+"If it is the case, you will need to follow Odoo's documentation for "+"'Self-signed certificate for ePOS printers' and 'Secure connection (HTTPS)' to solve the issue. "),},};}}
return __exports;});;

/* /point_of_sale/static/src/app/printer/hw_printer.js */
odoo.define('@point_of_sale/app/printer/hw_printer',['@point_of_sale/app/printer/base_printer'],function(require){'use strict';let __exports={};const{BasePrinter}=require("@point_of_sale/app/printer/base_printer");const HWPrinter=__exports.HWPrinter=class HWPrinter extends BasePrinter{setup(params){super.setup(...arguments);const{rpc,url}=params;this.rpc=rpc;this.url=url;}
sendAction(data){return this.rpc(`${this.url}/hw_proxy/default_printer_action`,{data});}
openCashbox(){return this.sendAction({action:"cashbox"});}
sendPrintingJob(img){return this.sendAction({action:"print_receipt",receipt:img});}}
return __exports;});;

/* /point_of_sale/static/src/app/printer/pos_printer_service.js */
odoo.define('@point_of_sale/app/printer/pos_printer_service',['@web/core/l10n/translation','@web/core/registry','@point_of_sale/app/utils/confirm_popup/confirm_popup','@point_of_sale/app/errors/popups/error_popup','@point_of_sale/app/printer/printer_service'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{PrinterService}=require("@point_of_sale/app/printer/printer_service");const posPrinterService=__exports.posPrinterService={dependencies:["hardware_proxy","popup","renderer","pos"],start(env,{hardware_proxy,popup,renderer,pos}){return new PosPrinterService(env,{hardware_proxy,popup,renderer,pos});},};const PosPrinterService=__exports.PosPrinterService=class PosPrinterService extends PrinterService{constructor(...args){super(...args);this.setup(...args);}
setup(env,{hardware_proxy,popup,renderer,pos}){this.renderer=renderer;this.hardware_proxy=hardware_proxy;this.popup=popup;this.device=hardware_proxy.printer;this.pos=pos;}
printWeb(){try{return super.printWeb(...arguments);}catch{this.popup.add(ErrorPopup,{title:_t("Printing is not supported on some browsers"),body:_t("It is possible to print your tickets by making use of an IoT Box."),});return false;}}
async printHtml(){this.setPrinter(this.hardware_proxy.printer);try{return await super.printHtml(...arguments);}catch(error){return this.printHtmlAlternative(error);}}
async printHtmlAlternative(error){const{confirmed}=await this.popup.add(ConfirmPopup,{title:error.title||_t("Printing error"),body:error.body+_t("Do you want to print using the web printer? "),});if(!confirmed){return false;}
await new Promise(requestAnimationFrame);return this.printWeb(...arguments);}}
registry.category("services").add("printer",posPrinterService);return __exports;});;

/* /point_of_sale/static/src/app/printer/printer_service.js */
odoo.define('@point_of_sale/app/printer/printer_service',['@point_of_sale/utils'],function(require){'use strict';let __exports={};const{loadAllImages}=require("@point_of_sale/utils");const printerService=__exports.printerService={dependencies:["renderer"],start(env,{renderer}){return new PrinterService(env,{renderer});},};const PrinterService=__exports.PrinterService=class PrinterService{constructor(...args){this.setup(...args);}
setup(env,{renderer}){this.renderer=renderer;this.device=null;}
setPrinter(newDevice){this.device=newDevice;}
printWeb(el){this.renderer.whenMounted({el,callback:window.print});return true;}
async printHtml(el,{webPrintFallback=false}={}){if(!this.device){return webPrintFallback&&this.printWeb(el);}
const printResult=await this.device.printReceipt(el);if(printResult.successful){return true;}
throw{title:printResult.message.title||"Error",body:printResult.message.body,};}
async print(component,props,options){const el=await this.renderer.toHtml(component,props);try{await loadAllImages(el);}catch(e){console.error("Images could not be loaded correctly",e);}
return await this.printHtml(el,options);}
is=()=>Boolean(this.device?.printReceipt);}
return __exports;});;

/* /point_of_sale/static/src/app/printer/render_service.js */
odoo.define('@point_of_sale/app/printer/render_service',['@web/core/registry','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{Component,onRendered,reactive,useRef,xml}=require("@odoo/owl");const RenderContainer=__exports.RenderContainer=class RenderContainer extends Component{static props=["comp","onRendered"];static template=xml`
        <div style="left: -1000px; position: fixed;">
            <div t-ref="ref">
                <t t-if="props.comp.component" t-component="props.comp.component" t-props="props.comp.props"/>
            </div>
            <div class="render-container" />
        </div>`;setup(){this.ref=useRef("ref");onRendered(async()=>{await new Promise((r)=>setTimeout(r,100));this.props.onRendered(this.ref?.el?.firstChild);});}}
const renderService={dependencies:[],start(){const toBeRenderedComponentData=reactive({});let elem,resolver;registry.category("main_components").add("RenderContainer",{Component:RenderContainer,props:{comp:toBeRenderedComponentData,onRendered:(el)=>{elem=el;resolver?.();toBeRenderedComponentData.component=null;},},});const toHtml=async(component,props)=>{Object.assign(toBeRenderedComponentData,{component,props});await new Promise((r)=>(resolver=r));return elem;};const toCanvas=async(component,props,options)=>{return htmlToCanvas(await toHtml(component,props),options);};const toJpeg=async(component,props,options)=>{const canvas=await toCanvas(component,props,options);return canvas.toDataURL("image/jpeg").replace("data:image/jpeg;base64,","");};const whenMounted=async({el,container,callback})=>{container||=document.querySelector(".render-container");return await applyWhenMounted({el,container,callback});};return{toHtml,toCanvas,toJpeg,whenMounted};},};registry.category("services").add("renderer",renderService);const applyWhenMounted=async({el,container,callback})=>{const elClone=el.cloneNode(true);const sameClassElements=container.querySelectorAll(`.${[...el.classList].join(".")}`);sameClassElements.forEach(element=>{element.remove();});container.appendChild(elClone);const res=await callback(elClone);return res;};const htmlToCanvas=__exports.htmlToCanvas=async(el,options)=>{el.classList.add(options.addClass||"");return await applyWhenMounted({el,container:document.querySelector(".render-container"),callback:async(el)=>await html2canvas(el,{height:Math.ceil(el.clientHeight),width:Math.ceil(el.clientWidth),scale:1,}),});};return __exports;});;

/* /point_of_sale/static/src/app/screens/partner_list/partner_editor/partner_editor.js */
odoo.define('@point_of_sale/app/screens/partner_list/partner_editor/partner_editor',['@web/core/l10n/translation','@web/core/utils/urls','@point_of_sale/app/errors/popups/error_popup','@web/core/utils/hooks','@odoo/owl','@point_of_sale/app/store/pos_hook','@point_of_sale/utils'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{getDataURLFromFile}=require("@web/core/utils/urls");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{useService}=require("@web/core/utils/hooks");const{Component,useState}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{loadImage}=require("@point_of_sale/utils");const PartnerDetailsEdit=__exports.PartnerDetailsEdit=class PartnerDetailsEdit extends Component{static template="point_of_sale.PartnerDetailsEdit";setup(){this.popup=useService("popup");this.pos=usePos();this.intFields=["country_id","state_id","property_product_pricelist"];const partner=this.props.partner;this.changes=useState({name:partner.name||"",street:partner.street||"",city:partner.city||"",zip:partner.zip||"",state_id:partner.state_id&&partner.state_id[0],country_id:partner.country_id&&partner.country_id[0],lang:partner.lang||"",email:partner.email||"",phone:partner.phone||"",mobile:partner.mobile||"",barcode:partner.barcode||"",vat:partner.vat||"",property_product_pricelist:this.setDefaultPricelist(partner),});this.partnerDetailsFields={'Street':_t('Street'),'City':_t('City'),'Zip':_t('Zip'),'Email':_t('Email'),'Phone':_t('Phone'),'Mobile':_t('Mobile'),'Barcode':_t('Barcode')};Object.assign(this.props.imperativeHandle,{save:()=>this.saveChanges(),});}
setDefaultPricelist(partner){if(partner.property_product_pricelist){return partner.property_product_pricelist[0];}
return this.pos.default_pricelist?.id??false;}
get missingFields(){return this.props.missingFields?this.props.missingFields:[];}
get partnerImageUrl(){const partner=this.props.partner;if(this.changes.image_1920){return this.changes.image_1920;}else if(partner.id){return`/web/image?model=res.partner&id=${partner.id}&field=avatar_128&unique=${partner.write_date}`;}else{return false;}}
saveChanges(){const processedChanges={};for(const[key,value]of Object.entries(this.changes)){if(this.intFields.includes(key)){processedChanges[key]=parseInt(value)||false;}else{processedChanges[key]=value;}}
if(processedChanges.state_id&&this.pos.states.find((state)=>state.id===processedChanges.state_id).country_id[0]!==processedChanges.country_id){processedChanges.state_id=false;}
if((!this.props.partner.name&&!processedChanges.name)||processedChanges.name===""){return this.popup.add(ErrorPopup,{title:_t("A Customer Name Is Required"),});}
processedChanges.id=this.props.partner.id||false;this.props.saveChanges(processedChanges);}
async uploadImage(event){const file=event.target.files[0];if(!file.type.match(/image.*/)){await this.popup.add(ErrorPopup,{title:_t("Unsupported File Format"),body:_t("Only web-compatible Image formats such as .png or .jpeg are supported."),});}else{const imageUrl=await getDataURLFromFile(file);const loadedImage=await loadImage(imageUrl,{onError:()=>{this.popup.add(ErrorPopup,{title:_t("Loading Image Error"),body:_t("Encountered error when loading image. Please try again."),});}});if(loadedImage){const resizedImage=await this._resizeImage(loadedImage,800,600);this.changes.image_1920=resizedImage.toDataURL();}}}
_resizeImage(img,maxwidth,maxheight){var canvas=document.createElement("canvas");var ctx=canvas.getContext("2d");var ratio=1;if(img.width>maxwidth){ratio=maxwidth/img.width;}
if(img.height*ratio>maxheight){ratio=maxheight/img.height;}
var width=Math.floor(img.width*ratio);var height=Math.floor(img.height*ratio);canvas.width=width;canvas.height=height;ctx.drawImage(img,0,0,width,height);return canvas;}
isFieldCommercialAndPartnerIsChild(field){return(this.pos.isChildPartner(this.props.partner)&&this.pos.partner_commercial_fields.includes(field));}}
return __exports;});;

/* /point_of_sale/static/src/app/screens/partner_list/partner_line/partner_line.js */
odoo.define('@point_of_sale/app/screens/partner_list/partner_line/partner_line',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const PartnerLine=__exports.PartnerLine=class PartnerLine extends Component{static template="point_of_sale.PartnerLine";get highlight(){return this._isPartnerSelected?"highlight active":"";}
get _isPartnerSelected(){return this.props.partner===this.props.selectedPartner;}}
return __exports;});;

/* /point_of_sale/static/src/app/screens/partner_list/partner_list.js */
odoo.define('@point_of_sale/app/screens/partner_list/partner_list',['@web/core/l10n/translation','@web/core/registry','@web/core/utils/timing','@web/core/utils/hooks','@point_of_sale/app/utils/hooks','@web/session','@point_of_sale/app/screens/partner_list/partner_line/partner_line','@point_of_sale/app/screens/partner_list/partner_editor/partner_editor','@point_of_sale/app/store/pos_hook','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{debounce}=require("@web/core/utils/timing");const{useService,useAutofocus}=require("@web/core/utils/hooks");const{useAsyncLockedMethod}=require("@point_of_sale/app/utils/hooks");const{session}=require("@web/session");const{PartnerLine}=require("@point_of_sale/app/screens/partner_list/partner_line/partner_line");const{PartnerDetailsEdit}=require("@point_of_sale/app/screens/partner_list/partner_editor/partner_editor");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{Component,onWillUnmount,useRef,useState}=require("@odoo/owl");const PartnerListScreen=__exports.PartnerListScreen=class PartnerListScreen extends Component{static components={PartnerDetailsEdit,PartnerLine};static template="point_of_sale.PartnerListScreen";setup(){this.pos=usePos();this.ui=useState(useService("ui"));this.orm=useService("orm");this.notification=useService("pos_notification");this.searchWordInputRef=useRef("search-word-input-partner");useAutofocus({refName:'search-word-input-partner'});this.state=useState({query:null,selectedPartner:this.props.partner,detailIsShown:this.props.editModeProps?true:false,editModeProps:{partner:this.props.editModeProps?this.props.partner:null,missingFields:this.props.missingFields?this.props.missingFields:null,},previousQuery:"",currentOffset:0,});this.updatePartnerList=debounce(this.updatePartnerList,70);this.saveChanges=useAsyncLockedMethod(this.saveChanges);onWillUnmount(this.updatePartnerList.cancel);this.partnerEditor={};}
back(force=false){if(this.state.detailIsShown&&!force){this.state.detailIsShown=false;}else{this.props.resolve({confirmed:false,payload:false});this.pos.closeTempScreen();}}
goToOrders(){this.back(true);const partner=this.state.editModeProps.partner;const partnerHasActiveOrders=this.pos.get_order_list().some((order)=>order.partner?.id===partner.id);const ui={searchDetails:{fieldName:"PARTNER",searchTerm:partner.name,},filter:partnerHasActiveOrders?"":"SYNCED",};this.pos.showScreen("TicketScreen",{ui});}
confirm(){this.props.resolve({confirmed:true,payload:this.state.selectedPartner});this.pos.closeTempScreen();}
activateEditMode(){this.state.detailIsShown=true;}
get currentOrder(){return this.pos.get_order();}
get partners(){let res;if(this.state.query&&this.state.query.trim()!==""){res=this.pos.db.search_partner(this.state.query.trim());}else{res=this.pos.db.get_partners_sorted(1000);}
res.sort(function(a,b){return(a.name||"").localeCompare(b.name||"");});if(this.state.selectedPartner){const indexOfSelectedPartner=res.findIndex((partner)=>partner.id===this.state.selectedPartner.id);if(indexOfSelectedPartner!==-1){res.splice(indexOfSelectedPartner,1);}
res.unshift(this.state.selectedPartner);}
return res;}
get isBalanceDisplayed(){return false;}
get partnerLink(){return`/web#model=res.partner&id=${this.state.editModeProps.partner.id}`;}
async _onPressEnterKey(){if(!this.state.query){return;}
const result=await this.searchPartner();if(result.length>0){this.notification.add(_t('%s customer(s) found for "%s".',result.length,this.state.query),3000);}else{this.notification.add(_t('No more customer found for "%s".',this.state.query),3000);}}
_clearSearch(){this.searchWordInputRef.el.value="";this.state.query="";}
async updatePartnerList(event){this.state.query=event.target.value;}
clickPartner(partner){if(this.state.selectedPartner&&this.state.selectedPartner.id===partner.id){this.state.selectedPartner=null;}else{this.state.selectedPartner=partner;}
this.confirm();}
editPartner(partner){this.state.editModeProps.partner=partner;this.activateEditMode();}
createPartner(){const{country_id,state_id}=this.pos.company;this.state.editModeProps.partner={country_id,state_id,lang:session.user_context.lang};this.activateEditMode();}
async saveChanges(processedChanges){const partnerId=await this.orm.call("res.partner","create_from_ui",[processedChanges]);await this.pos._loadPartners([partnerId]);this.state.selectedPartner=this.pos.db.get_partner_by_id(partnerId);this.confirm();}
async searchPartner(){if(this.state.previousQuery!=this.state.query){this.state.currentOffset=0;}
const result=await this.getNewPartners();this.pos.addPartners(result);if(this.state.previousQuery==this.state.query){this.state.currentOffset+=result.length;}else{this.state.previousQuery=this.state.query;this.state.currentOffset=result.length;}
return result;}
async getNewPartners(){let domain=[];const limit=30;if(this.state.query){const search_fields=["name","parent_name","phone_mobile_search","email"];domain=[...Array(search_fields.length-1).fill('|'),...search_fields.map(field=>[field,"ilike",this.state.query+"%"])];}
const result=await this.orm.silent.call("pos.session","get_pos_ui_res_partner_by_params",[[odoo.pos_session_id],{domain,limit:limit,offset:this.state.currentOffset}]);return result;}}
registry.category("pos_screens").add("PartnerListScreen",PartnerListScreen);return __exports;});;

/* /point_of_sale/static/src/app/screens/payment_screen/payment_lines/payment_lines.js */
odoo.define('@point_of_sale/app/screens/payment_screen/payment_lines/payment_lines',['@web/core/l10n/translation','@point_of_sale/app/utils/input_popups/number_popup','@web/core/utils/hooks','@odoo/owl','@point_of_sale/app/store/pos_hook','@web/views/fields/parsers'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{NumberPopup}=require("@point_of_sale/app/utils/input_popups/number_popup");const{useService}=require("@web/core/utils/hooks");const{Component,useState}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{parseFloat}=require("@web/views/fields/parsers");const PaymentScreenPaymentLines=__exports.PaymentScreenPaymentLines=class PaymentScreenPaymentLines extends Component{static template="point_of_sale.PaymentScreenPaymentLines";setup(){this.ui=useState(useService("ui"));this.popup=useService("popup");this.pos=usePos();}
formatLineAmount(paymentline){return this.env.utils.formatCurrency(paymentline.get_amount(),false);}
selectedLineClass(line){return{"payment-terminal":line.get_payment_status()};}
unselectedLineClass(line){return{};}
async selectLine(paymentline){this.props.selectLine(paymentline.cid);if(this.ui.isSmall){const{confirmed,payload}=await this.popup.add(NumberPopup,{title:_t("New amount"),startingValue:paymentline.amount,isInputSelected:true,nbrDecimal:this.pos.currency.decimal_places,});if(confirmed){this.props.updateSelectedPaymentline(parseFloat(payload));}}
return;}}
return __exports;});;

/* /point_of_sale/static/src/app/screens/payment_screen/payment_screen.js */
odoo.define('@point_of_sale/app/screens/payment_screen/payment_screen',['@web/core/l10n/translation','@web/views/fields/parsers','@point_of_sale/app/utils/hooks','@web/core/registry','@web/core/utils/hooks','@point_of_sale/app/errors/popups/error_popup','@point_of_sale/app/utils/input_popups/number_popup','@point_of_sale/app/utils/date_picker_popup/date_picker_popup','@point_of_sale/app/utils/confirm_popup/confirm_popup','@web/core/network/rpc_service','@point_of_sale/app/screens/payment_screen/payment_lines/payment_lines','@point_of_sale/app/screens/payment_screen/payment_status/payment_status','@point_of_sale/app/store/pos_hook','@odoo/owl','@point_of_sale/app/generic_components/numpad/numpad','@web/core/utils/numbers','@point_of_sale/app/screens/receipt_screen/receipt/order_receipt'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{parseFloat}=require("@web/views/fields/parsers");const{useErrorHandlers,useAsyncLockedMethod}=require("@point_of_sale/app/utils/hooks");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{NumberPopup}=require("@point_of_sale/app/utils/input_popups/number_popup");const{DatePickerPopup}=require("@point_of_sale/app/utils/date_picker_popup/date_picker_popup");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{ConnectionLostError}=require("@web/core/network/rpc_service");const{PaymentScreenPaymentLines}=require("@point_of_sale/app/screens/payment_screen/payment_lines/payment_lines");const{PaymentScreenStatus}=require("@point_of_sale/app/screens/payment_screen/payment_status/payment_status");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{Component,useState,onMounted}=require("@odoo/owl");const{Numpad}=require("@point_of_sale/app/generic_components/numpad/numpad");const{floatIsZero}=require("@web/core/utils/numbers");const{OrderReceipt}=require("@point_of_sale/app/screens/receipt_screen/receipt/order_receipt");const PaymentScreen=__exports.PaymentScreen=class PaymentScreen extends Component{static template="point_of_sale.PaymentScreen";static components={Numpad,PaymentScreenPaymentLines,PaymentScreenStatus,};setup(){this.pos=usePos();this.ui=useState(useService("ui"));this.orm=useService("orm");this.popup=useService("popup");this.report=useService("report");this.notification=useService("pos_notification");this.hardwareProxy=useService("hardware_proxy");this.printer=useService("printer");this.payment_methods_from_config=this.pos.payment_methods.filter((method)=>this.pos.config.payment_method_ids.includes(method.id));this.numberBuffer=useService("number_buffer");this.numberBuffer.use(this._getNumberBufferConfig);useErrorHandlers();this.payment_interface=null;this.error=false;this.validateOrder=useAsyncLockedMethod(this.validateOrder);onMounted(this.onMounted);}
onMounted(){if(this.payment_methods_from_config.length==1){this.addNewPaymentLine(this.payment_methods_from_config[0]);}}
getNumpadButtons(){return[{value:"1"},{value:"2"},{value:"3"},{value:"+10"},{value:"4"},{value:"5"},{value:"6"},{value:"+20"},{value:"7"},{value:"8"},{value:"9"},{value:"+50"},{value:"-",text:"+/-"},{value:"0"},{value:this.env.services.localization.decimalPoint},{value:"Backspace",text:""},];}
showMaxValueError(){this.popup.add(ErrorPopup,{title:_t("Maximum value reached"),body:_t("The amount cannot be higher than the due amount if you don't have a cash payment method configured."),});}
get _getNumberBufferConfig(){const config={triggerAtInput:()=>this.updateSelectedPaymentline(),};return config;}
get currentOrder(){return this.pos.get_order();}
get paymentLines(){return this.currentOrder.get_paymentlines();}
get selectedPaymentLine(){return this.currentOrder.selected_paymentline;}
async selectPartner(isEditMode=false,missingFields=[]){const currentPartner=this.currentOrder.get_partner();const partnerScreenProps={partner:currentPartner};if(isEditMode&&currentPartner){partnerScreenProps.editModeProps=true;partnerScreenProps.missingFields=missingFields;}
const{confirmed,payload:newPartner}=await this.pos.showTempScreen("PartnerListScreen",partnerScreenProps);if(confirmed){this.currentOrder.set_partner(newPartner);}}
addNewPaymentLine(paymentMethod){const result=this.currentOrder.add_paymentline(paymentMethod);if(result){this.numberBuffer.reset();return true;}else{this.popup.add(ErrorPopup,{title:_t("Error"),body:_t("There is already an electronic payment in progress."),});return false;}}
updateSelectedPaymentline(amount=false){if(this.paymentLines.every((line)=>line.paid)){this.currentOrder.add_paymentline(this.payment_methods_from_config[0]);}
if(!this.selectedPaymentLine){return;}
if(amount===false){if(this.numberBuffer.get()===null){amount=null;}else if(this.numberBuffer.get()===""){amount=0;}else{amount=this.numberBuffer.getFloat();}}
const payment_terminal=this.selectedPaymentLine.payment_method.payment_terminal;const hasCashPaymentMethod=this.payment_methods_from_config.some((method)=>method.type==="cash");if(!hasCashPaymentMethod&&amount>this.currentOrder.get_due()+this.selectedPaymentLine.amount){this.selectedPaymentLine.set_amount(0);this.numberBuffer.set(this.currentOrder.get_due().toString());amount=this.currentOrder.get_due();this.showMaxValueError();}
if(payment_terminal&&!["pending","retry"].includes(this.selectedPaymentLine.get_payment_status())){return;}
if(amount===null){this.deletePaymentLine(this.selectedPaymentLine.cid);}else{this.selectedPaymentLine.set_amount(amount);}}
toggleIsToInvoice(){this.currentOrder.set_to_invoice(!this.currentOrder.is_to_invoice());}
openCashbox(){this.hardwareProxy.openCashbox();}
async addTip(){const tip=this.currentOrder.get_tip();const change=this.currentOrder.get_change();const value=tip===0&&change>0?change:tip;const{confirmed,payload}=await this.popup.add(NumberPopup,{title:tip?_t("Change Tip"):_t("Add Tip"),startingValue:value,isInputSelected:true,nbrDecimal:this.pos.currency.decimal_places,inputSuffix:this.pos.currency.symbol,});if(confirmed){this.currentOrder.set_tip(parseFloat(payload??""));}}
async toggleShippingDatePicker(){if(!this.currentOrder.getShippingDate()){const{confirmed,payload:shippingDate}=await this.popup.add(DatePickerPopup,{title:_t("Select the shipping date"),});if(confirmed){this.currentOrder.setShippingDate(shippingDate);}}else{this.currentOrder.setShippingDate(false);}}
deletePaymentLine(cid){const line=this.paymentLines.find((line)=>line.cid===cid);if(["waiting","waitingCard","timeout"].includes(line.get_payment_status())){line.set_payment_status("waitingCancel");line.payment_method.payment_terminal.send_payment_cancel(this.currentOrder,cid).then(()=>{this.currentOrder.remove_paymentline(line);this.numberBuffer.reset();});}else if(line.get_payment_status()!=="waitingCancel"){this.currentOrder.remove_paymentline(line);this.numberBuffer.reset();}}
selectPaymentLine(cid){const line=this.paymentLines.find((line)=>line.cid===cid);this.currentOrder.select_paymentline(line);this.numberBuffer.reset();}
async validateOrder(isForceValidate){this.numberBuffer.capture();if(this.pos.config.cash_rounding){if(!this.pos.get_order().check_paymentlines_rounding()){this.popup.add(ErrorPopup,{title:_t("Rounding error in payment lines"),body:_t("The amount of your payment lines must be rounded to validate the transaction."),});return;}}
if(await this._isOrderValid(isForceValidate)){for(const line of this.paymentLines){if(!line.is_done()){this.currentOrder.remove_paymentline(line);}}
await this._finalizeValidation();}}
async _finalizeValidation(){if(this.currentOrder.is_paid_with_cash()||this.currentOrder.get_change()){this.hardwareProxy.openCashbox();}
this.currentOrder.date_order=luxon.DateTime.now();for(const line of this.paymentLines){if(!line.amount===0){this.currentOrder.remove_paymentline(line);}}
this.currentOrder.finalized=true;this.env.services.ui.block();let syncOrderResult;try{syncOrderResult=await this.pos.push_single_order(this.currentOrder);if(!syncOrderResult){return;}
if(this.shouldDownloadInvoice()&&this.currentOrder.is_to_invoice()){if(syncOrderResult[0]?.account_move){await this.report.doAction("account.account_invoices",[syncOrderResult[0].account_move,]);}else{throw{code:401,message:"Backend Invoice",data:{order:this.currentOrder},};}}}catch(error){if(error instanceof ConnectionLostError){this.pos.showScreen(this.nextScreen);Promise.reject(error);return error;}else{throw error;}}finally{this.env.services.ui.unblock();}
if(syncOrderResult&&syncOrderResult.length>0&&this.currentOrder.wait_for_push_order()){await this.postPushOrderResolve(syncOrderResult.map((res)=>res.id));}
await this.afterOrderValidation(!!syncOrderResult&&syncOrderResult.length>0);}
async postPushOrderResolve(ordersServerId){const postPushResult=await this._postPushOrderResolve(this.currentOrder,ordersServerId);if(!postPushResult){this.popup.add(ErrorPopup,{title:_t("Error: no internet connection."),body:_t("Some, if not all, post-processing after syncing order failed."),});}}
async afterOrderValidation(suggestToSync=true){this.pos.db.remove_unpaid_order(this.currentOrder);if(suggestToSync&&this.pos.db.get_orders().length){const{confirmed}=await this.popup.add(ConfirmPopup,{title:_t("Remaining unsynced orders"),body:_t("There are unsynced orders. Do you want to sync these orders?"),});if(confirmed){this.pos.push_orders();}}
let nextScreen=this.nextScreen;if(nextScreen==="ReceiptScreen"&&!this.currentOrder._printed&&this.pos.config.iface_print_auto){const invoiced_finalized=this.currentOrder.is_to_invoice()?this.currentOrder.finalized:true;if(invoiced_finalized){const printResult=await this.printer.print(OrderReceipt,{data:this.pos.get_order().export_for_printing(),formatCurrency:this.env.utils.formatCurrency,},{webPrintFallback:true});if(printResult&&this.pos.config.iface_print_skip_screen){this.pos.removeOrder(this.currentOrder);this.pos.add_new_order();nextScreen="ProductScreen";}}}
this.pos.showScreen(nextScreen);}
shouldDownloadInvoice(){return true;}
get nextScreen(){return!this.error?"ReceiptScreen":"ProductScreen";}
paymentMethodImage(id){if(this.paymentMethod.image){return`/web/image/pos.payment.method/${id}/image`;}else if(this.paymentMethod.type==="cash"){return"/point_of_sale/static/src/img/money.png";}else if(this.paymentMethod.type==="pay_later"){return"/point_of_sale/static/src/img/pay-later.png";}else{return"/point_of_sale/static/src/img/card-bank.png";}}
async _askForCustomerIfRequired(){const splitPayments=this.paymentLines.filter((payment)=>payment.payment_method.split_transactions);if(splitPayments.length&&!this.currentOrder.get_partner()){const paymentMethod=splitPayments[0].payment_method;const{confirmed}=await this.popup.add(ConfirmPopup,{title:_t("Customer Required"),body:_t("Customer is required for %s payment method.",paymentMethod.name),});if(confirmed){this.selectPartner();}
return false;}}
async _isOrderValid(isForceValidate){if(this.currentOrder.get_orderlines().length===0&&this.currentOrder.is_to_invoice()){this.popup.add(ErrorPopup,{title:_t("Empty Order"),body:_t("There must be at least one product in your order before it can be validated and invoiced."),});return false;}
if((await this._askForCustomerIfRequired())===false){return false;}
if((this.currentOrder.is_to_invoice()||this.currentOrder.getShippingDate())&&!this.currentOrder.get_partner()){const{confirmed}=await this.popup.add(ConfirmPopup,{title:_t("Please select the Customer"),body:_t("You need to select the customer before you can invoice or ship an order."),});if(confirmed){this.selectPartner();}
return false;}
const partner=this.currentOrder.get_partner();if(this.currentOrder.getShippingDate()&&!(partner.name&&partner.street&&partner.city&&partner.country_id)){this.popup.add(ErrorPopup,{title:_t("Incorrect address for shipping"),body:_t("The selected customer needs an address."),});return false;}
if(this.currentOrder.get_total_with_tax()!=0&&this.currentOrder.get_paymentlines().length===0){this.notification.add(_t("Select a payment method to validate the order."));return false;}
if(!this.currentOrder.is_paid()||this.invoicing){return false;}
if(this.currentOrder.has_not_valid_rounding()){var line=this.currentOrder.has_not_valid_rounding();this.popup.add(ErrorPopup,{title:_t("Incorrect rounding"),body:_t("You have to round your payments lines."+line.amount+" is not rounded."),});return false;}
if(Math.abs(this.currentOrder.get_total_with_tax()-
this.currentOrder.get_total_paid()+
this.currentOrder.get_rounding_applied())>0.00001){if(!this.pos.payment_methods.some((pm)=>pm.is_cash_count)){this.popup.add(ErrorPopup,{title:_t("Cannot return change without a cash payment method"),body:_t("There is no cash payment method available in this point of sale to handle the change.\n\n Please pay the exact amount or add a cash payment method in the point of sale configuration"),});return false;}}
if(!isForceValidate&&this.currentOrder.get_total_with_tax()>0&&this.currentOrder.get_total_with_tax()*1000<this.currentOrder.get_total_paid()){this.popup.add(ConfirmPopup,{title:_t("Please Confirm Large Amount"),body:_t("Are you sure that the customer wants to  pay")+" "+
this.env.utils.formatCurrency(this.currentOrder.get_total_paid())+" "+
_t("for an order of")+" "+
this.env.utils.formatCurrency(this.currentOrder.get_total_with_tax())+" "+
_t('? Clicking "Confirm" will validate the payment.'),}).then(({confirmed})=>{if(confirmed){this.validateOrder(true);}});return false;}
if(!this.currentOrder._isValidEmptyOrder()){return false;}
return true;}
async _postPushOrderResolve(order,order_server_ids){return true;}
async sendPaymentRequest(line){this.numberBuffer.capture();this.paymentLines.forEach(function(line){line.can_be_reversed=false;});const isPaymentSuccessful=await line.pay();const{config,currency}=this.pos;const currentOrder=this.pos.get_order();if(isPaymentSuccessful&&currentOrder.is_paid()&&floatIsZero(currentOrder.get_due(),currency.decimal_places)&&config.auto_validate_terminal_payment){this.validateOrder(false);}}
async sendPaymentCancel(line){const payment_terminal=line.payment_method.payment_terminal;line.set_payment_status("waitingCancel");const isCancelSuccessful=await payment_terminal.send_payment_cancel(this.currentOrder,line.cid);if(isCancelSuccessful){line.set_payment_status("retry");}else{line.set_payment_status("waitingCard");}}
async sendPaymentReverse(line){const payment_terminal=line.payment_method.payment_terminal;line.set_payment_status("reversing");const isReversalSuccessful=await payment_terminal.send_payment_reversal(line.cid);if(isReversalSuccessful){line.set_amount(0);line.set_payment_status("reversed");}else{line.can_be_reversed=false;line.set_payment_status("done");}}
async sendForceDone(line){line.set_payment_status("done");}}
registry.category("pos_screens").add("PaymentScreen",PaymentScreen);return __exports;});;

/* /point_of_sale/static/src/app/screens/payment_screen/payment_status/payment_status.js */
odoo.define('@point_of_sale/app/screens/payment_screen/payment_status/payment_status',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const PaymentScreenStatus=__exports.PaymentScreenStatus=class PaymentScreenStatus extends Component{static template="point_of_sale.PaymentScreenStatus";get changeText(){return this.env.utils.formatCurrency(this.props.order.get_change());}
get totalDueText(){return this.env.utils.formatCurrency(this.props.order.get_total_with_tax()+this.props.order.get_rounding_applied());}
get remainingText(){return this.env.utils.formatCurrency(this.props.order.get_due()>0?this.props.order.get_due():0);}}
return __exports;});;

/* /point_of_sale/static/src/app/screens/product_screen/action_pad/action_pad.js */
odoo.define('@point_of_sale/app/screens/product_screen/action_pad/action_pad',['@point_of_sale/app/store/pos_hook','@odoo/owl','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{usePos}=require("@point_of_sale/app/store/pos_hook");const{Component,useState}=require("@odoo/owl");const{useService}=require("@web/core/utils/hooks");const ActionpadWidget=__exports.ActionpadWidget=class ActionpadWidget extends Component{static template="point_of_sale.ActionpadWidget";static defaultProps={isActionButtonHighlighted:false,};setup(){this.pos=usePos();this.ui=useState(useService("ui"));}
get isLongName(){return this.props.partner&&this.props.partner.name.length>10;}
get highlightPay(){return this.pos.get_order()?.orderlines?.length;}
getMainButtonClasses(){return"button btn d-flex flex-column flex-fill align-items-center justify-content-center fw-bolder btn-lg rounded-0";}}
return __exports;});;

/* /point_of_sale/static/src/app/screens/product_screen/control_buttons/control_buttons_popup.js */
odoo.define('@point_of_sale/app/screens/product_screen/control_buttons/control_buttons_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{_t}=require("@web/core/l10n/translation");const ControlButtonPopup=__exports.ControlButtonPopup=class ControlButtonPopup extends AbstractAwaitablePopup{static template="point_of_sale.ControlButtonPopup";static defaultProps={cancelText:_t("Back"),controlButtons:[],confirmKey:false,};setup(){super.setup();this.controlButtons=this.props.controlButtons;}}
return __exports;});;

/* /point_of_sale/static/src/app/screens/product_screen/control_buttons/customer_button/customer_button.js */
odoo.define('@point_of_sale/app/screens/product_screen/control_buttons/customer_button/customer_button',['@point_of_sale/app/store/pos_hook','@point_of_sale/app/screens/product_screen/product_screen','@odoo/owl'],function(require){'use strict';let __exports={};const{usePos}=require("@point_of_sale/app/store/pos_hook");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{Component}=require("@odoo/owl");const CustomerButton=__exports.CustomerButton=class CustomerButton extends Component{static template="point_of_sale.CustomerButton";setup(){this.pos=usePos();}
get partner(){const order=this.pos.get_order();return order?order.get_partner():null;}}
ProductScreen.addControlButton({component:CustomerButton,position:["before","SetFiscalPositionButton"],condition:function(){return this.pos.config.module_pos_restaurant;},});return __exports;});;

/* /point_of_sale/static/src/app/screens/product_screen/control_buttons/customer_note_button/customer_note_button.js */
odoo.define('@point_of_sale/app/screens/product_screen/control_buttons/customer_note_button/customer_note_button',['@web/core/l10n/translation','@point_of_sale/app/screens/product_screen/product_screen','@web/core/utils/hooks','@point_of_sale/app/utils/input_popups/textarea_popup','@odoo/owl','@point_of_sale/app/store/pos_hook'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{useService}=require("@web/core/utils/hooks");const{TextAreaPopup}=require("@point_of_sale/app/utils/input_popups/textarea_popup");const{Component}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const OrderlineCustomerNoteButton=__exports.OrderlineCustomerNoteButton=class OrderlineCustomerNoteButton extends Component{static template="point_of_sale.OrderlineCustomerNoteButton";setup(){this.pos=usePos();this.popup=useService("popup");}
async onClick(){const selectedOrderline=this.pos.get_order().get_selected_orderline();if(!selectedOrderline){return;}
const{confirmed,payload:inputNote}=await this.popup.add(TextAreaPopup,{startingValue:selectedOrderline.get_customer_note(),title:_t("Add Customer Note"),});if(confirmed){selectedOrderline.set_customer_note(inputNote);}}}
ProductScreen.addControlButton({component:OrderlineCustomerNoteButton,});return __exports;});;

/* /point_of_sale/static/src/app/screens/product_screen/control_buttons/fiscal_position_button/fiscal_position_button.js */
odoo.define('@point_of_sale/app/screens/product_screen/control_buttons/fiscal_position_button/fiscal_position_button',['@web/core/l10n/translation','@point_of_sale/app/screens/product_screen/product_screen','@web/core/utils/hooks','@point_of_sale/app/utils/input_popups/selection_popup','@odoo/owl','@point_of_sale/app/store/pos_hook'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{useService}=require("@web/core/utils/hooks");const{SelectionPopup}=require("@point_of_sale/app/utils/input_popups/selection_popup");const{Component}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const SetFiscalPositionButton=__exports.SetFiscalPositionButton=class SetFiscalPositionButton extends Component{static template="point_of_sale.SetFiscalPositionButton";setup(){this.pos=usePos();this.popup=useService("popup");}
get currentOrder(){return this.pos.get_order();}
get currentFiscalPositionName(){return this.currentOrder&&this.currentOrder.fiscal_position?this.currentOrder.fiscal_position.display_name:_t("Tax");}
async click(){const currentFiscalPosition=this.currentOrder.fiscal_position;const fiscalPosList=[{id:-1,label:_t("None"),isSelected:!currentFiscalPosition,},];for(const fiscalPos of this.pos.fiscal_positions){fiscalPosList.push({id:fiscalPos.id,label:fiscalPos.name,isSelected:currentFiscalPosition?fiscalPos.id===currentFiscalPosition.id:false,item:fiscalPos,});}
const{confirmed,payload:selectedFiscalPosition}=await this.popup.add(SelectionPopup,{title:_t("Select Fiscal Position"),list:fiscalPosList,});if(confirmed){this.currentOrder.set_fiscal_position(selectedFiscalPosition);for(const line of this.currentOrder.orderlines){line.set_quantity(line.quantity);}}}}
ProductScreen.addControlButton({component:SetFiscalPositionButton,condition:function(){return this.pos.fiscal_positions.length>0;},position:["before","SetPricelistButton"],});return __exports;});;

/* /point_of_sale/static/src/app/screens/product_screen/control_buttons/pricelist_button/pricelist_button.js */
odoo.define('@point_of_sale/app/screens/product_screen/control_buttons/pricelist_button/pricelist_button',['@web/core/l10n/translation','@point_of_sale/app/screens/product_screen/product_screen','@web/core/utils/hooks','@point_of_sale/app/utils/input_popups/selection_popup','@odoo/owl','@point_of_sale/app/store/pos_hook'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{useService}=require("@web/core/utils/hooks");const{SelectionPopup}=require("@point_of_sale/app/utils/input_popups/selection_popup");const{Component}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const SetPricelistButton=__exports.SetPricelistButton=class SetPricelistButton extends Component{static template="point_of_sale.SetPricelistButton";setup(){this.pos=usePos();this.popup=useService("popup");}
get currentOrder(){return this.pos.get_order();}
get currentPricelistName(){const order=this.currentOrder;return order&&order.pricelist?order.pricelist.display_name:_t("Pricelist");}
async click(){const selectionList=this.pos.pricelists.map((pricelist)=>({id:pricelist.id,label:pricelist.name,isSelected:this.currentOrder.pricelist&&pricelist.id===this.currentOrder.pricelist.id,item:pricelist,}));if(!this.pos.default_pricelist){selectionList.push({id:null,label:_t("Default Price"),isSelected:!this.currentOrder.pricelist,item:null,});}
const{confirmed,payload:selectedPricelist}=await this.popup.add(SelectionPopup,{title:_t("Select the pricelist"),list:selectionList,});if(confirmed){this.currentOrder.set_pricelist(selectedPricelist);}}}
ProductScreen.addControlButton({component:SetPricelistButton,condition:function(){const{config,pricelists}=this.pos;return config.use_pricelist&&pricelists.length>0;},});return __exports;});;

/* /point_of_sale/static/src/app/screens/product_screen/control_buttons/refund_button/refund_button.js */
odoo.define('@point_of_sale/app/screens/product_screen/control_buttons/refund_button/refund_button',['@point_of_sale/app/store/pos_hook','@point_of_sale/app/screens/product_screen/product_screen','@odoo/owl'],function(require){'use strict';let __exports={};const{usePos}=require("@point_of_sale/app/store/pos_hook");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{Component}=require("@odoo/owl");const RefundButton=__exports.RefundButton=class RefundButton extends Component{static template="point_of_sale.RefundButton";setup(){this.pos=usePos();}
click(){const order=this.pos.get_order();const partner=order.get_partner();const searchDetails=partner?{fieldName:"PARTNER",searchTerm:partner.name}:{};this.pos.showScreen("TicketScreen",{ui:{filter:"SYNCED",searchDetails},destinationOrder:order,});}}
ProductScreen.addControlButton({component:RefundButton,condition:function(){return true;},});return __exports;});;

/* /point_of_sale/static/src/app/screens/product_screen/control_buttons/save_button/save_button.js */
odoo.define('@point_of_sale/app/screens/product_screen/control_buttons/save_button/save_button',['@web/core/l10n/translation','@odoo/owl','@point_of_sale/app/store/pos_hook','@point_of_sale/app/screens/product_screen/product_screen','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{Component}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{useService}=require("@web/core/utils/hooks");const SaveButton=__exports.SaveButton=class SaveButton extends Component{static template="point_of_sale.SaveButton";setup(){this.pos=usePos();this.notification=useService("pos_notification");}
onClick(){const orderline=this.pos.get_order().get_selected_orderline();if(!orderline){this.notification.add(_t("You cannot save an empty order"),3000);return;}
this._selectEmptyOrder();this.notification.add(_t("Order saved for later"),3000);}
_selectEmptyOrder(){const orders=this.pos.get_order_list();const emptyOrders=orders.filter((order)=>order.is_empty());if(emptyOrders.length>0){this.pos.sendDraftToServer();this.pos.set_order(emptyOrders[0]);}else{this.pos.add_new_order();}}}
ProductScreen.addControlButton({component:SaveButton,condition:function(){return this.pos.config.trusted_config_ids.length>0;},});return __exports;});;

/* /point_of_sale/static/src/app/screens/product_screen/product_info_popup/product_info_popup.js */
odoo.define('@point_of_sale/app/screens/product_screen/product_info_popup/product_info_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@point_of_sale/app/store/pos_hook'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{usePos}=require("@point_of_sale/app/store/pos_hook");const ProductInfoPopup=__exports.ProductInfoPopup=class ProductInfoPopup extends AbstractAwaitablePopup{static template="point_of_sale.ProductInfoPopup";static defaultProps={confirmKey:false};setup(){super.setup();this.pos=usePos();Object.assign(this,this.props.info);}
searchProduct(productName){this.pos.setSelectedCategoryId(0);this.pos.searchProductWord=productName;this.cancel();}
_hasMarginsCostsAccessRights(){const isAccessibleToEveryUser=this.pos.config.is_margins_costs_accessible_to_every_user;const isCashierManager=this.pos.get_cashier().role==="manager";return isAccessibleToEveryUser||isCashierManager;}}
return __exports;});;

/* /point_of_sale/static/src/app/screens/product_screen/product_list/product_list.js */
odoo.define('@point_of_sale/app/screens/product_screen/product_list/product_list',['@web/core/l10n/translation','@point_of_sale/app/store/pos_hook','@web/core/utils/hooks','@web/core/network/rpc_service','@point_of_sale/app/generic_components/product_card/product_card','@odoo/owl','@point_of_sale/app/errors/popups/offline_error_popup','@point_of_sale/app/errors/popups/error_popup','@point_of_sale/app/screens/product_screen/product_info_popup/product_info_popup','@point_of_sale/app/generic_components/category_selector/category_selector','@point_of_sale/app/generic_components/inputs/input/input'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{useService}=require("@web/core/utils/hooks");const{ConnectionLostError,ConnectionAbortedError}=require("@web/core/network/rpc_service");const{ProductCard}=require("@point_of_sale/app/generic_components/product_card/product_card");const{Component,useState,useEffect,useRef}=require("@odoo/owl");const{OfflineErrorPopup}=require("@point_of_sale/app/errors/popups/offline_error_popup");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{ProductInfoPopup}=require("@point_of_sale/app/screens/product_screen/product_info_popup/product_info_popup");const{CategorySelector}=require("@point_of_sale/app/generic_components/category_selector/category_selector");const{Input}=require("@point_of_sale/app/generic_components/inputs/input/input");const ProductsWidget=__exports.ProductsWidget=class ProductsWidget extends Component{static components={ProductCard,CategorySelector,Input};static template="point_of_sale.ProductsWidget";setup(){this.state=useState({previousSearchWord:"",currentOffset:0,loadingDemo:false,height:0,});this.productsWidgetRef=useRef("products-widget");this.pos=usePos();this.ui=useState(useService("ui"));this.popup=useService("popup");this.notification=useService("pos_notification");this.orm=useService("orm");useEffect(()=>{const productsWidget=this.productsWidgetRef.el;if(!productsWidget){return;}
const observer=new ResizeObserver((entries)=>{if(!entries.length){return;}
const height=entries[0].contentRect.height;this.state.height=height;});observer.observe(productsWidget);return()=>observer.disconnect();});}
getShowCategoryImages(){return(this.pos.show_category_images&&Object.values(this.pos.db.category_by_id).some((category)=>category.has_image)&&!this.ui.isSmall);}
getCategories(){return[...this.pos.db.get_category_ancestors_ids(this.pos.selectedCategoryId),this.pos.selectedCategoryId,...this.pos.db.get_category_childs_ids(this.pos.selectedCategoryId),].map((id)=>this.pos.db.category_by_id[id]).map((category)=>{const isRootCategory=category.id===this.pos.db.root_category_id;const showSeparator=!isRootCategory&&[...this.pos.db.get_category_ancestors_ids(this.pos.selectedCategoryId),this.pos.selectedCategoryId,].includes(category.id);return{id:category.id,name:!isRootCategory?category.name:"",icon:isRootCategory?"fa-home fa-2x":"",separator:"fa-caret-right",showSeparator,imageUrl:category?.has_image&&`/web/image?model=pos.category&field=image_128&id=${category.id}&unique=${category.write_date}`,};});}
get selectedCategoryId(){return this.pos.selectedCategoryId;}
get searchWord(){return this.pos.searchProductWord.trim();}
getProductListToNotDisplay(){return[this.pos.config.tip_product_id];}
get productsToDisplay(){const{db}=this.pos;let list=[];if(this.searchWord!==""){list=db.search_product_in_category(this.selectedCategoryId,this.searchWord);}else{list=db.get_product_by_category(this.selectedCategoryId);}
list=list.filter((product)=>!this.getProductListToNotDisplay().includes(product.id));return list.sort(function(a,b){return a.display_name.localeCompare(b.display_name);});}
get hasNoCategories(){return this.pos.db.get_category_childs_ids(0).length===0;}
get shouldShowButton(){return this.productsToDisplay.length===0&&this.searchWord;}
updateProductList(event){this.pos.setSelectedCategoryId(0);}
async onPressEnterKey(){const{searchProductWord}=this.pos;if(!searchProductWord){return;}
if(this.state.previousSearchWord!==searchProductWord){this.state.currentOffset=0;}
const result=await this.loadProductFromDB();if(result.length>0){this.notification.add(_t('%s product(s) found for "%s".',result.length,searchProductWord),3000);}else{this.notification.add(_t('No more product found for "%s".',searchProductWord),3000);}
if(this.state.previousSearchWord===searchProductWord){this.state.currentOffset+=result.length;}else{this.state.previousSearchWord=searchProductWord;this.state.currentOffset=result.length;}}
async loadProductFromDB(){const{searchProductWord}=this.pos;if(!searchProductWord){return;}
try{const limit=30;const ProductIds=await this.orm.call("product.product","search",[["&",["available_in_pos","=",true],"|","|",["name","ilike",searchProductWord],["default_code","ilike",searchProductWord],["barcode","ilike",searchProductWord],],],{offset:this.state.currentOffset,limit:limit,});if(ProductIds.length){await this.pos._addProducts(ProductIds,false);}
this.updateProductList();return ProductIds;}catch(error){if(error instanceof ConnectionLostError||error instanceof ConnectionAbortedError){return this.popup.add(OfflineErrorPopup,{title:_t("Network Error"),body:_t("Product is not loaded. Tried loading the product from the server but there is a network error."),});}else{throw error;}}}
async loadDemoDataProducts(){try{this.state.loadingDemo=true;const{models_data,successful}=await this.orm.call("pos.session","load_product_frontend",[this.pos.pos_session.id]);if(!successful){this.popup.add(ErrorPopup,{title:_t("Demo products are no longer available"),body:_t("A valid product already exists for Point of Sale. Therefore, demonstration products cannot be loaded."),});}
if(!models_data){this._showLoadDemoDataMissingDataError("models_data");return;}
for(const dataName of["pos.category","product.product","pos.order"]){if(!models_data[dataName]){this._showLoadDemoDataMissingDataError(dataName);return;}}
this.pos.updateModelsData(models_data);}finally{this.state.loadingDemo=false;}}
_showLoadDemoDataMissingDataError(missingData){console.error("Missing '",missingData,"' in pos.session:load_product_frontend server answer.");}
createNewProducts(){window.open("/web#action=point_of_sale.action_client_product_menu","_self");}
async onProductInfoClick(product){const info=await this.pos.getProductInfo(product,1);this.popup.add(ProductInfoPopup,{info:info,product:product});}}
return __exports;});;

/* /point_of_sale/static/src/app/screens/product_screen/product_screen.js */
odoo.define('@point_of_sale/app/screens/product_screen/product_screen',['@point_of_sale/app/utils/control_buttons_mixin','@web/core/registry','@web/core/utils/hooks','@point_of_sale/app/barcode/barcode_reader_hook','@web/views/fields/parsers','@web/core/l10n/translation','@point_of_sale/app/utils/input_popups/number_popup','@point_of_sale/app/errors/popups/error_popup','@point_of_sale/app/screens/product_screen/control_buttons/control_buttons_popup','@web/core/network/rpc_service','@point_of_sale/app/store/pos_hook','@odoo/owl','@point_of_sale/app/barcode/error_popup/barcode_error_popup','@point_of_sale/app/generic_components/numpad/numpad','@point_of_sale/app/screens/product_screen/product_list/product_list','@point_of_sale/app/screens/product_screen/action_pad/action_pad','@point_of_sale/app/generic_components/orderline/orderline','@point_of_sale/app/generic_components/order_widget/order_widget'],function(require){'use strict';let __exports={};const{ControlButtonsMixin}=require("@point_of_sale/app/utils/control_buttons_mixin");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{useBarcodeReader}=require("@point_of_sale/app/barcode/barcode_reader_hook");const{parseFloat}=require("@web/views/fields/parsers");const{_t}=require("@web/core/l10n/translation");const{NumberPopup}=require("@point_of_sale/app/utils/input_popups/number_popup");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{ControlButtonPopup}=require("@point_of_sale/app/screens/product_screen/control_buttons/control_buttons_popup");const{ConnectionLostError}=require("@web/core/network/rpc_service");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{Component,onMounted,useState}=require("@odoo/owl");const{ErrorBarcodePopup}=require("@point_of_sale/app/barcode/error_popup/barcode_error_popup");const{Numpad}=require("@point_of_sale/app/generic_components/numpad/numpad");const{ProductsWidget}=require("@point_of_sale/app/screens/product_screen/product_list/product_list");const{ActionpadWidget}=require("@point_of_sale/app/screens/product_screen/action_pad/action_pad");const{Orderline}=require("@point_of_sale/app/generic_components/orderline/orderline");const{OrderWidget}=require("@point_of_sale/app/generic_components/order_widget/order_widget");const ProductScreen=__exports.ProductScreen=class ProductScreen extends ControlButtonsMixin(Component){static template="point_of_sale.ProductScreen";static components={ActionpadWidget,Numpad,ProductsWidget,Orderline,OrderWidget,};static numpadActionName=_t("Payment");setup(){super.setup();this.pos=usePos();this.ui=useState(useService("ui"));this.popup=useService("popup");this.orm=useService("orm");this.notification=useService("pos_notification");this.numberBuffer=useService("number_buffer");onMounted(this.onMounted);useBarcodeReader({product:this._barcodeProductAction,quantity:this._barcodeProductAction,weight:this._barcodeProductAction,price:this._barcodeProductAction,client:this._barcodePartnerAction,discount:this._barcodeDiscountAction,gs1:this._barcodeGS1Action,});onMounted(()=>this.numberBuffer.reset());this.numberBuffer.use({triggerAtInput:(...args)=>{if(!this.pos.tempScreenIsShown){this.updateSelectedOrderline(...args);}},useWithBarcode:true,});}
onMounted(){this.pos.openCashControl();}
getNumpadButtons(){return[{value:"1"},{value:"2"},{value:"3"},{value:"quantity",text:_t("Qty")},{value:"4"},{value:"5"},{value:"6"},{value:"discount",text:_t("% Disc"),disabled:!this.pos.config.manual_discount},{value:"7"},{value:"8"},{value:"9"},{value:"price",text:_t("Price"),disabled:!this.pos.cashierHasPriceControlRights(),},{value:"-",text:"+/-"},{value:"0"},{value:this.env.services.localization.decimalPoint},{value:"Backspace",text:""},].map((button)=>({...button,class:this.pos.numpadMode===button.value?"active border-primary":"",}));}
onNumpadClick(buttonValue){if(["quantity","discount","price"].includes(buttonValue)){this.numberBuffer.capture();this.numberBuffer.reset();this.pos.numpadMode=buttonValue;return;}
this.numberBuffer.sendKey(buttonValue);}
selectLine(orderline){this.numberBuffer.reset();this.currentOrder.select_orderline(orderline);}
get partner(){return this.currentOrder?this.currentOrder.get_partner():null;}
get currentOrder(){return this.pos.get_order();}
get total(){return this.env.utils.formatCurrency(this.currentOrder?.get_total_with_tax()??0);}
get items(){return this.currentOrder.orderlines?.reduce((items,line)=>items+line.quantity,0)??0;}
async updateSelectedOrderline({buffer,key}){const order=this.pos.get_order();const selectedLine=order.get_selected_orderline();if(selectedLine&&selectedLine.isTipLine()&&this.pos.numpadMode!=="price"){this.numberBuffer.reset();if(key==="Backspace"){this._setValue("remove");}else{this.popup.add(ErrorPopup,{title:_t("Cannot modify a tip"),body:_t("Customer tips, cannot be modified directly"),});}
return;}
if(selectedLine&&this.pos.numpadMode==="quantity"&&this.pos.disallowLineQuantityChange()){const orderlines=order.orderlines;const lastId=orderlines.length!==0&&orderlines.at(orderlines.length-1).cid;const currentQuantity=this.pos.get_order().get_selected_orderline().get_quantity();if(selectedLine.noDecrease){this.popup.add(ErrorPopup,{title:_t("Invalid action"),body:_t("You are not allowed to change this quantity"),});return;}
const parsedInput=(buffer&&parseFloat(buffer))||0;if(lastId!=selectedLine.cid){this._showDecreaseQuantityPopup();}else if(currentQuantity<parsedInput){this._setValue(buffer);}else if(parsedInput<currentQuantity){this._showDecreaseQuantityPopup();}
return;}else if(selectedLine&&this.pos.numpadMode==="discount"&&this.pos.disallowLineDiscountChange()){this.numberBuffer.reset();const{confirmed,payload:inputNumber}=await this.popup.add(NumberPopup,{startingValue:10,title:_t("Set the new discount"),isInputSelected:true,});if(confirmed){await this.pos.setDiscountFromUI(selectedLine,inputNumber);}
return;}
const val=buffer===null?"remove":buffer;this._setValue(val);if(val=="remove"){this.numberBuffer.reset();this.pos.numpadMode="quantity";}}
_setValue(val){const{numpadMode}=this.pos;let selectedLine=this.currentOrder.get_selected_orderline();if(selectedLine){if(numpadMode==="quantity"){if(selectedLine.comboParent){selectedLine=selectedLine.comboParent;}
if(val==="remove"){this.currentOrder.removeOrderline(selectedLine);}else{const result=selectedLine.set_quantity(val,Boolean(selectedLine.comboLines?.length));if(selectedLine.comboLines){for(const line of selectedLine.comboLines){line.set_quantity(val,true);}}
if(!result){this.numberBuffer.reset();}}}else if(numpadMode==="discount"){this.pos.setDiscountFromUI(selectedLine,val);}else if(numpadMode==="price"){selectedLine.price_type="manual";selectedLine.set_unit_price(val);}}}
async _getProductByBarcode(code){let product=this.pos.db.get_product_by_barcode(code.base_code);if(!product){const{product_id=[],packaging=[]}=await this.orm.silent.call("pos.session","find_product_by_barcode",[odoo.pos_session_id,code.base_code]);if(product_id.length){await this.pos._addProducts(product_id,false);if(packaging.length){this.pos.db.add_packagings(packaging);}
product=this.pos.db.get_product_by_id(product_id[0]);}}
return product;}
async _barcodeProductAction(code){const product=await this._getProductByBarcode(code);if(!product){return this.popup.add(ErrorBarcodePopup,{code:code.base_code});}
const options=await product.getAddProductOptions(code);if(!options){return;}
if(code.type==="price"){Object.assign(options,{price:code.value,extras:{price_type:"manual",},});}else if(code.type==="weight"||code.type==="quantity"){Object.assign(options,{quantity:code.value,merge:false,});}else if(code.type==="discount"){Object.assign(options,{discount:code.value,merge:false,});}
this.currentOrder.add_product(product,options);this.numberBuffer.reset();}
async _getPartnerByBarcode(code){let partner=this.pos.db.get_partner_by_barcode(code.code);if(!partner){const foundPartnerIds=await this.orm.search("res.partner",[["barcode","=",code.code],]);if(foundPartnerIds.length){await this.pos._loadPartners(foundPartnerIds);partner=this.pos.db.get_partner_by_id(foundPartnerIds[0]);}}
return partner;}
async _barcodePartnerAction(code){const partner=await this._getPartnerByBarcode(code);if(partner){if(this.currentOrder.get_partner()!==partner){this.currentOrder.set_partner(partner);}
return;}
return this.popup.add(ErrorBarcodePopup,{code:code.base_code});}
_barcodeDiscountAction(code){var last_orderline=this.currentOrder.get_last_orderline();if(last_orderline){this.pos.setDiscountFromUI(last_orderline,code.value);}}
async _parseElementsFromGS1(parsed_results){const productBarcode=parsed_results.find((element)=>element.type==="product");const lotBarcode=parsed_results.find((element)=>element.type==="lot");const product=await this._getProductByBarcode(productBarcode);return{product,lotBarcode,customProductOptions:{}};}
async _barcodeGS1Action(parsed_results){const{product,lotBarcode,customProductOptions}=await this._parseElementsFromGS1(parsed_results);if(!product){const productBarcode=parsed_results.find((element)=>element.type==="product");return this.popup.add(ErrorBarcodePopup,{code:productBarcode.base_code});}
const options=await product.getAddProductOptions(lotBarcode);await this.currentOrder.add_product(product,{...options,...customProductOptions});this.numberBuffer.reset();}
async displayAllControlPopup(){await this.popup.add(ControlButtonPopup,{controlButtons:this.controlButtons,});}
async _showDecreaseQuantityPopup(){this.numberBuffer.reset();const{confirmed,payload:inputNumber}=await this.popup.add(NumberPopup,{startingValue:0,title:_t("Set the new quantity"),});if(confirmed){const newQuantity=inputNumber&&inputNumber!==""?parseFloat(inputNumber):null;return await this.updateQuantityNumber(newQuantity);}}
async updateQuantityNumber(newQuantity){if(newQuantity!==null){const order=this.pos.get_order();const selectedLine=order.get_selected_orderline();const currentQuantity=selectedLine.get_quantity();if(newQuantity>=currentQuantity){selectedLine.set_quantity(newQuantity);}else if(newQuantity>=selectedLine.saved_quantity){await this.handleDecreaseUnsavedLine(newQuantity);}else{await this.handleDecreaseLine(newQuantity);}
return true;}
return false;}
async handleDecreaseUnsavedLine(newQuantity){const order=this.pos.get_order();const selectedLine=order.get_selected_orderline();const decreaseQuantity=selectedLine.get_quantity()-newQuantity;selectedLine.set_quantity(newQuantity);if(newQuantity==0){order._unlinkOrderline(selectedLine);}
return decreaseQuantity;}
async handleDecreaseLine(newQuantity){const order=this.pos.get_order();const selectedLine=order.get_selected_orderline();let current_saved_quantity=0;for(const line of order.orderlines){if(line===selectedLine){current_saved_quantity+=line.saved_quantity;}else if(line.product.id===selectedLine.product.id&&line.get_unit_price()===selectedLine.get_unit_price()){current_saved_quantity+=line.quantity;}}
const newLine=this.getNewLine();const decreasedQuantity=current_saved_quantity-newQuantity;newLine.order=this.currentOrder;if(decreasedQuantity!=0){if(newLine===selectedLine){selectedLine.set_quantity(newQuantity,true);}else{newLine.set_quantity(-decreasedQuantity,true);order.add_orderline(newLine);}}
if(newLine!==selectedLine&&selectedLine.saved_quantity!=0){selectedLine.set_quantity(selectedLine.saved_quantity);}
return decreasedQuantity;}
getNewLine(){const selectedLine=this.currentOrder.get_selected_orderline();let newLine=selectedLine;if(selectedLine.saved_quantity!=0){newLine=selectedLine.clone();newLine.refunded_orderline_id=selectedLine.refunded_orderline_id;}
return newLine;}
get selectedOrderlineQuantity(){return this.currentOrder.get_selected_orderline()?.get_quantity_str();}
get selectedOrderlineDisplayName(){return this.currentOrder.get_selected_orderline()?.get_full_product_name();}
get selectedOrderlineTotal(){return this.env.utils.formatCurrency(this.currentOrder.get_selected_orderline()?.get_display_price());}
get animationKey(){return[this.currentOrder.get_selected_orderline()?.uuid,this.selectedOrderlineQuantity,this.selectedOrderlineDisplayName,this.selectedOrderlineTotal,].join(",");}
primaryPayButton(){return!this.currentOrder.is_empty();}
async onClickPay(){if(this.pos.get_order().server_id){try{const isPaid=await this.orm.call("pos.order","is_already_paid",[this.pos.get_order().server_id,]);if(isPaid){const searchDetails={fieldName:"RECEIPT_NUMBER",searchTerm:this.pos.get_order().uid,};this.pos.showScreen("TicketScreen",{ui:{filter:"SYNCED",searchDetails},});this.notification.add(_t("The order has been already paid."),3000);this.pos.removeOrder(this.pos.get_order(),false);this.pos.add_new_order();return;}}catch(error){if(!(error instanceof ConnectionLostError)){throw error;}
Promise.reject(error);}}
this.currentOrder.pay();}
switchPane(){this.pos.switchPane();}}
registry.category("pos_screens").add("ProductScreen",ProductScreen);return __exports;});;

/* /point_of_sale/static/src/app/screens/receipt_screen/receipt/order_receipt.js */
odoo.define('@point_of_sale/app/screens/receipt_screen/receipt/order_receipt',['@odoo/owl','@point_of_sale/app/generic_components/orderline/orderline','@point_of_sale/app/generic_components/order_widget/order_widget','@point_of_sale/app/screens/receipt_screen/receipt/receipt_header/receipt_header','@web/core/utils/objects'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{Orderline}=require("@point_of_sale/app/generic_components/orderline/orderline");const{OrderWidget}=require("@point_of_sale/app/generic_components/order_widget/order_widget");const{ReceiptHeader}=require("@point_of_sale/app/screens/receipt_screen/receipt/receipt_header/receipt_header");const{omit}=require("@web/core/utils/objects");const OrderReceipt=__exports.OrderReceipt=class OrderReceipt extends Component{static template="point_of_sale.OrderReceipt";static components={Orderline,OrderWidget,ReceiptHeader,};static props={data:Object,formatCurrency:Function,};omit(...args){return omit(...args);}}
return __exports;});;

/* /point_of_sale/static/src/app/screens/receipt_screen/receipt/receipt_header/receipt_header.js */
odoo.define('@point_of_sale/app/screens/receipt_screen/receipt/receipt_header/receipt_header',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const ReceiptHeader=__exports.ReceiptHeader=class ReceiptHeader extends Component{static template="point_of_sale.ReceiptHeader";static props={data:{type:Object,shape:{company:Object,header:{type:[String,{value:false}],optional:true},cashier:{type:String,optional:true},"*":true,},},};}
return __exports;});;

/* /point_of_sale/static/src/app/screens/receipt_screen/receipt_screen.js */
odoo.define('@point_of_sale/app/screens/receipt_screen/receipt_screen',['@web/core/l10n/translation','@point_of_sale/app/utils/hooks','@point_of_sale/app/errors/popups/offline_error_popup','@web/core/registry','@point_of_sale/app/screens/receipt_screen/receipt/order_receipt','@odoo/owl','@point_of_sale/app/store/pos_hook','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{useErrorHandlers}=require("@point_of_sale/app/utils/hooks");const{OfflineErrorPopup}=require("@point_of_sale/app/errors/popups/offline_error_popup");const{registry}=require("@web/core/registry");const{OrderReceipt}=require("@point_of_sale/app/screens/receipt_screen/receipt/order_receipt");const{useRef,useState,onWillStart,Component}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{useService}=require("@web/core/utils/hooks");const ReceiptScreen=__exports.ReceiptScreen=class ReceiptScreen extends Component{static template="point_of_sale.ReceiptScreen";static components={OrderReceipt};setup(){super.setup();this.pos=usePos();this.printer=useService("printer");useErrorHandlers();this.ui=useState(useService("ui"));this.orm=useService("orm");this.renderer=useService("renderer");this.buttonMailReceipt=useRef("order-mail-receipt-button");this.buttonPrintReceipt=useRef("order-print-receipt-button");this.currentOrder=this.pos.get_order();const partner=this.currentOrder.get_partner();this.orderUiState=this.currentOrder.uiState.ReceiptScreen;this.orderUiState.inputEmail=this.orderUiState.inputEmail||(partner&&partner.email)||"";onWillStart(async()=>{if(this.pos.orderPreparationCategories.size){try{this.sendOrderToPreparationTools();}catch(error){Promise.reject(error);}}});}
async sendOrderToPreparationTools(){await this.pos.sendOrderInPreparationUpdateLastChange(this.currentOrder);}
_addNewOrder(){this.pos.add_new_order();}
onSendEmail(){if(this.buttonMailReceipt.el.classList.contains("fa-spin")){this.orderUiState.emailSuccessful=false;this.orderUiState.emailNotice=_t("Sending in progress.");return;}
this.buttonMailReceipt.el.className="fa fa-fw fa-spin fa-circle-o-notch";this.orderUiState.emailNotice="";if(!this.isValidEmail()){this.orderUiState.emailSuccessful=false;this.buttonMailReceipt.el.className="fa fa-paper-plane";this.orderUiState.emailNotice=_t("Invalid email.");return;}
setTimeout(async()=>{try{await this._sendReceiptToCustomer();this.orderUiState.emailSuccessful=true;this.orderUiState.emailNotice=_t("Email sent.");}catch{this.orderUiState.emailSuccessful=false;this.orderUiState.emailNotice=_t("Sending email failed. Please try again.");}
this.buttonMailReceipt.el.className="fa fa-paper-plane";},1000);}
isValidEmail(){return/^.+@.+$/.test(this.orderUiState.inputEmail);}
get orderAmountPlusTip(){const order=this.currentOrder;const orderTotalAmount=order.get_total_with_tax();const tip_product_id=this.pos.config.tip_product_id?.[0];const tipLine=order.get_orderlines().find((line)=>tip_product_id&&line.product.id===tip_product_id);const tipAmount=tipLine?tipLine.get_all_prices().priceWithTax:0;const orderAmountStr=this.env.utils.formatCurrency(orderTotalAmount-tipAmount);if(!tipAmount){return orderAmountStr;}
const tipAmountStr=this.env.utils.formatCurrency(tipAmount);return`${orderAmountStr} + ${tipAmountStr} tip`;}
get nextScreen(){return{name:"ProductScreen"};}
get ticketScreen(){return{name:"TicketScreen"};}
orderDone(){this.pos.removeOrder(this.currentOrder);this._addNewOrder();this.pos.resetProductScreenSearch();const{name,props}=this.nextScreen;this.pos.showScreen(name,props);}
resumeOrder(){this.pos.removeOrder(this.currentOrder);this.pos.selectNextOrder();const{name,props}=this.ticketScreen;this.pos.showScreen(name,props);}
continueSplitting(){this.pos.selectedOrder=this.currentOrder.originalSplittedOrder;this.pos.removeOrder(this.currentOrder);this.pos.showScreen("ProductScreen");}
isResumeVisible(){return this.pos.get_order_list().length>1;}
async printReceipt(){this.buttonPrintReceipt.el.className="fa fa-fw fa-spin fa-circle-o-notch";const isPrinted=await this.printer.print(OrderReceipt,{data:this.pos.get_order().export_for_printing(),formatCurrency:this.env.utils.formatCurrency,},{webPrintFallback:true});if(isPrinted){this.currentOrder._printed=true;}
if(this.buttonPrintReceipt.el){this.buttonPrintReceipt.el.className="fa fa-print";}}
async _sendReceiptToCustomer(){const partner=this.currentOrder.get_partner();const orderPartner={email:this.orderUiState.inputEmail,name:partner?partner.name:this.orderUiState.inputEmail,};await this.sendToCustomer(orderPartner,"action_receipt_to_customer");}
async sendToCustomer(orderPartner,methodName){const ticketImage=await this.renderer.toJpeg(OrderReceipt,{data:this.pos.get_order().export_for_printing(),formatCurrency:this.env.utils.formatCurrency,},{addClass:"pos-receipt-print"});const order=this.currentOrder;const orderName=order.get_name();const order_server_id=this.pos.validated_orders_name_server_id_map[orderName];if(!order_server_id){this.popup.add(OfflineErrorPopup,{title:_t("Unsynced order"),body:_t("This order is not yet synced to server. Make sure it is synced then try again."),});return Promise.reject();}
await this.orm.call("pos.order",methodName,[[order_server_id],orderName,orderPartner,ticketImage,]);}}
registry.category("pos_screens").add("ReceiptScreen",ReceiptScreen);return __exports;});;

/* /point_of_sale/static/src/app/screens/receipt_screen/reprint_receipt_screen.js */
odoo.define('@point_of_sale/app/screens/receipt_screen/reprint_receipt_screen',['@point_of_sale/app/store/pos_hook','@point_of_sale/app/screens/receipt_screen/receipt/order_receipt','@web/core/registry','@odoo/owl','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{usePos}=require("@point_of_sale/app/store/pos_hook");const{OrderReceipt}=require("@point_of_sale/app/screens/receipt_screen/receipt/order_receipt");const{registry}=require("@web/core/registry");const{Component}=require("@odoo/owl");const{useService}=require("@web/core/utils/hooks");const ReprintReceiptScreen=__exports.ReprintReceiptScreen=class ReprintReceiptScreen extends Component{static template="point_of_sale.ReprintReceiptScreen";static components={OrderReceipt};static storeOnOrder=false;static props=["order"];setup(){super.setup();this.pos=usePos();this.printer=useService("printer");}
confirm(){this.pos.showScreen("TicketScreen",{reuseSavedUIState:true});}
tryReprint(){this.printer.print(OrderReceipt,{data:this.props.order.export_for_printing(),formatCurrency:this.env.utils.formatCurrency,},{webPrintFallback:true});}}
registry.category("pos_screens").add("ReprintReceiptScreen",ReprintReceiptScreen);return __exports;});;

/* /point_of_sale/static/src/app/screens/scale_screen/scale_screen.js */
odoo.define('@point_of_sale/app/screens/scale_screen/scale_screen',['@web/core/utils/numbers','@web/core/registry','@point_of_sale/app/store/pos_hook','@odoo/owl','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{roundPrecision:round_pr}=require("@web/core/utils/numbers");const{registry}=require("@web/core/registry");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{Component,onMounted,onWillUnmount,useExternalListener,useState}=require("@odoo/owl");const{useService}=require("@web/core/utils/hooks");const ScaleScreen=__exports.ScaleScreen=class ScaleScreen extends Component{static template="point_of_sale.ScaleScreen";setup(){this.pos=usePos();this.hardwareProxy=useService("hardware_proxy");useExternalListener(document,"keyup",this._onHotkeys);this.state=useState({weight:0});onMounted(this.onMounted);onWillUnmount(this.onWillUnmount);this.pos=usePos();}
onMounted(){this._readScale();}
onWillUnmount(){this.shouldRead=false;}
back(){this.props.resolve({confirmed:false,payload:null});this.pos.closeTempScreen();}
confirm(){this.props.resolve({confirmed:true,payload:{weight:this.state.weight},});this.pos.closeTempScreen();}
_onHotkeys(event){if(event.key==="Escape"){this.back();}else if(event.key==="Enter"){this.confirm();}}
_readScale(){this.shouldRead=true;this._setWeight();}
async _setWeight(){if(!this.shouldRead){return;}
this.state.weight=await this.hardwareProxy.readScale();setTimeout(()=>this._setWeight(),500);}
get _activePricelist(){const current_order=this.pos.get_order();let current_pricelist=this.pos.default_pricelist;if(current_order){current_pricelist=current_order.pricelist;}
return current_pricelist;}
get productWeightString(){const defaultstr=(this.state.weight||0).toFixed(3)+" Kg";if(!this.props.product){return defaultstr;}
const unit_id=this.props.product.uom_id;if(!unit_id){return defaultstr;}
const unit=this.pos.units_by_id[unit_id[0]];const weight=round_pr(this.state.weight||0,unit.rounding);let weightstr=weight.toFixed(Math.ceil(Math.log(1.0/unit.rounding)/Math.log(10)));weightstr+=" "+unit.name;return weightstr;}
get computedPriceString(){return this.env.utils.formatCurrency(this.productPrice*this.state.weight);}
get productPrice(){const product=this.props.product;return(product?product.get_price(this._activePricelist,this.state.weight):0)||0;}
get productName(){return this.props.product?.display_name||"Unnamed Product";}
get productUom(){if(!this.props.product){return"";}
return this.pos.units_by_id[this.props.product.uom_id[0]].name;}}
registry.category("pos_screens").add("ScaleScreen",ScaleScreen);return __exports;});;

/* /point_of_sale/static/src/app/screens/ticket_screen/invoice_button/invoice_button.js */
odoo.define('@point_of_sale/app/screens/ticket_screen/invoice_button/invoice_button',['@web/core/l10n/translation','@web/core/utils/hooks','@point_of_sale/app/errors/popups/error_popup','@point_of_sale/app/utils/confirm_popup/confirm_popup','@point_of_sale/app/store/pos_hook','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{useService}=require("@web/core/utils/hooks");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{Component,useRef}=require("@odoo/owl");const InvoiceButton=__exports.InvoiceButton=class InvoiceButton extends Component{static template="point_of_sale.InvoiceButton";setup(){this.pos=usePos();this.invoiceButton=useRef("invoice-button");this.popup=useService("popup");this.orm=useService("orm");this.report=useService("report");}
get isAlreadyInvoiced(){if(!this.props.order){return false;}
return Boolean(this.props.order.account_move);}
get commandName(){if(!this.props.order){return _t("Invoice");}else{return this.isAlreadyInvoiced?_t("Reprint Invoice"):_t("Invoice");}}
async _downloadInvoice(orderId){try{const[orderWithInvoice]=await this.orm.read("pos.order",[orderId],["account_move"],{load:false});if(orderWithInvoice?.account_move){await this.report.doAction("account.account_invoices",[orderWithInvoice.account_move,]);}}catch(error){if(error instanceof Error){throw error;}else{this.popup.add(ErrorPopup,{title:_t("Network Error"),body:_t("Unable to download invoice."),});}}}
async onWillInvoiceOrder(order){return true;}
async _invoiceOrder(){const order=this.props.order;if(!order){return;}
const orderId=order.backendId;if(this.isAlreadyInvoiced){await this._downloadInvoice(orderId);return;}
const prevPartner=order.get_partner();if(!prevPartner){const{confirmed:confirmedPopup}=await this.popup.add(ConfirmPopup,{title:_t("Need customer to invoice"),body:_t("Do you want to open the customer list to select customer?"),});if(!confirmedPopup){return;}
const{confirmed:confirmedTempScreen,payload:newPartner}=await this.pos.showTempScreen("PartnerListScreen");if(!confirmedTempScreen){return;}
await this.orm.write("pos.order",[orderId],{partner_id:newPartner.id});order.set_partner(newPartner);}
const confirmed=await this.onWillInvoiceOrder(order);if(!confirmed){order.set_partner(prevPartner);return;}
await this.orm.silent.call("pos.order","action_pos_order_invoice",[orderId]);await this._downloadInvoice(orderId);this.props.onInvoiceOrder(orderId);}
async click(){try{this.invoiceButton.el.style.pointerEvents="none";await this._invoiceOrder();}finally{this.invoiceButton.el.style.pointerEvents="auto";}}}
return __exports;});;

/* /point_of_sale/static/src/app/screens/ticket_screen/reprint_receipt_button/reprint_receipt_button.js */
odoo.define('@point_of_sale/app/screens/ticket_screen/reprint_receipt_button/reprint_receipt_button',['@point_of_sale/app/store/pos_hook','@odoo/owl','@web/core/utils/hooks','@point_of_sale/app/screens/receipt_screen/receipt/order_receipt','@point_of_sale/app/utils/hooks'],function(require){'use strict';let __exports={};const{usePos}=require("@point_of_sale/app/store/pos_hook");const{Component}=require("@odoo/owl");const{useService}=require("@web/core/utils/hooks");const{OrderReceipt}=require("@point_of_sale/app/screens/receipt_screen/receipt/order_receipt");const{useAsyncLockedMethod}=require("@point_of_sale/app/utils/hooks");const ReprintReceiptButton=__exports.ReprintReceiptButton=class ReprintReceiptButton extends Component{static template="point_of_sale.ReprintReceiptButton";setup(){this.pos=usePos();this.printer=useService("printer");this.click=useAsyncLockedMethod(this.click);}
async click(){if(!this.props.order){return;}
(await this.printer.print(OrderReceipt,{data:this.props.order.export_for_printing(),formatCurrency:this.env.utils.formatCurrency,}))||this.pos.showScreen("ReprintReceiptScreen",{order:this.props.order});}}
return __exports;});;

/* /point_of_sale/static/src/app/screens/ticket_screen/search_bar/search_bar.js */
odoo.define('@point_of_sale/app/screens/ticket_screen/search_bar/search_bar',['@odoo/owl','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{Component,useExternalListener,useState}=require("@odoo/owl");const{useAutofocus,useService}=require("@web/core/utils/hooks");const SearchBar=__exports.SearchBar=class SearchBar extends Component{static template="point_of_sale.SearchBar";setup(){this.ui=useState(useService("ui"));useAutofocus();useExternalListener(window,"click",this._hideOptions);this.filterOptionsList=[...this.props.config.filter.options.keys()];this.searchFieldsList=[...this.props.config.searchFields.keys()];const defaultSearchFieldId=this.searchFieldsList.indexOf(this.props.config.defaultSearchDetails.fieldName);this.state=useState({searchInput:this.props.config.defaultSearchDetails.searchTerm||"",selectedSearchFieldId:defaultSearchFieldId==-1?0:defaultSearchFieldId,showSearchFields:false,showFilterOptions:false,selectedFilter:this.props.config.defaultFilter||this.filterOptionsList[0],});}
_onSelectFilter(key){this.state.selectedFilter=key;this.props.onFilterSelected(this.state.selectedFilter);}
onSearchInputKeydown(event){if(["ArrowUp","ArrowDown"].includes(event.key)){event.preventDefault();}}
onSearchInputKeyup(event){if(["ArrowUp","ArrowDown"].includes(event.key)){this.state.selectedSearchFieldId=this._fieldIdToSelect(event.key);}else if(event.key==="Enter"||this.state.searchInput==""){this._onClickSearchField(this.searchFieldsList[this.state.selectedSearchFieldId]);}else{if(this.state.selectedSearchFieldId===-1&&this.searchFieldsList.length){this.state.selectedSearchFieldId=0;}
this.state.showSearchFields=true;}}
_onClickSearchField(fieldName){this.state.showSearchFields=false;this.props.onSearch({fieldName,searchTerm:this.state.searchInput});}
_fieldIdToSelect(key){const length=this.searchFieldsList.length;if(!length){return null;}
if(this.state.selectedSearchFieldId===-1){return 0;}
const current=this.state.selectedSearchFieldId||length;return(current+(key==="ArrowDown"?1:-1))%length;}
_hideOptions(){this.state.showFilterOptions=false;this.state.showSearchFields=false;}}
return __exports;});;

/* /point_of_sale/static/src/app/screens/ticket_screen/ticket_screen.js */
odoo.define('@point_of_sale/app/screens/ticket_screen/ticket_screen',['@point_of_sale/app/store/models','@web/core/registry','@web/core/utils/hooks','@web/core/l10n/dates','@web/views/fields/parsers','@web/core/l10n/translation','@point_of_sale/app/errors/popups/error_popup','@point_of_sale/app/utils/confirm_popup/confirm_popup','@point_of_sale/app/screens/product_screen/action_pad/action_pad','@point_of_sale/app/screens/ticket_screen/invoice_button/invoice_button','@point_of_sale/app/generic_components/orderline/orderline','@point_of_sale/app/generic_components/order_widget/order_widget','@point_of_sale/app/generic_components/centered_icon/centered_icon','@point_of_sale/app/screens/ticket_screen/reprint_receipt_button/reprint_receipt_button','@point_of_sale/app/screens/ticket_screen/search_bar/search_bar','@point_of_sale/app/store/pos_hook','@odoo/owl','@point_of_sale/app/generic_components/numpad/numpad'],function(require){'use strict';let __exports={};const{Order}=require("@point_of_sale/app/store/models");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{deserializeDateTime,formatDateTime,parseDateTime}=require("@web/core/l10n/dates");const{parseFloat}=require("@web/views/fields/parsers");const{_t}=require("@web/core/l10n/translation");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{ActionpadWidget}=require("@point_of_sale/app/screens/product_screen/action_pad/action_pad");const{InvoiceButton}=require("@point_of_sale/app/screens/ticket_screen/invoice_button/invoice_button");const{Orderline}=require("@point_of_sale/app/generic_components/orderline/orderline");const{OrderWidget}=require("@point_of_sale/app/generic_components/order_widget/order_widget");const{CenteredIcon}=require("@point_of_sale/app/generic_components/centered_icon/centered_icon");const{ReprintReceiptButton}=require("@point_of_sale/app/screens/ticket_screen/reprint_receipt_button/reprint_receipt_button");const{SearchBar}=require("@point_of_sale/app/screens/ticket_screen/search_bar/search_bar");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{Component,onMounted,useState}=require("@odoo/owl");const{Numpad}=require("@point_of_sale/app/generic_components/numpad/numpad");const{DateTime}=luxon;const TicketScreen=__exports.TicketScreen=class TicketScreen extends Component{static storeOnOrder=false;static template="point_of_sale.TicketScreen";static components={ActionpadWidget,InvoiceButton,Orderline,OrderWidget,CenteredIcon,ReprintReceiptButton,SearchBar,Numpad,};static defaultProps={destinationOrder:null,reuseSavedUIState:false,ui:{},};static numpadActionName=_t("Refund");static searchPlaceholder=_t("Search Orders...");setup(){this.pos=usePos();this.ui=useState(useService("ui"));this.popup=useService("popup");this.orm=useService("orm");this.numberBuffer=useService("number_buffer");this.numberBuffer.use({triggerAtInput:(event)=>this._onUpdateSelectedOrderline(event),});this._state=this.pos.TICKET_SCREEN_STATE;const defaultUIState=this.props.reuseSavedUIState?this._state.ui:{selectedOrder:this.pos.get_order(),searchDetails:this.pos.getDefaultSearchDetails(),filter:null,selectedOrderlineIds:{},};Object.assign(this._state.ui,defaultUIState,this.props.ui||{});onMounted(this.onMounted);}
onMounted(){setTimeout(()=>{this.onFilterSelected(this._state.ui.filter);});}
async onFilterSelected(selectedFilter){this._state.ui.filter=selectedFilter;if(this._state.ui.filter=="ACTIVE_ORDERS"||this._state.ui.filter===null){this._state.ui.selectedOrder=this.pos.get_order();}
if(this._state.ui.filter=="SYNCED"){await this._fetchSyncedOrders();}}
getNumpadButtons(){return[{value:"1"},{value:"2"},{value:"3"},{value:"quantity",text:_t("Qty"),class:"active border-primary"},{value:"4"},{value:"5"},{value:"6"},{value:"discount",text:_t("% Disc"),disabled:true},{value:"7"},{value:"8"},{value:"9"},{value:"price",text:_t("Price"),disabled:true},{value:"-",text:"+/-",disabled:true},{value:"0"},{value:this.env.services.localization.decimalPoint},{value:"Backspace",text:""},];}
async onSearch(search){Object.assign(this._state.ui.searchDetails,search);if(this._state.ui.filter=="SYNCED"){this._state.syncedOrders.currentPage=1;await this._fetchSyncedOrders();}}
onClickOrder(clickedOrder){this._state.ui.selectedOrder=clickedOrder;this.numberBuffer.reset();if((!clickedOrder||clickedOrder.locked)&&!this.getSelectedOrderlineId()){const firstLine=this._state.ui.selectedOrder.get_orderlines()[0];if(firstLine){this._state.ui.selectedOrderlineIds[clickedOrder.backendId]=firstLine.id;}}}
onCreateNewOrder(){this.pos.add_new_order();this.pos.showScreen("ProductScreen");}
_selectNextOrder(currentOrder){const currentOrderIndex=this._getOrderList().indexOf(currentOrder);const orderList=this._getOrderList();this.pos.set_order(orderList[currentOrderIndex+1]||orderList[currentOrderIndex-1]);}
async onDeleteOrder(order){const screen=order.get_screen_data();if(["ProductScreen","PaymentScreen"].includes(screen.name)&&order.get_orderlines().length>0){const{confirmed}=await this.popup.add(ConfirmPopup,{title:_t("Existing orderlines"),body:_t("%s has a total amount of %s, are you sure you want to delete this order?",order.name,this.getTotal(order)),});if(!confirmed){return confirmed;}}
if(order&&(await this._onBeforeDeleteOrder(order))){if(Object.keys(order.lastOrderPrepaChange).length>0){await this.pos.sendOrderInPreparationUpdateLastChange(order,true);}
if(order===this.pos.get_order()){this._selectNextOrder(order);}
this.pos.removeOrder(order);if(this._state.ui.selectedOrder===order){if(this.pos.get_order_list().length>0){this._state.ui.selectedOrder=this.pos.get_order_list()[0];}else{this._state.ui.selectedOrder=null;}}}
if(this.pos.isOpenOrderShareable()){await this.pos._removeOrdersFromServer();}
return true;}
async onNextPage(){if(this._state.syncedOrders.currentPage<this._getLastPage()){this._state.syncedOrders.currentPage+=1;await this._fetchSyncedOrders();}}
async onPrevPage(){if(this._state.syncedOrders.currentPage>1){this._state.syncedOrders.currentPage-=1;await this._fetchSyncedOrders();}}
async onInvoiceOrder(orderId){this.pos._invalidateSyncedOrdersCache([orderId]);await this._fetchSyncedOrders();}
onClickOrderline(orderline){if(this._state.ui.selectedOrder.locked){const order=this.getSelectedOrder();this._state.ui.selectedOrderlineIds[order.backendId]=orderline.id;this.numberBuffer.reset();}}
onClickRefundOrderUid(orderUid){const refundOrder=this.pos.orders.find((order)=>order.uid==orderUid);if(refundOrder){this._setOrder(refundOrder);}}
_onUpdateSelectedOrderline({key,buffer}){const order=this.getSelectedOrder();if(!order){return this.numberBuffer.reset();}
const selectedOrderlineId=this.getSelectedOrderlineId();const orderline=order.orderlines.find((line)=>line.id==selectedOrderlineId);if(!orderline){return this.numberBuffer.reset();}
const toRefundDetails=orderline.getAllLinesInCombo().map((line)=>this._getToRefundDetail(line));for(const toRefundDetail of toRefundDetails){if(toRefundDetail.destinationOrderUid){return this.numberBuffer.reset();}
const refundableQty=toRefundDetail.orderline.qty-toRefundDetail.orderline.refundedQty;if(refundableQty<=0){return this.numberBuffer.reset();}
if(buffer==null||buffer==""){toRefundDetail.qty=0;}else{const quantity=Math.abs(parseFloat(buffer));if(quantity>refundableQty){this.numberBuffer.reset();if(!toRefundDetail.orderline.comboParent){this.popup.add(ErrorPopup,{title:_t("Maximum Exceeded"),body:_t("The requested quantity to be refunded is higher than the ordered quantity. %s is requested while only %s can be refunded.",quantity,refundableQty),});}}else{toRefundDetail.qty=quantity;}}}}
async addAdditionalRefundInfo(order,destinationOrder){return Promise.resolve();}
async onDoRefund(){const order=this.getSelectedOrder();if(order&&this._doesOrderHaveSoleItem(order)){if(!this._prepareAutoRefundOnOrder(order)){return;}}
if(!order){this._state.ui.highlightHeaderNote=!this._state.ui.highlightHeaderNote;return;}
const partner=order.get_partner();const allToRefundDetails=this._getRefundableDetails(partner);if(allToRefundDetails.length==0){this._state.ui.highlightHeaderNote=!this._state.ui.highlightHeaderNote;return;}
const invoicedOrderIds=new Set(allToRefundDetails.filter((detail)=>this._state.syncedOrders.cache[detail.orderline.orderBackendId]?.state==="invoiced").map((detail)=>detail.orderline.orderBackendId));if(invoicedOrderIds.size>1){this.popup.add(ErrorPopup,{title:_t("Multiple Invoiced Orders Selected"),body:_t("You have selected orderlines from multiple invoiced orders. To proceed refund, please select orderlines from the same invoiced order."),});return;}
const destinationOrder=this.props.destinationOrder&&partner===this.props.destinationOrder.get_partner()&&!this.pos.doNotAllowRefundAndSales()?this.props.destinationOrder:this._getEmptyOrder(partner);const originalToDestinationLineMap=new Map();for(const refundDetail of allToRefundDetails){const product=this.pos.db.get_product_by_id(refundDetail.orderline.productId);const options=this._prepareRefundOrderlineOptions(refundDetail);const newOrderline=await destinationOrder.add_product(product,options);originalToDestinationLineMap.set(refundDetail.orderline.id,newOrderline);refundDetail.destinationOrderUid=destinationOrder.uid;}
for(const refundDetail of allToRefundDetails){const originalOrderline=refundDetail.orderline;const destinationOrderline=originalToDestinationLineMap.get(originalOrderline.id);if(originalOrderline.comboParent){const comboParentLine=originalToDestinationLineMap.get(originalOrderline.comboParent.id);if(comboParentLine){destinationOrderline.comboParent=comboParentLine;}}
if(originalOrderline.comboLines&&originalOrderline.comboLines.length>0){destinationOrderline.comboLines=originalOrderline.comboLines.map((comboLine)=>{return originalToDestinationLineMap.get(comboLine.id);});}}
if(order.fiscal_position_not_found){this.showPopup("ErrorPopup",{title:_t("Fiscal Position not found"),body:_t("The fiscal position used in the original order is not loaded. Make sure it is loaded by adding it in the pos configuration."),});return;}
destinationOrder.fiscal_position=order.fiscal_position;this.setPartnerToRefundOrder(partner,destinationOrder);if(this.pos.get_order().cid!==destinationOrder.cid){this.pos.set_order(destinationOrder);}
await this.addAdditionalRefundInfo(order,destinationOrder);this.closeTicketScreen();}
setPartnerToRefundOrder(partner,destinationOrder){if(partner&&!destinationOrder.get_partner()){destinationOrder.set_partner(partner);}}
getSelectedOrder(){if(this._state.ui.filter=="SYNCED"&&this._state.ui.selectedOrder){return this._state.syncedOrders.cache[this._state.ui.selectedOrder.backendId];}else{return this._state.ui.selectedOrder;}}
getSelectedOrderlineId(){if(this._state.ui.selectedOrder?.backendId){return this._state.ui.selectedOrderlineIds[this._state.ui.selectedOrder.backendId];}}
get allowNewOrders(){return true;}
get isOrderSynced(){return this._state.ui.selectedOrder?.locked;}
getFilteredOrderList(){if(this._state.ui.filter=="SYNCED"){return this._state.syncedOrders.toShow;}
const filterCheck=(order)=>{if(this._state.ui.filter&&this._state.ui.filter!=="ACTIVE_ORDERS"){const screen=order.get_screen_data();return this._state.ui.filter===this._getScreenToStatusMap()[screen.name];}
return true;};const{fieldName,searchTerm}=this._state.ui.searchDetails;const searchField=this._getSearchFields()[fieldName];const searchCheck=(order)=>{if(!searchField){return true;}
const repr=searchField.repr(order);if(repr===null){return true;}
if(!searchTerm){return true;}
return repr&&repr.toString().toLowerCase().includes(searchTerm.toLowerCase());};const predicate=(order)=>{return filterCheck(order)&&searchCheck(order);};return this._getOrderList().filter(predicate);}
getDate(order){return formatDateTime(order.date_order);}
getTotal(order){return this.env.utils.formatCurrency(order.get_total_with_tax());}
getPartner(order){return order.get_partner_name();}
getCardholderName(order){return order.get_cardholder_name();}
getCashier(order){return order.cashier?order.cashier.name:"";}
getStatus(order){if(order.locked){return order.state==="invoiced"?_t("Invoiced"):_t("Paid");}else{const screen=order.get_screen_data();return this._getOrderStates().get(this._getScreenToStatusMap()[screen.name]).text;}}
isDefaultOrderEmpty(order){const status=this._getScreenToStatusMap()[order.get_screen_data().name];const productScreenStatus=this._getScreenToStatusMap().ProductScreen;return(order.get_orderlines().length===0&&this.pos.get_order_list().length===1&&status===productScreenStatus&&order.get_paymentlines().length===0);}
shouldHideDeleteButton(order){return((this.ui.isSmall&&order!=this._state.ui.selectedOrder)||this.isDefaultOrderEmpty(order)||order.locked||order.get_paymentlines().some((payment)=>payment.is_electronic()&&payment.get_payment_status()==="done"));}
isHighlighted(order){const selectedOrder=this.getSelectedOrder();return selectedOrder?(order.backendId&&order.backendId==selectedOrder.backendId)||order.uid===selectedOrder.uid:false;}
showCardholderName(){return this.pos.payment_methods.some((method)=>method.use_payment_terminal);}
getSearchBarConfig(){return{searchFields:new Map(Object.entries(this._getSearchFields()).map(([key,val])=>[key,val.displayName])),filter:{show:true,options:this._getFilterOptions()},defaultSearchDetails:this._state.ui.searchDetails,defaultFilter:this._state.ui.filter,};}
shouldShowPageControls(){return this._state.ui.filter=="SYNCED"&&this._getLastPage()>1;}
getPageNumber(){if(!this._state.syncedOrders.totalCount){return`1/1`;}else{return`${this._state.syncedOrders.currentPage}/${this._getLastPage()}`;}}
getSelectedPartner(){const order=this.getSelectedOrder();return order?order.get_partner():null;}
getHasItemsToRefund(){const order=this.getSelectedOrder();if(!order){return false;}
if(this._doesOrderHaveSoleItem(order)){return true;}
const total=Object.values(this.pos.toRefundLines).filter((toRefundDetail)=>toRefundDetail.orderline.orderUid===order.uid&&!toRefundDetail.destinationOrderUid).map((toRefundDetail)=>toRefundDetail.qty).reduce((acc,val)=>acc+val,0);return!this.pos.isProductQtyZero(total);}
switchPane(){this.pos.switchPaneTicketScreen();}
closeTicketScreen(){this.pos.ticket_screen_mobile_pane="left";this.pos.closeScreen();}
_getEmptyOrder(partner){let emptyOrderForPartner=null;let emptyOrder=null;for(const order of this.pos.orders){if(order.get_orderlines().length===0&&order.get_paymentlines().length===0){if(order.get_partner()===partner){emptyOrderForPartner=order;break;}else if(!order.get_partner()&&emptyOrder===null){emptyOrder=order;}}}
return emptyOrderForPartner||emptyOrder||this.pos.add_new_order();}
_doesOrderHaveSoleItem(order){const orderlines=order.get_orderlines();if(orderlines.length!==1){return false;}
const theOrderline=orderlines[0];const refundableQty=theOrderline.get_quantity()-theOrderline.refunded_qty;return this.pos.isProductQtyZero(refundableQty-1);}
_prepareAutoRefundOnOrder(order){const selectedOrderlineId=this.getSelectedOrderlineId();const orderline=order.orderlines.find((line)=>line.id==selectedOrderlineId);if(!orderline){return false;}
const toRefundDetail=this._getToRefundDetail(orderline);const refundableQty=orderline.get_quantity()-orderline.refunded_qty;if(this.pos.isProductQtyZero(refundableQty-1)&&toRefundDetail.qty===0){toRefundDetail.qty=1;}
return true;}
_getToRefundDetail(orderline){const{toRefundLines}=this.pos;if(orderline.id in toRefundLines){return toRefundLines[orderline.id];}
const partner=orderline.order.get_partner();const orderPartnerId=partner?partner.id:false;const newToRefundDetail={qty:0,orderline:{id:orderline.id,productId:orderline.product.id,price:orderline.price,qty:orderline.quantity,refundedQty:orderline.refunded_qty,orderUid:orderline.order.uid,orderBackendId:orderline.order.backendId,orderPartnerId,tax_ids:orderline.get_taxes().map((tax)=>tax.id),discount:orderline.discount,pack_lot_lines:orderline.pack_lot_lines?orderline.pack_lot_lines.map((lot)=>{return{lot_name:lot.lot_name};}):false,comboParent:orderline.comboParent,comboLines:orderline.comboLines,},destinationOrderUid:false,};toRefundLines[orderline.id]=newToRefundDetail;return newToRefundDetail;}
_getRefundableDetails(partner){return Object.values(this.pos.toRefundLines).filter(({qty,orderline,destinationOrderUid})=>!this.pos.isProductQtyZero(qty)&&(partner?orderline.orderPartnerId==partner.id:true)&&!destinationOrderUid);}
_prepareRefundOrderlineOptions(toRefundDetail){const{qty,orderline}=toRefundDetail;const draftPackLotLines=orderline.pack_lot_lines?{modifiedPackLotLines:[],newPackLotLines:orderline.pack_lot_lines}:false;return{quantity:-qty,price:orderline.price,extras:{price_type:"automatic"},merge:false,refunded_orderline_id:orderline.id,tax_ids:orderline.tax_ids,discount:orderline.discount,draftPackLotLines:draftPackLotLines,};}
_setOrder(order){if(this.pos.isOpenOrderShareable()){this.pos.sendDraftToServer();}
this.pos.set_order(order);this.closeTicketScreen();}
_getOrderList(){return this.pos.get_order_list();}
_getFilterOptions(){const orderStates=this._getOrderStates();orderStates.set("SYNCED",{text:_t("Paid")});return orderStates;}
_getSearchFields(){const fields={TRACKING_NUMBER:{repr:(order)=>order.trackingNumber,displayName:_t("Order Number"),modelField:"tracking_number",},RECEIPT_NUMBER:{repr:(order)=>order.name,displayName:_t("Receipt Number"),modelField:"pos_reference",},DATE:{repr:(order)=>formatDateTime(order.date_order),displayName:_t("Date"),modelField:"date_order",formatSearch:(searchTerm)=>{const includesTime=searchTerm.includes(':');let parsedDateTime;try{parsedDateTime=parseDateTime(searchTerm);}catch{return searchTerm;}
if(includesTime){return parsedDateTime.toUTC().toFormat("yyyy-MM-dd HH:mm:ss");}else{return parsedDateTime.toFormat("yyyy-MM-dd");}}},PARTNER:{repr:(order)=>order.get_partner_name(),displayName:_t("Customer"),modelField:"partner_id.complete_name",},};if(this.showCardholderName()){fields.CARDHOLDER_NAME={repr:(order)=>order.get_cardholder_name(),displayName:_t("Cardholder Name"),modelField:"payment_ids.cardholder_name",};}
return fields;}
_getScreenToStatusMap(){return{ProductScreen:"ONGOING",PaymentScreen:"PAYMENT",ReceiptScreen:"RECEIPT",};}
async _onBeforeDeleteOrder(order){return true;}
_getOrderStates(){const states=new Map();states.set("ACTIVE_ORDERS",{text:_t("All active orders"),});states.set("ONGOING",{text:_t("Ongoing"),indented:true,});states.set("PAYMENT",{text:_t("Payment"),indented:true,});states.set("RECEIPT",{text:_t("Receipt"),indented:true,});return states;}
_computeSyncedOrdersDomain(){let{fieldName,searchTerm}=this._state.ui.searchDetails;if(!searchTerm){return[];}
const searchField=this._getSearchFields()[fieldName];if(searchField){if(searchField.formatSearch){searchTerm=searchField.formatSearch(searchTerm);}
return[[searchField.modelField,"ilike",`%${searchTerm}%`]];}else{return[];}}
async _fetchSyncedOrders(){const domain=this._computeSyncedOrdersDomain();const limit=this._state.syncedOrders.nPerPage;const offset=(this._state.syncedOrders.currentPage-1)*this._state.syncedOrders.nPerPage;const config_id=this.pos.config.id;const{ordersInfo,totalCount}=await this.orm.call("pos.order","search_paid_order_ids",[],{config_id,domain,limit,offset});const idsNotInCache=ordersInfo.filter((orderInfo)=>!(orderInfo[0]in this._state.syncedOrders.cache));const cacheDate=this._state.syncedOrders.cacheDate||DateTime.fromMillis(0);const idsNotUpToDate=ordersInfo.filter((orderInfo)=>{return deserializeDateTime(orderInfo[1])>cacheDate;});const idsToLoad=idsNotInCache.concat(idsNotUpToDate).map((info)=>info[0]);if(idsToLoad.length>0){const fetchedOrders=await this.orm.call("pos.order","export_for_ui",[idsToLoad]);await this.pos._loadMissingProducts(fetchedOrders);await this.pos._loadMissingPartners(fetchedOrders);fetchedOrders.forEach((order)=>{this._state.syncedOrders.cache[order.id]=new Order({env:this.env},{pos:this.pos,json:order});});this._state.syncedOrders.cacheDate=DateTime.local();}
const ids=ordersInfo.map((info)=>info[0]);this._state.syncedOrders.totalCount=totalCount;this._state.syncedOrders.toShow=ids.map((id)=>this._state.syncedOrders.cache[id]);}
_getLastPage(){const totalCount=this._state.syncedOrders.totalCount;const nPerPage=this._state.syncedOrders.nPerPage;const remainder=totalCount%nPerPage;if(remainder==0){return totalCount/nPerPage;}else{return Math.ceil(totalCount/nPerPage);}}}
registry.category("pos_screens").add("TicketScreen",TicketScreen);return __exports;});;

/* /point_of_sale/static/src/app/sound/sound_service.js */
odoo.define('@point_of_sale/app/sound/sound_service',['@odoo/owl','@web/core/registry'],function(require){'use strict';let __exports={};const{Component,reactive,xml}=require("@odoo/owl");const{registry}=require("@web/core/registry");registry.category("sounds").add("error","/point_of_sale/static/src/sounds/error.wav").add("bell","/point_of_sale/static/src/sounds/bell.wav").add("notification","/point_of_sale/static/src/sounds/notification.wav");class SoundContainer extends Component{static template=xml`<t t-foreach="props.sounds" t-as="sound" t-key="sound">
        <audio autoplay="true" t-att-src="sound_value.src" t-on-ended="sound_value.cleanup" t-on-error="sound_value.cleanup"/>
    </t>`;static props={sounds:Object,};}
const soundService=__exports.soundService={start(){let soundId=0;const sounds=reactive({});registry.category("main_components").add("SoundContainer",{Component:SoundContainer,props:{sounds},});return{play(name){const id=soundId++;sounds[id]={src:registry.category("sounds").get(name),cleanup:()=>delete sounds[id],};},};},};registry.category("services").add("sound",soundService);return __exports;});;

/* /point_of_sale/static/src/app/store/cash_opening_popup/cash_opening_popup.js */
odoo.define('@point_of_sale/app/store/cash_opening_popup/cash_opening_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@web/core/utils/hooks','@point_of_sale/app/store/pos_hook','@point_of_sale/app/utils/money_details_popup/money_details_popup','@odoo/owl','@web/core/l10n/translation','@point_of_sale/app/generic_components/inputs/input/input','@web/views/fields/parsers'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{useService}=require("@web/core/utils/hooks");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{MoneyDetailsPopup}=require("@point_of_sale/app/utils/money_details_popup/money_details_popup");const{useState}=require("@odoo/owl");const{_t}=require("@web/core/l10n/translation");const{Input}=require("@point_of_sale/app/generic_components/inputs/input/input");const{parseFloat}=require("@web/views/fields/parsers");const CashOpeningPopup=__exports.CashOpeningPopup=class CashOpeningPopup extends AbstractAwaitablePopup{static template="point_of_sale.CashOpeningPopup";static components={Input};static defaultProps={cancelKey:false};setup(){super.setup();this.moneyDetails=null;this.pos=usePos();this.state=useState({notes:"",openingCash:this.env.utils.formatCurrency(this.pos.pos_session.cash_register_balance_start||0,false),});this.popup=useService("popup");this.orm=useService("orm");this.hardwareProxy=useService("hardware_proxy");}
async confirm(){this.pos.pos_session.state="opened";this.orm.call("pos.session","set_cashbox_pos",[this.pos.pos_session.id,parseFloat(this.state.openingCash),this.state.notes,]);super.confirm();}
async openDetailsPopup(){const action=_t("Cash control - opening");this.hardwareProxy.openCashbox(action);const{confirmed,payload}=await this.popup.add(MoneyDetailsPopup,{moneyDetails:this.moneyDetails,action:action,});if(confirmed){const{total,moneyDetails,moneyDetailsNotes}=payload;this.state.openingCash=this.env.utils.formatCurrency(total,false);if(moneyDetailsNotes){this.state.notes=moneyDetailsNotes;}
this.moneyDetails=moneyDetails;}}
handleInputChange(){if(!this.env.utils.isValidFloat(this.state.openingCash)){return;}
this.state.notes="";}}
return __exports;});;

/* /point_of_sale/static/src/app/store/combo_configurator_popup/combo_configurator_popup.js */
odoo.define('@point_of_sale/app/store/combo_configurator_popup/combo_configurator_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@odoo/owl','@point_of_sale/app/store/pos_hook','@point_of_sale/app/generic_components/product_card/product_card','@web/core/utils/numbers'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{useState}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{ProductCard}=require("@point_of_sale/app/generic_components/product_card/product_card");const{floatIsZero}=require("@web/core/utils/numbers");const ComboConfiguratorPopup=__exports.ComboConfiguratorPopup=class ComboConfiguratorPopup extends AbstractAwaitablePopup{static template="point_of_sale.ComboConfiguratorPopup";static components={ProductCard};setup(){super.setup();this.pos=usePos();this.state=useState({combo:Object.fromEntries(this.props.product.combo_ids.map((elem)=>[elem,0])),configuration:{},});}
areAllCombosSelected(){return Object.values(this.state.combo).every((x)=>Boolean(x));}
formattedComboPrice(comboLine){const combo_price=comboLine.combo_price;if(floatIsZero(combo_price)){return"";}else{const product=this.pos.db.product_by_id[comboLine.product_id[0]];return this.env.utils.formatCurrency(product.get_display_price({price:combo_price}));}}
getPayload(){return Object.values(this.state.combo).filter((x)=>x).map((x)=>{const combo_line=this.pos.db.combo_line_by_id[x];return{...combo_line,configuration:this.state.configuration[combo_line.id],};});}
async onClickProduct({product,combo_line},ev){if(product.isConfigurable()){const{confirmed,payload}=await product.openConfigurator({initQuantity:1});if(confirmed){this.state.configuration[combo_line.id]=payload;}else{this.state.combo[combo_line.id]=0;}}}}
return __exports;});;

/* /point_of_sale/static/src/app/store/db.js */
odoo.define('@point_of_sale/app/store/db',['@web/core/utils/strings'],function(require){'use strict';let __exports={};const{unaccent}=require("@web/core/utils/strings");const CACHE={};const PosDB=__exports.PosDB=class PosDB{name="openerp_pos_db";limit=100;constructor(options){options=options||{};this.name=options.name||this.name;this.limit=options.limit||this.limit;if(options.uuid){this.name=this.name+"_"+options.uuid;}
this.product_by_id={};this.product_by_barcode={};this.product_by_category_id={};this.product_packaging_by_barcode={};this.attribute_by_id={};this.attribute_value_by_id={};this.partner_sorted=[];this.partner_by_id={};this.partner_by_barcode={};this.partner_search_strings={};this.partner_write_date=null;this.category_by_id={};this.root_category_id=0;this.category_products={};this.category_ancestors={};this.category_childs={};this.category_parent={};this.category_search_string={};this.combo_by_id={};this.combo_line_by_id={};this.product_ids_to_not_display=[];}
add_attributes(attribute){for(const attr of Object.values(attribute)){this.attribute_by_id[attr.id]=attr;for(const val of attr.values){val.attribute_id=attr.id;this.attribute_value_by_id[val.id]=val;}}}
set_uuid(uuid){this.name=this.name+"_"+uuid;}
get_category_by_id(categ_id){if(categ_id instanceof Array){var list=[];for(var i=0,len=categ_id.length;i<len;i++){var cat=this.category_by_id[categ_id[i]];if(cat){list.push(cat);}else{console.error("get_category_by_id: no category has id:",categ_id[i]);}}
return list;}else{return this.category_by_id[categ_id];}}
get_category_childs_ids(categ_id){return this.category_childs[categ_id]||[];}
get_category_ancestors_ids(categ_id){return this.category_ancestors[categ_id]||[this.root_category_id];}
get_category_parent_id(categ_id){return this.category_parent[categ_id]||this.root_category_id;}
add_categories(categories){var self=this;if(!this.category_by_id[this.root_category_id]){this.category_by_id[this.root_category_id]={id:this.root_category_id,name:"Root",};}
categories.forEach(function(cat){self.category_by_id[cat.id]=cat;});categories.forEach(function(cat){var parent_id=cat.parent_id[0];if(!(parent_id&&self.category_by_id[parent_id])){parent_id=self.root_category_id;}
self.category_parent[cat.id]=parent_id;if(!self.category_childs[parent_id]){self.category_childs[parent_id]=[];}
if(!self.category_childs[parent_id].includes(cat.id)){self.category_childs[parent_id].push(cat.id);}});function make_ancestors(cat_id,ancestors){self.category_ancestors[cat_id]=ancestors;ancestors=ancestors.slice(0);ancestors.push(cat_id);var childs=self.category_childs[cat_id]||[];for(var i=0,len=childs.length;i<len;i++){make_ancestors(childs[i],ancestors);}}
make_ancestors(this.root_category_id,[]);}
remove_categories(categories_id){categories_id=categories_id.filter((cat_id)=>cat_id!==this.root_category_id);categories_id.forEach((cat_id)=>{if(cat_id===undefined||cat_id===null){return;}
const cat=this.category_by_id[cat_id];if(!cat){return;}
const parent_id=this.category_parent[cat.id];if(this.category_childs[parent_id]){this._remove_all_occurrences_from_array(this.category_childs[parent_id],cat.id);if(this.category_childs[parent_id].length===0){delete this.category_childs[parent_id];}}
delete this.category_parent[cat.id];delete this.category_by_id[cat_id];});const removed_categories_id=new Set(categories_id);for(const cat_id_str in this.category_ancestors){if(removed_categories_id.has(Number(cat_id_str))){delete this.category_ancestors[cat_id_str];}else{this.category_ancestors[cat_id_str]=this.category_ancestors[cat_id_str].filter((anc_id_str)=>!removed_categories_id.has(Number(anc_id_str)));}}}
add_combos(combos){combos.forEach((combo)=>{this.combo_by_id[combo.id]=combo;});}
add_combo_lines(combo_lines){combo_lines.forEach((combo_line)=>{this.combo_line_by_id[combo_line.id]=combo_line;});}
addProductIdsToNotDisplay(product_ids){this.product_ids_to_not_display=this.product_ids_to_not_display.concat(product_ids);}
load(store,deft){if(CACHE[store]!==undefined){return CACHE[store];}
var data=localStorage[this.name+"_"+store];if(data!==undefined&&data!==""){data=JSON.parse(data);CACHE[store]=data;return data;}else{return deft;}}
save(store,data){localStorage[this.name+"_"+store]=JSON.stringify(data);CACHE[store]=data;}
_product_search_string(product){var str=product.display_name;if(product.barcode){str+="|"+product.barcode;}
if(product.default_code){str+="|"+product.default_code;}
if(product.description){str+="|"+product.description;}
if(product.description_sale){str+="|"+product.description_sale;}
str=product.id+":"+str.replace(/[\n:]/g,"")+"\n";return str;}
add_products(products){var stored_categories=this.product_by_category_id;if(!(products instanceof Array)){products=[products];}
for(var i=0,len=products.length;i<len;i++){var product=products[i];if(product.id in this.product_by_id){continue;}
if(product.available_in_pos){var search_string=unaccent(this._product_search_string(product));const all_categ_ids=product.pos_categ_ids.length?product.pos_categ_ids:[this.root_category_id];product.product_tmpl_id=product.product_tmpl_id[0];for(const categ_id of all_categ_ids){if(!stored_categories[categ_id]){stored_categories[categ_id]=[];}
stored_categories[categ_id].push(product.id);if(this.category_search_string[categ_id]===undefined){this.category_search_string[categ_id]="";}
this.category_search_string[categ_id]+=search_string;var ancestors=this.get_category_ancestors_ids(categ_id)||[];for(var j=0,jlen=ancestors.length;j<jlen;j++){var ancestor=ancestors[j];if(!stored_categories[ancestor]){stored_categories[ancestor]=[];}
stored_categories[ancestor].push(product.id);if(this.category_search_string[ancestor]===undefined){this.category_search_string[ancestor]="";}
this.category_search_string[ancestor]+=search_string;}}}
this.product_by_id[product.id]=product;if(product.barcode&&product.active){this.product_by_barcode[product.barcode]=product;}}}
remove_products(products_id){if(!(products_id instanceof Array)){products_id=[products_id];}
products_id.forEach((product_id)=>{if(product_id===undefined||product_id===null){return;}
const product=this.product_by_id[product_id];if(!product){return;}
if(product.available_in_pos){const product_search_string=unaccent(this._product_search_string(product));const all_categ_ids=product.pos_categ_ids.length?product.pos_categ_ids:[this.root_category_id];for(const categ_id of all_categ_ids){this.remove_product_from_category(product.id,product_search_string,categ_id);const categ_ancestors_id=this.get_category_ancestors_ids(categ_id)||[];categ_ancestors_id.forEach((ancestor_id)=>{this.remove_product_from_category(product.id,product_search_string,ancestor_id);});}}
delete this.product_by_id[product.id];if(product.barcode){delete this.product_by_barcode[product.barcode];}});}
remove_product_from_category(product_id,product_search_string,categ_id){const stored_categories=this.product_by_category_id;if(stored_categories[categ_id]){this._remove_all_occurrences_from_array(stored_categories[categ_id],product_id);if(stored_categories[categ_id].length===0){delete stored_categories[categ_id];}}
if(this.category_search_string[categ_id]){this.category_search_string[categ_id]=this.category_search_string[categ_id].replace(product_search_string,"");}
if(!this.category_search_string[categ_id]){delete this.category_search_string[categ_id];}}
_remove_all_occurrences_from_array(array,element){for(let i=array.length-1;i>=0;i--){if(array[i]===element){array.splice(i,1);}}}
add_packagings(productPackagings){productPackagings?.forEach((productPackaging)=>{if(productPackaging.product_id[0]in this.product_by_id){this.product_packaging_by_barcode[productPackaging.barcode]=productPackaging;}});}
_partner_search_string(partner){var str=partner.name||"";str+="|"+(partner.barcode||"");str+="|"+(partner.address||"");str+="|"+(partner.phone||"").split(" ").join("");str+="|"+(partner.mobile||"").split(" ").join("");str+="|"+(partner.email||"");str+="|"+(partner.vat||"");str+="|"+(partner.parent_name||"");str=""+partner.id+":"+str.replace(":","").replace(/\n/g," ")+"\n";return str;}
add_partners(partners){var updated={};var new_write_date="";var partner;for(var i=0,len=partners.length;i<len;i++){partner=partners[i];var local_partner_date=(this.partner_write_date||"").replace(/^(\d{4}-\d{2}-\d{2}) ((\d{2}:?){3})$/,"$1T$2Z");var dist_partner_date=(partner.write_date||"").replace(/^(\d{4}-\d{2}-\d{2}) ((\d{2}:?){3})$/,"$1T$2Z");if(this.partner_write_date&&this.partner_by_id[partner.id]&&new Date(local_partner_date).getTime()+1000>=new Date(dist_partner_date).getTime()){continue;}else if(new_write_date<partner.write_date){new_write_date=partner.write_date;}
if(!this.partner_by_id[partner.id]){this.partner_sorted.push(partner.id);}else{const oldPartner=this.partner_by_id[partner.id];if(oldPartner.barcode){delete this.partner_by_barcode[oldPartner.barcode];}}
if(partner.barcode){this.partner_by_barcode[partner.barcode]=partner;}
updated[partner.id]=partner;this.partner_by_id[partner.id]=partner;}
this.partner_write_date=new_write_date||this.partner_write_date;const updatedChunks=new Set();const CHUNK_SIZE=100;for(const id in updated){const chunkId=Math.floor(id/CHUNK_SIZE);if(updatedChunks.has(chunkId)){continue;}
updatedChunks.add(chunkId);let searchString="";for(let id=chunkId*CHUNK_SIZE;id<(chunkId+1)*CHUNK_SIZE;id++){if(!(id in this.partner_by_id)){continue;}
const partner=this.partner_by_id[id];partner.address=(partner.street?partner.street+", ":"")+
(partner.zip?partner.zip+", ":"")+
(partner.city?partner.city+", ":"")+
(partner.state_id?partner.state_id[1]+", ":"")+
(partner.country_id?partner.country_id[1]:"");searchString+=this._partner_search_string(partner);}
this.partner_search_strings[chunkId]=unaccent(searchString);}
return Object.keys(updated).length;}
get_partner_write_date(){return this.partner_write_date||"1970-01-01 00:00:00";}
get_partner_by_id(id){return this.partner_by_id[id];}
get_partner_by_barcode(barcode){return this.partner_by_barcode[barcode];}
get_partners_sorted(max_count){max_count=max_count?Math.min(this.partner_sorted.length,max_count):this.partner_sorted.length;var partners=[];for(var i=0;i<max_count;i++){partners.push(this.partner_by_id[this.partner_sorted[i]]);}
return partners;}
search_partner(query){try{query=query.replace(/[\[\]\(\)\+\*\?\.\-\!\&\^\$\|\~\_\{\}\:\,\\\/]/g,".");query=query.replace(/ /g,".+");var re=RegExp("^([0-9]+):.*?"+unaccent(query),"gim");}catch{return[];}
var results=[];const searchStrings=Object.values(this.partner_search_strings).reverse();let searchString=searchStrings.pop();while(searchString&&results.length<this.limit){var r=re.exec(searchString);if(r){const barcode=r[0].split("|")[1];if(query===barcode){const partner=this.get_partner_by_barcode(barcode);if(partner){return[partner];}}
var id=Number(r[1]);results.push(this.get_partner_by_id(id));}else{searchString=searchStrings.pop();}}
return results;}
clear(){for(var i=0,len=arguments.length;i<len;i++){localStorage.removeItem(this.name+"_"+arguments[i]);}}
_count_props(obj){var count=0;for(var prop in obj){if(Object.hasOwnProperty.call(obj,prop)){count++;}}
return count;}
get_product_by_id(id){return this.product_by_id[id];}
get_product_by_barcode(barcode){if(this.product_by_barcode[barcode]){return this.product_by_barcode[barcode];}else if(this.product_packaging_by_barcode[barcode]){return this.product_by_id[this.product_packaging_by_barcode[barcode].product_id[0]];}
return undefined;}
shouldAddProduct(product,list){return(product.active&&product.available_in_pos&&!list.includes(product)&&!this.product_ids_to_not_display.includes(product.id));}
get_product_by_category(category_id){var product_ids=this.product_by_category_id[category_id];var list=[];if(product_ids){for(var i=0,len=Math.min(product_ids.length,this.limit);i<len;i++){const product=this.product_by_id[product_ids[i]];if(!this.shouldAddProduct(product,list)){continue;}
list.push(product);}}
return list;}
search_product_in_category(category_id,query){try{query=query.replace(/[\[\]\(\)\+\*\?\.\-\!\&\^\$\|\~\_\{\}\:\,\\\/]/g,".");query=query.replace(/ /g,".+");var re=RegExp("([0-9]+):.*?"+unaccent(query),"gi");}catch{return[];}
var results=[];for(var i=0;i<this.limit;i++){var r=re.exec(this.category_search_string[category_id]);if(r){var id=Number(r[1]);const product=this.get_product_by_id(id);if(!this.shouldAddProduct(product,results)){continue;}
results.push(product);}else{break;}}
return results;}
is_product_in_category(category_ids,product_id){const product_categ_ids=this.get_product_by_id(product_id).pos_categ_ids;return this.any_of_is_subcategory(product_categ_ids,category_ids);}
any_of_is_subcategory(subcategory_ids,category_ids){return subcategory_ids.some((subcategory_id)=>this.is_subcategory(subcategory_id,category_ids));}
is_subcategory(subcategory_id,category_ids){const check=(categ_id)=>categ_id&&this.is_subcategory(categ_id,category_ids);return(category_ids.includes(Number(subcategory_id))||check(this.get_category_parent_id(subcategory_id)));}
add_order(order){var order_id=order.uid;var orders=this.load("orders",[]);for(var i=0,len=orders.length;i<len;i++){if(orders[i].id===order_id){orders[i].data=order;this.save("orders",orders);return order_id;}}
this.remove_unpaid_order(order);orders.push({id:order_id,data:order});this.save("orders",orders);return order_id;}
remove_order(order_id){var orders=this.load("orders",[]);orders=orders.filter((order)=>order.id!==order_id);this.save("orders",orders);}
remove_all_orders(){this.save("orders",[]);}
get_orders(){return this.load("orders",[]);}
get_order(order_id){var orders=this.get_orders();for(var i=0,len=orders.length;i<len;i++){if(orders[i].id===order_id){return orders[i];}}
return undefined;}
save_unpaid_order(order){var order_id=order.uid;var orders=this.load("unpaid_orders",[]);var serialized=order.export_as_JSON();for(var i=0;i<orders.length;i++){if(orders[i].id===order_id){orders[i].data=serialized;this.save("unpaid_orders",orders);return order_id;}}
orders.push({id:order_id,data:serialized});this.save("unpaid_orders",orders);return order_id;}
remove_unpaid_order(order){var orders=this.load("unpaid_orders",[]);orders=orders.filter((o)=>o.id!==order.uid);this.save("unpaid_orders",orders);}
remove_all_unpaid_orders(){this.save("unpaid_orders",[]);}
get_unpaid_orders(){var saved=this.load("unpaid_orders",[]);var orders=[];for(var i=0;i<saved.length;i++){orders.push(saved[i].data);}
return orders;}
get_unpaid_orders_to_sync(ids){const savedOrders=this.load("unpaid_orders",[]);return savedOrders.filter((order)=>ids.includes(order.id)&&(order.data.server_id||order.data.lines.length||order.data.statement_ids.length||order.data.booked));}
set_order_to_remove_from_server(order){if(order.server_id===undefined){return;}
const to_remove=new Set([this.load("unpaid_orders_to_remove",[]),order.server_id].flat());this.save("unpaid_orders_to_remove",[...to_remove]);}
get_ids_to_remove_from_server(){return this.load("unpaid_orders_to_remove",[]);}
set_ids_removed_from_server(ids){var to_remove=this.load("unpaid_orders_to_remove",[]);to_remove=to_remove.filter((id)=>!ids.includes(id));this.save("unpaid_orders_to_remove",to_remove);}}
return __exports;});;

/* /point_of_sale/static/src/app/store/models.js */
odoo.define('@point_of_sale/app/store/models',['@point_of_sale/utils','@web/views/fields/parsers','@web/core/l10n/dates','@web/core/utils/numbers','@point_of_sale/app/errors/popups/error_popup','@point_of_sale/app/store/product_configurator_popup/product_configurator_popup','@point_of_sale/app/store/combo_configurator_popup/combo_configurator_popup','@point_of_sale/app/utils/confirm_popup/confirm_popup','@web/core/l10n/translation','@web/core/utils/render','@point_of_sale/app/store/models/product_custom_attribute','@web/core/utils/objects'],function(require){'use strict';let __exports={};const{constructFullProductName,random5Chars,uuidv4,qrCodeSrc}=require("@point_of_sale/utils");const{parseFloat:oParseFloat}=require("@web/views/fields/parsers");const{formatDate,formatDateTime,serializeDateTime,deserializeDate,deserializeDateTime,}=require("@web/core/l10n/dates");const{formatFloat,roundDecimals:round_di,roundPrecision:round_pr,floatIsZero,}=require("@web/core/utils/numbers");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{ProductConfiguratorPopup}=require("@point_of_sale/app/store/product_configurator_popup/product_configurator_popup");const{ComboConfiguratorPopup}=require("@point_of_sale/app/store/combo_configurator_popup/combo_configurator_popup");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{_t}=require("@web/core/l10n/translation");const{renderToElement}=require("@web/core/utils/render");const{ProductCustomAttribute}=require("@point_of_sale/app/store/models/product_custom_attribute");const{omit}=require("@web/core/utils/objects");const{DateTime}=luxon;const PosCollection=__exports.PosCollection=class PosCollection extends Array{getByCID(cid){return this.find((item)=>item.cid==cid);}
add(item){this.push(item);}
remove(item){const index=this.findIndex((_item)=>item.cid==_item.cid);if(index<0){return index;}
this.splice(index,1);return index;}
reset(){this.length=0;}
at(index){return this[index];}}
let nextId=0;class PosModel{constructor(){this.setup(...arguments);}
setup(defaultObj){defaultObj=defaultObj||{};if(!defaultObj.cid){defaultObj.cid=this._getCID(defaultObj);}
Object.assign(this,defaultObj);}
_getCID(obj){if(obj.id){if(typeof obj.id=="string"){return obj.id;}else if(typeof obj.id=="number"){return`c${obj.id}`;}}
return`c${nextId++}`;}}
const Product=__exports.Product=class Product extends PosModel{constructor(obj){super(obj);this.parent_category_ids=[];let category=this.categ.parent;while(category){this.parent_category_ids.push(category.id);category=category.parent;}}
isAllowOnlyOneLot(){const productUnit=this.get_unit();return this.tracking==="lot"||!productUnit||!productUnit.is_pos_groupable;}
getImageUrl(){return((this.image_128&&`/web/image?model=product.product&field=image_128&id=${this.id}&unique=${this.write_date}`)||"");}
isTracked(){return(["serial","lot"].includes(this.tracking)&&(this.pos.picking_type.use_create_lots||this.pos.picking_type.use_existing_lots));}
get_unit(){var unit_id=this.uom_id;if(!unit_id){return undefined;}
unit_id=unit_id[0];if(!this.pos){return undefined;}
return this.pos.units_by_id[unit_id];}
async _onScaleNotAvailable(){}
get isScaleAvailable(){return true;}
getFormattedUnitPrice(){const formattedUnitPrice=this.env.utils.formatCurrency(this.get_display_price());if(this.to_weight){return`${formattedUnitPrice}/${this.get_unit().name}`;}else{return formattedUnitPrice;}}
async openConfigurator({initQuantity=1}){const attributes=this.attribute_line_ids.map((id)=>this.pos.attributes_by_ptal_id[id]).filter((attr)=>attr!==undefined);if(attributes.some((attribute)=>attribute.values.length>1||attribute.values[0].is_custom)){return await this.env.services.popup.add(ProductConfiguratorPopup,{product:this,attributes:attributes,quantity:initQuantity,});}
return{confirmed:true,payload:{attribute_value_ids:attributes.map((attr)=>attr.values[0].id),attribute_custom_values:[],price_extra:attributes.reduce((acc,attr)=>acc+attr.values[0].price_extra,0),quantity:1,},};}
isConfigurable(){return this.attribute_line_ids.some((id)=>id in this.pos.attributes_by_ptal_id);}
async getAddProductOptions(code){let price_extra=0.0;let draftPackLotLines,packLotLinesToEdit,attribute_value_ids;let quantity=1;let comboLines=[];let attribute_custom_values={};if(code&&this.pos.db.product_packaging_by_barcode[code.code]){quantity=this.pos.db.product_packaging_by_barcode[code.code].qty;}
if(this.isConfigurable()){const{confirmed,payload}=await this.openConfigurator({initQuantity:quantity});if(confirmed){attribute_value_ids=payload.attribute_value_ids;attribute_custom_values=payload.attribute_custom_values;price_extra+=payload.price_extra;quantity=payload.quantity;}else{return;}}
if(this.combo_ids.length){const{confirmed,payload}=await this.env.services.popup.add(ComboConfiguratorPopup,{product:this});if(!confirmed){return;}
comboLines=payload;}
if(this.isTracked()){packLotLinesToEdit=(!this.isAllowOnlyOneLot()&&this.pos.selectedOrder.get_orderlines().filter((line)=>!line.get_discount()).find((line)=>line.product.id===this.id)?.getPackLotLinesToEdit())||[];if(code&&code.type==="lot"){const modifiedPackLotLines=Object.fromEntries(packLotLinesToEdit.filter((item)=>item.id).map((item)=>[item.id,item.text]));const newPackLotLines=[{lot_name:code.code}];draftPackLotLines={modifiedPackLotLines,newPackLotLines};}else{draftPackLotLines=await this.pos.getEditedPackLotLines(this.isAllowOnlyOneLot(),packLotLinesToEdit,this.display_name);}
if(!draftPackLotLines){return;}}
if(this.to_weight&&this.pos.config.iface_electronic_scale){if(this.isScaleAvailable){const product=this;const{confirmed,payload}=await this.env.services.pos.showTempScreen("ScaleScreen",{product,});if(confirmed){quantity=payload.weight;}else{return;}}else{await this._onScaleNotAvailable();}}
return{draftPackLotLines,quantity,attribute_custom_values,price_extra,comboLines,attribute_value_ids,};}
isPricelistItemUsable(item,date){const categories=this.parent_category_ids.concat(this.categ.id);return((!item.categ_id||categories.includes(item.categ_id[0]))&&(!item.date_start||deserializeDate(item.date_start)<=date)&&(!item.date_end||deserializeDate(item.date_end)>=date));}
get_price(pricelist,quantity,price_extra=0,recurring=false){const date=DateTime.now();if(recurring&&!pricelist){alert(_t("An error occurred when loading product prices. "+"Make sure all pricelists are available in the POS."));}
const rules=!pricelist?[]:(this.applicablePricelistItems[pricelist.id]||[]).filter((item)=>this.isPricelistItemUsable(item,date));let price=this.lst_price+(price_extra||0);const rule=rules.find((rule)=>!rule.min_quantity||quantity>=rule.min_quantity);if(!rule){return price;}
if(rule.base==="pricelist"){const base_pricelist=this.pos.pricelists.find((pricelist)=>pricelist.id===rule.base_pricelist_id[0]);if(base_pricelist){price=this.get_price(base_pricelist,quantity,0,true);}}else if(rule.base==="standard_price"){price=this.standard_price;}
if(rule.compute_price==="fixed"){price=rule.fixed_price;}else if(rule.compute_price==="percentage"){price=price-price*(rule.percent_price/100);}else{var price_limit=price;price-=price*(rule.price_discount/100);if(rule.price_round){price=round_pr(price,rule.price_round);}
if(rule.price_surcharge){price+=rule.price_surcharge;}
if(rule.price_min_margin){price=Math.max(price,price_limit+rule.price_min_margin);}
if(rule.price_max_margin){price=Math.min(price,price_limit+rule.price_max_margin);}}
return price;}
get_display_price({pricelist=this.pos.getDefaultPricelist(),quantity=1,price=this.get_price(pricelist,quantity),iface_tax_included=this.pos.config.iface_tax_included,}={}){const order=this.pos.get_order();const taxes=this.pos.get_taxes_after_fp(this.taxes_id,order&&order.fiscal_position);const currentTaxes=this.pos.getTaxesByIds(this.taxes_id);const priceAfterFp=this.pos.computePriceAfterFp(price,currentTaxes);const allPrices=this.pos.compute_all(taxes,priceAfterFp,1,this.pos.currency.rounding);if(iface_tax_included==="total"){return allPrices.total_included;}else{return allPrices.total_excluded;}}}
var orderline_id=1;const Orderline=__exports.Orderline=class Orderline extends PosModel{setup(_defaultObj,options){super.setup(...arguments);this.pos=options.pos;this.order=options.order;this.price_type=options.price_type;this.uuid=this.uuid||uuidv4();this.price_type=options.price_type||"original";if(options.json){try{this.init_from_JSON(options.json);}catch(error){console.error("ERROR: attempting to recover product ID",options.json.product_id[0],"not available in the point of sale. Correct the product or clean the browser cache.");throw error;}
return;}
this.product=options.product;this.tax_ids=options.tax_ids;this.set_product_lot(this.product);options.quantity?this.set_quantity(options.quantity):this.set_quantity(1);this.discount=0;this.note="";this.custom_attribute_value_ids=[];this.hasChange=false;this.skipChange=false;this.discountStr="0";this.selected=false;this.price_extra=0;this.full_product_name="";this.id=orderline_id++;this.customerNote=this.customerNote||"";this.saved_quantity=0;if(options.price){this.set_unit_price(options.price);}else{this.set_unit_price(this.product.get_price(this.order.pricelist,this.get_quantity()));}}
init_from_JSON(json){this.product=this.pos.db.get_product_by_id(json.product_id);this.set_product_lot(this.product);this.price=json.price_unit;this.price_type=json.price_type||"original";this.set_discount(json.discount);this.set_quantity(json.qty,"do not recompute unit price");this.attribute_value_ids=json.attribute_value_ids||[];this.set_price_extra(json.price_extra);this.custom_attribute_value_ids=json.custom_attribute_value_ids.map((attr)=>{if(attr.length>0){attr=attr[2];}
return new ProductCustomAttribute(attr);});this.set_full_product_name();this.id=json.server_id||json.id||orderline_id++;orderline_id=Math.max(this.id+1,orderline_id);if(this.has_product_lot){var pack_lot_lines=json.pack_lot_ids;for(var i=0;i<pack_lot_lines.length;i++){var packlotline=pack_lot_lines[i][2];var pack_lot_line=new Packlotline({env:this.env},{json:{...packlotline,order_line:this}});this.pack_lot_lines.add(pack_lot_line);}}
this.tax_ids=json.tax_ids&&json.tax_ids.length!==0?json.tax_ids[0][2]:undefined;this.set_customer_note(json.customer_note);this.refunded_qty=json.refunded_qty;this.refunded_orderline_id=json.refunded_orderline_id;this.saved_quantity=json.qty;this.uuid=json.uuid;this.skipChange=json.skip_change;this.combo_line_ids=json.combo_line_ids;this.combo_parent_id=json.combo_parent_id;this.comboLine=this.pos.db.combo_line_by_id[json.combo_line_id];}
clone(){var orderline=new Orderline({env:this.env},{pos:this.pos,order:this.order,product:this.product,price:this.price,});orderline.order=null;orderline.custom_attribute_value_ids=this.custom_attribute_value_ids;orderline.quantity=this.quantity;orderline.quantityStr=this.quantityStr;orderline.discount=this.discount;orderline.price=this.price;orderline.selected=false;orderline.price_type=this.price_type;orderline.customerNote=this.customerNote;return orderline;}
getDisplayClasses(){return{};}
getPackLotLinesToEdit(isAllowOnlyOneLot){const currentPackLotLines=this.pack_lot_lines;let nExtraLines=Math.abs(this.quantity)-currentPackLotLines.length;nExtraLines=Math.ceil(nExtraLines);nExtraLines=nExtraLines>0?nExtraLines:1;const tempLines=currentPackLotLines.map((lotLine)=>({id:lotLine.cid,text:lotLine.lot_name,})).concat(Array.from(Array(nExtraLines)).map((_)=>({text:"",})));return isAllowOnlyOneLot?[tempLines[0]]:tempLines;}
async editPackLotLines(){const isAllowOnlyOneLot=this.product.isAllowOnlyOneLot();const editedPackLotLines=await this.pos.getEditedPackLotLines(isAllowOnlyOneLot,this.getPackLotLinesToEdit(isAllowOnlyOneLot),this.product.display_name);if(!editedPackLotLines){return;}
this.setPackLotLines(editedPackLotLines);this.order.select_orderline(this);}
setPackLotLines({modifiedPackLotLines,newPackLotLines,setQuantity=true}){const lotLinesToRemove=[];for(const lotLine of this.pack_lot_lines){const modifiedLotName=modifiedPackLotLines[lotLine.cid];if(modifiedLotName){lotLine.lot_name=modifiedLotName;}else{lotLinesToRemove.push(lotLine);}}
for(const lotLine of lotLinesToRemove){this.pack_lot_lines.remove(lotLine);}
let newPackLotLine;for(const newLotLine of newPackLotLines){newPackLotLine=new Packlotline({env:this.env},{order_line:this});newPackLotLine.lot_name=newLotLine.lot_name;this.pack_lot_lines.add(newPackLotLine);}
if(!this.product.to_weight&&setQuantity){this.set_quantity_by_lot();}}
set_product_lot(product){this.has_product_lot=product.tracking!=="none";this.pack_lot_lines=this.has_product_lot&&new PosCollection();}
getNote(){return this.note;}
setNote(note){this.note=note;}
setHasChange(isChange){this.hasChange=isChange;}
set_discount(discount){var parsed_discount=typeof discount==="number"?discount:isNaN(parseFloat(discount))?0:oParseFloat(""+discount);var disc=Math.min(Math.max(parsed_discount||0,0),100);this.discount=disc;this.discountStr=""+disc;}
get_discount(){return this.discount;}
get_discount_str(){return this.discountStr;}
set_price_extra(price_extra){this.price_extra=parseFloat(price_extra)||0.0;}
set_full_product_name(){this.full_product_name=this.get_full_product_name_with_variant();}
get_price_extra(){return this.price_extra;}
updateSavedQuantity(){this.saved_quantity=this.quantity;}
set_quantity(quantity,keep_price){this.order.assert_editable();var quant=typeof quantity==="number"?quantity:oParseFloat(""+(quantity?quantity:0));if(this.refunded_orderline_id in this.pos.toRefundLines){const toRefundDetail=this.pos.toRefundLines[this.refunded_orderline_id];const maxQtyToRefund=toRefundDetail.orderline.qty-toRefundDetail.orderline.refundedQty;if(quant>0){if(!this.comboParent){this.env.services.popup.add(ErrorPopup,{title:_t("Positive quantity not allowed"),body:_t("Only a negative quantity is allowed for this refund line. Click on +/- to modify the quantity to be refunded."),});}
return false;}else if(quant==0){toRefundDetail.qty=0;}else if(-quant<=maxQtyToRefund){toRefundDetail.qty=-quant;}else{if(!this.comboParent){this.env.services.popup.add(ErrorPopup,{title:_t("Greater than allowed"),body:_t("The requested quantity to be refunded is higher than the refundable quantity of %s.",this.env.utils.formatProductQty(maxQtyToRefund)),});}
return false;}}
var unit=this.get_unit();if(unit){if(unit.rounding){var decimals=this.pos.dp["Product Unit of Measure"];var rounding=Math.max(unit.rounding,Math.pow(10,-decimals));this.quantity=round_pr(quant,rounding);this.quantityStr=formatFloat(this.quantity,{digits:[69,decimals],});}else{this.quantity=round_pr(quant,1);this.quantityStr=this.quantity.toFixed(0);}}else{this.quantity=quant;this.quantityStr=""+this.quantity;}
if(!keep_price&&this.price_type==="original"){this.set_unit_price(this.product.get_price(this.order.pricelist,this.get_quantity(),this.get_price_extra()));this.order.fix_tax_included_price(this);}
return true;}
get_quantity(){return this.quantity;}
get_quantity_str(){return this.quantityStr;}
get_quantity_str_with_unit(){if(this.is_pos_groupable()){return this.quantityStr+" "+this.get_unit().name;}else{return this.quantityStr;}}
get_lot_lines(){return this.pack_lot_lines&&this.pack_lot_lines;}
get_required_number_of_lots(){var lots_required=1;if(this.product.tracking=="serial"){lots_required=Math.abs(this.quantity);}
return lots_required;}
get_valid_lots(){return this.pack_lot_lines.filter((item)=>{return item.lot_name;});}
set_quantity_by_lot(){var valid_lots_quantity=this.get_valid_lots().length;if(this.quantity<0){valid_lots_quantity=-valid_lots_quantity;}
this.set_quantity(valid_lots_quantity);}
has_valid_product_lot(){if(!this.has_product_lot){return true;}
var valid_product_lot=this.get_valid_lots();return this.get_required_number_of_lots()===valid_product_lot.length;}
get_unit(){return this.product.get_unit();}
get_product(){return this.product;}
get_full_product_name(){return this.full_product_name||this.product.display_name;}
get_full_product_name_with_variant(){return constructFullProductName(this,this.pos.db.attribute_value_by_id,this.product.display_name);}
set_selected(selected){this.selected=selected;}
is_selected(){return this.selected;}
can_be_merged_with(orderline){var price=parseFloat(round_di(this.price||0,this.pos.dp["Product Price"]).toFixed(this.pos.dp["Product Price"]));var order_line_price=orderline.get_product().get_price(orderline.order.pricelist,this.get_quantity());order_line_price=round_di(orderline.compute_fixed_price(order_line_price),this.pos.currency.decimal_places);let hasSameAttributes=Object.keys(Object(orderline.attribute_value_ids)).length===Object.keys(Object(this.attribute_value_ids)).length;if(hasSameAttributes&&Object(orderline.attribute_value_ids)?.length&&Object(this.attribute_value_ids)?.length){hasSameAttributes=orderline.attribute_value_ids.every((value,index)=>value===this.attribute_value_ids[index]);}
return(!this.skipChange&&orderline.getNote()===this.getNote()&&this.get_product().id===orderline.get_product().id&&this.get_unit()&&this.is_pos_groupable()&&this.get_discount()===0&&floatIsZero(price-order_line_price-orderline.get_price_extra(),this.pos.currency.decimal_places)&&!(this.product.tracking==="lot"&&(this.pos.picking_type.use_create_lots||this.pos.picking_type.use_existing_lots))&&this.full_product_name===orderline.full_product_name&&orderline.get_customer_note()===this.get_customer_note()&&!this.refunded_orderline_id&&!this.isPartOfCombo()&&!orderline.isPartOfCombo()&&hasSameAttributes);}
is_pos_groupable(){return this.get_unit()?.is_pos_groupable&&!this.isPartOfCombo();}
merge(orderline){this.order.assert_editable();this.set_quantity(this.get_quantity()+orderline.get_quantity());}
export_as_JSON(){var pack_lot_ids=[];if(this.has_product_lot){this.pack_lot_lines.forEach((item)=>{return pack_lot_ids.push([0,0,item.export_as_JSON()]);});}
return{uuid:this.uuid,skip_change:this.skipChange,custom_attribute_value_ids:this.custom_attribute_value_ids.map((attr)=>[0,0,attr]),qty:this.get_quantity(),price_unit:this.get_unit_price(),price_subtotal:this.get_price_without_tax(),price_subtotal_incl:this.get_price_with_tax(),discount:this.get_discount(),product_id:this.get_product().id,tax_ids:[[6,false,this.get_applicable_taxes().map((tax)=>tax.id)]],id:this.id,pack_lot_ids:pack_lot_ids,attribute_value_ids:this.attribute_value_ids||[],full_product_name:this.get_full_product_name(),price_extra:this.get_price_extra(),customer_note:this.get_customer_note(),refunded_orderline_id:this.refunded_orderline_id,price_type:this.price_type,combo_line_ids:this.comboLines?.map((line)=>line.id||line.cid),combo_parent_id:this.comboParent?.id||this.comboParent?.cid,combo_line_id:this.comboLine?.id,};}
set_unit_price(price){this.order.assert_editable();var parsed_price=!isNaN(price)?price:isNaN(parseFloat(price))?0:oParseFloat(""+price);this.price=round_di(parsed_price||0,this.pos.dp["Product Price"]);}
get_unit_price(){var digits=this.pos.dp["Product Price"];return parseFloat(round_di(this.price||0,digits).toFixed(digits));}
get_unit_display_price(){if(this.pos.config.iface_tax_included==="total"){return this.get_all_prices(1).priceWithTax;}else{return this.get_all_prices(1).priceWithoutTax;}}
get_old_unit_display_price(){return(this.display_discount_policy()==="without_discount"&&this.env.utils.roundCurrency(this.get_unit_display_price())<this.env.utils.roundCurrency(this.get_taxed_lst_unit_price())&&this.get_taxed_lst_unit_price());}
getUnitDisplayPriceBeforeDiscount(){if(this.pos.config.iface_tax_included==="total"){return this.get_all_prices(1).priceWithTaxBeforeDiscount;}else{return this.get_all_prices(1).priceWithoutTaxBeforeDiscount;}}
get_base_price(){var rounding=this.pos.currency.rounding;return round_pr(this.get_unit_price()*this.get_quantity()*(1-this.get_discount()/100),rounding);}
get_display_price_one(){var rounding=this.pos.currency.rounding;var price_unit=this.get_unit_price();if(this.pos.config.iface_tax_included!=="total"){return round_pr(price_unit*(1.0-this.get_discount()/100.0),rounding);}else{var product=this.get_product();var taxes_ids=this.tax_ids||product.taxes_id;var product_taxes=this.pos.get_taxes_after_fp(taxes_ids,this.order.fiscal_position);var all_taxes=this.compute_all(product_taxes,price_unit,1,this.pos.currency.rounding);return round_pr(all_taxes.total_included*(1-this.get_discount()/100),rounding);}}
get_display_price(){if(this.pos.config.iface_tax_included==="total"){return this.get_price_with_tax();}else{return this.get_price_without_tax();}}
get_taxed_lst_unit_price(){const lstPrice=this.compute_fixed_price(this.get_lst_price());const product=this.get_product();const taxesIds=product.taxes_id;const productTaxes=this.pos.get_taxes_after_fp(taxesIds,this.order.fiscal_position);const unitPrices=this.compute_all(productTaxes,lstPrice,1,this.pos.currency.rounding);if(this.pos.config.iface_tax_included==="total"){return unitPrices.total_included;}else{return unitPrices.total_excluded;}}
get_price_without_tax(){return this.get_all_prices().priceWithoutTax;}
get_price_with_tax(){return this.get_all_prices().priceWithTax;}
get_price_with_tax_before_discount(){return this.get_all_prices().priceWithTaxBeforeDiscount;}
get_tax(){return this.get_all_prices().tax;}
get_applicable_taxes(){var i;var ptaxes_ids=this.tax_ids||this.get_product().taxes_id;var ptaxes_set={};for(i=0;i<ptaxes_ids.length;i++){ptaxes_set[ptaxes_ids[i]]=true;}
var taxes=[];for(i=0;i<this.pos.taxes.length;i++){if(ptaxes_set[this.pos.taxes[i].id]){taxes.push(this.pos.taxes[i]);}}
return taxes;}
get_tax_details(){return this.get_all_prices().taxDetails;}
get_taxes(){var taxes_ids=this.tax_ids||this.get_product().taxes_id;return this.pos.getTaxesByIds(taxes_ids);}
get_total_taxes_included_in_price(){const productTaxes=this._getProductTaxesAfterFiscalPosition();const taxDetails=this.get_tax_details();return productTaxes.filter((tax)=>tax.price_include).reduce((sum,tax)=>sum+taxDetails[tax.id].amount,0);}
_map_tax_fiscal_position(tax,order=false){return this.pos._map_tax_fiscal_position(tax,order);}
_compute_all(tax,base_amount,quantity,price_exclude){return this.pos._compute_all(tax,base_amount,quantity,price_exclude);}
compute_all(taxes,price_unit,quantity,currency_rounding,handle_price_include=true){return this.pos.compute_all(taxes,price_unit,quantity,currency_rounding,handle_price_include);}
_getProductTaxesAfterFiscalPosition(){const product=this.get_product();let taxesIds=this.tax_ids||product.taxes_id;taxesIds=taxesIds.filter((t)=>t in this.pos.taxes_by_id);return this.pos.get_taxes_after_fp(taxesIds,this.order.fiscal_position);}
get_all_prices(qty=this.get_quantity()){var price_unit=this.get_unit_price()*(1.0-this.get_discount()/100.0);var taxtotal=0;var product=this.get_product();var taxes_ids=this.tax_ids||product.taxes_id;taxes_ids=taxes_ids.filter((t)=>t in this.pos.taxes_by_id);var taxdetail={};var product_taxes=this.pos.get_taxes_after_fp(taxes_ids,this.order.fiscal_position);var all_taxes=this.compute_all(product_taxes,price_unit,qty,this.pos.currency.rounding);var all_taxes_before_discount=this.compute_all(product_taxes,this.get_unit_price(),qty,this.pos.currency.rounding);all_taxes.taxes.forEach(function(tax){taxtotal+=tax.amount;taxdetail[tax.id]={amount:tax.amount,base:tax.base,};});return{priceWithTax:all_taxes.total_included,priceWithoutTax:all_taxes.total_excluded,priceWithTaxBeforeDiscount:all_taxes_before_discount.total_included,priceWithoutTaxBeforeDiscount:all_taxes_before_discount.total_excluded,tax:taxtotal,taxDetails:taxdetail,};}
display_discount_policy(){return this.order.pricelist?this.order.pricelist.discount_policy:"with_discount";}
compute_fixed_price(price){return this.pos.computePriceAfterFp(price,this.get_taxes());}
get_fixed_lst_price(){return this.compute_fixed_price(this.get_lst_price());}
get_lst_price(){return this.product.get_price(this.pos.default_pricelist,1,this.price_extra);}
set_lst_price(price){this.order.assert_editable();this.product.lst_price=round_di(parseFloat(price)||0,this.pos.dp["Product Price"]);}
is_last_line(){var order=this.pos.get_order();var orderlines=order.orderlines;var last_id=orderlines[orderlines.length-1].cid;var selectedLine=order?order.selected_orderline:null;return!selectedLine?false:last_id===selectedLine.cid;}
set_customer_note(note){this.customerNote=note||"";}
get_customer_note(){return this.customerNote;}
get_total_cost(){return this.product.standard_price*this.quantity;}
isTipLine(){const tipProduct=this.pos.config.tip_product_id;return tipProduct&&this.product.id===tipProduct[0];}
getAllLinesInCombo(){if(this.comboParent){return this.comboParent.getAllLinesInCombo();}
const lines=[];const stack=[this];while(stack.length){const n=stack.pop();lines.push(n);if(n.comboLines){stack.push(...n.comboLines);}}
return lines;}
isPartOfCombo(){return Boolean(this.comboParent||this.comboLines?.length);}
findAttribute(values,customAttributes){const listOfAttributes=[];const addedPtal_id=[];for(const value of values){for(const ptal_id of this.pos.ptal_ids_by_ptav_id[value]){if(addedPtal_id.includes(ptal_id)){continue;}
const attribute=this.pos.attributes_by_ptal_id[ptal_id];const attFound=attribute.values.filter((target)=>{return Object.values(values).includes(target.id);}).map((att)=>({...att}));attFound.forEach((att)=>{if(att.is_custom){customAttributes.forEach((customAttribute)=>{if(att.id===customAttribute.custom_product_template_attribute_value_id){att.name=customAttribute.value;}});}});const modifiedAttribute={...attribute,valuesForOrderLine:attFound,};listOfAttributes.push(modifiedAttribute);addedPtal_id.push(ptal_id);}}
return listOfAttributes;}
getPriceString(){return this.get_discount_str()==="100"?_t("Free"):(this.comboLines&&this.comboLines.length>0)?"":this.env.utils.formatCurrency(this.get_display_price(),this.currency);}
getDisplayData(){return{productName:this.get_full_product_name(),price:this.getPriceString(),qty:this.get_quantity_str(),unit:this.get_unit().name,unitPrice:this.env.utils.formatCurrency(this.get_unit_display_price()),oldUnitPrice:this.env.utils.formatCurrency(this.get_old_unit_display_price()),discount:this.get_discount_str(),customerNote:this.get_customer_note(),internalNote:this.getNote(),comboParent:this.comboParent?.get_full_product_name(),pack_lot_lines:this.get_lot_lines(),price_without_discount:this.env.utils.formatCurrency(this.getUnitDisplayPriceBeforeDiscount()),attributes:this.attribute_value_ids?this.findAttribute(this.attribute_value_ids,this.custom_attribute_value_ids):[],};}}
const Packlotline=__exports.Packlotline=class Packlotline extends PosModel{setup(_defaultObj,options){super.setup(...arguments);this.lot_name=null;this.order_line=options.order_line;if(options.json){this.init_from_JSON(options.json);return;}}
init_from_JSON(json){this.order_line=json.order_line;this.set_lot_name(json.lot_name);}
set_lot_name(name){this.lot_name=String(name||"").trim()||null;}
get_lot_name(){return this.lot_name;}
export_as_JSON(){return{lot_name:this.get_lot_name(),};}}
const Payment=__exports.Payment=class Payment extends PosModel{setup(obj,options){super.setup(...arguments);this.pos=options.pos;this.order=options.order;this.amount=0;this.selected=false;this.cashier_receipt="";this.ticket="";this.payment_status="";this.card_type="";this.cardholder_name="";this.transaction_id="";if(options.json){this.init_from_JSON(options.json);return;}
this.payment_method=options.payment_method;if(this.payment_method===undefined){throw new Error(_t("Please configure a payment method in your POS."));}
this.name=this.payment_method.name;}
init_from_JSON(json){this.amount=json.amount;this.payment_method=this.pos.payment_methods_by_id[json.payment_method_id];this.can_be_reversed=json.can_be_reversed;this.name=this.payment_method.name;this.payment_status=json.payment_status;this.ticket=json.ticket;this.card_type=json.card_type;this.cardholder_name=json.cardholder_name;this.transaction_id=json.transaction_id;this.is_change=json.is_change;}
set_amount(value){this.order.assert_editable();this.amount=round_di(parseFloat(value)||0,this.pos.currency.decimal_places);}
get_amount(){return this.amount;}
get_amount_str(){return formatFloat(this.amount,{digits:[69,this.pos.currency.decimal_places],});}
set_selected(selected){if(this.selected!==selected){this.selected=selected;}}
get_payment_status(){return this.payment_status;}
set_payment_status(value){this.payment_status=value;}
is_done(){return this.get_payment_status()?this.get_payment_status()==="done"||this.get_payment_status()==="reversed":true;}
set_cashier_receipt(value){this.cashier_receipt=value;}
set_receipt_info(value){this.ticket+=value;}
export_as_JSON(){return{name:serializeDateTime(DateTime.local()),payment_method_id:this.payment_method.id,amount:this.get_amount(),payment_status:this.payment_status,can_be_reversed:this.can_be_reversed,ticket:this.ticket,card_type:this.card_type,cardholder_name:this.cardholder_name,transaction_id:this.transaction_id,};}
export_for_printing(){return{amount:this.get_amount(),name:this.name,ticket:this.ticket,};}
is_electronic(){return Boolean(this.get_payment_status());}
async pay(){this.set_payment_status("waiting");return this.handle_payment_response(await this.payment_method.payment_terminal.send_payment_request(this.cid));}
handle_payment_response(isPaymentSuccessful){if(isPaymentSuccessful){this.set_payment_status("done");this.can_be_reversed=this.payment_method.payment_terminal.supports_reversals;}else{this.set_payment_status("retry");}
return isPaymentSuccessful;}}
const Order=__exports.Order=class Order extends PosModel{setup(_defaultObj,options){super.setup(...arguments);var self=this;options=options||{};this.locked=false;this.pos=options.pos;this.selected_orderline=undefined;this.selected_paymentline=undefined;this.screen_data={};this.temporary=options.temporary||false;this.date_order=luxon.DateTime.now();this.to_invoice=false;this.orderlines=new PosCollection();this.paymentlines=new PosCollection();this.pos_session_id=this.pos.pos_session.id;this.cashier=this.pos.get_cashier();this.finalized=false;this.shippingDate=null;this.firstDraft=true;this.combos=[];this.partner=null;this.uiState={ReceiptScreen:{inputEmail:"",emailSuccessful:null,emailNotice:"",},TipScreen:{inputTipAmount:"",},};if(options.json){this.init_from_JSON(options.json);const linesById=Object.fromEntries(this.orderlines.map((l)=>[l.id||l.cid,l]));for(const line of this.orderlines){line.comboLines=line.combo_line_ids?.map((id)=>linesById[id]);const combo_parent_id=line.combo_parent_id?.[0]||line.combo_parent_id;if(combo_parent_id){line.comboParent=linesById[combo_parent_id];}}}else{this.set_pricelist(this.pos.default_pricelist);this.sequence_number=this.pos.pos_session.sequence_number++;this.access_token=uuidv4();this.ticketCode=this._generateTicketCode();this.uid=this.generate_unique_id();this.name=_t("Order %s",this.uid);this.fiscal_position=this.pos.fiscal_positions.find(function(fp){return fp.id===self.pos.config.default_fiscal_position_id[0];});}
this.lastOrderPrepaChange=this.lastOrderPrepaChange||{};this.trackingNumber=((this.pos_session_id%10)*100+
(this.sequence_number%100)).toString();}
getEmailItems(){return[_t("the receipt")].concat(this.is_to_invoice()?[_t("the invoice")]:[]);}
save_to_db(){if(!this.temporary&&!this.locked&&!this.finalized){this.assert_editable();this.pos.db.save_unpaid_order(this);}}
init_from_JSON(json){let partner;if(json.state&&["done","invoiced","paid"].includes(json.state)){this.sequence_number=json.sequence_number;this.pos_session_id=json.pos_session_id;}else if(json.pos_session_id!==this.pos.pos_session.id){this.sequence_number=this.pos.pos_session.sequence_number++;}else{this.sequence_number=json.sequence_number;this.pos.pos_session.sequence_number=Math.max(this.sequence_number+1,this.pos.pos_session.sequence_number);}
this.session_id=this.pos.pos_session.id;this.uid=json.uid;if(json.name){this.name=json.name;}else{this.name=_t("Order %s",this.uid);}
this.date_order=deserializeDateTime(json.date_order);this.server_id=json.server_id||json.id||false;this.user_id=json.user_id;this.firstDraft=false;if(json.fiscal_position_id){var fiscal_position=this.pos.fiscal_positions.find(function(fp){return fp.id===json.fiscal_position_id;});if(fiscal_position){this.fiscal_position=fiscal_position;}else{this.fiscal_position_not_found=true;console.error("ERROR: trying to load a fiscal position not available in the pos");}}
if(json.pricelist_id){this.pricelist=this.pos.pricelists.find(function(pricelist){return pricelist.id===json.pricelist_id;});}else{this.pricelist=this.pos.default_pricelist;}
if(json.partner_id){partner=this.pos.db.get_partner_by_id(json.partner_id);if(!partner){console.error("ERROR: trying to load a partner not available in the pos");}}else{partner=null;}
this.partner=partner;this.temporary=false;this.to_invoice=json.to_invoice||false;this.shippingDate=json.shipping_date;var orderlines=json.lines;for(var i=0;i<orderlines.length;i++){var orderline=orderlines[i][2];if(orderline.product_id&&this.pos.db.get_product_by_id(orderline.product_id)){this.add_orderline(new Orderline({env:this.env},{pos:this.pos,order:this,json:orderline}));}}
var paymentlines=json.statement_ids;for(i=0;i<paymentlines.length;i++){var paymentline=paymentlines[i][2];var newpaymentline=new Payment({env:this.env},{pos:this.pos,order:this,json:paymentline});this.paymentlines.add(newpaymentline);if(i===paymentlines.length-1){this.select_paymentline(newpaymentline);}}
this.locked=["paid","done","invoiced"].includes(json.state);this.state=json.state;this.amount_return=json.amount_return;this.account_move=json.account_move;this.backendId=json.id;this.is_tipped=json.is_tipped||false;this.tip_amount=json.tip_amount||0;this.access_token=json.access_token||"";this.ticketCode=json.ticket_code||"";this.lastOrderPrepaChange=json.last_order_preparation_change&&JSON.parse(json.last_order_preparation_change);}
export_as_JSON(){var orderLines,paymentLines;orderLines=[];this.orderlines.forEach((item)=>{return orderLines.push([0,0,item.export_as_JSON()]);});paymentLines=[];this.paymentlines.forEach((item)=>{const itemAsJson=item.export_as_JSON();if(itemAsJson){return paymentLines.push([0,0,itemAsJson]);}});var json={name:this.get_name(),amount_paid:this.get_total_paid()-this.get_change(),amount_total:this.get_total_with_tax(),amount_tax:this.get_total_tax(),amount_return:this.get_change(),lines:orderLines,statement_ids:paymentLines,pos_session_id:this.pos_session_id,pricelist_id:this.pricelist?this.pricelist.id:false,partner_id:this.get_partner()?this.get_partner().id:false,user_id:this.pos.user.id,uid:this.uid,sequence_number:this.sequence_number,date_order:serializeDateTime(this.date_order),fiscal_position_id:this.fiscal_position?this.fiscal_position.id:false,server_id:this.server_id?this.server_id:false,to_invoice:this.to_invoice?this.to_invoice:false,shipping_date:this.shippingDate?this.shippingDate:false,is_tipped:this.is_tipped||false,tip_amount:this.tip_amount||0,access_token:this.access_token||"",last_order_preparation_change:JSON.stringify(this.lastOrderPrepaChange),ticket_code:this.ticketCode||"",};if(!this.is_paid&&this.user_id){json.user_id=this.user_id;}
return json;}
export_for_printing(){const paymentlines=this.paymentlines.filter((p)=>!p.is_change).map((p)=>p.export_for_printing());return{orderlines:this.orderlines.map((l)=>omit(l.getDisplayData(),"internalNote")),paymentlines,amount_total:this.get_total_with_tax(),total_without_tax:this.get_total_without_tax(),amount_tax:this.get_total_tax(),total_paid:this.get_total_paid(),total_discount:this.get_total_discount(),rounding_applied:this.get_rounding_applied(),tax_details:this.get_tax_details(),change:this.locked?this.amount_return:this.get_change(),name:this.get_name(),invoice_id:null,cashier:this.cashier?.name,date:formatDateTime(this.date_order),pos_qr_code:this.pos.company.point_of_sale_use_ticket_qr_code&&(this.finalized||["paid","done","invoiced"].includes(this.state))&&qrCodeSrc(`${this.pos.base_url}/pos/ticket/validate?access_token=${this.access_token}`),ticket_code:this.pos.company.point_of_sale_ticket_unique_code&&this.finalized&&this.ticketCode,base_url:this.pos.base_url,footer:this.pos.config.receipt_footer,shippingDate:this.shippingDate&&formatDate(DateTime.fromJSDate(new Date(this.shippingDate))),headerData:{...this.pos.getReceiptHeaderData(this),trackingNumber:this.trackingNumber,},};}
async printChanges(cancelled){const orderChange=this.changesToOrder(cancelled);let isPrintSuccessful=true;const d=new Date();let hours=""+d.getHours();hours=hours.length<2?"0"+hours:hours;let minutes=""+d.getMinutes();minutes=minutes.length<2?"0"+minutes:minutes;for(const printer of this.pos.unwatched.printers){const changes=this._getPrintingCategoriesChanges(printer.config.product_categories_ids,orderChange);if(changes["new"].length>0||changes["cancelled"].length>0){const printingChanges={new:changes["new"],cancelled:changes["cancelled"],table_name:this.pos.config.module_pos_restaurant?this.getTable().name:false,floor_name:this.pos.config.module_pos_restaurant?this.getTable().floor.name:false,name:this.name||"unknown order",time:{hours,minutes,},};const receipt=renderToElement("point_of_sale.OrderChangeReceipt",{changes:printingChanges,});const result=await printer.printReceipt(receipt);if(!result.successful){isPrintSuccessful=false;}}}
return isPrintSuccessful;}
_getPrintingCategoriesChanges(categories,currentOrderChange){return{new:currentOrderChange["new"].filter((change)=>this.pos.db.is_product_in_category(categories,change["product_id"])),cancelled:currentOrderChange["cancelled"].filter((change)=>this.pos.db.is_product_in_category(categories,change["product_id"])),};}
updateLastOrderChange(){const orderlineIdx=[];this.orderlines.forEach((line)=>{if(!line.skipChange){const note=line.getNote();const lineKey=`${line.uuid} - ${note}`;orderlineIdx.push(lineKey);if(this.lastOrderPrepaChange[lineKey]){this.lastOrderPrepaChange[lineKey]["quantity"]=line.get_quantity();}else{this.lastOrderPrepaChange[lineKey]={attribute_value_ids:line.attribute_value_ids,line_uuid:line.uuid,product_id:line.get_product().id,name:line.get_full_product_name_with_variant(),note:note,quantity:line.get_quantity(),};}
line.setHasChange(false);line.saved_quantity=line.get_quantity();}});for(const lineKey in this.lastOrderPrepaChange){if(!this.getOrderedLine(lineKey)){delete this.lastOrderPrepaChange[lineKey];}}}
getOrderChanges(skipped=false){const prepaCategoryIds=this.pos.orderPreparationCategories;const oldChanges=this.lastOrderPrepaChange;const changes={};let changesCount=0;let changeAbsCount=0;for(const orderlineIdx in this.orderlines){const orderline=this.orderlines[orderlineIdx];const product=orderline.get_product();const note=orderline.getNote();const lineKey=`${orderline.uuid} - ${note}`;if(prepaCategoryIds.size===0||this.pos.db.any_of_is_subcategory(product.pos_categ_ids,[...prepaCategoryIds])){const quantity=orderline.get_quantity();const quantityDiff=oldChanges[lineKey]?quantity-oldChanges[lineKey].quantity:quantity;if(quantityDiff&&orderline.skipChange===skipped){changes[lineKey]={name:orderline.get_full_product_name_with_variant(),product_id:product.id,attribute_value_ids:orderline.attribute_value_ids,quantity:quantityDiff,note:note,};changesCount+=quantityDiff;changeAbsCount+=Math.abs(quantityDiff);if(!orderline.skipChange){orderline.setHasChange(true);}}else{orderline.setHasChange(false);}}else{orderline.setHasChange(false);}}
for(const[lineKey,lineResume]of Object.entries(this.lastOrderPrepaChange)){if(!this.getOrderedLine(lineKey)){const lineKey=`${lineResume["line_uuid"]} - ${lineResume["note"]}`;if(!changes[lineKey]){changes[lineKey]={product_id:lineResume["product_id"],name:lineResume["name"],note:lineResume["note"],attribute_value_ids:lineResume["attribute_value_ids"],quantity:-lineResume["quantity"],};}else{changes[lineKey]["quantity"]-=lineResume["quantity"];}}}
return{nbrOfChanges:changeAbsCount,orderlines:changes,count:changesCount,};}
changesToOrder(cancelled=false){const toAdd=[];const toRemove=[];const changes=!cancelled?Object.values(this.getOrderChanges().orderlines):Object.values(this.lastOrderPrepaChange);for(const lineChange of changes){if(lineChange["quantity"]>0&&!cancelled){toAdd.push(lineChange);}else{lineChange["quantity"]=Math.abs(lineChange["quantity"]);toRemove.push(lineChange);}}
return{new:toAdd,cancelled:toRemove};}
getOrderedLine(lineKey){return this.orderlines.find((line)=>line.uuid===this.lastOrderPrepaChange[lineKey]["line_uuid"]&&line.note===this.lastOrderPrepaChange[lineKey]["note"]);}
hasSkippedChanges(){return this.orderlines.find((orderline)=>orderline.skipChange)?true:false;}
hasChangesToPrint(){return this.getOrderChanges().count?true:false;}
canPay(){return this.orderlines.length;}
async pay(){if(!this.canPay()){return;}
if(this.orderlines.some((line)=>line.get_product().tracking!=="none"&&!line.has_valid_product_lot())&&(this.pos.picking_type.use_create_lots||this.pos.picking_type.use_existing_lots)){const{confirmed}=await this.env.services.popup.add(ConfirmPopup,{title:_t("Some Serial/Lot Numbers are missing"),body:_t("You are trying to sell products with serial/lot numbers, but some of them are not set.\nWould you like to proceed anyway?"),confirmText:_t("Yes"),cancelText:_t("No"),});if(confirmed){this.pos.mobile_pane="right";this.env.services.pos.showScreen("PaymentScreen");}}else{this.pos.mobile_pane="right";this.env.services.pos.showScreen("PaymentScreen");}}
is_empty(){return this.orderlines.length===0;}
get isBooked(){return Boolean(this.booked||!this.is_empty()||this.server_id);}
generate_unique_id(){function zero_pad(num,size){var s=""+num;while(s.length<size){s="0"+s;}
return s;}
return(zero_pad(this.pos.pos_session.id,5)+"-"+
zero_pad(this.pos.pos_session.login_number,3)+"-"+
zero_pad(this.sequence_number,4));}
updateSavedQuantity(){this.orderlines.forEach((line)=>line.updateSavedQuantity());}
get_name(){return this.name;}
assert_editable(){if(this.finalized){throw new Error("Finalized Order cannot be modified");}}
add_orderline(line){this.assert_editable();if(line.order){line.order._unlinkOrderline(line);}
line.order=this;this.orderlines.add(line);this.select_orderline(this.get_last_orderline());}
get_orderline(id){var orderlines=this.orderlines;for(var i=0;i<orderlines.length;i++){if(orderlines[i].id===id){return orderlines[i];}}
return null;}
get_orderlines(){return this.orderlines;}
get_orderlines_grouped_by_tax_ids(){const orderlines_by_tax_group={};const lines=this.get_orderlines();for(const line of lines){const tax_group=this._get_tax_group_key(line);if(!(tax_group in orderlines_by_tax_group)){orderlines_by_tax_group[tax_group]=[];}
orderlines_by_tax_group[tax_group].push(line);}
return orderlines_by_tax_group;}
_get_tax_group_key(line){return line._getProductTaxesAfterFiscalPosition().map((tax)=>tax.id).join(",");}
calculate_base_amount(tax_ids_array,lines){const has_taxes_included_in_price=tax_ids_array.filter((tax_id)=>this.pos.taxes_by_id[tax_id].price_include||this.pos.taxes_by_id[tax_id].children_tax_ids.length>0&&this.pos.taxes_by_id[tax_id].children_tax_ids.every(child_tax=>child_tax.price_include)).length;const base_amount=lines.reduce((sum,line)=>sum+
(has_taxes_included_in_price?line.get_price_with_tax():line.get_price_without_tax()),0);return base_amount;}
get_last_orderline(){const orderlines=this.orderlines;return this.orderlines.at(orderlines.length-1);}
get_tip(){var tip_product=this.pos.db.get_product_by_id(this.pos.config.tip_product_id[0]);var lines=this.get_orderlines();if(!tip_product){return 0;}else{for(var i=0;i<lines.length;i++){if(lines[i].get_product()===tip_product){return lines[i].get_unit_price();}}
return 0;}}
set_tip(tip){var tip_product=this.pos.db.get_product_by_id(this.pos.config.tip_product_id[0]);var lines=this.get_orderlines();if(tip_product){for(var i=0;i<lines.length;i++){if(lines[i].get_product()===tip_product){lines[i].set_unit_price(tip);lines[i].set_lst_price(tip);lines[i].price_type="automatic";lines[i].order.tip_amount=tip;return;}}
return this.add_product(tip_product,{is_tip:true,quantity:1,price:tip,lst_price:tip,extras:{price_type:"automatic"},});}}
set_fiscal_position(fiscal_position){this.fiscal_position=fiscal_position;}
set_pricelist(pricelist){var self=this;this.pricelist=pricelist;const orderlines=this.get_orderlines();const lines_to_recompute=orderlines.filter((line)=>line.price_type==="original"&&!(line.comboLines?.length||line.comboParent));lines_to_recompute.forEach((line)=>{line.set_unit_price(line.product.get_price(self.pricelist,line.get_quantity(),line.get_price_extra()));self.fix_tax_included_price(line);});const combo_parent_lines=orderlines.filter((line)=>line.price_type==="original"&&line.comboLines?.length);const attributes_prices={};combo_parent_lines.forEach((parentLine)=>{attributes_prices[parentLine.id]=this.compute_child_lines(parentLine.product,parentLine.comboLines.map((childLine)=>{const comboLineCopy={...childLine.comboLine};if(childLine.attribute_value_ids){comboLineCopy.configuration={attribute_value_ids:childLine.attribute_value_ids,};}
return comboLineCopy;}),pricelist);});const combo_children_lines=orderlines.filter((line)=>line.price_type==="original"&&line.comboParent);combo_children_lines.forEach((line)=>{line.set_unit_price(attributes_prices[line.comboParent.id].find((item)=>item.comboLine.id===line.comboLine.id).price);self.fix_tax_included_price(line);});}
_unlinkOrderline(line){this.assert_editable();this.orderlines.remove(line);line.order=null;}
removeOrderline(line){const linesToRemove=line.getAllLinesInCombo();for(const lineToRemove of linesToRemove){this._unlinkOrderline(lineToRemove);if(lineToRemove.refunded_orderline_id in this.pos.toRefundLines){delete this.pos.toRefundLines[lineToRemove.refunded_orderline_id];}}
this.select_orderline(this.get_last_orderline());return true;}
isFirstDraft(){return this.firstDraft;}
fix_tax_included_price(line){line.set_unit_price(line.compute_fixed_price(line.price));}
_isRefundOrder(){if(this.orderlines.length>0&&this.orderlines[0].refunded_orderline_id){return true;}
return false;}
async add_product(product,options){if(this.pos.doNotAllowRefundAndSales()&&this._isRefundOrder()&&(!options.quantity||options.quantity>0)){this.pos.env.services.popup.add(ErrorPopup,{title:_t("Refund and Sales not allowed"),body:_t("It is not allowed to mix refunds and sales"),});return;}
if(this._printed){this.pos.removeOrder(this);return await this.pos.add_new_order().add_product(product,options);}
this.assert_editable();options=options||{};const quantity=options.quantity?options.quantity:1;const line=new Orderline({env:this.env},{pos:this.pos,order:this,product:product,quantity:quantity});this.fix_tax_included_price(line);this.set_orderline_options(line,options);line.set_full_product_name();var to_merge_orderline;for(var i=0;i<this.orderlines.length;i++){if(this.orderlines.at(i).can_be_merged_with(line)&&options.merge!==false){to_merge_orderline=this.orderlines.at(i);}}
if(to_merge_orderline){to_merge_orderline.merge(line);this.select_orderline(to_merge_orderline);}else{this.add_orderline(line);this.select_orderline(this.get_last_orderline());}
if(options.draftPackLotLines){this.selected_orderline.setPackLotLines({...options.draftPackLotLines,setQuantity:options.quantity===undefined,});}
if(options.comboLines?.length){await this.addComboLines(line,options);this.select_orderline(line);}
this.hasJustAddedProduct=true;clearTimeout(this.productReminderTimeout);this.productReminderTimeout=setTimeout(()=>{this.hasJustAddedProduct=false;},3000);return line;}
compute_child_lines(comboParentProduct,comboLines,pricelist){const combolines=[];const parentLstPrice=comboParentProduct.get_price(pricelist,1);const originalTotal=comboLines.reduce((acc,comboLine)=>{const originalPrice=this.pos.db.combo_by_id[comboLine.combo_id[0]].base_price;return acc+originalPrice;},0);let remainingTotal=parentLstPrice;for(const comboLine of comboLines){const combo=this.pos.db.combo_by_id[comboLine.combo_id[0]];let priceUnit=round_di((combo.base_price*parentLstPrice)/originalTotal,this.pos.dp["Product Price"]);remainingTotal-=priceUnit;if(comboLine==comboLines[comboLines.length-1]){priceUnit+=remainingTotal;}
const attribute_value_ids=comboLine.configuration?.attribute_value_ids;const attributesPriceExtra=(attribute_value_ids??[]).map((id)=>this.pos.db.attribute_value_by_id[id]?.price_extra||0).reduce((acc,price)=>acc+price,0);const totalPriceExtra=priceUnit+attributesPriceExtra+comboLine.combo_price;combolines.push({comboLine:comboLine,price:totalPriceExtra,attribute_value_ids});}
return combolines;}
async addComboLines(comboParent,options){const comboLinesPrices=this.compute_child_lines(comboParent.product,options.comboLines,this.pricelist);for(const line of comboLinesPrices){await this.pos.addProductFromUi(this.pos.db.product_by_id[line.comboLine.product_id[0]],{price:line.price,comboParent,comboLine:line.comboLine,attribute_value_ids:line.attribute_value_ids,});}}
set_orderline_options(orderline,options){if(options.comboLines?.length){options.price=0;orderline.comboLines=[];}
if(options.comboParent){orderline.comboParent=options.comboParent;orderline.comboLine=options.comboLine;orderline.comboParent.comboLines.push(orderline);}
if(options.quantity!==undefined){orderline.set_quantity(options.quantity);}
if(options.price_extra!==undefined){orderline.price_extra=options.price_extra;orderline.set_unit_price(orderline.product.get_price(this.pricelist,orderline.get_quantity(),options.price_extra));this.fix_tax_included_price(orderline);}
if(options.price!==undefined){orderline.set_unit_price(options.price);this.fix_tax_included_price(orderline);}
if(options.lst_price!==undefined){orderline.set_lst_price(options.lst_price);}
if(options.discount!==undefined){orderline.set_discount(options.discount);}
if(options.attribute_value_ids){orderline.attribute_value_ids=options.attribute_value_ids||[];}
if(options.attribute_custom_values&&Object.keys(options.attribute_custom_values).length>0){const customAttributeValues=[];for(const[id,value]of Object.entries(options.attribute_custom_values)){if(!value){continue;}
customAttributeValues.push(new ProductCustomAttribute({custom_product_template_attribute_value_id:parseInt(id),custom_value:value,}));}
orderline.custom_attribute_value_ids=customAttributeValues;}
if(options.extras!==undefined){for(var prop in options.extras){orderline[prop]=options.extras[prop];}}
if(options.is_tip){this.is_tipped=true;this.tip_amount=options.price;}
if(options.refunded_orderline_id){orderline.refunded_orderline_id=options.refunded_orderline_id;}
if(options.tax_ids){orderline.tax_ids=options.tax_ids;}}
get_selected_orderline(){return this.selected_orderline;}
select_orderline(line){if(line){if(line!==this.selected_orderline){if(this.selected_orderline){this.selected_orderline.set_selected(false);}
this.selected_orderline=line;this.selected_orderline.set_selected(true);}}else{this.selected_orderline=undefined;}
this.pos.numpadMode="quantity";}
deselect_orderline(){if(this.selected_orderline){this.selected_orderline.set_selected(false);this.selected_orderline=undefined;}}
add_paymentline(payment_method){this.assert_editable();if(this.electronic_payment_in_progress()){return false;}else{var newPaymentline=new Payment({env:this.env},{order:this,payment_method:payment_method,pos:this.pos});this.paymentlines.add(newPaymentline);this.select_paymentline(newPaymentline);if(this.pos.config.cash_rounding){this.selected_paymentline.set_amount(0);}
newPaymentline.set_amount(this.get_due());if(payment_method.payment_terminal){newPaymentline.set_payment_status("pending");}
return newPaymentline;}}
get_paymentlines(){return this.paymentlines;}
get_paymentline(cid){var lines=this.get_paymentlines();return lines.find(function(line){return line.cid===cid;});}
remove_paymentline(line){this.assert_editable();if(this.selected_paymentline===line){this.select_paymentline(undefined);}
this.paymentlines.remove(line);}
clean_empty_paymentlines(){var lines=this.paymentlines;var empty=[];for(var i=0;i<lines.length;i++){if(!lines[i].get_amount()){empty.push(lines[i]);}}
for(i=0;i<empty.length;i++){this.remove_paymentline(empty[i]);}}
select_paymentline(line){if(line!==this.selected_paymentline){if(this.selected_paymentline){this.selected_paymentline.set_selected(false);}
this.selected_paymentline=line;if(this.selected_paymentline){this.selected_paymentline.set_selected(true);}}}
electronic_payment_in_progress(){return this.get_paymentlines().some(function(pl){if(pl.payment_status){return!["done","reversed"].includes(pl.payment_status);}else{return false;}});}
stop_electronic_payment(){var lines=this.get_paymentlines();var line=lines.find(function(line){var status=line.get_payment_status();return(status&&!["done","reversed","reversing","pending","retry"].includes(status));});if(line){line.set_payment_status("waitingCancel");line.payment_method.payment_terminal.send_payment_cancel(this,line.cid).finally(function(){line.set_payment_status("retry");});}}
get_subtotal(){return round_pr(this.orderlines.reduce(function(sum,orderLine){return sum+orderLine.get_display_price();},0),this.pos.currency.rounding);}
get_total_with_tax(){return this.get_total_without_tax()+this.get_total_tax();}
get_total_without_tax(){return round_pr(this.orderlines.reduce(function(sum,orderLine){return sum+orderLine.get_price_without_tax();},0),this.pos.currency.rounding);}
_get_ignored_product_ids_total_discount(){return[];}
_reduce_total_discount_callback(sum,orderLine){let discountUnitPrice=orderLine.getUnitDisplayPriceBeforeDiscount()*(orderLine.get_discount()/100);if(orderLine.display_discount_policy()==="without_discount"){discountUnitPrice+=orderLine.get_taxed_lst_unit_price()-
orderLine.getUnitDisplayPriceBeforeDiscount();}
return sum+discountUnitPrice*orderLine.get_quantity();}
get_total_discount(){const ignored_product_ids=this._get_ignored_product_ids_total_discount();return round_pr(this.orderlines.reduce((sum,orderLine)=>{if(!ignored_product_ids.includes(orderLine.product.id)){sum+=orderLine.getUnitDisplayPriceBeforeDiscount()*(orderLine.get_discount()/100)*orderLine.get_quantity();if(orderLine.display_discount_policy()==="without_discount"){sum+=(orderLine.get_taxed_lst_unit_price()-
orderLine.getUnitDisplayPriceBeforeDiscount())*orderLine.get_quantity();}}
return sum;},0),this.pos.currency.rounding);}
get_total_tax(){if(this.pos.company.tax_calculation_rounding_method==="round_globally"){var groupTaxes={};this.orderlines.forEach(function(line){var taxDetails=line.get_tax_details();var taxIds=Object.keys(taxDetails);for(var t=0;t<taxIds.length;t++){var taxId=taxIds[t];if(!(taxId in groupTaxes)){groupTaxes[taxId]=0;}
groupTaxes[taxId]+=taxDetails[taxId].amount;}});var sum=0;var taxIds=Object.keys(groupTaxes);for(var j=0;j<taxIds.length;j++){var taxAmount=groupTaxes[taxIds[j]];sum+=round_pr(taxAmount,this.pos.currency.rounding);}
return sum;}else{return round_pr(this.orderlines.reduce(function(sum,orderLine){return sum+orderLine.get_tax();},0),this.pos.currency.rounding);}}
get_total_paid(){return round_pr(this.paymentlines.reduce(function(sum,paymentLine){if(paymentLine.is_done()){sum+=paymentLine.get_amount();}
return sum;},0),this.pos.currency.rounding);}
get_tax_details(){var details={};var fulldetails=[];this.orderlines.forEach(function(line){var ldetails=line.get_tax_details();for(var id in ldetails){if(Object.hasOwnProperty.call(ldetails,id)){details[id]={amount:(details[id]?.amount||0)+ldetails[id].amount,base:(details[id]?.base||0)+ldetails[id].base,};}}});for(var id in details){if(Object.hasOwnProperty.call(details,id)){fulldetails.push({amount:details[id].amount,base:details[id].base,tax:this.pos.taxes_by_id[id],name:this.pos.taxes_by_id[id].name,});}}
return fulldetails;}
get_total_for_taxes(tax_id){var total=0;if(!(tax_id instanceof Array)){tax_id=[tax_id];}
var tax_set={};for(var i=0;i<tax_id.length;i++){tax_set[tax_id[i]]=true;}
this.orderlines.forEach((line)=>{var taxes_ids=this.tax_ids||line.get_product().taxes_id;for(var i=0;i<taxes_ids.length;i++){if(tax_set[taxes_ids[i]]){total+=line.get_price_with_tax();return;}}});return total;}
get_change(paymentline){if(!paymentline){var change=this.get_total_paid()-this.get_total_with_tax()-this.get_rounding_applied();}else{change=-this.get_total_with_tax();var lines=this.paymentlines;for(var i=0;i<lines.length;i++){change+=lines[i].get_amount();if(lines[i]===paymentline){break;}}}
return round_pr(Math.max(0,change),this.pos.currency.rounding);}
get_due(paymentline){if(!paymentline){var due=this.get_total_with_tax()-this.get_total_paid()+this.get_rounding_applied();}else{due=this.get_total_with_tax();var lines=this.paymentlines;for(var i=0;i<lines.length;i++){if(lines[i]===paymentline){break;}else{due-=lines[i].get_amount();}}}
return round_pr(due,this.pos.currency.rounding);}
get_rounding_applied(){if(this.pos.config.cash_rounding){const only_cash=this.pos.config.only_round_cash_method;const paymentlines=this.get_paymentlines();const last_line=paymentlines?paymentlines[paymentlines.length-1]:false;const last_line_is_cash=last_line?last_line.payment_method.is_cash_count==true:false;if(!only_cash||(only_cash&&last_line_is_cash)){var rounding_method=this.pos.cash_rounding[0].rounding_method;var remaining=this.get_total_with_tax()-this.get_total_paid();var sign=this.get_total_with_tax()>0?1.0:-1.0;if(((this.get_total_with_tax()<0&&remaining>0)||(this.get_total_with_tax()>0&&remaining<0))&&rounding_method!=="HALF-UP"){rounding_method=rounding_method==="UP"?"DOWN":"UP";}
remaining*=sign;var total=round_pr(remaining,this.pos.cash_rounding[0].rounding);var rounding_applied=total-remaining;if(floatIsZero(rounding_applied,this.pos.currency.decimal_places)){return 0;}else if(Math.abs(this.get_total_with_tax())<this.pos.cash_rounding[0].rounding){return 0;}else if(rounding_method==="UP"&&rounding_applied<0&&remaining>0){rounding_applied+=this.pos.cash_rounding[0].rounding;}else if(rounding_method==="UP"&&rounding_applied>0&&remaining<0){rounding_applied-=this.pos.cash_rounding[0].rounding;}else if(rounding_method==="DOWN"&&rounding_applied>0&&remaining>0){rounding_applied-=this.pos.cash_rounding[0].rounding;}else if(rounding_method==="DOWN"&&rounding_applied<0&&remaining<0){rounding_applied+=this.pos.cash_rounding[0].rounding;}else if(rounding_method==="HALF-UP"&&rounding_applied===this.pos.cash_rounding[0].rounding/-2){rounding_applied+=this.pos.cash_rounding[0].rounding;}
return sign*rounding_applied;}else{return 0;}}
return 0;}
has_not_valid_rounding(){if(!this.pos.config.cash_rounding||this.get_total_with_tax()<this.pos.cash_rounding[0].rounding){return false;}
const only_cash=this.pos.config.only_round_cash_method;var lines=this.paymentlines;for(var i=0;i<lines.length;i++){var line=lines[i];if(only_cash&&!line.payment_method.is_cash_count){continue;}
if(!floatIsZero(line.amount-round_pr(line.amount,this.pos.cash_rounding[0].rounding),6)){return line;}}
return false;}
is_paid(){return this.get_due()<=0&&this.check_paymentlines_rounding();}
is_paid_with_cash(){return!!this.paymentlines.find(function(pl){return pl.payment_method.is_cash_count;});}
check_paymentlines_rounding(){if(this.pos.config.cash_rounding){var cash_rounding=this.pos.cash_rounding[0].rounding;var default_rounding=this.pos.currency.rounding;for(var id in this.get_paymentlines()){var line=this.get_paymentlines()[id];var diff=round_pr(round_pr(line.amount,cash_rounding)-round_pr(line.amount,default_rounding),default_rounding);if(this.get_total_with_tax()<this.pos.cash_rounding[0].rounding){return true;}
if(diff&&line.payment_method.is_cash_count){return false;}else if(!this.pos.config.only_round_cash_method&&diff){return false;}}
return true;}
return true;}
get_total_cost(){return this.orderlines.reduce(function(sum,orderLine){return sum+orderLine.get_total_cost();},0);}
set_to_invoice(to_invoice){this.assert_editable();this.to_invoice=to_invoice;}
is_to_invoice(){return this.to_invoice;}
set_partner(partner){this.assert_editable();this.partner=partner;this.updatePricelistAndFiscalPosition(partner);}
get_partner(){return this.partner;}
get_partner_name(){const partner=this.partner;return partner?partner.name:"";}
get_cardholder_name(){var card_payment_line=this.paymentlines.find((pl)=>pl.cardholder_name);return card_payment_line?card_payment_line.cardholder_name:"";}
set_screen_data(value){this.screen_data["value"]=value;}
get_current_screen_data(){return this.screen_data["value"]??{name:"ProductScreen"};}
get_screen_data(){const screen=this.screen_data["value"];if(!screen){if(this.get_paymentlines().length>0){return{name:"PaymentScreen"};}
return{name:"ProductScreen"};}
if(!this.finalized&&this.get_paymentlines().length>0){return{name:"PaymentScreen"};}
return screen;}
wait_for_push_order(){return false;}
updatePricelistAndFiscalPosition(newPartner){let newPartnerPricelist,newPartnerFiscalPosition;const defaultFiscalPosition=this.pos.fiscal_positions.find((position)=>position.id===this.pos.config.default_fiscal_position_id[0]);if(newPartner){newPartnerFiscalPosition=newPartner.property_account_position_id?this.pos.fiscal_positions.find((position)=>position.id===newPartner.property_account_position_id[0]):defaultFiscalPosition;newPartnerPricelist=this.pos.pricelists.find((pricelist)=>pricelist.id===newPartner.property_product_pricelist[0])||this.pos.default_pricelist;}else{newPartnerFiscalPosition=defaultFiscalPosition;newPartnerPricelist=this.pos.default_pricelist;}
this.set_fiscal_position(newPartnerFiscalPosition);this.set_pricelist(newPartnerPricelist);}
setShippingDate(shippingDate){this.shippingDate=shippingDate;}
getShippingDate(){return this.shippingDate;}
getHasRefundLines(){for(const line of this.get_orderlines()){if(line.refunded_orderline_id){return true;}}
return false;}
_isValidEmptyOrder(){if(this.get_orderlines().length==0){return this.get_paymentlines().length!=0;}else{return true;}}
_generateTicketCode(){return random5Chars();}
_getOrderOptions(){return{};}}
return __exports;});;

/* /point_of_sale/static/src/app/store/models/product_custom_attribute.js */
odoo.define('@point_of_sale/app/store/models/product_custom_attribute',['@web/core/utils/reactive'],function(require){'use strict';let __exports={};const{Reactive}=require("@web/core/utils/reactive");const ProductCustomAttribute=__exports.ProductCustomAttribute=class ProductCustomAttribute extends Reactive{constructor(){super();this.setup(...arguments);}
setup({id,name,custom_value,custom_product_template_attribute_value_id}){this.id=id;this.name=name;this.custom_value=custom_value;this.custom_product_template_attribute_value_id=custom_product_template_attribute_value_id;}
get value(){return this.custom_value;}}
return __exports;});;

/* /point_of_sale/static/src/app/store/pos_hook.js */
odoo.define('@point_of_sale/app/store/pos_hook',['@odoo/owl','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{useState}=require("@odoo/owl");const{useService}=require("@web/core/utils/hooks");__exports.usePos=usePos;function usePos(){return useState(useService("pos"));}
return __exports;});;

/* /point_of_sale/static/src/app/store/pos_store.js */
odoo.define('@point_of_sale/app/store/pos_store',['@point_of_sale/app/store/models','@web/core/utils/concurrency','@point_of_sale/app/store/db','@odoo/owl','@web/core/utils/numbers','@web/core/registry','@point_of_sale/app/utils/confirm_popup/confirm_popup','@point_of_sale/utils','@web/core/utils/reactive','@point_of_sale/app/printer/hw_printer','@web/core/utils/functions','@point_of_sale/app/errors/popups/error_popup','@web/core/network/rpc_service','@web/core/l10n/translation','@point_of_sale/app/store/cash_opening_popup/cash_opening_popup','@point_of_sale/app/screens/payment_screen/payment_screen','@point_of_sale/app/screens/product_screen/product_screen','@web/core/utils/render','@web/core/utils/timing','@point_of_sale/app/screens/ticket_screen/ticket_screen','@point_of_sale/app/store/select_lot_popup/select_lot_popup'],function(require){'use strict';let __exports={};const{PosCollection,Order,Product}=require("@point_of_sale/app/store/models");const{Mutex}=require("@web/core/utils/concurrency");const{PosDB}=require("@point_of_sale/app/store/db");const{markRaw,reactive}=require("@odoo/owl");const{roundPrecision:round_pr,floatIsZero}=require("@web/core/utils/numbers");const{registry}=require("@web/core/registry");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{deduceUrl}=require("@point_of_sale/utils");const{Reactive}=require("@web/core/utils/reactive");const{HWPrinter}=require("@point_of_sale/app/printer/hw_printer");const{memoize}=require("@web/core/utils/functions");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{ConnectionLostError}=require("@web/core/network/rpc_service");const{_t}=require("@web/core/l10n/translation");const{CashOpeningPopup}=require("@point_of_sale/app/store/cash_opening_popup/cash_opening_popup");const{PaymentScreen}=require("@point_of_sale/app/screens/payment_screen/payment_screen");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{renderToString}=require("@web/core/utils/render");const{batched}=require("@web/core/utils/timing");const{TicketScreen}=require("@point_of_sale/app/screens/ticket_screen/ticket_screen");const{EditListPopup}=require("@point_of_sale/app/store/select_lot_popup/select_lot_popup");__exports.uniqueBy=uniqueBy;function uniqueBy(array,agg){const map=new Map();for(const item of array){const key=agg(item);if(!map.has(key)){map.set(key,item);}}
return[...map.values()];}
const getProductImage=memoize(function getProductImage(productId,writeDate){return new Promise(function(resolve,reject){const img=new Image();img.addEventListener("load",()=>{const canvas=document.createElement("canvas");const ctx=canvas.getContext("2d");canvas.height=img.height;canvas.width=img.width;ctx.drawImage(img,0,0);resolve(canvas.toDataURL("image/jpeg"));});img.addEventListener("error",reject);img.src=`/web/image?model=product.product&field=image_128&id=${productId}&unique=${writeDate}`;});});const PosStore=__exports.PosStore=class PosStore extends Reactive{hasBigScrollBars=false;loadingSkipButtonIsShown=false;mainScreen={name:null,component:null};tempScreen=null;static serviceDependencies=["popup","orm","number_buffer","barcode_reader","hardware_proxy","ui",];constructor(){super();this.ready=this.setup(...arguments).then(()=>this);}
async setup(env,{popup,orm,number_buffer,hardware_proxy,barcode_reader,ui}){this.env=env;this.orm=orm;this.popup=popup;this.numberBuffer=number_buffer;this.barcodeReader=barcode_reader;this.ui=ui;this.db=new PosDB();this.unwatched=markRaw({});this.pushOrderMutex=new Mutex();this.company_logo=null;this.company_logo_base64="";this.currency=null;this.company=null;this.user=null;this.partners=[];this.taxes=[];this.pos_session=null;this.config=null;this.units=[];this.units_by_id={};this.uom_unit_id=null;this.default_pricelist=null;this.order_sequence=1;this.printers_category_ids_set=new Set();this.validated_orders_name_server_id_map={};this.numpadMode="quantity";this.mobile_pane="right";this.ticket_screen_mobile_pane="left";this.productListView=window.localStorage.getItem("productListView")||"grid";this.toRefundLines={};this.TICKET_SCREEN_STATE={syncedOrders:{currentPage:1,cache:{},toShow:[],nPerPage:80,totalCount:null,cacheDate:null,},ui:{selectedOrder:null,searchDetails:this.getDefaultSearchDetails(),filter:null,selectedOrderlineIds:{},highlightHeaderNote:false,},};this.ordersToUpdateSet=new Set();this.loadingOrderState=false;this.showOfflineWarning=true;this.tempScreenIsShown=false;Object.assign(this,{synch:{status:"connected",pending:0},orders:new PosCollection(),selectedOrder:null,selectedPartner:null,selectedCategoryId:null,searchProductWord:"",});this.ready=new Promise((resolve)=>{this.markReady=resolve;});this.hardwareProxy=hardware_proxy;this.hardwareProxy.pos=this;await this.load_server_data();if(this.config.use_proxy){await this.connectToProxy();}
this.closeOtherTabs();this.preloadImages();this.showScreen("ProductScreen");}
toggleImages(imageType="product"){if(imageType==="product"){this.show_product_images=!this.show_product_images;}
if(imageType==="category"){this.show_category_images=!this.show_category_images;}
this.orm.silent.call("pos.config","toggle_images",[[this.config.id],this.show_product_images?"yes":"no",this.show_category_images?"yes":"no",]);}
get productListViewMode(){const viewMode=this.productListView&&this.ui.isSmall?this.productListView:"grid";if(viewMode==="grid"){return"d-grid gap-1";}else{return"";}}
get productViewMode(){const viewMode=this.productListView&&this.ui.isSmall?this.productListView:"grid";if(viewMode==="grid"){return"flex-column";}else{return"flex-row-reverse justify-content-between m-1";}}
getDefaultSearchDetails(){return{fieldName:"RECEIPT_NUMBER",searchTerm:"",};}
async setDiscountFromUI(line,val){line.set_discount(val);}
getDefaultPricelist(){const current_order=this.get_order();if(current_order){return current_order.pricelist;}
return this.default_pricelist;}
async load_product_uom_unit(){const uom_id=await this.orm.call("ir.model.data","check_object_reference",["uom","product_uom_unit",]);this.uom_unit_id=uom_id[1];}
async after_load_server_data(){await this.load_product_uom_unit();await this.load_orders();this.set_start_order();Object.assign(this.toRefundLines,this.db.load("TO_REFUND_LINES")||{});window.addEventListener("beforeunload",()=>this.db.save("TO_REFUND_LINES",this.toRefundLines));this.resetProductScreenSearch();this.hasBigScrollBars=this.config.iface_big_scrollbars;this.push_orders();this.load_server_orders();this.markReady();}
async load_server_data(){const loadedData=await this.orm.silent.call("pos.session","load_pos_data",[[odoo.pos_session_id],]);await this._processData(loadedData);return this.after_load_server_data();}
async _processData(loadedData){this.version=loadedData["version"];this.company=loadedData["res.company"];this.dp=loadedData["decimal.precision"];this.units=loadedData["uom.uom"];this.units_by_id=loadedData["units_by_id"];this.states=loadedData["res.country.state"];this.countries=loadedData["res.country"];this.langs=loadedData["res.lang"];this.taxes=loadedData["account.tax"];this.taxes_by_id=loadedData["taxes_by_id"];this.pos_session=loadedData["pos.session"];this._loadPosSession();this.config=loadedData["pos.config"];this._loadPoSConfig();this.bills=loadedData["pos.bill"];this.partners=loadedData["res.partner"];this.addPartners(this.partners);this.picking_type=loadedData["stock.picking.type"];this.user=loadedData["res.users"];this.pricelists=loadedData["product.pricelist"];this.default_pricelist=loadedData["default_pricelist"];this.currency=loadedData["res.currency"];this.db.add_attributes(loadedData["attributes_by_ptal_id"]);this.db.add_categories(loadedData["pos.category"]);this.db.add_combos(loadedData["pos.combo"]);this.db.add_combo_lines(loadedData["pos.combo.line"]);this._loadProductProduct(loadedData["product.product"]);this.db.add_packagings(loadedData["product.packaging"]);this.attributes_by_ptal_id=loadedData["attributes_by_ptal_id"];this._add_ptal_ids_by_ptav_id(this.attributes_by_ptal_id);this.cash_rounding=loadedData["account.cash.rounding"];this.payment_methods=loadedData["pos.payment.method"];this._loadPosPaymentMethod();this.fiscal_positions=loadedData["account.fiscal.position"];this.base_url=loadedData["base_url"];this.pos_has_valid_product=loadedData["pos_has_valid_product"];this.db.addProductIdsToNotDisplay(loadedData["pos_special_products_ids"]);this.partner_commercial_fields=loadedData["partner_commercial_fields"];this.show_product_images=loadedData["show_product_images"]==="yes";this.show_category_images=loadedData["show_category_images"]==="yes";await this._loadPosPrinters(loadedData["pos.printer"]);this.open_orders_json=loadedData["open_orders"];}
_add_ptal_ids_by_ptav_id(attributes_by_ptal_id){this.ptal_ids_by_ptav_id={};for(const[ptal_id,attribute]of Object.entries(attributes_by_ptal_id)){for(const value of attribute["values"]){const ptav_id=value["id"];if(ptav_id in this.ptal_ids_by_ptav_id){this.ptal_ids_by_ptav_id[ptav_id].push(ptal_id);}else{this.ptal_ids_by_ptav_id[ptav_id]=[ptal_id];}}}}
_loadPosSession(){this.db.save("pos_session_id",this.pos_session.id);const orders=this.db.get_orders();const sequences=orders.map((order)=>order.data.sequence_number+1);this.pos_session.sequence_number=Math.max(this.pos_session.sequence_number,...sequences);this.pos_session.login_number=odoo.login_number;}
_loadPosPrinters(printers){this.unwatched.printers=[];for(const printerConfig of printers){const printer=this.create_printer(printerConfig);printer.config=printerConfig;this.unwatched.printers.push(printer);for(const id of printer.config.product_categories_ids){this.printers_category_ids_set.add(id);}}
this.config.iface_printers=!!this.unwatched.printers.length;}
create_printer(config){const url=deduceUrl(config.proxy_ip||"");return new HWPrinter({rpc:this.env.services.rpc,url});}
_loadPoSConfig(){this.db.set_uuid(this.config.uuid);}
addPartners(partners){return this.db.add_partners(partners);}
_assignApplicableItems(pricelist,correspondingProduct,pricelistItem){if(!(pricelist.id in correspondingProduct.applicablePricelistItems)){correspondingProduct.applicablePricelistItems[pricelist.id]=[];}
correspondingProduct.applicablePricelistItems[pricelist.id].push(pricelistItem);}
_loadProductProduct(products){const productMap={};const productTemplateMap={};const modelProducts=products.map((product)=>{product.pos=this;product.env=this.env;product.applicablePricelistItems={};productMap[product.id]=product;productTemplateMap[product.product_tmpl_id[0]]=(productTemplateMap[product.product_tmpl_id[0]]||[]).concat(product);return new Product(product);});for(const pricelist of this.pricelists){for(const pricelistItem of pricelist.items){if(pricelistItem.product_id){const product_id=pricelistItem.product_id[0];const correspondingProduct=productMap[product_id];if(correspondingProduct){this._assignApplicableItems(pricelist,correspondingProduct,pricelistItem);}}else if(pricelistItem.product_tmpl_id){const product_tmpl_id=pricelistItem.product_tmpl_id[0];const correspondingProducts=productTemplateMap[product_tmpl_id];for(const correspondingProduct of correspondingProducts||[]){this._assignApplicableItems(pricelist,correspondingProduct,pricelistItem);}}else{for(const correspondingProduct of products){this._assignApplicableItems(pricelist,correspondingProduct,pricelistItem);}}}}
this.db.add_products(modelProducts);}
_loadPosPaymentMethod(){this.payment_methods_by_id={};for(const pm of this.payment_methods){this.payment_methods_by_id[pm.id]=pm;const PaymentInterface=this.electronic_payment_interfaces[pm.use_payment_terminal];if(PaymentInterface){pm.payment_terminal=new PaymentInterface(this,pm);}}}
async _loadFonts(){return new Promise(function(resolve,reject){waitForWebfonts(["Lato","Inconsolata"],function(){resolve();});setTimeout(resolve,5000);});}
async _loadPictures(){this.company_logo=new Image();return new Promise((resolve,reject)=>{this.company_logo.onload=()=>{const img=this.company_logo;let ratio=1;const targetwidth=300;const maxheight=150;if(img.width!==targetwidth){ratio=targetwidth/img.width;}
if(img.height*ratio>maxheight){ratio=maxheight/img.height;}
const width=Math.floor(img.width*ratio);const height=Math.floor(img.height*ratio);const c=document.createElement("canvas");c.width=width;c.height=height;const ctx=c.getContext("2d");ctx.drawImage(this.company_logo,0,0,width,height);this.company_logo_base64=c.toDataURL();resolve();};this.company_logo.onerror=()=>{reject();};this.company_logo.crossOrigin="anonymous";this.company_logo.src=`/web/image?model=res.company&id=${this.company.id}&field=logo`;});}
prepare_new_partners_domain(){return[["write_date",">",this.db.get_partner_write_date()]];}
async load_new_partners(){const search_params={domain:this.prepare_new_partners_domain()};const partners=await this.orm.silent.call("pos.session","get_pos_ui_res_partner_by_params",[[odoo.pos_session_id],search_params]);return this.addPartners(partners);}
async updateModelsData(models_data){const products=models_data["product.product"];const categories=models_data["pos.category"];const openOrders=models_data["pos.order"];let removed_categories_id;if(categories){const previous_categories_id=Object.values(this.db.category_by_id).map((c)=>c.id);const received_categories_id=new Set(categories.map((c)=>c.id));this.db.add_categories(categories);removed_categories_id=previous_categories_id.filter((p)=>!received_categories_id.has(p));}
if(products){const previous_products_id=Object.values(this.db.product_by_id).map((p)=>p.id);const received_products_id=new Set(products.map((p)=>p.id));this._loadProductProduct(products);const removed_products_id=previous_products_id.filter((p)=>!received_products_id.has(p));this.db.remove_products(removed_products_id);if(Object.values(this.db.product_by_id).some((p)=>p.available_in_pos&&p.lst_price>0)){this.pos_has_valid_product=true;}}
if(categories){this.db.remove_categories(removed_categories_id);}
if(openOrders){this.loadOpenOrders(openOrders);}}
loadOpenOrders(openOrders){let isOrderSet=false;for(const json of openOrders){if(this.orders.find((el)=>el.server_id===json.id)){continue;}
this._createOrder(json);if(!isOrderSet){this.selectedOrder=this.orders[this.orders.length-1];isOrderSet=true;}}}
posHasValidProduct(){return this.pos_has_valid_product;}
setSelectedCategoryId(categoryId){this.selectedCategoryId=categoryId;}
removeOrder(order,removeFromServer=true){this.orders.remove(order);this.db.remove_unpaid_order(order);for(const line of order.get_orderlines()){if(line.refunded_orderline_id){delete this.toRefundLines[line.refunded_orderline_id];}}
if(this.isOpenOrderShareable()&&removeFromServer){if(this.ordersToUpdateSet.has(order)){this.ordersToUpdateSet.delete(order);}
if(order.server_id&&!order.finalized){this.setOrderToRemove(order);}}}
setOrderToRemove(order){this.db.set_order_to_remove_from_server(order);}
get_cashier(){return this.user;}
get_cashier_user_id(){return this.user.id;}
get orderPreparationCategories(){if(this.printers_category_ids_set){return new Set([...this.printers_category_ids_set]);}
return new Set();}
cashierHasPriceControlRights(){return!this.config.restrict_price_control||this.get_cashier().role=="manager";}
_onReactiveOrderUpdated(order){order.save_to_db();if(this.isOpenOrderShareable()&&!this.loadingOrderState){this.ordersToUpdateSet.add(order);}}
createReactiveOrder(json){const options={pos:this};if(json){options.json=json;}
return this.makeOrderReactive(new Order({env:this.env},options));}
makeOrderReactive(order){const batchedCallback=batched(()=>{this._onReactiveOrderUpdated(order);});order=reactive(order,batchedCallback);order.save_to_db();return order;}
add_new_order(){if(this.isOpenOrderShareable()){this.sendDraftToServer();}
if(this.selectedOrder){this.selectedOrder.firstDraft=false;this.selectedOrder.updateSavedQuantity();}
const order=this.createReactiveOrder();this.orders.add(order);this.selectedOrder=order;return order;}
selectNextOrder(){if(this.orders.length>0){this.selectedOrder=this.orders[0];}else{this.add_new_order();}}
async sendDraftToServer(){const ordersUidsToSync=[...this.ordersToUpdateSet].map((order)=>order.uid);const ordersToSync=this.db.get_unpaid_orders_to_sync(ordersUidsToSync);const ordersResponse=await this._save_to_server(ordersToSync,{draft:true});const orders=[...this.ordersToUpdateSet].map((order)=>order);ordersResponse.forEach((orderResponseData)=>this._updateOrder(orderResponseData,orders));this.ordersToUpdateSet.clear();}
addOrderToUpdateSet(){this.ordersToUpdateSet.add(this.selectedOrder);}
_updateOrder(ordersResponseData,orders){const order=orders.find((order)=>order.name===ordersResponseData.pos_reference);if(order){order.server_id=ordersResponseData.id;return order;}}
async load_orders(){this.loadingOrderState=true;var jsons=this.db.get_unpaid_orders();await this._loadMissingProducts(jsons);await this._loadMissingPartners(jsons);var orders=[];for(const json of jsons){if(json.pos_session_id===this.pos_session.id||json.lines.length>0||json.statement_ids.length>0){try{orders.push(this.createReactiveOrder(json));continue;}catch(error){console.error("There was an error while loading the order",json,error);}}
this.db.remove_unpaid_order(json);}
orders=orders.sort(function(a,b){return a.sequence_number-b.sequence_number;});if(orders.length){for(const order of orders){this.orders.add(order);}}
this.loadingOrderState=false;}
load_server_orders(){if(!this.open_orders_json){return;}
this.loadOpenOrders(this.open_orders_json);}
async _loadMissingProducts(orders){const missingProductIds=new Set([]);for(const order of orders){for(const line of order.lines){const productId=line[2].product_id;if(missingProductIds.has(productId)){continue;}
if(!this.db.get_product_by_id(productId)){missingProductIds.add(productId);}}}
if(!missingProductIds.size){return;}
const products=await this.orm.call("pos.session","get_pos_ui_product_product_by_params",[odoo.pos_session_id,{domain:[["id","in",[...missingProductIds]]]}]);await this._loadMissingPricelistItems(products);this._loadProductProduct(products);}
async _loadMissingPricelistItems(products){if(!products.length){return;}
const product_tmpl_ids=products.map((product)=>product.product_tmpl_id[0]);const product_ids=products.map((product)=>product.id);const pricelistItems=await this.orm.call("pos.session","get_pos_ui_product_pricelist_item_by_product",[odoo.pos_session_id,product_tmpl_ids,product_ids]);for(const pricelist of this.pricelists){const itemIds=new Set(pricelist.items.map((item)=>item.id));const _pricelistItems=pricelistItems.filter((item)=>{return item.pricelist_id[0]===pricelist.id&&!itemIds.has(item.id);});pricelist.items=[..._pricelistItems,...pricelist.items];}}
async _loadPartners(partnerIds){if(partnerIds.length>0){const fetchedPartners=await this.orm.silent.call("pos.session","get_pos_ui_res_partner_by_params",[[odoo.pos_session_id],{domain:[["id","in",partnerIds]]}]);this.addPartners(fetchedPartners);}}
async _loadMissingPartners(orders){const missingPartnerIds=new Set([]);for(const order of orders){const partnerId=order.partner_id;if(missingPartnerIds.has(partnerId)){continue;}
if(partnerId&&!this.db.get_partner_by_id(partnerId)){missingPartnerIds.add(partnerId);}}
await this._loadPartners([...missingPartnerIds]);}
setLoadingOrderState(bool){this.loadingOrderState=bool;}
async _removeOrdersFromServer(){const removedOrdersIds=this.db.get_ids_to_remove_from_server();if(removedOrdersIds.length===0){return;}
this.set_synch("connecting",removedOrdersIds.length);try{const removeOrdersResponseData=await this.orm.silent.call("pos.order","remove_from_ui",[removedOrdersIds]);this.set_synch("connected");this._postRemoveFromServer(removedOrdersIds,removeOrdersResponseData);}catch(reason){const error=reason.message;if(error.code===200){if(error.data.exception_type=="warning"){delete error.data.debug;}}
console.warn("Failed to remove orders:",removedOrdersIds);this._postRemoveFromServer(removedOrdersIds);throw error;}}
_postRemoveFromServer(serverIds,data){this.db.set_ids_removed_from_server(serverIds);}
_replaceOrders(ordersToReplace,newOrdersJsons){ordersToReplace.forEach((order)=>{if(this._shouldRemoveOrder(order)){this.removeOrder(order,false);}});let removeSelected=true;newOrdersJsons.forEach((json)=>{const isSelectedOrder=this._createOrder(json);if(removeSelected&&isSelectedOrder){removeSelected=false;}});if(this._shouldRemoveSelectedOrder(removeSelected)){this._removeSelectedOrder();}}
_shouldRemoveOrder(order){return((!this.selectedOrder||this.selectedOrder.uid!=order.uid)&&order.server_id&&!order.finalized);}
_shouldRemoveSelectedOrder(removeSelected){return removeSelected&&this.selectedOrder.server_id&&!this.selectedOrder.finalized;}
_shouldCreateOrder(json){return json.uid!=this.selectedOrder.uid;}
_isSelectedOrder(json){return json.uid==this.selectedOrder.uid;}
_createOrder(json){if(this._shouldCreateOrder(json)){const order=this.createReactiveOrder(json);this.orders.add(order);}
return this._isSelectedOrder(json);}
_removeSelectedOrder(){this.removeOrder(this.selectedOrder,false);const orderList=this.get_order_list();if(orderList.length!=0){this.set_order(orderList[0]);}}
async _syncAllOrdersFromServer(){await this._removeOrdersFromServer();const ordersJson=await this._getOrdersJson();let message=null;message=await this._addPricelists(ordersJson);let messageFp=null;messageFp=await this._addFiscalPositions(ordersJson);if(messageFp){if(message){message+="\n"+messageFp;}else{message=messageFp;}}
await this._loadMissingProducts(ordersJson);await this._loadMissingPartners(ordersJson);const allOrders=[...this.get_order_list()];this._replaceOrders(allOrders,ordersJson);this.sortOrders();return message;}
async _getOrdersJson(){return await this.orm.call("pos.order","export_for_ui_shared_order",[],{config_id:this.config.id,});}
async _addPricelists(ordersJson){const pricelistsToGet=[];ordersJson.forEach((order)=>{let found=false;for(const pricelist of this.pricelists){if(pricelist.id===order.pricelist_id){found=true;break;}}
if(!found&&order.pricelist_id){pricelistsToGet.push(order.pricelist_id);}});let message=null;if(pricelistsToGet.length>0){const pricelistsJson=await this._getPricelistJson(pricelistsToGet);message=this._addPosPricelists(pricelistsJson);}
return message;}
async _getPricelistJson(pricelistsToGet){return await this.env.services.orm.call("pos.session","get_pos_ui_product_pricelists_by_ids",[[odoo.pos_session_id],pricelistsToGet]);}
_addPosPricelists(pricelistsJson){if(!this.config.use_pricelist){this.config.use_pricelist=true;}
this.pricelists.push(...pricelistsJson);let message="";const pricelistsNames=pricelistsJson.map((pricelist)=>{return pricelist.display_name;});message=_t("%s fiscal position(s) added to the configuration.",pricelistsNames.join(", "));return message;}
async _addFiscalPositions(ordersJson){const fiscalPositionToGet=[];ordersJson.forEach((order)=>{let found=false;for(const fp of this.fiscal_positions){if(fp.id===order.fiscal_position_id){found=true;break;}}
if(!found&&order.fiscal_position_id){fiscalPositionToGet.push(order.fiscal_position_id);}});let message=null;if(fiscalPositionToGet.length>0){const fiscalPositionJson=await this._getFiscalPositionJson(fiscalPositionToGet);message=this._addPosFiscalPosition(fiscalPositionJson);}
return message;}
async _getFiscalPositionJson(fiscalPositionToGet){return await this.env.services.orm.call("pos.session","get_pos_ui_account_fiscal_positions_by_ids",[[odoo.pos_session_id],fiscalPositionToGet]);}
_addPosFiscalPosition(fiscalPositionJson){this.fiscal_positions.push(...fiscalPositionJson);let message="";const fiscalPositionNames=fiscalPositionJson.map((fp)=>{return fp.display_name;});message=_t("%s fiscal position(s) added to the configuration.",fiscalPositionNames.join(", "));return message;}
sortOrders(){this.orders.sort((a,b)=>(a.name>b.name?1:-1));}
async getProductInfo(product,quantity){const order=this.get_order();const productInfo=await this.orm.call("product.product","get_product_info_pos",[[product.id],product.get_price(order.pricelist,quantity),quantity,this.config.id,]);const priceWithoutTax=productInfo["all_prices"]["price_without_tax"];const margin=priceWithoutTax-product.standard_price;const orderPriceWithoutTax=order.get_total_without_tax();const orderCost=order.get_total_cost();const orderMargin=orderPriceWithoutTax-orderCost;const costCurrency=this.env.utils.formatCurrency(product.standard_price);const marginCurrency=this.env.utils.formatCurrency(margin);const marginPercent=priceWithoutTax?Math.round((margin/priceWithoutTax)*10000)/100:0;const orderPriceWithoutTaxCurrency=this.env.utils.formatCurrency(orderPriceWithoutTax);const orderCostCurrency=this.env.utils.formatCurrency(orderCost);const orderMarginCurrency=this.env.utils.formatCurrency(orderMargin);const orderMarginPercent=orderPriceWithoutTax?Math.round((orderMargin/orderPriceWithoutTax)*10000)/100:0;return{costCurrency,marginCurrency,marginPercent,orderPriceWithoutTaxCurrency,orderCostCurrency,orderMarginCurrency,orderMarginPercent,productInfo,};}
async getClosePosInfo(){return await this.orm.call("pos.session","get_closing_control_data",[[this.pos_session.id],]);}
set_start_order(){if(this.orders.length&&!this.selectedOrder){this.selectedOrder=this.orders[0];if(this.isOpenOrderShareable()){this.ordersToUpdateSet.add(this.orders[0]);}}else{this.add_new_order();}}
get_order(){return this.selectedOrder;}
set_order(order,options){if(this.selectedOrder){this.selectedOrder.firstDraft=false;this.selectedOrder.updateSavedQuantity();}
this.selectedOrder=order;}
get_order_list(){return this.orders;}
computePriceAfterFp(price,taxes){const order=this.get_order();if(order&&order.fiscal_position){const mapped_included_taxes=[];let new_included_taxes=[];taxes.forEach((tax)=>{const line_taxes=this.get_taxes_after_fp([tax.id],order.fiscal_position);if(line_taxes.length&&line_taxes[0].price_include){new_included_taxes=new_included_taxes.concat(line_taxes);}
if(tax.price_include&&!line_taxes.includes(tax)){mapped_included_taxes.push(tax);}});if(mapped_included_taxes.length>0){if(new_included_taxes.length>0){return price;}else{return this.compute_all(mapped_included_taxes,price,1,this.currency.rounding,true).total_excluded;}}}
return price;}
getTaxesByIds(taxIds){const taxes=[];for(let i=0;i<taxIds.length;i++){if(this.taxes_by_id[taxIds[i]]){taxes.push(this.taxes_by_id[taxIds[i]]);}}
return taxes;}
async customerDisplayHTML(closeUI=false){const order=this.get_order();if(closeUI||!order){return renderToString("point_of_sale.CustomerFacingDisplayNoOrder",{pos:this,origin:window.location.origin,});}
const orderLines=order.get_orderlines();const productImages=Object.fromEntries(await Promise.all(orderLines.map(async({product})=>[product.id,await getProductImage(product.id,product.writeDate),])));return renderToString("point_of_sale.CustomerFacingDisplayOrder",{pos:this,formatCurrency:this.env.utils.formatCurrency,origin:window.location.origin,order,productImages,});}
async push_orders_with_closing_popup(opts={}){try{await this.push_orders(opts);return true;}catch(error){console.warn(error);const reason=this.failed?_t('Some orders could not be submitted to '+'the server due to configuration errors. '+'You can exit the Point of Sale, but do '+'not close the session before the issue '+'has been resolved.'):_t('Some orders could not be submitted to '+'the server due to internet connection issues. '+'You can exit the Point of Sale, but do '+'not close the session before the issue '+'has been resolved.');await this.env.services.popup.add(ConfirmPopup,{title:_t('Offline Orders'),body:reason,});return false;}}
push_orders(opts={}){opts=Object.assign({printedOrders:true},opts);return this.pushOrderMutex.exec(()=>this._flush_orders(this.db.get_orders(),opts));}
push_single_order(order){const order_id=this.db.add_order(order.export_as_JSON());return this.pushOrderMutex.exec(()=>this._flush_orders([this.db.get_order(order_id)],order._getOrderOptions()));}
async _flush_orders(orders,options={}){try{const server_ids=await this._save_to_server(orders,options);for(let i=0;i<server_ids.length;i++){this.validated_orders_name_server_id_map[server_ids[i].pos_reference]=server_ids[i].id;}
return server_ids;}catch(error){if(!(error instanceof ConnectionLostError)&&!options.printedOrders){for(const order of orders){const reactiveOrder=this.orders.find((o)=>o.uid===order.id);reactiveOrder.finalized=false;this.db.remove_order(reactiveOrder.uid);this.db.save_unpaid_order(reactiveOrder);}
this.set_synch("connected");}
throw error;}finally{this._after_flush_orders(orders);}}
_after_flush_orders(orders){const refundedOrderIds=new Set();for(const order of orders){for(const line of order.data.lines){const refundDetail=this.toRefundLines[line[2].refunded_orderline_id];if(!refundDetail){continue;}
refundedOrderIds.add(refundDetail.orderline.orderBackendId);delete this.toRefundLines[refundDetail.orderline.id];}}
this._invalidateSyncedOrdersCache([...refundedOrderIds]);}
_invalidateSyncedOrdersCache(ids){for(const id of ids){delete this.TICKET_SCREEN_STATE.syncedOrders.cache[id];}}
set_synch(status,pending){if(["connected","connecting","error","disconnected"].indexOf(status)===-1){console.error(status," is not a known connection state.");}else if(status==="connected"){this.showOfflineWarning=true;}
pending=pending||this.db.get_orders().length+this.db.get_ids_to_remove_from_server().length;this.synch={status,pending};}
_getCreateOrderContext(orders,options){const orderContext=this.context||{};if(options.printedOrders!==undefined){orderContext.is_receipt_printed=options.printedOrders;}
return orderContext;}
async _save_to_server(orders,options){if(!orders||!orders.length){return Promise.resolve([]);}
this.set_synch("connecting",orders.length);options=options||{};var order_ids_to_sync=orders.map((o)=>o.id);for(const order of orders){order.to_invoice=options.to_invoice||false;}
const orm=options.to_invoice?this.orm:this.orm.silent;try{const serverIds=await orm.call("pos.order","create_from_ui",[orders,options.draft||false],{context:this._getCreateOrderContext(orders,options),});for(const serverId of serverIds){const order=this.env.services.pos.orders.find((order)=>order.name===serverId.pos_reference);if(order){order.server_id=serverId.id;}}
for(const order_id of order_ids_to_sync){this.db.remove_order(order_id);}
this.failed=false;this.set_synch("connected");return serverIds;}catch(error){console.warn("Failed to send orders:",orders);if(error.code===200){if((!this.failed||options.show_error)&&!options.to_invoice){this.failed=error;this.set_synch("error");throw error;}}
this.set_synch("disconnected");throw error;}}
export_paid_orders(){return JSON.stringify({paid_orders:this.db.get_orders(),session:this.pos_session.name,session_id:this.pos_session.id,date:new Date().toUTCString(),version:this.version.server_version_info,},null,2);}
export_unpaid_orders(){return JSON.stringify({unpaid_orders:this.db.get_unpaid_orders(),session:this.pos_session.name,session_id:this.pos_session.id,date:new Date().toUTCString(),version:this.version.server_version_info,},null,2);}
import_orders(str){var json=JSON.parse(str);var report={paid:0,unpaid:0,unpaid_skipped_existing:0,unpaid_skipped_session:0,unpaid_skipped_sessions:[],};if(json.paid_orders){for(var i=0;i<json.paid_orders.length;i++){this.db.add_order(json.paid_orders[i].data);}
report.paid=json.paid_orders.length;this.push_orders();}
if(json.unpaid_orders){var orders=[];var existing=this.get_order_list();var existing_uids={};var skipped_sessions={};for(i=0;i<existing.length;i++){existing_uids[existing[i].uid]=true;}
for(i=0;i<json.unpaid_orders.length;i++){var order=json.unpaid_orders[i];if(order.pos_session_id!==this.pos_session.id){report.unpaid_skipped_session+=1;skipped_sessions[order.pos_session_id]=true;}else if(existing_uids[order.uid]){report.unpaid_skipped_existing+=1;}else{orders.push(this.createReactiveOrder(order));}}
orders=orders.sort(function(a,b){return a.sequence_number-b.sequence_number;});if(orders.length){report.unpaid=orders.length;this.orders.add(orders);}
report.unpaid_skipped_sessions=Object.keys(skipped_sessions);}
return report;}
_load_orders(){var jsons=this.db.get_unpaid_orders();var orders=[];var not_loaded_count=0;for(var i=0;i<jsons.length;i++){var json=jsons[i];if(json.pos_session_id===this.pos_session.id){orders.push(this.createReactiveOrder(json));}else{not_loaded_count+=1;}}
if(not_loaded_count){console.info("There are "+
not_loaded_count+" locally saved unpaid orders belonging to another session");}
orders=orders.sort(function(a,b){return a.sequence_number-b.sequence_number;});if(orders.length){this.orders.add(orders);}}
_compute_all(tax,base_amount,quantity,price_exclude){if(price_exclude===undefined){var price_include=tax.price_include;}else{price_include=!price_exclude;}
if(tax.amount_type==="fixed"){if(base_amount){return Math.sign(base_amount)*Math.abs(quantity)*tax.amount;}else{return quantity*tax.amount;}}
if(tax.amount_type==="percent"&&!price_include){return(base_amount*tax.amount)/100;}
if(tax.amount_type==="percent"&&price_include){return base_amount-base_amount/(1+tax.amount/100);}
if(tax.amount_type==="division"&&!price_include){return base_amount/(1-tax.amount/100)-base_amount;}
if(tax.amount_type==="division"&&price_include){return base_amount-base_amount*(tax.amount/100);}
return false;}
compute_all(taxes,price_unit,quantity,currency_rounding,handle_price_include=true){var self=this;var _collect_taxes=function(taxes,all_taxes){taxes=[...taxes].sort(function(tax1,tax2){return tax1.sequence-tax2.sequence;});taxes.forEach((tax)=>{if(tax.amount_type==="group"){all_taxes=_collect_taxes(tax.children_tax_ids,all_taxes);}else{all_taxes.push(tax);}});return all_taxes;};var collect_taxes=function(taxes){return _collect_taxes(taxes,[]);};taxes=collect_taxes(taxes);const company=this.company;var round_tax=company.tax_calculation_rounding_method!="round_globally";var initial_currency_rounding=currency_rounding;if(!round_tax){currency_rounding=currency_rounding*0.00001;}
var recompute_base=function(base_amount,incl_tax_amounts){let fixed_amount=incl_tax_amounts.fixed_amount;let division_amount=0.0;for(const[,tax_factor]of incl_tax_amounts.division_taxes){division_amount+=tax_factor;}
let percent_amount=0.0;for(const[,tax_factor]of incl_tax_amounts.percent_taxes){percent_amount+=tax_factor;}
if(company.country&&company.country.code==="IN"){let total_tax_amount=0.0;for(const[i,tax_factor]of incl_tax_amounts.percent_taxes){const tax_amount=round_pr(base_amount*tax_factor/(100+percent_amount),currency_rounding);total_tax_amount+=tax_amount;cached_tax_amounts[i]=tax_amount;fixed_amount+=tax_amount;}
for(const[i,]of incl_tax_amounts.percent_taxes){cached_base_amounts[i]=base-total_tax_amount;}
percent_amount=0.0;}
Object.assign(incl_tax_amounts,{percent_taxes:[],division_taxes:[],fixed_amount:0.0,});return((((base_amount-fixed_amount)/(1.0+percent_amount/100.0))*(100-division_amount))/100);};var base=round_pr(price_unit*quantity,initial_currency_rounding);var sign=1;if(base<0){base=-base;sign=-1;}
var total_included_checkpoints={};var i=taxes.length-1;var store_included_tax_total=true;const incl_tax_amounts={percent_taxes:[],division_taxes:[],fixed_amount:0.0,};var cached_tax_amounts={};var cached_base_amounts={};let is_base_affected=true;if(handle_price_include){taxes.reverse().forEach(function(tax){if(tax.include_base_amount&&is_base_affected){base=recompute_base(base,incl_tax_amounts);store_included_tax_total=true;}
if(tax.price_include){if(tax.amount_type==="percent"){incl_tax_amounts.percent_taxes.push([i,tax.amount*tax.sum_repartition_factor,]);}else if(tax.amount_type==="division"){incl_tax_amounts.division_taxes.push([i,tax.amount*tax.sum_repartition_factor,]);}else if(tax.amount_type==="fixed"){incl_tax_amounts.fixed_amount+=Math.abs(quantity)*tax.amount*tax.sum_repartition_factor;}else{var tax_amount=self._compute_all(tax,base,quantity);incl_tax_amounts.fixed_amount+=tax_amount;cached_tax_amounts[i]=tax_amount;}
if(store_included_tax_total){total_included_checkpoints[i]=base;store_included_tax_total=false;}}
i-=1;is_base_affected=tax.is_base_affected;});}
var total_excluded=round_pr(recompute_base(base,incl_tax_amounts),initial_currency_rounding);var total_included=total_excluded;base=total_excluded;var skip_checkpoint=false;var taxes_vals=[];i=0;var cumulated_tax_included_amount=0;taxes.reverse().forEach(function(tax){if(tax.price_include&&i in cached_base_amounts){var tax_base_amount=cached_base_amounts[i];}else if(tax.price_include||tax.is_base_affected){var tax_base_amount=base;}else{tax_base_amount=total_excluded;}
if(tax.price_include&&cached_tax_amounts.hasOwnProperty(i)){var tax_amount=cached_tax_amounts[i];}else if(!skip_checkpoint&&tax.price_include&&total_included_checkpoints[i]!==undefined){var tax_amount=total_included_checkpoints[i]-(base+cumulated_tax_included_amount);cumulated_tax_included_amount=0;}else{var tax_amount=self._compute_all(tax,tax_base_amount,quantity,true);}
tax_amount=round_pr(tax_amount,currency_rounding);var factorized_tax_amount=round_pr(tax_amount*tax.sum_repartition_factor,currency_rounding);if(tax.price_include&&total_included_checkpoints[i]===undefined){cumulated_tax_included_amount+=factorized_tax_amount;}
taxes_vals.push({id:tax.id,name:tax.name,amount:sign*factorized_tax_amount,base:sign*round_pr(tax_base_amount,currency_rounding),});if(tax.include_base_amount){base+=factorized_tax_amount;if(!tax.price_include){skip_checkpoint=true;}}
total_included+=factorized_tax_amount;i+=1;});return{taxes:taxes_vals,total_excluded:sign*round_pr(total_excluded,this.currency.rounding),total_included:sign*round_pr(total_included,this.currency.rounding),};}
get_taxes_after_fp(taxIds,fpos){if(!fpos){return taxIds.map((taxId)=>this.taxes_by_id[taxId]);}
const mappedTaxes=[];for(const taxId of taxIds){const tax=this.taxes_by_id[taxId];if(tax){const taxMaps=Object.values(fpos.fiscal_position_taxes_by_id).filter((fposTax)=>fposTax.tax_src_id[0]===tax.id);if(taxMaps.length){for(const taxMap of taxMaps){if(taxMap.tax_dest_id){const mappedTax=this.taxes_by_id[taxMap.tax_dest_id[0]];if(mappedTax){mappedTaxes.push(mappedTax);}}}}else{mappedTaxes.push(tax);}}}
return uniqueBy(mappedTaxes,(tax)=>tax.id);}
getPendingPaymentLine(terminalName){return this.get_order().paymentlines.find((paymentLine)=>paymentLine.payment_method.use_payment_terminal===terminalName&&!paymentLine.is_done());}
_trigger_up(ev){if(ev.is_stopped()){return;}
const payload=ev.data;if(ev.name==="call_service"){const service=this.env.services[payload.service];const result=service[payload.method].apply(service,ev.data.args||[]);payload.callback(result);}}
isProductQtyZero(qty){return floatIsZero(qty,this.dp["Product Unit of Measure"]);}
disallowLineQuantityChange(){return false;}
disallowLineDiscountChange(){return false;}
getCurrencySymbol(){return this.currency?this.currency.symbol:"$";}
async _addProducts(ids,setAvailable=true){if(setAvailable){await this.orm.write("product.product",ids,{available_in_pos:true});}
const product=await this.orm.call("pos.session","get_pos_ui_product_product_by_params",[odoo.pos_session_id,{domain:[["id","in",ids]]},]);await this._loadMissingPricelistItems(product);this._loadProductProduct(product);}
isOpenOrderShareable(){return this.config.trusted_config_ids.length>0;}
switchPane(){this.mobile_pane=this.mobile_pane==="left"?"right":"left";}
switchPaneTicketScreen(){this.ticket_screen_mobile_pane=this.ticket_screen_mobile_pane==="left"?"right":"left";}
async logEmployeeMessage(action,message){await this.orm.call("pos.session","log_partner_message",[this.pos_session.id,this.user.partner_id.id,action,message,]);}
showScreen(name,props){const component=registry.category("pos_screens").get(name);this.mainScreen={component,props};if(component.storeOnOrder??true){this.get_order()?.set_screen_data({name,props});}}
async sendOrderInPreparation(order,cancelled=false){if(this.printers_category_ids_set.size){try{const changes=order.changesToOrder(cancelled);if(changes.cancelled.length>0||changes.new.length>0){const isPrintSuccessful=await order.printChanges(cancelled);if(!isPrintSuccessful){this.popup.add(ErrorPopup,{title:_t("Printing failed"),body:_t("Failed in printing the changes in the order"),});}}}catch(e){console.warn("Failed in printing the changes in the order",e);}}}
async sendOrderInPreparationUpdateLastChange(order,cancelled=false){await this.sendOrderInPreparation(order,cancelled);order.updateLastOrderChange();order.save_to_db();order.pos.ordersToUpdateSet.add(order);await order.pos.sendDraftToServer();}
closeScreen(){this.addOrderIfEmpty();const{name:screenName}=this.get_order().get_screen_data();this.showScreen(screenName);}
addOrderIfEmpty(){if(!this.get_order()){this.add_new_order();}}
connectToProxy(){return new Promise((resolve,reject)=>{this.barcodeReader?.disconnectFromProxy();this.loadingSkipButtonIsShown=true;this.hardwareProxy.autoconnect({force_ip:this.config.proxy_ip}).then(()=>{if(this.config.iface_scan_via_proxy){this.barcodeReader?.connectToProxy();}
resolve();},(statusText,url)=>{if(statusText=="error"&&window.location.protocol=="https:"){reject({title:_t("HTTPS connection to IoT Box failed"),body:_t("Make sure you are using IoT Box v18.12 or higher. Navigate to %s to accept the certificate of your IoT Box.",url),popup:"alert",});}else{resolve();}});});}
async closePos(){const customerDisplayService=this.env.services.customer_display;if(customerDisplayService){customerDisplayService.update({closeUI:true});}
if(!this||this.db.get_orders().length===0){this.redirectToBackend();}
const syncSuccess=await this.push_orders_with_closing_popup();if(syncSuccess){this.redirectToBackend();}}
async selectPartner(){const currentOrder=this.get_order();if(!currentOrder){return;}
const currentPartner=currentOrder.get_partner();if(currentPartner&&currentOrder.getHasRefundLines()){this.popup.add(ErrorPopup,{title:_t("Can't change customer"),body:_t("This order already has refund lines for %s. We can't change the customer associated to it. Create a new order for the new customer.",currentPartner.name),});return;}
const{confirmed,payload:newPartner}=await this.showTempScreen("PartnerListScreen",{partner:currentPartner,});if(confirmed){currentOrder.set_partner(newPartner);}}
async addProductFromUi(product,options){return this.get_order().add_product(product,options);}
async addProductToCurrentOrder(product,options={}){if(Number.isInteger(product)){product=this.db.get_product_by_id(product);}
this.get_order()||this.add_new_order();options={...options,...(await product.getAddProductOptions())};if(!Object.keys(options).length){return;}
await this.addProductFromUi(product,options);this.numberBuffer.reset();}
async getEditedPackLotLines(isAllowOnlyOneLot,packLotLinesToEdit,productName){const{confirmed,payload}=await this.env.services.popup.add(EditListPopup,{title:_t("Lot/Serial Number(s) Required"),name:productName,isSingleItem:isAllowOnlyOneLot,array:packLotLinesToEdit,});if(!confirmed){return;}
const modifiedPackLotLines=Object.fromEntries(payload.newArray.filter((item)=>item.id).map((item)=>[item.id,item.text]));const newPackLotLines=payload.newArray.filter((item)=>!item.id).map((item)=>({lot_name:item.text}));return{modifiedPackLotLines,newPackLotLines};}
showTempScreen(name,props={}){return new Promise((resolve)=>{this.tempScreen={name,component:registry.category("pos_screens").get(name),props:{...props,resolve},};this.tempScreenIsShown=true;});}
closeTempScreen(){this.tempScreenIsShown=false;this.tempScreen=null;}
openCashControl(){if(this.shouldShowCashControl()){this.popup.add(CashOpeningPopup);}}
shouldShowCashControl(){return this.config.cash_control&&this.pos_session.state=="opening_control";}
preloadImages(){for(const product of this.db.get_product_by_category(0)){const image=new Image();image.src=`/web/image?model=product.product&field=image_128&id=${product.id}&unique=${product.write_date}`;}
for(const category of Object.values(this.db.category_by_id)){if(category.id==0){continue;}
const image=new Image();image.src=`/web/image?model=pos.category&field=image_128&id=${category.id}&unique=${category.write_date}`;}}
closeOtherTabs(){localStorage["message"]="";localStorage["message"]=JSON.stringify({message:"close_tabs",session:this.pos_session.id,});window.addEventListener("storage",(event)=>{if(event.key==="message"&&event.newValue){const msg=JSON.parse(event.newValue);if(msg.message==="close_tabs"&&msg.session==this.pos_session.id){console.info("POS / Session opened in another window. EXITING POS");this.closePos();}}},false);}
showBackButton(){return(this.mainScreen.component===PaymentScreen||(this.mainScreen.component===ProductScreen&&this.mobile_pane=="left")||this.mainScreen.component===TicketScreen);}
doNotAllowRefundAndSales(){return false;}
getReceiptHeaderData(order){return{company:this.company,cashier:this.get_cashier()?.name,header:this.config.receipt_header,};}
isChildPartner(partner){return partner.parent_name;}
redirectToBackend(){window.location="/web#action=point_of_sale.action_client_pos_menu";}
resetProductScreenSearch(){this.searchProductWord="";const{start_category,iface_start_categ_id}=this.config;this.selectedCategoryId=(start_category&&iface_start_categ_id?.[0])||0;}}
PosStore.prototype.electronic_payment_interfaces={};__exports.register_payment_method=register_payment_method;function register_payment_method(use_payment_terminal,ImplementedPaymentInterface){PosStore.prototype.electronic_payment_interfaces[use_payment_terminal]=ImplementedPaymentInterface;}
const posService=__exports.posService={dependencies:PosStore.serviceDependencies,async start(env,deps){return new PosStore(env,deps).ready;},};registry.category("services").add("pos",posService);return __exports;});;

/* /point_of_sale/static/src/app/store/product_configurator_popup/product_configurator_popup.js */
odoo.define('@point_of_sale/app/store/product_configurator_popup/product_configurator_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@odoo/owl','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{Component,onMounted,useRef,useState,useSubEnv}=require("@odoo/owl");const{useService}=require("@web/core/utils/hooks");const BaseProductAttribute=__exports.BaseProductAttribute=class BaseProductAttribute extends Component{setup(){this.env.attribute_components.push(this);this.attribute=this.props.attribute;this.values=this.attribute.values;this.state=useState({attribute_value_ids:parseFloat(this.values[0].id),custom_value:"",});}
getValue(){const attribute_value_ids=this.attribute.display_type==="multi"?this.values.filter((val)=>this.state.attribute_value_ids[val.id]):[this.values.find((val)=>val.id===parseInt(this.state.attribute_value_ids))];const extra=attribute_value_ids.reduce((acc,val)=>acc+val.price_extra,0);const valueIds=attribute_value_ids.map((val)=>val.id);const value=attribute_value_ids.map((val)=>{if(val.is_custom&&this.state.custom_value){return`${val.name}: ${this.state.custom_value}`;}
return val.name;}).join(", ");return{value,valueIds,custom_value:this.state.custom_value,extra,};}
getFormatPriceExtra(val){const sign=val<0?"- ":"+ ";return sign+this.env.utils.formatCurrency(Math.abs(val));}}
const RadioProductAttribute=__exports.RadioProductAttribute=class RadioProductAttribute extends BaseProductAttribute{static template="point_of_sale.RadioProductAttribute";setup(){super.setup();this.root=useRef("root");onMounted(this.onMounted);}
onMounted(){this.root.el.querySelector("input[type=radio]").checked=true;}}
const PillsProductAttribute=__exports.PillsProductAttribute=class PillsProductAttribute extends BaseProductAttribute{static template="point_of_sale.PillsProductAttribute";}
const SelectProductAttribute=__exports.SelectProductAttribute=class SelectProductAttribute extends BaseProductAttribute{static template="point_of_sale.SelectProductAttribute";}
const ColorProductAttribute=__exports.ColorProductAttribute=class ColorProductAttribute extends BaseProductAttribute{static template="point_of_sale.ColorProductAttribute";}
const MultiProductAttribute=__exports.MultiProductAttribute=class MultiProductAttribute extends BaseProductAttribute{static template="point_of_sale.MultiProductAttribute";setup(){super.setup();this.state=useState({attribute_value_ids:{},custom_value:"",});this.initAttribute();}
initAttribute(){const attribute=this.props.attribute;for(const value of attribute.values){this.state.attribute_value_ids[value.id]=false;}}}
const ProductConfiguratorPopup=__exports.ProductConfiguratorPopup=class ProductConfiguratorPopup extends AbstractAwaitablePopup{static template="point_of_sale.ProductConfiguratorPopup";static components={RadioProductAttribute,PillsProductAttribute,SelectProductAttribute,ColorProductAttribute,MultiProductAttribute,};setup(){super.setup();useSubEnv({attribute_components:[]});this.state=useState({quantity:this.props.quantity||1,});this.ui=useService("ui");}
getPayload(){const attribute_custom_values=[];let attribute_value_ids=[];var price_extra=0.0;const quantity=this.state.quantity;this.env.attribute_components.forEach((attribute_component)=>{const{valueIds,extra,custom_value}=attribute_component.getValue();attribute_value_ids.push(valueIds);if(custom_value){attribute_custom_values[valueIds[0]]=custom_value;}
price_extra+=extra;});attribute_value_ids=attribute_value_ids.flat();return{attribute_value_ids,attribute_custom_values,price_extra,quantity,};}
get imageUrl(){const product=this.props.product;return`/web/image?model=product.product&field=image_128&id=${product.id}&unique=${product.write_date}`;}
get unitPrice(){return this.env.utils.formatCurrency(this.props.product.lst_price);}
addOneQuantity(){++this.state.quantity;}
removeOneQuantity(){if(this.state.quantity==1){return;}
--this.state.quantity;}}
return __exports;});;

/* /point_of_sale/static/src/app/store/select_lot_popup/edit_list_input/edit_list_input.js */
odoo.define('@point_of_sale/app/store/select_lot_popup/edit_list_input/edit_list_input',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const EditListInput=__exports.EditListInput=class EditListInput extends Component{static template="point_of_sale.EditListInput";onKeyup(event){if(event.key==="Enter"&&event.target.value.trim()!==""){this.props.createNewItem();}}
onInput(event){this.props.onInputChange(this.props.item._id,event.target.value);}}
return __exports;});;

/* /point_of_sale/static/src/app/store/select_lot_popup/select_lot_popup.js */
odoo.define('@point_of_sale/app/store/select_lot_popup/select_lot_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@point_of_sale/app/utils/hooks','@web/core/l10n/translation','@odoo/owl','@point_of_sale/app/store/select_lot_popup/edit_list_input/edit_list_input'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{useAutoFocusToLast}=require("@point_of_sale/app/utils/hooks");const{_t}=require("@web/core/l10n/translation");const{useState}=require("@odoo/owl");const{EditListInput}=require("@point_of_sale/app/store/select_lot_popup/edit_list_input/edit_list_input");const EditListPopup=__exports.EditListPopup=class EditListPopup extends AbstractAwaitablePopup{static components={EditListInput};static template="point_of_sale.EditListPopup";static defaultProps={confirmText:_t("Add"),cancelText:_t("Discard"),array:[],isSingleItem:false,};setup(){super.setup();this._id=0;this.state=useState({array:this._initialize(this.props.array)});useAutoFocusToLast();}
_nextId(){return this._id++;}
_emptyItem(){return{text:"",_id:this._nextId(),};}
_initialize(array){if(array.length===0){return[this._emptyItem()];}
return array.map((item)=>Object.assign({},{_id:this._nextId()},typeof item==="object"?item:{text:item}));}
_hasMoreThanOneItem(){return this.state.array.length>1;}
removeItem(itemId){this.state.array.splice(this.state.array.findIndex((item)=>item._id==itemId),1);}
onInputChange(itemId,text){const item=this.state.array.find((elem)=>elem._id===itemId);item.text=text;}
createNewItem(){if(this.props.isSingleItem){return;}
this.state.array.push(this._emptyItem());}
getPayload(){return{newArray:this.state.array.filter((item)=>item.text.trim()!=="").map((item)=>Object.assign({},item)),};}}
return __exports;});;

/* /point_of_sale/static/src/app/utils/confirm_popup/confirm_popup.js */
odoo.define('@point_of_sale/app/utils/confirm_popup/confirm_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{_t}=require("@web/core/l10n/translation");const ConfirmPopup=__exports.ConfirmPopup=class ConfirmPopup extends AbstractAwaitablePopup{static template="point_of_sale.ConfirmPopup";static defaultProps={confirmText:_t("Ok"),cancelText:_t("Cancel"),title:_t("Confirm?"),body:"",};}
return __exports;});;

/* /point_of_sale/static/src/app/utils/contextual_utils_service.js */
odoo.define('@point_of_sale/app/utils/contextual_utils_service',['@web/views/fields/formatters','@web/core/utils/numbers','@web/core/utils/strings','@web/core/registry','@web/views/fields/parsers'],function(require){'use strict';let __exports={};const{formatMonetary}=require("@web/views/fields/formatters");const{formatFloat,roundDecimals,floatIsZero:genericFloatIsZero,}=require("@web/core/utils/numbers");const{escapeRegExp}=require("@web/core/utils/strings");const{registry}=require("@web/core/registry");const{parseFloat}=require("@web/views/fields/parsers");const contextualUtilsService=__exports.contextualUtilsService={dependencies:["pos","localization"],start(env,{pos,localization}){const currency=pos.currency;const productUoMDecimals=pos.dp["Product Unit of Measure"];const decimalPoint=localization.decimalPoint;const thousandsSep=localization.thousandsSep;const escapedDecimalPoint=escapeRegExp(decimalPoint);let floatRegex;if(thousandsSep){const escapedThousandsSep=escapeRegExp(thousandsSep);floatRegex=new RegExp(`^-?(?:\\d+(${escapedThousandsSep}\\d+)*)?(?:${escapedDecimalPoint}\\d*)?$`);}else{floatRegex=new RegExp(`^-?(?:\\d+)?(?:${escapedDecimalPoint}\\d*)?$`);}
const formatProductQty=(qty)=>{return formatFloat(qty,{digits:[true,productUoMDecimals]});};const formatStrCurrency=(valueStr,hasSymbol=true)=>{return formatCurrency(parseFloat(valueStr),hasSymbol);};const formatCurrency=(value,hasSymbol=true)=>{return formatMonetary(value,{currencyId:currency.id,noSymbol:!hasSymbol,});};const floatIsZero=(value)=>{return genericFloatIsZero(value,currency.decimal_places);};const roundCurrency=(value)=>{return roundDecimals(value,currency.decimal_places);};const isValidFloat=(inputValue)=>{return![decimalPoint,"-"].includes(inputValue)&&floatRegex.test(inputValue);};env.utils={formatCurrency,formatStrCurrency,roundCurrency,formatProductQty,isValidFloat,floatIsZero,};},};registry.category("services").add("contextual_utils_service",contextualUtilsService);return __exports;});;

/* /point_of_sale/static/src/app/utils/control_buttons_mixin.js */
odoo.define('@point_of_sale/app/utils/control_buttons_mixin',[],function(require){'use strict';let __exports={};const ControlButtonsMixin=__exports.ControlButtonsMixin=(x)=>{const controlButtonsToPosition=[];const orderedControlButtons=[];let sortedControlButtons=[];class Extended extends x{get controlButtons(){return sortedControlButtons.filter((cb)=>{return cb.condition?cb.condition.bind(this)():true;}).map((cb)=>Object.assign({},cb,{component:cb.component}));}}
Extended.addControlButton=function(controlButton){if(!controlButton.name){controlButton.name=controlButton.component.name;}
if(!controlButton.position){orderedControlButtons.push(controlButton);}else{controlButtonsToPosition.push(controlButton);}
Extended.sortControlButtons();};Extended.sortControlButtons=function(){sortedControlButtons=[...orderedControlButtons];function setControlButton(locator,index,cb){if(locator=="replace"){sortedControlButtons[index]=cb;}else if(locator=="before"){sortedControlButtons.splice(index,0,cb);}else if(locator=="after"){sortedControlButtons.splice(index+1,0,cb);}}
function locate(cb){const[locator,reference]=cb.position;const index=sortedControlButtons.findIndex((cb)=>cb.name==reference);return[locator,index];}
const cbMissingReference=[];for(const cb of controlButtonsToPosition){const[locator,index]=locate(cb);if(index==-1){cbMissingReference.push(cb);continue;}
setControlButton(locator,index,cb);}
for(const cb of cbMissingReference.reverse()){const[locator,index]=locate(cb);if(index==-1){sortedControlButtons.push(cb);}else{setControlButton(locator,index,cb);}}};return Extended;};return __exports;});;

/* /point_of_sale/static/src/app/utils/date_picker_popup/date_picker_popup.js */
odoo.define('@point_of_sale/app/utils/date_picker_popup/date_picker_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@web/core/l10n/translation','@odoo/owl'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{_t}=require("@web/core/l10n/translation");const{onMounted,useRef,useState}=require("@odoo/owl");const DatePickerPopup=__exports.DatePickerPopup=class DatePickerPopup extends AbstractAwaitablePopup{static template="point_of_sale.DatePickerPopup";static defaultProps={confirmText:_t("Confirm"),cancelText:_t("Discard"),title:_t("DatePicker"),};setup(){super.setup();this.state=useState({shippingDate:this._today()});this.inputRef=useRef("input");onMounted(()=>this.inputRef.el.focus());}
getPayload(){return this.state.shippingDate<this._today()?this._today():this.state.shippingDate;}
_today(){return new Date().toISOString().split("T")[0];}}
return __exports;});;

/* /point_of_sale/static/src/app/utils/hooks.js */
odoo.define('@point_of_sale/app/utils/hooks',['@web/core/l10n/translation','@point_of_sale/app/errors/popups/offline_error_popup','@point_of_sale/app/utils/confirm_popup/confirm_popup','@point_of_sale/app/errors/popups/error_traceback_popup','@point_of_sale/app/errors/popups/error_popup','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{OfflineErrorPopup}=require("@point_of_sale/app/errors/popups/offline_error_popup");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{ErrorTracebackPopup}=require("@point_of_sale/app/errors/popups/error_traceback_popup");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{useEnv,onMounted,onPatched,useComponent,useRef}=require("@odoo/owl");__exports.useErrorHandlers=useErrorHandlers;function useErrorHandlers(){const component=useComponent();const popup=useEnv().services.popup;component._handlePushOrderError=async function(error){if(error.message==="Backend Invoice"){await popup.add(ConfirmPopup,{title:_t("Please print the invoice from the backend"),body:_t("The order has been synchronized earlier. Please make the invoice from the backend for the order: ")+error.data.order.name,});}else if(error.code<0){const title=_t("Unable to sync order");const body=_t("Check the internet connection then try to sync again by clicking on the red wifi button (upper right of the screen).");await popup.add(OfflineErrorPopup,{title,body});}else if(error.code===200){await popup.add(ErrorTracebackPopup,{title:error.data.message||_t("Server Error"),body:error.data.debug||_t("The server encountered an error while receiving your order."),});}else{await popup.add(ErrorPopup,{title:_t("Unknown Error"),body:_t("The order could not be sent to the server due to an unknown error"),});}};}
__exports.useAutoFocusToLast=useAutoFocusToLast;function useAutoFocusToLast(){const root=useRef("root");let target=null;function autofocus(){const prevTarget=target;const allInputs=root.el.querySelectorAll("input");target=allInputs[allInputs.length-1];if(target&&target!==prevTarget){target.focus();target.selectionStart=target.selectionEnd=target.value.length;}}
onMounted(autofocus);onPatched(autofocus);}
__exports.useAsyncLockedMethod=useAsyncLockedMethod;function useAsyncLockedMethod(method){const component=useComponent();let called=false;return async(...args)=>{if(called){return;}
try{called=true;await method.call(component,...args);}finally{called=false;}};}
return __exports;});;

/* /point_of_sale/static/src/app/utils/input_popups/number_popup.js */
odoo.define('@point_of_sale/app/utils/input_popups/number_popup',['@web/core/l10n/translation','@point_of_sale/app/popup/abstract_awaitable_popup','@web/core/utils/hooks','@odoo/owl','@point_of_sale/app/generic_components/numpad/numpad'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{useService}=require("@web/core/utils/hooks");const{useState,useRef,onMounted}=require("@odoo/owl");const{Numpad}=require("@point_of_sale/app/generic_components/numpad/numpad");const NumberPopup=__exports.NumberPopup=class NumberPopup extends AbstractAwaitablePopup{static template="point_of_sale.NumberPopup";static components={Numpad};static defaultProps={confirmText:_t("Confirm"),cancelText:_t("Discard"),title:_t("Confirm?"),subtitle:"",body:"",cheap:false,startingValue:null,isPassword:false,nbrDecimal:0,inputSuffix:"",getInputBufferReminder:()=>false,};setup(){super.setup();let startingBuffer="";let startingPayload=null;if(typeof this.props.startingValue==="number"&&this.props.startingValue>0){startingBuffer=this.props.startingValue.toFixed(this.props.nbrDecimal).toString().replace(".",this.decimalSeparator);startingPayload=this.props.startingValue.toFixed(this.props.nbrDecimal);}
this.state=useState({buffer:startingBuffer,toStartOver:this.props.isInputSelected,payload:startingPayload,});this.numberBuffer=useService("number_buffer");this.numberBuffer.use({triggerAtEnter:()=>this.confirm(),triggerAtEscape:()=>this.cancel(),state:this.state,});this.inputRef=useRef("input");onMounted(this.onMounted);}
onMounted(){if(this.inputRef.el){this.inputRef.el.focus();}}
get decimalSeparator(){return this.env.services.localization.decimalPoint;}
getNumpadButtons(){const{isPassword,cheap}=this.props;return[{value:"1"},{value:"2"},{value:"3"},...(!isPassword?[{value:cheap?"+1":"+10"}]:[]),{value:"4"},{value:"5"},{value:"6"},...(!isPassword?[{value:cheap?"+2":"+20"}]:[]),{value:"7"},{value:"8"},{value:"9"},...(!isPassword?[{value:"-"}]:[]),{value:"Delete",text:"C"},{value:"0"},...(!isPassword?[{value:this.decimalSeparator}]:[]),{value:"Backspace",text:""},];}
get inputBuffer(){if(this.state.buffer===null){return"";}
if(this.props.isPassword){return this.state.buffer.replace(/./g,"");}else{return this.state.buffer;}}
confirm(event){if(this.numberBuffer.get()||this.state.payload){super.confirm();}}
getPayload(){let startingPayload=null;if(typeof this.props.startingValue==="number"&&this.props.startingValue>0){startingPayload=this.props.startingValue.toFixed(this.props.nbrDecimal);}
if(this.state.payload!=startingPayload){return this.state.payload;}
return this.numberBuffer.get();}
isMobile(){return window.innerWidth<=768;}}
return __exports;});;

/* /point_of_sale/static/src/app/utils/input_popups/selection_popup.js */
odoo.define('@point_of_sale/app/utils/input_popups/selection_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@web/core/l10n/translation','@odoo/owl'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{_t}=require("@web/core/l10n/translation");const{useState}=require("@odoo/owl");const SelectionPopup=__exports.SelectionPopup=class SelectionPopup extends AbstractAwaitablePopup{static template="point_of_sale.SelectionPopup";static defaultProps={cancelText:_t("Cancel"),title:_t("Select"),body:"",list:[],confirmKey:false,};setup(){super.setup();this.state=useState({selectedId:this.props.list.find((item)=>item.isSelected)});}
selectItem(itemId){this.state.selectedId=itemId;this.confirm();}
getPayload(){const selected=this.props.list.find((item)=>this.state.selectedId===item.id);return selected&&selected.item;}}
return __exports;});;

/* /point_of_sale/static/src/app/utils/input_popups/text_input_popup.js */
odoo.define('@point_of_sale/app/utils/input_popups/text_input_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@web/core/l10n/translation','@odoo/owl'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{_t}=require("@web/core/l10n/translation");const{onMounted,useRef,useState}=require("@odoo/owl");const TextInputPopup=__exports.TextInputPopup=class TextInputPopup extends AbstractAwaitablePopup{static template="point_of_sale.TextInputPopup";static defaultProps={confirmText:_t("Confirm"),cancelText:_t("Discard"),confirmKey:"Enter",title:"",body:"",startingValue:"",placeholder:"",};setup(){super.setup();this.state=useState({inputValue:this.props.startingValue});this.inputRef=useRef("input");onMounted(this.onMounted);}
_onWindowKeyup(event){if(event.key===this.props.confirmKey){this.confirm();}else{super._onWindowKeyup(...arguments);}}
onMounted(){this.inputRef.el.focus();}
getPayload(){return this.state.inputValue;}}
return __exports;});;

/* /point_of_sale/static/src/app/utils/input_popups/textarea_popup.js */
odoo.define('@point_of_sale/app/utils/input_popups/textarea_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@web/core/l10n/translation','@odoo/owl'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{_t}=require("@web/core/l10n/translation");const{onMounted,useRef,useState}=require("@odoo/owl");const TextAreaPopup=__exports.TextAreaPopup=class TextAreaPopup extends AbstractAwaitablePopup{static template="point_of_sale.TextAreaPopup";static defaultProps={confirmText:_t("Add"),cancelText:_t("Discard"),title:"",body:"",};setup(){super.setup();this.state=useState({inputValue:this.props.startingValue});this.inputRef=useRef("input");onMounted(this.onMounted);}
onMounted(){this.inputRef.el.focus();}
getPayload(){return this.state.inputValue;}}
return __exports;});;

/* /point_of_sale/static/src/app/utils/money_details_popup/money_details_popup.js */
odoo.define('@point_of_sale/app/utils/money_details_popup/money_details_popup',['@point_of_sale/app/popup/abstract_awaitable_popup','@odoo/owl','@point_of_sale/app/store/pos_hook','@web/core/utils/numbers','@point_of_sale/app/generic_components/inputs/numeric_input/numeric_input'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const{useState}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{floatIsZero}=require("@web/core/utils/numbers");const{NumericInput}=require("@point_of_sale/app/generic_components/inputs/numeric_input/numeric_input");const MoneyDetailsPopup=__exports.MoneyDetailsPopup=class MoneyDetailsPopup extends AbstractAwaitablePopup{static template="point_of_sale.MoneyDetailsPopup";static components={NumericInput};setup(){super.setup();this.pos=usePos();this.currency=this.pos.currency;this.state=useState({moneyDetails:this.props.moneyDetails?{...this.props.moneyDetails}:Object.fromEntries(this.pos.bills.map((bill)=>[bill.value,0])),});}
computeTotal(moneyDetails=this.state.moneyDetails){return Object.entries(moneyDetails).reduce((total,[value,inputQty])=>{const quantity=isNaN(inputQty)?0:inputQty;return total+parseFloat(value)*quantity;},0);}
async getPayload(){let moneyDetailsNotes=!floatIsZero(this.computeTotal(),this.currency.decimal_places)?"Money details: \n":null;this.pos.bills.forEach((bill)=>{if(this.state.moneyDetails[bill.value]){moneyDetailsNotes+=`  - ${
                    this.state.moneyDetails[bill.value]
                } x ${this.env.utils.formatCurrency(bill.value)}\n`;}});return{total:this.computeTotal(),moneyDetailsNotes,moneyDetails:{...this.state.moneyDetails},action:this.props.action,};}
async cancel(){super.cancel();if(this.pos.config.iface_cashdrawer&&this.pos.hardwareProxy.connectionInfo.status==="connected"){this.pos.logEmployeeMessage(this.props.action,"ACTION_CANCELLED");}}
_parseFloat(value){return parseFloat(value);}}
return __exports;});;

/* /point_of_sale/static/src/app/utils/movable_hook.js */
odoo.define('@point_of_sale/app/utils/movable_hook',['@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{useRefListener}=require("@web/core/utils/hooks");const{onWillUnmount}=require("@odoo/owl");__exports.constrain=constrain;function constrain(num,min,max){return Math.min(Math.max(num,min),max);}
__exports.getLimits=getLimits;function getLimits(el,limitEl){const{width,height}=el.getBoundingClientRect();const limitRect=limitEl.getBoundingClientRect();const offsetParentRect=el.offsetParent.getBoundingClientRect();return{minX:limitRect.left-offsetParentRect.left,maxX:limitRect.left-offsetParentRect.left+limitRect.width-width,minY:limitRect.top-offsetParentRect.top,maxY:limitRect.top-offsetParentRect.top+limitRect.height-height,};}
__exports.useMovable=useMovable;function useMovable({ref,onMoveStart,onMove}){let startPosition;function registerMovingMethod({startEv,moveEv,endEv,getPos}){const moveHandler=(ev)=>{const{x,y}=getPos(ev);onMove({dx:x-startPosition.x,dy:y-startPosition.y});};useRefListener(ref,startEv,(ev)=>{ev.stopImmediatePropagation();startPosition=getPos(ev);onMoveStart();document.addEventListener(moveEv,moveHandler);document.addEventListener(endEv,()=>document.removeEventListener(moveEv,moveHandler),{once:true,capture:true});});onWillUnmount(()=>document.removeEventListener(moveEv,moveHandler));}
registerMovingMethod({startEv:"mousedown",moveEv:"mousemove",endEv:"mouseup",getPos:(ev)=>({x:ev.clientX,y:ev.clientY}),});registerMovingMethod({startEv:"touchstart",moveEv:"touchmove",endEv:"touchend",getPos:(ev)=>({x:ev.touches[0].clientX,y:ev.touches[0].clientY}),});}
return __exports;});;

/* /point_of_sale/static/src/app/utils/number_buffer_service.js */
odoo.define('@point_of_sale/app/utils/number_buffer_service',['@web/views/fields/parsers','@barcodes/barcode_service','@web/core/registry','@odoo/owl'],function(require){'use strict';let __exports={};const{parseFloat:oParseFloat}=require("@web/views/fields/parsers");const{barcodeService}=require("@barcodes/barcode_service");const{registry}=require("@web/core/registry");const{EventBus,onWillDestroy,useComponent}=require("@odoo/owl");const INPUT_KEYS=new Set(["Delete","Backspace","+1","+2","+5","+10","+20","+50"].concat("0123456789+-.,".split("")));const CONTROL_KEYS=new Set(["Enter","Esc"]);const ALLOWED_KEYS=new Set([...INPUT_KEYS,...CONTROL_KEYS]);const getDefaultConfig=()=>({decimalPoint:false,triggerAtEnter:false,triggerAtEsc:false,triggerAtInput:false,useWithBarcode:false,});class NumberBuffer extends EventBus{static serviceDependencies=["sound","localization"];constructor(){super();this.setup(...arguments);}
setup({sound,localization}){this.isReset=false;this.bufferHolderStack=[];this.sound=sound;this.defaultDecimalPoint=localization.decimalPoint;window.addEventListener("keyup",this._onKeyboardInput.bind(this));}
get(){return this.state?this.state.buffer:null;}
set(val){this.state.buffer=!isNaN(parseFloat(val))?val:"";this.trigger("buffer-update",this.state.buffer);}
reset(){this.isReset=true;this.state.buffer="";this.trigger("buffer-update",this.state.buffer);}
capture(){if(this.handler){clearTimeout(this._timeout);this.handler(true);delete this.handler;}}
getFloat(){return oParseFloat(this.get());}
use(config){this.eventsBuffer=[];const currentComponent=useComponent();config=Object.assign(getDefaultConfig(),config);this.bufferHolderStack.push({component:currentComponent,state:config.state?config.state:{buffer:"",toStartOver:false},config,});this._setUp();onWillDestroy(()=>{const currentComponentName=currentComponent.constructor.name;const indexComponent=this.bufferHolderStack.findIndex((stack)=>stack.component.constructor.name===currentComponentName);this.bufferHolderStack.splice(indexComponent,1);this._setUp();});}
get _currentBufferHolder(){return this.bufferHolderStack[this.bufferHolderStack.length-1];}
_setUp(){if(!this._currentBufferHolder){return;}
const{component,state,config}=this._currentBufferHolder;this.component=component;this.state=state;this.config=config;this.decimalPoint=config.decimalPoint||this.defaultDecimalPoint;this.maxTimeBetweenKeys=this.config.useWithBarcode?barcodeService.maxTimeBetweenKeysInMs:0;}
_onKeyboardInput(event){return(this._currentBufferHolder&&this._bufferEvents(this._onInput((event)=>event.key))(event));}
sendKey(key){const event=new CustomEvent("",{detail:{key:key,},});Object.defineProperty(event,"target",{value:{}});return this._bufferEvents(this._onInput((event)=>event.detail.key))(event);}
_bufferEvents(handler){return(event)=>{if(["INPUT","TEXTAREA"].includes(event.target.tagName)||!this.eventsBuffer){return;}
clearTimeout(this._timeout);this.eventsBuffer.push(event);this._timeout=setTimeout(handler,this.maxTimeBetweenKeys);this.handler=handler;};}
_onInput(keyAccessor){return(manualCapture=false)=>{if(manualCapture||(!manualCapture&&this.eventsBuffer.length<=2)){for(const event of this.eventsBuffer){if(!ALLOWED_KEYS.has(keyAccessor(event))){this.eventsBuffer=[];return;}}
for(const event of this.eventsBuffer){this._handleInput(keyAccessor(event));event.preventDefault();event.stopPropagation();}}
this.eventsBuffer=[];};}
_handleInput(key){if(key==="Enter"&&this.config.triggerAtEnter){this.config.triggerAtEnter(this.state);}else if(key==="Esc"&&this.config.triggerAtEsc){this.config.triggerAtEsc(this.state);}else if(INPUT_KEYS.has(key)){this._updateBuffer(key);if(this.config.triggerAtInput){this.config.triggerAtInput({buffer:this.state.buffer,key,});}}}
_updateBuffer(input){const isEmpty=(val)=>{return val===""||val===null;};if(input===undefined||input===null){return;}
const isFirstInput=isEmpty(this.state.buffer);if(input===","||input==="."){if(this.state.toStartOver){this.state.buffer="";}
if(isFirstInput){this.state.buffer="0"+this.decimalPoint;}else if(!this.state.buffer.length||this.state.buffer==="-"){this.state.buffer+="0"+this.decimalPoint;}else if(this.state.buffer.indexOf(this.decimalPoint)<0){this.state.buffer=this.state.buffer+this.decimalPoint;}}else if(input==="Delete"){if(this.isReset){this.state.buffer="";this.isReset=false;return;}
this.state.buffer=isEmpty(this.state.buffer)?null:"";}else if(input==="Backspace"){if(this.isReset){this.state.buffer="";this.isReset=false;return;}
if(this.state.toStartOver){this.state.buffer="";}
const buffer=this.state.buffer;if(isEmpty(buffer)){this.state.buffer=null;}else{const nCharToRemove=buffer[buffer.length-1]===this.decimalPoint?2:1;this.state.buffer=buffer.substring(0,buffer.length-nCharToRemove);}}else if(input==="+"){if(this.state.buffer[0]==="-"){this.state.buffer=this.state.buffer.substring(1,this.state.buffer.length);}}else if(input==="-"){if(isFirstInput){this.state.buffer="-0";}else if(this.state.buffer[0]==="-"){this.state.buffer=this.state.buffer.substring(1,this.state.buffer.length);}else{this.state.buffer="-"+this.state.buffer;}}else if(input[0]==="+"&&!isNaN(parseFloat(input))){const inputValue=oParseFloat(input.slice(1));const currentBufferValue=this.state.buffer?oParseFloat(this.state.buffer):0;this.state.buffer=this.component.env.utils.formatCurrency(inputValue+currentBufferValue,false);}else if(!isNaN(parseInt(input,10))){if(this.state.toStartOver){this.state.buffer="";}
if(isFirstInput){this.state.buffer=""+input;}else if(this.state.buffer.length>12){this.sound.play("bell");}else{this.state.buffer+=input;}}
if(this.state.buffer==="-"){this.state.buffer="";}
this.isReset=false;this.state.toStartOver=false;this.trigger("buffer-update",this.state.buffer);}}
const numberBufferService=__exports.numberBufferService={dependencies:NumberBuffer.serviceDependencies,start(env,deps){return new NumberBuffer(deps);},};registry.category("services").add("number_buffer",numberBufferService);return __exports;});;

/* /point_of_sale/static/src/app/utils/report_service.js */
odoo.define('@point_of_sale/app/utils/report_service',['@web/core/registry','@web/core/network/download','@web/webclient/actions/reports/utils'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{downloadFile}=require("@web/core/network/download");const{downloadReport}=require("@web/webclient/actions/reports/utils");const reportService=__exports.reportService={dependencies:["rpc","user","ui","orm","pos"],start(env,{rpc,user,ui,orm,pos}){const reportActionsCache={};return{async doAction(reportXmlId,active_ids){ui.block();try{if(reportXmlId==="account.account_invoices"){const[pdf,filename]=await orm.call("account.move","get_invoice_pdf_report_attachment",[active_ids]);const byteArray=new Uint8Array(pdf.length);for(let i=0;i<pdf.length;i++){byteArray[i]=pdf.charCodeAt(i);}
const blob=new Blob([byteArray],{type:"application/pdf"});await downloadFile(blob,filename,"application/pdf");}else{reportActionsCache[reportXmlId]||=rpc("/web/action/load",{action_id:reportXmlId,});const reportAction=await reportActionsCache[reportXmlId];await downloadReport(rpc,{...reportAction,context:{active_ids}},"pdf",user.context);}}finally{ui.unblock();}},};},};registry.category("services").add("report",reportService);return __exports;});;

/* /point_of_sale/static/src/overrides/ui_service.js */
odoo.define('@point_of_sale/overrides/ui_service',['@web/core/ui/ui_service','@web/core/utils/patch'],function(require){'use strict';let __exports={};const{SIZES,utils}=require("@web/core/ui/ui_service");const{patch}=require("@web/core/utils/patch");patch(utils,{isSmall(ui={}){return(ui.size||utils.getSize())<=SIZES.MD;},});return __exports;});;

/* /point_of_sale/static/src/utils.js */
odoo.define('@point_of_sale/utils',[],function(require){'use strict';let __exports={};__exports.uuidv4=uuidv4;function uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){const r=(Math.random()*16)|0,v=c=="x"?r:(r&0x3)|0x8;return v.toString(16);});}
__exports.deduceUrl=deduceUrl;function deduceUrl(url){const{protocol}=window.location;if(!url.includes("//")){url=`${protocol}//${url}`;}
if(url.indexOf(":",6)<0){url+=":"+(protocol==="https:"?443:8069);}
return url;}
__exports.constructFullProductName=constructFullProductName;function constructFullProductName(line,attribute_value_by_id,display_name){let attributeString="";if(line.attribute_value_ids&&line.attribute_value_ids.length>0){for(const valId of line.attribute_value_ids){const value=attribute_value_by_id[valId];if(value.is_custom){const customValue=line.custom_attribute_value_ids.find((cus)=>cus.custom_product_template_attribute_value_id==parseInt(valId));attributeString+=customValue?`${value.name}: ${customValue.custom_value}, `:`${value.name}, `;}else{attributeString+=`${value.name}, `;}}
attributeString=attributeString.slice(0,-2);attributeString=`(${attributeString})`;}
return attributeString!==""?`${display_name} ${attributeString}`:display_name;}
__exports.random5Chars=random5Chars;function random5Chars(){let code="";while(code.length!=5){code=Math.random().toString(36).slice(2,7);}
return code;}
__exports.qrCodeSrc=qrCodeSrc;function qrCodeSrc(url,{size=200}={}){return`/report/barcode/QR/${encodeURIComponent(url)}?width=${size}&height=${size}`;}
__exports.loadImage=loadImage;function loadImage(url,options={}){return new Promise((resolve,reject)=>{const img=new Image();img.addEventListener("load",()=>resolve(img));img.addEventListener("error",()=>{if(options.onError){options.onError();}
reject(new Error(`Failed to load image at ${url}`));});img.src=url;});}
__exports.loadAllImages=loadAllImages;function loadAllImages(el){const images=el.querySelectorAll("img");return Promise.all(Array.from(images).map(img=>loadImage(img.src)));}
return __exports;});;

/* /web/static/lib/jquery/jquery.js */
(function(global,factory){"use strict";if(typeof module==="object"&&typeof module.exports==="object"){module.exports=global.document?factory(global,true):function(w){if(!w.document){throw new Error("jQuery requires a window with a document");}
return factory(w);};}else{factory(global);}})(typeof window!=="undefined"?window:this,function(window,noGlobal){"use strict";var arr=[];var getProto=Object.getPrototypeOf;var slice=arr.slice;var flat=arr.flat?function(array){return arr.flat.call(array);}:function(array){return arr.concat.apply([],array);};var push=arr.push;var indexOf=arr.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var fnToString=hasOwn.toString;var ObjectFunctionString=fnToString.call(Object);var support={};var isFunction=function isFunction(obj){return typeof obj==="function"&&typeof obj.nodeType!=="number"&&typeof obj.item!=="function";};var isWindow=function isWindow(obj){return obj!=null&&obj===obj.window;};var document=window.document;var preservedScriptAttributes={type:true,src:true,nonce:true,noModule:true};function DOMEval(code,node,doc){doc=doc||document;var i,val,script=doc.createElement("script");script.text=code;if(node){for(i in preservedScriptAttributes){val=node[i]||node.getAttribute&&node.getAttribute(i);if(val){script.setAttribute(i,val);}}}
doc.head.appendChild(script).parentNode.removeChild(script);}
function toType(obj){if(obj==null){return obj+"";}
return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj;}
var
version="3.6.3",jQuery=function(selector,context){return new jQuery.fn.init(selector,context);};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,length:0,toArray:function(){return slice.call(this);},get:function(num){if(num==null){return slice.call(this);}
return num<0?this[num+this.length]:this[num];},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;return ret;},each:function(callback){return jQuery.each(this,callback);},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem);}));},slice:function(){return this.pushStack(slice.apply(this,arguments));},first:function(){return this.eq(0);},last:function(){return this.eq(-1);},even:function(){return this.pushStack(jQuery.grep(this,function(_elem,i){return(i+1)%2;}));},odd:function(){return this.pushStack(jQuery.grep(this,function(_elem,i){return i%2;}));},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[]);},end:function(){return this.prevObject||this.constructor();},push:push,sort:arr.sort,splice:arr.splice};jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++;}
if(typeof target!=="object"&&!isFunction(target)){target={};}
if(i===length){target=this;i--;}
for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){copy=options[name];if(name==="__proto__"||target===copy){continue;}
if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))){src=target[name];if(copyIsArray&&!Array.isArray(src)){clone=[];}else if(!copyIsArray&&!jQuery.isPlainObject(src)){clone={};}else{clone=src;}
copyIsArray=false;target[name]=jQuery.extend(deep,clone,copy);}else if(copy!==undefined){target[name]=copy;}}}}
return target;};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:true,error:function(msg){throw new Error(msg);},noop:function(){},isPlainObject:function(obj){var proto,Ctor;if(!obj||toString.call(obj)!=="[object Object]"){return false;}
proto=getProto(obj);if(!proto){return true;}
Ctor=hasOwn.call(proto,"constructor")&&proto.constructor;return typeof Ctor==="function"&&fnToString.call(Ctor)===ObjectFunctionString;},isEmptyObject:function(obj){var name;for(name in obj){return false;}
return true;},globalEval:function(code,options,doc){DOMEval(code,{nonce:options&&options.nonce},doc);},each:function(obj,callback){var length,i=0;if(isArrayLike(obj)){length=obj.length;for(;i<length;i++){if(callback.call(obj[i],i,obj[i])===false){break;}}}else{for(i in obj){if(callback.call(obj[i],i,obj[i])===false){break;}}}
return obj;},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArrayLike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr);}else{push.call(ret,arr);}}
return ret;},inArray:function(elem,arr,i){return arr==null?-1:indexOf.call(arr,elem,i);},merge:function(first,second){var len=+second.length,j=0,i=first.length;for(;j<len;j++){first[i++]=second[j];}
first.length=i;return first;},grep:function(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++){callbackInverse=!callback(elems[i],i);if(callbackInverse!==callbackExpect){matches.push(elems[i]);}}
return matches;},map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems)){length=elems.length;for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret.push(value);}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret.push(value);}}}
return flat(ret);},guid:1,support:support});if(typeof Symbol==="function"){jQuery.fn[Symbol.iterator]=arr[Symbol.iterator];}
jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(_i,name){class2type["[object "+name+"]"]=name.toLowerCase();});function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=toType(obj);if(isFunction(obj)||isWindow(obj)){return false;}
return type==="array"||length===0||typeof length==="number"&&length>0&&(length-1)in obj;}
var Sizzle=(function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date(),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),nonnativeSelectorCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true;}
return 0;},hasOwn=({}).hasOwnProperty,arr=[],pop=arr.pop,pushNative=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){var i=0,len=list.length;for(;i<len;i++){if(list[i]===elem){return i;}}
return-1;},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|"+"ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\[\\da-fA-F]{1,6}"+whitespace+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+
whitespace+"*\\]",pseudos=":("+identifier+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|"+".*"+")\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+
whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rdescend=new RegExp(whitespace+"|>"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={"ID":new RegExp("^#("+identifier+")"),"CLASS":new RegExp("^\\.("+identifier+")"),"TAG":new RegExp("^("+identifier+"|[*])"),"ATTR":new RegExp("^"+attributes),"PSEUDO":new RegExp("^"+pseudos),"CHILD":new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+
whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+
whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),"bool":new RegExp("^(?:"+booleans+")$","i"),"needsContext":new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rhtml=/HTML$/i,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,runescape=new RegExp("\\\\[\\da-fA-F]{1,6}"+whitespace+"?|\\\\([^\\r\\n\\f])","g"),funescape=function(escape,nonHex){var high="0x"+escape.slice(1)-0x10000;return nonHex?nonHex:high<0?String.fromCharCode(high+0x10000):String.fromCharCode(high>>10|0xD800,high&0x3FF|0xDC00);},rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,fcssescape=function(ch,asCodePoint){if(asCodePoint){if(ch==="\0"){return"\uFFFD";}
return ch.slice(0,-1)+"\\"+
ch.charCodeAt(ch.length-1).toString(16)+" ";}
return"\\"+ch;},unloadHandler=function(){setDocument();},inDisabledFieldset=addCombinator(function(elem){return elem.disabled===true&&elem.nodeName.toLowerCase()==="fieldset";},{dir:"parentNode",next:"legend"});try{push.apply((arr=slice.call(preferredDoc.childNodes)),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType;}catch(e){push={apply:arr.length?function(target,els){pushNative.apply(target,slice.call(els));}:function(target,els){var j=target.length,i=0;while((target[j++]=els[i++])){}
target.length=j-1;}};}
function Sizzle(selector,context,results,seed){var m,i,elem,nid,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;results=results||[];if(typeof selector!=="string"||!selector||nodeType!==1&&nodeType!==9&&nodeType!==11){return results;}
if(!seed){setDocument(context);context=context||document;if(documentIsHTML){if(nodeType!==11&&(match=rquickExpr.exec(selector))){if((m=match[1])){if(nodeType===9){if((elem=context.getElementById(m))){if(elem.id===m){results.push(elem);return results;}}else{return results;}}else{if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results;}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results;}else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results;}}
if(support.qsa&&!nonnativeSelectorCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))&&(nodeType!==1||context.nodeName.toLowerCase()!=="object")){newSelector=selector;newContext=context;if(nodeType===1&&(rdescend.test(selector)||rcombinators.test(selector))){newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;if(newContext!==context||!support.scope){if((nid=context.getAttribute("id"))){nid=nid.replace(rcssescape,fcssescape);}else{context.setAttribute("id",(nid=expando));}}
groups=tokenize(selector);i=groups.length;while(i--){groups[i]=(nid?"#"+nid:":scope")+" "+
toSelector(groups[i]);}
newSelector=groups.join(",");}
try{if(support.cssSupportsSelector&&!CSS.supports("selector(:is("+newSelector+"))")){throw new Error();}
push.apply(results,newContext.querySelectorAll(newSelector));return results;}catch(qsaError){nonnativeSelectorCache(selector,true);}finally{if(nid===expando){context.removeAttribute("id");}}}}}
return select(selector.replace(rtrim,"$1"),context,results,seed);}
function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()];}
return(cache[key+" "]=value);}
return cache;}
function markFunction(fn){fn[expando]=true;return fn;}
function assert(fn){var el=document.createElement("fieldset");try{return!!fn(el);}catch(e){return false;}finally{if(el.parentNode){el.parentNode.removeChild(el);}
el=null;}}
function addHandle(attrs,handler){var arr=attrs.split("|"),i=arr.length;while(i--){Expr.attrHandle[arr[i]]=handler;}}
function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&a.sourceIndex-b.sourceIndex;if(diff){return diff;}
if(cur){while((cur=cur.nextSibling)){if(cur===b){return-1;}}}
return a?1:-1;}
function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type;};}
function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type;};}
function createDisabledPseudo(disabled){return function(elem){if("form"in elem){if(elem.parentNode&&elem.disabled===false){if("label"in elem){if("label"in elem.parentNode){return elem.parentNode.disabled===disabled;}else{return elem.disabled===disabled;}}
return elem.isDisabled===disabled||elem.isDisabled!==!disabled&&inDisabledFieldset(elem)===disabled;}
return elem.disabled===disabled;}else if("label"in elem){return elem.disabled===disabled;}
return false;};}
function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[(j=matchIndexes[i])]){seed[j]=!(matches[j]=seed[j]);}}});});}
function testContext(context){return context&&typeof context.getElementsByTagName!=="undefined"&&context;}
support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var namespace=elem&&elem.namespaceURI,docElem=elem&&(elem.ownerDocument||elem).documentElement;return!rhtml.test(namespace||docElem&&docElem.nodeName||"HTML");};setDocument=Sizzle.setDocument=function(node){var hasCompare,subWindow,doc=node?node.ownerDocument||node:preferredDoc;if(doc==document||doc.nodeType!==9||!doc.documentElement){return document;}
document=doc;docElem=document.documentElement;documentIsHTML=!isXML(document);if(preferredDoc!=document&&(subWindow=document.defaultView)&&subWindow.top!==subWindow){if(subWindow.addEventListener){subWindow.addEventListener("unload",unloadHandler,false);}else if(subWindow.attachEvent){subWindow.attachEvent("onunload",unloadHandler);}}
support.scope=assert(function(el){docElem.appendChild(el).appendChild(document.createElement("div"));return typeof el.querySelectorAll!=="undefined"&&!el.querySelectorAll(":scope fieldset div").length;});support.cssSupportsSelector=assert(function(){return CSS.supports("selector(*)")&&document.querySelectorAll(":is(:jqfake)")&&!CSS.supports("selector(:is(*,:jqfake))");});support.attributes=assert(function(el){el.className="i";return!el.getAttribute("className");});support.getElementsByTagName=assert(function(el){el.appendChild(document.createComment(""));return!el.getElementsByTagName("*").length;});support.getElementsByClassName=rnative.test(document.getElementsByClassName);support.getById=assert(function(el){docElem.appendChild(el).id=expando;return!document.getElementsByName||!document.getElementsByName(expando).length;});if(support.getById){Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId;};};Expr.find["ID"]=function(id,context){if(typeof context.getElementById!=="undefined"&&documentIsHTML){var elem=context.getElementById(id);return elem?[elem]:[];}};}else{Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return node&&node.value===attrId;};};Expr.find["ID"]=function(id,context){if(typeof context.getElementById!=="undefined"&&documentIsHTML){var node,i,elems,elem=context.getElementById(id);if(elem){node=elem.getAttributeNode("id");if(node&&node.value===id){return[elem];}
elems=context.getElementsByName(id);i=0;while((elem=elems[i++])){node=elem.getAttributeNode("id");if(node&&node.value===id){return[elem];}}}
return[];}};}
Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!=="undefined"){return context.getElementsByTagName(tag);}else if(support.qsa){return context.querySelectorAll(tag);}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while((elem=results[i++])){if(elem.nodeType===1){tmp.push(elem);}}
return tmp;}
return results;};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!=="undefined"&&documentIsHTML){return context.getElementsByClassName(className);}};rbuggyMatches=[];rbuggyQSA=[];if((support.qsa=rnative.test(document.querySelectorAll))){assert(function(el){var input;docElem.appendChild(el).innerHTML="<a id='"+expando+"'></a>"+"<select id='"+expando+"-\r\\' msallowcapture=''>"+"<option selected=''></option></select>";if(el.querySelectorAll("[msallowcapture^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")");}
if(!el.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")");}
if(!el.querySelectorAll("[id~="+expando+"-]").length){rbuggyQSA.push("~=");}
input=document.createElement("input");input.setAttribute("name","");el.appendChild(input);if(!el.querySelectorAll("[name='']").length){rbuggyQSA.push("\\["+whitespace+"*name"+whitespace+"*="+
whitespace+"*(?:''|\"\")");}
if(!el.querySelectorAll(":checked").length){rbuggyQSA.push(":checked");}
if(!el.querySelectorAll("a#"+expando+"+*").length){rbuggyQSA.push(".#.+[+~]");}});assert(function(el){el.innerHTML="<a href='' disabled='disabled'></a>"+"<select disabled='disabled'><option/></select>";var input=document.createElement("input");input.setAttribute("type","hidden");el.appendChild(input).setAttribute("name","D");if(el.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=");}
if(el.querySelectorAll(":enabled").length!==2){rbuggyQSA.push(":enabled",":disabled");}
docElem.appendChild(el).disabled=true;if(el.querySelectorAll(":disabled").length!==2){rbuggyQSA.push(":enabled",":disabled");}});}
if((support.matchesSelector=rnative.test((matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)))){assert(function(el){support.disconnectedMatch=matches.call(el,"*");});}
if(!support.cssSupportsSelector){rbuggyQSA.push(":has");}
rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9&&a.documentElement||a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16));}:function(a,b){if(b){while((b=b.parentNode)){if(b===a){return true;}}}
return false;};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0;}
var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare;}
compare=(a.ownerDocument||a)==(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||(!support.sortDetached&&b.compareDocumentPosition(a)===compare)){if(a==document||a.ownerDocument==preferredDoc&&contains(preferredDoc,a)){return-1;}
if(b==document||b.ownerDocument==preferredDoc&&contains(preferredDoc,b)){return 1;}
return sortInput?(indexOf(sortInput,a)-indexOf(sortInput,b)):0;}
return compare&4?-1:1;}:function(a,b){if(a===b){hasDuplicate=true;return 0;}
var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a==document?-1:b==document?1:aup?-1:bup?1:sortInput?(indexOf(sortInput,a)-indexOf(sortInput,b)):0;}else if(aup===bup){return siblingCheck(a,b);}
cur=a;while((cur=cur.parentNode)){ap.unshift(cur);}
cur=b;while((cur=cur.parentNode)){bp.unshift(cur);}
while(ap[i]===bp[i]){i++;}
return i?siblingCheck(ap[i],bp[i]):ap[i]==preferredDoc?-1:bp[i]==preferredDoc?1:0;};return document;};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements);};Sizzle.matchesSelector=function(elem,expr){setDocument(elem);if(support.matchesSelector&&documentIsHTML&&!nonnativeSelectorCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret;}}catch(e){nonnativeSelectorCache(expr,true);}}
return Sizzle(expr,document,null,[elem]).length>0;};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!=document){setDocument(context);}
return contains(context,elem);};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!=document){setDocument(elem);}
var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null;};Sizzle.escape=function(sel){return(sel+"").replace(rcssescape,fcssescape);};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg);};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while((elem=results[i++])){if(elem===results[i]){j=duplicates.push(i);}}
while(j--){results.splice(duplicates[j],1);}}
sortInput=null;return results;};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while((node=elem[i++])){ret+=getText(node);}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent;}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem);}}}else if(nodeType===3||nodeType===4){return elem.nodeValue;}
return ret;};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{"ATTR":function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" ";}
return match.slice(0,4);},"CHILD":function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0]);}
match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+((match[7]+match[8])||match[3]==="odd");}else if(match[3]){Sizzle.error(match[0]);}
return match;},"PSEUDO":function(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null;}
if(match[3]){match[2]=match[4]||match[5]||"";}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess);}
return match.slice(0,3);}},filter:{"TAG":function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true;}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName;};},"CLASS":function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!=="undefined"&&elem.getAttribute("class")||"");});},"ATTR":function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!=";}
if(!operator){return true;}
result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false;};},"CHILD":function(type,what,_argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode;}:function(elem,_context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=false;if(parent){if(simple){while(dir){node=elem;while((node=node[dir])){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false;}}
start=dir=type==="only"&&!start&&"nextSibling";}
return true;}
start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){node=parent;outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});cache=uniqueCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=nodeIndex&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if(node.nodeType===1&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break;}}}else{if(useCache){node=elem;outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});cache=uniqueCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=nodeIndex;}
if(diff===false){while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});uniqueCache[type]=[dirruns,diff];}
if(node===elem){break;}}}}}
diff-=last;return diff===first||(diff%first===0&&diff/first>=0);}};},"PSEUDO":function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument);}
if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i]);}}):function(elem){return fn(elem,0,args);};}
return fn;}},pseudos:{"not":markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,_context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if((elem=unmatched[i])){seed[i]=!(matches[i]=elem);}}}):function(elem,_context,xml){input[0]=elem;matcher(input,null,xml,results);input[0]=null;return!results.pop();};}),"has":markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0;};}),"contains":markFunction(function(text){text=text.replace(runescape,funescape);return function(elem){return(elem.textContent||getText(elem)).indexOf(text)>-1;};}),"lang":markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang);}
lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if((elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0;}}while((elem=elem.parentNode)&&elem.nodeType===1);return false;};}),"target":function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id;},"root":function(elem){return elem===docElem;},"focus":function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex);},"enabled":createDisabledPseudo(false),"disabled":createDisabledPseudo(true),"checked":function(elem){var nodeName=elem.nodeName.toLowerCase();return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected);},"selected":function(elem){if(elem.parentNode){elem.parentNode.selectedIndex;}
return elem.selected===true;},"empty":function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false;}}
return true;},"parent":function(elem){return!Expr.pseudos["empty"](elem);},"header":function(elem){return rheader.test(elem.nodeName);},"input":function(elem){return rinputs.test(elem.nodeName);},"button":function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button";},"text":function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text");},"first":createPositionalPseudo(function(){return[0];}),"last":createPositionalPseudo(function(_matchIndexes,length){return[length-1];}),"eq":createPositionalPseudo(function(_matchIndexes,length,argument){return[argument<0?argument+length:argument];}),"even":createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i);}
return matchIndexes;}),"odd":createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i);}
return matchIndexes;}),"lt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument>length?length:argument;for(;--i>=0;){matchIndexes.push(i);}
return matchIndexes;}),"gt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i);}
return matchIndexes;})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i);}
for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i);}
function setFilters(){}
setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0);}
soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar;}
groups.push((tokens=[]));}
matched=false;if((match=rcombinators.exec(soFar))){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length);}
for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length);}}
if(!matched){break;}}
return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0);};function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value;}
return selector;}
function addCombinator(matcher,combinator,base){var dir=combinator.dir,skip=combinator.next,key=skip||dir,checkNonElements=base&&key==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml);}}
return false;}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true;}}}}else{while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={});if(skip&&skip===elem.nodeName.toLowerCase()){elem=elem[dir]||elem;}else if((oldCache=uniqueCache[key])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return(newCache[2]=oldCache[2]);}else{uniqueCache[key]=newCache;if((newCache[2]=matcher(elem,context,xml))){return true;}}}}}
return false;};}
function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false;}}
return true;}:matchers[0];}
function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results);}
return results;}
function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if((elem=unmatched[i])){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i);}}}}
return newUnmatched;}
function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter);}
if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector);}
return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml);}
if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if((elem=temp[i])){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem);}}}
if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if((elem=matcherOut[i])){temp.push((matcherIn[i]=elem));}}
postFinder(null,(matcherOut=[]),temp,xml);}
i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem);}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml);}else{push.apply(results,matcherOut);}}});}
function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext;},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1;},implicitRelative,true),matchers=[function(elem,context,xml){var ret=(!leadingRelative&&(xml||context!==outermostContext))||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));checkContext=null;return ret;}];for(;i<len;i++){if((matcher=Expr.relative[tokens[i].type])){matchers=[addCombinator(elementMatcher(matchers),matcher)];}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break;}}
return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens((tokens=tokens.slice(j))),j<len&&toSelector(tokens));}
matchers.push(matcher);}}
return elementMatcher(matchers);}
function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1),len=elems.length;if(outermost){outermostContext=context==document||context||outermost;}
for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;if(!context&&elem.ownerDocument!=document){setDocument(elem);xml=!documentIsHTML;}
while((matcher=elementMatchers[j++])){if(matcher(elem,context||document,xml)){results.push(elem);break;}}
if(outermost){dirruns=dirrunsUnique;}}
if(bySet){if((elem=!matcher&&elem)){matchedCount--;}
if(seed){unmatched.push(elem);}}}
matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while((matcher=setMatchers[j++])){matcher(unmatched,setMatched,context,xml);}
if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results);}}}
setMatched=condense(setMatched);}
push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&(matchedCount+setMatchers.length)>1){Sizzle.uniqueSort(results);}}
if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup;}
return unmatched;};return bySet?markFunction(superMatcher):superMatcher;}
compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector);}
i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached);}else{elementMatchers.push(cached);}}
cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector;}
return cached;};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize((selector=compiled.selector||selector));results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results;}else if(compiled){context=context.parentNode;}
selector=selector.slice(tokens.shift().value.length);}
i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[(type=token.type)]){break;}
if((find=Expr.find[type])){if((seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results;}
break;}}}}
(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context);return results;};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(el){return el.compareDocumentPosition(document.createElement("fieldset"))&1;});if(!assert(function(el){el.innerHTML="<a href='#'></a>";return el.firstChild.getAttribute("href")==="#";})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2);}});}
if(!support.attributes||!assert(function(el){el.innerHTML="<input/>";el.firstChild.setAttribute("value","");return el.firstChild.getAttribute("value")==="";})){addHandle("value",function(elem,_name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue;}});}
if(!assert(function(el){return el.getAttribute("disabled")==null;})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null;}});}
return Sizzle;})(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;jQuery.escapeSelector=Sizzle.escape;var dir=function(elem,dir,until){var matched=[],truncate=until!==undefined;while((elem=elem[dir])&&elem.nodeType!==9){if(elem.nodeType===1){if(truncate&&jQuery(elem).is(until)){break;}
matched.push(elem);}}
return matched;};var siblings=function(n,elem){var matched=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){matched.push(n);}}
return matched;};var rneedsContext=jQuery.expr.match.needsContext;function nodeName(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase();}
var rsingleTag=(/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i);function winnow(elements,qualifier,not){if(isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not;});}
if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return(elem===qualifier)!==not;});}
if(typeof qualifier!=="string"){return jQuery.grep(elements,function(elem){return(indexOf.call(qualifier,elem)>-1)!==not;});}
return jQuery.filter(qualifier,elements,not);}
jQuery.filter=function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")";}
if(elems.length===1&&elem.nodeType===1){return jQuery.find.matchesSelector(elem,expr)?[elem]:[];}
return jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1;}));};jQuery.fn.extend({find:function(selector){var i,ret,len=this.length,self=this;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true;}}}));}
ret=this.pushStack([]);for(i=0;i<len;i++){jQuery.find(selector,self[i],ret);}
return len>1?jQuery.uniqueSort(ret):ret;},filter:function(selector){return this.pushStack(winnow(this,selector||[],false));},not:function(selector){return this.pushStack(winnow(this,selector||[],true));},is:function(selector){return!!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length;}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,init=jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector){return this;}
root=root||rootjQuery;if(typeof selector==="string"){if(selector[0]==="<"&&selector[selector.length-1]===">"&&selector.length>=3){match=[null,selector,null];}else{match=rquickExpr.exec(selector);}
if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(isFunction(this[match])){this[match](context[match]);}else{this.attr(match,context[match]);}}}
return this;}else{elem=document.getElementById(match[2]);if(elem){this[0]=elem;this.length=1;}
return this;}}else if(!context||context.jquery){return(context||root).find(selector);}else{return this.constructor(context).find(selector);}}else if(selector.nodeType){this[0]=selector;this.length=1;return this;}else if(isFunction(selector)){return root.ready!==undefined?root.ready(selector):selector(jQuery);}
return jQuery.makeArray(selector,this);};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){var i=0;for(;i<l;i++){if(jQuery.contains(this,targets[i])){return true;}}});},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],targets=typeof selectors!=="string"&&jQuery(selectors);if(!rneedsContext.test(selectors)){for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(targets?targets.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break;}}}}
return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched);},index:function(elem){if(!elem){return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1;}
if(typeof elem==="string"){return indexOf.call(jQuery(elem),this[0]);}
return indexOf.call(this,elem.jquery?elem[0]:elem);},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))));},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));}});function sibling(cur,dir){while((cur=cur[dir])&&cur.nodeType!==1){}
return cur;}
jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null;},parents:function(elem){return dir(elem,"parentNode");},parentsUntil:function(elem,_i,until){return dir(elem,"parentNode",until);},next:function(elem){return sibling(elem,"nextSibling");},prev:function(elem){return sibling(elem,"previousSibling");},nextAll:function(elem){return dir(elem,"nextSibling");},prevAll:function(elem){return dir(elem,"previousSibling");},nextUntil:function(elem,_i,until){return dir(elem,"nextSibling",until);},prevUntil:function(elem,_i,until){return dir(elem,"previousSibling",until);},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem);},children:function(elem){return siblings(elem.firstChild);},contents:function(elem){if(elem.contentDocument!=null&&getProto(elem.contentDocument)){return elem.contentDocument;}
if(nodeName(elem,"template")){elem=elem.content||elem;}
return jQuery.merge([],elem.childNodes);}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until;}
if(selector&&typeof selector==="string"){matched=jQuery.filter(selector,matched);}
if(this.length>1){if(!guaranteedUnique[name]){jQuery.uniqueSort(matched);}
if(rparentsprev.test(name)){matched.reverse();}}
return this.pushStack(matched);};});var rnothtmlwhite=(/[^\x20\t\r\n\f]+/g);function createOptions(options){var object={};jQuery.each(options.match(rnothtmlwhite)||[],function(_,flag){object[flag]=true;});return object;}
jQuery.Callbacks=function(options){options=typeof options==="string"?createOptions(options):jQuery.extend({},options);var
firing,memory,fired,locked,list=[],queue=[],firingIndex=-1,fire=function(){locked=locked||options.once;fired=firing=true;for(;queue.length;firingIndex=-1){memory=queue.shift();while(++firingIndex<list.length){if(list[firingIndex].apply(memory[0],memory[1])===false&&options.stopOnFalse){firingIndex=list.length;memory=false;}}}
if(!options.memory){memory=false;}
firing=false;if(locked){if(memory){list=[];}else{list="";}}},self={add:function(){if(list){if(memory&&!firing){firingIndex=list.length-1;queue.push(memory);}
(function add(args){jQuery.each(args,function(_,arg){if(isFunction(arg)){if(!options.unique||!self.has(arg)){list.push(arg);}}else if(arg&&arg.length&&toType(arg)!=="string"){add(arg);}});})(arguments);if(memory&&!firing){fire();}}
return this;},remove:function(){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(index<=firingIndex){firingIndex--;}}});return this;},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:list.length>0;},empty:function(){if(list){list=[];}
return this;},disable:function(){locked=queue=[];list=memory="";return this;},disabled:function(){return!list;},lock:function(){locked=queue=[];if(!memory&&!firing){list=memory="";}
return this;},locked:function(){return!!locked;},fireWith:function(context,args){if(!locked){args=args||[];args=[context,args.slice?args.slice():args];queue.push(args);if(!firing){fire();}}
return this;},fire:function(){self.fireWith(this,arguments);return this;},fired:function(){return!!fired;}};return self;};function Identity(v){return v;}
function Thrower(ex){throw ex;}
function adoptValue(value,resolve,reject,noValue){var method;try{if(value&&isFunction((method=value.promise))){method.call(value).done(resolve).fail(reject);}else if(value&&isFunction((method=value.then))){method.call(value,resolve,reject);}else{resolve.apply(undefined,[value].slice(noValue));}}catch(value){reject.apply(undefined,[value]);}}
jQuery.extend({Deferred:function(func){var tuples=[["notify","progress",jQuery.Callbacks("memory"),jQuery.Callbacks("memory"),2],["resolve","done",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),0,"resolved"],["reject","fail",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),1,"rejected"]],state="pending",promise={state:function(){return state;},always:function(){deferred.done(arguments).fail(arguments);return this;},"catch":function(fn){return promise.then(null,fn);},pipe:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(_i,tuple){var fn=isFunction(fns[tuple[4]])&&fns[tuple[4]];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&isFunction(returned.promise)){returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject);}else{newDefer[tuple[0]+"With"](this,fn?[returned]:arguments);}});});fns=null;}).promise();},then:function(onFulfilled,onRejected,onProgress){var maxDepth=0;function resolve(depth,deferred,handler,special){return function(){var that=this,args=arguments,mightThrow=function(){var returned,then;if(depth<maxDepth){return;}
returned=handler.apply(that,args);if(returned===deferred.promise()){throw new TypeError("Thenable self-resolution");}
then=returned&&(typeof returned==="object"||typeof returned==="function")&&returned.then;if(isFunction(then)){if(special){then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special));}else{maxDepth++;then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special),resolve(maxDepth,deferred,Identity,deferred.notifyWith));}}else{if(handler!==Identity){that=undefined;args=[returned];}
(special||deferred.resolveWith)(that,args);}},process=special?mightThrow:function(){try{mightThrow();}catch(e){if(jQuery.Deferred.exceptionHook){jQuery.Deferred.exceptionHook(e,process.stackTrace);}
if(depth+1>=maxDepth){if(handler!==Thrower){that=undefined;args=[e];}
deferred.rejectWith(that,args);}}};if(depth){process();}else{if(jQuery.Deferred.getStackHook){process.stackTrace=jQuery.Deferred.getStackHook();}
window.setTimeout(process);}};}
return jQuery.Deferred(function(newDefer){tuples[0][3].add(resolve(0,newDefer,isFunction(onProgress)?onProgress:Identity,newDefer.notifyWith));tuples[1][3].add(resolve(0,newDefer,isFunction(onFulfilled)?onFulfilled:Identity));tuples[2][3].add(resolve(0,newDefer,isFunction(onRejected)?onRejected:Thrower));}).promise();},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise;}},deferred={};jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[5];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString;},tuples[3-i][2].disable,tuples[3-i][3].disable,tuples[0][2].lock,tuples[0][3].lock);}
list.add(tuple[3].fire);deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?undefined:this,arguments);return this;};deferred[tuple[0]+"With"]=list.fireWith;});promise.promise(deferred);if(func){func.call(deferred,deferred);}
return deferred;},when:function(singleValue){var
remaining=arguments.length,i=remaining,resolveContexts=Array(i),resolveValues=slice.call(arguments),primary=jQuery.Deferred(),updateFunc=function(i){return function(value){resolveContexts[i]=this;resolveValues[i]=arguments.length>1?slice.call(arguments):value;if(!(--remaining)){primary.resolveWith(resolveContexts,resolveValues);}};};if(remaining<=1){adoptValue(singleValue,primary.done(updateFunc(i)).resolve,primary.reject,!remaining);if(primary.state()==="pending"||isFunction(resolveValues[i]&&resolveValues[i].then)){return primary.then();}}
while(i--){adoptValue(resolveValues[i],updateFunc(i),primary.reject);}
return primary.promise();}});var rerrorNames=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;jQuery.Deferred.exceptionHook=function(error,stack){if(window.console&&window.console.warn&&error&&rerrorNames.test(error.name)){window.console.warn("jQuery.Deferred exception: "+error.message,error.stack,stack);}};jQuery.readyException=function(error){window.setTimeout(function(){throw error;});};var readyList=jQuery.Deferred();jQuery.fn.ready=function(fn){readyList.then(fn).catch(function(error){jQuery.readyException(error);});return this;};jQuery.extend({isReady:false,readyWait:1,ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return;}
jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return;}
readyList.resolveWith(document,[jQuery]);}});jQuery.ready.then=readyList.then;function completed(){document.removeEventListener("DOMContentLoaded",completed);window.removeEventListener("load",completed);jQuery.ready();}
if(document.readyState==="complete"||(document.readyState!=="loading"&&!document.documentElement.doScroll)){window.setTimeout(jQuery.ready);}else{document.addEventListener("DOMContentLoaded",completed);window.addEventListener("load",completed);}
var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=key==null;if(toType(key)==="object"){chainable=true;for(i in key){access(elems,fn,i,key[i],true,emptyGet,raw);}}else if(value!==undefined){chainable=true;if(!isFunction(value)){raw=true;}
if(bulk){if(raw){fn.call(elems,value);fn=null;}else{bulk=fn;fn=function(elem,_key,value){return bulk.call(jQuery(elem),value);};}}
if(fn){for(;i<len;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));}}}
if(chainable){return elems;}
if(bulk){return fn.call(elems);}
return len?fn(elems[0],key):emptyGet;};var rmsPrefix=/^-ms-/,rdashAlpha=/-([a-z])/g;function fcamelCase(_all,letter){return letter.toUpperCase();}
function camelCase(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase);}
var acceptData=function(owner){return owner.nodeType===1||owner.nodeType===9||!(+owner.nodeType);};function Data(){this.expando=jQuery.expando+Data.uid++;}
Data.uid=1;Data.prototype={cache:function(owner){var value=owner[this.expando];if(!value){value={};if(acceptData(owner)){if(owner.nodeType){owner[this.expando]=value;}else{Object.defineProperty(owner,this.expando,{value:value,configurable:true});}}}
return value;},set:function(owner,data,value){var prop,cache=this.cache(owner);if(typeof data==="string"){cache[camelCase(data)]=value;}else{for(prop in data){cache[camelCase(prop)]=data[prop];}}
return cache;},get:function(owner,key){return key===undefined?this.cache(owner):owner[this.expando]&&owner[this.expando][camelCase(key)];},access:function(owner,key,value){if(key===undefined||((key&&typeof key==="string")&&value===undefined)){return this.get(owner,key);}
this.set(owner,key,value);return value!==undefined?value:key;},remove:function(owner,key){var i,cache=owner[this.expando];if(cache===undefined){return;}
if(key!==undefined){if(Array.isArray(key)){key=key.map(camelCase);}else{key=camelCase(key);key=key in cache?[key]:(key.match(rnothtmlwhite)||[]);}
i=key.length;while(i--){delete cache[key[i]];}}
if(key===undefined||jQuery.isEmptyObject(cache)){if(owner.nodeType){owner[this.expando]=undefined;}else{delete owner[this.expando];}}},hasData:function(owner){var cache=owner[this.expando];return cache!==undefined&&!jQuery.isEmptyObject(cache);}};var dataPriv=new Data();var dataUser=new Data();var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;function getData(data){if(data==="true"){return true;}
if(data==="false"){return false;}
if(data==="null"){return null;}
if(data===+data+""){return+data;}
if(rbrace.test(data)){return JSON.parse(data);}
return data;}
function dataAttr(elem,key,data){var name;if(data===undefined&&elem.nodeType===1){name="data-"+key.replace(rmultiDash,"-$&").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=getData(data);}catch(e){}
dataUser.set(elem,key,data);}else{data=undefined;}}
return data;}
jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem);},data:function(elem,name,data){return dataUser.access(elem,name,data);},removeData:function(elem,name){dataUser.remove(elem,name);},_data:function(elem,name,data){return dataPriv.access(elem,name,data);},_removeData:function(elem,name){dataPriv.remove(elem,name);}});jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length){data=dataUser.get(elem);if(elem.nodeType===1&&!dataPriv.get(elem,"hasDataAttrs")){i=attrs.length;while(i--){if(attrs[i]){name=attrs[i].name;if(name.indexOf("data-")===0){name=camelCase(name.slice(5));dataAttr(elem,name,data[name]);}}}
dataPriv.set(elem,"hasDataAttrs",true);}}
return data;}
if(typeof key==="object"){return this.each(function(){dataUser.set(this,key);});}
return access(this,function(value){var data;if(elem&&value===undefined){data=dataUser.get(elem,key);if(data!==undefined){return data;}
data=dataAttr(elem,key);if(data!==undefined){return data;}
return;}
this.each(function(){dataUser.set(this,key,value);});},null,value,arguments.length>1,null,true);},removeData:function(key){return this.each(function(){dataUser.remove(this,key);});}});jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=dataPriv.get(elem,type);if(data){if(!queue||Array.isArray(data)){queue=dataPriv.access(elem,type,jQuery.makeArray(data));}else{queue.push(data);}}
return queue||[];}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type);};if(fn==="inprogress"){fn=queue.shift();startLength--;}
if(fn){if(type==="fx"){queue.unshift("inprogress");}
delete hooks.stop;fn.call(elem,next,hooks);}
if(!startLength&&hooks){hooks.empty.fire();}},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key]);})});}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--;}
if(arguments.length<setter){return jQuery.queue(this[0],type);}
return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type);}});},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type);});},clearQueue:function(type){return this.queue(type||"fx",[]);},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!(--count)){defer.resolveWith(elements,[elements]);}};if(typeof type!=="string"){obj=type;type=undefined;}
type=type||"fx";while(i--){tmp=dataPriv.get(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve);}}
resolve();return defer.promise(obj);}});var pnum=(/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;var rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i");var cssExpand=["Top","Right","Bottom","Left"];var documentElement=document.documentElement;var isAttached=function(elem){return jQuery.contains(elem.ownerDocument,elem);},composed={composed:true};if(documentElement.getRootNode){isAttached=function(elem){return jQuery.contains(elem.ownerDocument,elem)||elem.getRootNode(composed)===elem.ownerDocument;};}
var isHiddenWithinTree=function(elem,el){elem=el||elem;return elem.style.display==="none"||elem.style.display===""&&isAttached(elem)&&jQuery.css(elem,"display")==="none";};function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale,maxIterations=20,currentValue=tween?function(){return tween.cur();}:function(){return jQuery.css(elem,prop,"");},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=elem.nodeType&&(jQuery.cssNumber[prop]||unit!=="px"&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){initial=initial/2;unit=unit||initialInUnit[3];initialInUnit=+initial||1;while(maxIterations--){jQuery.style(elem,prop,initialInUnit+unit);if((1-scale)*(1-(scale=currentValue()/initial||0.5))<=0){maxIterations=0;}
initialInUnit=initialInUnit/scale;}
initialInUnit=initialInUnit*2;jQuery.style(elem,prop,initialInUnit+unit);valueParts=valueParts||[];}
if(valueParts){initialInUnit=+initialInUnit||+initial||0;adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2];if(tween){tween.unit=unit;tween.start=initialInUnit;tween.end=adjusted;}}
return adjusted;}
var defaultDisplayMap={};function getDefaultDisplay(elem){var temp,doc=elem.ownerDocument,nodeName=elem.nodeName,display=defaultDisplayMap[nodeName];if(display){return display;}
temp=doc.body.appendChild(doc.createElement(nodeName));display=jQuery.css(temp,"display");temp.parentNode.removeChild(temp);if(display==="none"){display="block";}
defaultDisplayMap[nodeName]=display;return display;}
function showHide(elements,show){var display,elem,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue;}
display=elem.style.display;if(show){if(display==="none"){values[index]=dataPriv.get(elem,"display")||null;if(!values[index]){elem.style.display="";}}
if(elem.style.display===""&&isHiddenWithinTree(elem)){values[index]=getDefaultDisplay(elem);}}else{if(display!=="none"){values[index]="none";dataPriv.set(elem,"display",display);}}}
for(index=0;index<length;index++){if(values[index]!=null){elements[index].style.display=values[index];}}
return elements;}
jQuery.fn.extend({show:function(){return showHide(this,true);},hide:function(){return showHide(this);},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide();}
return this.each(function(){if(isHiddenWithinTree(this)){jQuery(this).show();}else{jQuery(this).hide();}});}});var rcheckableType=(/^(?:checkbox|radio)$/i);var rtagName=(/<([a-z][^\/\0>\x20\t\r\n\f]*)/i);var rscriptType=(/^$|^module$|\/(?:java|ecma)script/i);(function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio");input.setAttribute("checked","checked");input.setAttribute("name","t");div.appendChild(input);support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue;div.innerHTML="<option></option>";support.option=!!div.lastChild;})();var wrapMap={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;if(!support.option){wrapMap.optgroup=wrapMap.option=[1,"<select multiple='multiple'>","</select>"];}
function getAll(context,tag){var ret;if(typeof context.getElementsByTagName!=="undefined"){ret=context.getElementsByTagName(tag||"*");}else if(typeof context.querySelectorAll!=="undefined"){ret=context.querySelectorAll(tag||"*");}else{ret=[];}
if(tag===undefined||tag&&nodeName(context,tag)){return jQuery.merge([context],ret);}
return ret;}
function setGlobalEval(elems,refElements){var i=0,l=elems.length;for(;i<l;i++){dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"));}}
var rhtml=/<|&#?\w+;/;function buildFragment(elems,context,scripts,selection,ignored){var elem,tmp,tag,wrap,attached,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(toType(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem);}else if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem));}else{tmp=tmp||fragment.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild;}
jQuery.merge(nodes,tmp.childNodes);tmp=fragment.firstChild;tmp.textContent="";}}}
fragment.textContent="";i=0;while((elem=nodes[i++])){if(selection&&jQuery.inArray(elem,selection)>-1){if(ignored){ignored.push(elem);}
continue;}
attached=isAttached(elem);tmp=getAll(fragment.appendChild(elem),"script");if(attached){setGlobalEval(tmp);}
if(scripts){j=0;while((elem=tmp[j++])){if(rscriptType.test(elem.type||"")){scripts.push(elem);}}}}
return fragment;}
var rtypenamespace=/^([^.]*)(?:\.(.+)|)/;function returnTrue(){return true;}
function returnFalse(){return false;}
function expectSync(elem,type){return(elem===safeActiveElement())===(type==="focus");}
function safeActiveElement(){try{return document.activeElement;}catch(err){}}
function on(elem,types,selector,data,fn,one){var origFn,type;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined;}
for(type in types){on(elem,type,selector,data,types[type],one);}
return elem;}
if(data==null&&fn==null){fn=selector;data=selector=undefined;}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined;}else{fn=data;data=selector;selector=undefined;}}
if(fn===false){fn=returnFalse;}else if(!fn){return elem;}
if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments);};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++);}
return elem.each(function(){jQuery.event.add(this,types,fn,data,selector);});}
jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(!acceptData(elem)){return;}
if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector;}
if(selector){jQuery.find.matchesSelector(documentElement,selector);}
if(!handler.guid){handler.guid=jQuery.guid++;}
if(!(events=elemData.events)){events=elemData.events=Object.create(null);}
if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!=="undefined"&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):undefined;};}
types=(types||"").match(rnothtmlwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue;}
special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle);}}}
if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid;}}
if(selector){handlers.splice(handlers.delegateCount++,0,handleObj);}else{handlers.push(handleObj);}
jQuery.event.global[type]=true;}},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(!elemData||!(events=elemData.events)){return;}
types=(types||"").match(rnothtmlwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true);}
continue;}
special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--;}
if(special.remove){special.remove.call(elem,handleObj);}}}
if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle);}
delete events[type];}}
if(jQuery.isEmptyObject(events)){dataPriv.remove(elem,"handle events");}},dispatch:function(nativeEvent){var i,j,ret,matched,handleObj,handlerQueue,args=new Array(arguments.length),event=jQuery.event.fix(nativeEvent),handlers=(dataPriv.get(this,"events")||Object.create(null))[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;for(i=1;i<arguments.length;i++){args[i]=arguments[i];}
event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return;}
handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.rnamespace||handleObj.namespace===false||event.rnamespace.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation();}}}}}
if(special.postDispatch){special.postDispatch.call(this,event);}
return event.result;},handlers:function(event,handlers){var i,handleObj,sel,matchedHandlers,matchedSelectors,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&!(event.type==="click"&&event.button>=1)){for(;cur!==this;cur=cur.parentNode||this){if(cur.nodeType===1&&!(event.type==="click"&&cur.disabled===true)){matchedHandlers=[];matchedSelectors={};for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matchedSelectors[sel]===undefined){matchedSelectors[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length;}
if(matchedSelectors[sel]){matchedHandlers.push(handleObj);}}
if(matchedHandlers.length){handlerQueue.push({elem:cur,handlers:matchedHandlers});}}}}
cur=this;if(delegateCount<handlers.length){handlerQueue.push({elem:cur,handlers:handlers.slice(delegateCount)});}
return handlerQueue;},addProp:function(name,hook){Object.defineProperty(jQuery.Event.prototype,name,{enumerable:true,configurable:true,get:isFunction(hook)?function(){if(this.originalEvent){return hook(this.originalEvent);}}:function(){if(this.originalEvent){return this.originalEvent[name];}},set:function(value){Object.defineProperty(this,name,{enumerable:true,configurable:true,writable:true,value:value});}});},fix:function(originalEvent){return originalEvent[jQuery.expando]?originalEvent:new jQuery.Event(originalEvent);},special:{load:{noBubble:true},click:{setup:function(data){var el=this||data;if(rcheckableType.test(el.type)&&el.click&&nodeName(el,"input")){leverageNative(el,"click",returnTrue);}
return false;},trigger:function(data){var el=this||data;if(rcheckableType.test(el.type)&&el.click&&nodeName(el,"input")){leverageNative(el,"click");}
return true;},_default:function(event){var target=event.target;return rcheckableType.test(target.type)&&target.click&&nodeName(target,"input")&&dataPriv.get(target,"click")||nodeName(target,"a");}},beforeunload:{postDispatch:function(event){if(event.result!==undefined&&event.originalEvent){event.originalEvent.returnValue=event.result;}}}}};function leverageNative(el,type,expectSync){if(!expectSync){if(dataPriv.get(el,type)===undefined){jQuery.event.add(el,type,returnTrue);}
return;}
dataPriv.set(el,type,false);jQuery.event.add(el,type,{namespace:false,handler:function(event){var notAsync,result,saved=dataPriv.get(this,type);if((event.isTrigger&1)&&this[type]){if(!saved.length){saved=slice.call(arguments);dataPriv.set(this,type,saved);notAsync=expectSync(this,type);this[type]();result=dataPriv.get(this,type);if(saved!==result||notAsync){dataPriv.set(this,type,false);}else{result={};}
if(saved!==result){event.stopImmediatePropagation();event.preventDefault();return result&&result.value;}}else if((jQuery.event.special[type]||{}).delegateType){event.stopPropagation();}}else if(saved.length){dataPriv.set(this,type,{value:jQuery.event.trigger(jQuery.extend(saved[0],jQuery.Event.prototype),saved.slice(1),this)});event.stopImmediatePropagation();}}});}
jQuery.removeEvent=function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle);}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props);}
if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&src.returnValue===false?returnTrue:returnFalse;this.target=(src.target&&src.target.nodeType===3)?src.target.parentNode:src.target;this.currentTarget=src.currentTarget;this.relatedTarget=src.relatedTarget;}else{this.type=src;}
if(props){jQuery.extend(this,props);}
this.timeStamp=src&&src.timeStamp||Date.now();this[jQuery.expando]=true;};jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:false,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(e&&!this.isSimulated){e.preventDefault();}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(e&&!this.isSimulated){e.stopPropagation();}},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue;if(e&&!this.isSimulated){e.stopImmediatePropagation();}
this.stopPropagation();}};jQuery.each({altKey:true,bubbles:true,cancelable:true,changedTouches:true,ctrlKey:true,detail:true,eventPhase:true,metaKey:true,pageX:true,pageY:true,shiftKey:true,view:true,"char":true,code:true,charCode:true,key:true,keyCode:true,button:true,buttons:true,clientX:true,clientY:true,offsetX:true,offsetY:true,pointerId:true,pointerType:true,screenX:true,screenY:true,targetTouches:true,toElement:true,touches:true,which:true},jQuery.event.addProp);jQuery.each({focus:"focusin",blur:"focusout"},function(type,delegateType){jQuery.event.special[type]={setup:function(){leverageNative(this,type,expectSync);return false;},trigger:function(){leverageNative(this,type);return true;},_default:function(event){return dataPriv.get(event.target,type);},delegateType:delegateType};});jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||(related!==target&&!jQuery.contains(target,related))){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix;}
return ret;}};});jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn);},one:function(types,selector,data,fn){return on(this,types,selector,data,fn,1);},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this;}
if(typeof types==="object"){for(type in types){this.off(type,selector,types[type]);}
return this;}
if(selector===false||typeof selector==="function"){fn=selector;selector=undefined;}
if(fn===false){fn=returnFalse;}
return this.each(function(){jQuery.event.remove(this,types,fn,selector);});}});var
rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rcleanScript=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function manipulationTarget(elem,content){if(nodeName(elem,"table")&&nodeName(content.nodeType!==11?content:content.firstChild,"tr")){return jQuery(elem).children("tbody")[0]||elem;}
return elem;}
function disableScript(elem){elem.type=(elem.getAttribute("type")!==null)+"/"+elem.type;return elem;}
function restoreScript(elem){if((elem.type||"").slice(0,5)==="true/"){elem.type=elem.type.slice(5);}else{elem.removeAttribute("type");}
return elem;}
function cloneCopyEvent(src,dest){var i,l,type,pdataOld,udataOld,udataCur,events;if(dest.nodeType!==1){return;}
if(dataPriv.hasData(src)){pdataOld=dataPriv.get(src);events=pdataOld.events;if(events){dataPriv.remove(dest,"handle events");for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i]);}}}}
if(dataUser.hasData(src)){udataOld=dataUser.access(src);udataCur=jQuery.extend({},udataOld);dataUser.set(dest,udataCur);}}
function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();if(nodeName==="input"&&rcheckableType.test(src.type)){dest.checked=src.checked;}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue;}}
function domManip(collection,args,callback,ignored){args=flat(args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],valueIsFunction=isFunction(value);if(valueIsFunction||(l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value))){return collection.each(function(index){var self=collection.eq(index);if(valueIsFunction){args[0]=value.call(this,index,self.html());}
domManip(self,args,callback,ignored);});}
if(l){fragment=buildFragment(args,collection[0].ownerDocument,false,collection,ignored);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first;}
if(first||ignored){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"));}}
callback.call(collection[i],node,i);}
if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src&&(node.type||"").toLowerCase()!=="module"){if(jQuery._evalUrl&&!node.noModule){jQuery._evalUrl(node.src,{nonce:node.nonce||node.getAttribute("nonce")},doc);}}else{DOMEval(node.textContent.replace(rcleanScript,""),node,doc);}}}}}}
return collection;}
function remove(elem,selector,keepData){var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;for(;(node=nodes[i])!=null;i++){if(!keepData&&node.nodeType===1){jQuery.cleanData(getAll(node));}
if(node.parentNode){if(keepData&&isAttached(node)){setGlobalEval(getAll(node,"script"));}
node.parentNode.removeChild(node);}}
return elem;}
jQuery.extend({htmlPrefilter:function(html){return html;},clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(true),inPage=isAttached(elem);if(!support.noCloneChecked&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0,l=srcElements.length;i<l;i++){fixInput(srcElements[i],destElements[i]);}}
if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0,l=srcElements.length;i<l;i++){cloneCopyEvent(srcElements[i],destElements[i]);}}else{cloneCopyEvent(elem,clone);}}
destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"));}
return clone;},cleanData:function(elems){var data,elem,type,special=jQuery.event.special,i=0;for(;(elem=elems[i])!==undefined;i++){if(acceptData(elem)){if((data=elem[dataPriv.expando])){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type);}else{jQuery.removeEvent(elem,type,data.handle);}}}
elem[dataPriv.expando]=undefined;}
if(elem[dataUser.expando]){elem[dataUser.expando]=undefined;}}}}});jQuery.fn.extend({detach:function(selector){return remove(this,selector,true);},remove:function(selector){return remove(this,selector);},text:function(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.textContent=value;}});},null,value,arguments.length);},append:function(){return domManip(this,arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem);}});},prepend:function(){return domManip(this,arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild);}});},before:function(){return domManip(this,arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this);}});},after:function(){return domManip(this,arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling);}});},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.textContent="";}}
return this;},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents);});},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined&&elem.nodeType===1){return elem.innerHTML;}
if(typeof value==="string"&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value;}}
elem=0;}catch(e){}}
if(elem){this.empty().append(value);}},null,value,arguments.length);},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;if(jQuery.inArray(this,ignored)<0){jQuery.cleanData(getAll(this));if(parent){parent.replaceChild(elem,this);}}},ignored);}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);push.apply(ret,elems.get());}
return this.pushStack(ret);};});var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");var rcustomProp=/^--/;var getStyles=function(elem){var view=elem.ownerDocument.defaultView;if(!view||!view.opener){view=window;}
return view.getComputedStyle(elem);};var swap=function(elem,options,callback){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name];}
ret=callback.call(elem);for(name in options){elem.style[name]=old[name];}
return ret;};var rboxStyle=new RegExp(cssExpand.join("|"),"i");var whitespace="[\\x20\\t\\r\\n\\f]";var rtrimCSS=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g");(function(){function computeStyleTests(){if(!div){return;}
container.style.cssText="position:absolute;left:-11111px;width:60px;"+"margin-top:1px;padding:0;border:0";div.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;"+"margin:auto;border:1px;padding:1px;"+"width:60%;top:1%";documentElement.appendChild(container).appendChild(div);var divStyle=window.getComputedStyle(div);pixelPositionVal=divStyle.top!=="1%";reliableMarginLeftVal=roundPixelMeasures(divStyle.marginLeft)===12;div.style.right="60%";pixelBoxStylesVal=roundPixelMeasures(divStyle.right)===36;boxSizingReliableVal=roundPixelMeasures(divStyle.width)===36;div.style.position="absolute";scrollboxSizeVal=roundPixelMeasures(div.offsetWidth/3)===12;documentElement.removeChild(container);div=null;}
function roundPixelMeasures(measure){return Math.round(parseFloat(measure));}
var pixelPositionVal,boxSizingReliableVal,scrollboxSizeVal,pixelBoxStylesVal,reliableTrDimensionsVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");if(!div.style){return;}
div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";jQuery.extend(support,{boxSizingReliable:function(){computeStyleTests();return boxSizingReliableVal;},pixelBoxStyles:function(){computeStyleTests();return pixelBoxStylesVal;},pixelPosition:function(){computeStyleTests();return pixelPositionVal;},reliableMarginLeft:function(){computeStyleTests();return reliableMarginLeftVal;},scrollboxSize:function(){computeStyleTests();return scrollboxSizeVal;},reliableTrDimensions:function(){var table,tr,trChild,trStyle;if(reliableTrDimensionsVal==null){table=document.createElement("table");tr=document.createElement("tr");trChild=document.createElement("div");table.style.cssText="position:absolute;left:-11111px;border-collapse:separate";tr.style.cssText="border:1px solid";tr.style.height="1px";trChild.style.height="9px";trChild.style.display="block";documentElement.appendChild(table).appendChild(tr).appendChild(trChild);trStyle=window.getComputedStyle(tr);reliableTrDimensionsVal=(parseInt(trStyle.height,10)+
parseInt(trStyle.borderTopWidth,10)+
parseInt(trStyle.borderBottomWidth,10))===tr.offsetHeight;documentElement.removeChild(table);}
return reliableTrDimensionsVal;}});})();function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,isCustomProp=rcustomProp.test(name),style=elem.style;computed=computed||getStyles(elem);if(computed){ret=computed.getPropertyValue(name)||computed[name];if(isCustomProp&&ret){ret=ret.replace(rtrimCSS,"$1")||undefined;}
if(ret===""&&!isAttached(elem)){ret=jQuery.style(elem,name);}
if(!support.pixelBoxStyles()&&rnumnonpx.test(ret)&&rboxStyle.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth;}}
return ret!==undefined?ret+"":ret;}
function addGetHookIf(conditionFn,hookFn){return{get:function(){if(conditionFn()){delete this.get;return;}
return(this.get=hookFn).apply(this,arguments);}};}
var cssPrefixes=["Webkit","Moz","ms"],emptyStyle=document.createElement("div").style,vendorProps={};function vendorPropName(name){var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in emptyStyle){return name;}}}
function finalPropName(name){var final=jQuery.cssProps[name]||vendorProps[name];if(final){return final;}
if(name in emptyStyle){return name;}
return vendorProps[name]=vendorPropName(name)||name;}
var
rdisplayswap=/^(none|table(?!-c[ea]).+)/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"};function setPositiveNumber(_elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value;}
function boxModelAdjustment(elem,dimension,box,isBorderBox,styles,computedVal){var i=dimension==="width"?1:0,extra=0,delta=0;if(box===(isBorderBox?"border":"content")){return 0;}
for(;i<4;i+=2){if(box==="margin"){delta+=jQuery.css(elem,box+cssExpand[i],true,styles);}
if(!isBorderBox){delta+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(box!=="padding"){delta+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}else{extra+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}}else{if(box==="content"){delta-=jQuery.css(elem,"padding"+cssExpand[i],true,styles);}
if(box!=="margin"){delta-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}}}
if(!isBorderBox&&computedVal>=0){delta+=Math.max(0,Math.ceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-
computedVal-
delta-
extra-
0.5))||0;}
return delta;}
function getWidthOrHeight(elem,dimension,extra){var styles=getStyles(elem),boxSizingNeeded=!support.boxSizingReliable()||extra,isBorderBox=boxSizingNeeded&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",valueIsBorderBox=isBorderBox,val=curCSS(elem,dimension,styles),offsetProp="offset"+dimension[0].toUpperCase()+dimension.slice(1);if(rnumnonpx.test(val)){if(!extra){return val;}
val="auto";}
if((!support.boxSizingReliable()&&isBorderBox||!support.reliableTrDimensions()&&nodeName(elem,"tr")||val==="auto"||!parseFloat(val)&&jQuery.css(elem,"display",false,styles)==="inline")&&elem.getClientRects().length){isBorderBox=jQuery.css(elem,"boxSizing",false,styles)==="border-box";valueIsBorderBox=offsetProp in elem;if(valueIsBorderBox){val=elem[offsetProp];}}
val=parseFloat(val)||0;return(val+
boxModelAdjustment(elem,dimension,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles,val))+"px";}
jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret;}}}},cssNumber:{"animationIterationCount":true,"columnCount":true,"fillOpacity":true,"flexGrow":true,"flexShrink":true,"fontWeight":true,"gridArea":true,"gridColumn":true,"gridColumnEnd":true,"gridColumnStart":true,"gridRow":true,"gridRowEnd":true,"gridRowStart":true,"lineHeight":true,"opacity":true,"order":true,"orphans":true,"widows":true,"zIndex":true,"zoom":true},cssProps:{},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return;}
var ret,type,hooks,origName=camelCase(name),isCustomProp=rcustomProp.test(name),style=elem.style;if(!isCustomProp){name=finalPropName(origName);}
hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rcssNum.exec(value))&&ret[1]){value=adjustCSS(elem,name,ret);type="number";}
if(value==null||value!==value){return;}
if(type==="number"&&!isCustomProp){value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px");}
if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit";}
if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){if(isCustomProp){style.setProperty(name,value);}else{style[name]=value;}}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret;}
return style[name];}},css:function(elem,name,extra,styles){var val,num,hooks,origName=camelCase(name),isCustomProp=rcustomProp.test(name);if(!isCustomProp){name=finalPropName(origName);}
hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get"in hooks){val=hooks.get(elem,true,extra);}
if(val===undefined){val=curCSS(elem,name,styles);}
if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name];}
if(extra===""||extra){num=parseFloat(val);return extra===true||isFinite(num)?num||0:val;}
return val;}});jQuery.each(["height","width"],function(_i,dimension){jQuery.cssHooks[dimension]={get:function(elem,computed,extra){if(computed){return rdisplayswap.test(jQuery.css(elem,"display"))&&(!elem.getClientRects().length||!elem.getBoundingClientRect().width)?swap(elem,cssShow,function(){return getWidthOrHeight(elem,dimension,extra);}):getWidthOrHeight(elem,dimension,extra);}},set:function(elem,value,extra){var matches,styles=getStyles(elem),scrollboxSizeBuggy=!support.scrollboxSize()&&styles.position==="absolute",boxSizingNeeded=scrollboxSizeBuggy||extra,isBorderBox=boxSizingNeeded&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",subtract=extra?boxModelAdjustment(elem,dimension,extra,isBorderBox,styles):0;if(isBorderBox&&scrollboxSizeBuggy){subtract-=Math.ceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-
parseFloat(styles[dimension])-
boxModelAdjustment(elem,dimension,"border",false,styles)-
0.5);}
if(subtract&&(matches=rcssNum.exec(value))&&(matches[3]||"px")!=="px"){elem.style[dimension]=value;value=jQuery.css(elem,dimension);}
return setPositiveNumber(elem,value,subtract);}};});jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){if(computed){return(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-
swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left;}))+"px";}});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];}
return expanded;}};if(prefix!=="margin"){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber;}});jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(Array.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles);}
return map;}
return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name);},name,value,arguments.length>1);}});function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing);}
jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||jQuery.easing._default;this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px");},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this);},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration);}else{this.pos=eased=percent;}
this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this);}
if(hooks&&hooks.set){hooks.set(this);}else{Tween.propHooks._default.set(this);}
return this;}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem.nodeType!==1||tween.elem[tween.prop]!=null&&tween.elem.style[tween.prop]==null){return tween.elem[tween.prop];}
result=jQuery.css(tween.elem,tween.prop,"");return!result||result==="auto"?0:result;},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween);}else if(tween.elem.nodeType===1&&(jQuery.cssHooks[tween.prop]||tween.elem.style[finalPropName(tween.prop)]!=null)){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit);}else{tween.elem[tween.prop]=tween.now;}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now;}}};jQuery.easing={linear:function(p){return p;},swing:function(p){return 0.5-Math.cos(p*Math.PI)/2;},_default:"swing"};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var
fxNow,inProgress,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;function schedule(){if(inProgress){if(document.hidden===false&&window.requestAnimationFrame){window.requestAnimationFrame(schedule);}else{window.setTimeout(schedule,jQuery.fx.interval);}
jQuery.fx.tick();}}
function createFxNow(){window.setTimeout(function(){fxNow=undefined;});return(fxNow=Date.now());}
function genFx(type,includeWidth){var which,i=0,attrs={height:type};includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type;}
if(includeWidth){attrs.opacity=attrs.width=type;}
return attrs;}
function createTween(value,prop,animation){var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if((tween=collection[index].call(animation,prop,value))){return tween;}}}
function defaultPrefilter(elem,props,opts){var prop,value,toggle,hooks,oldfire,propTween,restoreDisplay,display,isBox="width"in props||"height"in props,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHiddenWithinTree(elem),dataShow=dataPriv.get(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire();}};}
hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire();}});});}
for(prop in props){value=props[prop];if(rfxtypes.test(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=true;}else{continue;}}
orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop);}}
propTween=!jQuery.isEmptyObject(props);if(!propTween&&jQuery.isEmptyObject(orig)){return;}
if(isBox&&elem.nodeType===1){opts.overflow=[style.overflow,style.overflowX,style.overflowY];restoreDisplay=dataShow&&dataShow.display;if(restoreDisplay==null){restoreDisplay=dataPriv.get(elem,"display");}
display=jQuery.css(elem,"display");if(display==="none"){if(restoreDisplay){display=restoreDisplay;}else{showHide([elem],true);restoreDisplay=elem.style.display||restoreDisplay;display=jQuery.css(elem,"display");showHide([elem]);}}
if(display==="inline"||display==="inline-block"&&restoreDisplay!=null){if(jQuery.css(elem,"float")==="none"){if(!propTween){anim.done(function(){style.display=restoreDisplay;});if(restoreDisplay==null){display=style.display;restoreDisplay=display==="none"?"":display;}}
style.display="inline-block";}}}
if(opts.overflow){style.overflow="hidden";anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2];});}
propTween=false;for(prop in orig){if(!propTween){if(dataShow){if("hidden"in dataShow){hidden=dataShow.hidden;}}else{dataShow=dataPriv.access(elem,"fxshow",{display:restoreDisplay});}
if(toggle){dataShow.hidden=!hidden;}
if(hidden){showHide([elem],true);}
anim.done(function(){if(!hidden){showHide([elem]);}
dataPriv.remove(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop]);}});}
propTween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=propTween.start;if(hidden){propTween.end=propTween.start;propTween.start=0;}}}}
function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=camelCase(index);easing=specialEasing[name];value=props[index];if(Array.isArray(value)){easing=value[1];value=props[index]=value[0];}
if(index!==name){props[name]=value;delete props[index];}
hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing;}}}else{specialEasing[name]=easing;}}}
function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem;}),tick=function(){if(stopped){return false;}
var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent);}
deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining;}
if(!length){deferred.notifyWith(elem,[animation,1,0]);}
deferred.resolveWith(elem,[animation]);return false;},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween;},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this;}
stopped=true;for(;index<length;index++){animation.tweens[index].run(1);}
if(gotoEnd){deferred.notifyWith(elem,[animation,1,0]);deferred.resolveWith(elem,[animation,gotoEnd]);}else{deferred.rejectWith(elem,[animation,gotoEnd]);}
return this;}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=Animation.prefilters[index].call(animation,elem,props,animation.opts);if(result){if(isFunction(result.stop)){jQuery._queueHooks(animation.elem,animation.opts.queue).stop=result.stop.bind(result);}
return result;}}
jQuery.map(props,createTween,animation);if(isFunction(animation.opts.start)){animation.opts.start.call(elem,animation);}
animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always);jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation;}
jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);adjustCSS(tween.elem,prop,rcssNum.exec(value),tween);return tween;}]},tweener:function(props,callback){if(isFunction(props)){callback=props;props=["*"];}else{props=props.match(rnothtmlwhite);}
var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];Animation.tweeners[prop]=Animation.tweeners[prop]||[];Animation.tweeners[prop].unshift(callback);}},prefilters:[defaultPrefilter],prefilter:function(callback,prepend){if(prepend){Animation.prefilters.unshift(callback);}else{Animation.prefilters.push(callback);}}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!isFunction(easing)&&easing};if(jQuery.fx.off){opt.duration=0;}else{if(typeof opt.duration!=="number"){if(opt.duration in jQuery.fx.speeds){opt.duration=jQuery.fx.speeds[opt.duration];}else{opt.duration=jQuery.fx.speeds._default;}}}
if(opt.queue==null||opt.queue===true){opt.queue="fx";}
opt.old=opt.complete;opt.complete=function(){if(isFunction(opt.old)){opt.old.call(this);}
if(opt.queue){jQuery.dequeue(this,opt.queue);}};return opt;};jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHiddenWithinTree).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback);},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||dataPriv.get(this,"finish")){anim.stop(true);}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation);},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd);};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined;}
if(clearQueue){this.queue(type||"fx",[]);}
return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index]);}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index]);}}}
for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1);}}
if(dequeue||!gotoEnd){jQuery.dequeue(this,type);}});},finish:function(type){if(type!==false){type=type||"fx";}
return this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true);}
for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1);}}
for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this);}}
delete data.finish;});}});jQuery.each(["toggle","show","hide"],function(_i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback);};});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback);};});jQuery.timers=[];jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;fxNow=Date.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1);}}
if(!timers.length){jQuery.fx.stop();}
fxNow=undefined;};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);jQuery.fx.start();};jQuery.fx.interval=13;jQuery.fx.start=function(){if(inProgress){return;}
inProgress=true;schedule();};jQuery.fx.stop=function(){inProgress=null;};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout);};});};(function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox";support.checkOn=input.value!=="";support.optSelected=opt.selected;input=document.createElement("input");input.value="t";input.type="radio";support.radioValue=input.value==="t";})();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1);},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name);});}});jQuery.extend({attr:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(nType===3||nType===8||nType===2){return;}
if(typeof elem.getAttribute==="undefined"){return jQuery.prop(elem,name,value);}
if(nType!==1||!jQuery.isXMLDoc(elem)){hooks=jQuery.attrHooks[name.toLowerCase()]||(jQuery.expr.match.bool.test(name)?boolHook:undefined);}
if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);return;}
if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret;}
elem.setAttribute(name,value+"");return value;}
if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret;}
ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret;},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&value==="radio"&&nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val;}
return value;}}}},removeAttr:function(elem,value){var name,i=0,attrNames=value&&value.match(rnothtmlwhite);if(attrNames&&elem.nodeType===1){while((name=attrNames[i++])){elem.removeAttribute(name);}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name);}else{elem.setAttribute(name,name);}
return name;}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(_i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle,lowercaseName=name.toLowerCase();if(!isXML){handle=attrHandle[lowercaseName];attrHandle[lowercaseName]=ret;ret=getter(elem,name,isXML)!=null?lowercaseName:null;attrHandle[lowercaseName]=handle;}
return ret;};});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1);},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name];});}});jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(nType===3||nType===8||nType===2){return;}
if(nType!==1||!jQuery.isXMLDoc(elem)){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name];}
if(value!==undefined){if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret;}
return(elem[name]=value);}
if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret;}
return elem[name];},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");if(tabindex){return parseInt(tabindex,10);}
if(rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href){return 0;}
return-1;}}},propFix:{"for":"htmlFor","class":"className"}});if(!support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent&&parent.parentNode){parent.parentNode.selectedIndex;}
return null;},set:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex;}}}};}
jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this;});function stripAndCollapse(value){var tokens=value.match(rnothtmlwhite)||[];return tokens.join(" ");}
function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||"";}
function classesToArray(value){if(Array.isArray(value)){return value;}
if(typeof value==="string"){return value.match(rnothtmlwhite)||[];}
return[];}
jQuery.fn.extend({addClass:function(value){var classNames,cur,curValue,className,i,finalValue;if(isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)));});}
classNames=classesToArray(value);if(classNames.length){return this.each(function(){curValue=getClass(this);cur=this.nodeType===1&&(" "+stripAndCollapse(curValue)+" ");if(cur){for(i=0;i<classNames.length;i++){className=classNames[i];if(cur.indexOf(" "+className+" ")<0){cur+=className+" ";}}
finalValue=stripAndCollapse(cur);if(curValue!==finalValue){this.setAttribute("class",finalValue);}}});}
return this;},removeClass:function(value){var classNames,cur,curValue,className,i,finalValue;if(isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)));});}
if(!arguments.length){return this.attr("class","");}
classNames=classesToArray(value);if(classNames.length){return this.each(function(){curValue=getClass(this);cur=this.nodeType===1&&(" "+stripAndCollapse(curValue)+" ");if(cur){for(i=0;i<classNames.length;i++){className=classNames[i];while(cur.indexOf(" "+className+" ")>-1){cur=cur.replace(" "+className+" "," ");}}
finalValue=stripAndCollapse(cur);if(curValue!==finalValue){this.setAttribute("class",finalValue);}}});}
return this;},toggleClass:function(value,stateVal){var classNames,className,i,self,type=typeof value,isValidValue=type==="string"||Array.isArray(value);if(isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal);});}
if(typeof stateVal==="boolean"&&isValidValue){return stateVal?this.addClass(value):this.removeClass(value);}
classNames=classesToArray(value);return this.each(function(){if(isValidValue){self=jQuery(this);for(i=0;i<classNames.length;i++){className=classNames[i];if(self.hasClass(className)){self.removeClass(className);}else{self.addClass(className);}}}else if(value===undefined||type==="boolean"){className=getClass(this);if(className){dataPriv.set(this,"__className__",className);}
if(this.setAttribute){this.setAttribute("class",className||value===false?"":dataPriv.get(this,"__className__")||"");}}});},hasClass:function(selector){var className,elem,i=0;className=" "+selector+" ";while((elem=this[i++])){if(elem.nodeType===1&&(" "+stripAndCollapse(getClass(elem))+" ").indexOf(className)>-1){return true;}}
return false;}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,valueIsFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret;}
ret=elem.value;if(typeof ret==="string"){return ret.replace(rreturn,"");}
return ret==null?"":ret;}
return;}
valueIsFunction=isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return;}
if(valueIsFunction){val=value.call(this,i,jQuery(this).val());}else{val=value;}
if(val==null){val="";}else if(typeof val==="number"){val+="";}else if(Array.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+"";});}
hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val;}});}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:stripAndCollapse(jQuery.text(elem));}},select:{get:function(elem){var value,option,i,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one",values=one?null:[],max=one?index+1:options.length;if(index<0){i=max;}else{i=one?index:0;}
for(;i<max;i++){option=options[i];if((option.selected||i===index)&&!option.disabled&&(!option.parentNode.disabled||!nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value;}
values.push(value);}}
return values;},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if(option.selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1){optionSet=true;}}
if(!optionSet){elem.selectedIndex=-1;}
return values;}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(Array.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>-1);}}};if(!support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value;};}});support.focusin="onfocusin"in window;var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,stopPropagationCallback=function(e){e.stopPropagation();};jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,lastElement,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=lastElement=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return;}
if(rfocusMorph.test(type+jQuery.event.triggered)){return;}
if(type.indexOf(".")>-1){namespaces=type.split(".");type=namespaces.shift();namespaces.sort();}
ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem;}
data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return;}
if(!onlyHandlers&&!special.noBubble&&!isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode;}
for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur;}
if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window);}}
i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){lastElement=cur;event.type=i>1?bubbleType:special.bindType||type;handle=(dataPriv.get(cur,"events")||Object.create(null))[event.type]&&dataPriv.get(cur,"handle");if(handle){handle.apply(cur,data);}
handle=ontype&&cur[ontype];if(handle&&handle.apply&&acceptData(cur)){event.result=handle.apply(cur,data);if(event.result===false){event.preventDefault();}}}
event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&acceptData(elem)){if(ontype&&isFunction(elem[type])&&!isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null;}
jQuery.event.triggered=type;if(event.isPropagationStopped()){lastElement.addEventListener(type,stopPropagationCallback);}
elem[type]();if(event.isPropagationStopped()){lastElement.removeEventListener(type,stopPropagationCallback);}
jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp;}}}}
return event.result;},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:true});jQuery.event.trigger(e,null,elem);}});jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this);});},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true);}}});if(!support.focusin){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event));};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this.document||this,attaches=dataPriv.access(doc,fix);if(!attaches){doc.addEventListener(orig,handler,true);}
dataPriv.access(doc,fix,(attaches||0)+1);},teardown:function(){var doc=this.ownerDocument||this.document||this,attaches=dataPriv.access(doc,fix)-1;if(!attaches){doc.removeEventListener(orig,handler,true);dataPriv.remove(doc,fix);}else{dataPriv.access(doc,fix,attaches);}}};});}
var location=window.location;var nonce={guid:Date.now()};var rquery=(/\?/);jQuery.parseXML=function(data){var xml,parserErrorElem;if(!data||typeof data!=="string"){return null;}
try{xml=(new window.DOMParser()).parseFromString(data,"text/xml");}catch(e){}
parserErrorElem=xml&&xml.getElementsByTagName("parsererror")[0];if(!xml||parserErrorElem){jQuery.error("Invalid XML: "+(parserErrorElem?jQuery.map(parserErrorElem.childNodes,function(el){return el.textContent;}).join("\n"):data));}
return xml;};var
rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(Array.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v);}else{buildParams(prefix+"["+(typeof v==="object"&&v!=null?i:"")+"]",v,traditional,add);}});}else if(!traditional&&toType(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add);}}else{add(prefix,obj);}}
jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,valueOrFunction){var value=isFunction(valueOrFunction)?valueOrFunction():valueOrFunction;s[s.length]=encodeURIComponent(key)+"="+
encodeURIComponent(value==null?"":value);};if(a==null){return"";}
if(Array.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value);});}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add);}}
return s.join("&");};jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray());},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this;}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type));}).map(function(_i,elem){var val=jQuery(this).val();if(val==null){return null;}
if(Array.isArray(val)){return jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")};});}
return{name:elem.name,value:val.replace(rCRLF,"\r\n")};}).get();}});var
r20=/%20/g,rhash=/#.*$/,rantiCache=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");originAnchor.href=location.href;function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*";}
var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnothtmlwhite)||[];if(isFunction(func)){while((dataType=dataTypes[i++])){if(dataType[0]==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func);}else{(structure[dataType]=structure[dataType]||[]).push(func);}}}};}
function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=(structure===transports);function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false;}else if(seekingTransport){return!(selected=dataTypeOrTransport);}});return selected;}
return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*");}
function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:(deep||(deep={})))[key]=src[key];}}
if(deep){jQuery.extend(true,target,deep);}
return target;}
function ajaxHandleResponses(s,jqXHR,responses){var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type");}}
if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break;}}}
if(dataTypes[0]in responses){finalDataType=dataTypes[0];}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break;}
if(!firstDataType){firstDataType=type;}}
finalDataType=finalDataType||firstDataType;}
if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType);}
return responses[finalDataType];}}
function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv];}}
current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response;}
if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType);}
prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev;}else if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2];}else if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1]);}
break;}}}}
if(conv!==true){if(conv&&s.throws){response=conv(response);}else{try{response=conv(response);}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current};}}}}}}
return{state:"success",data:response};}
jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:rlocalProtocol.test(location.protocol),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":JSON.parse,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target);},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined;}
options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,completed,fireGlobals,i,uncached,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(completed){if(!responseHeaders){responseHeaders={};while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()+" "]=(responseHeaders[match[1].toLowerCase()+" "]||[]).concat(match[2]);}}
match=responseHeaders[key.toLowerCase()+" "];}
return match==null?null:match.join(", ");},getAllResponseHeaders:function(){return completed?responseHeadersString:null;},setRequestHeader:function(name,value){if(completed==null){name=requestHeadersNames[name.toLowerCase()]=requestHeadersNames[name.toLowerCase()]||name;requestHeaders[name]=value;}
return this;},overrideMimeType:function(type){if(completed==null){s.mimeType=type;}
return this;},statusCode:function(map){var code;if(map){if(completed){jqXHR.always(map[jqXHR.status]);}else{for(code in map){statusCode[code]=[statusCode[code],map[code]];}}}
return this;},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText);}
done(0,finalText);return this;}};deferred.promise(jqXHR);s.url=((url||s.url||location.href)+"").replace(rprotocol,location.protocol+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=(s.dataType||"*").toLowerCase().match(rnothtmlwhite)||[""];if(s.crossDomain==null){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url;urlAnchor.href=urlAnchor.href;s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!==urlAnchor.protocol+"//"+urlAnchor.host;}catch(e){s.crossDomain=true;}}
if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional);}
inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(completed){return jqXHR;}
fireGlobals=jQuery.event&&s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart");}
s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url.replace(rhash,"");if(!s.hasContent){uncached=s.url.slice(cacheURL.length);if(s.data&&(s.processData||typeof s.data==="string")){cacheURL+=(rquery.test(cacheURL)?"&":"?")+s.data;delete s.data;}
if(s.cache===false){cacheURL=cacheURL.replace(rantiCache,"$1");uncached=(rquery.test(cacheURL)?"&":"?")+"_="+(nonce.guid++)+
uncached;}
s.url=cacheURL+uncached;}else if(s.data&&s.processData&&(s.contentType||"").indexOf("application/x-www-form-urlencoded")===0){s.data=s.data.replace(r20,"+");}
if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]);}
if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL]);}}
if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType);}
jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+
(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i]);}
if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||completed)){return jqXHR.abort();}
strAbort="abort";completeDeferred.add(s.complete);jqXHR.done(s.success);jqXHR.fail(s.error);transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport");}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s]);}
if(completed){return jqXHR;}
if(s.async&&s.timeout>0){timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout");},s.timeout);}
try{completed=false;transport.send(requestHeaders,done);}catch(e){if(completed){throw e;}
done(-1,e);}}
function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(completed){return;}
completed=true;if(timeoutTimer){window.clearTimeout(timeoutTimer);}
transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses);}
if(!isSuccess&&jQuery.inArray("script",s.dataTypes)>-1&&jQuery.inArray("json",s.dataTypes)<0){s.converters["text script"]=function(){};}
response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified;}
modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified;}}
if(status===204||s.type==="HEAD"){statusText="nocontent";}else if(status===304){statusText="notmodified";}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error;}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0;}}}
jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR]);}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);}
jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]);}
completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop");}}}
return jqXHR;},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json");},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script");}});jQuery.each(["get","post"],function(_i,method){jQuery[method]=function(url,data,callback,type){if(isFunction(data)){type=type||callback;callback=data;data=undefined;}
return jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url));};});jQuery.ajaxPrefilter(function(s){var i;for(i in s.headers){if(i.toLowerCase()==="content-type"){s.contentType=s.headers[i]||"";}}});jQuery._evalUrl=function(url,options,doc){return jQuery.ajax({url:url,type:"GET",dataType:"script",cache:true,async:false,global:false,converters:{"text script":function(){}},dataFilter:function(response){jQuery.globalEval(response,options,doc);}});};jQuery.fn.extend({wrapAll:function(html){var wrap;if(this[0]){if(isFunction(html)){html=html.call(this[0]);}
wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0]);}
wrap.map(function(){var elem=this;while(elem.firstElementChild){elem=elem.firstElementChild;}
return elem;}).append(this);}
return this;},wrapInner:function(html){if(isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i));});}
return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html);}else{self.append(html);}});},wrap:function(html){var htmlIsFunction=isFunction(html);return this.each(function(i){jQuery(this).wrapAll(htmlIsFunction?html.call(this,i):html);});},unwrap:function(selector){this.parent(selector).not("body").each(function(){jQuery(this).replaceWith(this.childNodes);});return this;}});jQuery.expr.pseudos.hidden=function(elem){return!jQuery.expr.pseudos.visible(elem);};jQuery.expr.pseudos.visible=function(elem){return!!(elem.offsetWidth||elem.offsetHeight||elem.getClientRects().length);};jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest();}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&("withCredentials"in xhrSupported);support.ajax=xhrSupported=!!xhrSupported;jQuery.ajaxTransport(function(options){var callback,errorCallback;if(support.cors||xhrSupported&&!options.crossDomain){return{send:function(headers,complete){var i,xhr=options.xhr();xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i];}}
if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType);}
if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest";}
for(i in headers){xhr.setRequestHeader(i,headers[i]);}
callback=function(type){return function(){if(callback){callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.ontimeout=xhr.onreadystatechange=null;if(type==="abort"){xhr.abort();}else if(type==="error"){if(typeof xhr.status!=="number"){complete(0,"error");}else{complete(xhr.status,xhr.statusText);}}else{complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,(xhr.responseType||"text")!=="text"||typeof xhr.responseText!=="string"?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders());}}};};xhr.onload=callback();errorCallback=xhr.onerror=xhr.ontimeout=callback("error");if(xhr.onabort!==undefined){xhr.onabort=errorCallback;}else{xhr.onreadystatechange=function(){if(xhr.readyState===4){window.setTimeout(function(){if(callback){errorCallback();}});}};}
callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null);}catch(e){if(callback){throw e;}}},abort:function(){if(callback){callback();}}};}});jQuery.ajaxPrefilter(function(s){if(s.crossDomain){s.contents.script=false;}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, "+"application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){jQuery.globalEval(text);return text;}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false;}
if(s.crossDomain){s.type="GET";}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain||s.scriptAttrs){var script,callback;return{send:function(_,complete){script=jQuery("<script>").attr(s.scriptAttrs||{}).prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove();callback=null;if(evt){complete(evt.type==="error"?404:200,evt.type);}});document.head.appendChild(script[0]);},abort:function(){if(callback){callback();}}};}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||(jQuery.expando+"_"+(nonce.guid++));this[callback]=true;return callback;}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&(s.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName);}else if(s.jsonp!==false){s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName;}
s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called");}
return responseContainer[0];};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments;};jqXHR.always(function(){if(overwritten===undefined){jQuery(window).removeProp(callbackName);}else{window[callbackName]=overwritten;}
if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName);}
if(responseContainer&&isFunction(overwritten)){overwritten(responseContainer[0]);}
responseContainer=overwritten=undefined;});return"script";}});support.createHTMLDocument=(function(){var body=document.implementation.createHTMLDocument("").body;body.innerHTML="<form></form><form></form>";return body.childNodes.length===2;})();jQuery.parseHTML=function(data,context,keepScripts){if(typeof data!=="string"){return[];}
if(typeof context==="boolean"){keepScripts=context;context=false;}
var base,parsed,scripts;if(!context){if(support.createHTMLDocument){context=document.implementation.createHTMLDocument("");base=context.createElement("base");base.href=document.location.href;context.head.appendChild(base);}else{context=document;}}
parsed=rsingleTag.exec(data);scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])];}
parsed=buildFragment([data],context,scripts);if(scripts&&scripts.length){jQuery(scripts).remove();}
return jQuery.merge([],parsed.childNodes);};jQuery.fn.load=function(url,params,callback){var selector,type,response,self=this,off=url.indexOf(" ");if(off>-1){selector=stripAndCollapse(url.slice(off));url=url.slice(0,off);}
if(isFunction(params)){callback=params;params=undefined;}else if(params&&typeof params==="object"){type="POST";}
if(self.length>0){jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText);}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR]);});});}
return this;};jQuery.expr.pseudos.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem;}).length;};jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};if(position==="static"){elem.style.position="relative";}
curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&(curCSSTop+curCSSLeft).indexOf("auto")>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left;}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0;}
if(isFunction(options)){options=options.call(elem,i,jQuery.extend({},curOffset));}
if(options.top!=null){props.top=(options.top-curOffset.top)+curTop;}
if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft;}
if("using"in options){options.using.call(elem,props);}else{curElem.css(props);}}};jQuery.fn.extend({offset:function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i);});}
var rect,win,elem=this[0];if(!elem){return;}
if(!elem.getClientRects().length){return{top:0,left:0};}
rect=elem.getBoundingClientRect();win=elem.ownerDocument.defaultView;return{top:rect.top+win.pageYOffset,left:rect.left+win.pageXOffset};},position:function(){if(!this[0]){return;}
var offsetParent,offset,doc,elem=this[0],parentOffset={top:0,left:0};if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect();}else{offset=this.offset();doc=elem.ownerDocument;offsetParent=elem.offsetParent||doc.documentElement;while(offsetParent&&(offsetParent===doc.body||offsetParent===doc.documentElement)&&jQuery.css(offsetParent,"position")==="static"){offsetParent=offsetParent.parentNode;}
if(offsetParent&&offsetParent!==elem&&offsetParent.nodeType===1){parentOffset=jQuery(offsetParent).offset();parentOffset.top+=jQuery.css(offsetParent,"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent,"borderLeftWidth",true);}}
return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)};},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent;while(offsetParent&&jQuery.css(offsetParent,"position")==="static"){offsetParent=offsetParent.offsetParent;}
return offsetParent||documentElement;});}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win;if(isWindow(elem)){win=elem;}else if(elem.nodeType===9){win=elem.defaultView;}
if(val===undefined){return win?win[prop]:elem[method];}
if(win){win.scrollTo(!top?val:win.pageXOffset,top?val:win.pageYOffset);}else{elem[method]=val;}},method,val,arguments.length);};});jQuery.each(["top","left"],function(_i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed;}});});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return access(this,function(elem,type,value){var doc;if(isWindow(elem)){return funcName.indexOf("outer")===0?elem["inner"+name]:elem.document.documentElement["client"+name];}
if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name]);}
return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra);},type,chainable?margin:undefined,chainable);};});});jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(_i,type){jQuery.fn[type]=function(fn){return this.on(type,fn);};});jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn);},unbind:function(types,fn){return this.off(types,null,fn);},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn);},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn);},hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver);}});jQuery.each(("blur focus focusin focusout resize scroll click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup contextmenu").split(" "),function(_i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name);};});var rtrim=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;jQuery.proxy=function(fn,context){var tmp,args,proxy;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp;}
if(!isFunction(fn)){return undefined;}
args=slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)));};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy;};jQuery.holdReady=function(hold){if(hold){jQuery.readyWait++;}else{jQuery.ready(true);}};jQuery.isArray=Array.isArray;jQuery.parseJSON=JSON.parse;jQuery.nodeName=nodeName;jQuery.isFunction=isFunction;jQuery.isWindow=isWindow;jQuery.camelCase=camelCase;jQuery.type=toType;jQuery.now=Date.now;jQuery.isNumeric=function(obj){var type=jQuery.type(obj);return(type==="number"||type==="string")&&!isNaN(obj-parseFloat(obj));};jQuery.trim=function(text){return text==null?"":(text+"").replace(rtrim,"$1");};if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery;});}
var
_jQuery=window.jQuery,_$=window.$;jQuery.noConflict=function(deep){if(window.$===jQuery){window.$=_$;}
if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery;}
return jQuery;};if(typeof noGlobal==="undefined"){window.jQuery=window.$=jQuery;}
return jQuery;});;

/* /web/static/src/legacy/js/libs/jquery.js */
odoo.define('@web/legacy/js/libs/jquery',[],function(require){'use strict';let __exports={};$.extend($.expr[':'],{containsLike:function(element,index,matches){return element.innerHTML.toUpperCase().indexOf(matches[3].toUpperCase())>=0;},containsTextLike:function(element,index,matches){return element.innerText.toUpperCase().indexOf(matches[3].toUpperCase())>=0;},containsExact:function(element,index,matches){return $.trim(element.innerHTML)===matches[3];},containsExactText:function(element,index,matches){return element.innerText.trim()===matches[3].trim();},containsRegex:function(element,index,matches){var regreg=/^\/((?:\\\/|[^\/])+)\/([mig]{0,3})$/,reg=regreg.exec(matches[3]);return reg?new RegExp(reg[1],reg[2]).test($.trim(element.innerHTML)):false;},propChecked:function(element,index,matches){return $(element).prop("checked")===true;},propSelected:function(element,index,matches){return $(element).prop("selected")===true;},propValue:function(element,index,matches){return $(element).prop("value")===matches[3];},propValueContains:function(element,index,matches){return $(element).prop("value")&&$(element).prop("value").indexOf(matches[3])!==-1;},hasData:function(element){return!!_.toArray(element.dataset).length;},data:function(element,index,matches){return $(element).data(matches[3]);},hasVisibility:function(element,index,matches){var $element=$(element);if($(element).css('visibility')==='hidden'){return false;}
var $parent=$element.parent();if(!$parent.length||$element.is('html')){return true;}
return $parent.is(':hasVisibility');},hasOpacity:function(element,index,matches){var $element=$(element);if(parseFloat($(element).css('opacity'))<=0.01){return false;}
var $parent=$element.parent();if(!$parent.length||$element.is('html')){return true;}
return $parent.is(':hasOpacity');},});$.fn.extend({getAttributes:function(){var o={};if(this.length){var attrs=this[0].attributes;for(var i=0,l=attrs.length;i<l;i++){var attr=attrs.item(i);o[attr.name]=attr.value;}}
return o;},odooBounce:function(extraClass){for(const el of this){el.classList.add('o_catch_attention',extraClass);setTimeout(()=>el.classList.remove('o_catch_attention',extraClass),400);}
return this;},prependEvent:function(events,selector,data,handler){this.on.apply(this,arguments);events=events.split(' ');return this.each(function(){var el=this;events.forEach((evNameNamespaced)=>{var evName=evNameNamespaced.split('.')[0];var handler=$._data(el,'events')[evName].pop();$._data(el,'events')[evName].unshift(handler);});});},closestScrollable(){const document=this.length?this[0].ownerDocument:window.document;let $el=this;while($el[0]!==document.scrollingElement){if(!$el.length||$el[0]instanceof Document){return $();}
if($el.isScrollable()){return $el;}
$el=$el.parent();}
return $el;},compensateScrollbar(add=true,isScrollElement=true,cssProperty='padding-right'){for(const el of this){const scrollableEl=isScrollElement?el:$(el).parent().closestScrollable()[0];const isRTL=scrollableEl.matches(".o_rtl");if(isRTL){cssProperty=cssProperty.replace("right","left");}
el.style.removeProperty(cssProperty);if(!add){return;}
const style=window.getComputedStyle(el);const borderLeftWidth=Math.ceil(parseFloat(style.borderLeftWidth.replace('px','')));const borderRightWidth=Math.ceil(parseFloat(style.borderRightWidth.replace('px','')));const bordersWidth=borderLeftWidth+borderRightWidth;const newValue=parseInt(style[cssProperty])+scrollableEl.offsetWidth-scrollableEl.clientWidth-bordersWidth;el.style.setProperty(cssProperty,`${newValue}px`,'important');}},getScrollingElement(document=window.document){const $baseScrollingElement=$(document.scrollingElement);if($baseScrollingElement.isScrollable()&&$baseScrollingElement.hasScrollableContent()){return $baseScrollingElement;}
const bodyHeight=$(document.body).height();for(const el of document.body.children){if(bodyHeight-el.scrollHeight>1.5){continue;}
const $el=$(el);if($el.isScrollable()){return $el;}}
return $baseScrollingElement;},getScrollingTarget(contextItem=window.document){const isElement=obj=>obj&&obj.nodeType===Node.ELEMENT_NODE;const isJQuery=obj=>obj&&('jquery'in obj);const $scrollingElement=isElement(contextItem)?$(contextItem):isJQuery(contextItem)?contextItem:$().getScrollingElement(contextItem);const document=$scrollingElement[0].ownerDocument;return $scrollingElement.is(document.scrollingElement)?$(document.defaultView):$scrollingElement;},hasScrollableContent(){return this[0].scrollHeight>this[0].clientHeight;},isScrollable(){if(!this.length){return false;}
const overflow=this.css('overflow-y');const el=this[0];return overflow==='auto'||overflow==='scroll'||(overflow==='visible'&&el===el.ownerDocument.scrollingElement);},});const originalScrollTop=$.fn.scrollTop;$.fn.scrollTop=function(value){if(value!==undefined&&this.filter('html, body').length){const $withRealScrollable=this.not('html, body').add($().getScrollingElement(this[0].ownerDocument));originalScrollTop.apply($withRealScrollable,arguments);return this;}else if(value===undefined&&this.eq(0).is('html, body')){return originalScrollTop.apply($().getScrollingElement(this[0].ownerDocument),arguments);}
return originalScrollTop.apply(this,arguments);};const originalAnimate=$.fn.animate;$.fn.animate=function(properties,...rest){const props=Object.assign({},properties);if('scrollTop'in props&&this.filter('html, body').length){const $withRealScrollable=this.not('html, body').add($().getScrollingElement(this[0].ownerDocument));originalAnimate.call($withRealScrollable,{'scrollTop':props['scrollTop']},...rest);delete props['scrollTop'];}
if(!Object.keys(props).length){return this;}
return originalAnimate.call(this,props,...rest);};return __exports;});;

/* /web_tour/static/src/tour_pointer/tour_pointer.js */
odoo.define('@web_tour/tour_pointer/tour_pointer',['@odoo/owl','@web/core/position_hook'],function(require){'use strict';let __exports={};const{Component,useEffect,useRef}=require("@odoo/owl");const{usePosition}=require("@web/core/position_hook");const TourPointer=__exports.TourPointer=class TourPointer extends Component{static props={pointerState:{type:Object,shape:{anchor:{type:HTMLElement,optional:true},content:{type:String,optional:true},isOpen:{type:Boolean,optional:true},isVisible:{type:Boolean,optional:true},onClick:{type:[Function,{value:null}],optional:true},onMouseEnter:{type:[Function,{value:null}],optional:true},onMouseLeave:{type:[Function,{value:null}],optional:true},position:{type:[{value:"left"},{value:"right"},{value:"top"},{value:"bottom"},],optional:true,},rev:{type:Number,optional:true},},},bounce:{type:Boolean,optional:true},};static defaultProps={bounce:true,};static template="web_tour.TourPointer";static width=28;static height=28;setup(){const positionOptions={margin:6,onPositioned:(pointer,position)=>{const popperRect=pointer.getBoundingClientRect();const{top,left,direction}=position;if(direction==="top"){pointer.style.bottom=`${window.innerHeight - top - popperRect.height}px`;pointer.style.removeProperty("top");}else if(direction==="left"){pointer.style.right=`${window.innerWidth - left - popperRect.width}px`;pointer.style.removeProperty("left");}},};Object.defineProperty(positionOptions,"position",{get:()=>this.position,enumerable:true});const position=usePosition("pointer",()=>this.props.pointerState.anchor,positionOptions);const rootRef=useRef("pointer");let dimensions=null;let lastMeasuredContent=null;let lastOpenState=this.isOpen;let lastAnchor;let[anchorX,anchorY]=[0,0];useEffect(()=>{const{el:pointer}=rootRef;if(pointer){const hasContentChanged=lastMeasuredContent!==this.content;const hasOpenStateChanged=lastOpenState!==this.isOpen;lastOpenState=this.isOpen;if(hasContentChanged){lastMeasuredContent=this.content;pointer.style.removeProperty("width");pointer.style.removeProperty("height");dimensions=pointer.getBoundingClientRect();}
if(hasContentChanged||hasOpenStateChanged){const[width,height]=this.isOpen?[dimensions.width,dimensions.height]:[this.constructor.width,this.constructor.height];if(this.isOpen){pointer.style.removeProperty("transition");}else{pointer.style.setProperty("transition","none");}
pointer.style.setProperty("width",`${width}px`);pointer.style.setProperty("height",`${height}px`);}
if(!this.isOpen){const{anchor}=this.props.pointerState;if(anchor===lastAnchor){const{x,y,width}=anchor.getBoundingClientRect();const[lastAnchorX,lastAnchorY]=[anchorX,anchorY];[anchorX,anchorY]=[x,y];const delta=Math.sqrt(Math.pow(x-lastAnchorX,2)+Math.pow(y-lastAnchorY,2));if(delta<1){position.lock();return;}
const wouldOverflow=window.innerWidth-x-width/2<dimensions?.width;pointer.classList.toggle("o_expand_left",wouldOverflow);}
lastAnchor=anchor;pointer.style.bottom="";pointer.style.right="";position.unlock();}}else{lastMeasuredContent=null;lastOpenState=false;lastAnchor=null;dimensions=null;}});}
get content(){return this.props.pointerState.content||"";}
get isOpen(){return this.props.pointerState.isOpen;}
get position(){return this.props.pointerState.position||"top";}}
return __exports;});;

/* /web_tour/static/src/tour_service/tour_compilers.js */
odoo.define('@web_tour/tour_service/tour_compilers',['@web/core/browser/browser','@web/core/utils/timing','@web/core/utils/ui','@web_tour/tour_service/tour_state','@web_tour/tour_service/tour_utils'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{debounce}=require("@web/core/utils/timing");const{isVisible}=require("@web/core/utils/ui");const{tourState}=require("@web_tour/tour_service/tour_state");const{callWithUnloadCheck,getConsumeEventType,getFirstVisibleElement,getJQueryElementFromSelector,getScrollParent,RunningTourActionHelper,}=require("@web_tour/tour_service/tour_utils");function findTrigger(selector,inModal,shadowDOM){const $target=$(shadowDOM?document.querySelector(shadowDOM)?.shadowRoot:document);const $visibleModal=$target.find(".modal:visible").last();let $el;if(inModal!==false&&$visibleModal.length){$el=$visibleModal.find(selector);}else{$el=getJQueryElementFromSelector(selector,$target);}
return getFirstVisibleElement($el).get(0);}
function findExtraTrigger(selector,shadowDOM){const $target=$(shadowDOM?document.querySelector(shadowDOM)?.shadowRoot:document);const $el=getJQueryElementFromSelector(selector,$target);return getFirstVisibleElement($el).get(0);}
function findStepTriggers(step){const triggerEl=findTrigger(step.trigger,step.in_modal,step.shadow_dom);const altEl=findTrigger(step.alt_trigger,step.in_modal,step.shadow_dom);const skipEl=findTrigger(step.skip_trigger,step.in_modal,step.shadow_dom);const extraTriggerOkay=step.extra_trigger?findExtraTrigger(step.extra_trigger,step.shadow_dom):true;return{triggerEl,altEl,extraTriggerOkay,skipEl};}
function describeStep(step){return step.content?`${step.content} (trigger: ${step.trigger})`:step.trigger;}
function describeFailedStepSimple(step,tour){return`Tour ${tour.name} failed at step ${describeStep(step)}`;}
function describeFailedStepDetailed(step,tour){const offset=3;const stepIndex=tour.steps.findIndex((s)=>s===step);const start=stepIndex-offset>=0?stepIndex-offset:0;const end=stepIndex+offset+1<=tour.steps.length?stepIndex+offset+1:tour.steps.length;let result="";for(let i=start;i<end;i++){const highlight=i===stepIndex;const stepString=JSON.stringify(tour.steps[i],(_key,value)=>{if(typeof value==="function"){return"[function]";}else{return value;}},2);result+=`\n${highlight ? "----- FAILING STEP -----\n" : ""}${stepString},${
            highlight ? "\n-----------------------" : ""
        }`;}
return`${describeFailedStepSimple(step, tour)}\n\n${result.trim()}`;}
function getAnchorEl(el,consumeEvent){if(consumeEvent==="drag"){return el.closest(".ui-draggable, .o_draggable");}
if(consumeEvent==="input"&&!["textarea","input"].includes(el.tagName.toLowerCase())){return el.closest("[contenteditable='true']");}
if(consumeEvent==="sort"){return el.closest(".ui-sortable, .o_sortable");}
return el;}
function canContinue(el,step){const rootNode=el.getRootNode();const isInDoc=rootNode instanceof ShadowRoot?el.ownerDocument.contains(rootNode.host):el.ownerDocument.contains(el);const isElement=el instanceof el.ownerDocument.defaultView.Element||el instanceof Element;const isBlocked=document.body.classList.contains("o_ui_blocked")||document.querySelector(".o_blockUI");return(isInDoc&&isElement&&!isBlocked&&(!step.allowInvisible?isVisible(el):true)&&(!el.disabled||step.isCheck));}
function setupListeners({anchorEl,consumeEvent,onMouseEnter,onMouseLeave,onScroll,onConsume,}){anchorEl.addEventListener(consumeEvent,onConsume);anchorEl.addEventListener("mouseenter",onMouseEnter);anchorEl.addEventListener("mouseleave",onMouseLeave);const cleanups=[()=>{anchorEl.removeEventListener(consumeEvent,onConsume);anchorEl.removeEventListener("mouseenter",onMouseEnter);anchorEl.removeEventListener("mouseleave",onMouseLeave);},];const scrollEl=getScrollParent(anchorEl);if(scrollEl){const debouncedOnScroll=debounce(onScroll,50);scrollEl.addEventListener("scroll",debouncedOnScroll);cleanups.push(()=>scrollEl.removeEventListener("scroll",debouncedOnScroll));}
return()=>{while(cleanups.length){cleanups.pop()();}};}
__exports.compileStepManual=compileStepManual;function compileStepManual(stepIndex,step,options){const{tour,pointer,onStepConsummed}=options;let proceedWith=null;let removeListeners=()=>{};return[{action:()=>console.log(step.trigger),},{trigger:()=>{removeListeners();if(proceedWith){return proceedWith;}
const{triggerEl,altEl,extraTriggerOkay,skipEl}=findStepTriggers(step);if(skipEl){return skipEl;}
const stepEl=extraTriggerOkay&&(triggerEl||altEl);if(stepEl&&canContinue(stepEl,step)){const consumeEvent=step.consumeEvent||getConsumeEventType(stepEl,step.run);const anchorEl=getAnchorEl(stepEl,consumeEvent);const debouncedToggleOpen=debounce(pointer.showContent,50,true);const updatePointer=()=>{pointer.setState({onMouseEnter:()=>debouncedToggleOpen(true),onMouseLeave:()=>debouncedToggleOpen(false),});pointer.pointTo(anchorEl,step);};removeListeners=setupListeners({anchorEl,consumeEvent,onMouseEnter:()=>pointer.showContent(true),onMouseLeave:()=>pointer.showContent(false),onScroll:updatePointer,onConsume:()=>{proceedWith=stepEl;pointer.hide();},});updatePointer();}else{pointer.hide();}},action:()=>{tourState.set(tour.name,"currentIndex",stepIndex+1);pointer.hide();proceedWith=null;onStepConsummed(tour,step);},},];}
let tourTimeout;__exports.compileStepAuto=compileStepAuto;function compileStepAuto(stepIndex,step,options){const{tour,pointer,stepDelay,keepWatchBrowser,showPointerDuration,onStepConsummed}=options;let skipAction=false;return[{action:async()=>{await new Promise(resolve=>requestAnimationFrame(resolve))},},{action:async()=>{skipAction=false;console.log(`Tour ${tour.name} on step: '${describeStep(step)}'`);if(!keepWatchBrowser){browser.clearTimeout(tourTimeout);tourTimeout=browser.setTimeout(()=>{console.warn(describeFailedStepDetailed(step,tour));console.error(describeFailedStepSimple(step,tour));},(step.timeout||10000)+stepDelay);}
await new Promise((resolve)=>browser.setTimeout(resolve,stepDelay));},},{trigger:()=>{const{triggerEl,altEl,extraTriggerOkay,skipEl}=findStepTriggers(step);let stepEl=extraTriggerOkay&&(triggerEl||altEl);if(skipEl){skipAction=true;stepEl=skipEl;}
if(!stepEl){return false;}
return canContinue(stepEl,step)&&stepEl;},action:async(stepEl)=>{tourState.set(tour.name,"currentIndex",stepIndex+1);if(skipAction){return;}
const consumeEvent=step.consumeEvent||getConsumeEventType(stepEl,step.run);const $anchorEl=$(stepEl);if(showPointerDuration>0){pointer.pointTo($anchorEl.get(0),step);await new Promise((r)=>browser.setTimeout(r,showPointerDuration));pointer.hide();}
const actionHelper=new RunningTourActionHelper({consume_event:consumeEvent,$anchor:$anchorEl,});let result;if(typeof step.run==="function"){const willUnload=await callWithUnloadCheck(()=>step.run.call({$anchor:$anchorEl},actionHelper));result=willUnload&&"will unload";}else if(step.run!==undefined){const m=step.run.match(/^([a-zA-Z0-9_]+) *(?:\(? *(.+?) *\)?)?$/);actionHelper[m[1]](m[2]);}else if(!step.isCheck){if(stepIndex===tour.steps.length-1){console.warn('Tour %s: ignoring action (auto) of last step',tour.name);}else{actionHelper.auto();}}
return result;},},{action:()=>{onStepConsummed(tour,step);},},];}
__exports.compileTourToMacro=compileTourToMacro;function compileTourToMacro(tour,options){const{filteredSteps,stepCompiler,pointer,stepDelay,keepWatchBrowser,showPointerDuration,checkDelay,onStepConsummed,onTourEnd,}=options;const currentStepIndex=tourState.get(tour.name,"currentIndex");return{...tour,checkDelay,steps:filteredSteps.reduce((newSteps,step,i)=>{if(i<currentStepIndex){return newSteps;}else{return[...newSteps,...stepCompiler(i,step,{tour,pointer,stepDelay,keepWatchBrowser,showPointerDuration,onStepConsummed,}),];}},[]).concat([{action(){tourState.clear(tour.name);onTourEnd(tour);clearTimeout(tourTimeout);},},]),};}
return __exports;});;

/* /web_tour/static/src/tour_service/tour_pointer_state.js */
odoo.define('@web_tour/tour_service/tour_pointer_state',['@odoo/owl','@web/core/l10n/translation','@web_tour/tour_pointer/tour_pointer','@web_tour/tour_service/tour_utils'],function(require){'use strict';let __exports={};const{reactive}=require("@odoo/owl");const{_t}=require("@web/core/l10n/translation");const{TourPointer}=require("@web_tour/tour_pointer/tour_pointer");const{getScrollParent}=require("@web_tour/tour_service/tour_utils");class Intersection{constructor(){this.currentTarget=null;this.rootBounds=null;this._targetPosition="unknown";this._observer=new IntersectionObserver((observations)=>this._handleObservations(observations));}
_handleObservations(observations){if(observations.length<1){return;}
const observation=observations[observations.length-1];this.rootBounds=observation.rootBounds;if(this.rootBounds&&this.currentTarget){if(observation.isIntersecting){this._targetPosition="in";}else{const targetBounds=this.currentTarget.getBoundingClientRect();if(targetBounds.bottom<this.rootBounds.height/2){this._targetPosition="out-above";}else if(targetBounds.top>this.rootBounds.height/2){this._targetPosition="out-below";}}}else{this._targetPosition="unknown";}}
get targetPosition(){if(!this.rootBounds){return this.currentTarget?"in":"unknown";}else{return this._targetPosition;}}
setTarget(newTarget){if(this.currentTarget!==newTarget){if(this.currentTarget){this._observer.unobserve(this.currentTarget);}
if(newTarget){this._observer.observe(newTarget);}
this.currentTarget=newTarget;}}
stop(){this._observer.disconnect();}}
__exports.createPointerState=createPointerState;function createPointerState(){const setState=(newState)=>{Object.assign(state,newState);};const pointTo=(anchor,step)=>{intersection.setTarget(anchor);if(anchor){let{position,content}=step;switch(intersection.targetPosition){case"unknown":{break;}
case"in":{if(document.body.contains(floatingAnchor)){floatingAnchor.remove();}
setState({anchor,content,onClick:null,position,isVisible:true});break;}
default:{const onClick=()=>{anchor.scrollIntoView({behavior:"smooth",block:"nearest"});hide();};const scrollParent=getScrollParent(anchor);if(!scrollParent){setState({anchor,content,onClick:null,position,isVisible:true});return;}
const{x,y,width,height}=scrollParent.getBoundingClientRect();floatingAnchor.style.left=`${x + width / 2}px`;if(intersection.targetPosition==="out-below"){position="top";content=_t("Scroll down to reach the next step.");floatingAnchor.style.top=`${y + height - TourPointer.height}px`;}else if(intersection.targetPosition==="out-above"){position="bottom";content=_t("Scroll up to reach the next step.");floatingAnchor.style.top=`${y + TourPointer.height}px`;}
if(!document.contains(floatingAnchor)){document.body.appendChild(floatingAnchor);}
setState({anchor:floatingAnchor,content,onClick,position,isVisible:true,});}}}else{hide();}};function hide(){setState({content:"",isVisible:false,isOpen:false});}
function showContent(isOpen){setState({isOpen});}
function destroy(){intersection.stop();if(document.body.contains(floatingAnchor)){floatingAnchor.remove();}}
const state=reactive({});const intersection=new Intersection();const floatingAnchor=document.createElement("div");floatingAnchor.className="position-fixed";return{state,methods:{setState,showContent,pointTo,hide,destroy}};}
return __exports;});;

/* /web_tour/static/src/tour_service/tour_service.js */
odoo.define('@web_tour/tour_service/tour_service',['@odoo/owl','@web/core/browser/browser','@web/core/l10n/translation','@web/core/macro','@web/core/registry','@web/core/transition','@web/session','@web_tour/tour_pointer/tour_pointer','@web_tour/tour_service/tour_compilers','@web_tour/tour_service/tour_pointer_state','@web_tour/tour_service/tour_state','@web_tour/tour_service/tour_utils'],function(require){'use strict';let __exports={};const{EventBus,markup,whenReady,reactive}=require("@odoo/owl");const{browser}=require("@web/core/browser/browser");const{_t}=require("@web/core/l10n/translation");const{MacroEngine}=require("@web/core/macro");const{registry}=require("@web/core/registry");const{config:transitionConfig}=require("@web/core/transition");const{session}=require("@web/session");const{TourPointer}=require("@web_tour/tour_pointer/tour_pointer");const{compileStepAuto,compileStepManual,compileTourToMacro}=require("@web_tour/tour_service/tour_compilers");const{createPointerState}=require("@web_tour/tour_service/tour_pointer_state");const{tourState}=require("@web_tour/tour_service/tour_state");const{callWithUnloadCheck}=require("@web_tour/tour_service/tour_utils");const tourService=__exports.tourService={dependencies:["orm","effect","ui","overlay","localization"],start:async(_env,{orm,effect,ui,overlay})=>{await whenReady();const toursEnabled="tour_disable"in session&&!session.tour_disable;const consumedTours=new Set(session.web_tours);const tours={};const tourRegistry=registry.category("web_tour.tours");function register(name,tour){name=tour.saveAs||name;const wait_for=tour.wait_for||Promise.resolve();let steps;tours[name]={wait_for,name,get steps(){if(typeof tour.steps!=="function"){throw new Error(`tour.steps has to be a function that returns TourStep[]`);}
if(!steps){steps=tour.steps().map((step)=>{step.shadow_dom=step.shadow_dom??tour.shadow_dom;return step;});}
return steps;},shadow_dom:tour.shadow_dom,url:tour.url,rainbowMan:tour.rainbowMan===undefined?true:!!tour.rainbowMan,rainbowManMessage:tour.rainbowManMessage,fadeout:tour.fadeout||"medium",sequence:tour.sequence||1000,test:tour.test,checkDelay:tour.checkDelay,};wait_for.then(()=>{if(!tour.test&&toursEnabled&&!consumedTours.has(name)&&!tourState.getActiveTourNames().includes(name)){startTour(name,{mode:"manual",redirect:false});}});}
for(const[name,tour]of tourRegistry.getEntries()){register(name,tour);}
tourRegistry.addEventListener("UPDATE",({detail:{key,value}})=>{if(tourRegistry.contains(key)){register(key,value);if(tourState.getActiveTourNames().includes(key)&&(toursEnabled||tourState.get(key,"mode")==="auto")){resumeTour(key);}}else{delete tours[value];}});const bus=new EventBus();const macroEngine=new MacroEngine({target:document});const pointers=reactive({});const runningTours=new Set();const possiblePointTos=[];function createPointer(tourName,config){const{state:pointerState,methods}=createPointerState();let remove;return{start(){pointers[tourName]={methods,id:tourName,component:TourPointer,props:{pointerState,...config},};remove=overlay.add(pointers[tourName].component,pointers[tourName].props);},stop(){remove?.();delete pointers[tourName];methods.destroy();},...methods,async pointTo(anchor,step){possiblePointTos.push([tourName,()=>methods.pointTo(anchor,step)]);await Promise.resolve();if(!possiblePointTos.length){return;}
const toursByPriority=Object.fromEntries(getSortedTours().map((t,i)=>[t.name,i]));const sortedPointTos=possiblePointTos.slice(0).sort(([a],[b])=>toursByPriority[a]-toursByPriority[b]);possiblePointTos.splice(0);const active=sortedPointTos[0];const[activeId,enablePointer]=active||[];for(const{id,methods}of Object.values(pointers)){if(id===activeId){enablePointer();}else{methods.hide();}}},};}
function shouldOmit(step,mode){const isDefined=(key,obj)=>key in obj&&obj[key]!==undefined;const getEdition=()=>(session.server_version_info||[]).at(-1)==="e"?"enterprise":"community";const correctEdition=isDefined("edition",step)?step.edition===getEdition():true;const correctDevice=isDefined("mobile",step)?step.mobile===ui.isSmall:true;return(!correctEdition||!correctDevice||(mode==="manual"&&step.auto));}
function convertToMacro(tour,pointer,{mode,stepDelay,keepWatchBrowser,showPointerDuration}){const stepCompiler=mode==="auto"?compileStepAuto:compileStepManual;const checkDelay=mode==="auto"?tour.checkDelay:100;const filteredSteps=tour.steps.filter((step)=>!shouldOmit(step,mode));return compileTourToMacro(tour,{filteredSteps,stepCompiler,pointer,stepDelay,keepWatchBrowser,showPointerDuration,checkDelay,onStepConsummed(tour,step){bus.trigger("STEP-CONSUMMED",{tour,step});},onTourEnd({name,rainbowManMessage,fadeout}){if(mode==="auto"){transitionConfig.disabled=false;}
let message;if(typeof rainbowManMessage==="function"){message=rainbowManMessage({isTourConsumed:(name)=>consumedTours.has(name),});}else if(typeof rainbowManMessage==="string"){message=rainbowManMessage;}else{message=markup(_t("<strong><b>Good job!</b> You went through all steps of this tour.</strong>"));}
effect.add({type:"rainbow_man",message,fadeout});if(mode==="manual"){consumedTours.add(name);orm.call("web_tour.tour","consume",[[name]]);}
pointer.stop();browser.console.log("test successful");runningTours.delete(name);},});}
function observeShadows(shadowHostSelectors){const observer=new MutationObserver(()=>{const shadowRoots=[];for(const selector of shadowHostSelectors){const shadowHost=document.querySelector(selector);if(shadowHost){shadowRoots.push(shadowHost.shadowRoot);shadowHostSelectors.delete(selector);}}
for(const shadowRoot of shadowRoots){macroEngine.observer.observe(shadowRoot,macroEngine.observerOptions);}
if(shadowHostSelectors.size===0){observer.disconnect();}});observer.observe(macroEngine.target,{childList:true,subtree:true});}
function setupShadowObservers(tour){const shadowDOMs=new Set(tour.steps.filter((step)=>step.shadow_dom).map((step)=>step.shadow_dom));if(shadowDOMs.size>0){observeShadows(shadowDOMs);}}
function activateMacro(macro,mode){if(mode==="auto"){transitionConfig.disabled=true;}
macroEngine.activate(macro,mode==="auto");}
function startTour(tourName,options={}){if(runningTours.has(tourName)&&options.mode==="manual"){return;}
runningTours.add(tourName);const defaultOptions={stepDelay:0,keepWatchBrowser:false,mode:"auto",startUrl:"",showPointerDuration:0,redirect:true,};options=Object.assign(defaultOptions,options);const tour=tours[tourName];if(!tour){throw new Error(`Tour '${tourName}' is not found.`);}
tourState.set(tourName,"currentIndex",0);tourState.set(tourName,"stepDelay",options.stepDelay);tourState.set(tourName,"keepWatchBrowser",options.keepWatchBrowser);tourState.set(tourName,"showPointerDuration",options.showPointerDuration);tourState.set(tourName,"mode",options.mode);tourState.set(tourName,"sequence",tour.sequence);const pointer=createPointer(tourName,{bounce:!(options.mode==="auto"&&options.keepWatchBrowser),});const macro=convertToMacro(tour,pointer,options);const willUnload=callWithUnloadCheck(()=>{if(tour.url&&tour.url!==options.startUrl&&options.redirect){window.location.href=window.location.origin+tour.url;}});if(!willUnload){setupShadowObservers(tour);pointer.start();activateMacro(macro,options.mode);}}
function resumeTour(tourName){if(runningTours.has(tourName)){return;}
runningTours.add(tourName);const tour=tours[tourName];const stepDelay=tourState.get(tourName,"stepDelay");const keepWatchBrowser=tourState.get(tourName,"keepWatchBrowser");const showPointerDuration=tourState.get(tourName,"showPointerDuration");const mode=tourState.get(tourName,"mode");const pointer=createPointer(tourName,{bounce:!(mode==="auto"&&keepWatchBrowser),});const macro=convertToMacro(tour,pointer,{mode,stepDelay,keepWatchBrowser,showPointerDuration,});setupShadowObservers(tour);pointer.start();activateMacro(macro,mode);}
function getSortedTours(){return Object.values(tours).sort((t1,t2)=>{return t1.sequence-t2.sequence||(t1.name<t2.name?-1:1);});}
if(!window.frameElement){for(const tourName of tourState.getActiveTourNames()){if(tourName in tours){resumeTour(tourName);}}}
odoo.startTour=startTour;odoo.isTourReady=(tourName)=>tours[tourName].wait_for.then(()=>true);return{bus,startTour,getSortedTours,};},};registry.category("services").add("tour_service",tourService);return __exports;});;

/* /web_tour/static/src/tour_service/tour_state.js */
odoo.define('@web_tour/tour_service/tour_state',['@web/core/browser/browser'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const BOOLEAN={toLocalStorage:(val)=>(val?"1":"0"),fromLocalStorage:(val)=>(val==="1"?true:false),};const INTEGER={toLocalStorage:(val)=>val.toString(),fromLocalStorage:(val)=>parseInt(val,10),};const STRING={toLocalStorage:(x)=>x,fromLocalStorage:(x)=>x,};const ALLOWED_KEYS={keepWatchBrowser:BOOLEAN,showPointerDuration:INTEGER,currentIndex:INTEGER,stepDelay:INTEGER,mode:STRING,sequence:INTEGER,};function getPrefixedName(tourName,key){return`tour__${tourName}__${key}`;}
function destructurePrefixedName(prefixedName){const match=prefixedName.match(/tour__([.\w]+)__([\w]+)/);return match?[match[1],match[2]]:null;}
const tourState=__exports.tourState={get(tourName,key){if(!(key in ALLOWED_KEYS)){throw new Error(`Invalid key: '${key}' (tourName = '${tourName}')`);}
const prefixedName=getPrefixedName(tourName,key);const savedValue=browser.localStorage.getItem(prefixedName);return ALLOWED_KEYS[key].fromLocalStorage(savedValue);},set(tourName,key,value){if(!(key in ALLOWED_KEYS)){throw new Error(`Invalid key: '${key}' (tourName = '${tourName}')`);}
const prefixedName=getPrefixedName(tourName,key);browser.localStorage.setItem(prefixedName,ALLOWED_KEYS[key].toLocalStorage(value));},clear(tourName){for(const key in ALLOWED_KEYS){const prefixedName=getPrefixedName(tourName,key);browser.localStorage.removeItem(prefixedName);}},getActiveTourNames(){const tourNames=new Set();for(const key of Object.keys(browser.localStorage)){const[tourName]=destructurePrefixedName(key)||[false];if(tourName){tourNames.add(tourName);}}
return[...tourNames].sort((a,b)=>this.get(a,"sequence")-this.get(b,"sequence"));},};return __exports;});;

/* /web_tour/static/src/tour_service/tour_utils.js */
odoo.define('@web_tour/tour_service/tour_utils',['@odoo/owl','@web/core/l10n/translation','@web/core/ui/ui_service','@web/core/utils/ui'],function(require){'use strict';let __exports={};const{markup}=require("@odoo/owl");const{_t}=require("@web/core/l10n/translation");const{utils}=require("@web/core/ui/ui_service");const{_legacyIsVisible}=require("@web/core/utils/ui");const TourError=__exports.TourError=class TourError extends Error{constructor(message,...args){super(message,...args);this.message=`(TourError) ${message}`;}}
__exports.callWithUnloadCheck=callWithUnloadCheck;function callWithUnloadCheck(func,...args){let willUnload=false;const beforeunload=()=>(willUnload=true);window.addEventListener("beforeunload",beforeunload);const result=func(...args);if(result instanceof Promise){return result.then(()=>{window.removeEventListener("beforeunload",beforeunload);return willUnload;});}else{window.removeEventListener("beforeunload",beforeunload);return willUnload;}}
__exports.getFirstVisibleElement=getFirstVisibleElement;function getFirstVisibleElement($elements){for(var i=0;i<$elements.length;i++){var $i=$elements.eq(i);if(_legacyIsVisible($i[0])){return $i;}}
return $();}
__exports.getJQueryElementFromSelector=getJQueryElementFromSelector;function getJQueryElementFromSelector(selector,$target){$target=$target||$(document);const iframeSplit=typeof selector==="string"&&selector.match(/(.*\biframe[^ ]*)(.*)/);if(iframeSplit&&iframeSplit[2]){var $iframe=$target.find(`${iframeSplit[1]}:not(.o_ignore_in_tour)`);if($iframe.is('[is-ready="false"]')){return $();}
var $el=$iframe.contents().find(iframeSplit[2]);$el.iframeContainer=$iframe[0];return $el;}else if(typeof selector==="string"){return $target.find(selector);}else{return $(selector);}}
__exports.getConsumeEventType=getConsumeEventType;function getConsumeEventType(element,runCommand){if(!element){return"click";}
const{classList,tagName,type}=element;const tag=tagName.toLowerCase();if(classList.contains("o_field_many2one")){return"autocompleteselect";}
if(tag==="textarea"||(tag==="input"&&(!type||["email","number","password","search","tel","text","url"].includes(type)))){if(utils.isSmall()&&element.closest(".o_field_widget")?.matches(".o_field_many2one, .o_field_many2many")){return"click";}
return"input";}
if(classList.contains("ui-draggable-handle")){return"mousedown";}
if(typeof runCommand==="string"&&/^drag_and_drop/.test(runCommand)){if(element.closest(".ui-sortable")){return"sort";}
if((/^drag_and_drop_native/.test(runCommand)&&classList.contains("o_draggable"))||element.closest(".o_draggable")){return"pointerdown";}}
return"click";}
__exports.getDifferentParents=getDifferentParents;function getDifferentParents(n1,n2){const parents=[n2];while(parents[0].parentNode){const parent=parents[0].parentNode;if(parent.contains(n1)){break;}
parents.unshift(parent);}
return parents;}
__exports.getScrollParent=getScrollParent;function getScrollParent(element){if(!element){return null;}
if(element.scrollHeight>element.clientHeight){return element;}else{return getScrollParent(element.parentNode);}}
const triggerPointerEvent=__exports.triggerPointerEvent=(el,type,canBubbleAndBeCanceled,additionalParams)=>{const eventInit={bubbles:canBubbleAndBeCanceled,cancelable:canBubbleAndBeCanceled,view:window,...additionalParams,};el.dispatchEvent(new PointerEvent(type,eventInit));if(type.startsWith("pointer")){el.dispatchEvent(new MouseEvent(type.replace("pointer","mouse"),eventInit));}};const RunningTourActionHelper=__exports.RunningTourActionHelper=class RunningTourActionHelper{constructor(tip_widget){this.tip_widget=tip_widget;}
click(element){this._click(this._get_action_values(element));}
dblclick(element){this._click(this._get_action_values(element),2);}
tripleclick(element){this._click(this._get_action_values(element),3);}
clicknoleave(element){this._click(this._get_action_values(element),1,false);}
text(text,element){this._text(this._get_action_values(element),text);}
remove_text(text,element){this._text(this._get_action_values(element),"\n");}
text_blur(text,element){this._text_blur(this._get_action_values(element),text);}
range(text,element){this._range(this._get_action_values(element),text);}
drag_and_drop(to,element){this._drag_and_drop_jquery(this._get_action_values(element),to);}
drag_and_drop_native(toSel,element){const to=getJQueryElementFromSelector(toSel)[0];this._drag_and_drop(this._get_action_values(element).$element[0],to);}
keydown(keyCodes,element){this._keydown(this._get_action_values(element),keyCodes.split(/[,\s]+/));}
auto(element){var values=this._get_action_values(element);if(values.consume_event==="input"){this._text(values);}else{this._click(values);}}
_get_action_values(element){var $e=getJQueryElementFromSelector(element);var $element=element?getFirstVisibleElement($e):this.tip_widget.$anchor;if($element.length===0){$element=$e.first();}
var consume_event=element?getConsumeEventType($element[0]):this.tip_widget.consume_event;return{$element:$element,consume_event:consume_event,};}
_click(values,nb,leave){const target=values.$element[0];triggerPointerEvent(target,"pointerover",true);triggerPointerEvent(target,"pointerenter",false);triggerPointerEvent(target,"pointermove",true);for(let i=1;i<=(nb||1);i++){triggerPointerEvent(target,"pointerdown",true);triggerPointerEvent(target,"pointerup",true);triggerPointerEvent(target,"click",true,{detail:i});if(i%2===0){triggerPointerEvent(target,"dblclick",true);}}
if(leave!==false){triggerPointerEvent(target,"pointerout",true);triggerPointerEvent(target,"pointerleave",false);}}
_text(values,text){this._click(values);text=text||"Test";if(values.consume_event==="input"){values.$element.trigger({type:"keydown",key:text[text.length-1]}).val(text).trigger({type:"keyup",key:text[text.length-1]});values.$element[0].dispatchEvent(new InputEvent("input",{bubbles:true,}));}else if(values.$element.is("select")){var $options=values.$element.find("option");$options.prop("selected",false).removeProp("selected");var $selectedOption=$options.filter(function(){return $(this).val()===text;});if($selectedOption.length===0){$selectedOption=$options.filter(function(){return $(this).text().trim()===text;});}
const regex=/option\s+([0-9]+)/;if($selectedOption.length===0&&regex.test(text)){const position=parseInt(regex.exec(text)[1]);$selectedOption=$options.eq(position-1);}
$selectedOption.prop("selected",true);this._click(values);values.$element.trigger("input");}else{values.$element.focusIn();values.$element.trigger($.Event("keydown",{key:"_"}));values.$element.text(text).trigger("input");values.$element.focusInEnd();values.$element.trigger($.Event("keyup",{key:"_"}));}
values.$element[0].dispatchEvent(new Event("change",{bubbles:true,cancelable:false}));}
_text_blur(values,text){this._text(values,text);values.$element.trigger("focusout");values.$element.trigger("blur");}
_range(values,text){values.$element[0].value=text;values.$element[0].dispatchEvent(new Event('change',{bubbles:true,cancelable:false}));}
_calculateCenter($el,selector){const center=$el.offset();if(selector&&selector.indexOf("iframe")!==-1){const iFrameOffset=$("iframe").offset();center.left+=iFrameOffset.left;center.top+=iFrameOffset.top;}
center.left+=$el.outerWidth()/2;center.top+=$el.outerHeight()/2;return center;}
_drag_and_drop_jquery(values,to){var $to;const elementCenter=this._calculateCenter(values.$element);if(to){$to=getJQueryElementFromSelector(to);}else{$to=$(document.body);}
values.$element.trigger($.Event("mouseenter"));values.$element.trigger($.Event("mousedown",{which:1,pageX:elementCenter.left+1,pageY:elementCenter.top,}));if(!$to.length){values.$element.trigger($.Event("mousemove",{which:1,pageX:elementCenter.left+1,pageY:elementCenter.top,}));$to=getJQueryElementFromSelector(to);}
let toCenter=this._calculateCenter($to,to);values.$element.trigger($.Event("mousemove",{which:1,pageX:toCenter.left,pageY:toCenter.top}));toCenter=this._calculateCenter($to,to);values.$element.trigger($.Event("mouseup",{which:1,pageX:toCenter.left,pageY:toCenter.top}));}
_drag_and_drop(source,target){const sourceRect=source.getBoundingClientRect();const sourcePosition={clientX:sourceRect.x+sourceRect.width/2,clientY:sourceRect.y+sourceRect.height/2,};const targetRect=target.getBoundingClientRect();const targetPosition={clientX:targetRect.x+targetRect.width/2,clientY:targetRect.y+targetRect.height/2,};triggerPointerEvent(source,"pointerdown",true,sourcePosition);triggerPointerEvent(source,"pointermove",true,targetPosition);for(const parent of getDifferentParents(source,target)){triggerPointerEvent(parent,"pointerenter",false,targetPosition);}
triggerPointerEvent(target,"pointerup",true,targetPosition);}
_keydown(values,keyCodes){while(keyCodes.length){const eventOptions={};const keyCode=keyCodes.shift();let insertedText=null;if(isNaN(keyCode)){eventOptions.key=keyCode;}else{const code=parseInt(keyCode,10);if(code===32||(code>47&&code<58)||(code>64&&code<91)||(code>95&&code<112)||(code>185&&code<193)||(code>218&&code<223)){insertedText=String.fromCharCode(code);}}
values.$element.trigger(Object.assign({type:"keydown"},eventOptions));if(insertedText){values.$element[0].ownerDocument.execCommand("insertText",0,insertedText);}
values.$element.trigger(Object.assign({type:"keyup"},eventOptions));}}}
const stepUtils=__exports.stepUtils={_getHelpMessage(functionName,...args){return`Generated by function tour utils ${functionName}(${args.join(", ")})`;},addDebugHelp(helpMessage,step){if(typeof step.debugHelp==="string"){step.debugHelp=step.debugHelp+"\n"+helpMessage;}else{step.debugHelp=helpMessage;}
return step;},editionEnterpriseModifier(step){step.edition="enterprise";return step;},mobileModifier(step){step.mobile=true;return step;},showAppsMenuItem(){return{edition:"community",trigger:".o_navbar_apps_menu button",auto:true,position:"bottom",};},toggleHomeMenu(){return{edition:"enterprise",trigger:".o_main_navbar .o_menu_toggle",content:markup(_t("Click on the <i>Home icon</i> to navigate across apps.")),position:"bottom",};},autoExpandMoreButtons(extra_trigger){return{trigger:".o-form-buttonbox",extra_trigger:extra_trigger,auto:true,run:(actions)=>{const $more=$(".o-form-buttonbox .o_button_more");if($more.length){actions.click($more);}},};},goBackBreadcrumbsMobile(description,...extraTrigger){return extraTrigger.map((element)=>({mobile:true,trigger:".o_back_button",extra_trigger:element,content:description,position:"bottom",debugHelp:this._getHelpMessage("goBackBreadcrumbsMobile",description,...extraTrigger),}));},goToAppSteps(dataMenuXmlid,description){return[this.showAppsMenuItem(),{trigger:`.o_app[data-menu-xmlid="${dataMenuXmlid}"]`,content:description,position:"right",edition:"community",},{trigger:`.o_app[data-menu-xmlid="${dataMenuXmlid}"]`,content:description,position:"bottom",edition:"enterprise",},].map((step)=>this.addDebugHelp(this._getHelpMessage("goToApp",dataMenuXmlid,description),step));},openBurgerMenu(extraTrigger){return{mobile:true,trigger:".o_mobile_menu_toggle",extra_trigger:extraTrigger,content:_t("Open bugger menu."),position:"bottom",debugHelp:this._getHelpMessage("openBurgerMenu",extraTrigger),};},statusbarButtonsSteps(innerTextButton,description,extraTrigger){return[{mobile:true,auto:true,trigger:".o_statusbar_buttons",extra_trigger:extraTrigger,run:(actions)=>{const $action=$(".o_statusbar_buttons .btn.dropdown-toggle:contains(Action)");if($action.length){actions.click($action);}},},{trigger:`.o_statusbar_buttons button:enabled:contains('${innerTextButton}')`,content:description,position:"bottom",},].map((step)=>this.addDebugHelp(this._getHelpMessage("statusbarButtonsSteps",innerTextButton,description,extraTrigger),step));},simulateEnterKeyboardInSearchModal(){return{mobile:true,trigger:".o_searchview_input",extra_trigger:".modal:not(.o_inactive_modal) .dropdown-menu.o_searchview_autocomplete",position:"bottom",run:(action)=>{const keyEventEnter=new KeyboardEvent("keydown",{bubbles:true,cancelable:true,key:"Enter",code:"Enter",});action.tip_widget.$anchor[0].dispatchEvent(keyEventEnter);},debugHelp:this._getHelpMessage("simulateEnterKeyboardInSearchModal"),};},mobileKanbanSearchMany2X(modalTitle,valueSearched){return[{mobile:true,trigger:`.o_control_panel_navigation .btn .fa-search`,position:"bottom",},{mobile:true,trigger:".o_searchview_input",extra_trigger:`.modal:not(.o_inactive_modal) .modal-title:contains('${modalTitle}')`,position:"bottom",run:`text ${valueSearched}`,},this.simulateEnterKeyboardInSearchModal(),{mobile:true,trigger:`.o_kanban_record .o_kanban_record_title :contains('${valueSearched}')`,position:"bottom",},].map((step)=>this.addDebugHelp(this._getHelpMessage("mobileKanbanSearchMany2X",modalTitle,valueSearched),step));},saveForm(options={}){return[{content:options.content||"save form",trigger:".o_form_button_save",extra_trigger:options.extra_trigger,run:"click",auto:true,},{content:"wait for save completion",trigger:".o_form_readonly, .o_form_saved",run(){},auto:true,},];},discardForm(options={}){return[{content:options.content||"exit the form",trigger:".o_form_button_cancel",extra_trigger:options.extra_trigger,run:"click",auto:true,},{content:"wait for cancellation to complete",trigger:".o_view_controller.o_list_view, .o_form_view > div > div > .o_form_readonly, .o_form_view > div > div > .o_form_saved",run(){},auto:true,},];},};return __exports;});;

/* /web/static/src/model/model.js */
odoo.define('@web/model/model',['@web/core/utils/hooks','@web/search/with_search/with_search','@web/views/view_hook','@web/model/sample_server','@odoo/owl'],function(require){'use strict';let __exports={};const{useBus,useService}=require("@web/core/utils/hooks");const{SEARCH_KEYS}=require("@web/search/with_search/with_search");const{useSetupView}=require("@web/views/view_hook");const{buildSampleORM}=require("@web/model/sample_server");const{EventBus,onWillStart,onWillUpdateProps,useComponent}=require("@odoo/owl");const Model=__exports.Model=class Model{constructor(env,params,services){this.env=env;this.orm=services.orm;this.bus=new EventBus();this.setup(params,services);}
setup(){}
async load(){}
hasData(){return true;}
getGroups(){return null;}
notify(){this.bus.trigger("update");}}
Model.services=[];function getSearchParams(props){const params={};for(const key of SEARCH_KEYS){params[key]=props[key];}
return params;}
__exports.useModel=useModel;function useModel(ModelClass,params,options={}){const component=useComponent();const services={};for(const key of ModelClass.services){services[key]=useService(key);}
services.orm=services.orm||useService("orm");const model=new ModelClass(component.env,params,services);onWillStart(async()=>{await options.beforeFirstLoad?.();return model.load(component.props);});onWillUpdateProps((nextProps)=>model.load(nextProps));return model;}
__exports.useModelWithSampleData=useModelWithSampleData;function useModelWithSampleData(ModelClass,params,options={}){const component=useComponent();if(!(ModelClass.prototype instanceof Model)){throw new Error(`the model class should extend Model`);}
const services={};for(const key of ModelClass.services){services[key]=useService(key);}
services.orm=services.orm||useService("orm");const model=new ModelClass(component.env,params,services);useBus(model.bus,"update",options.onUpdate||(()=>{component.render(true);}));const globalState=component.props.globalState||{};const localState=component.props.state||{};let useSampleModel=component.props.useSampleModel&&(!("useSampleModel"in globalState)||globalState.useSampleModel);model.useSampleModel=useSampleModel;const orm=model.orm;let sampleORM=localState.sampleORM;const user=useService("user");let started=false;async function load(props){const searchParams=getSearchParams(props);await model.load(searchParams);if(useSampleModel&&!model.hasData()){sampleORM=sampleORM||buildSampleORM(component.props.resModel,component.props.fields,user);model.orm=sampleORM;await model.load(searchParams);model.orm=orm;}else{useSampleModel=false;model.useSampleModel=useSampleModel;}
if(started){model.notify();}}
onWillStart(async()=>{if(options.onWillStart){await options.onWillStart();}
await load(component.props);if(options.onWillStartAfterLoad){await options.onWillStartAfterLoad();}
started=true;});onWillUpdateProps((nextProps)=>{useSampleModel=false;load(nextProps);});useSetupView({getGlobalState(){if(component.props.useSampleModel){return{useSampleModel};}},getLocalState:()=>{return{sampleORM};},});return model;}
return __exports;});;

/* /web/static/src/model/record.js */
odoo.define('@web/model/record',['@web/core/utils/hooks','@web/core/utils/objects','@web/model/relational_model/relational_model','@web/model/relational_model/utils','@odoo/owl'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{pick}=require("@web/core/utils/objects");const{RelationalModel}=require("@web/model/relational_model/relational_model");const{getFieldsSpec}=require("@web/model/relational_model/utils");const{Component,xml,onWillStart,onWillUpdateProps,useState}=require("@odoo/owl");const defaultActiveField={attrs:{},options:{},domain:"[]",string:""};class StandaloneRelationalModel extends RelationalModel{load(params={}){if(params.values){const data=params.values;const config=this._getNextConfig(this.config,params);this.root=this._createRoot(config,data);this.config=config;return;}
return super.load(params);}}
class _Record extends Component{setup(){this.orm=useService("orm");const resModel=this.props.info.resModel;const activeFields=this.getActiveFields();const modelParams={config:{resModel,fields:this.props.fields,isMonoRecord:true,activeFields,resId:this.props.info.resId,mode:this.props.info.mode,},hooks:{onRecordSaved:this.props.info.onRecordSaved||(()=>{}),onWillSaveRecord:this.props.info.onWillSaveRecord||(()=>{}),onRecordChanged:this.props.info.onRecordChanged||(()=>{}),},};const modelServices=Object.fromEntries(StandaloneRelationalModel.services.map((servName)=>{return[servName,useService(servName)];}));modelServices.orm=this.orm;this.model=useState(new StandaloneRelationalModel(this.env,modelParams,modelServices));const prepareLoadWithValues=async(values)=>{values=pick(values,...Object.keys(modelParams.config.activeFields));const proms=[];for(const fieldName in values){if(["one2many","many2many"].includes(this.props.fields[fieldName].type)){if(values[fieldName].length&&typeof values[fieldName][0]==="number"){const resModel=this.props.fields[fieldName].relation;const resIds=values[fieldName];const activeField=modelParams.config.activeFields[fieldName];if(activeField.related){const{activeFields,fields}=activeField.related;const fieldSpec=getFieldsSpec(activeFields,fields,{});const kwargs={context:activeField.context||{},specification:fieldSpec,};proms.push(this.orm.webRead(resModel,resIds,kwargs).then((records)=>{values[fieldName]=records;}));}}}
if(this.props.fields[fieldName].type==="many2one"){const loadDisplayName=async(resId)=>{const resModel=this.props.fields[fieldName].relation;const activeField=modelParams.config.activeFields[fieldName];const kwargs={context:activeField.context||{},specification:{display_name:{}},};const records=await this.orm.webRead(resModel,[resId],kwargs);return records[0].display_name;};if(typeof values[fieldName]==="number"){const prom=loadDisplayName(values[fieldName]);prom.then((displayName)=>{values[fieldName]={id:values[fieldName],display_name:displayName,};});proms.push(prom);}else if(Array.isArray(values[fieldName])){if(values[fieldName][1]===undefined){const prom=loadDisplayName(values[fieldName][0]);prom.then((displayName)=>{values[fieldName]={id:values[fieldName][0],display_name:displayName,};});proms.push(prom);}
values[fieldName]={id:values[fieldName][0],display_name:values[fieldName][1],};}}
await Promise.all(proms);}
return values;};onWillStart(async()=>{if(this.props.values){const values=await prepareLoadWithValues(this.props.values);return this.model.load({values});}else{return this.model.load();}});onWillUpdateProps(async(nextProps)=>{const params={};if(nextProps.info.resId!==this.model.root.resId){params.resId=nextProps.info.resId;}
if(nextProps.values){params.values=await prepareLoadWithValues(nextProps.values);}
if(Object.keys(params).length){return this.model.load(params);}});}
getActiveFields(){if(this.props.info.activeFields){const activeFields={};for(const[fName,fInfo]of Object.entries(this.props.info.activeFields)){activeFields[fName]={...defaultActiveField,...fInfo};}
return activeFields;}
return Object.fromEntries(this.props.info.fieldNames.map((f)=>[f,{...defaultActiveField}]));}}
_Record.template=xml`<t t-slot="default" record="model.root"/>`;_Record.props=["slots","info","fields","values?"];const Record=__exports.Record=class Record extends Component{setup(){if(this.props.fields){this.fields=this.props.fields;}else{const orm=useService("orm");onWillStart(async()=>{this.fields=await orm.call(this.props.resModel,"fields_get",[this.props.fieldNames],{});});}}}
Record.template=xml`<_Record fields="fields" slots="props.slots" values="props.values" info="props" />`;Record.components={_Record};Record.props=["slots","resModel?","fieldNames?","activeFields?","fields?","resId?","mode?","values?","onRecordChanged?","onRecordSaved?","onWillSaveRecord?",];return __exports;});;

/* /web/static/src/model/relational_model/datapoint.js */
odoo.define('@web/model/relational_model/datapoint',['@odoo/owl','@web/core/domain','@web/core/utils/reactive','@web/model/relational_model/utils'],function(require){'use strict';let __exports={};const{markRaw}=require("@odoo/owl");const{evalDomain}=require("@web/core/domain");const{Reactive}=require("@web/core/utils/reactive");const{getId}=require("@web/model/relational_model/utils");const DataPoint=__exports.DataPoint=class DataPoint extends Reactive{constructor(model,config,data,options){super(...arguments);this.id=getId("datapoint");this.model=model;markRaw(config.activeFields);markRaw(config.fields);this._config=config;this.setup(config,data,options);}
setup(){}
get activeFields(){return this.config.activeFields;}
get fields(){return this.config.fields;}
get fieldNames(){return Object.keys(this.activeFields).filter((fieldName)=>!this.fields[fieldName].relatedPropertyField);}
get resModel(){return this.config.resModel;}
get config(){return this._config;}
get context(){return this.config.context;}
get currentCompanyId(){return this.config.currentCompanyId;}
isFieldReadonly(fieldName){const activeField=this.activeFields[fieldName];const{readonly}=activeField||this.fields[fieldName];return readonly&&evalDomain(readonly,this.evalContext);}}
return __exports;});;

/* /web/static/src/model/relational_model/dynamic_group_list.js */
odoo.define('@web/model/relational_model/dynamic_group_list',['@web/core/domain','@web/model/relational_model/dynamic_list','@web/model/relational_model/utils'],function(require){'use strict';let __exports={};const{Domain}=require("@web/core/domain");const{DynamicList}=require("@web/model/relational_model/dynamic_list");const{getGroupServerValue}=require("@web/model/relational_model/utils");const DynamicGroupList=__exports.DynamicGroupList=class DynamicGroupList extends DynamicList{static type="DynamicGroupList";setup(config,data){super.setup(...arguments);this.isGrouped=true;this._setData(data);}
_setData(data){this.groups=data.groups.map((g)=>this._createGroupDatapoint(g));this.count=data.length;}
get groupBy(){return this.config.groupBy;}
get groupByField(){return this.fields[this.groupBy[0].split(":")[0]];}
get hasData(){return this.groups.some((group)=>group.hasData);}
get records(){return this.groups.filter((group)=>!group.isFolded).map((group)=>group.records).flat();}
get recordCount(){return this.groups.reduce((acc,group)=>acc+group.count,0);}
async createGroup(groupName,foldField){if(!this.groupByField||this.groupByField.type!=="many2one"){throw new Error("Cannot create a group on a non many2one group field");}
await this.model.mutex.exec(()=>this._createGroup(groupName,foldField));}
async deleteGroups(groups){await this.model.mutex.exec(()=>this._deleteGroups(groups));}
async moveRecord(dataRecordId,dataGroupId,refId,targetGroupId){const targetGroup=this.groups.find((g)=>g.id===targetGroupId);if(dataGroupId===targetGroupId){await targetGroup.list._resequence(targetGroup.list.records,this.resModel,dataRecordId,refId);return;}
const sourceGroup=this.groups.find((g)=>g.id===dataGroupId);const recordIndex=sourceGroup.list.records.findIndex((r)=>r.id===dataRecordId);const record=sourceGroup.list.records[recordIndex];const refIndex=targetGroup.list.records.findIndex((r)=>r.id===refId);const oldIndex=sourceGroup.list.records.findIndex((r)=>r.id===dataRecordId);const sourceList=sourceGroup.list;const mustReloadSourceList=sourceList.count>sourceList.offset+sourceList.limit;sourceGroup._removeRecords([record.id]);targetGroup._addRecord(record,refIndex+1);const value=targetGroup.groupByField.type==="many2one"?[targetGroup.value,targetGroup.displayName]:targetGroup.value;const revert=()=>{targetGroup._removeRecords([record.id]);sourceGroup._addRecord(record,oldIndex);};try{const changes={[targetGroup.groupByField.name]:value};const res=await record.update(changes,{save:true});if(!res){return revert();}}catch(e){revert();throw e;}
const proms=[];if(mustReloadSourceList){const{offset,limit,orderBy,domain}=sourceGroup.list;proms.push(sourceGroup.list._load(offset,limit,orderBy,domain));}
if(!targetGroup.isFolded){const targetList=targetGroup.list;const records=targetList.records;proms.push(targetList._resequence(records,this.resModel,dataRecordId,refId));}
return Promise.all(proms);}
async resequence(movedGroupId,targetGroupId){if(!this.groupByField||this.groupByField.type!=="many2one"){throw new Error("Cannot resequence a group on a non many2one group field");}
return this.model.mutex.exec(async()=>{await this._resequence(this.groups,this.groupByField.relation,movedGroupId,targetGroupId);});}
async sortBy(fieldName){if(!this.groups.length){return;}
if(this.groups.every((group)=>group.isFolded)){if(this.groupByField.name!==fieldName){if(!(fieldName in this.groups[0].aggregates)){return;}}}
return super.sortBy(fieldName);}
async _createGroup(groupName,foldField=false){const[id]=await this.model.orm.call(this.groupByField.relation,"name_create",[groupName],{context:this.context});if(foldField){await this.model.orm.write(this.groupByField.relation,[id],{[foldField]:true},{context:this.context});}
const lastGroup=this.groups.at(-1);const commonConfig={resModel:this.config.resModel,fields:this.config.fields,activeFields:this.config.activeFields,};const context={...this.context,[`default_${this.groupByField.name}`]:id,};const nextConfigGroups={...this.config.groups};const domain=Domain.and([this.domain,[[this.groupByField.name,"=",id]]]).toList();nextConfigGroups[id]={...commonConfig,context,groupByFieldName:this.groupByField.name,isFolded:Boolean(foldField),initialDomain:domain,list:{...commonConfig,context,domain:domain,groupBy:[],orderBy:this.orderBy,},};this.model._updateConfig(this.config,{groups:nextConfigGroups},{reload:false});const data={count:0,length:0,records:[],__domain:domain,[this.groupByField.name]:[id,groupName],value:id,serverValue:getGroupServerValue(this.groupByField,id),displayName:groupName,rawValue:[id,groupName],};const group=this._createGroupDatapoint(data);if(lastGroup){const groups=[...this.groups,group];await this._resequence(groups,this.groupByField.relation,group.id,lastGroup.id);this.groups=groups;}else{this.groups.push(group);}}
_createGroupDatapoint(data){return new this.model.constructor.Group(this.model,this.config.groups[data.value],data);}
async _deleteGroups(groups){const shouldReload=groups.some((g)=>g.count>0);await this._unlinkGroups(groups);const configGroups={...this.config.groups};for(const group of groups){delete configGroups[group.value];}
if(shouldReload){await this.model._updateConfig(this.config,{groups:configGroups},{commit:this._setData.bind(this)});}else{for(const group of groups){this._removeGroup(group);}
this.model._updateConfig(this.config,{groups:configGroups},{reload:false});}}
_getDPresId(group){return group.value;}
_getDPFieldValue(group,handleField){return group[handleField];}
async _load(offset,limit,orderBy,domain){await this.model._updateConfig(this.config,{offset,limit,orderBy,domain},{commit:this._setData.bind(this)});}
_removeGroup(group){const index=this.groups.findIndex((g)=>g.id===group.id);this.groups.splice(index,1);this.count--;}
_removeRecords(recordIds){const proms=[];for(const group of this.groups){proms.push(group._removeRecords(recordIds));}
return Promise.all(proms);}
_unlinkGroups(groups){const groupResIds=groups.map((g)=>g.value);return this.model.orm.unlink(this.groupByField.relation,groupResIds,{context:this.context,});}}
return __exports;});;

/* /web/static/src/model/relational_model/dynamic_list.js */
odoo.define('@web/model/relational_model/dynamic_list',['@web/core/confirmation_dialog/confirmation_dialog','@web/core/l10n/translation','@web/model/relational_model/datapoint','@web/model/relational_model/record'],function(require){'use strict';let __exports={};const{AlertDialog}=require("@web/core/confirmation_dialog/confirmation_dialog");const{_t}=require("@web/core/l10n/translation");const{DataPoint}=require("@web/model/relational_model/datapoint");const{Record}=require("@web/model/relational_model/record");const DEFAULT_HANDLE_FIELD="sequence";const DynamicList=__exports.DynamicList=class DynamicList extends DataPoint{setup(config){super.setup(...arguments);this.handleField=Object.keys(this.activeFields).find((fieldName)=>this.activeFields[fieldName].isHandle);if(!this.handleField&&DEFAULT_HANDLE_FIELD in this.fields){this.handleField=DEFAULT_HANDLE_FIELD;}
this.isDomainSelected=false;this.evalContext=this.context;}
get groupBy(){return[];}
get orderBy(){return this.config.orderBy;}
get domain(){return this.config.domain;}
get editedRecord(){return this.records.find((record)=>record.isInEdition);}
get limit(){return this.config.limit;}
get offset(){return this.config.offset;}
get selection(){return this.records.filter((record)=>record.selected);}
archive(isSelected){return this.model.mutex.exec(()=>this._toggleArchive(isSelected,true));}
canResequence(){return!!this.handleField;}
deleteRecords(records=[]){return this.model.mutex.exec(()=>this._deleteRecords(records));}
duplicateRecords(records=[]){return this.model.mutex.exec(()=>this._duplicateRecords(records));}
async enterEditMode(record){if(this.editedRecord===record){return true;}
const canProceed=await this.leaveEditMode();if(canProceed){this.model._updateConfig(record.config,{mode:"edit"},{reload:false});}
return canProceed;}
async getResIds(isSelected){let resIds;if(isSelected){if(this.isDomainSelected){resIds=await this.model.orm.search(this.resModel,this.domain,{limit:this.model.activeIdsLimit,context:this.context,});}else{resIds=this.selection.map((r)=>r.resId);}}else{resIds=this.records.map((r)=>r.resId);}
return resIds;}
async leaveEditMode({discard}={}){if(this.editedRecord){let canProceed=true;if(discard){await this.editedRecord.discard();if(this.editedRecord&&this.editedRecord.isNew){this._removeRecords([this.editedRecord.id]);}}else{if(!this.model._urgentSave){await this.editedRecord.checkValidity();if(!this.editedRecord){return true;}}
if(this.editedRecord.isNew&&!this.editedRecord.dirty){this._removeRecords([this.editedRecord.id]);}else{canProceed=await this.editedRecord.save();}}
if(canProceed&&this.editedRecord){this.model._updateConfig(this.editedRecord.config,{mode:"readonly"},{reload:false});}else{return canProceed;}}
return true;}
load(params={}){const limit=params.limit===undefined?this.limit:params.limit;const offset=params.offset===undefined?this.offset:params.offset;const orderBy=params.orderBy===undefined?this.orderBy:params.orderBy;const domain=params.domain===undefined?this.domain:params.domain;return this.model.mutex.exec(()=>this._load(offset,limit,orderBy,domain));}
async multiSave(record){return this.model.mutex.exec(()=>this._multiSave(record));}
selectDomain(value){return this.model.mutex.exec(()=>{this.isDomainSelected=value;});}
sortBy(fieldName){return this.model.mutex.exec(()=>{let orderBy=[...this.orderBy];if(orderBy.length&&orderBy[0].name===fieldName){orderBy[0]={name:orderBy[0].name,asc:!orderBy[0].asc};}else{orderBy=orderBy.filter((o)=>o.name!==fieldName);orderBy.unshift({name:fieldName,asc:true,});}
return this._load(this.offset,this.limit,orderBy,this.domain);});}
toggleSelection(){return this.model.mutex.exec(()=>{if(this.selection.length===this.records.length){this.records.forEach((record)=>{record._toggleSelection(false);});this.isDomainSelected=false;}else{this.records.forEach((record)=>{record._toggleSelection(true);});}});}
unarchive(isSelected){return this.model.mutex.exec(()=>this._toggleArchive(isSelected,false));}
async _duplicateRecords(records){let resIds;if(records.length){resIds=records.map((r)=>r.resId);}else{resIds=await this.getResIds(true);}
const duplicated=await this.model.orm.call(this.resModel,"copy_multi",[resIds]);if(resIds.length>duplicated.length){this.model.notification.add(_t("Some records could not be duplicated"),{title:_t("Warning"),});}
return this.model.load();}
async _deleteRecords(records){let resIds;if(records.length){resIds=records.map((r)=>r.resId);}else{resIds=await this.getResIds(true);records=this.records.filter((r)=>resIds.includes(r.resId));}
const unlinked=await this.model.orm.unlink(this.resModel,resIds,{context:this.context,});if(!unlinked){return false;}
if(this.isDomainSelected&&resIds.length===this.model.activeIdsLimit&&resIds.length<this.count){const msg=_t(`Only the first %s records have been deleted (out of %s selected)`,resIds.length,this.count);this.model.notification.add(msg,{title:_t("Warning")});}
this._removeRecords(records.map((r)=>r.id));await this._load(this.offset,this.limit,this.orderBy,this.domain);return unlinked;}
async _leaveSampleMode(){if(this.model.useSampleModel){await this._load(this.offset,this.limit,this.orderBy,this.domain);this.model.useSampleModel=false;}}
async _multiSave(record){const changes=record._getChanges();if(!Object.keys(changes).length){return;}
const validSelection=this.selection.filter((record)=>{return Object.keys(changes).every((fieldName)=>{if(record._isReadonly(fieldName)){return false;}else if(record._isRequired(fieldName)&&!changes[fieldName]){return false;}
return true;});});const canProceed=await this.model.hooks.onWillSaveMulti(record,changes,validSelection);if(canProceed===false){return false;}
if(validSelection.length===0){this.model.dialog.add(AlertDialog,{body:_t("No valid record to save"),confirm:()=>this.leaveEditMode({discard:true}),dismiss:()=>this.leaveEditMode({discard:true}),});return false;}else{const resIds=validSelection.map((r)=>r.resId);const context=this.context;try{await this.model.orm.write(this.resModel,resIds,changes,{context});}catch(e){record._discard();this.model._updateConfig(record.config,{mode:"readonly"},{reload:false});throw e;}
const records=await this.model._loadRecords({...this.config,resIds});for(const record of validSelection){const serverValues=records.find((r)=>r.id===record.resId);record._applyValues(serverValues);this.model._updateSimilarRecords(record,serverValues);}
record._discard();this.model._updateConfig(record.config,{mode:"readonly"},{reload:false});}
this.model.hooks.onSavedMulti(validSelection);return true;}
async _resequence(originalList,resModel,movedId,targetId){if(this.resModel===resModel&&!this.canResequence()){return;}
const handleField=this.resModel===resModel?this.handleField:DEFAULT_HANDLE_FIELD;const order=this.orderBy.find((o)=>o.name===handleField);const asc=!order||order.asc;const fromIndex=originalList.findIndex((d)=>d.id===movedId);let toIndex=0;if(targetId!==null){const targetIndex=originalList.findIndex((d)=>d.id===targetId);toIndex=fromIndex>targetIndex?targetIndex+1:targetIndex;}
const getSequence=(dp)=>dp&&this._getDPFieldValue(dp,handleField);const firstIndex=Math.min(fromIndex,toIndex);const lastIndex=Math.max(fromIndex,toIndex)+1;let reorderAll=originalList.some((dp)=>this._getDPFieldValue(dp,handleField)===undefined);if(!reorderAll){let lastSequence=(asc?-1:1)*Infinity;for(let index=0;index<originalList.length;index++){const sequence=getSequence(originalList[index]);if(((index<firstIndex||index>=lastIndex)&&((asc&&lastSequence>=sequence)||(!asc&&lastSequence<=sequence)))||(index>=firstIndex&&index<lastIndex&&lastSequence===sequence)){reorderAll=true;}
lastSequence=sequence;}}
const originalOrder=[...originalList];const[dp]=originalList.splice(fromIndex,1);originalList.splice(toIndex,0,dp);let toReorder=originalList;if(!reorderAll){toReorder=toReorder.slice(firstIndex,lastIndex).filter((r)=>r.id!==movedId);if(fromIndex<toIndex){toReorder.push(dp);}else{toReorder.unshift(dp);}}
if(!asc){toReorder.reverse();}
const resIds=toReorder.map((d)=>this._getDPresId(d)).filter((id)=>id&&!isNaN(id));const sequences=toReorder.map(getSequence);const offset=sequences.length&&Math.min(...sequences);const params={model:resModel,ids:resIds,context:this.context,field:handleField,};if(offset){params.offset=offset;}
try{const wasResequenced=await this.model.rpc("/web/dataset/resequence",params);if(!wasResequenced){return;}}catch(error){originalList.splice(0,originalList.length,...originalOrder);throw error;}
const kwargs={context:this.context};const result=await this.model.orm.read(resModel,resIds,[handleField],kwargs);for(const dpData of result){const dp=originalList.find((d)=>this._getDPresId(d)===dpData.id);if(dp instanceof Record){dp._applyValues(dpData);}else{dp[handleField]=dpData[handleField];}}}
async _toggleArchive(isSelected,state){const method=state?"action_archive":"action_unarchive";const context=this.context;const resIds=await this.getResIds(isSelected);const action=await this.model.orm.call(this.resModel,method,[resIds],{context});if(this.isDomainSelected&&resIds.length===this.model.activeIdsLimit&&resIds.length<this.count){const msg=_t("Of the %s records selected, only the first %s have been archived/unarchived.",resIds.length,this.count);this.model.notification.add(msg,{title:_t("Warning")});}
const reload=()=>this.model.load();if(action&&Object.keys(action).length){this.model.action.doAction(action,{onClose:reload,});}else{return reload();}}}
return __exports;});;

/* /web/static/src/model/relational_model/dynamic_record_list.js */
odoo.define('@web/model/relational_model/dynamic_record_list',['@web/model/relational_model/dynamic_list'],function(require){'use strict';let __exports={};const{DynamicList}=require("@web/model/relational_model/dynamic_list");const DynamicRecordList=__exports.DynamicRecordList=class DynamicRecordList extends DynamicList{static type="DynamicRecordList";setup(config,data){super.setup(config);this._setData(data);}
_setData(data){this.records=data.records.map((r)=>this._createRecordDatapoint(r));this._updateCount(data);}
get hasData(){return this.count>0;}
addExistingRecord(resId,atFirstPosition){return this.model.mutex.exec(async()=>{const record=this._createRecordDatapoint({});await record._load({resId});this._addRecord(record,atFirstPosition?0:this.records.length);return record;});}
addNewRecord(atFirstPosition=false){return this.model.mutex.exec(async()=>{await this._leaveSampleMode();return this._addNewRecord(atFirstPosition);});}
async fetchCount(){this.count=await this.model._updateCount(this.config);this.hasLimitedCount=false;return this.count;}
moveRecord(dataRecordId,_dataGroupId,refId,_targetGroupId){return this.resequence(dataRecordId,refId);}
removeRecord(record){if(!record.isNew){throw new Error("removeRecord can't be called on an existing record");}
const index=this.records.findIndex((r)=>r===record);if(index<0){return;}
this.records.splice(index,1);this.count--;return record;}
async resequence(movedRecordId,targetRecordId){return this.model.mutex.exec(async()=>await this._resequence(this.records,this.resModel,movedRecordId,targetRecordId));}
async _addNewRecord(atFirstPosition){const values=await this.model._loadNewRecord({resModel:this.resModel,activeFields:this.activeFields,fields:this.fields,context:this.context,});const record=this._createRecordDatapoint(values,"edit");this._addRecord(record,atFirstPosition?0:this.records.length);return record;}
_addRecord(record,index){this.records.splice(Number.isInteger(index)?index:this.records.length,0,record);this.count++;}
_createRecordDatapoint(data,mode="readonly"){return new this.model.constructor.Record(this.model,{context:this.context,activeFields:this.activeFields,resModel:this.resModel,fields:this.fields,resId:data.id||false,resIds:data.id?[data.id]:[],isMonoRecord:true,currentCompanyId:this.currentCompanyId,mode,},data,{manuallyAdded:!data.id});}
_getDPresId(record){return record.resId;}
_getDPFieldValue(record,handleField){return record.data[handleField];}
async _load(offset,limit,orderBy,domain){await this.model._updateConfig(this.config,{offset,limit,orderBy,domain},{commit:this._setData.bind(this)});}
_removeRecords(recordIds){const keptRecords=this.records.filter((r)=>!recordIds.includes(r.id));this.count-=this.records.length-keptRecords.length;this.records=keptRecords;if(this.offset&&!this.records.length){const offset=Math.max(this.offset-this.limit,0);this.model._updateConfig(this.config,{offset},{reload:false});}}
_updateCount(data){const length=data.length;if(length>=this.config.countLimit+1){this.hasLimitedCount=true;this.count=this.config.countLimit;}else{this.hasLimitedCount=false;this.count=length;}}}
return __exports;});;

/* /web/static/src/model/relational_model/group.js */
odoo.define('@web/model/relational_model/group',['@web/core/domain','@web/model/relational_model/datapoint'],function(require){'use strict';let __exports={};const{Domain}=require("@web/core/domain");const{DataPoint}=require("@web/model/relational_model/datapoint");const Group=__exports.Group=class Group extends DataPoint{static type="Group";setup(config,data){super.setup(...arguments);this.groupByField=this.fields[config.groupByFieldName];this.range=data.range;this._rawValue=data.rawValue;this.count=data.count;this.value=data.value;this.serverValue=data.serverValue;this.displayName=data.displayName;this.aggregates=data.aggregates;let List;if(config.list.groupBy.length){List=this.model.constructor.DynamicGroupList;}else{List=this.model.constructor.DynamicRecordList;}
this.list=new List(this.model,config.list,data);if(config.record){config.record.context={...config.record.context,...config.context};this.record=new this.model.constructor.Record(this.model,config.record,data.values);}}
get groupDomain(){return this.config.initialDomain;}
get hasData(){return this.count>0;}
get isFolded(){return this.config.isFolded;}
get records(){return this.list.records;}
async addExistingRecord(resId,atFirstPosition=false){const record=await this.list.addExistingRecord(resId,atFirstPosition);this.count++;return record;}
async addNewRecord(_unused,atFirstPosition=false){const canProceed=await this.model.root.leaveEditMode({discard:true});if(canProceed){const record=await this.list.addNewRecord(atFirstPosition);if(record){this.count++;}}}
async applyFilter(filter){if(filter){await this.list.load({domain:Domain.and([this.groupDomain,filter]).toList(),});}else{await this.list.load({domain:this.groupDomain});}
this.model._updateConfig(this.config,{extraDomain:filter},{reload:false});}
deleteRecords(records){return this.model.mutex.exec(()=>this._deleteRecords(records));}
async toggle(){if(this.config.isFolded){await this.list.load();}
this.model._updateConfig(this.config,{isFolded:!this.config.isFolded},{reload:false});}
_addRecord(record,index){this.list._addRecord(record,index);this.count++;}
async _deleteRecords(records){await this.list._deleteRecords(records);this.count-=records.length;}
async _removeRecords(recordIds){const idsToRemove=recordIds.filter((id)=>this.list.records.some((r)=>r.id===id));this.list._removeRecords(idsToRemove);this.count-=idsToRemove.length;}}
return __exports;});;

/* /web/static/src/model/relational_model/record.js */
odoo.define('@web/model/relational_model/record',['@odoo/owl','@web/core/confirmation_dialog/confirmation_dialog','@web/core/domain','@web/core/l10n/dates','@web/core/l10n/translation','@web/core/orm_service','@web/core/py_js/py','@web/core/utils/strings','@web/model/relational_model/datapoint','@web/model/relational_model/utils'],function(require){'use strict';let __exports={};const{markRaw,markup,toRaw}=require("@odoo/owl");const{AlertDialog}=require("@web/core/confirmation_dialog/confirmation_dialog");const{Domain}=require("@web/core/domain");const{serializeDate,serializeDateTime}=require("@web/core/l10n/dates");const{_t}=require("@web/core/l10n/translation");const{x2ManyCommands}=require("@web/core/orm_service");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{escape}=require("@web/core/utils/strings");const{DataPoint}=require("@web/model/relational_model/datapoint");const{FetchRecordError,createPropertyActiveField,getBasicEvalContext,getFieldContext,getFieldsSpec,parseServerValue,}=require("@web/model/relational_model/utils");const Record=__exports.Record=class Record extends DataPoint{static type="Record";setup(config,data,options={}){this._manuallyAdded=options.manuallyAdded===true;this._onUpdate=options.onUpdate||(()=>{});this._parentRecord=options.parentRecord;this._virtualId=options.virtualId||false;this._isEvalContextReady=false;this.dirty=false;this.selected=false;this._invalidFields=new Set();this._unsetRequiredFields=markRaw(new Set());this._closeInvalidFieldsNotification=()=>{};const parentRecord=this._parentRecord;if(parentRecord){this.evalContext={get parent(){return parentRecord.evalContext;},};this.evalContextWithVirtualIds={get parent(){return parentRecord.evalContextWithVirtualIds;},};}else{this.evalContext={};this.evalContextWithVirtualIds={};}
const missingFields=this.fieldNames.filter((fieldName)=>!(fieldName in data));data={...this._getDefaultValues(missingFields),...data};this._textValues=markRaw({});this._setData(data);}
_setData(data){this._isEvalContextReady=false;if(this.resId){this._values=this._parseServerValues(data);this._changes=markRaw({});Object.assign(this._textValues,this._getTextValues(data));}else{this._values=markRaw({});const allVals={...this._getDefaultValues(),...data};this._initialChanges=markRaw(this._parseServerValues(allVals));this._changes=markRaw({...this._initialChanges});Object.assign(this._textValues,this._getTextValues(allVals));}
this.dirty=false;this.data={...this._values,...this._changes};this._setEvalContext();this._initialTextValues={...this._textValues};this._invalidFields.clear();this._savePoint=undefined;}
get canBeAbandoned(){return this.isNew&&!this.dirty&&this._manuallyAdded;}
get hasData(){return true;}
get isActive(){if("active"in this.activeFields){return this.data.active;}else if("x_active"in this.activeFields){return this.data.x_active;}
return true;}
get isInEdition(){if(this.config.mode==="readonly"){return false;}else{return this.config.mode==="edit"||!this.resId;}}
get isNew(){return!this.resId;}
get isValid(){return!this._invalidFields.size;}
get resId(){return this.config.resId;}
get resIds(){return this.config.resIds;}
archive(){return this.model.mutex.exec(()=>this._toggleArchive(true));}
async checkValidity({displayNotification}={}){if(!this._urgentSave){await this.model._askChanges();}
return this._checkValidity({displayNotification});}
delete(){return this.model.mutex.exec(async()=>{const unlinked=await this.model.orm.unlink(this.resModel,[this.resId],{context:this.context,});if(!unlinked){return false;}
const resIds=this.resIds.slice();const index=resIds.indexOf(this.resId);resIds.splice(index,1);const resId=resIds[Math.min(index,resIds.length-1)]||false;if(resId){await this.model.load({resId,resIds});}else{this.model._updateConfig(this.config,{resId:false},{reload:false});this.dirty=false;this._changes=markRaw(this._parseServerValues(this._getDefaultValues()));this._values=markRaw({});this._textValues=markRaw({});this.data={...this._changes};this._setEvalContext();}});}
discard(){if(this.model._closeUrgentSaveNotification){this.model._closeUrgentSaveNotification();}
return this.model.mutex.exec(()=>this._discard());}
duplicate(){return this.model.mutex.exec(async()=>{const kwargs={context:this.context};const index=this.resIds.indexOf(this.resId);const resId=await this.model.orm.call(this.resModel,"copy",[this.resId],kwargs);const resIds=this.resIds.slice();resIds.splice(index+1,0,resId);await this.model.load({resId,resIds,mode:"edit"});});}
getFieldDomain(fieldName){const{domain}=this.fields[fieldName];return domain?new Domain(domain).toList(this.evalContext):[];}
async isDirty(){await this.model._askChanges();return this.dirty;}
isFieldInvalid(fieldName){return this._invalidFields.has(fieldName);}
load(){if(arguments.length>0){throw new Error("Record.load() does not accept arguments");}
return this.model.mutex.exec(()=>this._load());}
async save(options){await this.model._askChanges();return this.model.mutex.exec(()=>this._save(options));}
async setInvalidField(fieldName){this.dirty=true;return this._setInvalidField(fieldName);}
resetFieldValidity(fieldName){this.dirty=true;this._invalidFields.delete(fieldName);}
switchMode(mode){return this.model.mutex.exec(()=>this._switchMode(mode));}
toggleSelection(selected){return this.model.mutex.exec(()=>{this._toggleSelection(selected);});}
unarchive(){return this.model.mutex.exec(()=>this._toggleArchive(false));}
update(changes,{save}={}){if(this.model._urgentSave){return this._update(changes,{save:false});}
return this.model.mutex.exec(async()=>{await this._update(changes,{withoutOnchange:save});if(save){return this._save();}});}
async urgentSave(){this.model._urgentSave=true;this.model.bus.trigger("WILL_SAVE_URGENTLY");const succeeded=await this._save({reload:false});this.model._urgentSave=false;return succeeded;}
_addSavePoint(){this._savePoint=markRaw({dirty:this.dirty,textValues:{...this._textValues},changes:{...this._changes},});for(const fieldName in this._changes){if(["one2many","many2many"].includes(this.fields[fieldName].type)){this._changes[fieldName]._addSavePoint();}}}
_applyChanges(changes,serverChanges={}){const fieldNameChanges=[...Object.keys({...changes,...serverChanges})];const initialTextValues={...this._textValues};const initialChanges={...this._changes};const initialData={...toRaw(this.data)};const invalidFields=toRaw(this._invalidFields);const invalidFieldNames=fieldNameChanges.filter((fieldName)=>invalidFields.has(fieldName));const undoChanges=()=>{for(const fieldName of invalidFieldNames){this.setInvalidField(fieldName);}
Object.assign(this.data,initialData);this._changes=markRaw(initialChanges);Object.assign(this._textValues,initialTextValues);this._setEvalContext();};for(const fieldName in changes){const change=changes[fieldName];this._changes[fieldName]=change;this.data[fieldName]=change;if(this.fields[fieldName].type==="html"){this._textValues[fieldName]=change===false?false:change.toString();}else if(["char","text"].includes(this.fields[fieldName].type)){this._textValues[fieldName]=change;}}
const parsedChanges=this._parseServerValues(serverChanges,this.data);for(const fieldName in parsedChanges){this._changes[fieldName]=parsedChanges[fieldName];this.data[fieldName]=parsedChanges[fieldName];}
Object.assign(this._textValues,this._getTextValues(serverChanges));this._setEvalContext();this._removeInvalidFields(fieldNameChanges);return undoChanges;}
_applyDefaultValues(){const fieldNames=this.fieldNames.filter((fieldName)=>{return!(fieldName in this.data);});const defaultValues=this._getDefaultValues(fieldNames);if(this.isNew){this._applyChanges({},defaultValues);}else{this._applyValues(defaultValues);}}
_applyValues(values){const newValues=this._parseServerValues(values);Object.assign(this._values,newValues);for(const fieldName in newValues){if(fieldName in this._changes){if(["one2many","many2many"].includes(this.fields[fieldName].type)){this._changes[fieldName]=newValues[fieldName];}}}
Object.assign(this.data,this._values,this._changes);const textValues=this._getTextValues(values);Object.assign(this._initialTextValues,textValues);Object.assign(this._textValues,textValues,this._getTextValues(this._changes));this._setEvalContext();}
_checkValidity({silent,displayNotification}={}){const unsetRequiredFields=[];for(const fieldName in this.activeFields){const fieldType=this.fields[fieldName].type;if(this._isInvisible(fieldName)||this.fields[fieldName].relatedPropertyField){continue;}
switch(fieldType){case"boolean":case"float":case"integer":case"monetary":continue;case"html":if(this._isRequired(fieldName)&&this.data[fieldName].length===0){unsetRequiredFields.push(fieldName);}
break;case"one2many":case"many2many":{const list=this.data[fieldName];if((this._isRequired(fieldName)&&!list.count)||!list.records.every((r)=>!r.dirty||r._checkValidity({silent}))){unsetRequiredFields.push(fieldName);}
break;}
case"properties":{const value=this.data[fieldName];if(value){const ok=value.every((propertyDefinition)=>propertyDefinition.name&&propertyDefinition.name.length&&propertyDefinition.string&&propertyDefinition.string.length);if(!ok){unsetRequiredFields.push(fieldName);}}
break;}
case"json":{if(this._isRequired(fieldName)&&(!this.data[fieldName]||!Object.keys(this.data[fieldName]).length)){unsetRequiredFields.push(fieldName);}
break;}
default:if(!this.data[fieldName]&&this._isRequired(fieldName)){unsetRequiredFields.push(fieldName);}}}
if(silent){return!unsetRequiredFields.length;}
for(const fieldName of Array.from(this._unsetRequiredFields)){this._invalidFields.delete(fieldName);}
this._unsetRequiredFields.clear();for(const fieldName of unsetRequiredFields){this._unsetRequiredFields.add(fieldName);this._setInvalidField(fieldName);}
const isValid=!this._invalidFields.size;if(!isValid&&displayNotification){const items=[...this._invalidFields].map((fieldName)=>{return`<li>${escape(this.fields[fieldName].string || fieldName)}</li>`;},this);this._closeInvalidFieldsNotification=this.model.notification.add(markup(`<ul>${items.join("")}</ul>`),{title:_t("Invalid fields: "),type:"danger",});}
return isValid;}
_computeDataContext(){const dataContext={};const x2manyDataContext={withVirtualIds:{},withoutVirtualIds:{},};const data=toRaw(this.data);for(const fieldName in data){const value=data[fieldName];const field=this.fields[fieldName];if(field.relatedPropertyField){continue;}
if(["char","text","html"].includes(field.type)){dataContext[fieldName]=this._textValues[fieldName];}else if(field.type==="one2many"||field.type==="many2many"){x2manyDataContext.withVirtualIds[fieldName]=value.currentIds;x2manyDataContext.withoutVirtualIds[fieldName]=value.currentIds.filter((id)=>typeof id==="number");}else if(value&&field.type==="date"){dataContext[fieldName]=serializeDate(value);}else if(value&&field.type==="datetime"){dataContext[fieldName]=serializeDateTime(value);}else if(value&&field.type==="many2one"){dataContext[fieldName]=value[0];}else if(value&&field.type==="reference"){dataContext[fieldName]=`${value.resModel},${value.resId}`;}else if(field.type==="properties"){dataContext[fieldName]=value.filter((property)=>!property.definition_deleted!==false);}else{dataContext[fieldName]=value;}}
dataContext.id=this.resId||false;return{withVirtualIds:{...dataContext,...x2manyDataContext.withVirtualIds},withoutVirtualIds:{...dataContext,...x2manyDataContext.withoutVirtualIds},};}
_createStaticListDatapoint(data,fieldName){const{related,limit,defaultOrderBy}=this.activeFields[fieldName];const config={resModel:this.fields[fieldName].relation,activeFields:(related&&related.activeFields)||{},fields:(related&&related.fields)||{},relationField:this.fields[fieldName].relation_field||false,offset:0,resIds:data.map((r)=>r.id),orderBy:defaultOrderBy||[],limit:limit||Number.MAX_SAFE_INTEGER,currentCompanyId:this.currentCompanyId,context:{},};const options={onUpdate:({withoutOnchange}={})=>this._update({[fieldName]:[]},{withoutOnchange}),parent:this,};return new this.model.constructor.StaticList(this.model,config,data,options);}
_discard(){for(const fieldName in this._changes){if(["one2many","many2many"].includes(this.fields[fieldName].type)){this._changes[fieldName]._discard();}}
if(this._savePoint){this.dirty=this._savePoint.dirty;this._changes=markRaw({...this._savePoint.changes});this._textValues=markRaw({...this._savePoint.textValues});}else{this.dirty=false;this._changes=markRaw(this.isNew?{...this._initialChanges}:{});this._textValues=markRaw({...this._initialTextValues});}
this.data={...this._values,...this._changes};this._savePoint=undefined;this._setEvalContext();this._invalidFields.clear();this._closeInvalidFieldsNotification();this._closeInvalidFieldsNotification=()=>{};this._restoreActiveFields();}
_formatServerValue(fieldType,value){if(fieldType==="date"){return value?serializeDate(value):false;}else if(fieldType==="datetime"){return value?serializeDateTime(value):false;}else if(fieldType==="char"||fieldType==="text"){return value!==""?value:false;}else if(fieldType==="html"){return value&&value.length?value:false;}else if(fieldType==="many2one"){return value?value[0]:false;}else if(fieldType==="reference"){return value&&value.resModel&&value.resId?`${value.resModel},${value.resId}`:false;}else if(fieldType==="properties"){return value.map((property)=>{let value;if(property.type==="many2one"){value=property.value;}else if((property.type==="date"||property.type==="datetime")&&typeof property.value==="string"){value=property.value;}else{value=this._formatServerValue(property.type,property.value);}
return{...property,value,};});}
return value;}
_getChanges(changes=this._changes,{withReadonly}={}){const result={};for(const[fieldName,value]of Object.entries(changes)){const field=this.fields[fieldName];if(fieldName==="id"){continue;}
if(!withReadonly&&fieldName in this.activeFields&&this._isReadonly(fieldName)&&!this.activeFields[fieldName].forceSave){continue;}
if(field.relatedPropertyField){continue;}
if(field.type==="one2many"||field.type==="many2many"){const commands=value._getCommands({withReadonly});if(!this.isNew&&!commands.length&&!withReadonly){continue;}
result[fieldName]=commands;}else{result[fieldName]=this._formatServerValue(field.type,value);}}
return result;}
_getDefaultValues(fieldNames=this.fieldNames){const defaultValues={};for(const fieldName of fieldNames){switch(this.fields[fieldName].type){case"integer":case"float":case"monetary":defaultValues[fieldName]=fieldName==="id"?false:0;break;case"one2many":case"many2many":defaultValues[fieldName]=[];break;default:defaultValues[fieldName]=false;}}
return defaultValues;}
_getTextValues(values){const textValues={};for(const fieldName in values){if(!this.activeFields[fieldName]){continue;}
if(["char","text","html"].includes(this.fields[fieldName].type)){textValues[fieldName]=values[fieldName];}}
return textValues;}
_isInvisible(fieldName){const invisible=this.activeFields[fieldName].invisible;return invisible?evaluateBooleanExpr(invisible,this.evalContextWithVirtualIds):false;}
_isReadonly(fieldName){const readonly=this.activeFields[fieldName].readonly;return readonly?evaluateBooleanExpr(readonly,this.evalContextWithVirtualIds):false;}
_isRequired(fieldName){const required=this.activeFields[fieldName].required;return required?evaluateBooleanExpr(required,this.evalContextWithVirtualIds):false;}
async _load(nextConfig={}){if("resId"in nextConfig&&this.resId){throw new Error("Cannot change resId of a record");}
await this.model._updateConfig(this.config,nextConfig,{commit:(values)=>{if(this.resId){this.model._updateSimilarRecords(this,values);}
this._setData(values);},});}
_processProperties(properties,fieldName,parent,currentValues={}){const data={};const relatedPropertyField={fieldName,};if(parent){relatedPropertyField.id=parent[0];relatedPropertyField.displayName=parent[1];}
const hasCurrentValues=Object.keys(currentValues).length>0;for(const property of properties){const propertyFieldName=`${fieldName}.${property.name}`;if(hasCurrentValues||!this.fields[propertyFieldName]){this.fields[propertyFieldName]={...property,name:propertyFieldName,relatedPropertyField,propertyName:property.name,relation:property.comodel,};}
if(hasCurrentValues||!this.activeFields[propertyFieldName]){this.activeFields[propertyFieldName]=createPropertyActiveField(property);}
if(property.type==="many2many"){let staticList=currentValues[propertyFieldName];if(!staticList){staticList=this._createStaticListDatapoint((property.value||[]).map((record)=>({id:record[0],display_name:record[1],})),propertyFieldName);}
data[propertyFieldName]=staticList;}else if(property.type==="many2one"){data[propertyFieldName]=property.value.length&&property.value[1]===null?[property.value[0],_t("No Access")]:property.value;}else{data[propertyFieldName]=property.value??false;}}
return data;}
_parseServerValues(serverValues,currentValues={}){const parsedValues={};if(!serverValues){return parsedValues;}
for(const fieldName in serverValues){const value=serverValues[fieldName];if(!this.activeFields[fieldName]){continue;}
const field=this.fields[fieldName];if(field.type==="one2many"||field.type==="many2many"){let staticList=currentValues[fieldName];let valueIsCommandList=true;valueIsCommandList=value.length>0&&Array.isArray(value[0]);if(!staticList){let data=valueIsCommandList?[]:value;if(data.length>0&&typeof data[0]==="number"){data=data.map((resId)=>{return{id:resId};});}
staticList=this._createStaticListDatapoint(data,fieldName);}
if(valueIsCommandList){staticList._applyCommands(value);}
parsedValues[fieldName]=staticList;}else{parsedValues[fieldName]=parseServerValue(field,value);if(field.type==="properties"){const parent=serverValues[field.definition_record];Object.assign(parsedValues,this._processProperties(parsedValues[fieldName],fieldName,parent,currentValues));}}}
return parsedValues;}
async _preprocessReferenceChanges(changes){const proms=[];for(const[fieldName,value]of Object.entries(changes)){if(this.fields[fieldName].type!=="reference"){continue;}
if(!value){changes[fieldName]=false;continue;}
const id=value.resId;const displayName=value.displayName;if(!id&&!displayName){changes[fieldName]=false;continue;}
const context=getFieldContext(this,fieldName);if(!id&&displayName!==undefined){proms.push(this.model.orm.call(value.resModel,"name_create",[displayName],{context,}).then((result)=>{changes[fieldName]=result?{resModel:value.resModel,resId:result[0],displayName,}:false;}));}else if(id&&displayName===undefined){const kwargs={context,specification:{display_name:{}},};proms.push(this.model.orm.webRead(value.resModel,[id],kwargs).then((records)=>{changes[fieldName]={resModel:value.resModel,resId:id,displayName:records[0].display_name,};}));}else{changes[fieldName]=value;}}
return Promise.all(proms);}
async _preprocessMany2oneChanges(changes){const proms=[];for(const[fieldName,value]of Object.entries(changes)){if(this.fields[fieldName].type!=="many2one"){continue;}
if(!value){changes[fieldName]=false;continue;}
const[id,displayName]=value;const activeField=this.activeFields[fieldName];if(!activeField){changes[fieldName]=value;continue;}
const relation=this.fields[fieldName].relation;const context=getFieldContext(this,fieldName);if(!id&&displayName!==undefined){proms.push(this.model.orm.call(relation,"name_create",[displayName],{context,}).then((result)=>{changes[fieldName]=result;}));}else if(id&&displayName===undefined){const kwargs={context,specification:{display_name:{}},};proms.push(this.model.orm.webRead(relation,[id],kwargs).then((records)=>{changes[fieldName]=[records[0].id,records[0].display_name||""];}));}else{changes[fieldName]=value;}}
return Promise.all(proms);}
async _preprocessX2manyChanges(changes){for(const[fieldName,value]of Object.entries(changes)){if(this.fields[fieldName].type!=="one2many"&&this.fields[fieldName].type!=="many2many"){continue;}
const list=this.data[fieldName];for(const command of value){switch(command[0]){case x2ManyCommands.SET:await list._replaceWith(command[2]);break;default:await list._applyCommands([command]);}}
changes[fieldName]=list;}}
_preprocessPropertiesChanges(changes){for(const[fieldName,value]of Object.entries(changes)){const field=this.fields[fieldName];if(field.type==="properties"){const parent=changes[field.definition_record]||this.data[field.definition_record];Object.assign(changes,this._processProperties(value,fieldName,parent,this.data));}else if(field&&field.relatedPropertyField){const[propertyFieldName,propertyName]=field.name.split(".");const propertiesData=this.data[propertyFieldName]||[];if(!propertiesData.find((property)=>property.name===propertyName)){this.model.notification.add(_t("This record belongs to a different parent so you can not change this property."),{type:"warning"});return;}
changes[propertyFieldName]=propertiesData.map((property)=>property.name===propertyName?{...property,value}:property);}}}
_preprocessHtmlChanges(changes){for(const[fieldName,value]of Object.entries(changes)){if(this.fields[fieldName].type==="html"){changes[fieldName]=value===false?false:markup(value);}}}
_removeInvalidFields(fieldNames){for(const fieldName of fieldNames){this._invalidFields.delete(fieldName);}}
_restoreActiveFields(){if(!this._activeFieldsToRestore){return;}
this.model._updateConfig(this.config,{activeFields:{...this._activeFieldsToRestore},},{reload:false});this._activeFieldsToRestore=undefined;}
async _save({reload=true,onError,nextId}={}){if(this.model._closeUrgentSaveNotification){this.model._closeUrgentSaveNotification();}
const creation=!this.resId;if(nextId){if(creation){throw new Error("Cannot set nextId on a new record");}
reload=true;}
for(const fieldName in this.activeFields){const field=this.fields[fieldName];if(["one2many","many2many"].includes(field.type)&&!field.relatedPropertyField){this.data[fieldName]._abandonRecords();}}
const changes=this._getChanges();delete changes.id;if(!creation&&!Object.keys(changes).length){return true;}
if(!this._checkValidity({displayNotification:true})){return false;}
if(this.model._urgentSave&&this.model.useSendBeaconToSaveUrgently){const route=`/web/dataset/call_kw/${this.resModel}/web_save`;const params={model:this.resModel,method:"web_save",args:[this.resId?[this.resId]:[],changes],kwargs:{context:this.context,specification:{}},};const data={jsonrpc:"2.0",method:"call",params};const blob=new Blob([JSON.stringify(data)],{type:"application/json"});const succeeded=navigator.sendBeacon(route,blob);if(!succeeded){this.model._closeUrgentSaveNotification=this.model.notification.add(markup(_t(`Heads up! Your recent changes are too large to save automatically. Please click the <i class="fa fa-cloud-upload fa-fw"></i> button now to ensure your work is saved before you exit this tab.`)),{sticky:true});}
return succeeded;}
const canProceed=await this.model.hooks.onWillSaveRecord(this,changes);if(canProceed===false){return false;}
let fieldSpec={};if(reload){fieldSpec=getFieldsSpec(this.activeFields,this.fields,getBasicEvalContext(this.config));}
const kwargs={context:this.context,specification:fieldSpec,next_id:nextId,};let records=[];try{records=await this.model.orm.webSave(this.resModel,this.resId?[this.resId]:[],changes,kwargs);}catch(e){if(onError){return onError(e,{discard:()=>this._discard()});}
if(!this.isInEdition){await this._load({});}
throw e;}
if(reload&&!records.length){throw new FetchRecordError(nextId||this.resId);}
if(creation){const resId=records[0].id;const resIds=this.resIds.concat([resId]);this.model._updateConfig(this.config,{resId,resIds},{reload:false});}
await this.model.hooks.onRecordSaved(this,changes);if(reload){if(this.resId){this.model._updateSimilarRecords(this,records[0]);}
if(nextId){this.model._updateConfig(this.config,{resId:nextId},{reload:false});}
if(this.config.isRoot){this.model.hooks.onWillLoadRoot(this.config);}
this._setData(records[0]);}else{this._values=markRaw({...this._values,...this._changes});if("id"in this.activeFields){this._values.id=records[0].id;}
for(const fieldName in this.activeFields){const field=this.fields[fieldName];if(["one2many","many2many"].includes(field.type)&&!field.relatedPropertyField){this._changes[fieldName]?._clearCommands();}}
this._changes=markRaw({});this.data={...this._values};this.dirty=false;}
return true;}
_setEvalContext(){const evalContext=getBasicEvalContext(this.config);const dataContext=this._computeDataContext();Object.assign(this.evalContext,evalContext,dataContext.withoutVirtualIds);Object.assign(this.evalContextWithVirtualIds,evalContext,dataContext.withVirtualIds);this._isEvalContextReady=true;if(!this._parentRecord||this._parentRecord._isEvalContextReady){for(const[fieldName,value]of Object.entries(toRaw(this.data))){if(["one2many","many2many"].includes(this.fields[fieldName].type)){value._updateContext(getFieldContext(this,fieldName));}}}}
async _setInvalidField(fieldName){const canProceed=this.model.hooks.onWillSetInvalidField(this,fieldName);if(canProceed===false){return;}
if(this.selected&&this.model.multiEdit&&!this._invalidFields.has(fieldName)){await this.model.dialog.add(AlertDialog,{body:_t("No valid record to save"),confirm:async()=>{await this.discard();this.switchMode("readonly");},});}
this._invalidFields.add(fieldName);}
_switchMode(mode){this.model._updateConfig(this.config,{mode},{reload:false});if(mode==="readonly"){this._noUpdateParent=false;this._invalidFields.clear();}}
async _toggleArchive(state){const method=state?"action_archive":"action_unarchive";const action=await this.model.orm.call(this.resModel,method,[[this.resId]],{context:this.context,});if(action&&Object.keys(action).length){this.model.action.doAction(action,{onClose:()=>this._load()});}else{return this._load();}}
_toggleSelection(selected){if(typeof selected==="boolean"){this.selected=selected;}else{this.selected=!this.selected;}}
async _getOnchangeValues(changes){const onChangeFields=Object.keys(changes).filter((fieldName)=>this.activeFields[fieldName]&&this.activeFields[fieldName].onChange);if(!onChangeFields.length){return{};}
const localChanges=this._getChanges({...this._changes,...changes},{withReadonly:true});if(this.config.relationField){localChanges[this.config.relationField]=this._parentRecord._getChanges();if(!this._parentRecord.isNew){localChanges[this.config.relationField].id=this._parentRecord.resId;}}
return this.model._onchange(this.config,{changes:localChanges,fieldNames:onChangeFields,evalContext:toRaw(this.evalContext),onError:(e)=>{const undoChanges=this._applyChanges(changes);undoChanges();throw e;},});}
async _update(changes,{withoutOnchange,withoutParentUpdate}={}){this.dirty=true;const prom=Promise.all([this._preprocessMany2oneChanges(changes),this._preprocessReferenceChanges(changes),this._preprocessX2manyChanges(changes),this._preprocessPropertiesChanges(changes),this._preprocessHtmlChanges(changes),]);if(!this.model._urgentSave){await prom;}
if(this.selected&&this.model.multiEdit){this._applyChanges(changes);return this.model.root._multiSave(this);}
let onchangeServerValues={};if(!this.model._urgentSave&&!withoutOnchange){onchangeServerValues=await this._getOnchangeValues(changes);}
for(const fieldName in changes){if(this.fields[fieldName].type==="many2one"){const curVal=toRaw(this.data[fieldName]);const nextVal=changes[fieldName];if(curVal&&nextVal&&curVal[0]===nextVal[0]&&curVal[1]===nextVal[1]){delete changes[fieldName];}}}
const undoChanges=this._applyChanges(changes,onchangeServerValues);if(Object.keys(changes).length>0||Object.keys(onchangeServerValues).length>0){try{await this._onUpdate({withoutParentUpdate});}catch(e){undoChanges();throw e;}
await this.model.hooks.onRecordChanged(this,this._getChanges());}}}
return __exports;});;

/* /web/static/src/model/relational_model/relational_model.js */
odoo.define('@web/model/relational_model/relational_model',['@odoo/owl','@web/core/context','@web/core/domain','@web/core/errors/error_dialogs','@web/core/registry','@web/core/utils/arrays','@web/core/utils/concurrency','@web/search/utils/order_by','@web/model/model','@web/model/relational_model/dynamic_group_list','@web/model/relational_model/dynamic_record_list','@web/model/relational_model/group','@web/model/relational_model/record','@web/model/relational_model/static_list','@web/model/relational_model/utils'],function(require){'use strict';let __exports={};const{EventBus,markRaw,toRaw}=require("@odoo/owl");const{makeContext}=require("@web/core/context");const{Domain}=require("@web/core/domain");const{WarningDialog}=require("@web/core/errors/error_dialogs");const{registry}=require("@web/core/registry");const{shallowEqual,unique}=require("@web/core/utils/arrays");const{KeepLast,Mutex}=require("@web/core/utils/concurrency");const{orderByToString}=require("@web/search/utils/order_by");const{Model}=require("@web/model/model");const{DynamicGroupList}=require("@web/model/relational_model/dynamic_group_list");const{DynamicRecordList}=require("@web/model/relational_model/dynamic_record_list");const{Group}=require("@web/model/relational_model/group");const{Record}=require("@web/model/relational_model/record");const{StaticList}=require("@web/model/relational_model/static_list");const{FetchRecordError,extractInfoFromGroupData,getBasicEvalContext,getFieldsSpec,isRelational,makeActiveField,}=require("@web/model/relational_model/utils");const DEFAULT_HOOKS={onWillLoadRoot:()=>{},onRootLoaded:()=>{},onWillSaveRecord:()=>{},onRecordSaved:()=>{},onWillSaveMulti:()=>{},onSavedMulti:()=>{},onWillSetInvalidField:()=>{},onRecordChanged:()=>{},};__exports.fetchRecordErrorHandler=fetchRecordErrorHandler;function fetchRecordErrorHandler(env,error,originalError){if(originalError instanceof FetchRecordError){env.services.notification.add(originalError.message,{sticky:true,type:"danger"});return true;}}
const errorHandlerRegistry=registry.category("error_handlers");errorHandlerRegistry.add("fetchRecordErrorHandler",fetchRecordErrorHandler);const RelationalModel=__exports.RelationalModel=class RelationalModel extends Model{static services=["action","company","dialog","notification","orm","rpc","user"];static Record=Record;static Group=Group;static DynamicRecordList=DynamicRecordList;static DynamicGroupList=DynamicGroupList;static StaticList=StaticList;static DEFAULT_LIMIT=80;static DEFAULT_COUNT_LIMIT=10000;static DEFAULT_GROUP_LIMIT=80;static DEFAULT_OPEN_GROUP_LIMIT=10;static MAX_NUMBER_OPENED_GROUPS=10;setup(params,{action,company,dialog,notification,rpc,user}){this.action=action;this.dialog=dialog;this.notification=notification;this.rpc=rpc;this.user=user;this.bus=new EventBus();this.keepLast=markRaw(new KeepLast());this.mutex=markRaw(new Mutex());this.config={isMonoRecord:false,currentCompanyId:company.currentCompany.id,context:{},...params.config,isRoot:true,};this.hooks=Object.assign({},DEFAULT_HOOKS,params.hooks);this.initialLimit=params.limit||this.constructor.DEFAULT_LIMIT;this.initialGroupsLimit=params.groupsLimit;this.initialCountLimit=params.countLimit||this.constructor.DEFAULT_COUNT_LIMIT;this.defaultOrderBy=params.defaultOrderBy;this.defaultGroupBy=params.defaultGroupBy;this.maxGroupByDepth=params.maxGroupByDepth;this.groupByInfo=params.groupByInfo||{};this.multiEdit=params.multiEdit;this.activeIdsLimit=params.activeIdsLimit||Number.MAX_SAFE_INTEGER;this.specialDataCaches=markRaw(params.state?.specialDataCaches||{});this.useSendBeaconToSaveUrgently=params.useSendBeaconToSaveUrgently||false;this._urgentSave=false;}
exportState(){return{config:toRaw(this.config),specialDataCaches:this.specialDataCaches,};}
hasData(){return this.root.hasData;}
async load(params={}){const config=this._getNextConfig(this.config,params);this.hooks.onWillLoadRoot(config);const data=await this.keepLast.add(this._loadData(config));this.root=this._createRoot(config,data);this.config=config;return this.hooks.onRootLoaded();}
async _getPropertyDefinition(config,propertyFullName){const result=await this.orm.call(config.resModel,"get_property_definition",[propertyFullName],{context:config.context});if(!result){config.groupBy=null;}else{result.propertyName=result.name;result.name=propertyFullName;result.relatedPropertyField={fieldName:propertyFullName.split(".")[0]};result.relation=result.comodel;config.fields[propertyFullName]=result;}}
_askChanges(){const proms=[];this.bus.trigger("NEED_LOCAL_CHANGES",{proms});return Promise.all([...proms,this.mutex.getUnlockedDef()]);}
_createRoot(config,data){if(config.isMonoRecord){return new this.constructor.Record(this,config,data);}
if(config.groupBy.length){return new this.constructor.DynamicGroupList(this,config,data);}
return new this.constructor.DynamicRecordList(this,config,data);}
_getNextConfig(currentConfig,params){const currentGroupBy=currentConfig.groupBy;const config=Object.assign({},currentConfig);config.context="context"in params?params.context:config.context;if(currentConfig.isMonoRecord){config.resId="resId"in params?params.resId:config.resId;config.resIds="resIds"in params?params.resIds:config.resIds;if(!config.resIds){config.resIds=config.resId?[config.resId]:[];}
if(!config.resId&&config.mode!=="edit"){config.mode="edit";}}else{config.domain="domain"in params?params.domain:config.domain;config.comparison="comparison"in params?params.comparison:config.comparison;config.groupBy="groupBy"in params?params.groupBy:config.groupBy;if(this.defaultGroupBy&&!config.groupBy.length){config.groupBy=[this.defaultGroupBy];}
if(this.maxGroupByDepth){config.groupBy=config.groupBy.slice(0,this.maxGroupByDepth);}
config.orderBy="orderBy"in params?params.orderBy:config.orderBy;if(!config.orderBy.length){config.orderBy=currentConfig.orderBy||[];}
if(this.defaultOrderBy&&!config.orderBy.length){config.orderBy=this.defaultOrderBy;}
if(!shallowEqual(config.groupBy||[],currentGroupBy||[])){delete config.groups;}}
if(!config.isMonoRecord&&this.root){const resetOffset=(config)=>{config.offset=0;for(const group of Object.values(config.groups||{})){resetOffset(group.list);}};resetOffset(config);if(!!config.groupBy.length!==!!currentGroupBy.length){delete config.limit;}}
return config;}
async _loadData(config){if(config.isMonoRecord){const evalContext=getBasicEvalContext(config);if(!config.resId){return this._loadNewRecord(config,{evalContext});}
const records=await this._loadRecords({...config,resIds:[config.resId],},evalContext);return records[0];}
if(config.resIds){const resIds=config.resIds.slice(config.offset,config.offset+config.limit);return this._loadRecords({...config,resIds});}
if(config.groupBy.length){return this._loadGroupedList(config);}
Object.assign(config,{limit:config.limit||this.initialLimit,countLimit:"countLimit"in config?config.countLimit:this.initialCountLimit,offset:config.offset||0,});if(config.countLimit!==Number.MAX_SAFE_INTEGER){config.countLimit=Math.max(config.countLimit,config.offset+config.limit);}
return this._loadUngroupedList({...config,context:{...config.context,current_company_id:config.currentCompanyId,},});}
async _loadGroupedList(config){config.offset=config.offset||0;config.limit=config.limit||this.initialGroupsLimit;if(!config.limit){config.limit=config.openGroupsByDefault?this.constructor.DEFAULT_OPEN_GROUP_LIMIT:this.constructor.DEFAULT_GROUP_LIMIT;}
config.groups=config.groups||{};const firstGroupByName=config.groupBy[0].split(":")[0];if(firstGroupByName.includes(".")){if(!config.fields[firstGroupByName]){await this._getPropertyDefinition(config,firstGroupByName);}
const propertiesFieldName=firstGroupByName.split(".")[0];if(!config.activeFields[propertiesFieldName]){config.activeFields[propertiesFieldName]=makeActiveField();}}
const orderBy=config.orderBy.filter((o)=>o.name===firstGroupByName||(o.name in config.activeFields&&config.fields[o.name].group_operator!==undefined));const response=await this._webReadGroup(config,firstGroupByName,orderBy);const{groups:groupsData,length}=response;const groupBy=config.groupBy.slice(1);const groupByField=config.fields[config.groupBy[0].split(":")[0]];const commonConfig={resModel:config.resModel,fields:config.fields,activeFields:config.activeFields,};let groupRecordConfig;const groupRecordResIds=[];if(this.groupByInfo[firstGroupByName]){groupRecordConfig={...this.groupByInfo[firstGroupByName],resModel:config.fields[firstGroupByName].relation,context:{},};}
const proms=[];let nbOpenGroups=0;const groups=[];for(const groupData of groupsData){const group=extractInfoFromGroupData(groupData,config.groupBy,config.fields);if(!config.groups[group.value]){config.groups[group.value]={...commonConfig,groupByFieldName:groupByField.name,isFolded:"__fold"in groupData?groupData.__fold:!config.openGroupsByDefault,extraDomain:false,value:group.value,list:{...commonConfig,groupBy,},};if(isRelational(config.fields[firstGroupByName])&&!group.value){config.groups[group.value].isFolded=true;}
if(groupRecordConfig){config.groups[group.value].record={...groupRecordConfig,resId:group.value??false,};}}
if(groupRecordConfig){const resId=config.groups[group.value].record.resId;if(resId){groupRecordResIds.push(resId);}}
const groupConfig=config.groups[group.value];groupConfig.list.orderBy=config.orderBy;groupConfig.initialDomain=group.domain;if(groupConfig.extraDomain){groupConfig.list.domain=Domain.and([group.domain,groupConfig.extraDomain,]).toList();}else{groupConfig.list.domain=group.domain;}
const context={...config.context,[`default_${firstGroupByName}`]:group.serverValue,};groupConfig.list.context=context;groupConfig.context=context;if(groupBy.length){group.groups=[];}else{group.records=[];}
if(!groupConfig.isFolded){nbOpenGroups++;if(nbOpenGroups>this.constructor.MAX_NUMBER_OPENED_GROUPS){groupConfig.isFolded=true;}}
if(!groupConfig.isFolded&&group.count>0){const prom=this._loadData(groupConfig.list).then((response)=>{if(groupBy.length){group.groups=response?response.groups:[];group.length=response?response.length:0;}else{group.records=response?response.records:[];}});proms.push(prom);}
groups.push(group);}
if(groupRecordConfig&&Object.keys(groupRecordConfig.activeFields).length){const prom=this._loadRecords({...groupRecordConfig,resIds:groupRecordResIds,}).then((records)=>{for(const group of groups){if(!group.value){group.values={id:false};continue;}
group.values=records.find((r)=>group.value&&r.id===group.value);}});proms.push(prom);}
await Promise.all(proms);const params=JSON.stringify([config.domain,config.groupBy,config.offset,config.limit,config.orderBy,]);if(config.currentGroups&&config.currentGroups.params===params){const currentGroups=config.currentGroups.groups;currentGroups.forEach((group,index)=>{if(config.groups[group.value]&&!groups.some((g)=>JSON.stringify(g.value)===JSON.stringify(group.value))){const aggregates=Object.assign({},group.aggregates);for(const key in aggregates){aggregates[key]=0;}
groups.splice(index,0,Object.assign({},group,{count:0,length:0,records:[],aggregates}));}});}
config.currentGroups={params,groups};return{groups,length};}
async _loadNewRecord(config,params={}){return this._onchange(config,params);}
async _loadRecords(config,evalContext=config.context){const{resModel,resIds,activeFields,fields,context}=config;if(!resIds.length){return[];}
const fieldSpec=getFieldsSpec(activeFields,fields,evalContext);if(Object.keys(fieldSpec).length>0){const kwargs={context:{bin_size:true,...context},specification:fieldSpec,};const records=await this.orm.webRead(resModel,resIds,kwargs);if(!records.length){throw new FetchRecordError(resIds);}
return records;}else{return resIds.map((resId)=>{return{id:resId};});}}
async _loadUngroupedList(config){const kwargs={specification:getFieldsSpec(config.activeFields,config.fields,config.context),offset:config.offset,order:orderByToString(config.orderBy),limit:config.limit,context:{bin_size:true,...config.context},count_limit:config.countLimit!==Number.MAX_SAFE_INTEGER?config.countLimit+1:undefined,};return this.orm.webSearchRead(config.resModel,config.domain,kwargs);}
async _onchange(config,{changes={},fieldNames=[],evalContext=config.context,onError}){const{fields,activeFields,resModel,resId}=config;let context=config.context;if(fieldNames.length===1){const fieldContext=config.activeFields[fieldNames[0]].context;context=makeContext([context,fieldContext],evalContext);}
const spec=getFieldsSpec(activeFields,fields,evalContext,{withInvisible:true});const args=[resId?[resId]:[],changes,fieldNames,spec];let response;try{response=await this.orm.call(resModel,"onchange",args,{context});}catch(e){if(onError){return onError(e);}
throw e;}
if(response.warning){const{type,title,message,className,sticky}=response.warning;if(type==="dialog"){this.dialog.add(WarningDialog,{title,message});}else{this.notification.add(message,{className,sticky,title,type:"warning",});}}
return response.value;}
async _updateConfig(config,patch,{reload=true,commit}={}){const tmpConfig={...config,...patch};markRaw(tmpConfig.activeFields);markRaw(tmpConfig.fields);let data;if(reload){if(tmpConfig.isRoot){this.hooks.onWillLoadRoot(tmpConfig);}
data=await this._loadData(tmpConfig);}
Object.assign(config,tmpConfig);if(data&&commit){commit(data);}
if(reload&&config.isRoot){return this.hooks.onRootLoaded();}}
async _updateCount(config){const count=await this.keepLast.add(this.orm.searchCount(config.resModel,config.domain));config.countLimit=Number.MAX_SAFE_INTEGER;return count;}
_updateSimilarRecords(reloadedRecord,serverValues){if(this.config.isMonoRecord||!this.config.groupBy.length){return;}
for(const record of this.root.records){if(record===reloadedRecord){continue;}
if(record.resId===reloadedRecord.resId){record._applyValues(serverValues);}}}
async _webReadGroup(config,firstGroupByName,orderBy){return this.orm.webReadGroup(config.resModel,config.domain,unique([...Object.keys(config.activeFields),firstGroupByName]),[config.groupBy[0]],{orderby:orderByToString(orderBy),lazy:true,offset:config.offset,limit:config.limit,context:config.context,});}}
return __exports;});;

/* /web/static/src/model/relational_model/static_list.js */
odoo.define('@web/model/relational_model/static_list',['@web/core/orm_service','@web/core/utils/arrays','@web/core/utils/objects','@web/model/relational_model/utils','@web/model/relational_model/datapoint','@odoo/owl'],function(require){'use strict';let __exports={};const{x2ManyCommands}=require("@web/core/orm_service");const{intersection}=require("@web/core/utils/arrays");const{pick}=require("@web/core/utils/objects");const{completeActiveFields}=require("@web/model/relational_model/utils");const{DataPoint}=require("@web/model/relational_model/datapoint");const{fromUnityToServerValues,getId,patchActiveFields}=require("@web/model/relational_model/utils");const{markRaw}=require("@odoo/owl");function compareFieldValues(v1,v2,fieldType){if(fieldType==="many2one"){v1=v1?v1[1]:"";v2=v2?v2[1]:"";}
return v1<v2;}
function compareRecords(r1,r2,orderBy,fields){const{name,asc}=orderBy[0];function getValue(record,fieldName){return fieldName==="id"?record.resId:record.data[fieldName];}
const v1=asc?getValue(r1,name):getValue(r2,name);const v2=asc?getValue(r2,name):getValue(r1,name);if(compareFieldValues(v1,v2,fields[name].type)){return-1;}
if(compareFieldValues(v2,v1,fields[name].type)){return 1;}
if(orderBy.length>1){return compareRecords(r1,r2,orderBy.slice(1),fields);}
return 0;}
const StaticList=__exports.StaticList=class StaticList extends DataPoint{static type="StaticList";setup(config,data,options={}){this._parent=options.parent;this._onUpdate=options.onUpdate;this._cache=markRaw({});this._commands=[];this._savePoint=undefined;this._unknownRecordCommands={};this._currentIds=[...this.resIds];this._needsReordering=false;this._tmpIncreaseLimit=0;this._extendedRecords=new Set();this.records=data.slice(this.offset,this.limit).map((r)=>this._createRecordDatapoint(r));this.count=this.resIds.length;this.handleField=Object.keys(this.activeFields).find((fieldName)=>this.activeFields[fieldName].isHandle);}
get currentIds(){return this._currentIds;}
get editedRecord(){return this.records.find((record)=>record.isInEdition);}
get evalContext(){const context=this.config.context;return{context,uid:context.uid,allowed_company_ids:context.allowed_company_ids,current_company_id:this.config.currentCompanyId,parent:this._parent.evalContext,};}
get limit(){return this.config.limit;}
get offset(){return this.config.offset;}
get orderBy(){return this.config.orderBy;}
get resIds(){return this.config.resIds;}
addNewRecord(params){return this.model.mutex.exec(async()=>{const{activeFields,context,mode,position,withoutParent}=params;const record=await this._createNewRecordDatapoint({activeFields,context,position,withoutParent,manuallyAdded:true,mode,});await this._addRecord(record,{position});await this._onUpdate({withoutOnchange:!record._checkValidity({silent:true})});return record;});}
canResequence(){return this.handleField&&this.orderBy.length&&this.orderBy[0].name===this.handleField;}
createAndReplace(contextRecords){return this.model.mutex.exec(async()=>{const proms=[];for(const context of contextRecords){proms.push(this._createNewRecordDatapoint({context,manuallyAdded:true,}));}
this.records=await Promise.all(proms);this._commands=this.records.map((record)=>[x2ManyCommands.CREATE,record._virtualId,]);this._currentIds=this.records.map((record)=>record._virtualId);});}
delete(record){return this.model.mutex.exec(async()=>{await this._applyCommands([[x2ManyCommands.DELETE,record.resId||record._virtualId]]);await this._onUpdate();});}
async enterEditMode(record){const canProceed=await this.leaveEditMode();if(canProceed){await record.switchMode("edit");}
return canProceed;}
extendRecord(params,record){return this.model.mutex.exec(async()=>{completeActiveFields(this.config.activeFields,params.activeFields);Object.assign(this.fields,params.fields);const activeFields={...params.activeFields};for(const fieldName in this.activeFields){if(fieldName in activeFields){patchActiveFields(activeFields[fieldName],this.activeFields[fieldName]);}else{activeFields[fieldName]=this.activeFields[fieldName];}}
if(record){record._noUpdateParent=true;record._activeFieldsToRestore={...this.config.activeFields};const config={...record.config,...params,activeFields,};if(this._extendedRecords.has(record.id)){this.model._updateConfig(record.config,config,{reload:false});record._addSavePoint();return record;}
let data={};if(!record.isNew){const evalContext=Object.assign({},record.evalContext,config.context);const resIds=[record.resId];[data]=await this.model._loadRecords({...config,resIds},evalContext);}
this.model._updateConfig(record.config,config,{reload:false});record._applyDefaultValues();for(const fieldName in record.activeFields){if(["one2many","many2many"].includes(record.fields[fieldName].type)){const list=record.data[fieldName];const patch={activeFields:activeFields[fieldName].related.activeFields,fields:activeFields[fieldName].related.fields,};for(const subRecord of Object.values(list._cache)){this.model._updateConfig(subRecord.config,patch,{reload:false,});}
this.model._updateConfig(list.config,patch,{reload:false});}}
record._applyValues(data);const commands=this._unknownRecordCommands[record.resId];delete this._unknownRecordCommands[record.resId];if(commands){this._applyCommands(commands);}
record._addSavePoint();}else{record=await this._createNewRecordDatapoint({activeFields,context:params.context,withoutParent:params.withoutParent,manuallyAdded:true,});record._activeFieldsToRestore={...this.config.activeFields};record._noUpdateParent=true;}
this._extendedRecords.add(record.id);return record;});}
forget(record){return this.model.mutex.exec(async()=>{await this._applyCommands([[x2ManyCommands.UNLINK,record.resId]]);await this._onUpdate();});}
async leaveEditMode({discard,canAbandon,validate}={}){if(this.editedRecord){await this.model._askChanges(false);}
return this.model.mutex.exec(async()=>{if(this.editedRecord){const isValid=this.editedRecord._checkValidity();if(!isValid&&validate){return false;}
if(canAbandon!==false&&!validate){this._abandonRecords([this.editedRecord],{force:true});}
if(this.editedRecord){if(isValid&&!this.editedRecord.dirty&&discard){return false;}
if(isValid||(!this.editedRecord.dirty&&!this.editedRecord._manuallyAdded)){this.editedRecord._switchMode("readonly");}}}
return!this.editedRecord;});}
linkTo(resId,serverData){return this.model.mutex.exec(async()=>{await this._applyCommands([[x2ManyCommands.LINK,resId,serverData]]);await this._onUpdate();});}
unlinkFrom(resId,serverData){return this.model.mutex.exec(async()=>{await this._applyCommands([[x2ManyCommands.UNLINK,resId,serverData]]);await this._onUpdate();});}
load({limit,offset,orderBy}={}){return this.model.mutex.exec(async()=>{if(this.editedRecord&&!(await this.editedRecord.checkValidity())){return;}
limit=limit!==undefined?limit:this.limit;offset=offset!==undefined?offset:this.offset;orderBy=orderBy!==undefined?orderBy:this.orderBy;return this._load({limit,offset,orderBy});});}
moveRecord(dataRecordId,_dataGroupId,refId,_targetGroupId){return this.resequence(dataRecordId,refId);}
sortBy(fieldName){return this.model.mutex.exec(()=>this._sortBy(fieldName));}
async addAndRemove({add,remove,reload}={}){return this.model.mutex.exec(async()=>{const commands=[...(add||[]).map((id)=>[x2ManyCommands.LINK,id]),...(remove||[]).map((id)=>[x2ManyCommands.UNLINK,id]),];await this._applyCommands(commands,{canAddOverLimit:true,reload});await this._onUpdate();});}
async resequence(movedId,targetId){return this.model.mutex.exec(()=>this._resequence(movedId,targetId));}
validateExtendedRecord(record){return this.model.mutex.exec(async()=>{if(!this._currentIds.includes(record.isNew?record._virtualId:record.resId)){await this._addRecord(record);}else if(!record.dirty){return;}
await this._onUpdate();if(this.orderBy.length){await this._sort();}
record._restoreActiveFields();record._savePoint=undefined;});}
_abandonRecords(records=this.records,{force}={}){for(const record of records){if(record.canBeAbandoned&&(force||!record._checkValidity())){const virtualId=record._virtualId;const index=this._currentIds.findIndex((id)=>id===virtualId);this._currentIds.splice(index,1);this.records.splice(this.records.findIndex((r)=>r===record),1);this._commands=this._commands.filter((c)=>c[1]!==virtualId);this.count--;if(this._tmpIncreaseLimit>0){this.model._updateConfig(this.config,{limit:this.limit-1},{reload:false});this._tmpIncreaseLimit--;}}}}
async _addRecord(record,{position}={}){const command=[x2ManyCommands.CREATE,record._virtualId];if(position==="top"){this.records.unshift(record);if(this.records.length>this.limit){this.records.pop();}
this._currentIds.splice(this.offset,0,record._virtualId);this._commands.unshift(command);}else if(position==="bottom"){this.records.push(record);this._currentIds.splice(this.offset+this.limit,0,record._virtualId);if(this.records.length>this.limit){this._tmpIncreaseLimit++;const nextLimit=this.limit+1;this.model._updateConfig(this.config,{limit:nextLimit},{reload:false});}
this._commands.push(command);}else{const currentIds=[...this._currentIds,record._virtualId];if(this.orderBy.length){await this._sort(currentIds);}else{if(this.records.length<this.limit){this.records.push(record);}}
this._currentIds=currentIds;this._commands.push(command);}
this.count++;this._needsReordering=true;}
_addSavePoint(){for(const id in this._cache){this._cache[id]._addSavePoint();}
this._savePoint=markRaw({_commands:[...this._commands],_currentIds:[...this._currentIds],count:this.count,});}
_applyCommands(commands,{canAddOverLimit,reload}={}){const{CREATE,UPDATE,DELETE,UNLINK,LINK,SET}=x2ManyCommands;let lastCommandIndex=-1;const commandsByIds={};function addOwnCommand(command){commandsByIds[command[1]]=commandsByIds[command[1]]||[];commandsByIds[command[1]].push({command,index:++lastCommandIndex});}
function getOwnCommands(id){commandsByIds[id]=commandsByIds[id]||[];return commandsByIds[id];}
for(const command of this._commands){addOwnCommand(command);}
const removedIds={};const recordsToLoad=[];for(const command of commands){switch(command[0]){case CREATE:{const virtualId=getId("virtual");const record=this._createRecordDatapoint(command[2],{virtualId});this.records.push(record);addOwnCommand([CREATE,virtualId]);this._currentIds.splice(this.offset+this.limit,0,virtualId);this.count++;break;}
case UPDATE:{const existingCommand=getOwnCommands(command[1]).some((x)=>x.command[0]===CREATE||x.command[0]===UPDATE);if(!existingCommand){addOwnCommand([UPDATE,command[1]]);}
const record=this._cache[command[1]];if(!record){if(!(command[1]in this._unknownRecordCommands)){this._unknownRecordCommands[command[1]]=[];}
this._unknownRecordCommands[command[1]].push(command);}else if(command[1]in this._unknownRecordCommands){this._unknownRecordCommands[command[1]].push(command);}else{const changes={};for(const fieldName in command[2]){if(["one2many","many2many"].includes(this.fields[fieldName].type)){const invisible=record.activeFields[fieldName]?.invisible;if(invisible==="True"||invisible==="1"||!(fieldName in record.activeFields)){if(!(command[1]in this._unknownRecordCommands)){this._unknownRecordCommands[command[1]]=[];}
this._unknownRecordCommands[command[1]].push(command);continue;}}
changes[fieldName]=command[2][fieldName];}
record._applyChanges(record._parseServerValues(changes,record.data));}
break;}
case DELETE:case UNLINK:{if(command[0]===UNLINK){const firstCommand=this._commands[0];const hasReplaceWithCommand=firstCommand&&firstCommand[0]===SET;if(hasReplaceWithCommand&&firstCommand[2].includes(command[1])){firstCommand[2]=firstCommand[2].filter((id)=>id!==command[1]);break;}}
const ownCommands=getOwnCommands(command[1]);if(command[0]===DELETE){const hasCreateCommand=ownCommands.some((x)=>x.command[0]===CREATE);ownCommands.splice(0);if(!hasCreateCommand){addOwnCommand([DELETE,command[1]]);}}else{const linkToIndex=ownCommands.findIndex((x)=>x.command[0]===LINK);if(linkToIndex>=0){ownCommands.splice(linkToIndex,1);}else{addOwnCommand([UNLINK,command[1]]);}}
removedIds[command[1]]=true;break;}
case LINK:{let record;if(command[1]in this._cache){record=this._cache[command[1]];}else{record=this._createRecordDatapoint({...command[2],id:command[1]});}
if(!this.limit||this.records.length<this.limit||canAddOverLimit){if(!command[2]){recordsToLoad.push(record);}
this.records.push(record);if(this.records.length>this.limit){this._tmpIncreaseLimit=this.records.length-this.limit;const nextLimit=this.limit+this._tmpIncreaseLimit;this.model._updateConfig(this.config,{limit:nextLimit},{reload:false});}}
this._currentIds.push(record.resId);addOwnCommand([command[0],command[1]]);this.count++;break;}}}
this._commands=Object.values(commandsByIds).flat().sort((x,y)=>x.index-y.index).map((x)=>x.command);if(Object.keys(removedIds).length){let removeCommandsByIdsCopy=Object.assign({},removedIds);this.records=this.records.filter((r)=>{const id=r.resId||r._virtualId;if(removeCommandsByIdsCopy[id]){delete removeCommandsByIdsCopy[id];return false;}
return true;});const nextCurrentIds=[];removeCommandsByIdsCopy=Object.assign({},removedIds);for(const id of this._currentIds){if(removeCommandsByIdsCopy[id]){delete removeCommandsByIdsCopy[id];}else{nextCurrentIds.push(id);}}
this._currentIds=nextCurrentIds;this.count=this._currentIds.length;}
const nbMissingRecords=this.limit-this.records.length;if(nbMissingRecords>0){const lastRecordIndex=this.limit+this.offset;const firstRecordIndex=lastRecordIndex-nbMissingRecords;const nextRecordIds=this._currentIds.slice(firstRecordIndex,lastRecordIndex);for(const id of this._getResIdsToLoad(nextRecordIds)){const record=this._createRecordDatapoint({id},{dontApplyCommands:true});recordsToLoad.push(record);}
for(const id of nextRecordIds){this.records.push(this._cache[id]);}}
if(recordsToLoad.length||reload){const resIds=reload?this.records.map((r)=>r.resId):recordsToLoad.map((r)=>r.resId);return this.model._loadRecords({...this.config,resIds}).then((recordValues)=>{if(reload){for(const record of recordValues){this._createRecordDatapoint(record);}
this.records=resIds.map((id)=>this._cache[id]);return;}
for(let i=0;i<recordsToLoad.length;i++){const record=recordsToLoad[i];record._applyValues(recordValues[i]);const commands=this._unknownRecordCommands[record.resId];if(commands){delete this._unknownRecordCommands[record.resId];this._applyCommands(commands);}}});}}
async _createNewRecordDatapoint(params={}){const changes={};if(!params.withoutParent&&this.config.relationField){changes[this.config.relationField]=this._parent._getChanges();if(!this._parent.isNew){changes[this.config.relationField].id=this._parent.resId;}}
const values=await this.model._loadNewRecord({resModel:this.resModel,activeFields:params.activeFields||this.activeFields,fields:this.fields,context:Object.assign({},this.context,params.context),},{changes,evalContext:this.evalContext});if(this.canResequence()&&this.records.length){const position=params.position||"bottom";const order=this.orderBy[0];const asc=!order||order.asc;let value;if(position==="top"){const isOnFirstPage=this.offset===0;value=this.records[0].data[this.handleField];if(isOnFirstPage){if(asc){value=value>0?value-1:0;}else{value=value+1;}}}else if(position==="bottom"){value=this.records[this.records.length-1].data[this.handleField];const isOnLastPage=this.limit+this.offset>=this.count;if(isOnLastPage){if(asc){value=value+1;}else{value=value>0?value-1:0;}}}
values[this.handleField]=value;}
return this._createRecordDatapoint(values,{mode:params.mode||"edit",virtualId:getId("virtual"),activeFields:params.activeFields,manuallyAdded:params.manuallyAdded,});}
_createRecordDatapoint(data,params={}){const resId=data.id||false;if(!resId&&!params.virtualId){throw new Error("You must provide a virtualId if the record has no id");}
const id=resId||params.virtualId;const config={context:this.context,activeFields:Object.assign({},params.activeFields||this.activeFields),resModel:this.resModel,fields:params.fields||this.fields,relationField:this.config.relationField,resId,resIds:resId?[resId]:[],mode:params.mode||"readonly",isMonoRecord:true,currentCompanyId:this.currentCompanyId,};const{CREATE,UPDATE}=x2ManyCommands;const options={parentRecord:this._parent,onUpdate:async({withoutParentUpdate})=>{if(!this.currentIds.includes(record.isNew?record._virtualId:record.resId)){return;}
const hasCommand=this._commands.some((c)=>(c[0]===CREATE||c[0]===UPDATE)&&c[1]===id);if(!hasCommand){this._commands.push([UPDATE,id]);}
if(record._noUpdateParent){return;}
if(!withoutParentUpdate){await this._onUpdate({withoutOnchange:!record._checkValidity({silent:true}),});}},virtualId:params.virtualId,manuallyAdded:params.manuallyAdded,};const record=new this.model.constructor.Record(this.model,config,data,options);this._cache[id]=record;if(!params.dontApplyCommands){const commands=this._unknownRecordCommands[id];if(commands){delete this._unknownRecordCommands[id];this._applyCommands(commands);}}
return record;}
_clearCommands(){this._commands=[];this._unknownRecordCommands={};}
_discard(){for(const id in this._cache){this._cache[id]._discard();}
if(this._savePoint){this._commands=this._savePoint._commands;this._currentIds=this._savePoint._currentIds;this.count=this._savePoint.count;this._savePoint=undefined;}else{this._commands=[];this._currentIds=[...this.resIds];this.count=this.resIds.length;}
this._unknownRecordCommands={};const limit=this.limit-this._tmpIncreaseLimit;this._tmpIncreaseLimit=0;this.model._updateConfig(this.config,{limit},{reload:false});this.records=this._currentIds.slice(this.offset,this.limit).map((resId)=>this._cache[resId]);}
_getCommands({withReadonly}={}){const{CREATE,UPDATE,LINK}=x2ManyCommands;const commands=[];for(const command of this._commands){if(command[0]===UPDATE&&command[1]in this._unknownRecordCommands){const uCommands=this._unknownRecordCommands[command[1]];for(const uCommand of uCommands){const values=fromUnityToServerValues(uCommand[2],this.fields,this.activeFields,{withReadonly,context:this.context});commands.push([uCommand[0],uCommand[1],values]);}}else if(command[0]===CREATE||command[0]===UPDATE){const record=this._cache[command[1]];if(command[0]===CREATE&&record.resId){commands.push([LINK,record.resId]);}else{const values=record._getChanges(record._changes,{withReadonly});if(command[0]===CREATE||Object.keys(values).length){commands.push([command[0],command[1],values]);}}}else{commands.push(command);}}
return commands;}
_getResIdsToLoad(resIds,fieldNames=this.fieldNames){return resIds.filter((resId)=>{if(typeof resId==="string"){return false;}
const record=this._cache[resId];if(!record){return true;}
fieldNames=fieldNames.filter((fieldName)=>fieldName!=="id");return intersection(fieldNames,record.fieldNames).length!==fieldNames.length;});}
async _load({limit=this.limit,offset=this.offset,orderBy=this.orderBy,nextCurrentIds=this._currentIds,}={}){const currentIds=nextCurrentIds.slice(offset,offset+limit);const resIds=this._getResIdsToLoad(currentIds);if(resIds.length){const records=await this.model._loadRecords({...this.config,resIds},this.evalContext);for(const record of records){this._createRecordDatapoint(record);}}
this.records=currentIds.map((id)=>this._cache[id]);this._currentIds=nextCurrentIds;await this.model._updateConfig(this.config,{limit,offset,orderBy},{reload:false});}
async _replaceWith(ids,{reload=false}={}){const resIds=reload?ids:ids.filter((id)=>!this._cache[id]);if(resIds.length){const records=await this.model._loadRecords({...this.config,resIds,context:this.context,});for(const record of records){this._createRecordDatapoint(record);}}
this.records=ids.map((id)=>this._cache[id]);const updateCommandsToKeep=this._commands.filter((c)=>c[0]===x2ManyCommands.UPDATE&&ids.includes(c[1]));this._commands=[x2ManyCommands.set(ids)].concat(updateCommandsToKeep);this._currentIds=[...ids];this.count=this._currentIds.length;if(this._currentIds.length>this.limit){this._tmpIncreaseLimit=this._currentIds.length-this.limit;const nextLimit=this.limit+this._tmpIncreaseLimit;this.model._updateConfig(this.config,{limit:nextLimit},{reload:false});}}
async _resequence(movedId,targetId){const records=[...this.records];const order=this.orderBy.find((o)=>o.name===this.handleField);const asc=!order||order.asc;const fromIndex=records.findIndex((r)=>r.id===movedId);let toIndex=0;if(targetId!==null){const targetIndex=records.findIndex((r)=>r.id===targetId);toIndex=fromIndex>targetIndex?targetIndex+1:targetIndex;}
const getSequence=(rec)=>rec&&rec.data[this.handleField];const firstIndex=Math.min(fromIndex,toIndex);const lastIndex=Math.max(fromIndex,toIndex)+1;let reorderAll=false;let lastSequence=(asc?-1:1)*Infinity;for(let index=0;index<records.length;index++){const sequence=getSequence(records[index]);if(((index<firstIndex||index>=lastIndex)&&((asc&&lastSequence>=sequence)||(!asc&&lastSequence<=sequence)))||(index>=firstIndex&&index<lastIndex&&lastSequence===sequence)){reorderAll=true;}
lastSequence=sequence;}
const[record]=records.splice(fromIndex,1);records.splice(toIndex,0,record);let toReorder=records;if(!reorderAll){toReorder=toReorder.slice(firstIndex,lastIndex).filter((r)=>r.id!==movedId);if(fromIndex<toIndex){toReorder.push(record);}else{toReorder.unshift(record);}}
if(!asc){toReorder.reverse();}
const sequences=toReorder.map(getSequence);const offset=sequences.length&&Math.min(...sequences);const proms=[];for(const[i,record]of Object.entries(toReorder)){proms.push(record._update({[this.handleField]:offset+Number(i)},{withoutParentUpdate:true}));}
await Promise.all(proms);await this._sort();await this._onUpdate();}
async _sort(currentIds=this.currentIds,orderBy=this.orderBy){const fieldNames=orderBy.map((o)=>o.name);const resIds=this._getResIdsToLoad(currentIds,fieldNames);if(resIds.length){const activeFields=pick(this.activeFields,...fieldNames);const config={...this.config,resIds,activeFields};const records=await this.model._loadRecords(config);for(const record of records){this._createRecordDatapoint(record,{activeFields});}}
const allRecords=currentIds.map((id)=>this._cache[id]);const sortedRecords=allRecords.sort((r1,r2)=>{return compareRecords(r1,r2,orderBy,this.fields);});await this._load({orderBy,nextCurrentIds:sortedRecords.map((r)=>r.resId||r._virtualId),});this._needsReordering=false;}
async _sortBy(fieldName){let orderBy=[...this.orderBy];if(fieldName){if(orderBy.length&&orderBy[0].name===fieldName){if(!this._needsReordering){orderBy[0]={name:orderBy[0].name,asc:!orderBy[0].asc};}}else{orderBy=orderBy.filter((o)=>o.name!==fieldName);orderBy.unshift({name:fieldName,asc:true,});}}
return this._sort(this._currentIds,orderBy);}
_updateContext(context){Object.assign(this.context,context);for(const record of Object.values(this._cache)){record._setEvalContext();}}}
return __exports;});;

/* /web/static/src/model/relational_model/utils.js */
odoo.define('@web/model/relational_model/utils',['@odoo/owl','@web/core/context','@web/core/l10n/dates','@web/core/orm_service','@web/core/py_js/py','@web/core/utils/concurrency','@web/core/utils/objects','@web/core/utils/reactive','@web/core/utils/timing','@web/search/utils/order_by'],function(require){'use strict';let __exports={};const{markup,onWillDestroy,onWillStart,onWillUpdateProps,useComponent}=require("@odoo/owl");const{evalPartialContext,makeContext}=require("@web/core/context");const{deserializeDate,deserializeDateTime,serializeDate,serializeDateTime,}=require("@web/core/l10n/dates");const{x2ManyCommands}=require("@web/core/orm_service");const{evaluateExpr}=require("@web/core/py_js/py");const{Deferred}=require("@web/core/utils/concurrency");const{omit}=require("@web/core/utils/objects");const{effect}=require("@web/core/utils/reactive");const{batched}=require("@web/core/utils/timing");const{orderByToString}=require("@web/search/utils/order_by");function convertBoolToPyExpr(value){if(value===true||value===false){return value?"True":"False";}
return value;}
__exports.makeActiveField=makeActiveField;function makeActiveField({context,invisible,readonly,required,onChange,forceSave,isHandle,}={}){return{context:context||"{}",invisible:convertBoolToPyExpr(invisible||false),readonly:convertBoolToPyExpr(readonly||false),required:convertBoolToPyExpr(required||false),onChange:onChange||false,forceSave:forceSave||false,isHandle:isHandle||false,};}
const AGGREGATABLE_FIELD_TYPES=["float","integer","monetary"];const FetchRecordError=__exports.FetchRecordError=class FetchRecordError extends Error{constructor(resIds){super(`Can't fetch record(s) ${resIds}. They might have been deleted.`);}}
__exports.addFieldDependencies=addFieldDependencies;function addFieldDependencies(activeFields,fields,fieldDependencies=[]){for(const field of fieldDependencies){if(!("readonly"in field)){field.readonly=true;}
if(field.name in activeFields){patchActiveFields(activeFields[field.name],makeActiveField(field));}else{activeFields[field.name]=makeActiveField(field);}
if(!fields[field.name]){const newField=omit(field,["context","invisible","required","readonly","onChange",]);fields[field.name]=newField;if(newField.type==="selection"&&!Array.isArray(newField.selection)){newField.selection=[];}}}}
function completeActiveField(activeField,extra){if(extra.related){for(const fieldName in extra.related.activeFields){if(fieldName in activeField.related.activeFields){completeActiveField(activeField.related.activeFields[fieldName],extra.related.activeFields[fieldName]);}else{activeField.related.activeFields[fieldName]={...extra.related.activeFields[fieldName],};}}
Object.assign(activeField.related.fields,extra.related.fields);}}
__exports.completeActiveFields=completeActiveFields;function completeActiveFields(activeFields,extraActiveFields){for(const fieldName in extraActiveFields){const extraActiveField={...extraActiveFields[fieldName],invisible:"True",};if(fieldName in activeFields){completeActiveField(activeFields[fieldName],extraActiveField);}else{activeFields[fieldName]=extraActiveField;}}}
__exports.createPropertyActiveField=createPropertyActiveField;function createPropertyActiveField(property){const{type}=property;const activeField=makeActiveField();if(type==="one2many"||type==="many2many"){activeField.related={fields:{id:{name:"id",type:"integer"},display_name:{name:"display_name",type:"char"},},activeFields:{id:makeActiveField({readonly:true}),display_name:makeActiveField(),},};}
return activeField;}
__exports.combineModifiers=combineModifiers;function combineModifiers(mod1,mod2,operator){if(operator==="AND"){if(!mod1||mod1==="False"||!mod2||mod2==="False"){return"False";}
if(mod1==="True"){return mod2;}
if(mod2==="True"){return mod1;}
return"("+mod1+") and ("+mod2+")";}else if(operator==="OR"){if(mod1==="True"||mod2==="True"){return"True";}
if(!mod1||mod1==="False"){return mod2;}
if(!mod2||mod2==="False"){return mod1;}
return"("+mod1+") or ("+mod2+")";}
throw new Error(`Operator provided to "combineModifiers" must be "AND" or "OR", received ${operator}`);}
__exports.patchActiveFields=patchActiveFields;function patchActiveFields(activeField,patch){activeField.invisible=combineModifiers(activeField.invisible,patch.invisible,"AND");activeField.readonly=combineModifiers(activeField.readonly,patch.readonly,"AND");activeField.required=combineModifiers(activeField.required,patch.required,"OR");activeField.onChange=activeField.onChange||patch.onChange;activeField.forceSave=activeField.forceSave||patch.forceSave;activeField.isHandle=activeField.isHandle||patch.isHandle;if(patch.related){const related=activeField.related;for(const fieldName in patch.related.activeFields){if(fieldName in related.activeFields){patchActiveFields(related.activeFields[fieldName],patch.related.activeFields[fieldName]);}else{related.activeFields[fieldName]={...patch.related.activeFields[fieldName]};}}
Object.assign(related.fields,patch.related.fields);}
if("limit"in patch){activeField.limit=patch.limit;}
if(patch.defaultOrderBy){activeField.defaultOrderBy=patch.defaultOrderBy;}}
__exports.extractFieldsFromArchInfo=extractFieldsFromArchInfo;function extractFieldsFromArchInfo({fieldNodes,widgetNodes},fields){const activeFields={};for(const fieldNode of Object.values(fieldNodes)){const fieldName=fieldNode.name;const activeField=makeActiveField({context:fieldNode.context,invisible:combineModifiers(fieldNode.invisible,fieldNode.column_invisible,"OR"),readonly:fieldNode.readonly,required:fieldNode.required,onChange:fieldNode.onChange,forceSave:fieldNode.forceSave,isHandle:fieldNode.isHandle,});if(["one2many","many2many"].includes(fields[fieldName].type)){activeField.related={activeFields:{},fields:{},};if(fieldNode.views){const viewDescr=fieldNode.views[fieldNode.viewMode];if(viewDescr){activeField.related=extractFieldsFromArchInfo(viewDescr,viewDescr.fields);activeField.limit=viewDescr.limit;activeField.defaultOrderBy=viewDescr.defaultOrder;if(fieldNode.views.form){const formArchInfo=extractFieldsFromArchInfo(fieldNode.views.form,fieldNode.views.form.fields);completeActiveFields(activeField.related.activeFields,formArchInfo.activeFields);Object.assign(activeField.related.fields,formArchInfo.fields);}
if(fieldNode.viewMode!=="default"&&fieldNode.views.default){const defaultArchInfo=extractFieldsFromArchInfo(fieldNode.views.default,fieldNode.views.default.fields);for(const fieldName in defaultArchInfo.activeFields){if(fieldName in activeField.related.activeFields){patchActiveFields(activeField.related.activeFields[fieldName],defaultArchInfo.activeFields[fieldName]);}else{activeField.related.activeFields[fieldName]={...defaultArchInfo.activeFields[fieldName],};}}
activeField.related.fields=Object.assign({},defaultArchInfo.fields,activeField.related.fields);}}}
if(fieldNode.field?.useSubView){activeField.required="False";}}
if(fieldName in activeFields){patchActiveFields(activeFields[fieldName],activeField);}else{activeFields[fieldName]=activeField;}
if(fieldNode.field){let fieldDependencies=fieldNode.field.fieldDependencies;if(typeof fieldDependencies==="function"){fieldDependencies=fieldDependencies(fieldNode);}
addFieldDependencies(activeFields,fields,fieldDependencies);}}
for(const widgetInfo of Object.values(widgetNodes||{})){let fieldDependencies=widgetInfo.widget.fieldDependencies;if(typeof fieldDependencies==="function"){fieldDependencies=fieldDependencies(widgetInfo);}
addFieldDependencies(activeFields,fields,fieldDependencies);}
return{activeFields,fields};}
__exports.getFieldContext=getFieldContext;function getFieldContext(record,fieldName,rawContext=record.activeFields[fieldName].context){const context={};for(const key in record.context){if(!key.startsWith("default_")&&!key.startsWith("search_default_")&&!key.endsWith("_view_ref")){context[key]=record.context[key];}}
return{...context,...record.fields[fieldName].context,...makeContext([rawContext],record.evalContext),};}
__exports.getBasicEvalContext=getBasicEvalContext;function getBasicEvalContext(config){const{uid,allowed_company_ids}=config.context;return{context:config.context,uid,allowed_company_ids,active_id:config.resId||false,active_ids:config.resId?[config.resId]:[],active_model:config.resModel,current_company_id:config.currentCompanyId,};}
__exports.getFieldsSpec=getFieldsSpec;function getFieldsSpec(activeFields,fields,evalContext,{parentActiveFields,withInvisible}={}){const fieldsSpec={};const properties=[];for(const fieldName in activeFields){if(fields[fieldName].relatedPropertyField){continue;}
const{related,limit,defaultOrderBy,invisible}=activeFields[fieldName];fieldsSpec[fieldName]={};if(related&&((invisible!=="True"&&invisible!=="1")||withInvisible)){fieldsSpec[fieldName].fields=getFieldsSpec(related.activeFields,related.fields,evalContext,{parentActiveFields:activeFields,withInvisible});fieldsSpec[fieldName].limit=limit;if(defaultOrderBy){fieldsSpec[fieldName].order=orderByToString(defaultOrderBy);}}
if(fields[fieldName].type==="properties"){properties.push(fieldName);}
if(fields[fieldName].type==="many2one"){fieldsSpec[fieldName].fields={};if(invisible!=="True"&&invisible!=="1"){fieldsSpec[fieldName].fields.display_name={};}}
if(["many2one","one2many","many2many"].includes(fields[fieldName].type)){let context=activeFields[fieldName].context;if(!context||context==="{}"){context=fields[fieldName].context||{};}else{context=evalPartialContext(context,evalContext);}
if(Object.keys(context).length>0){fieldsSpec[fieldName].context=context;}}
if(fields[fieldName].type==="reference"){fieldsSpec[fieldName].fields={display_name:{}};}}
for(const fieldName of properties){const fieldSpec=fieldsSpec[fields[fieldName].definition_record];if(fieldSpec){if(!fieldSpec.fields){fieldSpec.fields={};}
fieldSpec.fields.display_name={};}}
return fieldsSpec;}
let nextId=0;__exports.getId=getId;function getId(prefix=""){return`${prefix}_${++nextId}`;}
__exports.parseServerValue=parseServerValue;function parseServerValue(field,value){switch(field.type){case"char":case"text":{return value||"";}
case"html":{return markup(value||"");}
case"date":{return value?deserializeDate(value):false;}
case"datetime":{return value?deserializeDateTime(value):false;}
case"selection":{if(value===false){const hasKey0=field.selection.find((option)=>option[0]===0);return hasKey0?0:value;}
return value;}
case"reference":{if(value===false){return false;}
return{resId:value.id.id,resModel:value.id.model,displayName:value.display_name,};}
case"many2one":{if(Array.isArray(value)){return value;}
return value?[value.id,value.display_name]:false;}
case"properties":{return value?value.map((property)=>({...property,value:parseServerValue(property,property.value??false),})):[];}}
return value;}
__exports.extractInfoFromGroupData=extractInfoFromGroupData;function extractInfoFromGroupData(groupData,groupBy,fields){const info={};const groupByField=fields[groupBy[0].split(":")[0]];info.count=groupData.__count||groupData[`${groupByField.name}_count`];info.length=info.count;info.range=groupData.__range?groupData.__range[groupBy[0]]:null;info.domain=groupData.__domain;info.rawValue=groupData[groupBy[0]];info.value=getValueFromGroupData(groupByField,info.rawValue,info.range);info.displayName=getDisplayNameFromGroupData(groupByField,info.rawValue);info.serverValue=getGroupServerValue(groupByField,info.value);info.aggregates=getAggregatesFromGroupData(groupData,fields);return info;}
function getAggregatesFromGroupData(groupData,fields){const aggregates={};for(const[key,value]of Object.entries(groupData)){if(key in fields&&AGGREGATABLE_FIELD_TYPES.includes(fields[key].type)){aggregates[key]=value;}}
return aggregates;}
function getDisplayNameFromGroupData(field,rawValue){if(field.type==="selection"){return Object.fromEntries(field.selection)[rawValue];}
if(["many2one","many2many","tags"].includes(field.type)){return rawValue?rawValue[1]:false;}
return rawValue;}
__exports.getGroupServerValue=getGroupServerValue;function getGroupServerValue(field,value){switch(field.type){case"many2many":{return value?[value]:false;}
case"datetime":{return value?serializeDateTime(value):false;}
case"date":{return value?serializeDate(value):false;}
default:{return value||false;}}}
function getValueFromGroupData(field,rawValue,range){if(["date","datetime"].includes(field.type)){if(!range){return false;}
const dateValue=parseServerValue(field,range.to);return dateValue.minus({[field.type==="date"?"day":"second"]:1,});}
const value=parseServerValue(field,rawValue);if(["many2one","many2many"].includes(field.type)){return value?value[0]:false;}
return value;}
__exports.fromUnityToServerValues=fromUnityToServerValues;function fromUnityToServerValues(values,fields,activeFields,{withReadonly,context}={}){const{CREATE,UPDATE}=x2ManyCommands;const serverValues={};for(const fieldName in values){let value=values[fieldName];const field=fields[fieldName];const activeField=activeFields[fieldName];if(!withReadonly){if(field.readonly){continue;}
try{if(evaluateExpr(activeField.readonly,context)){continue;}}catch{}}
switch(fields[fieldName].type){case"one2many":case"many2many":value=value.map((c)=>{if(c[0]===CREATE||c[0]===UPDATE){const _fields=activeField.related.fields;const _activeFields=activeField.related.activeFields;return[c[0],c[1],fromUnityToServerValues(c[2],_fields,_activeFields,{withReadonly}),];}
return[c[0],c[1]];});break;case"many2one":value=value?value.id:false;break;}
serverValues[fieldName]=value;}
return serverValues;}
__exports.isRelational=isRelational;function isRelational(field){return field&&["one2many","many2many","many2one"].includes(field.type);}
__exports.useRecordObserver=useRecordObserver;function useRecordObserver(callback){const component=useComponent();let alive=true;let props=component.props;const fct=()=>{const def=new Deferred();let firstCall=true;effect((record)=>{if(firstCall){firstCall=false;return Promise.resolve(callback(record,props)).then(def.resolve).catch(def.reject);}else{return batched((record)=>{if(!alive){return;}
return Promise.resolve(callback(record,props)).then(def.resolve).catch(def.reject);},()=>new Promise((resolve)=>window.requestAnimationFrame(resolve)))(record);}},[props.record]);return def;};onWillDestroy(()=>{alive=false;});onWillStart(()=>fct());onWillUpdateProps((nextProps)=>{const currentRecordId=props.record.id;props=nextProps;if(props.record.id!==currentRecordId){return fct();}});}
return __exports;});;

/* /web/static/src/model/sample_server.js */
odoo.define('@web/model/sample_server',['@web/core/l10n/dates','@web/core/orm_service','@web/core/registry','@web/core/utils/arrays','@web/model/relational_model/utils'],function(require){'use strict';let __exports={};const{deserializeDate,deserializeDateTime,parseDate,serializeDate,serializeDateTime,}=require("@web/core/l10n/dates");const{ORM}=require("@web/core/orm_service");const{registry}=require("@web/core/registry");const{cartesian,sortBy:arraySortBy}=require("@web/core/utils/arrays");const{parseServerValue}=require("@web/model/relational_model/utils");class UnimplementedRouteError extends Error{}
let searchReadNumber=0;function getSampleFromId(id,sampleTexts){return sampleTexts[(id-1)%sampleTexts.length];}
function serializeGroupDateValue(range,field){if(!range){return false;}
let dateValue=parseServerValue(field,range.to);dateValue=dateValue.minus({[field.type==="date"?"day":"second"]:1,});return field.type==="date"?serializeDate(dateValue):serializeDateTime(dateValue);}
function fieldNameRegex(...terms){return new RegExp(`\\b((\\w+)?_)?(${terms.join("|")})(_(\\w+)?)?\\b`);}
const MEASURE_SPEC_REGEX=/(?<measure>\w+):(?<aggregateFunction>\w+)(\((?<fieldName>\w+)\))?/;const DESCRIPTION_REGEX=fieldNameRegex("description","label","title","subject","message");const EMAIL_REGEX=fieldNameRegex("email");const PHONE_REGEX=fieldNameRegex("phone");const URL_REGEX=fieldNameRegex("url");const SampleServer=__exports.SampleServer=class SampleServer{constructor(modelName,fields){this.mainModel=modelName;this.data={};this.data[modelName]={fields,records:[],};for(const fieldName in fields){const field=fields[fieldName];if(["many2one","one2many","many2many"].includes(field.type)){this.data[field.relation]=this.data[field.relation]||{fields:{display_name:{type:"char"},id:{type:"integer"},color:{type:"integer"},},records:[],};}}
this.existingGroups=null;this.populated=false;this.existingGroupsPopulated=false;}
mockRpc(params){if(!(params.model in this.data)){throw new Error(`SampleServer: unknown model ${params.model}`);}
this._populateModels();switch(params.method||params.route){case"web_search_read":return this._mockWebSearchReadUnity(params);case"web_read_group":return this._mockWebReadGroup(params);case"read_group":return this._mockReadGroup(params);case"read_progress_bar":return this._mockReadProgressBar(params);case"read":return this._mockRead(params);}
const method=params.method||params.route;const mockFunction=registry.category("sample_server").get(`${params.model}/${method}`,null)||registry.category("sample_server").get(method,null);if(mockFunction){return mockFunction.call(this,params);}
console.log(`SampleServer: unimplemented route "${params.method || params.route}"`);throw new SampleServer.UnimplementedRouteError();}
setExistingGroups(groups){this.existingGroups=groups;}
_aggregateFields(measures,records){const values={};for(const{fieldName,type,aggregateFunction}of measures){if(["float","integer","monetary"].includes(type)){if(aggregateFunction==="array_agg"){values[fieldName]=(records||[]).map((r)=>r[fieldName]);}else if(records.length){let value=0;for(const record of records){value+=record[fieldName];}
values[fieldName]=this._sanitizeNumber(value);}else{values[fieldName]=null;}}
if(type==="many2one"){const ids=new Set(records.map((r)=>r[fieldName]));values.fieldName=ids.size||null;}}
return values;}
_formatValue(value,options){if(!value){return false;}
const{type,interval,relation}=options;if(["date","datetime"].includes(type)){const fmt=SampleServer.FORMATS[interval];return parseDate(value).toFormat(fmt);}else if(["many2one","many2many"].includes(type)){const rec=this.data[relation].records.find(({id})=>id===value);return[value,rec.display_name];}else{return value;}}
_generateFieldValue(modelName,fieldName,id){const field=this.data[modelName].fields[fieldName];switch(field.type){case"boolean":return fieldName==="active"?true:this._getRandomBool();case"char":case"text":if(["display_name","name"].includes(fieldName)){if(SampleServer.PEOPLE_MODELS.includes(modelName)){return getSampleFromId(id,SampleServer.SAMPLE_PEOPLE);}else if(modelName==="res.country"){return getSampleFromId(id,SampleServer.SAMPLE_COUNTRIES);}}
if(fieldName==="display_name"){return getSampleFromId(id,SampleServer.SAMPLE_TEXTS);}else if(["name","reference"].includes(fieldName)){return`REF${String(id).padStart(4, "0")}`;}else if(DESCRIPTION_REGEX.test(fieldName)){return getSampleFromId(id,SampleServer.SAMPLE_TEXTS);}else if(EMAIL_REGEX.test(fieldName)){const emailName=getSampleFromId(id,SampleServer.SAMPLE_PEOPLE).replace(/ /,".").toLowerCase();return`${emailName}@sample.demo`;}else if(PHONE_REGEX.test(fieldName)){return`+1 555 754 ${String(id).padStart(4, "0")}`;}else if(URL_REGEX.test(fieldName)){return`http://sample${id}.com`;}
return false;case"date":case"datetime":{const datetime=this._getRandomDate();return field.type==="date"?serializeDate(datetime):serializeDateTime(datetime);}
case"float":return this._getRandomFloat(SampleServer.MAX_FLOAT);case"integer":{let max=SampleServer.MAX_INTEGER;if(fieldName.includes("color")){max=this._getRandomBool()?SampleServer.MAX_COLOR_INT:0;}
return this._getRandomInt(max);}
case"monetary":return this._getRandomInt(SampleServer.MAX_MONETARY);case"many2one":if(field.relation==="res.currency"){return 1;}
if(field.relation==="ir.attachment"){return false;}
return this._getRandomSubRecordId();case"one2many":case"many2many":{const ids=[this._getRandomSubRecordId(),this._getRandomSubRecordId()];return[...new Set(ids)];}
case"selection":{if(fieldName==="activity_exception_decoration"){return false;}
if(field.selection.length>0){return this._getRandomArrayEl(field.selection)[0];}
return false;}
default:return false;}}
_getRandomArrayEl(array){return array[Math.floor(Math.random()*array.length)];}
_getRandomBool(){return Math.random()<0.5;}
_getRandomDate(){const delta=Math.floor((Math.random()-Math.random())*SampleServer.DATE_DELTA);return luxon.DateTime.local().plus({hours:delta});}
_getRandomFloat(max){return this._sanitizeNumber(Math.random()*max);}
_getRandomInt(max){return Math.floor(Math.random()*max);}
_getRandomSubRecordId(){return Math.floor(Math.random()*SampleServer.SUB_RECORDSET_SIZE)+1;}
_mockRead(params){const model=this.data[params.model];const ids=params.args[0];const fieldNames=params.args[1];const records=[];for(const r of model.records){if(!ids.includes(r.id)){continue;}
const record={id:r.id};for(const fieldName of fieldNames){const field=model.fields[fieldName];if(!field){record[fieldName]=false;}else if(field.type==="many2one"){const relModel=this.data[field.relation];const relRecord=relModel.records.find((relR)=>r[fieldName]===relR.id);record[fieldName]=relRecord?[relRecord.id,relRecord.display_name]:false;}else{record[fieldName]=r[fieldName];}}
records.push(record);}
return records;}
_mockReadGroup(params){const lazy="lazy"in params?params.lazy:true;const model=params.model;const fields=this.data[model].fields;const records=this.data[model].records;const normalizedGroupBys=[];let groupBy=[];if(params.groupBy.length){groupBy=lazy?[params.groupBy[0]]:params.groupBy;}
for(const groupBySpec of groupBy){let[fieldName,interval]=groupBySpec.split(":");interval=interval||"month";const{type,relation}=fields[fieldName];if(type){const gb={fieldName,type,interval,relation,alias:groupBySpec};normalizedGroupBys.push(gb);}}
const groupsFromRecord=(record)=>{const values=[];for(const gb of normalizedGroupBys){const{fieldName,type}=gb;let fieldVals;if(["date","datetime"].includes(type)){fieldVals=[this._formatValue(record[fieldName],gb)];}else if(type==="many2many"){fieldVals=record[fieldName].length?record[fieldName]:[false];}else{fieldVals=[record[fieldName]];}
values.push(fieldVals.map((val)=>({[fieldName]:val})));}
const cart=cartesian(...values);return cart.map((tuple)=>{if(!Array.isArray(tuple)){tuple=[tuple];}
return Object.assign({},...tuple);});};const groups={};for(const record of records){const recordGroups=groupsFromRecord(record);for(const group of recordGroups){const groupId=JSON.stringify(group);if(!(groupId in groups)){groups[groupId]=[];}
groups[groupId].push(record);}}
const measures=[];for(const measureSpec of params.fields||Object.keys(fields)){const matches=measureSpec.match(MEASURE_SPEC_REGEX);let{fieldName,aggregateFunction,measure}=(matches&&matches.groups)||{};if(!aggregateFunction&&fieldName in fields&&fields[fieldName].group_operator){aggregateFunction=fields[fieldName].group_operator;measure=fieldName;}
if(!fieldName&&!measure){continue;}
const fName=fieldName||measure;const{type}=fields[fName];if(!params.groupBy.includes(fName)&&type&&(type!=="many2one"||aggregateFunction!=="count_distinct")){measures.push({fieldName:fName,type,aggregateFunction});}}
let result=[];for(const id in groups){const records=groups[id];const group={__domain:[]};let countKey=`__count`;if(normalizedGroupBys.length&&lazy){countKey=`${normalizedGroupBys[0].fieldName}_count`;}
group[countKey]=records.length;const firstElem=records[0];const parsedId=JSON.parse(id);for(const gb of normalizedGroupBys){const{alias,fieldName,type}=gb;if(type==="many2many"){group[alias]=this._formatValue(parsedId[fieldName],gb);}else{group[alias]=this._formatValue(firstElem[fieldName],gb);if(["date","datetime"].includes(type)){group.__range={};const val=firstElem[fieldName];if(val){const deserialize=type==="date"?deserializeDate:deserializeDateTime;const serialize=type==="date"?serializeDate:serializeDateTime;const from=deserialize(val).startOf(gb.interval);const to=SampleServer.INTERVALS[gb.interval](from);group.__range[alias]={from:serialize(from),to:serialize(to)};}else{group.__range[alias]=false;}}}}
Object.assign(group,this._aggregateFields(measures,records));result.push(group);}
if(normalizedGroupBys.length>0){const{alias,interval,type}=normalizedGroupBys[0];result=arraySortBy(result,(group)=>{const val=group[alias];if(["date","datetime"].includes(type)){return parseDate(val,{format:SampleServer.FORMATS[interval]});}
return val;});}
return result;}
_mockReadProgressBar(params){const groupBy=params.group_by.split(":")[0];const progress_bar=params.progress_bar;const groupByField=this.data[params.model].fields[groupBy];const data={};for(const record of this.data[params.model].records){let groupByValue=record[groupBy];if(groupByField.type==="many2one"){const relatedRecords=this.data[groupByField.relation].records;const relatedRecord=relatedRecords.find((r)=>r.id===groupByValue);groupByValue=relatedRecord.display_name;}
if(!(groupByValue in data)){if(groupByValue===true){groupByValue="True";}else if(groupByValue===false){groupByValue="False";}}
if(!(groupByValue in data)){data[groupByValue]={};for(const key in progress_bar.colors){data[groupByValue][key]=0;}}
const fieldValue=record[progress_bar.field];if(fieldValue in data[groupByValue]){data[groupByValue][fieldValue]++;}}
return data;}
_mockWebSearchReadUnity(params){const fields=Object.keys(params.specification);let result;if(this.existingGroups){const groups=this.existingGroups;const group=groups[searchReadNumber++%groups.length];result={records:group.__data.records,length:group.__data.records.length,};}else{const model=this.data[params.model];const rawRecords=model.records.slice(0,SampleServer.SEARCH_READ_LIMIT);const records=this._mockRead({model:params.model,args:[rawRecords.map((r)=>r.id),fields],});result={records,length:records.length};}
for(const fieldName in params.specification){const field=this.data[params.model].fields[fieldName];if(field.type==="many2one"){for(const record of result.records){record[fieldName]=record[fieldName]?{id:record[fieldName][0],display_name:record[fieldName][1],}:false;}}
if(field.type==="one2many"||field.type==="many2many"){const relFields=Object.keys(params.specification[fieldName].fields||{});if(relFields.length){const relIds=result.records.map((r)=>r[fieldName]).flat();const relRecords={};const _relRecords=this._mockRead({model:field.relation,args:[relIds,relFields],});for(const relRecord of _relRecords){relRecords[relRecord.id]=relRecord;}
for(const record of result.records){record[fieldName]=record[fieldName].map((resId)=>relRecords[resId]);}}}}
return result;}
_mockWebReadGroup(params){let groups;if(this.existingGroups){this._tweakExistingGroups(params);groups=this.existingGroups;}else{groups=this._mockReadGroup(params);}
return{groups,length:groups.length,};}
_populateExistingGroups(params){const groups=this.existingGroups;const groupBy=params.groupBy[0].split(":")[0];const groupByField=this.data[params.model].fields[groupBy];const groupedByM2O=groupByField.type==="many2one";if(groupedByM2O){this.data[groupByField.relation].records=groups.map((g)=>{return{id:g[groupBy][0],display_name:g[groupBy][1]};});}
for(const r of this.data[params.model].records){const group=getSampleFromId(r.id,groups);if(["date","datetime"].includes(groupByField.type)){r[groupBy]=serializeGroupDateValue(group.__range[params.groupBy[0]],groupByField);}else if(groupByField.type==="many2one"){r[groupBy]=group[params.groupBy[0]]?group[params.groupBy[0]][0]:false;}else{r[groupBy]=group[params.groupBy[0]];}}}
_populateModels(){if(!this.populated){for(const modelName in this.data){const model=this.data[modelName];const fieldNames=Object.keys(model.fields).filter((f)=>f!=="id");const size=modelName===this.mainModel?SampleServer.MAIN_RECORDSET_SIZE:SampleServer.SUB_RECORDSET_SIZE;for(let id=1;id<=size;id++){const record={id};for(const fieldName of fieldNames){record[fieldName]=this._generateFieldValue(modelName,fieldName,id);}
model.records.push(record);}}
this.populated=true;}}
_sanitizeNumber(value){return parseFloat(value.toFixed(SampleServer.FLOAT_PRECISION));}
_tweakExistingGroups(params){const groups=this.existingGroups;this._populateExistingGroups(params);const fullGroupBy=params.groupBy[0];const groupBy=fullGroupBy.split(":")[0];const groupByField=this.data[params.model].fields[groupBy];const records=this.data[params.model].records;for(const g of groups){const recordsInGroup=records.filter((r)=>{if(["date","datetime"].includes(groupByField.type)){return(r[groupBy]===serializeGroupDateValue(g.__range[fullGroupBy],groupByField));}else if(groupByField.type==="many2one"){return(!r[groupBy]&&!g[fullGroupBy])||r[groupBy]===g[fullGroupBy][0];}
return r[groupBy]===g[fullGroupBy];});for(const field of params.fields){const fieldType=this.data[params.model].fields[field].type;if(["integer, float","monetary"].includes(fieldType)){g[field]=recordsInGroup.reduce((acc,r)=>acc+r[field],0);}}
g[`${groupBy}_count`]=recordsInGroup.length;g.__data={records:this._mockRead({model:params.model,args:[recordsInGroup.map((r)=>r.id),params.fields],}),length:recordsInGroup.length,};}}}
SampleServer.FORMATS={day:"yyyy-MM-dd",week:"'W'WW kkkk",month:"MMMM yyyy",quarter:"'Q'q yyyy",year:"y",};SampleServer.INTERVALS={day:(dt)=>dt.plus({days:1}),week:(dt)=>dt.plus({weeks:1}),month:(dt)=>dt.plus({months:1}),quarter:(dt)=>dt.plus({months:3}),year:(dt)=>dt.plus({years:1}),};SampleServer.DISPLAY_FORMATS=Object.assign({},SampleServer.FORMATS,{day:"dd MMM yyyy"});SampleServer.MAIN_RECORDSET_SIZE=16;SampleServer.SUB_RECORDSET_SIZE=5;SampleServer.SEARCH_READ_LIMIT=10;SampleServer.MAX_FLOAT=100;SampleServer.MAX_INTEGER=50;SampleServer.MAX_COLOR_INT=7;SampleServer.MAX_MONETARY=100000;SampleServer.DATE_DELTA=24*60;SampleServer.FLOAT_PRECISION=2;SampleServer.SAMPLE_COUNTRIES=["Belgium","France","Portugal","Singapore","Australia"];SampleServer.SAMPLE_PEOPLE=["John Miller","Henry Campbell","Carrie Helle","Wendi Baltz","Thomas Passot",];SampleServer.SAMPLE_TEXTS=["Laoreet id","Volutpat blandit","Integer vitae","Viverra nam","In massa",];SampleServer.PEOPLE_MODELS=["res.users","res.partner","hr.employee","mail.followers","mailing.contact",];SampleServer.UnimplementedRouteError=UnimplementedRouteError;__exports.buildSampleORM=buildSampleORM;function buildSampleORM(resModel,fields,user){const sampleServer=new SampleServer(resModel,fields);const fakeRPC=async(_,params)=>{const{args,kwargs,method,model}=params;const{groupby:groupBy}=kwargs;return sampleServer.mockRpc({method,model,args,...kwargs,groupBy});};const sampleORM=new ORM(fakeRPC,user);sampleORM.isSample=true;sampleORM.setGroups=(groups)=>sampleServer.setExistingGroups(groups);return sampleORM;}
return __exports;});;

/* /web/static/src/views/calendar/calendar_arch_parser.js */
odoo.define('@web/views/calendar/calendar_arch_parser',['@web/core/browser/browser','@web/core/py_js/py','@web/core/utils/xml','@web/views/fields/field','@web/views/utils'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{evaluateExpr}=require("@web/core/py_js/py");const{visitXML}=require("@web/core/utils/xml");const{Field}=require("@web/views/fields/field");const{archParseBoolean}=require("@web/views/utils");const FIELD_ATTRIBUTE_NAMES=["date_start","date_delay","date_stop","all_day","recurrence_update","create_name_field","color",];const SCALES=["day","week","month","year"];const CalendarParseArchError=__exports.CalendarParseArchError=class CalendarParseArchError extends Error{}
const CalendarArchParser=__exports.CalendarArchParser=class CalendarArchParser{parse(arch,models,modelName){const fields=models[modelName];const fieldNames=new Set(fields.display_name?["display_name"]:[]);const fieldMapping={date_start:"date_start"};let jsClass=null;let eventLimit=5;let scales=[...SCALES];const sessionScale=browser.sessionStorage.getItem("calendar-scale");let scale=sessionScale||"week";let canCreate=true;let canDelete=true;let quickCreate=true;let quickCreateViewId=null;let hasEditDialog=false;let showUnusualDays=false;let isDateHidden=false;let isTimeHidden=false;let formViewId=false;const popoverFieldNodes={};const filtersInfo={};visitXML(arch,(node)=>{switch(node.tagName){case"calendar":{if(!node.hasAttribute("date_start")){throw new CalendarParseArchError(`Calendar view has not defined "date_start" attribute.`);}
jsClass=node.getAttribute("js_class");for(const fieldAttrName of FIELD_ATTRIBUTE_NAMES){if(node.hasAttribute(fieldAttrName)){const fieldName=node.getAttribute(fieldAttrName);fieldNames.add(fieldName);fieldMapping[fieldAttrName]=fieldName;}}
if(node.hasAttribute("event_limit")){eventLimit=evaluateExpr(node.getAttribute("event_limit"));if(!Number.isInteger(eventLimit)){throw new CalendarParseArchError(`Calendar view's event limit should be a number`);}}
if(node.hasAttribute("scales")){const scalesAttr=node.getAttribute("scales");scales=scalesAttr.split(",").filter((scale)=>SCALES.includes(scale));}
if(node.hasAttribute("mode")){scale=node.getAttribute("mode");if(!scales.includes(scale)){throw new CalendarParseArchError(`Calendar view cannot display mode: ${scale}`);}}
if(node.hasAttribute("create")){canCreate=archParseBoolean(node.getAttribute("create"),true);}
if(node.hasAttribute("delete")){canDelete=archParseBoolean(node.getAttribute("delete"),true);}
if(node.hasAttribute("quick_create")){quickCreate=archParseBoolean(node.getAttribute("quick_create"),true);if(quickCreate&&node.hasAttribute("quick_create_view_id")){quickCreateViewId=parseInt(node.getAttribute("quick_create_view_id"),10);}}
if(node.hasAttribute("event_open_popup")){hasEditDialog=archParseBoolean(node.getAttribute("event_open_popup"));}
if(node.hasAttribute("show_unusual_days")){showUnusualDays=archParseBoolean(node.getAttribute("show_unusual_days"));}
if(node.hasAttribute("hide_date")){isDateHidden=archParseBoolean(node.getAttribute("hide_date"));}
if(node.hasAttribute("hide_time")){isTimeHidden=archParseBoolean(node.getAttribute("hide_time"));}
if(node.hasAttribute("form_view_id")){formViewId=parseInt(node.getAttribute("form_view_id"),10);}
break;}
case"field":{const fieldName=node.getAttribute("name");fieldNames.add(fieldName);const fieldInfo=Field.parseFieldNode(node,models,modelName,"calendar",jsClass);popoverFieldNodes[fieldName]=fieldInfo;const field=fields[fieldName];if(!node.hasAttribute("invisible")||node.hasAttribute("filters")){let filterInfo=null;if(node.hasAttribute("avatar_field")||node.hasAttribute("write_model")||node.hasAttribute("write_field")||node.hasAttribute("color")||node.hasAttribute("filters")){filtersInfo[fieldName]=filtersInfo[fieldName]||{avatarFieldName:null,colorFieldName:null,fieldName,filterFieldName:null,label:field.string,resModel:field.relation,writeFieldName:null,writeResModel:null,};filterInfo=filtersInfo[fieldName];}
if(node.hasAttribute("filter_field")){filterInfo.filterFieldName=node.getAttribute("filter_field");}
if(node.hasAttribute("avatar_field")){filterInfo.avatarFieldName=node.getAttribute("avatar_field");}
if(node.hasAttribute("write_model")){filterInfo.writeResModel=node.getAttribute("write_model");}
if(node.hasAttribute("write_field")){filterInfo.writeFieldName=node.getAttribute("write_field");}
if(node.hasAttribute("filters")){if(node.hasAttribute("color")){filterInfo.colorFieldName=node.getAttribute("color");}
if(node.hasAttribute("avatar_field")&&field.relation){if(field.relation.includes(["res.users","res.partners","hr.employee",])){filterInfo.avatarFieldName="image_128";}}}}
break;}}});return{canCreate,canDelete,eventLimit,fieldMapping,fieldNames:[...fieldNames],filtersInfo,formViewId,hasEditDialog,quickCreate,quickCreateViewId,isDateHidden,isTimeHidden,popoverFieldNodes,scale,scales,showUnusualDays,};}}
return __exports;});;

/* /web/static/src/views/calendar/calendar_common/calendar_common_popover.js */
odoo.define('@web/views/calendar/calendar_common/calendar_common_popover',['@web/core/l10n/translation','@web/core/dialog/dialog','@web/core/py_js/py','@web/core/l10n/dates','@web/core/registry','@web/views/fields/field','@web/model/record','@web/views/calendar/utils','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{Dialog}=require("@web/core/dialog/dialog");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{is24HourFormat}=require("@web/core/l10n/dates");const{registry}=require("@web/core/registry");const{Field}=require("@web/views/fields/field");const{Record}=require("@web/model/record");const{getFormattedDateSpan}=require("@web/views/calendar/utils");const{Component,useExternalListener}=require("@odoo/owl");const CalendarCommonPopover=__exports.CalendarCommonPopover=class CalendarCommonPopover extends Component{setup(){this.time=null;this.timeDuration=null;this.date=null;this.dateDuration=null;useExternalListener(window,"pointerdown",(e)=>e.preventDefault(),{capture:true});this.computeDateTimeAndDuration();}
get activeFields(){return this.props.model.activeFields;}
get isEventEditable(){return true;}
get isEventDeletable(){return this.props.model.canDelete;}
get hasFooter(){return this.isEventEditable||this.isEventDeletable;}
isInvisible(fieldNode,record){return evaluateBooleanExpr(fieldNode.invisible,record.evalContextWithVirtualIds);}
getFormattedValue(fieldName,record){const fieldInfo=this.props.model.popoverFieldNodes[fieldName];const field=this.props.model.fields[fieldName];let format;const formattersRegistry=registry.category("formatters");if(fieldInfo.widget&&formattersRegistry.contains(fieldInfo.widget)){format=formattersRegistry.get(fieldInfo.widget);}else{format=formattersRegistry.get(field.type);}
return format(record.data[fieldName]);}
computeDateTimeAndDuration(){const record=this.props.record;const{start,end}=record;const isSameDay=start.hasSame(end,"day");if(!record.isTimeHidden&&!record.isAllDay&&isSameDay){const timeFormat=is24HourFormat()?"HH:mm":"hh:mm a";this.time=`${start.toFormat(timeFormat)} - ${end.toFormat(timeFormat)}`;const duration=end.diff(start,["hours","minutes"]);const formatParts=[];if(duration.hours>0){const hourString=duration.hours===1?_t("hour"):_t("hours");formatParts.push(`h '${hourString}'`);}
if(duration.minutes>0){const minuteStr=duration.minutes===1?_t("minute"):_t("minutes");formatParts.push(`m '${minuteStr}'`);}
this.timeDuration=duration.toFormat(formatParts.join(", "));}
if(!this.props.model.isDateHidden){this.date=getFormattedDateSpan(start,end);if(record.isAllDay){if(isSameDay){this.dateDuration=_t("All day");}else{const duration=end.plus({day:1}).diff(start,"days");this.dateDuration=duration.toFormat(`d '${_t("days")}'`);}}}}
onEditEvent(){this.props.editRecord(this.props.record);this.props.close();}
onDeleteEvent(){this.props.deleteRecord(this.props.record);this.props.close();}}
CalendarCommonPopover.components={Dialog,Field,Record,};CalendarCommonPopover.template="web.CalendarCommonPopover";CalendarCommonPopover.subTemplates={popover:"web.CalendarCommonPopover.popover",body:"web.CalendarCommonPopover.body",footer:"web.CalendarCommonPopover.footer",};CalendarCommonPopover.props={close:Function,record:Object,model:Object,createRecord:Function,deleteRecord:Function,editRecord:Function,};return __exports;});;

/* /web/static/src/views/calendar/calendar_common/calendar_common_renderer.js */
odoo.define('@web/views/calendar/calendar_common/calendar_common_renderer',['@web/core/l10n/translation','@web/core/l10n/dates','@web/core/l10n/localization','@web/core/utils/render','@web/core/utils/timing','@web/views/calendar/colors','@web/views/calendar/hooks','@web/views/calendar/calendar_common/calendar_common_popover','@web/core/browser/browser','@web/views/calendar/utils','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{is24HourFormat}=require("@web/core/l10n/dates");const{localization}=require("@web/core/l10n/localization");const{renderToString}=require("@web/core/utils/render");const{useDebounced}=require("@web/core/utils/timing");const{getColor}=require("@web/views/calendar/colors");const{useCalendarPopover,useClickHandler,useFullCalendar}=require("@web/views/calendar/hooks");const{CalendarCommonPopover}=require("@web/views/calendar/calendar_common/calendar_common_popover");const{browser}=require("@web/core/browser/browser");const{getWeekNumber}=require("@web/views/calendar/utils");const{Component,onMounted,useEffect}=require("@odoo/owl");const SCALE_TO_FC_VIEW={day:"timeGridDay",week:"timeGridWeek",month:"dayGridMonth",};const SCALE_TO_HEADER_FORMAT={day:"DDD",week:"EEE d",month:"EEEE",};const SHORT_SCALE_TO_HEADER_FORMAT={...SCALE_TO_HEADER_FORMAT,day:"D",month:"EEE",};const HOUR_FORMATS={12:{hour:"numeric",minute:"2-digit",omitZeroMinute:true,meridiem:"short",},24:{hour:"numeric",minute:"2-digit",hour12:false,},};const{DateTime}=luxon;const CalendarCommonRenderer=__exports.CalendarCommonRenderer=class CalendarCommonRenderer extends Component{setup(){this.fc=useFullCalendar("fullCalendar",this.options);this.click=useClickHandler(this.onClick,this.onDblClick);this.popover=useCalendarPopover(this.constructor.components.Popover);this.onWindowResizeDebounced=useDebounced(this.onWindowResize,200);onMounted(()=>{if(this.props.model.scale==="day"||this.props.model.scale==="week"){browser.setTimeout(()=>{if(this.fc.api.view){this.fc.api.scrollToTime("06:00:00");}},0);}});useEffect(()=>{this.updateSize();});}
get options(){return{allDaySlot:true,allDayText:_t(""),columnHeaderFormat:this.env.isSmall?SHORT_SCALE_TO_HEADER_FORMAT[this.props.model.scale]:SCALE_TO_HEADER_FORMAT[this.props.model.scale],dateClick:this.onDateClick,dayRender:this.onDayRender,defaultDate:this.props.model.date.toISO(),defaultView:SCALE_TO_FC_VIEW[this.props.model.scale],dir:localization.direction,droppable:true,editable:this.props.model.canEdit,eventClick:this.onEventClick,eventDragStart:this.onEventDragStart,eventDrop:this.onEventDrop,eventLimit:this.props.model.eventLimit,eventLimitClick:this.onEventLimitClick,eventLimitText:this.env.isSmall?"":"more",eventMouseEnter:this.onEventMouseEnter,eventMouseLeave:this.onEventMouseLeave,eventRender:this.onEventRender,eventResizableFromStart:true,eventResize:this.onEventResize,eventResizeStart:this.onEventResizeStart,events:(_,successCb)=>successCb(this.mapRecordsToEvents()),firstDay:this.props.model.firstDayOfWeek,header:false,height:"parent",locale:luxon.Settings.defaultLocale,longPressDelay:500,navLinks:false,nowIndicator:true,plugins:["dayGrid","interaction","timeGrid","luxon"],select:this.onSelect,selectAllow:this.isSelectionAllowed,selectMinDistance:5,selectMirror:true,selectable:this.props.model.canCreate,slotLabelFormat:is24HourFormat()?HOUR_FORMATS[24]:HOUR_FORMATS[12],snapDuration:{minutes:15},timeZone:luxon.Settings.defaultZone.name,unselectAuto:false,weekLabel:this.props.model.scale==="month"&&this.env.isSmall?"":_t("Week"),weekends:this.props.isWeekendVisible,weekNumberCalculation:(date)=>getWeekNumber(date,this.props.model.firstDayOfWeek),weekNumbers:true,weekNumbersWithinDays:!this.env.isSmall,windowResize:this.onWindowResizeDebounced,columnHeaderHtml:this.getHeaderHtml,};}
getStartTime(record){const timeFormat=is24HourFormat()?"HH:mm":"hh:mm a";return record.start.toFormat(timeFormat);}
getEndTime(record){const timeFormat=is24HourFormat()?"HH:mm":"hh:mm a";return record.end.toFormat(timeFormat);}
computeEventSelector(event){return`[data-event-id="${event.id}"]`;}
highlightEvent(event,className){for(const el of this.fc.el.querySelectorAll(this.computeEventSelector(event))){el.classList.add(className);}}
unhighlightEvent(event,className){for(const el of this.fc.el.querySelectorAll(this.computeEventSelector(event))){el.classList.remove(className);}}
mapRecordsToEvents(){return Object.values(this.props.model.records).map((r)=>this.convertRecordToEvent(r));}
convertRecordToEvent(record){const allDay=record.isAllDay||record.end.diff(record.start,"hours").hours>=24;return{id:record.id,title:record.title,start:record.start.toISO(),end:(["week","month"].includes(this.props.model.scale)&&allDay)||record.isAllDay||(allDay&&record.end.toMillis()!==record.end.startOf("day").toMillis())?record.end.plus({days:1}).toISO():record.end.toISO(),allDay:allDay,};}
getPopoverProps(record){return{record,model:this.props.model,createRecord:this.props.createRecord,deleteRecord:this.props.deleteRecord,editRecord:this.props.editRecord,};}
openPopover(target,record){const color=getColor(record.colorIndex);this.popover.open(target,this.getPopoverProps(record),`o_cw_popover o_calendar_color_${typeof color === "number" ? color : 0}`);}
updateSize(){let headerHeight=0;if(!this.env.isSmall){headerHeight=document.querySelector(".o_calendar_header")?.getBoundingClientRect()?.height??0;}
const height=window.innerHeight-this.fc.el.getBoundingClientRect().top-headerHeight;this.fc.el.style.height=`${height}px`;this.fc.api.updateSize();}
onClick(info){this.openPopover(info.el,this.props.model.records[info.event.id]);this.highlightEvent(info.event,"o_cw_custom_highlight");}
onDateClick(info){if(info?.jsEvent?.defaultPrevented){return;}
this.props.createRecord(this.fcEventToRecord(info));}
onDayRender(info){const date=luxon.DateTime.fromJSDate(info.date).toISODate();if(this.props.model.unusualDays.includes(date)){info.el.classList.add("o_calendar_disabled");}}
onDblClick(info){this.props.editRecord(this.props.model.records[info.event.id]);}
onEventClick(info){this.click(info);}
onEventRender(info){const{el,event}=info;el.dataset.eventId=event.id;el.classList.add("o_event");const record=this.props.model.records[event.id];if(record){const injectedContentStr=renderToString(this.constructor.eventTemplate,{...record,startTime:this.getStartTime(record),endTime:this.getEndTime(record),});const domParser=new DOMParser();const{children}=domParser.parseFromString(injectedContentStr,"text/html").body;el.querySelector(".fc-content").replaceWith(...children);const color=getColor(record.colorIndex);if(typeof color==="string"){el.style.backgroundColor=color;}else if(typeof color==="number"){el.classList.add(`o_calendar_color_${color}`);}else{el.classList.add("o_calendar_color_0");}
if(record.isHatched){el.classList.add("o_event_hatched");}
if(record.isStriked){el.classList.add("o_event_striked");}
if(record.duration<=0.25){el.classList.add("o_event_oneliner");}
if(DateTime.now()>=record.end){el.classList.add("o_past_event");}
if(!record.isAllDay&&!record.isTimeHidden&&record.isMonth){el.classList.add("o_event_dot");}else if(record.isAllDay){el.classList.add("o_event_allday");}
if(!el.classList.contains("fc-bg")){const bg=document.createElement("div");bg.classList.add("fc-bg");el.appendChild(bg);}}}
async onSelect(info){info.jsEvent.preventDefault();this.popover.close();await this.props.createRecord(this.fcEventToRecord(info));this.fc.api.unselect();}
isSelectionAllowed(event){return event.end.getDate()===event.start.getDate()||event.allDay;}
onEventDrop(info){this.fc.api.unselect();this.props.model.updateRecord(this.fcEventToRecord(info.event),{moved:true});}
onEventResize(info){this.fc.api.unselect();this.props.model.updateRecord(this.fcEventToRecord(info.event));}
fcEventToRecord(event){const{id,allDay,date,start,end}=event;const res={start:luxon.DateTime.fromJSDate(date||start),isAllDay:allDay,};if(end){res.end=luxon.DateTime.fromJSDate(end);if(["week","month"].includes(this.props.model.scale)&&allDay){res.end=res.end.minus({days:1});}}
if(id){res.id=this.props.model.records[id].id;}
return res;}
onEventMouseEnter(info){this.highlightEvent(info.event,"o_cw_custom_highlight");}
onEventMouseLeave(info){if(!info.event.id){return;}
this.unhighlightEvent(info.event,"o_cw_custom_highlight");}
onEventDragStart(info){info.el.classList.add(info.view.type);this.fc.api.unselect();this.highlightEvent(info.event,"o_cw_custom_highlight");}
onEventResizeStart(info){this.fc.api.unselect();this.highlightEvent(info.event,"o_cw_custom_highlight");}
onEventLimitClick(){this.fc.api.unselect();return"popover";}
onWindowResize(){this.updateSize();}
getHeaderHtml(date){const scale=this.props.model.scale;const{weekdayShort:weekdayShort,weekdayLong:weekdayLong,day,}=DateTime.fromJSDate(date);return renderToString(this.constructor.headerTemplate,{weekdayShort,weekdayLong,day,scale,});}}
CalendarCommonRenderer.components={Popover:CalendarCommonPopover,};CalendarCommonRenderer.template="web.CalendarCommonRenderer";CalendarCommonRenderer.eventTemplate="web.CalendarCommonRenderer.event";CalendarCommonRenderer.headerTemplate="web.CalendarCommonRendererHeader";return __exports;});;

/* /web/static/src/views/calendar/calendar_controller.js */
odoo.define('@web/views/calendar/calendar_controller',['@web/core/confirmation_dialog/confirmation_dialog','@web/core/l10n/translation','@web/core/utils/hooks','@web/search/layout','@web/model/model','@web/views/view_dialogs/form_view_dialog','@web/views/view_hook','@web/core/datetime/datetime_picker','@web/views/calendar/filter_panel/calendar_filter_panel','@web/views/calendar/mobile_filter_panel/calendar_mobile_filter_panel','@web/views/calendar/quick_create/calendar_quick_create','@web/search/search_bar/search_bar','@web/search/search_bar/search_bar_toggler','@web/views/view_components/view_scale_selector','@web/search/cog_menu/cog_menu','@web/core/browser/browser','@web/views/calendar/utils','@odoo/owl'],function(require){'use strict';let __exports={};const{deleteConfirmationMessage,ConfirmationDialog,}=require("@web/core/confirmation_dialog/confirmation_dialog");const{_t}=require("@web/core/l10n/translation");const{useOwnedDialogs,useService}=require("@web/core/utils/hooks");const{Layout}=require("@web/search/layout");const{useModelWithSampleData}=require("@web/model/model");const{FormViewDialog}=require("@web/views/view_dialogs/form_view_dialog");const{useSetupView}=require("@web/views/view_hook");const{DateTimePicker}=require("@web/core/datetime/datetime_picker");const{CalendarFilterPanel}=require("@web/views/calendar/filter_panel/calendar_filter_panel");const{CalendarMobileFilterPanel}=require("@web/views/calendar/mobile_filter_panel/calendar_mobile_filter_panel");const{CalendarQuickCreate}=require("@web/views/calendar/quick_create/calendar_quick_create");const{SearchBar}=require("@web/search/search_bar/search_bar");const{useSearchBarToggler}=require("@web/search/search_bar/search_bar_toggler");const{ViewScaleSelector}=require("@web/views/view_components/view_scale_selector");const{CogMenu}=require("@web/search/cog_menu/cog_menu");const{browser}=require("@web/core/browser/browser");const{getWeekNumber}=require("@web/views/calendar/utils");const{Component,useState}=require("@odoo/owl");const{DateTime}=luxon;const SCALE_LABELS=__exports.SCALE_LABELS={day:_t("Day"),week:_t("Week"),month:_t("Month"),year:_t("Year"),};function useUniqueDialog(){const displayDialog=useOwnedDialogs();let close=null;return(...args)=>{if(close){close();}
close=displayDialog(...args);};}
const CalendarController=__exports.CalendarController=class CalendarController extends Component{setup(){this.action=useService("action");this.orm=useService("orm");this.displayDialog=useUniqueDialog();this.model=useModelWithSampleData(this.props.Model,{...this.props.archInfo,resModel:this.props.resModel,domain:this.props.domain,fields:this.props.fields,allFilter:this.props.state?.allFilter??{},date:this.props.state?.date,},{onWillStart:this.onWillStartModel.bind(this),});useSetupView({getLocalState:()=>this.model.exportedState,});const sessionShowSidebar=browser.sessionStorage.getItem("calendar.showSideBar");this.state=useState({isWeekendVisible:browser.localStorage.getItem("calendar.isWeekendVisible")!=null?JSON.parse(browser.localStorage.getItem("calendar.isWeekendVisible")):true,showSideBar:!this.env.isSmall&&Boolean(sessionShowSidebar!=null?JSON.parse(sessionShowSidebar):true),});this.searchBarToggler=useSearchBarToggler();}
get currentDate(){const meta=this.model.meta;const scale=meta.scale;if(this.env.isSmall&&["week","month"].includes(scale)){const date=meta.date||DateTime.now();let text="";if(scale==="week"){const startMonth=date.startOf("week");const endMonth=date.endOf("week");if(startMonth.toFormat("LLL")!==endMonth.toFormat("LLL")){text=`${startMonth.toFormat("LLL")}-${endMonth.toFormat("LLL")}`;}else{text=startMonth.toFormat("LLLL");}}else if(scale==="month"){text=date.toFormat("LLLL");}
return` - ${text} ${date.year}`;}else{return"";}}
get date(){return this.model.meta.date||DateTime.now();}
get today(){return DateTime.now().toFormat("d");}
get currentYear(){return this.date.toFormat("y");}
get dayHeader(){return`${this.date.toFormat("d")} ${this.date.toFormat("MMMM")} ${this.date.year}`;}
get weekHeader(){const{rangeStart,rangeEnd}=this.model;if(rangeStart.year!=rangeEnd.year){return`${rangeStart.toFormat("MMMM")} ${rangeStart.year} - ${rangeEnd.toFormat(
                "MMMM"
            )} ${rangeEnd.year}`;}else if(rangeStart.month!=rangeEnd.month){return`${rangeStart.toFormat("MMMM")} - ${rangeEnd.toFormat("MMMM")} ${
                rangeStart.year
            }`;}
return`${rangeStart.toFormat("MMMM")} ${rangeStart.year}`;}
get currentMonth(){return`${this.date.toFormat("MMMM")} ${this.date.year}`;}
get currentWeek(){return getWeekNumber(this.model.rangeStart);}
get rendererProps(){return{model:this.model,isWeekendVisible:this.model.scale==="day"||this.state.isWeekendVisible,createRecord:this.createRecord.bind(this),deleteRecord:this.deleteRecord.bind(this),editRecord:this.editRecord.bind(this),setDate:this.setDate.bind(this),};}
get containerProps(){return{model:this.model,};}
get datePickerProps(){return{type:"date",showWeekNumbers:false,maxPrecision:"days",daysOfWeekFormat:"narrow",onSelect:(date)=>{let scale="week";if(this.model.date.hasSame(date,"day")){const scales=["month","week","day"];scale=scales[(scales.indexOf(this.model.scale)+1)%scales.length];}else{const currentDate=this.model.date.weekday===7?this.model.date.plus({day:1}):this.model.date;const pickedDate=date.weekday===7?date.plus({day:1}):date;if(currentDate.hasSame(pickedDate,"week")){scale="day";}}
this.model.load({scale,date});},value:this.model.date,};}
get filterPanelProps(){return{model:this.model,};}
get mobileFilterPanelProps(){return{model:this.model,sideBarShown:this.state.showSideBar,toggleSideBar:()=>{this.state.showSideBar=!this.state.showSideBar;},};}
toggleSideBar(){this.state.showSideBar=!this.state.showSideBar;browser.sessionStorage.setItem("calendar.showSideBar",this.state.showSideBar);}
get showCalendar(){return!this.env.isSmall||!this.state.showSideBar;}
get showSideBar(){return this.state.showSideBar;}
get className(){return this.props.className;}
get editRecordDefaultDisplayText(){return _t("New Event");}
getQuickCreateProps(record){return{record,model:this.model,editRecord:this.editRecordInCreation.bind(this),title:this.props.context.default_name,};}
getQuickCreateFormViewProps(record){const rawRecord=this.model.buildRawRecord(record);const context=this.model.makeContextDefaults(rawRecord);return{resModel:this.model.resModel,viewId:this.model.quickCreateFormViewId,title:_t("New Event"),context,};}
createRecord(record){if(!this.model.canCreate){return;}
if(this.model.hasQuickCreate){if(this.model.quickCreateFormViewId){return new Promise((resolve)=>{this.displayDialog(this.constructor.components.QuickCreateFormView,this.getQuickCreateFormViewProps(record),{onClose:()=>resolve(),});});}
return new Promise((resolve)=>{this.displayDialog(this.constructor.components.QuickCreate,this.getQuickCreateProps(record),{onClose:()=>resolve(),});});}else{return this.editRecordInCreation(record);}}
async editRecord(record,context={},shouldFetchFormViewId=true){if(this.model.hasEditDialog){return new Promise((resolve)=>{this.displayDialog(FormViewDialog,{resModel:this.model.resModel,resId:record.id||false,context,title:record.id?_t("Open: %s",record.title):this.editRecordDefaultDisplayText,viewId:this.model.formViewId,onRecordSaved:()=>this.model.load(),},{onClose:()=>resolve()});});}else{let formViewId=this.model.formViewId;if(shouldFetchFormViewId){formViewId=await this.orm.call(this.model.resModel,"get_formview_id",[[record.id]],context);}
const action={type:"ir.actions.act_window",res_model:this.model.resModel,views:[[formViewId||false,"form"]],target:"current",context,};if(record.id){action.res_id=record.id;}
this.action.doAction(action);}}
editRecordInCreation(record){const rawRecord=this.model.buildRawRecord(record);const context=this.model.makeContextDefaults(rawRecord);return this.editRecord(record,context,false);}
deleteRecord(record){this.displayDialog(ConfirmationDialog,{title:_t("Bye-bye, record!"),body:deleteConfirmationMessage,confirm:()=>{this.model.unlinkRecord(record.id);},confirmLabel:_t("Delete"),cancel:()=>{},cancelLabel:_t("No, keep it"),});}
onWillStartModel(){}
async setDate(move){let date=null;switch(move){case"next":date=this.model.date.plus({[`${this.model.scale}s`]:1});break;case"previous":date=this.model.date.minus({[`${this.model.scale}s`]:1});break;case"today":date=luxon.DateTime.local().startOf("day");break;}
await this.model.load({date});}
get scales(){return Object.fromEntries(this.model.scales.map((s)=>[s,{description:SCALE_LABELS[s]}]));}
async setScale(scale){await this.model.load({scale});browser.sessionStorage.setItem("calendar-scale",this.model.scale);}
toggleWeekendVisibility(){this.state.isWeekendVisible=!this.state.isWeekendVisible;browser.localStorage.setItem("calendar.isWeekendVisible",this.state.isWeekendVisible);}}
CalendarController.components={DatePicker:DateTimePicker,FilterPanel:CalendarFilterPanel,MobileFilterPanel:CalendarMobileFilterPanel,QuickCreate:CalendarQuickCreate,QuickCreateFormView:FormViewDialog,Layout,SearchBar,ViewScaleSelector,CogMenu,};CalendarController.template="web.CalendarController";return __exports;});;

/* /web/static/src/views/calendar/calendar_model.js */
odoo.define('@web/views/calendar/calendar_model',['@web/core/l10n/dates','@web/core/l10n/localization','@web/core/l10n/translation','@web/core/registry','@web/core/utils/concurrency','@web/model/model','@web/model/relational_model/utils'],function(require){'use strict';let __exports={};const{serializeDate,serializeDateTime,deserializeDate,deserializeDateTime,}=require("@web/core/l10n/dates");const{localization}=require("@web/core/l10n/localization");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{KeepLast}=require("@web/core/utils/concurrency");const{Model}=require("@web/model/model");const{extractFieldsFromArchInfo}=require("@web/model/relational_model/utils");const CalendarModel=__exports.CalendarModel=class CalendarModel extends Model{setup(params,services){this.user=services.user;this.keepLast=new KeepLast();const formViewFromConfig=(this.env.config.views||[]).find((view)=>view[1]==="form");const formViewIdFromConfig=formViewFromConfig?formViewFromConfig[0]:false;const fieldNodes=params.popoverFieldNodes;const{activeFields,fields}=extractFieldsFromArchInfo({fieldNodes},params.fields);this.meta={...params,activeFields,fields,firstDayOfWeek:(localization.weekStart||0)%7,formViewId:params.formViewId||formViewIdFromConfig,};this.data={filters:{},filterSections:{},hasCreateRight:null,range:null,records:{},unusualDays:[],};}
async load(params={}){Object.assign(this.meta,params);if(!this.meta.date){this.meta.date=params.context&&params.context.initial_date?deserializeDateTime(params.context.initial_date):luxon.DateTime.local();}
if(!this.meta.scales.includes(this.meta.scale)){this.meta.scale=this.meta.scales[0];}
const data={...this.data};await this.keepLast.add(this.updateData(data));this.data=data;this.notify();}
get date(){return this.meta.date;}
get canCreate(){return this.meta.canCreate&&this.data.hasCreateRight;}
get canDelete(){return this.meta.canDelete;}
get canEdit(){return!this.meta.fields[this.meta.fieldMapping.date_start].readonly;}
get eventLimit(){return this.meta.eventLimit;}
get exportedState(){return this.meta;}
get fieldMapping(){return this.meta.fieldMapping;}
get fields(){return this.meta.fields;}
get filterSections(){return Object.values(this.data.filterSections);}
get firstDayOfWeek(){return this.meta.firstDayOfWeek;}
get formViewId(){return this.meta.formViewId;}
get hasAllDaySlot(){return(this.meta.fieldMapping.all_day||this.meta.fields[this.meta.fieldMapping.date_start].type==="date");}
get hasEditDialog(){return this.meta.hasEditDialog;}
get hasQuickCreate(){return this.meta.quickCreate;}
get isDateHidden(){return this.meta.isDateHidden;}
get isTimeHidden(){return this.meta.isTimeHidden;}
get popoverFieldNodes(){return this.meta.popoverFieldNodes;}
get activeFields(){return this.meta.activeFields;}
get rangeEnd(){return this.data.range.end;}
get rangeStart(){return this.data.range.start;}
get records(){return this.data.records;}
get resModel(){return this.meta.resModel;}
get scale(){return this.meta.scale;}
get scales(){return this.meta.scales;}
get unusualDays(){return this.data.unusualDays;}
get quickCreateFormViewId(){return this.meta.quickCreateViewId;}
get defaultFilterLabel(){return _t("Undefined");}
async createFilter(fieldName,filterValue){const info=this.meta.filtersInfo[fieldName];if(info&&info.writeFieldName&&info.writeResModel){const data={user_id:this.user.userId,[info.writeFieldName]:filterValue,};if(info.filterFieldName){data[info.filterFieldName]=true;}
await this.orm.create(info.writeResModel,[data]);await this.load();}}
async createRecord(record){const rawRecord=this.buildRawRecord(record);const context=this.makeContextDefaults(rawRecord);await this.orm.create(this.meta.resModel,[rawRecord],{context});await this.load();}
async unlinkFilter(fieldName,recordId){const info=this.meta.filtersInfo[fieldName];if(info&&info.writeResModel){await this.orm.unlink(info.writeResModel,[recordId]);await this.load();}}
async unlinkRecord(recordId){await this.orm.unlink(this.meta.resModel,[recordId]);await this.load();}
async updateFilters(fieldName,filters){const section=this.data.filterSections[fieldName];if(section){for(const value in filters){const active=filters[value];const filter=section.filters.find((filter)=>`${filter.value}`===value);if(filter){filter.active=active;const info=this.meta.filtersInfo[fieldName];if(filter.recordId&&info&&info.writeFieldName&&info.writeResModel&&info.filterFieldName){const data={[info.filterFieldName]:active,};await this.orm.write(info.writeResModel,[filter.recordId],data);}else if(filter.type==="all"){this.meta.allFilter[section.label]=active;}}}}
await this.load();}
async updateRecord(record,options={}){const rawRecord=this.buildRawRecord(record,options);delete rawRecord.name;await this.orm.write(this.meta.resModel,[record.id],rawRecord,{context:{from_ui:true},});await this.load();}
buildRawRecord(partialRecord,options={}){const data={};data[this.meta.fieldMapping.create_name_field||"name"]=partialRecord.title;let start=partialRecord.start;let end=partialRecord.end;if(!end||!end.isValid){if(partialRecord.isAllDay){end=start;}else{end=start.plus({hours:1});}}
const isDateEvent=this.fields[this.meta.fieldMapping.date_start].type==="date";if(partialRecord.isAllDay){if(!this.hasAllDaySlot&&!isDateEvent&&!partialRecord.id){start=start.set({hours:7});end=end.set({hours:19});}}
if(this.meta.fieldMapping.all_day){data[this.meta.fieldMapping.all_day]=partialRecord.isAllDay;}
data[this.meta.fieldMapping.date_start]=(partialRecord.isAllDay&&this.hasAllDaySlot?"date":this.fields[this.meta.fieldMapping.date_start].type)==="date"?serializeDate(start):serializeDateTime(start);if(this.meta.fieldMapping.date_stop){data[this.meta.fieldMapping.date_stop]=(partialRecord.isAllDay&&this.hasAllDaySlot?"date":this.fields[this.meta.fieldMapping.date_start].type)==="date"?serializeDate(end):serializeDateTime(end);}
if(this.meta.fieldMapping.date_delay){if(this.meta.scale!=="month"||!options.moved){data[this.meta.fieldMapping.date_delay]=end.diff(start,"hours").hours;}}
return data;}
makeContextDefaults(rawRecord){const{fieldMapping,scale}=this.meta;const context={...this.meta.context};const fieldNames=[fieldMapping.create_name_field||"name",fieldMapping.date_start,fieldMapping.date_stop,fieldMapping.date_delay,fieldMapping.all_day||"allday",];for(const fieldName of fieldNames){if(rawRecord[fieldName]!==undefined){context[`default_${fieldName}`]=rawRecord[fieldName];}}
if(["month","year"].includes(scale)){context[`default_${fieldMapping.all_day || "allday"}`]=true;}
return context;}
async updateData(data){if(data.hasCreateRight===null){data.hasCreateRight=await this.orm.call(this.meta.resModel,"check_access_rights",["create",false,]);}
data.range=this.computeRange();if(this.meta.showUnusualDays){data.unusualDays=await this.loadUnusualDays(data);}
const{sections,dynamicFiltersInfo}=await this.loadFilters(data);data.filterSections=sections;data.records=await this.loadRecords(data);const dynamicSections=await this.loadDynamicFilters(data,dynamicFiltersInfo);Object.assign(data.filterSections,dynamicSections);for(const[recordId,record]of Object.entries(data.records)){for(const[fieldName,filterInfo]of Object.entries(dynamicSections)){for(const filter of filterInfo.filters){const rawValue=record.rawRecord[fieldName];const value=Array.isArray(rawValue)?rawValue[0]:rawValue;if(filter.value===value&&!filter.active){delete data.records[recordId];}}}}}
computeRange(){const{scale,date,firstDayOfWeek}=this.meta;let start=date;let end=date;if(scale!=="week"){start=start.startOf(scale);end=end.endOf(scale);}
if(["week","month"].includes(scale)){const currentWeekOffset=(start.weekday-firstDayOfWeek+7)%7;start=start.minus({days:currentWeekOffset});end=start.plus({weeks:scale==="week"?1:6,days:-1});}
start=start.startOf("day");end=end.endOf("day");return{start,end};}
computeDomain(data){return[...this.meta.domain,...this.computeRangeDomain(data),...this.computeFiltersDomain(data),];}
computeFiltersDomain(data){const authorizedValues={};const avoidValues={};for(const[fieldName,filterSection]of Object.entries(data.filterSections)){const filterAll=filterSection.filters.find((f)=>f.type==="all");if(!(filterAll&&filterAll.active)){const filterSectionInfo=this.meta.filtersInfo[fieldName];for(const filter of filterSection.filters){if(filterSectionInfo.writeResModel){if(!authorizedValues[fieldName]){authorizedValues[fieldName]=[];}
if(filter.active){authorizedValues[fieldName].push(filter.value);}}else{if(!filter.active){if(!avoidValues[fieldName]){avoidValues[fieldName]=[];}
avoidValues[fieldName].push(filter.value);}}}}}
const domain=[];for(const field in authorizedValues){domain.push([field,"in",authorizedValues[field]]);}
for(const field in avoidValues){if(avoidValues[field].length>0){domain.push([field,"not in",avoidValues[field]]);}}
return domain;}
computeRangeDomain(data){const{fieldMapping}=this.meta;const formattedEnd=serializeDateTime(data.range.end);const formattedStart=serializeDateTime(data.range.start);const domain=[[fieldMapping.date_start,"<=",formattedEnd]];if(fieldMapping.date_stop){domain.push([fieldMapping.date_stop,">=",formattedStart]);}else if(!fieldMapping.date_delay){domain.push([fieldMapping.date_start,">=",formattedStart]);}
return domain;}
fetchUnusualDays(data){return this.orm.call(this.meta.resModel,"get_unusual_days",[serializeDateTime(data.range.start),serializeDateTime(data.range.end),]);}
async loadUnusualDays(data){const unusualDays=await this.fetchUnusualDays(data);return Object.entries(unusualDays).filter((entry)=>entry[1]).map((entry)=>entry[0]);}
fetchRecords(data){const{fieldNames,resModel}=this.meta;return this.orm.searchRead(resModel,this.computeDomain(data),fieldNames);}
async loadRecords(data){const rawRecords=await this.fetchRecords(data);const records={};for(const rawRecord of rawRecords){records[rawRecord.id]=this.normalizeRecord(rawRecord);}
return records;}
normalizeRecord(rawRecord){const{fields,fieldMapping,isTimeHidden}=this.meta;const startType=fields[fieldMapping.date_start].type;const isAllDay=startType==="date"||(fieldMapping.all_day&&rawRecord[fieldMapping.all_day])||false;let start=isAllDay?deserializeDate(rawRecord[fieldMapping.date_start]):deserializeDateTime(rawRecord[fieldMapping.date_start]);let end=start;let endType=startType;if(fieldMapping.date_stop){endType=fields[fieldMapping.date_stop].type;end=isAllDay?deserializeDate(rawRecord[fieldMapping.date_stop]):deserializeDateTime(rawRecord[fieldMapping.date_stop]);}
const duration=rawRecord[fieldMapping.date_delay]||1;if(isAllDay){start=start.startOf("day");end=end.startOf("day");}
if(!fieldMapping.date_stop&&duration){end=start.plus({hours:duration});}
const showTime=!(fieldMapping.all_day&&rawRecord[fieldMapping.all_day])&&startType!=="date"&&start.day===end.day;const colorValue=rawRecord[fieldMapping.color];const colorIndex=Array.isArray(colorValue)?colorValue[0]:colorValue;const title=rawRecord[fieldMapping.create_name_field||"display_name"];return{id:rawRecord.id,title,isAllDay,start,startType,end,endType,duration,colorIndex,isHatched:rawRecord["is_hatched"]||false,isStriked:rawRecord["is_striked"]||false,isTimeHidden:isTimeHidden||!showTime,isMonth:this.meta.scale==="month",isSmall:this.env.isSmall,rawRecord,};}
addFilterFields(record,filterInfo){return{colorIndex:record.colorIndex,};}
fetchFilters(resModel,fieldNames){return this.orm.searchRead(resModel,[["user_id","=",this.user.userId]],fieldNames);}
async loadFilters(data){const previousSections=data.filterSections;const sections={};const dynamicFiltersInfo={};for(const[fieldName,filterInfo]of Object.entries(this.meta.filtersInfo)){const previousSection=previousSections[fieldName];if(filterInfo.writeResModel){sections[fieldName]=await this.loadFilterSection(fieldName,filterInfo,previousSection);}else{dynamicFiltersInfo[fieldName]={filterInfo,previousSection};}}
return{sections,dynamicFiltersInfo};}
async loadFilterSection(fieldName,filterInfo,previousSection){const{filterFieldName,writeFieldName,writeResModel}=filterInfo;const fields=[writeFieldName,filterFieldName].filter(Boolean);const rawFilters=await this.fetchFilters(writeResModel,fields);const previousFilters=previousSection?previousSection.filters:[];const filters=rawFilters.map((rawFilter)=>{const previousRecordFilter=previousFilters.find((f)=>f.type==="record"&&f.recordId===rawFilter.id);return this.makeFilterRecord(filterInfo,previousRecordFilter,rawFilter);});const field=this.meta.fields[fieldName];const isUserOrPartner=["res.users","res.partner"].includes(field.relation);if(isUserOrPartner){const previousUserFilter=previousFilters.find((f)=>f.type==="user");filters.push(this.makeFilterUser(filterInfo,previousUserFilter,fieldName,rawFilters));}
const previousAllFilter=previousFilters.find((f)=>f.type==="all");filters.push(this.makeFilterAll(previousAllFilter,isUserOrPartner,filterInfo.label));return{label:filterInfo.label,fieldName,filters,avatar:{field:filterInfo.avatarFieldName,model:filterInfo.resModel,},hasAvatar:!!filterInfo.avatarFieldName,write:{field:writeFieldName,model:writeResModel,},canCollapse:filters.length>2,canAddFilter:!!filterInfo.writeResModel,};}
async loadDynamicFilters(data,filtersInfo){const sections={};for(const[fieldName,{filterInfo,previousSection}]of Object.entries(filtersInfo)){sections[fieldName]=await this.loadDynamicFilterSection(data,fieldName,filterInfo,previousSection);}
return sections;}
async loadDynamicFilterSection(data,fieldName,filterInfo,previousSection){const{fields,fieldMapping}=this.meta;const field=fields[fieldName];const previousFilters=previousSection?previousSection.filters:[];const rawFilters=Object.values(data.records).reduce((filters,record)=>{const rawValues=["many2many","one2many"].includes(field.type)?record.rawRecord[fieldName]:[record.rawRecord[fieldName]];for(const rawValue of rawValues){const value=Array.isArray(rawValue)?rawValue[0]:rawValue;if(!filters.find((f)=>f.id===value)){filters.push({id:value,[fieldName]:rawValue,...this.addFilterFields(record,filterInfo),});}}
return filters;},[]);const{colorFieldName}=filterInfo;const shouldFetchColor=colorFieldName&&`${fieldName}.${colorFieldName}`!==fields[fieldMapping.color].related;let rawColors=[];if(shouldFetchColor){const relatedIds=rawFilters.map(({id})=>id);if(relatedIds.length){rawColors=await this.orm.searchRead(field.relation,[["id","in",relatedIds]],[colorFieldName]);}}
const filters=rawFilters.map((rawFilter)=>{const previousDynamicFilter=previousFilters.find((f)=>f.type==="dynamic"&&f.value===rawFilter.id);return this.makeFilterDynamic(filterInfo,previousDynamicFilter,fieldName,rawFilter,rawColors);});return{label:filterInfo.label,fieldName,filters,avatar:{field:filterInfo.avatarFieldName,model:filterInfo.resModel,},hasAvatar:!!filterInfo.avatarFieldName,write:{field:filterInfo.writeFieldName,model:filterInfo.writeResModel,},canCollapse:filters.length>2,canAddFilter:!!filterInfo.writeResModel,};}
makeFilterDynamic(filterInfo,previousFilter,fieldName,rawFilter,rawColors){const{fieldMapping,fields}=this.meta;const rawValue=rawFilter[fieldName];const value=Array.isArray(rawValue)?rawValue[0]:rawValue;const field=fields[fieldName];const formatter=registry.category("formatters").get(field.type);const{colorFieldName}=filterInfo;const colorField=fields[fieldMapping.color];const hasFilterColorAttr=!!colorFieldName;const sameRelatedModel=colorField&&(colorField.relation===field.relation||(colorField.related&&colorField.related.startsWith(`${fieldName}.`)));let colorIndex=null;if(hasFilterColorAttr||sameRelatedModel){colorIndex=rawFilter.colorIndex;}
if(rawColors.length){const rawColor=rawColors.find(({id})=>id===value);colorIndex=rawColor?rawColor[colorFieldName]:0;}
return{type:"dynamic",recordId:null,value,label:formatter(rawValue,{field})||this.defaultFilterLabel,active:previousFilter?previousFilter.active:true,canRemove:false,colorIndex,hasAvatar:!!value,};}
makeFilterRecord(filterInfo,previousFilter,rawRecord){const{colorFieldName,filterFieldName,writeFieldName}=filterInfo;const{fields,fieldMapping}=this.meta;const raw=rawRecord[writeFieldName];const value=Array.isArray(raw)?raw[0]:raw;const field=fields[writeFieldName];const isX2Many=["many2many","one2many"].includes(field.type);const formatter=registry.category("formatters").get(isX2Many?"many2one":field.type);const colorField=fields[fieldMapping.color];const colorValue=colorField&&(()=>{const sameRelatedModel=colorField.relation===field.relation;const sameRelatedField=colorField.related===`${writeFieldName}.${colorFieldName}`;const shouldHaveColor=sameRelatedModel||sameRelatedField;const colorToUse=raw?value:rawRecord[fieldMapping.color];return shouldHaveColor?colorToUse:null;})();const colorIndex=Array.isArray(colorValue)?colorValue[0]:colorValue;let active=false;if(previousFilter){active=previousFilter.active;}else if(filterFieldName){active=rawRecord[filterFieldName];}
return{type:"record",recordId:rawRecord.id,value,label:formatter(raw),active,canRemove:true,colorIndex,hasAvatar:!!value,};}
makeFilterUser(filterInfo,previousFilter,fieldName,rawRecords){const field=this.meta.fields[fieldName];const userFieldName=field.relation==="res.partner"?"partnerId":"userId";const value=this.user[userFieldName];let colorIndex=value;const rawRecord=rawRecords.find((r)=>r[filterInfo.writeFieldName][0]===value);if(filterInfo.colorFieldName&&rawRecord){const colorValue=rawRecord[filterInfo.colorFieldName];colorIndex=Array.isArray(colorValue)?colorValue[0]:colorValue;}
return{type:"user",recordId:null,value,label:this.user.name,active:previousFilter?previousFilter.active:true,canRemove:false,colorIndex,hasAvatar:!!value,};}
makeFilterAll(previousAllFilter,isUserOrPartner,sectionLabel){return{type:"all",recordId:null,value:"all",label:isUserOrPartner?_t("Everybody's calendars"):_t("Everything"),active:previousAllFilter?previousAllFilter.active:this.meta.allFilter[sectionLabel]||false,canRemove:false,colorIndex:null,hasAvatar:false,};}}
CalendarModel.services=["user","rpc"];return __exports;});;

/* /web/static/src/views/calendar/calendar_renderer.js */
odoo.define('@web/views/calendar/calendar_renderer',['@web/core/action_swiper/action_swiper','@web/views/calendar/calendar_common/calendar_common_renderer','@web/views/calendar/calendar_year/calendar_year_renderer','@odoo/owl'],function(require){'use strict';let __exports={};const{ActionSwiper}=require("@web/core/action_swiper/action_swiper");const{CalendarCommonRenderer}=require("@web/views/calendar/calendar_common/calendar_common_renderer");const{CalendarYearRenderer}=require("@web/views/calendar/calendar_year/calendar_year_renderer");const{Component}=require("@odoo/owl");const CalendarRenderer=__exports.CalendarRenderer=class CalendarRenderer extends Component{get calendarComponent(){return this.constructor.components[this.props.model.scale];}
get calendarKey(){return`${this.props.model.scale}_${this.props.model.date.valueOf()}`;}
get actionSwiperProps(){return{onLeftSwipe:this.env.isSmall?{action:()=>this.props.setDate("next")}:undefined,onRightSwipe:this.env.isSmall?{action:()=>this.props.setDate("previous")}:undefined,animationOnMove:false,animationType:"forwards",swipeDistanceRatio:6,swipeInvalid:()=>Boolean(document.querySelector(".o_event.fc-mirror")),};}}
CalendarRenderer.components={day:CalendarCommonRenderer,week:CalendarCommonRenderer,month:CalendarCommonRenderer,year:CalendarYearRenderer,ActionSwiper,};CalendarRenderer.template="web.CalendarRenderer";return __exports;});;

/* /web/static/src/views/calendar/calendar_view.js */
odoo.define('@web/views/calendar/calendar_view',['@web/core/registry','@web/views/calendar/calendar_renderer','@web/views/calendar/calendar_arch_parser','@web/views/calendar/calendar_model','@web/views/calendar/calendar_controller'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{CalendarRenderer}=require("@web/views/calendar/calendar_renderer");const{CalendarArchParser}=require("@web/views/calendar/calendar_arch_parser");const{CalendarModel}=require("@web/views/calendar/calendar_model");const{CalendarController}=require("@web/views/calendar/calendar_controller");const calendarView=__exports.calendarView={type:"calendar",display_name:"Calendar",icon:"fa fa-calendar",multiRecord:true,searchMenuTypes:["filter","favorite"],ArchParser:CalendarArchParser,Controller:CalendarController,Model:CalendarModel,Renderer:CalendarRenderer,buttonTemplate:"web.CalendarController.controlButtons",props:(props,view)=>{const{ArchParser}=view;const{arch,relatedModels,resModel}=props;const archInfo=new ArchParser().parse(arch,relatedModels,resModel);return{...props,Model:view.Model,Renderer:view.Renderer,buttonTemplate:view.buttonTemplate,archInfo,};},};registry.category("views").add("calendar",calendarView);return __exports;});;

/* /web/static/src/views/calendar/calendar_year/calendar_year_popover.js */
odoo.define('@web/views/calendar/calendar_year/calendar_year_popover',['@web/core/dialog/dialog','@web/core/l10n/dates','@web/views/calendar/colors','@web/views/calendar/utils','@odoo/owl'],function(require){'use strict';let __exports={};const{Dialog}=require("@web/core/dialog/dialog");const{formatDate}=require("@web/core/l10n/dates");const{getColor}=require("@web/views/calendar/colors");const{getFormattedDateSpan}=require('@web/views/calendar/utils');const{Component}=require("@odoo/owl");const CalendarYearPopover=__exports.CalendarYearPopover=class CalendarYearPopover extends Component{get recordGroups(){return this.computeRecordGroups();}
get dialogTitle(){return formatDate(this.props.date,{format:"DDD"});}
computeRecordGroups(){const recordGroups=this.groupRecords();return this.getSortedRecordGroups(recordGroups);}
groupRecords(){const recordGroups={};for(const record of this.props.records){const start=record.start;const end=record.end;const duration=end.diff(start,"days").days;const modifiedRecord=Object.create(record);modifiedRecord.startHour=!record.isAllDay&&duration<1?start.toFormat("HH:mm"):"";const formattedDate=getFormattedDateSpan(start,end);if(!(formattedDate in recordGroups)){recordGroups[formattedDate]={title:formattedDate,start,end,records:[],};}
recordGroups[formattedDate].records.push(modifiedRecord);}
return Object.values(recordGroups);}
getRecordClass(record){const{colorIndex}=record;const color=getColor(colorIndex);if(color&&typeof color==="number"){return`o_calendar_color_${color}`;}
return"";}
getRecordStyle(record){const{colorIndex}=record;const color=getColor(colorIndex);if(color&&typeof color==="string"){return`background-color: ${color};`;}
return"";}
getSortedRecordGroups(recordGroups){return recordGroups.sort((a,b)=>{if(a.start.hasSame(a.end,"days")){return Number.MIN_SAFE_INTEGER;}else if(b.start.hasSame(b.end,"days")){return Number.MAX_SAFE_INTEGER;}else if(a.start.toMillis()-b.start.toMillis()===0){return a.end.toMillis()-b.end.toMillis();}
return a.start.toMillis()-b.start.toMillis();});}
onCreateButtonClick(){this.props.createRecord({start:this.props.date,isAllDay:true,});this.props.close();}
onRecordClick(record){this.props.editRecord(record);this.props.close();}}
CalendarYearPopover.components={Dialog};CalendarYearPopover.template="web.CalendarYearPopover";CalendarYearPopover.subTemplates={popover:"web.CalendarYearPopover.popover",body:"web.CalendarYearPopover.body",footer:"web.CalendarYearPopover.footer",record:"web.CalendarYearPopover.record",};CalendarYearPopover.props={close:Function,date:true,model:Object,records:Array,createRecord:Function,deleteRecord:Function,editRecord:Function,};return __exports;});;

/* /web/static/src/views/calendar/calendar_year/calendar_year_renderer.js */
odoo.define('@web/views/calendar/calendar_year/calendar_year_renderer',['@web/core/l10n/localization','@web/core/utils/timing','@web/views/calendar/colors','@web/views/calendar/hooks','@web/views/calendar/calendar_year/calendar_year_popover','@web/views/calendar/utils','@odoo/owl'],function(require){'use strict';let __exports={};const{localization}=require("@web/core/l10n/localization");const{useDebounced}=require("@web/core/utils/timing");const{getColor}=require("@web/views/calendar/colors");const{useCalendarPopover,useFullCalendar}=require("@web/views/calendar/hooks");const{CalendarYearPopover}=require("@web/views/calendar/calendar_year/calendar_year_popover");const{getWeekNumber}=require("@web/views/calendar/utils");const{Component,useEffect,useRef}=require("@odoo/owl");const CalendarYearRenderer=__exports.CalendarYearRenderer=class CalendarYearRenderer extends Component{setup(){this.months=luxon.Info.months();this.fcs={};for(const month of this.months){this.fcs[month]=useFullCalendar(`fullCalendar-${month}`,this.getOptionsForMonth(month));}
this.popover=useCalendarPopover(this.constructor.components.Popover);this.rootRef=useRef("root");this.onWindowResizeDebounced=useDebounced(this.onWindowResize,200);useEffect(()=>{this.updateSize();});}
get options(){return{columnHeaderFormat:"EEEEE",contentHeight:0,dateClick:this.onDateClick,dayRender:this.onDayRender,defaultDate:this.props.model.date.toISO(),defaultView:"dayGridMonth",dir:localization.direction,droppable:true,editable:this.props.model.canEdit,eventLimit:this.props.model.eventLimit,eventRender:this.onEventRender,eventResizableFromStart:true,events:(_,successCb)=>successCb(this.mapRecordsToEvents()),firstDay:this.props.model.firstDayOfWeek,header:{left:false,center:"title",right:false},height:0,locale:luxon.Settings.defaultLocale,longPressDelay:500,navLinks:false,nowIndicator:true,plugins:["dayGrid","interaction","luxon"],select:this.onSelect,selectMinDistance:5,selectMirror:true,selectable:this.props.model.canCreate,showNonCurrentDates:false,timeZone:luxon.Settings.defaultZone.name,titleFormat:{month:"long",year:"numeric"},unselectAuto:false,weekNumberCalculation:(date)=>getWeekNumber(date,this.props.model.firstDayOfWeek),weekNumbers:false,windowResize:this.onWindowResizeDebounced,};}
mapRecordsToEvents(){return Object.values(this.props.model.records).map((r)=>this.convertRecordToEvent(r));}
convertRecordToEvent(record){return{id:record.id,title:record.title,start:record.start.toISO(),end:record.end.plus({day:1}).toISO(),allDay:true,rendering:"background",};}
getDateWithMonth(month){return this.props.model.date.set({month:this.months.indexOf(month)+1}).toISO();}
getOptionsForMonth(month){return{...this.options,defaultDate:this.getDateWithMonth(month),};}
getPopoverProps(date,records){return{date,records,model:this.props.model,createRecord:this.props.createRecord,deleteRecord:this.props.deleteRecord,editRecord:this.props.editRecord,};}
openPopover(target,date,records){this.popover.open(target,this.getPopoverProps(date,records),"o_cw_popover");}
unselect(){for(const fc of Object.values(this.fcs)){fc.api.unselect();}}
updateSize(){const height=window.innerHeight-this.rootRef.el.getBoundingClientRect().top;this.rootRef.el.style.height=`${height}px`;}
onDateClick(info){if(this.env.isSmall){this.props.model.load({date:luxon.DateTime.fromISO(info.dateStr),scale:"day",});return;}
const date=luxon.DateTime.fromISO(info.dateStr);const records=Object.values(this.props.model.records).filter((r)=>luxon.Interval.fromDateTimes(r.start.startOf("day"),r.end.endOf("day")).contains(date));this.popover.close();if(records.length){const target=info.dayEl;this.openPopover(target,date,records);}else if(this.props.model.canCreate){this.props.createRecord({start:luxon.DateTime.fromISO(info.dateStr),isAllDay:true,});}}
onDayRender(info){const date=luxon.DateTime.fromJSDate(info.date).toISODate();if(this.props.model.unusualDays.includes(date)){info.el.classList.add("o_calendar_disabled");}}
onEventRender(info){const{el,event}=info;el.dataset.eventId=event.id;el.classList.add("o_event");const record=this.props.model.records[event.id];if(record){const color=getColor(record.colorIndex);if(typeof color==="string"){el.style.backgroundColor=color;}else if(typeof color==="number"){el.classList.add(`o_calendar_color_${color}`);}else{el.classList.add("o_calendar_color_0");}
if(record.isHatched){el.classList.add("o_event_hatched");}
if(record.isStriked){el.classList.add("o_event_striked");}}}
async onSelect(info){this.popover.close();await this.props.createRecord({start:luxon.DateTime.fromISO(info.startStr),end:luxon.DateTime.fromISO(info.endStr).minus({days:1}),isAllDay:true,});this.unselect();}
onWindowResize(){this.updateSize();}}
CalendarYearRenderer.components={Popover:CalendarYearPopover,};CalendarYearRenderer.template="web.CalendarYearRenderer";return __exports;});;

/* /web/static/src/views/calendar/colors.js */
odoo.define('@web/views/calendar/colors',[],function(require){'use strict';let __exports={};const CSS_COLOR_REGEX=/^((#[A-F0-9]{3})|(#[A-F0-9]{6})|((hsl|rgb)a?\(\s*(?:(\s*\d{1,3}%?\s*),?){3}(\s*,[0-9.]{1,4})?\))|)$/i;const colorMap=new Map();__exports.getColor=getColor;function getColor(key){if(!key){return false;}
if(colorMap.has(key)){return colorMap.get(key);}
if(typeof key==="string"&&key.match(CSS_COLOR_REGEX)){colorMap.set(key,key);}else if(typeof key==="number"){colorMap.set(key,((key-1)%55)+1);}else{colorMap.set(key,(((colorMap.size+1)*5)%24)+1);}
return colorMap.get(key);}
return __exports;});;

/* /web/static/src/views/calendar/filter_panel/calendar_filter_panel.js */
odoo.define('@web/views/calendar/filter_panel/calendar_filter_panel',['@web/core/l10n/translation','@web/core/autocomplete/autocomplete','@web/core/transition','@web/core/utils/hooks','@web/views/view_dialogs/select_create_dialog','@web/views/calendar/colors','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{AutoComplete}=require("@web/core/autocomplete/autocomplete");const{Transition}=require("@web/core/transition");const{useOwnedDialogs,useService}=require("@web/core/utils/hooks");const{SelectCreateDialog}=require("@web/views/view_dialogs/select_create_dialog");const{getColor}=require("@web/views/calendar/colors");const{Component,useState}=require("@odoo/owl");let nextId=1;const CalendarFilterPanel=__exports.CalendarFilterPanel=class CalendarFilterPanel extends Component{setup(){this.state=useState({collapsed:{},fieldRev:1,});this.addDialog=useOwnedDialogs();this.orm=useService("orm");}
getFilterColor(filter){return filter.colorIndex!==null?"o_cw_filter_color_"+getColor(filter.colorIndex):"";}
getAutoCompleteProps(section){return{autoSelect:true,resetOnSelect:true,placeholder:_t("+ Add %s",section.label),sources:[{placeholder:_t("Loading..."),options:(request)=>this.loadSource(section,request),},],onSelect:(option,params={})=>{if(option.action){option.action(params);return;}
this.props.model.createFilter(section.fieldName,option.value);},value:"",};}
async loadSource(section,request){const resModel=this.props.model.fields[section.fieldName].relation;const domain=[["id","not in",section.filters.filter((f)=>f.type!=="all").map((f)=>f.value)],];const records=await this.orm.call(resModel,"name_search",[],{name:request,operator:"ilike",args:domain,limit:8,context:{},});const options=records.map((result)=>({value:result[0],label:result[1],}));if(records.length>7){options.push({label:_t("Search More..."),action:()=>this.onSearchMore(section,resModel,domain,request),});}
if(records.length===0){options.push({label:_t("No records"),classList:"o_m2o_no_result",unselectable:true,});}
return options;}
async onSearchMore(section,resModel,domain,request){const dynamicFilters=[];if(request.length){const nameGets=await this.orm.call(resModel,"name_search",[],{name:request,args:domain,operator:"ilike",context:{},});dynamicFilters.push({description:_t("Quick search: %s",request),domain:[["id","in",nameGets.map((nameGet)=>nameGet[0])]],});}
const title=_t("Search: %s",section.label);this.addDialog(SelectCreateDialog,{title,noCreate:true,multiSelect:false,resModel,context:{},domain,onSelected:([resId])=>this.props.model.createFilter(section.fieldName,resId),dynamicFilters,});}
get nextFilterId(){nextId+=1;return nextId;}
isAllActive(section){let active=true;for(const filter of section.filters){if(filter.type!=="all"&&!filter.active){active=false;break;}}
return active;}
getFilterTypePriority(type){return["user","record","dynamic","all"].indexOf(type);}
getSortedFilters(section){return section.filters.slice().sort((a,b)=>{if(a.type===b.type){const va=a.value?-1:0;const vb=b.value?-1:0;if(a.type==="dynamic"&&va!==vb){return va-vb;}
return a.label.localeCompare(b.label,undefined,{numeric:true,sensitivity:"base",ignorePunctuation:true,});}else{return this.getFilterTypePriority(a.type)-this.getFilterTypePriority(b.type);}});}
toggleSection(section){if(section.canCollapse){this.state.collapsed[section.fieldName]=!this.state.collapsed[section.fieldName];}}
isSectionCollapsed(section){return this.state.collapsed[section.fieldName]||false;}
onFilterInputChange(section,filter,ev){this.props.model.updateFilters(section.fieldName,{[filter.value]:ev.target.checked,});}
onAllFilterInputChange(section,ev){const filters={};for(const filter of section.filters){if(filter.type!=="all"){filters[filter.value]=ev.target.checked;}}
this.props.model.updateFilters(section.fieldName,filters);}
onFilterRemoveBtnClick(section,filter){this.props.model.unlinkFilter(section.fieldName,filter.recordId);}
onFieldChanged(fieldName,filterValue){this.state.fieldRev+=1;this.props.model.createFilter(fieldName,filterValue);}}
CalendarFilterPanel.components={AutoComplete,Transition,};CalendarFilterPanel.template="web.CalendarFilterPanel";CalendarFilterPanel.subTemplates={filter:"web.CalendarFilterPanel.filter",};return __exports;});;

/* /web/static/src/views/calendar/hooks.js */
odoo.define('@web/views/calendar/hooks',['@web/core/assets','@web/core/browser/browser','@web/core/popover/popover_hook','@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{loadCSS,loadJS}=require("@web/core/assets");const{browser}=require("@web/core/browser/browser");const{usePopover}=require("@web/core/popover/popover_hook");const{useService}=require("@web/core/utils/hooks");const{onMounted,onPatched,onWillStart,onWillUnmount,onWillUpdateProps,useComponent,useExternalListener,useRef,}=require("@odoo/owl");__exports.useCalendarPopover=useCalendarPopover;function useCalendarPopover(component){const owner=useComponent();let popoverClass="";const popoverOptions={position:"right",onClose:cleanup};Object.defineProperty(popoverOptions,"popoverClass",{get:()=>popoverClass});const popover=usePopover(component,popoverOptions);const dialog=useService("dialog");let removeDialog=null;let fcPopover;useExternalListener(window,"mousedown",(ev)=>{if(fcPopover){ev.stopPropagation();}},{capture:true});function cleanup(){fcPopover=null;removeDialog=null;}
function close(){removeDialog?.();popover.close();cleanup();}
return{close,open(target,props,popoverClassToUse){fcPopover=target.closest(".fc-popover");if(owner.env.isSmall){close();removeDialog=dialog.add(component,props,{onClose:cleanup});}else{popoverClass=popoverClassToUse;popover.open(target,props);}},};}
__exports.useClickHandler=useClickHandler;function useClickHandler(singleClickCb,doubleClickCb){const component=useComponent();let clickTimeoutId=null;return function handle(...args){if(clickTimeoutId){doubleClickCb.call(component,...args);browser.clearTimeout(clickTimeoutId);clickTimeoutId=null;}else{clickTimeoutId=browser.setTimeout(()=>{singleClickCb.call(component,...args);clickTimeoutId=null;},250);}};}
__exports.useFullCalendar=useFullCalendar;function useFullCalendar(refName,params){const component=useComponent();const ref=useRef(refName);let instance=null;function boundParams(){const newParams={};for(const key in params){const value=params[key];newParams[key]=typeof value==="function"?value.bind(component):value;}
return newParams;}
async function loadJsFiles(){const files=["/web/static/lib/fullcalendar/core/main.js","/web/static/lib/fullcalendar/interaction/main.js","/web/static/lib/fullcalendar/daygrid/main.js","/web/static/lib/fullcalendar/luxon/main.js","/web/static/lib/fullcalendar/timegrid/main.js","/web/static/lib/fullcalendar/list/main.js",];for(const file of files){await loadJS(file);}}
async function loadCssFiles(){await Promise.all(["/web/static/lib/fullcalendar/core/main.css","/web/static/lib/fullcalendar/daygrid/main.css","/web/static/lib/fullcalendar/timegrid/main.css","/web/static/lib/fullcalendar/list/main.css",].map((file)=>loadCSS(file)));}
onWillStart(()=>Promise.all([loadJsFiles(),loadCssFiles()]));onMounted(()=>{try{instance=new FullCalendar.Calendar(ref.el,boundParams());instance.render();}catch(e){throw new Error(`Cannot instantiate FullCalendar\n${e.message}`);}});let isWeekendVisible=params.isWeekendVisible;onWillUpdateProps((np)=>{isWeekendVisible=np.isWeekendVisible;});onPatched(()=>{instance.refetchEvents();instance.setOption("weekends",isWeekendVisible);});onWillUnmount(()=>{instance.destroy();});return{get api(){return instance;},get el(){return ref.el;},};}
return __exports;});;

/* /web/static/src/views/calendar/mobile_filter_panel/calendar_mobile_filter_panel.js */
odoo.define('@web/views/calendar/mobile_filter_panel/calendar_mobile_filter_panel',['@odoo/owl','@web/views/calendar/colors'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{getColor}=require("@web/views/calendar/colors");const CalendarMobileFilterPanel=__exports.CalendarMobileFilterPanel=class CalendarMobileFilterPanel extends Component{get caretDirection(){return this.props.sideBarShown?"down":"left";}
getFilterColor(filter){return`o_color_${getColor(filter.colorIndex)}`;}
getFilterTypePriority(type){return["user","record","dynamic","all"].indexOf(type);}
getSortedFilters(section){return section.filters.slice().sort((a,b)=>{if(a.type===b.type){const va=a.value?-1:0;const vb=b.value?-1:0;if(a.type==="dynamic"&&va!==vb){return va-vb;}
return a.label.localeCompare(b.label,undefined,{numeric:true,sensitivity:"base",ignorePunctuation:true,});}else{return this.getFilterTypePriority(a.type)-this.getFilterTypePriority(b.type);}});}}
CalendarMobileFilterPanel.components={};CalendarMobileFilterPanel.template="web.CalendarMobileFilterPanel";return __exports;});;

/* /web/static/src/views/calendar/quick_create/calendar_quick_create.js */
odoo.define('@web/views/calendar/quick_create/calendar_quick_create',['@web/core/utils/hooks','@web/core/dialog/dialog','@web/core/l10n/translation','@odoo/owl'],function(require){'use strict';let __exports={};const{useAutofocus,useService}=require("@web/core/utils/hooks");const{Dialog}=require("@web/core/dialog/dialog");const{_t}=require("@web/core/l10n/translation");const{Component}=require("@odoo/owl");const CalendarQuickCreate=__exports.CalendarQuickCreate=class CalendarQuickCreate extends Component{setup(){this.titleRef=useAutofocus({refName:"title"});this.notification=useService("notification");this.creatingRecord=false;}
get dialogTitle(){return _t("New Event");}
get recordTitle(){return this.titleRef.el.value.trim();}
get record(){return{...this.props.record,title:this.recordTitle,};}
editRecord(){this.props.editRecord(this.record);this.props.close();}
async createRecord(){if(this.creatingRecord){return;}
if(this.recordTitle){try{this.creatingRecord=true;await this.props.model.createRecord(this.record);this.props.close();}catch{this.editRecord();}}else{this.titleRef.el.classList.add("o_field_invalid");this.notification.add(_t("Meeting Subject"),{title:_t("Invalid fields"),type:"danger",});}}
onInputKeyup(ev){switch(ev.key){case"Enter":this.createRecord();break;case"Escape":this.props.close();break;}}
onCreateBtnClick(){this.createRecord();}
onEditBtnClick(){this.editRecord();}
onCancelBtnClick(){this.props.close();}}
CalendarQuickCreate.template="web.CalendarQuickCreate";CalendarQuickCreate.components={Dialog,};CalendarQuickCreate.props={title:{type:String,optional:true},close:Function,record:Object,model:Object,editRecord:Function,};return __exports;});;

/* /web/static/src/views/calendar/utils.js */
odoo.define('@web/views/calendar/utils',[],function(require){'use strict';let __exports={};__exports.getFormattedDateSpan=getFormattedDateSpan;function getFormattedDateSpan(start,end){const isSameDay=start.hasSame(end,"days");if(!isSameDay&&start.hasSame(end,"month")){return start.toFormat("LLLL d")+"-"+end.toFormat("d, y");}else{return isSameDay?start.toFormat("DDD"):start.toFormat("DDD")+" - "+end.toFormat("DDD");}}
__exports.getWeekNumber=getWeekNumber;function getWeekNumber(date,firstDay){if(!date.isLuxonDateTime){date=luxon.DateTime.fromJSDate(date);}
if(Number.isInteger(firstDay)){date=date.minus({days:(date.weekday+7-firstDay)%7});}else{firstDay=date.weekday;}
date=firstDay>1&&firstDay<5?date.minus({days:(date.weekday+6)%7}):date.plus({days:(8-date.weekday)%7});date=date.plus({days:6});const jan4=luxon.DateTime.local(date.year,1,4);const diffDays=date<jan4?date.diff(jan4.minus({years:1}),'day').days:date.diff(jan4,'day').days;return Math.trunc(diffDays/7)+1;}
return __exports;});;

/* /web/static/src/views/debug_items.js */
odoo.define('@web/views/debug_items',['@web/core/l10n/translation','@web/core/dialog/dialog','@web/core/py_js/py','@web/core/debug/debug_utils','@web/core/l10n/dates','@web/core/registry','@web/core/utils/hooks','@web/views/fields/formatters','@web/views/view_dialogs/form_view_dialog','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{Dialog}=require("@web/core/dialog/dialog");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{editModelDebug}=require("@web/core/debug/debug_utils");const{formatDateTime,deserializeDateTime}=require("@web/core/l10n/dates");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{formatMany2one}=require("@web/views/fields/formatters");const{FormViewDialog}=require("@web/views/view_dialogs/form_view_dialog");const{Component,onWillStart,useState,xml}=require("@odoo/owl");const{serializeDate,serializeDateTime}=require("@web/core/l10n/dates");const debugRegistry=registry.category("debug");function viewSeparator(){return{type:"separator",sequence:300};}
debugRegistry.category("view").add("viewSeparator",viewSeparator);class GetViewDialog extends Component{setup(){this.title=_t("Get View");}}
GetViewDialog.template="web.DebugMenu.GetViewDialog";GetViewDialog.components={Dialog};GetViewDialog.props={arch:{type:Element},close:{type:Function},};__exports.getView=getView;function getView({component,env}){return{type:"item",description:_t("Get View"),callback:()=>{env.services.dialog.add(GetViewDialog,{arch:component.props.arch});},sequence:340,};}
debugRegistry.category("view").add("getView",getView);__exports.editView=editView;function editView({accessRights,component,env}){if(!accessRights.canEditView){return null;}
let{viewId,viewType:type}=component.env.config||{};if("viewInfo"in component.props){viewId=component.props.viewInfo.view_id;type=component.props.viewInfo.type;type=type==="tree"?"list":type;}
if(!type){return;}
const displayName=type[0].toUpperCase()+type.slice(1);const description=_t("Edit View: ")+displayName;return{type:"item",description,callback:()=>{editModelDebug(env,description,"ir.ui.view",viewId);},sequence:350,};}
debugRegistry.category("view").add("editView",editView);__exports.editSearchView=editSearchView;function editSearchView({accessRights,component,env}){if(!accessRights.canEditView){return null;}
let{searchViewId}=component.props.info||{};if("viewParams"in component.props){if(!component.props.viewParams.action.controlPanelFieldsView){return null;}
searchViewId=component.props.viewParams.action.controlPanelFieldsView.view_id;}
if(searchViewId===undefined){return null;}
const description=_t("Edit SearchView");return{type:"item",description,callback:()=>{editModelDebug(env,description,"ir.ui.view",searchViewId);},sequence:360,};}
debugRegistry.category("view").add("editSearchView",editSearchView);class GetMetadataDialog extends Component{setup(){this.orm=useService("orm");this.dialogService=useService("dialog");this.title=_t("View Metadata");this.state=useState({});onWillStart(()=>this.loadMetadata());}
onClickCreateXmlid(){const context=Object.assign({},this.context,{default_module:"__custom__",default_res_id:this.state.id,default_model:this.props.resModel,});this.dialogService.add(FormViewDialog,{context,onRecordSaved:()=>this.loadMetadata(),resModel:"ir.model.data",});}
async toggleNoupdate(){await this.env.services.orm.call("ir.model.data","toggle_noupdate",[this.props.resModel,this.state.id,]);await this.loadMetadata();}
async loadMetadata(){const args=[[this.props.resId]];const result=await this.orm.call(this.props.resModel,"get_metadata",args);const metadata=result[0];this.state.id=metadata.id;this.state.xmlid=metadata.xmlid;this.state.xmlids=metadata.xmlids;this.state.noupdate=metadata.noupdate;this.state.creator=formatMany2one(metadata.create_uid);this.state.lastModifiedBy=formatMany2one(metadata.write_uid);this.state.createDate=formatDateTime(deserializeDateTime(metadata.create_date));this.state.writeDate=formatDateTime(deserializeDateTime(metadata.write_date));}}
GetMetadataDialog.template="web.DebugMenu.GetMetadataDialog";GetMetadataDialog.components={Dialog};__exports.viewMetadata=viewMetadata;function viewMetadata({component,env}){const resId=component.model.root.resId;if(!resId){return null;}
return{type:"item",description:_t("View Metadata"),callback:()=>{env.services.dialog.add(GetMetadataDialog,{resModel:component.props.resModel,resId,});},sequence:320,};}
debugRegistry.category("form").add("viewMetadata",viewMetadata);class RawRecordDialog extends Component{get content(){const record=this.props.record;return JSON.stringify(record,Object.keys(record).sort(),2);}}
RawRecordDialog.template=xml`
<Dialog title="props.title">
    <pre t-esc="content"/>
</Dialog>`;RawRecordDialog.components={Dialog};RawRecordDialog.props={record:{type:Object},title:{type:String},close:{type:Function},};__exports.viewRawRecord=viewRawRecord;function viewRawRecord({component,env}){const{resId,resModel}=component.model.config;if(!resId){return null;}
const description=_t("View Raw Record Data");return{type:"item",description,callback:async()=>{const records=await component.model.orm.read(resModel,[resId]);env.services.dialog.add(RawRecordDialog,{title:_t("Raw Record Data: %s(%s)",resModel,resId),record:records[0],});},sequence:325,};}
debugRegistry.category("form").add("viewRawRecord",viewRawRecord);class SetDefaultDialog extends Component{setup(){this.orm=useService("orm");this.title=_t("Set Defaults");this.state={fieldToSet:"",condition:"",scope:"self",};this.fields=this.props.record.fields;this.activeFields=this.props.record.activeFields;this.fieldNamesInView=this.props.record.fieldNames;this.fieldNamesBlackList=["message_attachment_count"];this.fieldsValues=this.props.record.data;this.modifierDatas={};this.defaultFields=this.getDefaultFields();this.conditions=this.getConditions();}
getDefaultFields(){return this.fieldNamesInView.filter((fieldName)=>!this.fieldNamesBlackList.includes(fieldName)).map((fieldName)=>{const fieldInfo=this.fields[fieldName];const valueDisplayed=this.display(fieldInfo,this.fieldsValues[fieldName]);const value=valueDisplayed[0];const displayed=valueDisplayed[1];const evalContext=this.props.record.evalContextWithVirtualIds;if(!value||evaluateBooleanExpr(this.activeFields[fieldName].invisible,evalContext)||evaluateBooleanExpr(this.activeFields[fieldName].readonly,evalContext)||fieldInfo.type==="one2many"||fieldInfo.type==="many2many"||fieldInfo.type==="binary"||Object.entries(this.props.fieldNodes).filter(([key,value])=>value.name===fieldName).some(([key,value])=>value.options.isPassword)){return false;}
return{name:fieldName,string:fieldInfo.string,value,displayed,};}).filter((val)=>val).sort((field)=>field.string);}
getConditions(){return this.fieldNamesInView.filter((fieldName)=>{const fieldInfo=this.fields[fieldName];return fieldInfo.change_default;}).map((fieldName)=>{const fieldInfo=this.fields[fieldName];const valueDisplayed=this.display(fieldInfo,this.fieldsValues[fieldName]);const value=valueDisplayed[0];const displayed=valueDisplayed[1];return{name:fieldName,string:fieldInfo.string,value:value,displayed:displayed,};});}
display(fieldInfo,value){let displayed=value;if(value&&fieldInfo.type==="many2one"){displayed=value[1];value=value[0];}else if(value&&fieldInfo.type==="selection"){displayed=fieldInfo.selection.find((option)=>{return option[0]===value;})[1];}
return[value,displayed];}
async saveDefault(){if(!this.state.fieldToSet){return;}
let fieldToSet=this.defaultFields.find((field)=>{return field.name===this.state.fieldToSet;}).value;if(fieldToSet.constructor.name.toLowerCase()==="date"){fieldToSet=serializeDate(fieldToSet);}else if(fieldToSet.constructor.name.toLowerCase()==="datetime"){fieldToSet=serializeDateTime(fieldToSet);}
await this.orm.call("ir.default","set",[this.props.record.resModel,this.state.fieldToSet,fieldToSet,this.state.scope==="self",true,this.state.condition||false,]);this.props.close();}}
SetDefaultDialog.template="web.DebugMenu.SetDefaultDialog";SetDefaultDialog.components={Dialog};SetDefaultDialog.props={record:{type:Object},fieldNodes:{type:Object},close:{type:Function},};__exports.setDefaults=setDefaults;function setDefaults({component,env}){return{type:"item",description:_t("Set Defaults"),callback:()=>{env.services.dialog.add(SetDefaultDialog,{record:component.model.root,fieldNodes:component.props.archInfo.fieldNodes,});},sequence:310,};}
debugRegistry.category("form").add("setDefaults",setDefaults);__exports.manageAttachments=manageAttachments;function manageAttachments({component,env}){const resId=component.model.root.resId;if(!resId){return null;}
const description=_t("Manage Attachments");return{type:"item",description,callback:()=>{env.services.action.doAction({res_model:"ir.attachment",name:description,views:[[false,"list"],[false,"form"],],type:"ir.actions.act_window",domain:[["res_model","=",component.props.resModel],["res_id","=",resId],],context:{default_res_model:component.props.resModel,default_res_id:resId,skip_res_field_check:true,},});},sequence:330,};}
debugRegistry.category("form").add("manageAttachments",manageAttachments);return __exports;});;

/* /web/static/src/views/fields/ace/ace_field.js */
odoo.define('@web/views/fields/ace/ace_field',['@web/core/l10n/translation','@web/core/registry','@web/core/utils/hooks','@web/views/fields/standard_field_props','@web/core/code_editor/code_editor','@odoo/owl','@web/model/relational_model/utils','@web/views/fields/formatters','@web/core/browser/cookie'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useBus}=require("@web/core/utils/hooks");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{CodeEditor}=require("@web/core/code_editor/code_editor");const{Component,useState}=require("@odoo/owl");const{useRecordObserver}=require("@web/model/relational_model/utils");const{formatText}=require("@web/views/fields/formatters");const{cookie}=require("@web/core/browser/cookie");const AceField=__exports.AceField=class AceField extends Component{static template="web.AceField";static props={...standardFieldProps,mode:{type:String,optional:true},};static defaultProps={mode:"qweb",};static components={CodeEditor};setup(){this.state=useState({});useRecordObserver((record)=>{this.state.initialValue=formatText(record.data[this.props.name]);});this.isDirty=false;const{model}=this.props.record;useBus(model.bus,"WILL_SAVE_URGENTLY",()=>this.commitChanges());useBus(model.bus,"NEED_LOCAL_CHANGES",({detail})=>detail.proms.push(this.commitChanges()));}
get mode(){return this.props.mode==="xml"?"qweb":this.props.mode;}
get theme(){return cookie.get("color_scheme")==="dark"?"monokai":"";}
handleChange(editedValue){if(this.state.initialValue!==editedValue){this.isDirty=true;}else{this.isDirty=false;}
this.props.record.model.bus.trigger("FIELD_IS_DIRTY",this.isDirty);this.editedValue=editedValue;}
async commitChanges(){if(!this.props.readonly&&this.isDirty){if(this.state.initialValue!==this.editedValue){await this.props.record.update({[this.props.name]:this.editedValue});}
this.isDirty=false;}}}
const aceField=__exports.aceField={component:AceField,displayName:_t("Ace Editor"),supportedOptions:[{label:_t("Mode"),name:"mode",type:"string",},],supportedTypes:["text","html"],extractProps:({options})=>({mode:options.mode,}),};registry.category("fields").add("ace",aceField);registry.category("fields").add("code",aceField);return __exports;});;

/* /web/static/src/views/fields/attachment_image/attachment_image_field.js */
odoo.define('@web/views/fields/attachment_image/attachment_image_field',['@web/core/l10n/translation','@web/core/registry','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{Component}=require("@odoo/owl");const AttachmentImageField=__exports.AttachmentImageField=class AttachmentImageField extends Component{static template="web.AttachmentImageField";}
const attachmentImageField=__exports.attachmentImageField={component:AttachmentImageField,displayName:_t("Attachment Image"),supportedTypes:["many2one"],};registry.category("fields").add("attachment_image",attachmentImageField);return __exports;});;

/* /web/static/src/views/fields/badge/badge_field.js */
odoo.define('@web/views/fields/badge/badge_field',['@web/core/l10n/translation','@web/core/py_js/py','@web/core/registry','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{registry}=require("@web/core/registry");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const formatters=registry.category("formatters");const BadgeField=__exports.BadgeField=class BadgeField extends Component{static template="web.BadgeField";static props={...standardFieldProps,decorations:{type:Object,optional:true},};static defaultProps={decorations:{},};get formattedValue(){const formatter=formatters.get(this.props.record.fields[this.props.name].type);return formatter(this.props.record.data[this.props.name],{selection:this.props.record.fields[this.props.name].selection,});}
get classFromDecoration(){const evalContext=this.props.record.evalContextWithVirtualIds;for(const decorationName in this.props.decorations){if(evaluateBooleanExpr(this.props.decorations[decorationName],evalContext)){return`text-bg-${decorationName}`;}}
return"";}}
const badgeField=__exports.badgeField={component:BadgeField,displayName:_t("Badge"),supportedTypes:["selection","many2one","char"],extractProps:({decorations})=>{return{decorations};},};registry.category("fields").add("badge",badgeField);return __exports;});;

/* /web/static/src/views/fields/badge_selection/badge_selection_field.js */
odoo.define('@web/views/fields/badge_selection/badge_selection_field',['@odoo/owl','@web/core/l10n/translation','@web/core/registry','@web/views/fields/relational_utils','@web/views/fields/standard_field_props'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useSpecialData}=require("@web/views/fields/relational_utils");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const BadgeSelectionField=__exports.BadgeSelectionField=class BadgeSelectionField extends Component{static template="web.BadgeSelectionField";static props={...standardFieldProps,domain:{type:Array,optional:true},size:{type:String,optional:true,validate:(s)=>["sm","md","lg"].includes(s),default:"md",},};setup(){this.type=this.props.record.fields[this.props.name].type;if(this.type==="many2one"){this.specialData=useSpecialData((orm,props)=>{const{relation}=props.record.fields[props.name];return orm.call(relation,"name_search",["",props.domain]);});}}
get options(){switch(this.type){case"many2one":return this.specialData.data;case"selection":return this.props.record.fields[this.props.name].selection;default:return[];}}
get string(){switch(this.type){case"many2one":return this.props.record.data[this.props.name]?this.props.record.data[this.props.name][1]:"";case"selection":return this.props.record.data[this.props.name]!==false?this.options.find((o)=>o[0]===this.props.record.data[this.props.name])[1]:"";default:return"";}}
get value(){const rawValue=this.props.record.data[this.props.name];return this.type==="many2one"&&rawValue?rawValue[0]:rawValue;}
stringify(value){return JSON.stringify(value);}
onChange(value){switch(this.type){case"many2one":if(value===false){this.props.record.update({[this.props.name]:false});}else{this.props.record.update({[this.props.name]:this.options.find((option)=>option[0]===value),});}
break;case"selection":if(value===this.value){const{required}=this.props.record.fields[this.props.name];if(!required){this.props.record.update({[this.props.name]:false});}}else{this.props.record.update({[this.props.name]:value});}
break;}}}
const badgeSelectionField=__exports.badgeSelectionField={component:BadgeSelectionField,displayName:_t("Badges"),supportedTypes:["many2one","selection"],supportedOptions:[{label:"Size",name:"size",type:"selection",choices:[{label:"Small",value:"sm"},{label:"Medium",value:"md"},{label:"Large",value:"lg"},],default:"md",},],isEmpty:(record,fieldName)=>record.data[fieldName]===false,extractProps:(fieldInfo,dynamicInfo)=>({domain:dynamicInfo.domain(),size:fieldInfo.options.size,}),};registry.category("fields").add("selection_badge",badgeSelectionField);return __exports;});;

/* /web/static/src/views/fields/binary/binary_field.js */
odoo.define('@web/views/fields/binary/binary_field',['@web/core/registry','@web/core/utils/hooks','@web/core/utils/binary','@web/core/network/download','@web/views/fields/standard_field_props','@web/views/fields/file_handler','@web/core/l10n/translation','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{isBinarySize,toBase64Length}=require("@web/core/utils/binary");const{download}=require("@web/core/network/download");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{FileUploader}=require("@web/views/fields/file_handler");const{_t}=require("@web/core/l10n/translation");const{Component}=require("@odoo/owl");const MAX_FILENAME_SIZE_BYTES=__exports.MAX_FILENAME_SIZE_BYTES=0xFF;const BinaryField=__exports.BinaryField=class BinaryField extends Component{static template="web.BinaryField";static components={FileUploader,};static props={...standardFieldProps,acceptedFileExtensions:{type:String,optional:true},fileNameField:{type:String,optional:true},};static defaultProps={acceptedFileExtensions:"*",};setup(){this.notification=useService("notification");}
get fileName(){return(this.props.record.data[this.props.fileNameField]||this.props.record.data[this.props.name]||"").slice(0,toBase64Length(MAX_FILENAME_SIZE_BYTES));}
update({data,name}){const{fileNameField,record}=this.props;const changes={[this.props.name]:data||false};if(fileNameField in record.fields&&record.data[fileNameField]!==name){changes[fileNameField]=name||'';}
return this.props.record.update(changes);}
getDownloadData(){return{model:this.props.record.resModel,id:this.props.record.resId,field:this.props.name,filename_field:this.fileName,filename:this.fileName||"",download:true,data:isBinarySize(this.props.record.data[this.props.name])?null:this.props.record.data[this.props.name],};}
async onFileDownload(){await download({data:this.getDownloadData(),url:"/web/content",});}}
const ListBinaryField=__exports.ListBinaryField=class ListBinaryField extends BinaryField{static template="web.ListBinaryField";}
const binaryField=__exports.binaryField={component:BinaryField,displayName:_t("File"),supportedOptions:[{label:_t("Accepted file extensions"),name:"accepted_file_extensions",type:"string",},],supportedTypes:["binary"],extractProps:({attrs,options})=>({acceptedFileExtensions:options.accepted_file_extensions,fileNameField:attrs.filename,}),};const listBinaryField=__exports.listBinaryField={...binaryField,component:ListBinaryField,};registry.category("fields").add("binary",binaryField);registry.category("fields").add("list.binary",listBinaryField);return __exports;});;

/* /web/static/src/views/fields/boolean/boolean_field.js */
odoo.define('@web/views/fields/boolean/boolean_field',['@odoo/owl','@web/core/checkbox/checkbox','@web/core/l10n/translation','@web/core/registry','@web/model/relational_model/utils','@web/views/fields/standard_field_props'],function(require){'use strict';let __exports={};const{Component,useState}=require("@odoo/owl");const{CheckBox}=require("@web/core/checkbox/checkbox");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useRecordObserver}=require("@web/model/relational_model/utils");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const BooleanField=__exports.BooleanField=class BooleanField extends Component{static template="web.BooleanField";static components={CheckBox};static props={...standardFieldProps,};setup(){this.state=useState({});useRecordObserver((record)=>{this.state.value=record.data[this.props.name];});}
onChange(newValue){this.state.value=newValue;this.props.record.update({[this.props.name]:newValue});}}
const booleanField=__exports.booleanField={component:BooleanField,displayName:_t("Checkbox"),supportedTypes:["boolean"],isEmpty:()=>false,};registry.category("fields").add("boolean",booleanField);return __exports;});;

/* /web/static/src/views/fields/boolean_favorite/boolean_favorite_field.js */
odoo.define('@web/views/fields/boolean_favorite/boolean_favorite_field',['@web/core/l10n/translation','@web/core/registry','@web/views/utils','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{archParseBoolean}=require("@web/views/utils");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const BooleanFavoriteField=__exports.BooleanFavoriteField=class BooleanFavoriteField extends Component{static template="web.BooleanFavoriteField";static props={...standardFieldProps,noLabel:{type:Boolean,optional:true},autosave:{type:Boolean,optional:true},};static defaultProps={noLabel:false,};async update(){const changes={[this.props.name]:!this.props.record.data[this.props.name]};await this.props.record.update(changes,{save:this.props.autosave});}}
const booleanFavoriteField=__exports.booleanFavoriteField={component:BooleanFavoriteField,displayName:_t("Favorite"),supportedTypes:["boolean"],isEmpty:()=>false,supportedOptions:[{label:_t("Autosave"),name:"autosave",type:"boolean",default:true,help:_t("If checked, the record will be saved immediately when the field is modified."),},],extractProps:({attrs,options})=>({noLabel:archParseBoolean(attrs.nolabel),autosave:"autosave"in options?Boolean(options.autosave):true,}),};registry.category("fields").add("boolean_favorite",booleanFavoriteField);return __exports;});;

/* /web/static/src/views/fields/boolean_icon/boolean_icon_field.js */
odoo.define('@web/views/fields/boolean_icon/boolean_icon_field',['@odoo/owl','@web/core/registry','@web/core/l10n/translation','@web/views/fields/standard_field_props'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{registry}=require("@web/core/registry");const{_t}=require("@web/core/l10n/translation");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const BooleanIconField=__exports.BooleanIconField=class BooleanIconField extends Component{static template="web.BooleanIconField";static props={...standardFieldProps,icon:{type:String,optional:true},label:{type:String,optional:true},};static defaultProps={icon:"fa-check-square-o",};update(){this.props.record.update({[this.props.name]:!this.props.record.data[this.props.name]});}}
const booleanIconField=__exports.booleanIconField={component:BooleanIconField,displayName:_t("Boolean Icon"),supportedOptions:[{label:_t("Icon"),name:"icon",type:"string",},],supportedTypes:["boolean"],extractProps:({options,string})=>({icon:options.icon,label:string,}),};registry.category("fields").add("boolean_icon",booleanIconField);return __exports;});;

/* /web/static/src/views/fields/boolean_toggle/boolean_toggle_field.js */
odoo.define('@web/views/fields/boolean_toggle/boolean_toggle_field',['@web/core/l10n/translation','@web/core/registry','@web/views/fields/boolean/boolean_field'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{booleanField,BooleanField}=require("@web/views/fields/boolean/boolean_field");const BooleanToggleField=__exports.BooleanToggleField=class BooleanToggleField extends BooleanField{static template="web.BooleanToggleField";static props={...BooleanField.props,autosave:{type:Boolean,optional:true},};async onChange(newValue){this.state.value=newValue;const changes={[this.props.name]:newValue};await this.props.record.update(changes,{save:this.props.autosave});}}
const booleanToggleField=__exports.booleanToggleField={...booleanField,component:BooleanToggleField,displayName:_t("Toggle"),supportedOptions:[{label:_t("Autosave"),name:"autosave",type:"boolean",default:true,help:_t("If checked, the record will be saved immediately when the field is modified."),},],extractProps({options},dynamicInfo){return{autosave:"autosave"in options?Boolean(options.autosave):true,readonly:dynamicInfo.readonly,};},};registry.category("fields").add("boolean_toggle",booleanToggleField);return __exports;});;

/* /web/static/src/views/fields/boolean_toggle/list_boolean_toggle_field.js */
odoo.define('@web/views/fields/boolean_toggle/list_boolean_toggle_field',['@web/core/registry','@web/views/fields/boolean_toggle/boolean_toggle_field'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{booleanToggleField,BooleanToggleField}=require("@web/views/fields/boolean_toggle/boolean_toggle_field");const ListBooleanToggleField=__exports.ListBooleanToggleField=class ListBooleanToggleField extends BooleanToggleField{static template="web.ListBooleanToggleField";async onClick(){if(!this.props.readonly&&this.props.record.isInEdition){const changes={[this.props.name]:!this.props.record.data[this.props.name]};await this.props.record.update(changes,{save:this.props.autosave});}}}
const listBooleanToggleField=__exports.listBooleanToggleField={...booleanToggleField,component:ListBooleanToggleField,};registry.category("fields").add("list.boolean_toggle",listBooleanToggleField);return __exports;});;

/* /web/static/src/views/fields/char/char_field.js */
odoo.define('@web/views/fields/char/char_field',['@web/core/l10n/translation','@web/core/registry','@web/views/utils','@web/views/fields/formatters','@web/views/fields/input_field_hook','@web/views/fields/standard_field_props','@web/views/fields/translation_button','@web/views/fields/dynamic_placeholder_hook','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{archParseBoolean}=require("@web/views/utils");const{formatChar}=require("@web/views/fields/formatters");const{useInputField}=require("@web/views/fields/input_field_hook");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{TranslationButton}=require("@web/views/fields/translation_button");const{useDynamicPlaceholder}=require("@web/views/fields/dynamic_placeholder_hook");const{Component,useExternalListener,useRef,useEffect}=require("@odoo/owl");const CharField=__exports.CharField=class CharField extends Component{static template="web.CharField";static components={TranslationButton,};static props={...standardFieldProps,autocomplete:{type:String,optional:true},isPassword:{type:Boolean,optional:true},placeholder:{type:String,optional:true},dynamicPlaceholder:{type:Boolean,optional:true},dynamicPlaceholderModelReferenceField:{type:String,optional:true},};static defaultProps={dynamicPlaceholder:false};setup(){this.input=useRef("input");if(this.props.dynamicPlaceholder){const dynamicPlaceholder=useDynamicPlaceholder(this.input);useExternalListener(document,"keydown",dynamicPlaceholder.onKeydown);useEffect(()=>dynamicPlaceholder.updateModel(this.props.dynamicPlaceholderModelReferenceField));}
useInputField({getValue:()=>this.props.record.data[this.props.name]||"",parse:(v)=>this.parse(v),});}
get shouldTrim(){return this.props.record.fields[this.props.name].trim&&!this.props.isPassword;}
get maxLength(){return this.props.record.fields[this.props.name].size;}
get isTranslatable(){return this.props.record.fields[this.props.name].translate;}
get formattedValue(){return formatChar(this.props.record.data[this.props.name],{isPassword:this.props.isPassword,});}
parse(value){if(this.shouldTrim){return value.trim();}
return value;}}
const charField=__exports.charField={component:CharField,displayName:_t("Text"),supportedTypes:["char"],supportedOptions:[{label:_t("Dynamic placeholder"),name:"dynamic_placeholder",type:"boolean",help:_t("Enable this option to allow the input to display a dynamic placeholder."),},{label:_t("Model reference field"),name:"dynamic_placeholder_model_reference_field",type:"field",availableTypes:["char"],},],extractProps:({attrs,options})=>({isPassword:archParseBoolean(attrs.password),dynamicPlaceholder:options.dynamic_placeholder||false,dynamicPlaceholderModelReferenceField:options.dynamic_placeholder_model_reference_field||"",autocomplete:attrs.autocomplete,placeholder:attrs.placeholder,}),};registry.category("fields").add("char",charField);return __exports;});;

/* /web/static/src/views/fields/color/color_field.js */
odoo.define('@web/views/fields/color/color_field',['@odoo/owl','@web/core/registry','@web/views/fields/standard_field_props'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{registry}=require("@web/core/registry");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const ColorField=__exports.ColorField=class ColorField extends Component{static template="web.ColorField";static props={...standardFieldProps,};get color(){return this.props.record.data[this.props.name]||"";}}
const colorField=__exports.colorField={component:ColorField,supportedTypes:["char"],extractProps(fieldInfo,dynamicInfo){return{readonly:dynamicInfo.readonly,};},};registry.category("fields").add("color",colorField);return __exports;});;

/* /web/static/src/views/fields/color_picker/color_picker_field.js */
odoo.define('@web/views/fields/color_picker/color_picker_field',['@web/core/colorlist/colorlist','@web/core/registry','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{ColorList}=require("@web/core/colorlist/colorlist");const{registry}=require("@web/core/registry");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const ColorPickerField=__exports.ColorPickerField=class ColorPickerField extends Component{static template="web.ColorPickerField";static components={ColorList,};static props={...standardFieldProps,canToggle:{type:Boolean},};static RECORD_COLORS=[0,1,2,3,4,5,6,7,8,9,10,11];get isExpanded(){return!this.props.canToggle&&!this.props.readonly;}
switchColor(colorIndex){this.props.record.update({[this.props.name]:colorIndex});}}
const colorPickerField=__exports.colorPickerField={component:ColorPickerField,supportedTypes:["integer"],extractProps:({viewType})=>({canToggle:viewType!=="list",}),};registry.category("fields").add("color_picker",colorPickerField);return __exports;});;

/* /web/static/src/views/fields/copy_clipboard/copy_button.js */
odoo.define('@web/views/fields/copy_clipboard/copy_button',['@web/core/browser/browser','@web/core/tooltip/tooltip','@web/core/popover/popover_hook','@odoo/owl'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{Tooltip}=require("@web/core/tooltip/tooltip");const{usePopover}=require("@web/core/popover/popover_hook");const{Component,useRef}=require("@odoo/owl");const CopyButton=__exports.CopyButton=class CopyButton extends Component{static template="web.CopyButton";static props={className:{type:String,optional:true},copyText:{type:String,optional:true},disabled:{type:Boolean,optional:true},successText:{type:String,optional:true},content:{type:[String,Object],optional:true},};setup(){this.button=useRef("button");this.popover=usePopover(Tooltip);}
showTooltip(){this.popover.open(this.button.el,{tooltip:this.props.successText});browser.setTimeout(this.popover.close,800);}
async onClick(){let write;if(typeof this.props.content==="string"||this.props.content instanceof String){write=(value)=>browser.navigator.clipboard.writeText(value);}else{write=(value)=>browser.navigator.clipboard.write(value);}
try{await write(this.props.content);}catch(error){return browser.console.warn(error);}
this.showTooltip();}}
return __exports;});;

/* /web/static/src/views/fields/copy_clipboard/copy_clipboard_field.js */
odoo.define('@web/views/fields/copy_clipboard/copy_clipboard_field',['@web/core/l10n/translation','@web/core/py_js/py','@web/core/registry','@web/core/utils/objects','@web/views/fields/copy_clipboard/copy_button','@web/views/fields/url/url_field','@web/views/fields/char/char_field','@web/views/fields/text/text_field','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{registry}=require("@web/core/registry");const{omit}=require("@web/core/utils/objects");const{CopyButton}=require("@web/views/fields/copy_clipboard/copy_button");const{UrlField}=require("@web/views/fields/url/url_field");const{CharField}=require("@web/views/fields/char/char_field");const{TextField}=require("@web/views/fields/text/text_field");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");class CopyClipboardField extends Component{static template="web.CopyClipboardField";static props={...standardFieldProps,string:{type:String,optional:true},disabledExpr:{type:String,optional:true},};setup(){this.copyText=this.props.string||_t("Copy");this.successText=_t("Copied");}
get copyButtonClassName(){return`o_btn_${this.type}_copy btn-sm`;}
get fieldProps(){return omit(this.props,"string","disabledExpr");}
get type(){return this.props.record.fields[this.props.name].type;}
get disabled(){return this.props.disabledExpr?evaluateBooleanExpr(this.props.disabledExpr,this.props.record.evalContextWithVirtualIds):false;}}
const CopyClipboardButtonField=__exports.CopyClipboardButtonField=class CopyClipboardButtonField extends CopyClipboardField{static template="web.CopyClipboardButtonField";static components={CopyButton};get copyButtonClassName(){return`o_btn_${this.type}_copy rounded-2`;}}
const CopyClipboardCharField=__exports.CopyClipboardCharField=class CopyClipboardCharField extends CopyClipboardField{static components={Field:CharField,CopyButton};}
const CopyClipboardTextField=__exports.CopyClipboardTextField=class CopyClipboardTextField extends CopyClipboardField{static components={Field:TextField,CopyButton};}
const CopyClipboardURLField=__exports.CopyClipboardURLField=class CopyClipboardURLField extends CopyClipboardField{static components={Field:UrlField,CopyButton};}
function extractProps({attrs}){return{string:attrs.string,disabledExpr:attrs.disabled,};}
const copyClipboardButtonField=__exports.copyClipboardButtonField={component:CopyClipboardButtonField,displayName:_t("Copy to Clipboard"),extractProps,};registry.category("fields").add("CopyClipboardButton",copyClipboardButtonField);const copyClipboardCharField=__exports.copyClipboardCharField={component:CopyClipboardCharField,displayName:_t("Copy Text to Clipboard"),supportedTypes:["char"],extractProps,};registry.category("fields").add("CopyClipboardChar",copyClipboardCharField);const copyClipboardTextField=__exports.copyClipboardTextField={component:CopyClipboardTextField,displayName:_t("Copy Multiline Text to Clipboard"),supportedTypes:["text"],extractProps,};registry.category("fields").add("CopyClipboardText",copyClipboardTextField);const copyClipboardURLField=__exports.copyClipboardURLField={component:CopyClipboardURLField,displayName:_t("Copy URL to Clipboard"),supportedTypes:["char"],extractProps,};registry.category("fields").add("CopyClipboardURL",copyClipboardURLField);return __exports;});;

/* /web/static/src/views/fields/datetime/datetime_field.js */
odoo.define('@web/views/fields/datetime/datetime_field',['@odoo/owl','@web/core/datetime/datetime_hook','@web/core/l10n/dates','@web/core/py_js/py','@web/core/l10n/translation','@web/core/registry','@web/core/utils/arrays','@web/views/utils','@web/views/fields/standard_field_props'],function(require){'use strict';let __exports={};const{Component,onWillRender,useState}=require("@odoo/owl");const{useDateTimePicker}=require("@web/core/datetime/datetime_hook");const{areDatesEqual,deserializeDate,deserializeDateTime,formatDate,formatDateTime,today,}=require("@web/core/l10n/dates");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{ensureArray}=require("@web/core/utils/arrays");const{archParseBoolean}=require("@web/views/utils");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const DateTimeField=__exports.DateTimeField=class DateTimeField extends Component{static props={...standardFieldProps,endDateField:{type:String,optional:true},maxDate:{type:String,optional:true},minDate:{type:String,optional:true},alwaysRange:{type:Boolean,optional:true},placeholder:{type:String,optional:true},required:{type:Boolean,optional:true},rounding:{type:Number,optional:true},startDateField:{type:String,optional:true},warnFuture:{type:Boolean,optional:true},};static template="web.DateTimeField";get endDateField(){return this.relatedField?this.props.endDateField||this.props.name:null;}
get field(){return this.props.record.fields[this.props.name];}
get relatedField(){return this.props.startDateField||this.props.endDateField;}
get startDateField(){return this.props.startDateField||this.props.name;}
get values(){return ensureArray(this.state.value);}
setup(){const getPickerProps=()=>{const value=this.getRecordValue();const pickerProps={value,type:this.field.type,range:this.isRange(value),};if(this.props.maxDate){pickerProps.maxDate=this.parseLimitDate(this.props.maxDate);}
if(this.props.minDate){pickerProps.minDate=this.parseLimitDate(this.props.minDate);}
if(!isNaN(this.props.rounding)){pickerProps.rounding=this.props.rounding;}
return pickerProps;};const dateTimePicker=useDateTimePicker({target:"root",get pickerProps(){return getPickerProps();},onChange:()=>{this.state.range=this.isRange(this.state.value);},onApply:()=>{const toUpdate={};if(Array.isArray(this.state.value)){[toUpdate[this.startDateField],toUpdate[this.endDateField]]=this.state.value;}else{toUpdate[this.props.name]=this.state.value;}
if(!this.startDateField||!this.endDateField){for(const fieldName in toUpdate){if(areDatesEqual(toUpdate[fieldName],this.props.record.data[fieldName])){delete toUpdate[fieldName];}}}else{if(areDatesEqual(toUpdate[this.startDateField],this.props.record.data[this.startDateField])&&areDatesEqual(toUpdate[this.endDateField],this.props.record.data[this.endDateField])){delete toUpdate[this.startDateField];delete toUpdate[this.endDateField];}}
if(Object.keys(toUpdate).length){this.props.record.update(toUpdate);}},});this.state=useState(dateTimePicker.state);this.openPicker=dateTimePicker.open;onWillRender(()=>this.triggerIsDirty());}
async addDate(valueIndex){const values=this.values;values[valueIndex]=values[valueIndex?0:1];this.state.focusedDateIndex=valueIndex;this.state.value=values;this.state.range=true;this.openPicker(valueIndex);}
getFormattedValue(valueIndex){const value=this.values[valueIndex];return value?this.field.type==="date"?formatDate(value):formatDateTime(value):"";}
getRecordValue(){if(this.relatedField){return[this.props.record.data[this.startDateField],this.props.record.data[this.endDateField],];}else{return this.props.record.data[this.props.name];}}
isDateInTheFuture(index){return this.values[index]>today();}
isEmpty(fieldName){return fieldName===this.startDateField?!this.values[0]:!this.values[1];}
isRange(value){if(!this.relatedField){return false;}
return(this.props.alwaysRange||this.props.required||ensureArray(value).filter(Boolean).length===2);}
parseLimitDate(value){if(value==="today"){return value;}
return this.field.type==="date"?deserializeDate(value):deserializeDateTime(value);}
shouldShowSeparator(){return((this.props.alwaysRange&&(this.props.readonly?!this.isEmpty(this.startDateField)||!this.isEmpty(this.endDateField):true))||(this.state.range&&(this.props.required||(!this.isEmpty(this.startDateField)&&!this.isEmpty(this.endDateField)))));}
triggerIsDirty(isDirty){this.props.record.model.bus.trigger("FIELD_IS_DIRTY",isDirty??!areDatesEqual(this.getRecordValue(),this.state.value));}
onInput(){this.triggerIsDirty(true);}}
const START_DATE_FIELD_OPTION="start_date_field";const END_DATE_FIELD_OPTION="end_date_field";const dateField=__exports.dateField={component:DateTimeField,displayName:_t("Date"),supportedOptions:[{label:_t("Earliest accepted date"),name:"min_date",type:"string",help:_t(`ISO-formatted date (e.g. "2018-12-31") or "%s".`,"today"),},{label:_t("Latest accepted date"),name:"max_date",type:"string",help:_t(`ISO-formatted date (e.g. "2018-12-31") or "%s".`,"today"),},{label:_t("Warning for future dates"),name:"warn_future",type:"boolean",help:_t(`Displays a warning icon if the input dates are in the future.`),},],supportedTypes:["date"],extractProps:({attrs,options},dynamicInfo)=>({endDateField:options[END_DATE_FIELD_OPTION],maxDate:options.max_date,minDate:options.min_date,alwaysRange:archParseBoolean(options.always_range),placeholder:attrs.placeholder,required:dynamicInfo.required,rounding:options.rounding&&parseInt(options.rounding,10),startDateField:options[START_DATE_FIELD_OPTION],warnFuture:archParseBoolean(options.warn_future),}),fieldDependencies:({type,attrs,options})=>{const deps=[];if(options[START_DATE_FIELD_OPTION]){deps.push({name:options[START_DATE_FIELD_OPTION],type,readonly:false,...attrs,});if(options[END_DATE_FIELD_OPTION]){console.warn(`A field cannot have both ${START_DATE_FIELD_OPTION} and ${END_DATE_FIELD_OPTION} options at the same time`);}}else if(options[END_DATE_FIELD_OPTION]){deps.push({name:options[END_DATE_FIELD_OPTION],type,readonly:false,...attrs,});}
return deps;},};const dateTimeField=__exports.dateTimeField={...dateField,displayName:_t("Date & Time"),supportedOptions:[...dateField.supportedOptions,{label:_t("Time interval"),name:"rounding",type:"number",default:5,help:_t(`Control the number of minutes in the time selection. E.g. set it to 15 to work in quarters.`),},],supportedTypes:["datetime"],};const dateRangeField=__exports.dateRangeField={...dateTimeField,displayName:_t("Date Range"),supportedOptions:[...dateTimeField.supportedOptions,{label:_t("Start date field"),name:START_DATE_FIELD_OPTION,type:"field",availableTypes:["date","datetime"],},{label:_t("End date field"),name:END_DATE_FIELD_OPTION,type:"field",availableTypes:["date","datetime"],},{label:_t("Always range"),name:"always_range",type:"boolean",default:false,help:_t(`Set to true the full range input has to be display by default, even if empty.`),},],supportedTypes:["date","datetime"],isValid:(record,fieldname,fieldInfo)=>{if(fieldInfo.widget==="daterange"){if(!record.data[fieldInfo.options[END_DATE_FIELD_OPTION]]!==!record.data[fieldname]&&evaluateBooleanExpr(record.activeFields[fieldInfo.options[END_DATE_FIELD_OPTION]]?.required,record.evalContextWithVirtualIds)){return false;}
if(!record.data[fieldInfo.options[START_DATE_FIELD_OPTION]]!==!record.data[fieldname]&&evaluateBooleanExpr(record.activeFields[fieldInfo.options[START_DATE_FIELD_OPTION]]?.required,record.evalContextWithVirtualIds)){return false;}}
return!record.isFieldInvalid(fieldname);}};registry.category("fields").add("date",dateField).add("daterange",dateRangeField).add("datetime",dateTimeField);return __exports;});;

/* /web/static/src/views/fields/datetime/list_datetime_field.js */
odoo.define('@web/views/fields/datetime/list_datetime_field',['@web/core/registry','@web/views/fields/datetime/datetime_field'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{DateTimeField,dateField,dateRangeField,dateTimeField}=require("@web/views/fields/datetime/datetime_field");const ListDateTimeField=__exports.ListDateTimeField=class ListDateTimeField extends DateTimeField{shouldShowSeparator(){return this.props.readonly?this.relatedField&&this.values.some(Boolean):super.shouldShowSeparator();}}
const listDateField=__exports.listDateField={...dateField,component:ListDateTimeField};const listDateRangeField=__exports.listDateRangeField={...dateRangeField,component:ListDateTimeField};const listDateTimeField=__exports.listDateTimeField={...dateTimeField,component:ListDateTimeField};registry.category("fields").add("list.date",listDateField).add("list.daterange",listDateRangeField).add("list.datetime",listDateTimeField);return __exports;});;

/* /web/static/src/views/fields/domain/domain_field.js */
odoo.define('@web/views/fields/domain/domain_field',['@web/core/l10n/translation','@odoo/owl','@web/core/domain','@web/core/domain_selector/domain_selector','@web/core/domain_selector_dialog/domain_selector_dialog','@web/core/py_js/py_builtin','@web/core/registry','@web/views/view_dialogs/select_create_dialog','@web/views/fields/standard_field_props','@web/core/utils/hooks','@web/core/domain_selector/utils','@web/core/tree_editor/condition_tree'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{Component,onWillStart,onWillUpdateProps,useState}=require("@odoo/owl");const{Domain,InvalidDomainError}=require("@web/core/domain");const{DomainSelector}=require("@web/core/domain_selector/domain_selector");const{DomainSelectorDialog}=require("@web/core/domain_selector_dialog/domain_selector_dialog");const{EvaluationError}=require("@web/core/py_js/py_builtin");const{registry}=require("@web/core/registry");const{SelectCreateDialog}=require("@web/views/view_dialogs/select_create_dialog");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{useBus,useService,useOwnedDialogs}=require("@web/core/utils/hooks");const{useGetDomainTreeDescription,useGetDefaultLeafDomain,}=require("@web/core/domain_selector/utils");const{treeFromDomain}=require("@web/core/tree_editor/condition_tree");const DomainField=__exports.DomainField=class DomainField extends Component{static template="web.DomainField";static components={DomainSelector,};static props={...standardFieldProps,context:{type:Object,optional:true},editInDialog:{type:Boolean,optional:true},resModel:{type:String,optional:true},isFoldable:{type:Boolean,optional:true},};static defaultProps={editInDialog:false,isFoldable:false,};setup(){this.rpc=useService("rpc");this.orm=useService("orm");this.getDomainTreeDescription=useGetDomainTreeDescription();this.getDefaultLeafDomain=useGetDefaultLeafDomain();this.addDialog=useOwnedDialogs();this.state=useState({isValid:null,recordCount:null,folded:this.props.isFoldable,facets:[],});this.isDebugEdited=false;onWillStart(()=>{this.checkProps();if(this.props.isFoldable){this.loadFacets();}});onWillUpdateProps((nextProps)=>{if(this.isDebugEdited){this.quickValidityCheck(nextProps).then((isValid)=>{this.state.isValid=isValid;this.isDebugEdited=false;if(!isValid){this.state.recordCount=0;nextProps.record.setInvalidField(nextProps.name);}});}else{this.checkProps(nextProps);}
if(nextProps.isFoldable){this.loadFacets(nextProps);}});useBus(this.props.record.model.bus,"NEED_LOCAL_CHANGES",async(ev)=>{if(this.isDebugEdited){const props=this.props;ev.detail.proms.push(this.quickValidityCheck(props).then((isValid)=>{if(isValid){this.isDebugEdited=false;}else{this.state.isValid=false;this.state.recordCount=0;props.record.setInvalidField(props.name);}}));}});}
getContext(props=this.props){return props.context;}
getDomain(props=this.props){return props.record.data[props.name]||"[]";}
getEvaluatedDomain(props=this.props){const domainStringRepr=this.getDomain(props);const evalContext=this.getContext(props);try{const domain=new Domain(domainStringRepr).toList(evalContext);return domain;}catch(error){if(error instanceof InvalidDomainError||error instanceof EvaluationError){return{isInvalid:true};}
throw error;}}
getResModel(props=this.props){let resModel=props.resModel;if(props.record.fieldNames.includes(resModel)){resModel=props.record.data[resModel];}
return resModel;}
async addCondition(){const defaultDomain=await this.getDefaultLeafDomain(this.getResModel());this.update(defaultDomain);this.state.folded=false;}
async loadFacets(props=this.props){const resModel=this.getResModel(props);if(!resModel){this.state.facets=[];this.state.folded=false;return;}
if(typeof resModel!=="string"){throw new Error(`Invalid model: ${resModel}`);}
let promises=[];const domain=this.getDomain(props);try{const tree=treeFromDomain(domain,{distributeNot:!this.env.debug});const trees=!tree.negate&&tree.value==="&"?tree.children:[tree];promises=trees.map(async(tree)=>{const description=await this.getDomainTreeDescription(resModel,tree);return description;});}catch(error){if(error.data?.name==="builtins.KeyError"&&error.data.message===resModel){throw new Error(`Invalid model: ${resModel}`);}
this.state.facets=[];this.state.folded=false;}
this.state.facets=await Promise.all(promises);}
async checkProps(props=this.props){const resModel=this.getResModel(props);if(!resModel){this.updateState({});return;}
if(typeof resModel!=="string"){throw new Error(`Invalid model: ${resModel}`);}
const domain=this.getEvaluatedDomain(props);if(domain.isInvalid){this.updateState({isValid:false,recordCount:0});return;}
let recordCount;const context=this.getContext(props);try{recordCount=await this.orm.silent.searchCount(resModel,domain,{context});}catch(error){if(error.data?.name==="builtins.KeyError"&&error.data.message===resModel){throw new Error(`Invalid model: ${resModel}`);}
this.updateState({isValid:false,recordCount:0});return;}
this.updateState({isValid:true,recordCount});}
onButtonClick(){this.addDialog(SelectCreateDialog,{title:_t("Selected records"),noCreate:true,multiSelect:false,resModel:this.getResModel(),domain:this.getEvaluatedDomain(),context:this.getContext(),},{onClose:()=>this.checkProps(),});}
onEditDialogBtnClick(){this.addDialog(DomainSelectorDialog,{resModel:this.getResModel(),domain:this.getDomain(),isDebugMode:!!this.env.debug,onConfirm:this.update.bind(this),});}
async quickValidityCheck(props){const resModel=this.getResModel(props);if(!resModel){return false;}
const domain=this.getEvaluatedDomain(props);if(domain.isInvalid){return false;}
return this.rpc("/web/domain/validate",{model:resModel,domain});}
update(domain,isDebugEdited=false){this.isDebugEdited=isDebugEdited;return this.props.record.update({[this.props.name]:domain});}
fold(){this.state.folded=true;}
updateState(params={}){Object.assign(this.state,{isValid:"isValid"in params?params.isValid:null,recordCount:"recordCount"in params?params.recordCount:null,});}}
const domainField=__exports.domainField={component:DomainField,displayName:_t("Domain"),supportedOptions:[{label:_t("Edit in dialog"),name:"in_dialog",type:"boolean",},{label:_t("Foldable"),name:"foldable",type:"boolean",help:_t("Display the domain using facets"),},{label:_t("Model"),name:"model",type:"string",},],supportedTypes:["char"],isEmpty:()=>false,extractProps({options},dynamicInfo){return{editInDialog:options.in_dialog,isFoldable:options.foldable,resModel:options.model,context:dynamicInfo.context,};},};registry.category("fields").add("domain",domainField);return __exports;});;

/* /web/static/src/views/fields/dynamic_placeholder_hook.js */
odoo.define('@web/views/fields/dynamic_placeholder_hook',['@web/core/popover/popover_hook','@web/core/utils/hooks','@odoo/owl','@web/core/l10n/translation','@web/views/fields/dynamic_placeholder_popover'],function(require){'use strict';let __exports={};const{usePopover}=require("@web/core/popover/popover_hook");const{useService}=require("@web/core/utils/hooks");const{useComponent}=require("@odoo/owl");const{_t}=require("@web/core/l10n/translation");const{DynamicPlaceholderPopover}=require("@web/views/fields/dynamic_placeholder_popover");__exports.useDynamicPlaceholder=useDynamicPlaceholder;function useDynamicPlaceholder(elementRef){const TRIGGER_KEY="#";const ownerField=useComponent();const triggerKeyReplaceRegex=new RegExp(`${TRIGGER_KEY}$`);let closeCallback;let positionCallback;const popover=usePopover(DynamicPlaceholderPopover,{onClose:()=>closeCallback?.(),onPositioned:(popper,position)=>positionCallback?.(popper,position),});const notification=useService("notification");let model=null;const onDynamicPlaceholderValidate=function(path,defaultValue){const element=elementRef?.el;if(!element){return;}
let rangeIndex=parseInt(element.getAttribute("data-oe-dynamic-placeholder-range-index"));if(path){let dynamicPlaceholder="{{object."+path;dynamicPlaceholder+=defaultValue&&defaultValue!==""?` or '''${defaultValue}'''}}`:"}}";const baseValue=element.value;const splitedValue=[baseValue.slice(0,rangeIndex),baseValue.slice(rangeIndex)];const newValue=splitedValue[0].replace(triggerKeyReplaceRegex,"")+
dynamicPlaceholder+
splitedValue[1];const changes={[ownerField.props.name]:newValue};ownerField.props.record.update(changes);element.value=newValue;rangeIndex+=dynamicPlaceholder.length-1;element.setSelectionRange(rangeIndex,rangeIndex);element.removeAttribute("data-oe-dynamic-placeholder-range-index");}};const onDynamicPlaceholderClose=function(){elementRef?.el.focus();};async function open(opts){if(!model){return notification.add(_t("You need to select a model before opening the dynamic placeholder selector."),{type:"danger"});}
closeCallback=opts.closeCallback;positionCallback=opts.positionCallback;popover.open(elementRef?.el,{resModel:model,validate:opts.validateCallback,});}
async function onKeydown(ev){const element=elementRef?.el;if(ev.target===element&&ev.key===TRIGGER_KEY){const currentRangeIndex=element.selectionStart;element.setAttribute("data-oe-dynamic-placeholder-range-index",currentRangeIndex+1);await open({validateCallback:onDynamicPlaceholderValidate,closeCallback:onDynamicPlaceholderClose,});}}
function updateModel(model_name_location){const recordData=ownerField.props.record.data;model=recordData[model_name_location]||recordData.model;}
return{updateModel:updateModel,onKeydown:onKeydown,setElementRef:(er)=>(elementRef=er),open:open,};}
return __exports;});;

/* /web/static/src/views/fields/dynamic_placeholder_popover.js */
odoo.define('@web/views/fields/dynamic_placeholder_popover',['@web/core/utils/hooks','@web/core/model_field_selector/model_field_selector_popover','@odoo/owl'],function(require){'use strict';let __exports={};const{useAutofocus}=require("@web/core/utils/hooks");const{ModelFieldSelectorPopover}=require("@web/core/model_field_selector/model_field_selector_popover");const{Component,useState}=require("@odoo/owl");const DynamicPlaceholderPopover=__exports.DynamicPlaceholderPopover=class DynamicPlaceholderPopover extends Component{static template="web.DynamicPlaceholderPopover";static components={ModelFieldSelectorPopover,};static props=["resModel","validate","close"];setup(){useAutofocus();this.state=useState({path:"",isPathSelected:false,defaultValue:"",});}
filter(fieldDef){return!["one2many","boolean","many2many"].includes(fieldDef.type)&&fieldDef.searchable;}
closeFieldSelector(){if(this.state.path){this.state.isPathSelected=true;return;}
this.props.close();}
setPath(path){this.state.path=path;}
setDefaultValue(value){this.state.defaultValue=value;}
validate(){this.props.close();this.props.validate(this.state.path,this.state.defaultValue);}
async onInputKeydown(ev){switch(ev.key){case"Enter":{this.validate();break;}
case"Escape":{this.props.close();break;}}}}
return __exports;});;

/* /web/static/src/views/fields/dynamic_widget/dynamic_model_field_selector.js */
odoo.define('@web/views/fields/dynamic_widget/dynamic_model_field_selector',['@web/core/model_field_selector/model_field_selector'],function(require){'use strict';let __exports={};const{ModelFieldSelector}=require("@web/core/model_field_selector/model_field_selector");const DynamicModelFieldSelector=__exports.DynamicModelFieldSelector=class DynamicModelFieldSelector extends ModelFieldSelector{static props={...ModelFieldSelector.props,record:{type:Object,optional:true},recordProps:{type:Object,optional:true},};}
return __exports;});;

/* /web/static/src/views/fields/dynamic_widget/dynamic_model_field_selector_char.js */
odoo.define('@web/views/fields/dynamic_widget/dynamic_model_field_selector_char',['@web/views/fields/char/char_field','@web/core/registry','@web/views/utils','@web/views/fields/dynamic_widget/dynamic_model_field_selector','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{CharField,charField}=require("@web/views/fields/char/char_field");const{registry}=require("@web/core/registry");const{archParseBoolean}=require("@web/views/utils");const{DynamicModelFieldSelector}=require("@web/views/fields/dynamic_widget/dynamic_model_field_selector");const{_t}=require("@web/core/l10n/translation");const DynamicModelFieldSelectorChar=__exports.DynamicModelFieldSelectorChar=class DynamicModelFieldSelectorChar extends CharField{static components={...CharField.components,DynamicModelFieldSelector,};static props={...CharField.props,resModel:{type:String,optional:true},onlySearchable:{type:Boolean,optional:true},followRelations:{type:Boolean,optional:true},};async _onRecordUpdate(value){await this.props.record.update({[this.props.name]:value});}
get getSelectorProps(){return{path:this.props.record.data[this.props.name],resModel:this.getResModel(),readonly:this.props.readonly,record:this.props.record,recordProps:this.props,update:this._onRecordUpdate.bind(this),isDebugMode:!!this.env.debug,filter:this.filter.bind(this),followRelations:this.props.followRelations,};}
filter(fieldDef){return!this.props.onlySearchable||fieldDef.searchable;}
getResModel(props=this.props){const resModel=props.record.data[props.resModel];if(!resModel){return props.record.resModel;}
return resModel;}}
DynamicModelFieldSelectorChar.template="web.DynamicModelFieldSelectorChar";const dynamicModelFieldSelectorChar=__exports.dynamicModelFieldSelectorChar={...charField,component:DynamicModelFieldSelectorChar,supportedOptions:[{label:_t("Follow relations"),name:"follow_relations",type:"boolean",default:true,},{label:_t("Model"),name:"model",type:"string",},{label:_t("Only searchable"),name:"only_searchable",type:"string",},],extractProps({options},dynamicInfo){return{followRelations:options.follow_relations??true,onlySearchable:archParseBoolean(options.only_searchable),resModel:options.model,};},};registry.category("fields").add("DynamicModelFieldSelectorChar",dynamicModelFieldSelectorChar);return __exports;});;

/* /web/static/src/views/fields/email/email_field.js */
odoo.define('@web/views/fields/email/email_field',['@web/core/registry','@web/core/l10n/translation','@web/views/fields/input_field_hook','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{_t}=require("@web/core/l10n/translation");const{useInputField}=require("@web/views/fields/input_field_hook");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const EmailField=__exports.EmailField=class EmailField extends Component{static template="web.EmailField";static props={...standardFieldProps,placeholder:{type:String,optional:true},};setup(){useInputField({getValue:()=>this.props.record.data[this.props.name]||""});}}
const emailField=__exports.emailField={component:EmailField,displayName:_t("Email"),supportedTypes:["char"],extractProps:({attrs})=>({placeholder:attrs.placeholder,}),};registry.category("fields").add("email",emailField);class FormEmailField extends EmailField{static template="web.FormEmailField";}
const formEmailField=__exports.formEmailField={...emailField,component:FormEmailField,};registry.category("fields").add("form.email",formEmailField);return __exports;});;

/* /web/static/src/views/fields/field.js */
odoo.define('@web/views/fields/field',['@web/core/domain','@web/core/py_js/py','@web/core/registry','@web/core/ui/ui_service','@web/model/relational_model/utils','@web/views/utils','@web/views/fields/field_tooltip','@odoo/owl'],function(require){'use strict';let __exports={};const{Domain}=require("@web/core/domain");const{evaluateExpr,evaluateBooleanExpr}=require("@web/core/py_js/py");const{registry}=require("@web/core/registry");const{utils}=require("@web/core/ui/ui_service");const{getFieldContext}=require("@web/model/relational_model/utils");const{archParseBoolean,getClassNameFromDecoration,X2M_TYPES}=require("@web/views/utils");const{getTooltipInfo}=require("@web/views/fields/field_tooltip");const{Component,xml}=require("@odoo/owl");const isSmall=utils.isSmall;const viewRegistry=registry.category("views");const fieldRegistry=registry.category("fields");class DefaultField extends Component{}
DefaultField.template=xml``;__exports.getFieldFromRegistry=getFieldFromRegistry;function getFieldFromRegistry(fieldType,widget,viewType,jsClass){const prefixes=jsClass?[jsClass,viewType,""]:[viewType,""];const findInRegistry=(key)=>{for(const prefix of prefixes){const _key=prefix?`${prefix}.${key}`:key;if(fieldRegistry.contains(_key)){return fieldRegistry.get(_key);}}};if(widget){const field=findInRegistry(widget);if(field){return field;}
console.warn(`Missing widget: ${widget} for field of type ${fieldType}`);}
return findInRegistry(fieldType)||{component:DefaultField};}
__exports.fieldVisualFeedback=fieldVisualFeedback;function fieldVisualFeedback(field,record,fieldName,fieldInfo){const readonly=evaluateBooleanExpr(fieldInfo.readonly,record.evalContextWithVirtualIds);const required=evaluateBooleanExpr(fieldInfo.required,record.evalContextWithVirtualIds);const inEdit=record.isInEdition;let empty=!record.isNew;if("isEmpty"in field){empty=empty&&field.isEmpty(record,fieldName);}else{empty=empty&&!record.data[fieldName];}
empty=inEdit?empty&&readonly:empty;return{readonly,required,invalid:field.isValid?!field.isValid(record,fieldName,fieldInfo):record.isFieldInvalid(fieldName),empty,};}
__exports.getPropertyFieldInfo=getPropertyFieldInfo;function getPropertyFieldInfo(propertyField){const{name,relatedPropertyField,string,type}=propertyField;const fieldInfo={name,string,type,widget:type,options:{},column_invisible:"False",invisible:"False",readonly:"False",required:"False",attrs:{},relatedPropertyField,context:"{}",help:undefined,onChange:false,forceSave:false,decorations:{},};if(type==="many2one"||type==="many2many"){const{domain,relation}=propertyField;fieldInfo.relation=relation;fieldInfo.domain=domain;if(relation==="res.users"||relation==="res.partner"){fieldInfo.widget=propertyField.type==="many2one"?"many2one_avatar":"many2many_tags_avatar";}else{fieldInfo.widget=propertyField.type==="many2one"?type:"many2many_tags";}}else if(type==="tags"){fieldInfo.tags=propertyField.tags;fieldInfo.widget=`property_tags`;}else if(type==="selection"){fieldInfo.selection=propertyField.selection;}
fieldInfo.field=getFieldFromRegistry(propertyField.type,fieldInfo.widget);let{relatedFields}=fieldInfo.field;if(relatedFields){if(relatedFields instanceof Function){relatedFields=relatedFields({options:{},attrs:{}});}
fieldInfo.relatedFields=Object.fromEntries(relatedFields.map((f)=>[f.name,f]));}
return fieldInfo;}
__exports.getFieldDomain=getFieldDomain;function getFieldDomain(record,fieldName){const{domain}=record.fields[fieldName];return typeof domain==="string"?new Domain(evaluateExpr(domain,record.evalContext)).toList():domain||[];}
const Field=__exports.Field=class Field extends Component{setup(){if(this.props.fieldInfo){this.field=this.props.fieldInfo.field;}else{const fieldType=this.props.record.fields[this.props.name].type;this.field=getFieldFromRegistry(fieldType,this.props.type);}}
get classNames(){const{class:_class,fieldInfo,name,record}=this.props;const{readonly,required,invalid,empty}=fieldVisualFeedback(this.field,record,name,fieldInfo||{});const classNames={o_field_widget:true,o_readonly_modifier:readonly,o_required_modifier:required,o_field_invalid:invalid,o_field_empty:empty,[`o_field_${this.type}`]:true,[_class]:Boolean(_class),};if(this.field.additionalClasses){for(const cls of this.field.additionalClasses){classNames[cls]=true;}}
if(fieldInfo&&fieldInfo.decorations){const{decorations}=fieldInfo;for(const decoName in decorations){const value=evaluateBooleanExpr(decorations[decoName],record.evalContextWithVirtualIds);classNames[getClassNameFromDecoration(decoName)]=value;}}
return classNames;}
get type(){return this.props.type||this.props.record.fields[this.props.name].type;}
get fieldComponentProps(){const record=this.props.record;let readonly=this.props.readonly||false;let propsFromNode={};if(this.props.fieldInfo){let fieldInfo=this.props.fieldInfo;readonly=readonly||evaluateBooleanExpr(fieldInfo.readonly,record.evalContextWithVirtualIds);if(this.field.extractProps){if(this.props.attrs){fieldInfo={...fieldInfo,attrs:{...fieldInfo.attrs,...this.props.attrs},};}
const dynamicInfo={get context(){return getFieldContext(record,fieldInfo.name,fieldInfo.context);},domain(){if(fieldInfo.domain){return new Domain(evaluateExpr(fieldInfo.domain,record.evalContext)).toList();}
return getFieldDomain(record,fieldInfo.name);},required:evaluateBooleanExpr(fieldInfo.required,record.evalContextWithVirtualIds),readonly:readonly,};propsFromNode=this.field.extractProps(fieldInfo,dynamicInfo);}}
const props={...this.props};delete props.style;delete props.class;delete props.showTooltip;delete props.fieldInfo;delete props.attrs;delete props.type;delete props.readonly;return{readonly:readonly||!record.isInEdition||false,...propsFromNode,...props,};}
get tooltip(){if(this.props.showTooltip){const tooltip=getTooltipInfo({field:this.props.record.fields[this.props.name],fieldInfo:this.props.fieldInfo||{},});if(Boolean(odoo.debug)||(tooltip&&JSON.parse(tooltip).field.help)){return tooltip;}}
return false;}}
Field.template="web.Field";Field.parseFieldNode=function(node,models,modelName,viewType,jsClass){const name=node.getAttribute("name");const widget=node.getAttribute("widget");const fields=models[modelName];if(!fields[name]){throw new Error(`"${modelName}"."${name}" field is undefined.`);}
const field=getFieldFromRegistry(fields[name].type,widget,viewType,jsClass);const fieldInfo={name,type:fields[name].type,viewType,widget,field,context:"{}",string:fields[name].string,help:undefined,onChange:false,forceSave:false,options:{},decorations:{},attrs:{},domain:undefined,};for(const attr of["invisible","column_invisible","readonly","required"]){fieldInfo[attr]=node.getAttribute(attr);if(fieldInfo[attr]==="True"){if(attr==="column_invisible"){fieldInfo.invisible="True";}}else if(fieldInfo[attr]===null&&fields[name][attr]){fieldInfo[attr]="True";}}
for(const{name,value}of node.attributes){if(["name","widget"].includes(name)){continue;}
if(["context","string","help","domain"].includes(name)){fieldInfo[name]=value;}else if(name==="on_change"){fieldInfo.onChange=archParseBoolean(value);}else if(name==="options"){fieldInfo.options=evaluateExpr(value);}else if(name==="force_save"){fieldInfo.forceSave=archParseBoolean(value);}else if(name.startsWith("decoration-")){fieldInfo.decorations[name.replace("decoration-","")]=value;}else if(!name.startsWith("t-att")){fieldInfo.attrs[name]=value;}}
if(name==="id"){fieldInfo.readonly="True";}
if(widget==="handle"){fieldInfo.isHandle=true;}
if(X2M_TYPES.includes(fields[name].type)){const views={};let relatedFields=fieldInfo.field.relatedFields;if(relatedFields){if(relatedFields instanceof Function){relatedFields=relatedFields(fieldInfo);}
for(const relatedField of relatedFields){if(!("readonly"in relatedField)){relatedField.readonly=true;}}
relatedFields=Object.fromEntries(relatedFields.map((f)=>[f.name,f]));views.default={fieldNodes:relatedFields,fields:relatedFields};if(!fieldInfo.field.useSubView){fieldInfo.viewMode="default";}}
for(const child of node.children){const viewType=child.tagName==="tree"?"list":child.tagName;const{ArchParser}=viewRegistry.get(viewType);const childCopy=child.cloneNode(true);const archInfo=new ArchParser().parse(childCopy,models,fields[name].relation);views[viewType]={...archInfo,limit:archInfo.limit||40,fields:models[fields[name].relation],};}
let viewMode=node.getAttribute("mode");if(viewMode){if(viewMode.split(",").length!==1){viewMode=isSmall()?"kanban":"list";}else{viewMode=viewMode==="tree"?"list":viewMode;}}else{if(views.list&&!views.kanban){viewMode="list";}else if(!views.list&&views.kanban){viewMode="kanban";}else if(views.list&&views.kanban){viewMode=isSmall()?"kanban":"list";}}
if(viewMode){fieldInfo.viewMode=viewMode;}
if(Object.keys(views).length){fieldInfo.relatedFields=models[fields[name].relation];fieldInfo.views=views;}}
return fieldInfo;};Field.props=["fieldInfo?","*"];return __exports;});;

/* /web/static/src/views/fields/field_tooltip.js */
odoo.define('@web/views/fields/field_tooltip',[],function(require){'use strict';let __exports={};__exports.getTooltipInfo=getTooltipInfo;function getTooltipInfo(params){let widgetDescription=undefined;if(params.fieldInfo.widget){widgetDescription=params.fieldInfo.field.displayName;}
const info={viewMode:params.viewMode,resModel:params.resModel,debug:Boolean(odoo.debug),field:{name:params.field.name,help:params.fieldInfo.help??params.field.help,type:params.field.type,widget:params.fieldInfo.widget,widgetDescription,context:params.fieldInfo.context,domain:params.fieldInfo.domain||params.field.domain,invisible:params.fieldInfo.invisible,column_invisible:params.fieldInfo.column_invisible,readonly:params.fieldInfo.readonly,required:params.fieldInfo.required,changeDefault:params.field.change_default,relation:params.field.relation,selection:params.field.selection,default:params.field.default,},};return JSON.stringify(info);}
return __exports;});;

/* /web/static/src/views/fields/file_handler.js */
odoo.define('@web/views/fields/file_handler',['@web/core/l10n/translation','@web/core/utils/hooks','@web/core/utils/urls','@web/core/utils/files','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{useService}=require("@web/core/utils/hooks");const{getDataURLFromFile}=require("@web/core/utils/urls");const{checkFileSize}=require("@web/core/utils/files");const{Component,useRef,useState}=require("@odoo/owl");const FileUploader=__exports.FileUploader=class FileUploader extends Component{setup(){this.notification=useService("notification");this.fileInputRef=useRef("fileInput");this.state=useState({isUploading:false,});}
async onFileChange(ev){if(!ev.target.files.length){return;}
const{target}=ev;for(const file of ev.target.files){if(!checkFileSize(file.size,this.notification)){return null;}
this.state.isUploading=true;const data=await getDataURLFromFile(file);if(!file.size){console.warn(`Error while uploading file : ${file.name}`);this.notification.add(_t("There was a problem while uploading your file."),{type:"danger",});}
try{await this.props.onUploaded({name:file.name,size:file.size,type:file.type,data:data.split(",")[1],objectUrl:file.type==="application/pdf"?URL.createObjectURL(file):null,});}finally{this.state.isUploading=false;}}
target.value=null;if(this.props.multiUpload&&this.props.onUploadComplete){this.props.onUploadComplete({});}}
async onSelectFileButtonClick(ev){if(this.props.onClick){const ok=await this.props.onClick(ev);if(ok!==undefined&&!ok){return;}}
this.fileInputRef.el.click();}}
FileUploader.template="web.FileUploader";FileUploader.props={onClick:{type:Function,optional:true},onUploaded:Function,onUploadComplete:{type:Function,optional:true},multiUpload:{type:Boolean,optional:true},inputName:{type:String,optional:true},fileUploadClass:{type:String,optional:true},acceptedFileExtensions:{type:String,optional:true},slots:{type:Object,optional:true},showUploadingText:{type:Boolean,optional:true},};FileUploader.defaultProps={showUploadingText:true,};return __exports;});;

/* /web/static/src/views/fields/float/float_field.js */
odoo.define('@web/views/fields/float/float_field',['@web/core/l10n/translation','@web/core/registry','@web/views/fields/input_field_hook','@web/views/fields/numpad_decimal_hook','@web/views/fields/formatters','@web/views/fields/parsers','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useInputField}=require("@web/views/fields/input_field_hook");const{useNumpadDecimal}=require("@web/views/fields/numpad_decimal_hook");const{formatFloat}=require("@web/views/fields/formatters");const{parseFloat}=require("@web/views/fields/parsers");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component,useState}=require("@odoo/owl");const FloatField=__exports.FloatField=class FloatField extends Component{static template="web.FloatField";static props={...standardFieldProps,formatNumber:{type:Boolean,optional:true},inputType:{type:String,optional:true},step:{type:Number,optional:true},digits:{type:Array,optional:true},placeholder:{type:String,optional:true},humanReadable:{type:Boolean,optional:true},decimals:{type:Number,optional:true},};static defaultProps={formatNumber:true,inputType:"text",humanReadable:false,decimals:0,};setup(){this.state=useState({hasFocus:false,});this.inputRef=useInputField({getValue:()=>this.formattedValue,refName:"numpadDecimal",parse:(v)=>this.parse(v),});useNumpadDecimal();}
onFocusIn(){this.state.hasFocus=true;}
onFocusOut(){this.state.hasFocus=false;}
parse(value){return this.props.inputType==="number"?Number(value):parseFloat(value);}
get digits(){const fieldDigits=this.props.record.fields[this.props.name].digits;return!this.props.digits&&Array.isArray(fieldDigits)?fieldDigits:this.props.digits;}
get formattedValue(){if(!this.props.formatNumber||(this.props.inputType==="number"&&!this.props.readonly&&this.value)){return this.value;}
if(this.props.humanReadable&&!this.state.hasFocus){return formatFloat(this.value,{digits:this.digits,humanReadable:true,decimals:this.props.decimals,});}else{return formatFloat(this.value,{digits:this.digits,humanReadable:false});}}
get value(){return this.props.record.data[this.props.name];}}
const floatField=__exports.floatField={component:FloatField,displayName:_t("Float"),supportedOptions:[{label:_t("Format number"),name:"enable_formatting",type:"boolean",help:_t("Format the value according to your language setup - e.g. thousand separators, rounding, etc."),default:true,},{label:_t("Digits"),name:"digits",type:"digits",},{label:_t("Type"),name:"type",type:"string",},{label:_t("Step"),name:"step",type:"number",},{label:_t("User-friendly format"),name:"human_readable",type:"boolean",help:_t("Use a human readable format (e.g.: 500G instead of 500,000,000,000)."),},{label:_t("Decimals"),name:"decimals",type:"number",default:0,help:_t("Use it with the 'User-friendly format' option to customize the formatting."),},],supportedTypes:["float"],isEmpty:()=>false,extractProps:({attrs,options})=>{let digits;if(attrs.digits){digits=JSON.parse(attrs.digits);}else if(options.digits){digits=options.digits;}
return{formatNumber:options?.enable_formatting!==undefined?Boolean(options.enable_formatting):true,inputType:options.type,humanReadable:!!options.human_readable,step:options.step,digits,placeholder:attrs.placeholder,decimals:options.decimals||0,};},};registry.category("fields").add("float",floatField);return __exports;});;

/* /web/static/src/views/fields/float_factor/float_factor_field.js */
odoo.define('@web/views/fields/float_factor/float_factor_field',['@web/core/registry','@web/views/fields/float/float_field','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{floatField,FloatField}=require("@web/views/fields/float/float_field");const{_t}=require("@web/core/l10n/translation");const FloatFactorField=__exports.FloatFactorField=class FloatFactorField extends FloatField{static props={...FloatField.props,factor:{type:Number,optional:true},};static defaultProps={...FloatField.defaultProps,factor:1,};parse(value){return super.parse(value)/this.props.factor;}
get value(){return this.props.record.data[this.props.name]*this.props.factor;}}
const floatFactorField=__exports.floatFactorField={...floatField,component:FloatFactorField,supportedOptions:[...floatField.supportedOptions,{label:_t("Factor"),name:"factor",type:"number",},],extractProps({options}){const props=floatField.extractProps(...arguments);props.factor=options.factor;return props;},};registry.category("fields").add("float_factor",floatFactorField);return __exports;});;

/* /web/static/src/views/fields/float_time/float_time_field.js */
odoo.define('@web/views/fields/float_time/float_time_field',['@web/core/l10n/translation','@web/core/registry','@web/views/fields/formatters','@web/views/fields/parsers','@web/views/fields/input_field_hook','@web/views/fields/standard_field_props','@web/views/fields/numpad_decimal_hook','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{formatFloatTime}=require("@web/views/fields/formatters");const{parseFloatTime}=require("@web/views/fields/parsers");const{useInputField}=require("@web/views/fields/input_field_hook");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{useNumpadDecimal}=require("@web/views/fields/numpad_decimal_hook");const{Component}=require("@odoo/owl");const FloatTimeField=__exports.FloatTimeField=class FloatTimeField extends Component{static template="web.FloatTimeField";static props={...standardFieldProps,inputType:{type:String,optional:true},placeholder:{type:String,optional:true},displaySeconds:{type:Boolean,optional:true},};static defaultProps={inputType:"text",};setup(){useInputField({getValue:()=>this.formattedValue,refName:"numpadDecimal",parse:(v)=>parseFloatTime(v),});useNumpadDecimal();}
get formattedValue(){return formatFloatTime(this.props.record.data[this.props.name],{displaySeconds:this.props.displaySeconds,});}}
const floatTimeField=__exports.floatTimeField={component:FloatTimeField,displayName:_t("Time"),supportedOptions:[{label:_t("Display seconds"),name:"display_seconds",type:"boolean",},{label:_t("Type"),name:"type",type:"string",default:"text",},],supportedTypes:["float"],isEmpty:()=>false,extractProps:({attrs,options})=>({displaySeconds:options.displaySeconds,inputType:options.type,placeholder:attrs.placeholder,}),};registry.category("fields").add("float_time",floatTimeField);return __exports;});;

/* /web/static/src/views/fields/float_toggle/float_toggle_field.js */
odoo.define('@web/views/fields/float_toggle/float_toggle_field',['@web/core/l10n/translation','@web/core/registry','@web/views/fields/formatters','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{formatFloatFactor}=require("@web/views/fields/formatters");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const FloatToggleField=__exports.FloatToggleField=class FloatToggleField extends Component{static template="web.FloatToggleField";static props={...standardFieldProps,digits:{type:Array,optional:true},range:{type:Array,optional:true},factor:{type:Number,optional:true},disableReadOnly:{type:Boolean,optional:true},};static defaultProps={range:[0.0,0.5,1.0],factor:1,disableReadOnly:false,};onChange(){let currentIndex=this.props.range.indexOf(this.props.record.data[this.props.name]*this.factor);currentIndex++;if(currentIndex>this.props.range.length-1){currentIndex=0;}
this.props.record.update({[this.props.name]:this.props.range[currentIndex]/this.factor,});}
get factor(){return this.props.factor;}
get digits(){const fieldDigits=this.props.record.fields[this.props.name].digits;return!this.props.digits&&Array.isArray(fieldDigits)?fieldDigits:this.props.digits;}
get formattedValue(){return formatFloatFactor(this.props.record.data[this.props.name],{digits:this.digits,factor:this.factor,});}}
const floatToggleField=__exports.floatToggleField={component:FloatToggleField,supportedOptions:[{label:_t("Digits"),name:"digits",type:"digits",},{label:_t("Type"),name:"type",type:"string",},{label:_t("Range"),name:"range",type:"string",},{label:_t("Factor"),name:"factor",type:"number",},{label:_t("Disable readonly"),name:"force_button",type:"boolean",},],supportedTypes:["float"],isEmpty:()=>false,extractProps:({attrs,options})=>{let digits;if(attrs.digits){digits=JSON.parse(attrs.digits);}else if(options.digits){digits=options.digits;}
return{digits,range:options.range,factor:options.factor,disableReadOnly:options.force_button||false,};},};registry.category("fields").add("float_toggle",floatToggleField);return __exports;});;

/* /web/static/src/views/fields/font_selection/font_selection_field.js */
odoo.define('@web/views/fields/font_selection/font_selection_field',['@web/core/registry','@web/core/l10n/translation','@web/views/fields/standard_field_props','@web/views/fields/formatters','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{_t}=require("@web/core/l10n/translation");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{formatSelection}=require("@web/views/fields/formatters");const{Component}=require("@odoo/owl");const FontSelectionField=__exports.FontSelectionField=class FontSelectionField extends Component{static template="web.FontSelectionField";static props={...standardFieldProps,placeholder:{type:String,optional:true},required:{type:Boolean,optional:true},};get options(){return this.props.record.fields[this.props.name].selection.filter((option)=>option[0]!==false&&option[1]!=="");}
get string(){return formatSelection(this.props.record.data[this.props.name],{selection:this.options,});}
stringify(value){return JSON.stringify(value);}
onChange(ev){const value=JSON.parse(ev.target.value);this.props.record.update({[this.props.name]:value});}}
const fontSelectionField=__exports.fontSelectionField={component:FontSelectionField,displayName:_t("Font Selection"),supportedTypes:["selection"],extractProps({attrs},dynamicInfo){return{placeholder:attrs.placeholder,required:dynamicInfo.required,};},};registry.category("fields").add("font",fontSelectionField);return __exports;});;

/* /web/static/src/views/fields/gauge/gauge_field.js */
odoo.define('@web/views/fields/gauge/gauge_field',['@web/core/l10n/translation','@web/core/assets','@web/core/registry','@web/views/fields/formatters','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{loadBundle}=require("@web/core/assets");const{registry}=require("@web/core/registry");const{formatFloat}=require("@web/views/fields/formatters");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component,onWillStart,useEffect,useRef}=require("@odoo/owl");const GaugeField=__exports.GaugeField=class GaugeField extends Component{setup(){this.chart=null;this.canvasRef=useRef("canvas");onWillStart(async()=>await loadBundle("web.chartjs_lib"));useEffect(()=>{this.renderChart();return()=>{if(this.chart){this.chart.destroy();}};});}
get title(){return this.props.title||this.props.record.fields[this.props.name].string||"";}
get formattedValue(){return formatFloat(this.props.record.data[this.props.name],{humanReadable:true,decimals:1,});}
renderChart(){const gaugeValue=this.props.record.data[this.props.name];let maxValue=Math.max(gaugeValue,this.props.record.data[this.props.maxValueField]);let maxLabel=maxValue;if(gaugeValue===0&&maxValue===0){maxValue=1;maxLabel=0;}
const config={type:"doughnut",data:{datasets:[{data:[gaugeValue,maxValue-gaugeValue],backgroundColor:["#1f77b4","#dddddd"],label:this.title,},],},options:{circumference:180,rotation:270,responsive:true,maintainAspectRatio:false,cutout:"70%",layout:{padding:5,},plugins:{title:{display:true,text:this.title,padding:4,},tooltip:{displayColors:false,callbacks:{label:function(tooltipItem){if(tooltipItem.dataIndex===0){return _t("Value: ")+gaugeValue;}
return _t("Max: ")+maxLabel;},},},},aspectRatio:2,},};this.chart=new Chart(this.canvasRef.el,config);}}
GaugeField.template="web.GaugeField";GaugeField.props={...standardFieldProps,maxValueField:{type:String},title:{type:String,optional:true},};const gaugeField=__exports.gaugeField={component:GaugeField,supportedOptions:[{label:_t("Title"),name:"title",type:"string",},{label:_t("Max value field"),name:"max_value",type:"field",availableTypes:["integer","float"],},],extractProps:({options})=>({maxValueField:options.max_field,title:options.title,}),};registry.category("fields").add("gauge",gaugeField);return __exports;});;

/* /web/static/src/views/fields/handle/handle_field.js */
odoo.define('@web/views/fields/handle/handle_field',['@web/core/registry','@web/core/l10n/translation','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{_t}=require("@web/core/l10n/translation");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const HandleField=__exports.HandleField=class HandleField extends Component{static template="web.HandleField";static props={...standardFieldProps,};}
const handleField=__exports.handleField={component:HandleField,displayName:_t("Handle"),supportedTypes:["integer"],isEmpty:()=>false,};registry.category("fields").add("handle",handleField);return __exports;});;

/* /web/static/src/views/fields/html/html_field.js */
odoo.define('@web/views/fields/html/html_field',['@web/core/registry','@web/views/fields/text/text_field'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{TextField,textField}=require("@web/views/fields/text/text_field");const HtmlField=__exports.HtmlField=class HtmlField extends TextField{static template="web.HtmlField";}
const htmlField=__exports.htmlField={...textField,component:HtmlField,};registry.category("fields").add("html",htmlField);return __exports;});;

/* /web/static/src/views/fields/iframe_wrapper/iframe_wrapper_field.js */
odoo.define('@web/views/fields/iframe_wrapper/iframe_wrapper_field',['@web/core/registry','@web/core/l10n/translation','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{_t}=require("@web/core/l10n/translation");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component,useEffect,useRef}=require("@odoo/owl");const IframeWrapperField=__exports.IframeWrapperField=class IframeWrapperField extends Component{static template="web.IframeWrapperField";static props={...standardFieldProps,};setup(){this.iframeRef=useRef("iframe");useEffect((value)=>{const iframeDoc=this.iframeRef.el.contentDocument;iframeDoc.open();iframeDoc.write(value);iframeDoc.close();},()=>[this.props.record.data[this.props.name]]);}}
const iframeWrapperField=__exports.iframeWrapperField={component:IframeWrapperField,displayName:_t("Wrap raw html within an iframe"),supportedTypes:["text","html"],};registry.category("fields").add("iframe_wrapper",iframeWrapperField);return __exports;});;

/* /web/static/src/views/fields/image/image_field.js */
odoo.define('@web/views/fields/image/image_field',['@web/core/browser/feature_detection','@web/core/l10n/translation','@web/core/registry','@web/core/utils/hooks','@web/core/utils/urls','@web/core/utils/binary','@web/views/fields/file_handler','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{isMobileOS}=require("@web/core/browser/feature_detection");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{url}=require("@web/core/utils/urls");const{isBinarySize}=require("@web/core/utils/binary");const{FileUploader}=require("@web/views/fields/file_handler");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component,useState}=require("@odoo/owl");const{DateTime}=luxon;const fileTypeMagicWordMap=__exports.fileTypeMagicWordMap={"/":"jpg",R:"gif",i:"png",P:"svg+xml",U:"webp",};const placeholder="/web/static/img/placeholder.png";__exports.imageCacheKey=imageCacheKey;function imageCacheKey(value){if(value instanceof DateTime){return value.ts;}
return"";}
const ImageField=__exports.ImageField=class ImageField extends Component{static template="web.ImageField";static components={FileUploader,};static props={...standardFieldProps,enableZoom:{type:Boolean,optional:true},zoomDelay:{type:Number,optional:true},previewImage:{type:String,optional:true},acceptedFileExtensions:{type:String,optional:true},width:{type:Number,optional:true},height:{type:Number,optional:true},reload:{type:Boolean,optional:true},};static defaultProps={acceptedFileExtensions:"image/*",reload:true,};setup(){this.notification=useService("notification");this.orm=useService("orm");this.isMobile=isMobileOS();this.state=useState({isValid:true,});this.lastURL=undefined;}
get rawCacheKey(){return this.props.record.data.write_date;}
get sizeStyle(){let style="";if(this.props.width){style+=`max-width: ${this.props.width}px;`;if(!this.props.height){style+=`height: auto; max-height: 100%;`;}}
if(this.props.height){style+=`max-height: ${this.props.height}px;`;if(!this.props.width){style+=`width: auto; max-width: 100%;`;}}
return style;}
get hasTooltip(){return(this.props.enableZoom&&this.props.record.data[this.props.name]);}
get tooltipAttributes(){return{template:"web.ImageZoomTooltip",info:JSON.stringify({url:this.getUrl(this.props.name)}),};}
getUrl(previewFieldName){if(!this.props.reload&&this.lastURL){return this.lastURL;}
if(this.state.isValid&&this.props.record.data[this.props.name]){if(isBinarySize(this.props.record.data[this.props.name])){this.lastURL=url("/web/image",{model:this.props.record.resModel,id:this.props.record.resId,field:previewFieldName,unique:imageCacheKey(this.rawCacheKey),});}else{const magic=fileTypeMagicWordMap[this.props.record.data[this.props.name][0]]||"png";this.lastURL=`data:image/${magic};base64,${
                    this.props.record.data[this.props.name]
                }`;}
return this.lastURL;}
return placeholder;}
onFileRemove(){this.state.isValid=true;this.props.record.update({[this.props.name]:false});}
async onFileUploaded(info){this.state.isValid=true;if(info.type==="image/webp"){const image=document.createElement("img");image.src=`data:image/webp;base64,${info.data}`;await new Promise((resolve)=>image.addEventListener("load",resolve));const originalSize=Math.max(image.width,image.height);const smallerSizes=[1024,512,256,128].filter((size)=>size<originalSize);let referenceId=undefined;for(const size of[originalSize,...smallerSizes]){const ratio=size/originalSize;const canvas=document.createElement("canvas");canvas.width=image.width*ratio;canvas.height=image.height*ratio;const ctx=canvas.getContext("2d");ctx.fillStyle="rgb(255, 255, 255)";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(image,0,0,image.width,image.height,0,0,canvas.width,canvas.height);const[resizedId]=await this.orm.call("ir.attachment","create_unique",[[{name:info.name,description:size===originalSize?"":`resize: ${size}`,datas:size===originalSize?info.data:canvas.toDataURL("image/webp",0.75).split(",")[1],res_id:referenceId,res_model:"ir.attachment",mimetype:"image/webp",},],]);referenceId=referenceId||resizedId;await this.orm.call("ir.attachment","create_unique",[[{name:info.name.replace(/\.webp$/,".jpg"),description:"format: jpeg",datas:canvas.toDataURL("image/jpeg",0.75).split(",")[1],res_id:resizedId,res_model:"ir.attachment",mimetype:"image/jpeg",},],]);}}
this.props.record.update({[this.props.name]:info.data});}
onLoadFailed(){this.state.isValid=false;this.notification.add(_t("Could not display the selected image"),{type:"danger",});}}
const imageField=__exports.imageField={component:ImageField,displayName:_t("Image"),supportedOptions:[{label:_t("Reload"),name:"reload",type:"boolean",default:true,},{label:_t("Enable zoom"),name:"zoom",type:"boolean",},{label:_t("Zoom delay"),name:"zoom_delay",type:"number",help:_t("Delay the apparition of the zoomed image with a value in milliseconds"),},{label:_t("Accepted file extensions"),name:"accepted_file_extensions",type:"string",},{label:_t("Size"),name:"size",type:"selection",choices:[{label:_t("Small"),value:"[0,90]"},{label:_t("Medium"),value:"[0,180]"},{label:_t("Large"),value:"[0,270]"},],},{label:_t("Preview image"),name:"preview_image",type:"field",availableTypes:["binary"],},],supportedTypes:["binary"],fieldDependencies:[{name:"write_date",type:"datetime"}],isEmpty:()=>false,extractProps:({attrs,options})=>({enableZoom:options.zoom,zoomDelay:options.zoom_delay,previewImage:options.preview_image,acceptedFileExtensions:options.accepted_file_extensions,width:options.size&&Boolean(options.size[0])?options.size[0]:attrs.width,height:options.size&&Boolean(options.size[1])?options.size[1]:attrs.height,reload:"reload"in options?Boolean(options.reload):true,}),};registry.category("fields").add("image",imageField);return __exports;});;

/* /web/static/src/views/fields/image_url/image_url_field.js */
odoo.define('@web/views/fields/image_url/image_url_field',['@web/core/l10n/translation','@web/core/registry','@web/core/utils/hooks','@web/views/fields/standard_field_props','@odoo/owl','@web/model/relational_model/utils'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component,useState}=require("@odoo/owl");const{useRecordObserver}=require("@web/model/relational_model/utils");const ImageUrlField=__exports.ImageUrlField=class ImageUrlField extends Component{static template="web.ImageUrlField";static props={...standardFieldProps,width:{type:Number,optional:true},height:{type:Number,optional:true},};static fallbackSrc="/web/static/img/placeholder.png";setup(){this.notification=useService("notification");this.state=useState({src:this.props.record.data[this.props.name],});useRecordObserver((record)=>{this.state.src=record.data[this.props.name];});}
get sizeStyle(){let style="";if(this.props.width){style+=`max-width: ${this.props.width}px;`;}
if(this.props.height){style+=`max-height: ${this.props.height}px;`;}
return style;}
onLoadFailed(){this.state.src=this.constructor.fallbackSrc;this.notification.add(_t("Could not display the specified image url."),{type:"info",});}}
const imageUrlField=__exports.imageUrlField={component:ImageUrlField,displayName:_t("Image"),supportedOptions:[{label:_t("Size"),name:"size",type:"selection",choices:[{label:_t("Small"),value:"[0,90]"},{label:_t("Medium"),value:"[0,180]"},{label:_t("Large"),value:"[0,270]"},],},],supportedTypes:["char"],extractProps:({attrs,options})=>({width:options.size?options.size[0]:attrs.width,height:options.size?options.size[1]:attrs.height,}),};registry.category("fields").add("image_url",imageUrlField);return __exports;});;

/* /web/static/src/views/fields/input_field_hook.js */
odoo.define('@web/views/fields/input_field_hook',['@web/core/hotkeys/hotkey_service','@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{getActiveHotkey}=require("@web/core/hotkeys/hotkey_service");const{useBus}=require("@web/core/utils/hooks");const{useComponent,useEffect,useRef}=require("@odoo/owl");__exports.useInputField=useInputField;function useInputField(params){const inputRef=params.ref||useRef(params.refName||"input");const component=useComponent();let isDirty=false;let lastSetValue=null;let pendingUpdate=false;function onInput(ev){isDirty=ev.target.value!==lastSetValue;component.props.record.model.bus.trigger("FIELD_IS_DIRTY",isDirty);if(!component.props.record.isValid){component.props.record.resetFieldValidity(component.props.name);}}
async function onChange(ev){if(isDirty){isDirty=false;let isInvalid=false;let val=ev.target.value;if(params.parse){try{val=params.parse(val);}catch{component.props.record.setInvalidField(component.props.name);isInvalid=true;}}
if(!isInvalid){if(val!==component.props.record.data[component.props.name]){lastSetValue=inputRef.el.value;pendingUpdate=true;await component.props.record.update({[component.props.name]:val});pendingUpdate=false;component.props.record.model.bus.trigger("FIELD_IS_DIRTY",isDirty);}else{inputRef.el.value=params.getValue();}}}}
function onKeydown(ev){const hotkey=getActiveHotkey(ev);if(["enter","tab","shift+tab"].includes(hotkey)){commitChanges(false);}
if(params.preventLineBreaks&&["enter","shift+enter"].includes(hotkey)){ev.preventDefault();}}
useEffect((inputEl)=>{if(inputEl){inputEl.addEventListener("input",onInput);inputEl.addEventListener("change",onChange);inputEl.addEventListener("keydown",onKeydown);return()=>{inputEl.removeEventListener("input",onInput);inputEl.removeEventListener("change",onChange);inputEl.removeEventListener("keydown",onKeydown);};}},()=>[inputRef.el]);useEffect(()=>{const value=params.getValue();if(inputRef.el&&!isDirty&&!component.props.record.isFieldInvalid(component.props.name)){inputRef.el.value=value;lastSetValue=inputRef.el.value;}});const{model}=component.props.record;useBus(model.bus,"WILL_SAVE_URGENTLY",()=>commitChanges(true));useBus(model.bus,"NEED_LOCAL_CHANGES",(ev)=>ev.detail.proms.push(commitChanges()));async function commitChanges(urgent){if(!inputRef.el){return;}
isDirty=inputRef.el.value!==lastSetValue;if(isDirty||(urgent&&pendingUpdate)){let isInvalid=false;isDirty=false;let val=inputRef.el.value;if(params.parse){try{val=params.parse(val);}catch{isInvalid=true;if(urgent){return;}else{component.props.record.setInvalidField(component.props.name);}}}
if(isInvalid){return;}
if((val||false)!==(component.props.record.data[component.props.name]||false)){lastSetValue=inputRef.el.value;await component.props.record.update({[component.props.name]:val});component.props.record.model.bus.trigger("FIELD_IS_DIRTY",false);}else{inputRef.el.value=params.getValue();}}}
return inputRef;}
return __exports;});;

/* /web/static/src/views/fields/integer/integer_field.js */
odoo.define('@web/views/fields/integer/integer_field',['@web/core/l10n/translation','@web/core/registry','@web/views/fields/formatters','@web/views/fields/parsers','@web/views/fields/input_field_hook','@web/views/fields/standard_field_props','@web/views/fields/numpad_decimal_hook','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{formatInteger}=require("@web/views/fields/formatters");const{parseInteger}=require("@web/views/fields/parsers");const{useInputField}=require("@web/views/fields/input_field_hook");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{useNumpadDecimal}=require("@web/views/fields/numpad_decimal_hook");const{Component,useState}=require("@odoo/owl");const IntegerField=__exports.IntegerField=class IntegerField extends Component{static template="web.IntegerField";static props={...standardFieldProps,formatNumber:{type:Boolean,optional:true},humanReadable:{type:Boolean,optional:true},decimals:{type:Number,optional:true},inputType:{type:String,optional:true},step:{type:Number,optional:true},placeholder:{type:String,optional:true},};static defaultProps={formatNumber:true,humanReadable:false,inputType:"text",decimals:0,};setup(){this.state=useState({hasFocus:false,});useInputField({getValue:()=>this.formattedValue,refName:"numpadDecimal",parse:(v)=>parseInteger(v),});useNumpadDecimal();}
onFocusIn(){this.state.hasFocus=true;}
onFocusOut(){this.state.hasFocus=false;}
get formattedValue(){if(!this.props.formatNumber||(!this.props.readonly&&this.props.inputType==="number")){return this.value;}
if(this.props.humanReadable&&!this.state.hasFocus){return formatInteger(this.value,{humanReadable:true,decimals:this.props.decimals,});}else{return formatInteger(this.value,{humanReadable:false});}}
get value(){return this.props.record.data[this.props.name];}}
const integerField=__exports.integerField={component:IntegerField,displayName:_t("Integer"),supportedOptions:[{label:_t("Format number"),name:"enable_formatting",type:"boolean",help:_t("Format the valueaccording to your language setup - e.g. thousand separators, rounding, etc."),default:true,},{label:_t("Type"),name:"type",type:"string",},{label:_t("Step"),name:"step",type:"number",},{label:_t("User-friendly format"),name:"human_readable",type:"boolean",help:_t("Use a human readable format (e.g.: 500G instead of 500,000,000,000)."),},{label:_t("Decimals"),name:"decimals",type:"number",default:0,help:_t("Use it with the 'User-friendly format' option to customize the formatting."),},],supportedTypes:["integer"],isEmpty:(record,fieldName)=>record.data[fieldName]===false,extractProps:({attrs,options})=>({formatNumber:options?.enable_formatting!==undefined?Boolean(options.enable_formatting):true,humanReadable:!!options.human_readable,inputType:options.type,step:options.step,placeholder:attrs.placeholder,decimals:options.decimals||0,}),};registry.category("fields").add("integer",integerField);return __exports;});;

/* /web/static/src/views/fields/journal_dashboard_graph/journal_dashboard_graph_field.js */
odoo.define('@web/views/fields/journal_dashboard_graph/journal_dashboard_graph_field',['@web/core/assets','@web/core/registry','@web/core/colors/colors','@web/views/fields/standard_field_props','@odoo/owl','@web/core/browser/cookie'],function(require){'use strict';let __exports={};const{loadBundle}=require("@web/core/assets");const{registry}=require("@web/core/registry");const{getColor,hexToRGBA}=require("@web/core/colors/colors");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component,onWillStart,useEffect,useRef}=require("@odoo/owl");const{cookie}=require("@web/core/browser/cookie");const JournalDashboardGraphField=__exports.JournalDashboardGraphField=class JournalDashboardGraphField extends Component{static template="web.JournalDashboardGraphField";static props={...standardFieldProps,graphType:String,};setup(){this.chart=null;this.canvasRef=useRef("canvas");this.data=JSON.parse(this.props.record.data[this.props.name]);onWillStart(async()=>await loadBundle("web.chartjs_lib"));useEffect(()=>{this.renderChart();return()=>{if(this.chart){this.chart.destroy();}};});}
renderChart(){if(this.chart){this.chart.destroy();}
let config;if(this.props.graphType==="line"){config=this.getLineChartConfig();}else if(this.props.graphType==="bar"){config=this.getBarChartConfig();}
this.chart=new Chart(this.canvasRef.el,config);}
getLineChartConfig(){const labels=this.data[0].values.map(function(pt){return pt.x;});const color10=getColor(10,cookie.get("color_scheme"));const borderColor=this.data[0].is_sample_data?hexToRGBA(color10,0.1):color10;const backgroundColor=this.data[0].is_sample_data?hexToRGBA(color10,0.05):hexToRGBA(color10,0.2);return{type:"line",data:{labels,datasets:[{backgroundColor,borderColor,data:this.data[0].values,fill:"start",label:this.data[0].key,borderWidth:2,},],},options:{plugins:{legend:{display:false},tooltip:{intersect:false,position:"nearest",caretSize:0,},},scales:{y:{display:false,},x:{display:false,},},maintainAspectRatio:false,elements:{line:{tension:0.000001,},},},};}
getBarChartConfig(){const data=[];const labels=[];const backgroundColor=[];const color13=getColor(13,cookie.get("color_scheme"));const color19=getColor(19,cookie.get("color_scheme"));this.data[0].values.forEach((pt)=>{data.push(pt.value);labels.push(pt.label);if(pt.type==="past"){backgroundColor.push(color13);}else if(pt.type==="future"){backgroundColor.push(color19);}else{backgroundColor.push("#ebebeb");}});return{type:"bar",data:{labels,datasets:[{backgroundColor,data,fill:"start",label:this.data[0].key,},],},options:{plugins:{legend:{display:false},tooltip:{intersect:false,position:"nearest",caretSize:0,},},scales:{y:{display:false,},},maintainAspectRatio:false,elements:{line:{tension:0.000001,},},},};}}
const journalDashboardGraphField=__exports.journalDashboardGraphField={component:JournalDashboardGraphField,supportedTypes:["text"],extractProps:({attrs})=>({graphType:attrs.graph_type,}),};registry.category("fields").add("dashboard_graph",journalDashboardGraphField);return __exports;});;

/* /web/static/src/views/fields/jsonb/jsonb.js */
odoo.define('@web/views/fields/jsonb/jsonb',['@web/core/l10n/translation','@web/core/registry','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const JsonField=__exports.JsonField=class JsonField extends Component{static template="web.JsonbField";static props={...standardFieldProps,};get formattedValue(){const value=this.props.record.data[this.props.name];return value?JSON.stringify(value):"";}}
const jsonField=__exports.jsonField={component:JsonField,displayName:_t("Json"),supportedTypes:["jsonb"],};registry.category("fields").add("jsonb",jsonField);return __exports;});;

/* /web/static/src/views/fields/label_selection/label_selection_field.js */
odoo.define('@web/views/fields/label_selection/label_selection_field',['@web/core/registry','@web/core/l10n/translation','@web/views/fields/standard_field_props','@web/views/fields/formatters','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{_t}=require("@web/core/l10n/translation");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{formatSelection}=require("@web/views/fields/formatters");const{Component}=require("@odoo/owl");const LabelSelectionField=__exports.LabelSelectionField=class LabelSelectionField extends Component{static template="web.LabelSelectionField";static props={...standardFieldProps,classesObj:{type:Object,optional:true},};static defaultProps={classesObj:{},};get className(){return this.props.classesObj[this.props.record.data[this.props.name]]||"primary";}
get string(){return formatSelection(this.props.record.data[this.props.name],{selection:Array.from(this.props.record.fields[this.props.name].selection),});}}
const labelSelectionField=__exports.labelSelectionField={component:LabelSelectionField,displayName:_t("Label Selection"),supportedOptions:[{label:_t("Classes"),name:"classes",type:"string",},],supportedTypes:["selection"],extractProps:({options})=>({classesObj:options.classes,}),};registry.category("fields").add("label_selection",labelSelectionField);return __exports;});;

/* /web/static/src/views/fields/many2many_binary/many2many_binary_field.js */
odoo.define('@web/views/fields/many2many_binary/many2many_binary_field',['@web/core/l10n/translation','@web/core/registry','@web/core/utils/hooks','@web/views/fields/standard_field_props','@web/core/file_input/file_input','@web/views/fields/relational_utils','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{FileInput}=require("@web/core/file_input/file_input");const{useX2ManyCrud}=require("@web/views/fields/relational_utils");const{Component}=require("@odoo/owl");const Many2ManyBinaryField=__exports.Many2ManyBinaryField=class Many2ManyBinaryField extends Component{static template="web.Many2ManyBinaryField";static components={FileInput,};static props={...standardFieldProps,acceptedFileExtensions:{type:String,optional:true},className:{type:String,optional:true},numberOfFiles:{type:Number,optional:true},};setup(){this.orm=useService("orm");this.notification=useService("notification");this.operations=useX2ManyCrud(()=>this.props.record.data[this.props.name],true);}
get uploadText(){return this.props.record.fields[this.props.name].string;}
get files(){return this.props.record.data[this.props.name].records.map((record)=>{return{...record.data,id:record.resId,};});}
getUrl(id){return"/web/content/"+id+"?download=true";}
getExtension(file){return file.name.replace(/^.*\./,"");}
async onFileUploaded(files){for(const file of files){if(file.error){return this.notification.add(file.error,{title:_t("Uploading error"),type:"danger",});}
await this.operations.saveRecord([file.id]);}}
async onFileRemove(deleteId){const record=this.props.record.data[this.props.name].records.find((record)=>record.resId===deleteId);this.operations.removeRecord(record);}}
const many2ManyBinaryField=__exports.many2ManyBinaryField={component:Many2ManyBinaryField,supportedOptions:[{label:_t("Accepted file extensions"),name:"accepted_file_extensions",type:"string",},{label:_t("Number of files"),name:"number_of_files",type:"integer",},],supportedTypes:["many2many"],isEmpty:()=>false,relatedFields:[{name:"name",type:"char"},{name:"mimetype",type:"char"},],extractProps:({attrs,options})=>({acceptedFileExtensions:options.accepted_file_extensions,className:attrs.class,numberOfFiles:options.number_of_files,}),};registry.category("fields").add("many2many_binary",many2ManyBinaryField);return __exports;});;

/* /web/static/src/views/fields/many2many_checkboxes/many2many_checkboxes_field.js */
odoo.define('@web/views/fields/many2many_checkboxes/many2many_checkboxes_field',['@odoo/owl','@web/core/checkbox/checkbox','@web/core/l10n/translation','@web/core/registry','@web/core/utils/hooks','@web/core/utils/timing','@web/views/fields/relational_utils','@web/views/fields/standard_field_props'],function(require){'use strict';let __exports={};const{Component,onWillUnmount}=require("@odoo/owl");const{CheckBox}=require("@web/core/checkbox/checkbox");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useBus}=require("@web/core/utils/hooks");const{debounce}=require("@web/core/utils/timing");const{useSpecialData}=require("@web/views/fields/relational_utils");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const Many2ManyCheckboxesField=__exports.Many2ManyCheckboxesField=class Many2ManyCheckboxesField extends Component{static template="web.Many2ManyCheckboxesField";static components={CheckBox};static props={...standardFieldProps,domain:{type:Array,optional:true},};setup(){this.specialData=useSpecialData((orm,props)=>{const{relation}=props.record.fields[props.name];return orm.call(relation,"name_search",["",props.domain]);});this.idsToAdd=new Set();this.idsToRemove=new Set();this.debouncedCommitChanges=debounce(this.commitChanges.bind(this),500);useBus(this.props.record.model.bus,"NEED_LOCAL_CHANGES",this.commitChanges.bind(this));onWillUnmount(this.commitChanges.bind(this));}
get items(){return this.specialData.data;}
isSelected(item){return this.props.record.data[this.props.name].currentIds.includes(item[0]);}
commitChanges(){if(this.idsToAdd.size===0&&this.idsToRemove.size===0){return;}
const result=this.props.record.data[this.props.name].addAndRemove({add:[...this.idsToAdd],remove:[...this.idsToRemove],});this.idsToAdd.clear();this.idsToRemove.clear();return result;}
onChange(resId,checked){if(checked){if(this.idsToRemove.has(resId)){this.idsToRemove.delete(resId);}else{this.idsToAdd.add(resId);}}else{if(this.idsToAdd.has(resId)){this.idsToAdd.delete(resId);}else{this.idsToRemove.add(resId);}}
this.debouncedCommitChanges();}}
const many2ManyCheckboxesField=__exports.many2ManyCheckboxesField={component:Many2ManyCheckboxesField,displayName:_t("Checkboxes"),supportedTypes:["many2many"],isEmpty:()=>false,extractProps(fieldInfo,dynamicInfo){return{domain:dynamicInfo.domain(),};},};registry.category("fields").add("many2many_checkboxes",many2ManyCheckboxesField);__exports.preloadMany2ManyCheckboxes=preloadMany2ManyCheckboxes;function preloadMany2ManyCheckboxes(orm,record,fieldName,{domain}){const field=record.fields[fieldName];return orm.call(field.relation,"name_search",["",domain]);}
return __exports;});;

/* /web/static/src/views/fields/many2many_tags/kanban_many2many_tags_field.js */
odoo.define('@web/views/fields/many2many_tags/kanban_many2many_tags_field',['@web/core/registry','@web/views/fields/many2many_tags/many2many_tags_field'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{Many2ManyTagsField,many2ManyTagsField}=require("@web/views/fields/many2many_tags/many2many_tags_field");const KanbanMany2ManyTagsField=__exports.KanbanMany2ManyTagsField=class KanbanMany2ManyTagsField extends Many2ManyTagsField{static template="web.KanbanMany2ManyTagsField";get tags(){return super.tags.reduce((kanbanTags,tag)=>{if(tag.colorIndex!==0){delete tag.onClick;kanbanTags.push(tag);}
return kanbanTags;},[]);}}
const kanbanMany2ManyTagsField=__exports.kanbanMany2ManyTagsField={...many2ManyTagsField,component:KanbanMany2ManyTagsField,};registry.category("fields").add("kanban.many2many_tags",kanbanMany2ManyTagsField);return __exports;});;

/* /web/static/src/views/fields/many2many_tags/many2many_tags_field.js */
odoo.define('@web/views/fields/many2many_tags/many2many_tags_field',['@web/core/l10n/translation','@web/core/checkbox/checkbox','@web/core/colorlist/colorlist','@web/core/domain','@web/core/py_js/py','@web/views/fields/relational_utils','@web/core/registry','@web/views/fields/standard_field_props','@web/core/tags_list/tags_list','@web/core/popover/popover_hook','@web/core/utils/hooks','@web/core/record_selectors/tag_navigation_hook','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{CheckBox}=require("@web/core/checkbox/checkbox");const{ColorList}=require("@web/core/colorlist/colorlist");const{Domain}=require("@web/core/domain");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{Many2XAutocomplete,useActiveActions,useX2ManyCrud,}=require("@web/views/fields/relational_utils");const{registry}=require("@web/core/registry");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{TagsList}=require("@web/core/tags_list/tags_list");const{usePopover}=require("@web/core/popover/popover_hook");const{useService}=require("@web/core/utils/hooks");const{useTagNavigation}=require("@web/core/record_selectors/tag_navigation_hook");const{Component,useRef}=require("@odoo/owl");class Many2ManyTagsFieldColorListPopover extends Component{static template="web.Many2ManyTagsFieldColorListPopover";static components={CheckBox,ColorList,};}
const Many2ManyTagsField=__exports.Many2ManyTagsField=class Many2ManyTagsField extends Component{static template="web.Many2ManyTagsField";static components={TagsList,Many2XAutocomplete,};static props={...standardFieldProps,canCreate:{type:Boolean,optional:true},canQuickCreate:{type:Boolean,optional:true},canCreateEdit:{type:Boolean,optional:true},colorField:{type:String,optional:true},createDomain:{type:[Array,Boolean],optional:true},domain:{type:[Array,Function],optional:true},context:{type:Object,optional:true},placeholder:{type:String,optional:true},nameCreateField:{type:String,optional:true},string:{type:String,optional:true},noSearchMore:{type:Boolean,optional:true},};static defaultProps={canCreate:true,canQuickCreate:true,canCreateEdit:true,nameCreateField:"name",context:{},};static RECORD_COLORS=[1,2,3,4,5,6,7,8,9,10,11];static SEARCH_MORE_LIMIT=320;setup(){this.orm=useService("orm");this.previousColorsMap={};this.popover=usePopover(this.constructor.components.Popover);this.dialog=useService("dialog");this.dialogClose=[];this.onTagKeydown=useTagNavigation("many2ManyTagsField",this.deleteTagByIndex.bind(this));this.autoCompleteRef=useRef("autoComplete");const{saveRecord,removeRecord}=useX2ManyCrud(()=>this.props.record.data[this.props.name],true);this.activeActions=useActiveActions({fieldType:"many2many",crudOptions:{create:this.props.canCreate&&this.props.createDomain,createEdit:this.props.canCreateEdit,onDelete:removeRecord,},getEvalParams:(props)=>{return{evalContext:this.evalContext,readonly:props.readonly,};},});this.update=(recordlist)=>{if(!recordlist){return;}
if(Array.isArray(recordlist)){const resIds=recordlist.map((rec)=>rec.id);return saveRecord(resIds);}
return saveRecord(recordlist);};if(this.props.canQuickCreate){this.quickCreate=async(name)=>{const created=await this.orm.call(this.relation,"name_create",[name],{context:this.props.context,});return saveRecord([created[0]]);};}}
get relation(){return this.props.record.fields[this.props.name].relation;}
get evalContext(){return this.props.record.evalContext;}
get string(){return this.props.string||this.props.record.fields[this.props.name].string||"";}
getTagProps(record){return{id:record.id,resId:record.resId,text:record.data.display_name,colorIndex:record.data[this.props.colorField],onDelete:!this.props.readonly?()=>this.deleteTag(record.id):undefined,onKeydown:(ev)=>{if(this.props.readonly){return;}
this.onTagKeydown(ev);},};}
get tags(){return this.props.record.data[this.props.name].records.map((record)=>this.getTagProps(record));}
get showM2OSelectionField(){return!this.props.readonly;}
async deleteTagByIndex(index){const{id}=this.tags[index]||{};this.deleteTag(id);}
async deleteTag(id){const tagRecord=this.props.record.data[this.props.name].records.find((record)=>record.id===id);await this.props.record.data[this.props.name].forget(tagRecord);}
getDomain(){const domain=typeof this.props.domain==="function"?this.props.domain():this.props.domain;const currentIds=this.props.record.data[this.props.name].currentIds.filter((id)=>typeof id==="number");return Domain.and([domain,Domain.not([["id","in",currentIds]])]).toList(this.props.context);}}
const many2ManyTagsField=__exports.many2ManyTagsField={component:Many2ManyTagsField,displayName:_t("Tags"),supportedOptions:[{label:_t("Disable creation"),name:"no_create",type:"boolean",help:_t("If checked, users won't be able to create records through the autocomplete dropdown at all."),},{label:_t("Disable 'Create' option"),name:"no_quick_create",type:"boolean",help:_t("If checked, users will not be able to create records based on the text input; they will still be able to create records via a popup form."),},{label:_t("Disable 'Create and Edit' option"),name:"no_create_edit",type:"boolean",help:_t("If checked, users will not be able to create records based through a popup form; they will still be able to create records based on the text input."),},{label:_t("Can create"),name:"create",type:"string",help:_t("Write a domain to allow the creation of records conditionnally."),},{label:_t("Color field"),name:"color_field",type:"field",availableTypes:["integer"],help:_t("Set an integer field to use colors with the tags."),},],supportedTypes:["many2many"],relatedFields:({options})=>{const relatedFields=[{name:"display_name",type:"char"}];if(options.color_field){relatedFields.push({name:options.color_field,type:"integer",readonly:false});}
return relatedFields;},extractProps({attrs,options,string},dynamicInfo){const hasCreatePermission=attrs.can_create?evaluateBooleanExpr(attrs.can_create):true;const noCreate=Boolean(options.no_create);const canCreate=noCreate?false:hasCreatePermission;const noQuickCreate=Boolean(options.no_quick_create);const noCreateEdit=Boolean(options.no_create_edit);return{colorField:options.color_field,nameCreateField:options.create_name_field,canCreate,canQuickCreate:canCreate&&!noQuickCreate,canCreateEdit:canCreate&&!noCreateEdit,createDomain:options.create,context:dynamicInfo.context,domain:dynamicInfo.domain,placeholder:attrs.placeholder,string,};},};registry.category("fields").add("many2many_tags",many2ManyTagsField);registry.category("fields").add("calendar.one2many",many2ManyTagsField);registry.category("fields").add("calendar.many2many",many2ManyTagsField);const Many2ManyTagsFieldColorEditable=__exports.Many2ManyTagsFieldColorEditable=class Many2ManyTagsFieldColorEditable extends Many2ManyTagsField{static components={...super.components,Popover:Many2ManyTagsFieldColorListPopover,};static props={...super.props,canEditColor:{type:Boolean,optional:true},};static defaultProps={...super.defaultProps,canEditColor:true,};getTagProps(record){const props=super.getTagProps(record);props.onClick=(ev)=>this.onBadgeClick(ev,record);return props;}
onBadgeClick(ev,record){if(!this.props.canEditColor){return;}
if(this.popover.isOpen){this.popover.close();}else{this.popover.open(ev.currentTarget,{colors:this.constructor.RECORD_COLORS,tag:{id:record.id,colorIndex:record.data[this.props.colorField],},switchTagColor:this.switchTagColor.bind(this),onTagVisibilityChange:this.onTagVisibilityChange.bind(this),});}}
onTagVisibilityChange(isHidden,tag){const tagRecord=this.props.record.data[this.props.name].records.find((record)=>record.id===tag.id);if(tagRecord.data[this.props.colorField]!=0){this.previousColorsMap[tagRecord.resId]=tagRecord.data[this.props.colorField];}
const changes={[this.props.colorField]:isHidden?0:this.previousColorsMap[tagRecord.resId]||1,};tagRecord.update(changes,{save:true});this.popover.close();}
switchTagColor(colorIndex,tag){const tagRecord=this.props.record.data[this.props.name].records.find((record)=>record.id===tag.id);tagRecord.update({[this.props.colorField]:colorIndex},{save:true});this.popover.close();}}
const many2ManyTagsFieldColorEditable=__exports.many2ManyTagsFieldColorEditable={...many2ManyTagsField,component:Many2ManyTagsFieldColorEditable,supportedOptions:[...many2ManyTagsField.supportedOptions,{label:_t("Prevent color edition"),name:"no_edit_color",type:"boolean",},],extractProps({options}){const props=many2ManyTagsField.extractProps(...arguments);props.canEditColor=!options.no_edit_color&&!!options.color_field;return props;},};registry.category("fields").add("form.many2many_tags",many2ManyTagsFieldColorEditable);return __exports;});;

/* /web/static/src/views/fields/many2many_tags_avatar/many2many_tags_avatar_field.js */
odoo.define('@web/views/fields/many2many_tags_avatar/many2many_tags_avatar_field',['@web/core/l10n/translation','@web/core/popover/popover_hook','@web/core/registry','@web/views/fields/many2many_tags/many2many_tags_field','@web/core/tags_list/tags_list','@web/views/fields/relational_utils'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{usePopover}=require("@web/core/popover/popover_hook");const{registry}=require("@web/core/registry");const{many2ManyTagsField,Many2ManyTagsField,}=require("@web/views/fields/many2many_tags/many2many_tags_field");const{TagsList}=require("@web/core/tags_list/tags_list");const{AvatarMany2XAutocomplete}=require("@web/views/fields/relational_utils");const Many2ManyTagsAvatarField=__exports.Many2ManyTagsAvatarField=class Many2ManyTagsAvatarField extends Many2ManyTagsField{static template="web.Many2ManyTagsAvatarField";static components={Many2XAutocomplete:AvatarMany2XAutocomplete,TagsList,};static props={...Many2ManyTagsField.props,withCommand:{type:Boolean,optional:true},};getTagProps(record){return{...super.getTagProps(record),img:`/web/image/${this.relation}/${record.resId}/avatar_128`,};}}
const many2ManyTagsAvatarField=__exports.many2ManyTagsAvatarField={...many2ManyTagsField,component:Many2ManyTagsAvatarField,extractProps({viewType},dynamicInfo){const props=many2ManyTagsField.extractProps(...arguments);props.withCommand=viewType==="form"||viewType==="list";props.domain=dynamicInfo.domain;return props;},};registry.category("fields").add("many2many_tags_avatar",many2ManyTagsAvatarField);const ListMany2ManyTagsAvatarField=__exports.ListMany2ManyTagsAvatarField=class ListMany2ManyTagsAvatarField extends Many2ManyTagsAvatarField{itemsVisible=5;}
const listMany2ManyTagsAvatarField=__exports.listMany2ManyTagsAvatarField={...many2ManyTagsAvatarField,component:ListMany2ManyTagsAvatarField,};registry.category("fields").add("list.many2many_tags_avatar",listMany2ManyTagsAvatarField);const Many2ManyTagsAvatarFieldPopover=__exports.Many2ManyTagsAvatarFieldPopover=class Many2ManyTagsAvatarFieldPopover extends Many2ManyTagsAvatarField{static template="web.Many2ManyTagsAvatarFieldPopover";static props={...Many2ManyTagsAvatarField.props,close:{type:Function},};setup(){super.setup();const originalUpdate=this.update;this.update=async(recordList)=>{await originalUpdate(recordList);await this._saveUpdate();};}
async deleteTag(id){await super.deleteTag(id);await this._saveUpdate();}
async _saveUpdate(){await this.props.record.save({reload:false});this.render();this.autoCompleteRef.el?.querySelector("input")?.click();}
get tags(){return super.tags.reverse();}}
const many2ManyTagsAvatarFieldPopover=__exports.many2ManyTagsAvatarFieldPopover={...many2ManyTagsAvatarField,component:Many2ManyTagsAvatarFieldPopover,};registry.category("fields").add("many2many_tags_avatar_popover",many2ManyTagsAvatarFieldPopover);const KanbanMany2ManyTagsAvatarFieldTagsList=__exports.KanbanMany2ManyTagsAvatarFieldTagsList=class KanbanMany2ManyTagsAvatarFieldTagsList extends TagsList{static template="web.KanbanMany2ManyTagsAvatarFieldTagsList";static props={...TagsList.props,popoverProps:{type:Object},readonly:{type:Boolean,optional:true},};setup(){super.setup();this.popover=usePopover(Many2ManyTagsAvatarFieldPopover,{popoverClass:"o_m2m_tags_avatar_field_popover",closeOnClickAway:(target)=>!target.closest(".modal"),});}
get visibleTagsCount(){return this.props.itemsVisible;}
openPopover(ev){if(this.props.readonly){return;}
this.popover.open(ev.currentTarget.parentElement,{...this.props.popoverProps,readonly:false,canCreate:false,canCreateEdit:false,canQuickCreate:false,placeholder:_t("Search users..."),});}
get canDisplayQuickAssignAvatar(){return!this.props.readonly&&!(this.props.tags&&this.otherTags.length);}}
const KanbanMany2ManyTagsAvatarField=__exports.KanbanMany2ManyTagsAvatarField=class KanbanMany2ManyTagsAvatarField extends Many2ManyTagsAvatarField{static template="web.KanbanMany2ManyTagsAvatarField";static components={...Many2ManyTagsAvatarField.components,TagsList:KanbanMany2ManyTagsAvatarFieldTagsList,};static props={...Many2ManyTagsAvatarField.props,isEditable:{type:Boolean,optional:true},};itemsVisible=2;get popoverProps(){const props={...this.props,readonly:false,};delete props.isEditable;return props;}
get tags(){return super.tags.reverse();}}
const kanbanMany2ManyTagsAvatarField=__exports.kanbanMany2ManyTagsAvatarField={...many2ManyTagsAvatarField,component:KanbanMany2ManyTagsAvatarField,extractProps(fieldInfo,dynamicInfo){const props=many2ManyTagsAvatarField.extractProps(...arguments);props.isEditable=!dynamicInfo.readonly;return props;},};registry.category("fields").add("kanban.many2many_tags_avatar",kanbanMany2ManyTagsAvatarField);return __exports;});;

/* /web/static/src/views/fields/many2one/many2one_field.js */
odoo.define('@web/views/fields/many2one/many2one_field',['@web/core/browser/browser','@web/core/browser/feature_detection','@web/core/context','@web/core/dialog/dialog','@web/core/l10n/translation','@web/core/py_js/py','@web/core/registry','@web/core/utils/hooks','@web/core/utils/strings','@web/views/fields/relational_utils','@web/webclient/barcode/barcode_scanner','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{isMobileOS}=require("@web/core/browser/feature_detection");const{makeContext}=require("@web/core/context");const{Dialog}=require("@web/core/dialog/dialog");const{_t}=require("@web/core/l10n/translation");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{registry}=require("@web/core/registry");const{useChildRef,useOwnedDialogs,useService}=require("@web/core/utils/hooks");const{escape}=require("@web/core/utils/strings");const{Many2XAutocomplete,useOpenMany2XRecord}=require("@web/views/fields/relational_utils");const BarcodeScanner=require("@web/webclient/barcode/barcode_scanner");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component,onWillUpdateProps,useState,markup}=require("@odoo/owl");class CreateConfirmationDialog extends Component{static template="web.Many2OneField.CreateConfirmationDialog";static components={Dialog};get title(){return _t("New: %s",this.props.name);}
get dialogContent(){return markup(_t("Create <strong>%s</strong> as a new %s?",escape(this.props.value),escape(this.props.name)));}
async onCreate(){await this.props.create();this.props.close();}}
__exports.m2oTupleFromData=m2oTupleFromData;function m2oTupleFromData(data){const id=data.id;let name;if("display_name"in data){name=data.display_name;}else{const _name=data.name;name=Array.isArray(_name)?_name[1]:_name;}
return[id,name];}
const Many2OneField=__exports.Many2OneField=class Many2OneField extends Component{static template="web.Many2OneField";static components={Many2XAutocomplete,};static props={...standardFieldProps,placeholder:{type:String,optional:true},canOpen:{type:Boolean,optional:true},canCreate:{type:Boolean,optional:true},canWrite:{type:Boolean,optional:true},canQuickCreate:{type:Boolean,optional:true},canCreateEdit:{type:Boolean,optional:true},context:{type:String,optional:true},domain:{type:[Array,Function],optional:true},nameCreateField:{type:String,optional:true},searchLimit:{type:Number,optional:true},relation:{type:String,optional:true},string:{type:String,optional:true},canScanBarcode:{type:Boolean,optional:true},update:{type:Function,optional:true},value:{optional:true},decorations:{type:Object,optional:true},};static defaultProps={canOpen:true,canCreate:true,canWrite:true,canQuickCreate:true,canCreateEdit:true,nameCreateField:"name",searchLimit:7,string:"",canScanBarcode:false,context:{},decorations:{},};static SEARCH_MORE_LIMIT=320;setup(){this.orm=useService("orm");this.action=useService("action");this.dialog=useService("dialog");this.notification=useService("notification");this.autocompleteContainerRef=useChildRef();this.addDialog=useOwnedDialogs();this.focusInput=()=>{this.autocompleteContainerRef.el.querySelector("input").focus();};this.state=useState({isFloating:false,});this.computeActiveActions(this.props);this.openMany2X=useOpenMany2XRecord({resModel:this.relation,activeActions:this.state.activeActions,isToMany:false,onRecordSaved:async(record)=>{const resId=this.value[0];const fields=["display_name"];const records=await this.orm.read(this.relation,[resId],fields,{context:this.context,});await this.updateRecord(m2oTupleFromData(records[0]));},onClose:()=>this.focusInput(),fieldString:this.string,});this.update=(value,params={})=>{if(value){value=m2oTupleFromData(value[0]);}
this.state.isFloating=false;return this.updateRecord(value);};if(this.props.canQuickCreate){this.quickCreate=(name)=>{this.state.isFloating=false;return this.updateRecord([false,name]);};}
this.setFloating=(bool)=>{this.state.isFloating=bool;};onWillUpdateProps(async(nextProps)=>{this.computeActiveActions(nextProps);});}
updateRecord(value){const changes={[this.props.name]:value};if(this.props.update){return this.props.update(changes);}
return this.props.record.update(changes);}
get relation(){return this.props.relation||this.props.record.fields[this.props.name].relation;}
get string(){return this.props.string||this.props.record.fields[this.props.name].string||"";}
get hasExternalButton(){return this.props.canOpen&&!!this.value&&!this.state.isFloating;}
get context(){const{context,record}=this.props;const evalContext=record.getEvalContext?record.getEvalContext(false):record.evalContext;return makeContext([context],evalContext);}
get classFromDecoration(){const evalContext=this.props.record.evalContextWithVirtualIds;for(const decorationName in this.props.decorations){if(evaluateBooleanExpr(this.props.decorations[decorationName],evalContext)){return`text-${decorationName}`;}}
return"";}
get displayName(){if(this.value&&this.value[1]){return this.value[1].split("\n")[0];}else if(this.value){return _t("Unnamed");}else{return"";}}
get extraLines(){return this.value&&this.value[1]?this.value[1].split("\n").map((line)=>line.trim()).slice(1):[];}
get resId(){return this.value&&this.value[0];}
get value(){return"value"in this.props?this.props.value:this.props.record.data[this.props.name];}
get Many2XAutocompleteProps(){return{value:this.displayName,id:this.props.id,placeholder:this.props.placeholder,resModel:this.relation,autoSelect:true,fieldString:this.string,activeActions:this.state.activeActions,update:this.update,quickCreate:this.quickCreate,context:this.context,getDomain:this.getDomain.bind(this),nameCreateField:this.props.nameCreateField,setInputFloats:this.setFloating,autocomplete_container:this.autocompleteContainerRef,};}
computeActiveActions(props){this.state.activeActions={create:props.canCreate,createEdit:props.canCreateEdit,write:props.canWrite,};}
getDomain(){let domain=this.props.domain;if(typeof domain==="function"){domain=domain();}
return domain;}
async openAction(){const action=await this.orm.call(this.relation,"get_formview_action",[[this.resId]],{context:this.context,});await this.action.doAction(action);}
async openDialog(resId){return this.openMany2X({resId,context:this.context});}
async openConfirmationDialog(request){return new Promise((resolve,reject)=>{this.addDialog(CreateConfirmationDialog,{value:request,name:this.string,create:async()=>{try{await this.quickCreate(request);resolve();}catch(e){reject(e);}},});});}
onClick(ev){if(this.props.canOpen&&this.props.readonly){ev.stopPropagation();this.openAction();}}
onExternalBtnClick(){if(this.env.inDialog){this.openDialog(this.resId);}else{this.openAction();}}
async onBarcodeBtnClick(){const barcode=await BarcodeScanner.scanBarcode(this.env);if(barcode){await this.onBarcodeScanned(barcode);if("vibrate"in browser.navigator){browser.navigator.vibrate(100);}}else{this.notification.add(_t("Please, scan again!"),{type:"warning",});}}
async search(barcode){const results=await this.orm.call(this.relation,"name_search",[],{name:barcode,args:this.getDomain(),operator:"ilike",limit:2,context:this.context,});return results.map((result)=>{const[id,displayName]=result;return{id,name:displayName,};});}
async onBarcodeScanned(barcode){const results=await this.search(barcode);const records=results.filter((r)=>!!r.id);if(records.length===1){this.update([{id:records[0].id,name:records[0].name}]);}else{const searchInput=this.autocompleteContainerRef.el.querySelector("input");searchInput.value=barcode;searchInput.dispatchEvent(new Event("input"));if(this.env.isSmall){searchInput.dispatchEvent(new Event("barcode-search"));}}}
get hasBarcodeButton(){const canScanBarcode=this.props.canScanBarcode;const supported=BarcodeScanner.isBarcodeScannerSupported();return canScanBarcode&&isMobileOS()&&supported&&!this.hasExternalButton;}}
const many2OneField=__exports.many2OneField={component:Many2OneField,displayName:_t("Many2one"),supportedOptions:[{label:_t("Disable opening"),name:"no_open",type:"boolean",},{label:_t("Disable creation"),name:"no_create",type:"boolean",help:_t("If checked, users won't be able to create records through the autocomplete dropdown at all."),},{label:_t("Disable 'Create' option"),name:"no_quick_create",type:"boolean",help:_t("If checked, users will not be able to create records based on the text input; they will still be able to create records via a popup form."),},{label:_t("Disable 'Create and Edit' option"),name:"no_create_edit",type:"boolean",help:_t("If checked, users will not be able to create records based through a popup form; they will still be able to create records based on the text input."),},],supportedTypes:["many2one"],extractProps({attrs,context,decorations,options,string},dynamicInfo){const hasCreatePermission=attrs.can_create?evaluateBooleanExpr(attrs.can_create):true;const hasWritePermission=attrs.can_write?evaluateBooleanExpr(attrs.can_write):true;const canCreate=options.no_create?false:hasCreatePermission;return{placeholder:attrs.placeholder,canOpen:!options.no_open,canCreate,canWrite:hasWritePermission,canQuickCreate:canCreate&&!options.no_quick_create,canCreateEdit:canCreate&&!options.no_create_edit,context:context,decorations,domain:dynamicInfo.domain,nameCreateField:options.create_name_field,canScanBarcode:!!options.can_scan_barcode,string,};},};registry.category("fields").add("many2one",many2OneField);registry.category("fields").add("list.many2one",many2OneField);registry.category("fields").add("kanban.many2one",many2OneField);return __exports;});;

/* /web/static/src/views/fields/many2one_avatar/many2one_avatar_field.js */
odoo.define('@web/views/fields/many2one_avatar/many2one_avatar_field',['@web/core/l10n/translation','@web/core/registry','@web/core/popover/popover_hook','@web/views/fields/many2one/many2one_field','@odoo/owl','@web/views/fields/relational_utils'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{usePopover}=require("@web/core/popover/popover_hook");const{many2OneField,Many2OneField}=require("@web/views/fields/many2one/many2one_field");const{Component}=require("@odoo/owl");const{AvatarMany2XAutocomplete}=require("@web/views/fields/relational_utils");const Many2OneAvatarField=__exports.Many2OneAvatarField=class Many2OneAvatarField extends Component{static template="web.Many2OneAvatarField";static components={Many2OneField,};static props={...Many2OneField.props,};get relation(){return this.props.relation||this.props.record.fields[this.props.name].relation;}
get many2OneProps(){return Object.fromEntries(Object.entries(this.props).filter(([key,_val])=>key in this.constructor.components.Many2OneField.props));}}
const many2OneAvatarField=__exports.many2OneAvatarField={...many2OneField,component:Many2OneAvatarField,extractProps(fieldInfo){const props=many2OneField.extractProps(...arguments);props.canOpen=fieldInfo.viewType==="form";return props;},};const Many2OneFieldPopover=__exports.Many2OneFieldPopover=class Many2OneFieldPopover extends Many2OneField{static props={...Many2OneField.props,close:{type:Function},};static components={Many2XAutocomplete:AvatarMany2XAutocomplete,};get Many2XAutocompleteProps(){return{...super.Many2XAutocompleteProps,dropdown:false,autofocus:true,};}
async updateRecord(value){const updatedValue=await super.updateRecord(...arguments);await this.props.record.save();return updatedValue;}}
const KanbanMany2OneAvatarField=__exports.KanbanMany2OneAvatarField=class KanbanMany2OneAvatarField extends Many2OneAvatarField{static template="web.KanbanMany2OneAvatarField";static props={...Many2OneAvatarField.props,isEditable:{type:Boolean,optional:true},};setup(){super.setup();this.popover=usePopover(Many2OneFieldPopover,{popoverClass:"o_m2o_tags_avatar_field_popover",closeOnClickAway:(target)=>!target.closest(".modal"),});}
get popoverProps(){const props={...this.props,readonly:false,};delete props.isEditable;return props;}
openPopover(ev){if(!this.props.isEditable){return;}
this.popover.open(ev.currentTarget,{...this.popoverProps,canCreate:false,canCreateEdit:false,canQuickCreate:false,placeholder:_t("Search user..."),});}}
const kanbanMany2OneAvatarField=__exports.kanbanMany2OneAvatarField={...many2OneField,component:KanbanMany2OneAvatarField,additionalClasses:["o_field_many2one_avatar_kanban"],extractProps(fieldInfo,dynamicInfo){const props=many2OneAvatarField.extractProps(...arguments);props.isEditable=!dynamicInfo.readonly;return props;},};registry.category("fields").add("many2one_avatar",many2OneAvatarField);registry.category("fields").add("kanban.many2one_avatar",kanbanMany2OneAvatarField);return __exports;});;

/* /web/static/src/views/fields/many2one_barcode/many2one_barcode_field.js */
odoo.define('@web/views/fields/many2one_barcode/many2one_barcode_field',['@web/core/l10n/translation','@web/core/registry','@web/views/fields/many2one/many2one_field'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{many2OneField,Many2OneField}=require("@web/views/fields/many2one/many2one_field");const Many2OneBarcodeField=__exports.Many2OneBarcodeField=class Many2OneBarcodeField extends Many2OneField{static defaultProps={...super.defaultProps,canScanBarcode:true,};}
const many2OneBarcodeField=__exports.many2OneBarcodeField={...many2OneField,component:Many2OneBarcodeField,displayName:_t("Many2OneBarcode"),extractProps(){const props=many2OneField.extractProps(...arguments);props.canScanBarcode=true;return props;},};registry.category("fields").add("many2one_barcode",many2OneBarcodeField);return __exports;});;

/* /web/static/src/views/fields/many2one_reference/many2one_reference_field.js */
odoo.define('@web/views/fields/many2one_reference/many2one_reference_field',['@web/core/registry','@web/views/fields/integer/integer_field'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{integerField}=require("@web/views/fields/integer/integer_field");registry.category("fields").add("many2one_reference",integerField);return __exports;});;

/* /web/static/src/views/fields/monetary/monetary_field.js */
odoo.define('@web/views/fields/monetary/monetary_field',['@web/core/registry','@web/core/l10n/translation','@web/views/fields/formatters','@web/views/fields/parsers','@web/views/fields/input_field_hook','@web/views/fields/numpad_decimal_hook','@web/views/fields/standard_field_props','@odoo/owl','@web/core/currency'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{_t}=require("@web/core/l10n/translation");const{formatMonetary}=require("@web/views/fields/formatters");const{parseMonetary}=require("@web/views/fields/parsers");const{useInputField}=require("@web/views/fields/input_field_hook");const{useNumpadDecimal}=require("@web/views/fields/numpad_decimal_hook");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const{getCurrency}=require("@web/core/currency");const MonetaryField=__exports.MonetaryField=class MonetaryField extends Component{static template="web.MonetaryField";static props={...standardFieldProps,currencyField:{type:String,optional:true},inputType:{type:String,optional:true},useFieldDigits:{type:Boolean,optional:true},hideSymbol:{type:Boolean,optional:true},placeholder:{type:String,optional:true},};static defaultProps={hideSymbol:false,inputType:"text",};setup(){useInputField(this.inputOptions);useNumpadDecimal();}
get inputOptions(){return{getValue:()=>this.formattedValue,refName:"numpadDecimal",parse:parseMonetary,};}
get currencyId(){const currencyField=this.props.currencyField||this.props.record.fields[this.props.name].currency_field||"currency_id";const currency=this.props.record.data[currencyField];return currency&&currency[0];}
get currency(){if(!isNaN(this.currencyId)){return getCurrency(this.currencyId)||null;}
return null;}
get currencySymbol(){return this.currency?this.currency.symbol:"";}
get currencyDigits(){if(this.props.useFieldDigits){return this.props.record.fields[this.props.name].digits;}
if(!this.currency){return null;}
return getCurrency(this.currencyId).digits;}
get value(){return this.props.record.data[this.props.name];}
get formattedValue(){if(this.props.inputType==="number"&&!this.props.readonly&&this.value){return this.value;}
return formatMonetary(this.value,{digits:this.currencyDigits,currencyId:this.currencyId,noSymbol:!this.props.readonly||this.props.hideSymbol,});}}
const monetaryField=__exports.monetaryField={component:MonetaryField,supportedOptions:[{label:_t("Hide symbol"),name:"no_symbol",type:"boolean",},{label:_t("Currency"),name:"currency_field",type:"field",availableTypes:["many2one"],},],supportedTypes:["monetary","float"],displayName:_t("Monetary"),extractProps:({attrs,options})=>({currencyField:options.currency_field,inputType:attrs.type,useFieldDigits:options.field_digits,hideSymbol:options.no_symbol,placeholder:attrs.placeholder,}),};registry.category("fields").add("monetary",monetaryField);return __exports;});;

/* /web/static/src/views/fields/numpad_decimal_hook.js */
odoo.define('@web/views/fields/numpad_decimal_hook',['@web/core/l10n/localization','@web/core/browser/feature_detection','@odoo/owl'],function(require){'use strict';let __exports={};const{localization}=require("@web/core/l10n/localization");const{isIOS}=require("@web/core/browser/feature_detection");const{useRef,useEffect}=require("@odoo/owl");function onKeydown(ev){const decimalPoint=localization.decimalPoint;if(!([".",","].includes(ev.key)&&ev.code==="NumpadDecimal")||ev.key===decimalPoint||ev.target.type==="number"){return;}
ev.preventDefault();ev.target.setRangeText(decimalPoint,ev.target.selectionStart,ev.target.selectionEnd,"end");}
function onFocus(ev){ev.target.select();}
__exports.useNumpadDecimal=useNumpadDecimal;function useNumpadDecimal(){const ref=useRef("numpadDecimal");const isIOSDevice=isIOS();useEffect(()=>{let inputs=[];const el=ref.el;if(el){inputs=el.nodeName==="INPUT"?[el]:el.querySelectorAll("input");inputs.forEach((input)=>input.addEventListener("keydown",onKeydown));inputs.forEach((input)=>input.addEventListener("focus",onFocus));if(isIOSDevice){inputs.forEach((input)=>input.removeAttribute("inputmode"));}}
return()=>{inputs.forEach((input)=>input.removeEventListener("keydown",onKeydown));inputs.forEach((input)=>input.removeEventListener("focus",onFocus));};});}
return __exports;});;

/* /web/static/src/views/fields/pdf_viewer/pdf_viewer_field.js */
odoo.define('@web/views/fields/pdf_viewer/pdf_viewer_field',['@web/core/l10n/translation','@web/core/registry','@web/core/utils/hooks','@web/core/utils/urls','@web/views/fields/standard_field_props','@web/views/fields/file_handler','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{url}=require("@web/core/utils/urls");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{FileUploader}=require("@web/views/fields/file_handler");const{Component,onWillUpdateProps,useState}=require("@odoo/owl");const PdfViewerField=__exports.PdfViewerField=class PdfViewerField extends Component{static template="web.PdfViewerField";static components={FileUploader,};static props={...standardFieldProps,};setup(){this.notification=useService("notification");this.state=useState({isValid:true,objectUrl:"",});onWillUpdateProps((nextProps)=>{if(nextProps.readonly){this.state.objectUrl="";}});}
get url(){if(!this.state.isValid||!this.props.record.data[this.props.name]){return null;}
const page=this.props.record.data[`${this.props.name}_page`]||1;const file=encodeURIComponent(this.state.objectUrl||url("/web/content",{model:this.props.record.resModel,field:this.props.name,id:this.props.record.resId,}));return`/web/static/lib/pdfjs/web/viewer.html?file=${file}#page=${page}`;}
update({data}){const changes={[this.props.name]:data||false};return this.props.record.update(changes);}
onFileRemove(){this.state.isValid=true;this.update({});}
onFileUploaded({data,objectUrl}){this.state.isValid=true;this.state.objectUrl=objectUrl;this.update({data});}
onLoadFailed(){this.state.isValid=false;this.notification.add(_t("Could not display the selected pdf"),{type:"danger",});}}
const pdfViewerField=__exports.pdfViewerField={component:PdfViewerField,displayName:_t("PDF Viewer"),supportedOptions:[{label:_t("Preview image"),name:"preview_image",type:"field",availableTypes:["binary"],},],supportedTypes:["binary"],};registry.category("fields").add("pdf_viewer",pdfViewerField);return __exports;});;

/* /web/static/src/views/fields/percent_pie/percent_pie_field.js */
odoo.define('@web/views/fields/percent_pie/percent_pie_field',['@web/core/registry','@web/core/l10n/translation','@web/views/fields/formatters','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{_t}=require("@web/core/l10n/translation");const{formatFloat}=require("@web/views/fields/formatters");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const PercentPieField=__exports.PercentPieField=class PercentPieField extends Component{static template="web.PercentPieField";static props={...standardFieldProps,string:{type:String,optional:true},};get formattedValue(){return formatFloat(this.props.record.data[this.props.name],{trailingZeros:false,});}}
const percentPieField=__exports.percentPieField={component:PercentPieField,displayName:_t("PercentPie"),supportedTypes:["float","integer"],additionalClasses:["o_field_percent_pie"],extractProps:({string})=>({string}),};registry.category("fields").add("percentpie",percentPieField);return __exports;});;

/* /web/static/src/views/fields/percentage/percentage_field.js */
odoo.define('@web/views/fields/percentage/percentage_field',['@web/core/registry','@web/core/l10n/translation','@web/views/fields/formatters','@web/views/fields/parsers','@web/views/fields/input_field_hook','@web/views/fields/numpad_decimal_hook','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{_t}=require("@web/core/l10n/translation");const{formatPercentage}=require("@web/views/fields/formatters");const{parsePercentage}=require("@web/views/fields/parsers");const{useInputField}=require("@web/views/fields/input_field_hook");const{useNumpadDecimal}=require("@web/views/fields/numpad_decimal_hook");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const PercentageField=__exports.PercentageField=class PercentageField extends Component{static template="web.PercentageField";static props={...standardFieldProps,digits:{type:Array,optional:true},placeholder:{type:String,optional:true},};setup(){useInputField({getValue:()=>formatPercentage(this.props.record.data[this.props.name],{digits:this.digits,noSymbol:true,}),refName:"numpadDecimal",parse:(v)=>parsePercentage(v),});useNumpadDecimal();}
get digits(){const fieldDigits=this.props.record.fields[this.props.name].digits;return!this.props.digits&&Array.isArray(fieldDigits)?fieldDigits:this.props.digits;}
get formattedValue(){return formatPercentage(this.props.record.data[this.props.name],{digits:this.digits,});}}
const percentageField=__exports.percentageField={component:PercentageField,displayName:_t("Percentage"),supportedTypes:["integer","float"],extractProps:({attrs,options})=>{let digits;if(attrs.digits){digits=JSON.parse(attrs.digits);}else if(options.digits){digits=options.digits;}
return{digits,placeholder:attrs.placeholder,};},};registry.category("fields").add("percentage",percentageField);return __exports;});;

/* /web/static/src/views/fields/phone/phone_field.js */
odoo.define('@web/views/fields/phone/phone_field',['@web/core/registry','@web/core/l10n/translation','@web/views/fields/input_field_hook','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{_t}=require("@web/core/l10n/translation");const{useInputField}=require("@web/views/fields/input_field_hook");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const PhoneField=__exports.PhoneField=class PhoneField extends Component{static template="web.PhoneField";static props={...standardFieldProps,placeholder:{type:String,optional:true},};setup(){useInputField({getValue:()=>this.props.record.data[this.props.name]||""});}
get phoneHref(){return"tel:"+this.props.record.data[this.props.name].replace(/\s+/g,"");}}
const phoneField=__exports.phoneField={component:PhoneField,displayName:_t("Phone"),supportedTypes:["char"],extractProps:({attrs})=>({placeholder:attrs.placeholder,}),};registry.category("fields").add("phone",phoneField);class FormPhoneField extends PhoneField{static template="web.FormPhoneField";}
const formPhoneField=__exports.formPhoneField={...phoneField,component:FormPhoneField,};registry.category("fields").add("form.phone",formPhoneField);return __exports;});;

/* /web/static/src/views/fields/priority/priority_field.js */
odoo.define('@web/views/fields/priority/priority_field',['@web/core/commands/command_hook','@web/core/registry','@web/core/l10n/translation','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{useCommand}=require("@web/core/commands/command_hook");const{registry}=require("@web/core/registry");const{_t}=require("@web/core/l10n/translation");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component,useState}=require("@odoo/owl");const PriorityField=__exports.PriorityField=class PriorityField extends Component{static template="web.PriorityField";static props={...standardFieldProps,withCommand:{type:Boolean,optional:true},autosave:{type:Boolean,optional:true},};setup(){this.state=useState({index:-1,});if(this.props.withCommand){for(const command of this.commands){useCommand(...command);}}}
get commands(){const commandName=_t("Set priority...");return[[commandName,()=>{return{placeholder:commandName,providers:[{provide:()=>this.options.map((value)=>({name:value[1],action:()=>{this.updateRecord(value[0]);},})),},],};},{category:"smart_action",hotkey:"alt+r"},],];}
get tooltipLabel(){return this.props.record.fields[this.props.name].string;}
get options(){return Array.from(this.props.record.fields[this.props.name].selection);}
get index(){return this.state.index>-1?this.state.index:this.options.findIndex((o)=>o[0]===this.props.record.data[this.props.name]);}
getTooltip(value){return this.tooltipLabel&&this.tooltipLabel!==value?`${this.tooltipLabel}: ${value}`:value;}
onStarClicked(value){if(this.props.record.data[this.props.name]===value){this.state.index=-1;this.updateRecord(this.options[0][0]);}else{this.updateRecord(value);}}
async updateRecord(value){await this.props.record.update({[this.props.name]:value},{save:this.props.autosave});}}
const priorityField=__exports.priorityField={component:PriorityField,displayName:_t("Priority"),supportedOptions:[{label:_t("Autosave"),name:"autosave",type:"boolean",default:true,help:_t("If checked, the record will be saved immediately when the field is modified."),},],supportedTypes:["selection"],extractProps({options,viewType},dynamicInfo){return{withCommand:viewType==="form",readonly:dynamicInfo.readonly,autosave:"autosave"in options?!!options.autosave:true,};},};registry.category("fields").add("priority",priorityField);return __exports;});;

/* /web/static/src/views/fields/progress_bar/kanban_progress_bar_field.js */
odoo.define('@web/views/fields/progress_bar/kanban_progress_bar_field',['@web/core/registry','@web/views/fields/progress_bar/progress_bar_field'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{progressBarField,ProgressBarField}=require("@web/views/fields/progress_bar/progress_bar_field");const KanbanProgressBarField=__exports.KanbanProgressBarField=class KanbanProgressBarField extends ProgressBarField{get isEditable(){return this.props.isEditable;}}
const kanbanProgressBarField=__exports.kanbanProgressBarField={...progressBarField,component:KanbanProgressBarField,};registry.category("fields").add("kanban.progressbar",kanbanProgressBarField);return __exports;});;

/* /web/static/src/views/fields/progress_bar/progress_bar_field.js */
odoo.define('@web/views/fields/progress_bar/progress_bar_field',['@web/core/l10n/translation','@web/core/registry','@web/views/fields/numpad_decimal_hook','@web/views/fields/parsers','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useNumpadDecimal}=require("@web/views/fields/numpad_decimal_hook");const{parseFloat}=require("@web/views/fields/parsers");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component,useRef,useState}=require("@odoo/owl");const formatters=registry.category("formatters");const ProgressBarField=__exports.ProgressBarField=class ProgressBarField extends Component{static template="web.ProgressBarField";static props={...standardFieldProps,maxValueField:{type:[String,Number],optional:true},currentValueField:{type:String,optional:true},isEditable:{type:Boolean,optional:true},isCurrentValueEditable:{type:Boolean,optional:true},isMaxValueEditable:{type:Boolean,optional:true},title:{type:String,optional:true},overflowClass:{type:String,optional:true},};setup(){useNumpadDecimal();this.root=useRef("numpadDecimal");this.maxValueRef=useRef("maxValue");this.currentValueRef=useRef("currentValue");const{currentValueField,maxValueField,name}=this.props;this.currentValueField=currentValueField?currentValueField:name;if(maxValueField){this.maxValueField=maxValueField;}
this.state=useState({isEditing:false,});}
get isEditable(){return this.props.isEditable&&!this.props.readonly;}
get isPercentage(){return!this.props.maxValueField||!isNaN(this.props.maxValueField);}
get currentValue(){return this.props.record.data[this.currentValueField]||0;}
get maxValue(){return this.props.record.data[this.maxValueField]||100;}
get progressBarColorClass(){return this.currentValue>this.maxValue?this.props.overflowClass:"bg-primary";}
formatCurrentValue(humanReadable=!this.state.isEditing){const formatter=formatters.get(Number.isInteger(this.currentValue)?"integer":"float");return formatter(this.currentValue,{humanReadable});}
formatMaxValue(humanReadable=!this.state.isEditing){const formatter=formatters.get(Number.isInteger(this.maxValue)?"integer":"float");return formatter(this.maxValue,{humanReadable});}
onValueChange(value,fieldName){let parsedValue;try{parsedValue=parseFloat(value);}catch{this.props.record.setInvalidField(this.props.name);return;}
if(this.props.record.fields[fieldName].type==="integer"){parsedValue=Math.floor(parsedValue);}
this.props.record.update({[fieldName]:parsedValue},{save:this.props.readonly});}
onCurrentValueChange(ev){this.onValueChange(ev.target.value,this.currentValueField);}
onMaxValueChange(ev){this.onValueChange(ev.target.value,this.maxValueField);}
onInputBlur(){if(document.activeElement!==this.maxValueRef.el&&document.activeElement!==this.currentValueRef.el){this.state.isEditing=false;}}
onInputFocus(){this.state.isEditing=true;}}
const progressBarField=__exports.progressBarField={component:ProgressBarField,displayName:_t("Progress Bar"),supportedOptions:[{label:_t("Can edit value"),name:"editable",type:"boolean",},{label:_t("Can edit max value"),name:"edit_max_value",type:"boolean",},{label:_t("Current value field"),name:"current_value",type:"field",availableTypes:["integer","float"],help:_t("Use to override the display value (e.g. if your progress bar is a computed percentage but you want to display the actual field value instead)."),},{label:_t("Max value field"),name:"max_value",type:"field",availableTypes:["integer","float"],help:_t("Field that holds the maximum value of the progress bar. If set, will be displayed next to the progress bar (e.g. 10 / 200)."),},{label:_t("Overflow style"),name:"overflow_class",type:"string",availableTypes:["integer","float"],help:_t("Bootstrap classname to customize the style of the progress bar when the maximum value is exceeded"),default:"bg-secondary",},],supportedTypes:["integer","float"],extractProps:({attrs,options})=>({maxValueField:options.max_value,currentValueField:options.current_value,isEditable:!options.readonly&&options.editable,isCurrentValueEditable:options.editable&&!options.edit_max_value,isMaxValueEditable:options.editable&&options.edit_max_value,title:attrs.title,overflowClass:options.overflow_class||"bg-secondary",}),};registry.category("fields").add("progressbar",progressBarField);return __exports;});;

/* /web/static/src/views/fields/properties/card_properties_field.js */
odoo.define('@web/views/fields/properties/card_properties_field',['@web/core/registry','@web/views/fields/properties/properties_field'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{propertiesField,PropertiesField}=require("@web/views/fields/properties/properties_field");const CardPropertiesField=__exports.CardPropertiesField=class CardPropertiesField extends PropertiesField{static template="web.CardPropertiesField";async _checkDefinitionAccess(){this.state.canChangeDefinition=false;}}
const cardPropertiesField=__exports.cardPropertiesField={...propertiesField,component:CardPropertiesField,};registry.category("fields").add("calendar.properties",cardPropertiesField);registry.category("fields").add("kanban.properties",cardPropertiesField);return __exports;});;

/* /web/static/src/views/fields/properties/properties_field.js */
odoo.define('@web/views/fields/properties/properties_field',['@web/core/l10n/translation','@web/core/registry','@web/views/fields/standard_field_props','@web/views/utils','@web/views/fields/properties/property_definition','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/views/fields/properties/property_value','@web/core/utils/hooks','@web/core/popover/popover_hook','@web/core/confirmation_dialog/confirmation_dialog','@web/core/position_hook','@web/core/utils/objects','@web/core/utils/sortable_owl','@web/model/relational_model/utils','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{uuid}=require("@web/views/utils");const{PropertyDefinition}=require("@web/views/fields/properties/property_definition");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{PropertyValue}=require("@web/views/fields/properties/property_value");const{useBus,useService}=require("@web/core/utils/hooks");const{usePopover}=require("@web/core/popover/popover_hook");const{ConfirmationDialog}=require("@web/core/confirmation_dialog/confirmation_dialog");const{reposition}=require("@web/core/position_hook");const{archParseBoolean}=require("@web/views/utils");const{pick}=require("@web/core/utils/objects");const{useSortable}=require("@web/core/utils/sortable_owl");const{useRecordObserver}=require("@web/model/relational_model/utils");const{Component,useRef,useState,useEffect,onWillStart}=require("@odoo/owl");const PropertiesField=__exports.PropertiesField=class PropertiesField extends Component{static template="web.PropertiesField";static components={Dropdown,DropdownItem,PropertyDefinition,PropertyValue,};static props={...standardFieldProps,context:{type:Object,optional:true},columns:{type:Number,optional:true},showAddButton:{type:Boolean,optional:true},};setup(){this.notification=useService("notification");this.orm=useService("orm");this.user=useService("user");this.dialogService=useService("dialog");this.popover=usePopover(PropertyDefinition,{closeOnClickAway:this.checkPopoverClose,popoverClass:"o_property_field_popover",position:"top",onClose:()=>this.onCloseCurrentPopover?.(),fixedPosition:true,arrow:false,});this.propertiesRef=useRef("properties");let currentResId;useRecordObserver((record)=>{if(currentResId!==record.resId){currentResId=record.resId;this._saveInitialPropertiesValues();}});const field=this.props.record.fields[this.props.name];this.definitionRecordField=field.definition_record;this.state=useState({canChangeDefinition:true,movedPropertyName:null,showAddButton:this.props.showAddButton,unfoldedSeparators:this._getUnfoldedSeparators(),});if(this.env.config?.viewType==="form"){useBus(this.env.model.bus,"PROPERTY_FIELD:ADD_PROPERTY_VALUE",()=>{this.onPropertyCreate();});}
onWillStart(async()=>{await this._checkDefinitionAccess();});useEffect(()=>{if(this.openPropertyDefinition){const propertyName=this.openPropertyDefinition;const labels=this.propertiesRef.el.querySelectorAll(`.o_property_field[property-name="${propertyName}"] .o_field_property_open_popover`);this.openPropertyDefinition=null;const lastLabel=labels[labels.length-1];this._openPropertyDefinition(lastLabel,propertyName,true);}},()=>[this.openPropertyDefinition]);useEffect(()=>this._movePopoverIfNeeded());useSortable({enable:()=>!this.props.readonly&&this.state.canChangeDefinition,ref:this.propertiesRef,handle:".o_field_property_label .oi-draggable",elements:this.renderedColumnsCount===1?"*:is(.o_property_field, .o_field_property_group_label)":".o_property_field",groups:".o_property_group",connectGroups:true,cursor:"grabbing",onDragStart:({element,group})=>{this.propertiesRef.el.classList.add("o_property_dragging");element.classList.add("o_property_drag_item");group.classList.add("o_property_drag_group");document.activeElement.blur();},onDrop:async({parent,element,next,previous})=>{const from=element.getAttribute("property-name");let to=previous&&previous.getAttribute("property-name");let moveBefore=false;if(!to&&next){if(next.classList.contains("o_field_property_group_label")){next=next.closest(".o_property_group");}
to=next.getAttribute("property-name");moveBefore=!!to;}
if(!to){const groupName=parent.getAttribute("property-name");const group=this.groupedPropertiesList.find((group)=>group.name===groupName);to=group.elements.length?group.elements.at(-1).name:groupName;}
await this.onPropertyMoveTo(from,to,moveBefore);},onDragEnd:({element})=>{this.propertiesRef.el.classList.remove("o_property_dragging");element.classList.remove("o_property_drag_item");const targetGroup=this.propertiesRef.el.querySelector(".o_property_drag_group");if(targetGroup){targetGroup.classList.remove("o_property_drag_group");}},onGroupEnter:({group})=>{group.classList.add("o_property_drag_group");this._unfoldSeparators([group.getAttribute("property-name")],true);},onGroupLeave:({group})=>{group.classList.remove("o_property_drag_group");},});useSortable({enable:()=>!this.props.readonly&&this.state.canChangeDefinition,ref:this.propertiesRef,handle:".o_field_property_group_label .oi-draggable",elements:".o_property_group:not([property-name=''])",cursor:"grabbing",onDragStart:({element})=>{this.propertiesRef.el.classList.add("o_property_dragging");element.classList.add("o_property_drag_item");document.activeElement.blur();},onDrop:async({element,previous})=>{const from=element.getAttribute("property-name");const to=previous&&previous.getAttribute("property-name");await this.onGroupMoveTo(from,to);},onDragEnd:({element})=>{this.propertiesRef.el.classList.remove("o_property_dragging");element.classList.remove("o_property_drag_item");},});}
get renderedColumnsCount(){return this.env.isSmall?1:this.props.columns;}
get propertiesList(){const propertiesValues=this.props.record.data[this.props.name]||[];return propertiesValues.filter((definition)=>!definition.definition_deleted);}
get groupedPropertiesList(){const propertiesList=this.propertiesList;const groupedProperties=propertiesList[0]?.type!=="separator"?[{title:null,name:null,elements:[],invisibleLabel:true}]:[];propertiesList.forEach((property)=>{if(property.type==="separator"){groupedProperties.push({title:property.string,name:property.name,elements:[],});}else{groupedProperties.at(-1).elements.push(property);}});if(groupedProperties.length===1){const invisibleLabel=propertiesList[0]?.type!=="separator";groupedProperties[0].elements=[];groupedProperties[0].invisibleLabel=invisibleLabel;for(let col=1;col<this.renderedColumnsCount;++col){groupedProperties.push({title:null,name:groupedProperties[0].name,columnSeparator:true,elements:[],invisibleLabel,});}
const properties=propertiesList.filter((property)=>property.type!=="separator");properties.forEach((property,index)=>{const columnIndex=Math.floor((index*this.renderedColumnsCount)/properties.length);groupedProperties[columnIndex].elements.push(property);});}
return groupedProperties;}
get definitionRecordId(){return this.props.record.data[this.definitionRecordField][0];}
get definitionRecordModel(){return this.props.record.fields[this.definitionRecordField].relation;}
checkPopoverClose(target){if(target.closest(".o_datetime_picker")){return false;}
if(target.closest(".modal")){return false;}
if(target.closest(".o_tag_popover")){return false;}
if(target.closest(".o_model_field_selector_popover")){return false;}
return true;}
generateUniqueDomID(){return`property_${uuid()}`;}
generatePropertyName(){return uuid();}
async onPropertyMove(propertyName,direction){const propertiesValues=this.propertiesList||[];const propertyIndex=propertiesValues.findIndex((property)=>property.name===propertyName);const targetIndex=propertyIndex+(direction==="down"?1:-1);if(targetIndex<0||targetIndex>=propertiesValues.length){this.notification.add(direction==="down"?_t("This field is already last"):_t("This field is already first"),{type:"warning"});return;}
this.state.movedPropertyName=propertyName;const prop=propertiesValues[targetIndex];propertiesValues[targetIndex]=propertiesValues[propertyIndex];propertiesValues[propertyIndex]=prop;propertiesValues[propertyIndex].definition_changed=true;this._unfoldPropertyGroup(targetIndex,propertiesValues);await this.props.record.update({[this.props.name]:propertiesValues});this.movePopoverToProperty=propertyName;}
onPropertyMoveTo(propertyName,toPropertyName,moveBefore){const propertiesValues=this.propertiesList||[];let fromIndex=propertiesValues.findIndex((property)=>property.name===propertyName);let toIndex=propertiesValues.findIndex((property)=>property.name===toPropertyName);const columnSize=Math.ceil(propertiesValues.length/this.renderedColumnsCount);if(this.renderedColumnsCount>1&&!propertiesValues.some((p,index)=>index!==0&&p.type==="separator")&&Math.floor(fromIndex/columnSize)!==Math.floor(toIndex/columnSize)){const newSeparators=[];for(let col=0;col<this.renderedColumnsCount;++col){const separatorIndex=columnSize*col+newSeparators.length;if(propertiesValues[separatorIndex].type==="separator"){continue;}
const newSeparator={type:"separator",string:_t("Group %s",col+1),name:this.generatePropertyName(),};newSeparators.push(newSeparator.name);propertiesValues.splice(separatorIndex,0,newSeparator);}
this._unfoldSeparators(newSeparators,true);toPropertyName=toPropertyName||propertiesValues[0].name;fromIndex=propertiesValues.findIndex((property)=>property.name===propertyName);toIndex=propertiesValues.findIndex((property)=>property.name===toPropertyName);}
if(moveBefore){toIndex--;}
if(toIndex<fromIndex){toIndex++;}
propertiesValues.splice(toIndex,0,propertiesValues.splice(fromIndex,1)[0]);propertiesValues[0].definition_changed=true;this.props.record.update({[this.props.name]:propertiesValues});}
onGroupMoveTo(propertyName,toPropertyName){const propertiesValues=this.propertiesList||[];const fromIndex=propertiesValues.findIndex((property)=>property.name===propertyName);const toIndex=propertiesValues.findIndex((property)=>property.name===toPropertyName);if(propertiesValues[fromIndex].type!=="separator"||(toIndex>=0&&propertiesValues[toIndex].type!=="separator")){throw new Error("Something went wrong");}
const getNextSeparatorIndex=(startIndex)=>{const nextSeparatorIndex=propertiesValues.findIndex((property,index)=>property.type==="separator"&&index>startIndex);return nextSeparatorIndex<0?propertiesValues.length:nextSeparatorIndex;};const groupSize=getNextSeparatorIndex(fromIndex)-fromIndex;let targetIndex=getNextSeparatorIndex(toIndex);if(targetIndex>fromIndex){targetIndex-=groupSize;}
propertiesValues.splice(targetIndex,0,...propertiesValues.splice(fromIndex,groupSize));propertiesValues[0].definition_changed=true;this.props.record.update({[this.props.name]:propertiesValues});}
onPropertyValueChange(propertyName,propertyValue){const propertiesValues=this.propertiesList;propertiesValues.find((property)=>property.name===propertyName).value=propertyValue;this.props.record.update({[this.props.name]:propertiesValues});}
async onPropertyEdit(event,propertyName){event.stopPropagation();event.preventDefault();if(!(await this.checkDefinitionWriteAccess())){this.notification.add(_t("You need edit access on the parent document to update these property fields"),{type:"warning"});return;}
if(event.target.classList.contains("disabled")){return;}
event.target.classList.add("disabled");this._openPropertyDefinition(event.target,propertyName,false);}
async onPropertyDefinitionChange(propertyDefinition){propertyDefinition["definition_changed"]=true;if(propertyDefinition.type==="separator"){propertyDefinition=pick(propertyDefinition,"name","string","definition_changed","type");}
const propertiesValues=this.propertiesList;const propertyIndex=this._getPropertyIndex(propertyDefinition.name);const oldType=propertiesValues[propertyIndex].type;const newType=propertyDefinition.type;this._regeneratePropertyName(propertyDefinition);propertiesValues[propertyIndex]=propertyDefinition;await this.props.record.update({[this.props.name]:propertiesValues});if(newType==="separator"&&oldType!=="separator"){this._unfoldSeparators([propertyDefinition.name],true);this.movePopoverToProperty=propertyDefinition.name;}else if(oldType==="separator"&&newType!=="separator"){const previousSeperator=propertiesValues.findLast((property,index)=>index<propertyIndex&&property.type==="separator");if(previousSeperator){this._unfoldSeparators([previousSeperator.name],true);}
this.movePopoverToProperty=propertyDefinition.name;}}
onPropertyDelete(propertyName){this.popover.close();const dialogProps={title:_t("Delete Property Field"),body:_t('Are you sure you want to delete this property field? It will be removed for everyone using the "%s" %s.',this.parentName,this.parentString),confirmLabel:_t("Delete"),confirm:()=>{const propertiesDefinitions=this.propertiesList;propertiesDefinitions.find((property)=>property.name===propertyName).definition_deleted=true;this.props.record.update({[this.props.name]:propertiesDefinitions});},cancel:()=>{},};this.dialogService.add(ConfirmationDialog,dialogProps);}
async onPropertyCreate(){if(!this.state.canChangeDefinition||!(await this.checkDefinitionWriteAccess())){this.notification.add(_t("You need edit access on the parent document to update these property fields"),{type:"warning"});return;}
const propertiesDefinitions=this.propertiesList||[];if(propertiesDefinitions.length&&propertiesDefinitions.some((prop)=>prop.type!=="separator"&&(!prop.string||!prop.string.length))){this.propertiesRef.el.closest(".o_field_properties").classList.add("o_field_invalid");this.notification.add(_t("Please complete your properties before adding a new one"),{type:"warning",});return;}
this._unfoldPropertyGroup(propertiesDefinitions.length-1,propertiesDefinitions);this.propertiesRef.el.closest(".o_field_properties").classList.remove("o_field_invalid");const newName=this.generatePropertyName();propertiesDefinitions.push({name:newName,string:_t("Property %s",propertiesDefinitions.length+1),type:"char",definition_changed:true,});this.openPropertyDefinition=newName;this.state.showAddButton=true;this.props.record.update({[this.props.name]:propertiesDefinitions});}
onSeparatorClick(propertyName){if(propertyName){this._unfoldSeparators([propertyName]);}}
async checkDefinitionWriteAccess(){if(!this.definitionRecordId||!this.definitionRecordModel){return false;}
try{await this.orm.call(this.definitionRecordModel,"check_access_rule",[this.definitionRecordId],{operation:"write"});}catch{return false;}
return true;}
onTagsChange(propertyName,newTags,newValue=null){const propertyDefinition=this.propertiesList.find((property)=>property.name===propertyName);propertyDefinition.tags=newTags;if(newValue!==null){propertyDefinition.value=newValue;}
propertyDefinition.definition_changed=true;this.onPropertyDefinitionChange(propertyDefinition);}
_getSeparatorFoldKey(){const definitionRecordId=this.props.record.data[this.definitionRecordField][0];const definitionRecordModel=this.props.record.fields[this.definitionRecordField].relation;return`properties.fold,${definitionRecordModel},${definitionRecordId}`;}
_getUnfoldedSeparators(){const key=this._getSeparatorFoldKey();const unfoldedSeparators=JSON.parse(window.localStorage.getItem(key))||[];const allPropertiesNames=this.propertiesList.map((property)=>property.name);return unfoldedSeparators.filter((name)=>allPropertiesNames.includes(name));}
_unfoldSeparators(separatorNames,forceUnfold){let unfoldedSeparators=this._getUnfoldedSeparators();for(const separatorName of separatorNames){if(unfoldedSeparators.includes(separatorName)){if(!forceUnfold){unfoldedSeparators=unfoldedSeparators.filter((name)=>name!==separatorName);}}else{unfoldedSeparators.push(separatorName);}}
const key=this._getSeparatorFoldKey();window.localStorage.setItem(key,JSON.stringify(unfoldedSeparators));this.state.unfoldedSeparators=unfoldedSeparators;}
_movePopoverIfNeeded(){if(!this.movePopoverToProperty){return;}
const propertyName=this.movePopoverToProperty;this.movePopoverToProperty=null;const popover=document.querySelector(".o_field_property_definition").closest(".o_popover");const target=document.querySelector(`*[property-name="${propertyName}"] .o_field_property_open_popover`);reposition(popover,target,{position:"top",margin:10});}
async _checkDefinitionAccess(){this.parentName=this.props.record.data[this.definitionRecordField][1];this.parentString=this.props.record.fields[this.definitionRecordField].string;if(!this.definitionRecordModel){this.state.canChangeDefinition=false;return;}
this.state.canChangeDefinition=await this.user.checkAccessRight(this.definitionRecordModel,"write");}
_regeneratePropertyName(propertyDefinition){const initialValues=this.initialValues[propertyDefinition.name];if(initialValues&&propertyDefinition.type===initialValues.type&&propertyDefinition.comodel===initialValues.comodel){propertyDefinition.name=initialValues.name;}else if(initialValues&&initialValues.name===propertyDefinition.name){const newName=this.generatePropertyName();this.initialValues[newName]=initialValues;propertyDefinition.name=newName;}}
_getPropertyIndex(propertyName){const initialName=this.initialValues[propertyName]?.name||propertyName;return this.propertiesList.findIndex((property)=>[propertyName,initialName].includes(property.name));}
_saveInitialPropertiesValues(){this.initialValues={};for(const propertiesValues of this.props.record.data[this.props.name]||[]){this.initialValues[propertiesValues.name]={name:propertiesValues.name,type:propertiesValues.type,comodel:propertiesValues.comodel,};}}
_openPropertyDefinition(target,propertyName,isNewlyCreated=false){const propertiesList=this.propertiesList;const propertyIndex=propertiesList.findIndex((property)=>property.name===propertyName);const currentName=(propertyName)=>{const propertiesList=this.propertiesList;for(const[newName,initialValue]of Object.entries(this.initialValues)){if(initialValue.name===propertyName){const prop=propertiesList.find((prop)=>prop.name===newName);if(prop){return newName;}}}
return propertyName;};this.onCloseCurrentPopover=()=>{this.onCloseCurrentPopover=null;this.state.movedPropertyName=null;target.classList.remove("disabled");if(isNewlyCreated){this._setDefaultPropertyValue(currentName(propertyName));}};this.popover.open(target,{readonly:this.props.readonly||!this.state.canChangeDefinition,canChangeDefinition:this.state.canChangeDefinition,checkDefinitionWriteAccess:()=>this.checkDefinitionWriteAccess(),propertyDefinition:this.propertiesList.find((property)=>property.name===currentName(propertyName)),context:this.props.context,onChange:this.onPropertyDefinitionChange.bind(this),onDelete:()=>this.onPropertyDelete(currentName(propertyName)),onPropertyMove:(direction)=>this.onPropertyMove(currentName(propertyName),direction),isNewlyCreated:isNewlyCreated,propertyIndex:propertyIndex,propertiesSize:propertiesList.length,});}
_setDefaultPropertyValue(propertyName){const propertiesValues=this.propertiesList;const newProperty=propertiesValues.find((property)=>property.name===propertyName);newProperty.value=newProperty.default;this.props.value=propertiesValues;this.props.record.update({[this.props.name]:propertiesValues});}
_unfoldPropertyGroup(targetIndex,propertiesValues){const separator=propertiesValues.findLast((property,index)=>property.type==="separator"&&index<=targetIndex);if(separator){this._unfoldSeparators([separator.name],true);}}}
const propertiesField=__exports.propertiesField={component:PropertiesField,displayName:_t("Properties"),supportedTypes:["properties"],extractProps({attrs},dynamicInfo){return{context:dynamicInfo.context,columns:parseInt(attrs.columns||"1"),showAddButton:archParseBoolean(attrs.showAddButton),};},};registry.category("fields").add("properties",propertiesField);return __exports;});;

/* /web/static/src/views/fields/properties/property_definition.js */
odoo.define('@web/views/fields/properties/property_definition',['@web/core/l10n/translation','@web/views/fields/properties/property_value','@web/core/checkbox/checkbox','@web/core/domain_selector/domain_selector','@web/core/domain','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/model_selector/model_selector','@web/views/fields/relational_utils','@web/core/utils/hooks','@web/views/fields/properties/property_definition_selection','@web/views/fields/properties/property_tags','@web/views/view_dialogs/select_create_dialog','@web/views/utils','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{PropertyValue}=require("@web/views/fields/properties/property_value");const{CheckBox}=require("@web/core/checkbox/checkbox");const{DomainSelector}=require("@web/core/domain_selector/domain_selector");const{Domain}=require("@web/core/domain");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{ModelSelector}=require("@web/core/model_selector/model_selector");const{Many2XAutocomplete}=require("@web/views/fields/relational_utils");const{useService,useOwnedDialogs}=require("@web/core/utils/hooks");const{PropertyDefinitionSelection}=require("@web/views/fields/properties/property_definition_selection");const{PropertyTags}=require("@web/views/fields/properties/property_tags");const{SelectCreateDialog}=require("@web/views/view_dialogs/select_create_dialog");const{uuid}=require("@web/views/utils");const{Component,useState,onWillUpdateProps,useEffect,useRef}=require("@odoo/owl");const PropertyDefinition=__exports.PropertyDefinition=class PropertyDefinition extends Component{setup(){this.orm=useService("orm");this.propertyDefinitionRef=useRef("propertyDefinition");this.addDialog=useOwnedDialogs();const defaultDefinition={name:false,string:"",type:"char",default:"",};const propertyDefinition={...defaultDefinition,...this.props.propertyDefinition,};this.state=useState({propertyDefinition:propertyDefinition,typeLabel:this._typeLabel(propertyDefinition.type),resModel:"",resModelDescription:"",matchingRecordsCount:undefined,propertyIndex:this.props.propertyIndex,});this._syncStateWithProps(propertyDefinition);this._domInputIdPrefix=uuid();onWillUpdateProps((newProps)=>this._syncStateWithProps(newProps.value));useEffect((event)=>{if(this.labelFocused){return;}
this.labelFocused=true;const labelInput=this.propertyDefinitionRef.el.querySelectorAll("input")[0];if(labelInput){if(this.props.isNewlyCreated){labelInput.select();}else{labelInput.focus();}}});}
get availablePropertyTypes(){return[["char",_t("Text")],["boolean",_t("Checkbox")],["integer",_t("Integer")],["float",_t("Decimal")],["date",_t("Date")],["datetime",_t("Date & Time")],["selection",_t("Selection")],["tags",_t("Tags")],["many2one",_t("Many2one")],["many2many",_t("Many2many")],["separator",_t("Separator")],];}
get isFirst(){return this.state.propertyIndex===0;}
get isLast(){return this.state.propertyIndex===this.props.propertiesSize-1;}
get propertyTagValues(){return(this.state.propertyDefinition.tags||[]).map((tag)=>tag[0]);}
getUniqueDomID(suffix){return`property_definition_${this._domInputIdPrefix}_${suffix}`;}
onPropertyLabelChange(event){const newString=event.target.value;const propertyDefinition={...this.state.propertyDefinition,string:newString,};this.props.onChange(propertyDefinition);this.state.propertyDefinition=propertyDefinition;}
onPropertyLabelKeypress(event){if(event.key!=="Enter"){return;}
this.props.close();}
onDefaultChange(newDefault){const propertyDefinition={...this.state.propertyDefinition,default:newDefault,};this.props.onChange(propertyDefinition);this.state.propertyDefinition=propertyDefinition;}
onPropertyTypeChange(newType){const propertyDefinition={...this.state.propertyDefinition,type:newType,};if(["integer","float"].includes(newType)){propertyDefinition.value=0;propertyDefinition.default=0;}else{propertyDefinition.value=false;propertyDefinition.default=false;}
delete propertyDefinition.comodel;this.props.onChange(propertyDefinition);this.state.propertyDefinition=propertyDefinition;this.state.resModel="";this.state.resModelDescription="";this.state.typeLabel=this._typeLabel(newType);}
async onModelChange(newModel){const{label,technical}=newModel;const modelChanged=technical!==this.state.resModel;this.state.resModel=technical;this.state.resModelDescription=label;const propertyDefinition={...this.state.propertyDefinition,comodel:technical,default:modelChanged?false:this.state.propertyDefinition.default,value:modelChanged?false:this.state.propertyDefinition.value,domain:modelChanged?false:this.state.propertyDefinition.domain,};this.props.onChange(propertyDefinition);this.state.propertyDefinition=propertyDefinition;await this._updateMatchingRecordsCount();}
async onDomainChange(newDomain){const propertyDefinition={...this.state.propertyDefinition,domain:newDomain,default:false,};this.props.onChange(propertyDefinition);this.state.propertyDefinition=propertyDefinition;await this._updateMatchingRecordsCount();}
onButtonDomainClick(){this.addDialog(SelectCreateDialog,{title:_t("Selected records"),noCreate:true,multiSelect:false,resModel:this.state.propertyDefinition.comodel,domain:new Domain(this.state.propertyDefinition.domain||"[]").toList(),context:this.props.context||{},});}
onPropertyMove(direction){if(direction==="up"){this.state.propertyIndex--;}else{this.state.propertyIndex++;}
this.props.onPropertyMove(direction);}
onSelectionOptionChange(newOptions){const propertyDefinition={...this.state.propertyDefinition,selection:newOptions,};this.props.onChange(propertyDefinition);this.state.propertyDefinition=propertyDefinition;}
onTagsChange(newTags){const propertyDefinition={...this.state.propertyDefinition,tags:newTags,};this.props.onChange(propertyDefinition);this.state.propertyDefinition=propertyDefinition;}
onViewInKanbanChange(newValue){const propertyDefinition={...this.state.propertyDefinition,view_in_cards:newValue,};this.props.onChange(propertyDefinition);this.state.propertyDefinition=propertyDefinition;}
async _syncStateWithProps(propertyDefinition){const newModel=propertyDefinition.comodel;const currentModel=this.state.resModel;this.state.propertyDefinition=propertyDefinition;this.state.resModel=propertyDefinition.comodel;this.state.typeLabel=this._typeLabel(propertyDefinition.type);this.state.resModel=newModel;if(newModel&&newModel!==currentModel){try{const result=await this.orm.call("ir.model","display_name_for",[[newModel]]);if(!result||!result.length){return;}
this.state.resModelDescription=result[0].display_name;}catch{this.state.resModelDescription=_t('You do not have access to the model "%s".',newModel);}
await this._updateMatchingRecordsCount();}else if(!newModel){this.state.resModelDescription="";}}
async _updateMatchingRecordsCount(){if(this.state.resModel&&this.state.resModel.length){const domainList=new Domain(this.state.propertyDefinition.domain||"[]").toList();const result=await this.orm.call(this.state.propertyDefinition.comodel,"search_count",[domainList]);this.state.matchingRecordsCount=result;}else{this.state.matchingRecordsCount=undefined;}}
_typeLabel(propertyType){const allTypes=this.availablePropertyTypes;return allTypes.find((type)=>type[0]===propertyType)[1];}}
PropertyDefinition.template="web.PropertyDefinition";PropertyDefinition.components={CheckBox,DomainSelector,Dropdown,DropdownItem,PropertyValue,Many2XAutocomplete,ModelSelector,PropertyDefinitionSelection,PropertyTags,};PropertyDefinition.props={readonly:{type:Boolean,optional:true},canChangeDefinition:{type:Boolean,optional:true},checkDefinitionWriteAccess:{type:Function,optional:true},propertyDefinition:{optional:true},context:{type:Object},isNewlyCreated:{type:Boolean,optional:true},propertyIndex:{type:Number},propertiesSize:{type:Number},onChange:{type:Function,optional:true},onDelete:{type:Function,optional:true},onPropertyMove:{type:Function,optional:true},close:{type:Function,optional:true},};return __exports;});;

/* /web/static/src/views/fields/properties/property_definition_selection.js */
odoo.define('@web/views/fields/properties/property_definition_selection',['@web/core/utils/hooks','@web/views/utils','@odoo/owl','@web/core/utils/sortable_owl'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{uuid}=require("@web/views/utils");const{Component,useState,useRef,useEffect}=require("@odoo/owl");const{useSortable}=require("@web/core/utils/sortable_owl");const PropertyDefinitionSelection=__exports.PropertyDefinitionSelection=class PropertyDefinitionSelection extends Component{setup(){this.notification=useService("notification");this.state=useState({newOption:null,});this.propertyDefinitionSelectionRef=useRef("propertyDefinitionSelection");this.addButtonRef=useRef("addButton");useEffect(()=>{if(!this.state.newOption){return;}
const inputs=this.propertyDefinitionSelectionRef.el.querySelectorAll(".o_field_property_selection_option input");if(inputs&&inputs.length&&!inputs[this.state.newOption.index].value){inputs[this.state.newOption.index].focus();}});useSortable({enable:()=>this.props.canChangeDefinition&&!this.props.readonly,ref:this.propertyDefinitionSelectionRef,handle:".o_field_property_selection_drag",elements:".o_field_property_selection_option",cursor:"grabbing",onDrop:async({element,previous})=>{const movedOption=element.getAttribute("option-name");const destinationOption=previous&&previous.getAttribute("option-name");await this.onOptionMoveTo(movedOption,destinationOption);},});}
get options(){return JSON.parse(JSON.stringify(this.props.options||[]));}
get optionsVisible(){const options=this.options||[];const newOption=this.state.newOption;if(newOption){options.splice(newOption.index,0,[newOption.name,""]);}
return options;}
onOptionCreate(index){this.state.newOption={index:index,name:uuid(),};}
onOptionChange(event,optionIndex){const target=event.target;const newLabel=target.value;if(this.options[optionIndex]&&this.options[optionIndex][1]===newLabel){return;}
const options=this.optionsVisible;if(!newLabel||!newLabel.length){options.splice(optionIndex,1);}else{options[optionIndex][1]=newLabel;}
const nonEmptyOptions=options.filter((option)=>option[1]&&option[1].length);this.props.onOptionsChange(nonEmptyOptions);if(this.state.newOption){this.state.newOption=null;}}
onOptionBlur(event,optionIndex){if(event.target.value&&event.target.value.length){return;}else if(this._ignoreBlur){this._ignoreBlur=false;return;}
if(event.relatedTarget===this.addButtonRef.el){event.stopPropagation();event.preventDefault();}else if(optionIndex===this.state.newOption?.index){this.state.newOption=null;}}
onOptionKeyDown(event,optionIndex){if(event.key==="Enter"){const newLabel=event.target.value;if(!newLabel||!newLabel.length){event.stopPropagation();event.preventDefault();return;}
this.onOptionChange(event,optionIndex);this.onOptionCreate(optionIndex+1);}else if(["ArrowUp","ArrowDown"].includes(event.key)){event.stopPropagation();event.preventDefault();if(event.key==="ArrowUp"&&optionIndex>0){const previousInput=event.target.closest(".o_field_property_selection_option").previousElementSibling.querySelector("input");previousInput.focus();}else if(event.key==="ArrowDown"&&optionIndex<this.optionsVisible.length-1){const nextInput=event.target.closest(".o_field_property_selection_option").nextElementSibling.querySelector("input");nextInput.focus();}}}
onOptionSetDefault(optionIndex){if(!this.props.canChangeDefinition){return;}
const newValue=this.optionsVisible[optionIndex][0];this.props.onDefaultOptionChange(newValue!==this.props.default?newValue:false);}
onOptionDelete(optionIndex){const options=this.optionsVisible;options.splice(optionIndex,1);this.props.onOptionsChange(options);}
onOptionMoveTo(movedOption,destinationOption){this._ignoreBlur=true;let options=this.optionsVisible;let destinationOptionIndex=options.findIndex((option)=>option[0]==destinationOption);const movedOptionIndex=options.findIndex((option)=>option[0]==movedOption);if(destinationOptionIndex<movedOptionIndex){destinationOptionIndex++;}
const activeEl=document.activeElement;if(activeEl&&this.propertyDefinitionSelectionRef.el.contains(activeEl)&&activeEl.tagName==="INPUT"){const optionName=activeEl.closest(".o_field_property_selection_option").getAttribute("option-name");const editedOptionIndex=options.findIndex((option)=>option[0]===optionName);options[editedOptionIndex][1]=activeEl.value;}
options.splice(destinationOptionIndex,0,options.splice(movedOptionIndex,1)[0]);if(this.state.newOption){const newOptionIndex=options.findIndex((option)=>option[0]===this.state.newOption.name);if(!options[newOptionIndex][1]?.length){this.state.newOption={...this.state.newOption,index:newOptionIndex,};options=options.filter((option)=>option[0]!==this.state.newOption.name);}else{this.state.newOption=null;}}
this.props.onOptionsChange(options);}}
PropertyDefinitionSelection.template="web.PropertyDefinitionSelection";PropertyDefinitionSelection.props={default:{type:String,optional:true},options:{},readonly:{type:Boolean,optional:true},canChangeDefinition:{type:Boolean,optional:true},onOptionsChange:{type:Function,optional:true},onDefaultOptionChange:{type:Function,optional:true},};return __exports;});;

/* /web/static/src/views/fields/properties/property_tags.js */
odoo.define('@web/views/fields/properties/property_tags',['@web/core/autocomplete/autocomplete','@web/core/colorlist/colorlist','@web/core/l10n/translation','@web/core/popover/popover_hook','@web/core/registry','@web/core/utils/hooks','@web/core/tags_list/tags_list','@odoo/owl'],function(require){'use strict';let __exports={};const{AutoComplete}=require("@web/core/autocomplete/autocomplete");const{ColorList}=require("@web/core/colorlist/colorlist");const{_t}=require("@web/core/l10n/translation");const{usePopover}=require("@web/core/popover/popover_hook");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{TagsList}=require("@web/core/tags_list/tags_list");const{Component}=require("@odoo/owl");class PropertyTagsColorListPopover extends Component{}
PropertyTagsColorListPopover.template="web.PropertyTagsColorListPopover";PropertyTagsColorListPopover.components={ColorList,};const PropertyTagAutoComplete=__exports.PropertyTagAutoComplete=class PropertyTagAutoComplete extends AutoComplete{}
Object.assign(PropertyTagAutoComplete,{timeout:0});const PropertyTags=__exports.PropertyTags=class PropertyTags extends Component{setup(){this.notification=useService("notification");this.popover=usePopover(this.constructor.components.Popover);}
get displayBadge(){return!this.env.config||this.env.config.viewType!=="kanban";}
get tagListItems(){if(!this.props.selectedTags||!this.props.selectedTags.length){return[];}
let value=this.props.tags.filter((tag)=>this.props.selectedTags.indexOf(tag[0])>=0);if(!this.displayBadge){value=value.filter((tag)=>tag[2]);}
const canDeleteTag=!this.props.readonly&&(this.props.canChangeTags||this.props.deleteAction==="value");return value.map((tag)=>{const[tagId,tagLabel,tagColorIndex]=tag;return{id:tagId,text:tagLabel,className:this.props.canChangeTags?"":"pe-none",colorIndex:tagColorIndex||0,onClick:(event)=>this.onTagClick(event,tagId,tagColorIndex),onDelete:canDeleteTag&&(()=>this.onTagDelete(tagId)),};});}
get selectedTags(){return JSON.parse(JSON.stringify(this.props.selectedTags||[]));}
get availableTags(){return JSON.parse(JSON.stringify(this.props.tags||[]));}
get autocompleteSources(){return[{options:(request)=>{const tagsFiltered=this.props.tags.filter((tag)=>(!this.props.selectedTags||this.props.selectedTags.indexOf(tag[0])<0)&&(!request||!request.length||tag[1].toLocaleLowerCase().indexOf(request.toLocaleLowerCase())>=0));if(!tagsFiltered||!tagsFiltered.length){if(!request||!request.length){return[{value:null,label:_t("Start typing..."),classList:"fst-italic",},];}else if(!this.props.canChangeTags){return[{value:null,label:_t("No result"),classList:"fst-italic",},];}
return[{value:{toCreate:true,value:request},label:_t('Create "%s"',request),classList:"o_field_property_dropdown_add",},];}
return tagsFiltered.map((tag)=>{return{value:tag[0],label:tag[1],};});},},];}
onOptionSelected(tagValue){if(!tagValue){return;}
if(tagValue.toCreate){this.onTagCreate(tagValue.value);}else{const selectedTags=this.selectedTags;const newValue=[...selectedTags,tagValue];this.props.onValueChange(newValue);}}
async onTagCreate(newLabel){if(!newLabel||!newLabel.length){return;}
if(!(await this.props.checkDefinitionWriteAccess())){this.notification.add(_t("You need to be able to edit parent first to add property tags"),{type:"warning"});return;}
const newValue=newLabel?newLabel.toLowerCase().replace(" ","_"):"";const existingTag=this.props.tags.find((tag)=>tag[0]===newValue);if(existingTag){this.notification.add(_t("This tag is already available"),{type:"warning",});return;}
let tagColor=this.props.tags&&this.props.tags.length?(this.props.tags[this.props.tags.length-1][2]+1)%ColorList.COLORS.length:parseInt(Math.random()*ColorList.COLORS.length);tagColor=tagColor||1;const newTag=[newValue,newLabel,tagColor];const updatedTags=[...this.availableTags,newTag];const newValues=[...this.props.selectedTags,newTag[0]];this.props.onTagsChange(updatedTags,newValues);}
onTagDelete(deleteTag){if(this.props.deleteAction==="value"){const selectedTags=this.selectedTags;const newValue=selectedTags.filter((tag)=>tag!==deleteTag);this.props.onValueChange(newValue);}else{const availableTags=this.availableTags;this.props.onTagsChange(availableTags.filter((tag)=>tag[0]!==deleteTag));}}
onTagClick(event,tagId,tagColor){if(!this.props.canChangeTags){event.currentTarget.blur();return;}
this.popover.open(event.currentTarget,{colors:[...Array(ColorList.COLORS.length).keys()],tag:{id:tagId,colorIndex:tagColor},switchTagColor:this.onTagColorSwitch.bind(this),});}
onTagColorSwitch(colorIndex,currentTag){const availableTags=this.availableTags;availableTags.find((tag)=>tag[0]===currentTag.id)[2]=colorIndex;this.props.onTagsChange(availableTags);this.popover.close();}}
PropertyTags.template="web.PropertyTags";PropertyTags.components={AutoComplete:PropertyTagAutoComplete,TagsList,ColorList,Popover:PropertyTagsColorListPopover,};PropertyTags.props={id:{type:String,optional:true},selectedTags:{},tags:{},deleteAction:{type:String},readonly:{type:Boolean,optional:true},canChangeTags:{type:Boolean,optional:true},checkDefinitionWriteAccess:{type:Function,optional:true},onValueChange:{type:Function,optional:true},onTagsChange:{type:Function,optional:true},};const PropertyTagsField=__exports.PropertyTagsField=class PropertyTagsField extends Component{static template="web.PropertyTagsField";static components={PropertyTags};get propertyTagsProps(){return{selectedTags:this.props.record.data[this.props.name]||[],tags:this.props.record.fields[this.props.name].tags||[],deleteAction:"value",readonly:this.props.readonly,canChangeTags:false,onValueChange:(value)=>{this.props.record.update({[this.props.name]:value});},};}}
const propertyTagsField=__exports.propertyTagsField={component:PropertyTagsField,};registry.category("fields").add("property_tags",propertyTagsField);return __exports;});;

/* /web/static/src/views/fields/properties/property_value.js */
odoo.define('@web/views/fields/properties/property_value',['@odoo/owl','@web/core/autocomplete/autocomplete','@web/core/checkbox/checkbox','@web/core/datetime/datetime_input','@web/core/domain','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/l10n/dates','@web/core/l10n/translation','@web/core/tags_list/tags_list','@web/core/utils/hooks','@web/views/fields/formatters','@web/core/utils/numbers','@web/views/fields/many2one/many2one_field','@web/views/fields/parsers','@web/views/fields/relational_utils','@web/views/fields/properties/property_tags'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{AutoComplete}=require("@web/core/autocomplete/autocomplete");const{CheckBox}=require("@web/core/checkbox/checkbox");const{DateTimeInput}=require("@web/core/datetime/datetime_input");const{Domain}=require("@web/core/domain");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{deserializeDate,deserializeDateTime,formatDate,formatDateTime,serializeDate,serializeDateTime,}=require("@web/core/l10n/dates");const{_t}=require("@web/core/l10n/translation");const{TagsList}=require("@web/core/tags_list/tags_list");const{useService}=require("@web/core/utils/hooks");const{formatInteger,formatMany2one}=require("@web/views/fields/formatters");const{formatFloat}=require("@web/core/utils/numbers");const{m2oTupleFromData}=require("@web/views/fields/many2one/many2one_field");const{parseFloat,parseInteger}=require("@web/views/fields/parsers");const{Many2XAutocomplete,useOpenMany2XRecord}=require("@web/views/fields/relational_utils");const{PropertyTags}=require("@web/views/fields/properties/property_tags");const PropertyValue=__exports.PropertyValue=class PropertyValue extends Component{setup(){this.orm=useService("orm");this.action=useService("action");this.openMany2X=useOpenMany2XRecord({resModel:this.props.model,activeActions:{create:false,createEdit:false,write:true,},isToMany:false,onRecordSaved:async(record)=>{if(!record){return;}
await record.load();const recordData=m2oTupleFromData(record.data);await this.onValueChange([{id:recordData[0],name:recordData[1]}]);},fieldString:this.props.string,});}
get propertyValue(){const value=this.props.value;if(this.props.type==="float"){return value;}else if(this.props.type==="datetime"){const datetimeValue=typeof value==="string"?deserializeDateTime(value):value;return datetimeValue&&!datetimeValue.invalid?datetimeValue:false;}else if(this.props.type==="date"){const dateValue=typeof value==="string"?deserializeDate(value):value;return dateValue&&!dateValue.invalid?dateValue:false;}else if(this.props.type==="boolean"){return!!value;}else if(this.props.type==="selection"){const options=this.props.selection||[];const option=options.find((option)=>option[0]===value);return option&&option.length===2&&option[0]?option[0]:"";}else if(this.props.type==="many2one"){return!value||value.length!==2||!value[0]?false:value;}else if(this.props.type==="many2many"){if(!value||!value.length){return[];}
return value.map((many2manyValue)=>{const hasAccess=many2manyValue[1]!==null;return{id:many2manyValue[0],comodel:this.props.comodel,text:hasAccess?many2manyValue[1]:_t("No Access"),onClick:hasAccess&&this.clickableRelational&&(async()=>await this._openRecord(this.props.comodel,many2manyValue[0])),onDelete:!this.props.readonly&&hasAccess&&(()=>this.onMany2manyDelete(many2manyValue[0])),colorIndex:0,img:this.showAvatar&&hasAccess?`/web/image/${this.props.comodel}/${many2manyValue[0]}/avatar_128`:null,};});}else if(this.props.type==="tags"){return value||[];}
return value;}
get propertyDomain(){if(!this.props.domain||!this.props.domain.length){return[];}
let domain=new Domain(this.props.domain);if(this.props.type==="many2many"&&this.props.value){domain=Domain.and([domain,[["id","not in",this.props.value.map((rec)=>rec[0])]],]);}
return domain.toList();}
get displayValue(){const value=this.propertyValue;if(this.props.type==="many2one"&&value&&value.length===2){return formatMany2one(value);}else if(this.props.type==="integer"){return formatInteger(value||0);}else if(this.props.type==="float"){return formatFloat(value||0);}else if(!value){return false;}else if(this.props.type==="datetime"&&value){return formatDateTime(value);}else if(this.props.type==="date"&&value){return formatDate(value);}else if(this.props.type==="selection"){return this.props.selection.find((option)=>option[0]===value)[1];}
return value.toString();}
get clickableRelational(){return!this.env.config||this.env.config.viewType!=="kanban";}
get showAvatar(){return(["many2one","many2many"].includes(this.props.type)&&["res.users","res.partner"].includes(this.props.comodel));}
async onValueChange(newValue){if(this.props.type==="datetime"){newValue=newValue&&serializeDateTime(newValue);}else if(this.props.type==="date"){newValue=newValue&&serializeDate(newValue);}else if(this.props.type==="integer"){try{newValue=parseInteger(newValue)||0;}catch{newValue=0;}}else if(this.props.type==="float"){try{newValue=parseFloat(newValue)||0;}catch{newValue=0;}}else if(["many2one","many2many"].includes(this.props.type)){newValue=newValue&&newValue.length&&newValue[0].id?[newValue[0].id,newValue[0].name]:false;if(newValue&&newValue[0]&&newValue[1]===undefined){newValue=await this._nameGet(newValue[0]);}
if(this.props.type==="many2many"&&newValue){const currentValue=this.props.value||[];const recordId=newValue[0];const exists=currentValue.find((rec)=>rec[0]===recordId);if(exists){return;}
newValue=[...currentValue,newValue];}}
this.props.onChange(newValue);}
async onMany2oneClick(event){if(this.props.readonly){event.stopPropagation();await this._openRecord(this.props.comodel,this.propertyValue[0]);}}
onExternalLinkClick(){return this.openMany2X({resId:this.propertyValue[0],forceModel:this.props.comodel,context:this.context,});}
onMany2manyDelete(many2manyId){const currentValue=JSON.parse(JSON.stringify(this.props.value||[]));const newValue=currentValue.filter((value)=>value[0]!==many2manyId);this.props.onChange(newValue);}
async onQuickCreate(name,params={}){const result=await this.orm.call(this.props.comodel,"name_create",[name],{context:this.props.context,});this.onValueChange([{id:result[0],name:result[1]}]);}
async _openRecord(recordModel,recordId){const action=await this.orm.call(recordModel,"get_formview_action",[[recordId]],{context:this.props.context,});this.action.doAction(action);}
async _nameGet(recordId){const result=await this.orm.read(this.props.comodel,[recordId],["display_name"],{context:this.props.context,});return[result[0].id,result[0].display_name];}}
PropertyValue.template="web.PropertyValue";PropertyValue.components={Dropdown,DropdownItem,CheckBox,DateTimeInput,Many2XAutocomplete,TagsList,AutoComplete,PropertyTags,};PropertyValue.props={id:{type:String,optional:true},type:{type:String,optional:true},comodel:{type:String,optional:true},domain:{type:String,optional:true},string:{type:String,optional:true},value:{optional:true},context:{type:Object},readonly:{type:Boolean,optional:true},canChangeDefinition:{type:Boolean,optional:true},checkDefinitionWriteAccess:{type:Function,optional:true},selection:{type:Array,optional:true},tags:{type:Array,optional:true},onChange:{type:Function,optional:true},onTagsChange:{type:Function,optional:true},};return __exports;});;

/* /web/static/src/views/fields/radio/radio_field.js */
odoo.define('@web/views/fields/radio/radio_field',['@odoo/owl','@web/core/l10n/translation','@web/core/registry','@web/views/fields/relational_utils','@web/views/fields/standard_field_props'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useSpecialData}=require("@web/views/fields/relational_utils");const{standardFieldProps}=require("@web/views/fields/standard_field_props");let nextId=0;const RadioField=__exports.RadioField=class RadioField extends Component{static template="web.RadioField";static props={...standardFieldProps,orientation:{type:String,optional:true},label:{type:String,optional:true},domain:{type:Array,optional:true},};static defaultProps={orientation:"vertical",};setup(){this.id=`radio_field_${nextId++}`;this.type=this.props.record.fields[this.props.name].type;if(this.type==="many2one"){this.specialData=useSpecialData(async(orm,props)=>{const{relation}=props.record.fields[props.name];const kwargs={specification:{display_name:1},domain:props.domain,};const{records}=await orm.call(relation,"web_search_read",[],kwargs);return records.map((record)=>[record.id,record.display_name]);});}}
get items(){switch(this.type){case"selection":return this.props.record.fields[this.props.name].selection;case"many2one":{return this.specialData.data;}
default:return[];}}
get value(){switch(this.type){case"selection":return this.props.record.data[this.props.name];case"many2one":return Array.isArray(this.props.record.data[this.props.name])?this.props.record.data[this.props.name][0]:this.props.record.data[this.props.name];default:return null;}}
onChange(value){switch(this.type){case"selection":this.props.record.update({[this.props.name]:value[0]});break;case"many2one":this.props.record.update({[this.props.name]:value});break;}}}
const radioField=__exports.radioField={component:RadioField,displayName:_t("Radio"),supportedOptions:[{label:_t("Display horizontally"),name:"horizontal",type:"boolean",},],supportedTypes:["many2one","selection"],isEmpty:(record,fieldName)=>record.data[fieldName]===false,extractProps:({options,string},dynamicInfo)=>({orientation:options.horizontal?"horizontal":"vertical",label:string,domain:dynamicInfo.domain(),}),};registry.category("fields").add("radio",radioField);return __exports;});;

/* /web/static/src/views/fields/reference/reference_field.js */
odoo.define('@web/views/fields/reference/reference_field',['@web/core/l10n/translation','@web/core/registry','@web/model/relational_model/utils','@web/views/fields/many2one/many2one_field','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useRecordObserver}=require("@web/model/relational_model/utils");const{many2OneField,Many2OneField}=require("@web/views/fields/many2one/many2one_field");const{Component,useState}=require("@odoo/owl");const ReferenceField=__exports.ReferenceField=class ReferenceField extends Component{static template="web.ReferenceField";static components={Many2OneField,};static props={...Many2OneField.props,hideModel:{type:Boolean,optional:true},modelField:{type:String,optional:true},};static defaultProps={...Many2OneField.defaultProps,};setup(){this.state=useState({formattedCharValue:undefined,modelName:undefined,currentRelation:undefined,});if(this._isCharField(this.props)){let currentValue=undefined;useRecordObserver(async(record)=>{if(currentValue!==record.data[this.props.name]){this.state.formattedCharValue=await this._fetchReferenceCharData(this.props);currentValue=record.data[this.props.name];}});}else if(this.props.modelField){useRecordObserver(async(record)=>{if(this.currentModelId!==record.data[this.props.modelField]?.[0]){this.state.modelName=await this._fetchModelTechnicalName(this.props);if(this.currentModelId!==undefined){record.update({[this.props.name]:false});}
this.currentModelId=record.data[this.props.modelField]?.[0];}});}}
get m2oProps(){const value=this.getValue();const p={...this.props,relation:this.getRelation(),value:value&&[value.resId,value.displayName],update:this.updateM2O.bind(this),};delete p.hideModel;delete p.modelField;return p;}
get selection(){if(!this._isCharField(this.props)&&!this.hideModelSelector){return this.props.record.fields[this.props.name].selection;}
return[];}
get relation(){return this.getRelation();}
get hideModelSelector(){return this.props.hideModel||this.props.modelField;}
getRelation(){const modelName=this.getModelName();if(modelName){return modelName;}
const value=this.getValue();if(value&&value.resModel){return value.resModel;}else{return this.state.currentRelation;}}
getValue(){if(this._isCharField(this.props)){return this.state.formattedCharValue;}else{return this.props.record.data[this.props.name];}}
getModelName(){return this.hideModelSelector&&this.state.modelName;}
updateModel(value){this.state.currentRelation=value;this.props.record.update({[this.props.name]:false});}
updateM2O(data){const value=data[this.props.name];const resModel=this.state.currentRelation||this.getRelation();this.props.record.update({[this.props.name]:value&&{resModel,resId:value[0],displayName:value[1],},});}
_isCharField(props){return props.record.fields[props.name].type==="char";}
async _fetchReferenceCharData(props){const recordData=props.record.data[props.name];if(!recordData){return false;}
const[resModel,_resId]=recordData.split(",");const resId=parseInt(_resId,10);if(resModel&&resId){const{specialDataCaches,orm}=props.record.model;const key=`__reference__name_get-${recordData}`;if(!specialDataCaches[key]){specialDataCaches[key]=orm.read(resModel,[resId],["display_name"]);}
const result=await specialDataCaches[key];return{resId,resModel,displayName:result[0].display_name,};}
return false;}
_assertMany2OneToIrModel(props){const field=props.modelField&&props.record.fields[props.modelField];if(field&&(field.type!=="many2one"||field.relation!=="ir.model")){throw new Error(`The model_field (${props.modelField}) of the reference field ${props.name} must be a many2one('ir.model').`);}}
async _fetchModelTechnicalName(props){this._assertMany2OneToIrModel(props);const record=props.record;const modelId=record.data[props.modelField]?.[0];if(!modelId){return false;}
const{specialDataCaches,orm}=props.record.model;const key=`__reference__ir_model-${modelId}`;if(!specialDataCaches[key]){specialDataCaches[key]=orm.read("ir.model",[modelId],["model"]);}
const result=await specialDataCaches[key];return result[0].model;}}
const referenceField=__exports.referenceField={component:ReferenceField,displayName:_t("Reference"),supportedOptions:[{label:_t("Hide model"),name:"hide_model",type:"boolean",},{label:_t("Model field"),name:"model_field",type:"field",availableTypes:["many2one"],},],supportedTypes:["reference","char"],extractProps({options}){const props=many2OneField.extractProps(...arguments);props.hideModel=!!options.hide_model;props.modelField=options.model_field;return props;},};registry.category("fields").add("reference",referenceField);return __exports;});;

/* /web/static/src/views/fields/relational_utils.js */
odoo.define('@web/views/fields/relational_utils',['@web/core/l10n/translation','@web/core/autocomplete/autocomplete','@web/core/context','@web/core/dialog/dialog','@web/core/domain','@web/core/network/rpc_service','@web/core/utils/cache','@web/core/utils/hooks','@web/core/utils/xml','@web/views/form/form_arch_parser','@web/views/form/form_controller','@web/views/form/form_renderer','@web/model/relational_model/utils','@web/views/utils','@web/views/view_button/view_button','@web/views/view_button/view_button_hook','@web/views/view_dialogs/form_view_dialog','@web/views/view_dialogs/select_create_dialog','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{AutoComplete}=require("@web/core/autocomplete/autocomplete");const{makeContext}=require("@web/core/context");const{Dialog}=require("@web/core/dialog/dialog");const{Domain}=require("@web/core/domain");const{RPCError}=require("@web/core/network/rpc_service");const{Cache}=require("@web/core/utils/cache");const{useBus,useChildRef,useForwardRefToParent,useOwnedDialogs,useService,}=require("@web/core/utils/hooks");const{createElement,parseXML}=require("@web/core/utils/xml");const{FormArchParser}=require("@web/views/form/form_arch_parser");const{loadSubViews}=require("@web/views/form/form_controller");const{FormRenderer}=require("@web/views/form/form_renderer");const{extractFieldsFromArchInfo,useRecordObserver}=require("@web/model/relational_model/utils");const{computeViewClassName,isNull}=require("@web/views/utils");const{ViewButton}=require("@web/views/view_button/view_button");const{executeButtonCallback,useViewButtons}=require("@web/views/view_button/view_button_hook");const{FormViewDialog}=require("@web/views/view_dialogs/form_view_dialog");const{SelectCreateDialog}=require("@web/views/view_dialogs/select_create_dialog");const{Component,onWillUpdateProps,useComponent,useEffect,useEnv,useState,useSubEnv,}=require("@odoo/owl");__exports.useSelectCreate=useSelectCreate;function useSelectCreate({resModel,activeActions,onSelected,onCreateEdit,onUnselect}){const addDialog=useOwnedDialogs();function selectCreate({domain,context,filters,title}){addDialog(SelectCreateDialog,{title:title||_t("Select records"),noCreate:!activeActions.create,multiSelect:"link"in activeActions?activeActions.link:false,resModel,context,domain,onSelected,onCreateEdit:()=>onCreateEdit({context}),dynamicFilters:filters,onUnselect,});}
return selectCreate;}
const STANDARD_ACTIVE_ACTIONS=["create","createEdit","delete","link","unlink","write"];__exports.useActiveActions=useActiveActions;function useActiveActions({fieldType,subViewActiveActions={},crudOptions={},getEvalParams=()=>({}),}){const compute=({evalContext={},readonly=true})=>{const result={type:fieldType,onDelete:null};const evalAction=(actionName)=>evals[actionName](evalContext);result.create=!readonly&&evalAction("create");result.createEdit=!readonly&&result.create&&crudOptions.createEdit;result.delete=!readonly&&evalAction("delete");if(isMany2Many){result.link=!readonly&&evalAction("link");result.unlink=!readonly&&evalAction("unlink");result.write=evalAction("write");}
if(result.unlink||(!isMany2Many&&result.delete)){result.onDelete=crudOptions.onDelete;}
return result;};const props=useComponent().props;const isMany2Many=fieldType==="many2many";const evals={};for(const actionName of STANDARD_ACTIVE_ACTIONS){let evalFn=()=>actionName!=="write";if(!isNull(crudOptions[actionName])){const action=crudOptions[actionName];evalFn=(evalContext)=>Boolean(action&&new Domain(action).contains(evalContext));}
if(actionName in subViewActiveActions){const viewActiveAction=subViewActiveActions[actionName];evals[actionName]=(evalContext)=>viewActiveAction&&evalFn(evalContext);}else{evals[actionName]=evalFn;}}
const activeActions=compute(getEvalParams(props));onWillUpdateProps((nextProps)=>{Object.assign(activeActions,compute(getEvalParams(nextProps)));});return activeActions;}
__exports.useSpecialData=useSpecialData;function useSpecialData(loadFn){const component=useComponent();const record=component.props.record;const key=`${record.resModel}-${component.props.name}`;const{specialDataCaches}=record.model;const orm=component.env.services.orm;const ormWithCache=Object.create(orm);if(!specialDataCaches[key]){specialDataCaches[key]=new Cache((...args)=>orm.call(...args),(...path)=>JSON.stringify(path));}
ormWithCache.call=(...args)=>specialDataCaches[key].read(...args);const result=useState({data:{}});useRecordObserver(async(record,props)=>{result.data=await loadFn(ormWithCache,{...props,record});});onWillUpdateProps(async(props)=>{if(props.record.id===component.props.record.id){result.data=await loadFn(ormWithCache,props);}});return result;}
const Many2XAutocomplete=__exports.Many2XAutocomplete=class Many2XAutocomplete extends Component{setup(){this.orm=useService("orm");this.autoCompleteContainer=useForwardRefToParent("autocomplete_container");const{activeActions,resModel,update,isToMany,fieldString}=this.props;this.openMany2X=useOpenMany2XRecord({resModel,activeActions,isToMany,onRecordSaved:(record)=>{return update([{...record.data,id:record.resId}]);},onRecordDiscarded:()=>{if(!isToMany){this.props.update(false);}},fieldString,onClose:()=>{const autoCompleteInput=this.autoCompleteContainer.el.querySelector("input");if(this.props.value!==autoCompleteInput.value){autoCompleteInput.value="";}
autoCompleteInput.focus();},});this.selectCreate=useSelectCreate({resModel,activeActions,onSelected:(resId)=>{const resIds=Array.isArray(resId)?resId:[resId];const values=resIds.map((id)=>({id}));return update(values);},onCreateEdit:({context})=>this.openMany2X({context}),onUnselect:isToMany?undefined:()=>update(),});}
get sources(){return[this.optionsSource];}
get optionsSource(){return{placeholder:_t("Loading..."),options:this.loadOptionsSource.bind(this),};}
get activeActions(){return this.props.activeActions||{};}
getCreationContext(value){return makeContext([this.props.context,{[`default_${this.props.nameCreateField}`]:value},]);}
onInput({inputValue}){if(!this.props.value||this.props.value!==inputValue){this.props.setInputFloats(true);}}
onCancel(){this.props.setInputFloats(false);}
onSelect(option,params={}){if(option.action){return option.action(params);}
const record={id:option.value,display_name:option.displayName,};this.props.update([record],params);}
search(name){return this.orm.call(this.props.resModel,"name_search",[],{name:name,operator:"ilike",args:this.props.getDomain(),limit:this.props.searchLimit+1,context:this.props.context,});}
mapRecordToOption(result){return{value:result[0],label:result[1]?result[1].split("\n")[0]:_t("Unnamed"),displayName:result[1],};}
async loadOptionsSource(request){if(this.lastProm){this.lastProm.abort(false);}
this.lastProm=this.search(request);const records=await this.lastProm;const options=records.map((result)=>this.mapRecordToOption(result));if(this.props.quickCreate&&request.length){options.push({label:_t('Create "%s"',request),classList:"o_m2o_dropdown_option o_m2o_dropdown_option_create",action:async(params)=>{try{await this.props.quickCreate(request,params);}catch(e){if(e instanceof RPCError&&e.exceptionName==="odoo.exceptions.ValidationError"){const context=this.getCreationContext(request);return this.openMany2X({context});}
throw e;}},});}
if(!this.props.noSearchMore&&records.length>0){options.push({label:_t("Search More..."),action:this.onSearchMore.bind(this,request),classList:"o_m2o_dropdown_option o_m2o_dropdown_option_search_more",});}
const canCreateEdit="createEdit"in this.activeActions?this.activeActions.createEdit:this.activeActions.create;if(!request.length&&!this.props.value&&(this.props.quickCreate||canCreateEdit)){options.push({label:_t("Start typing..."),classList:"o_m2o_start_typing",unselectable:true,});}
if(request.length&&canCreateEdit){const context=this.getCreationContext(request);options.push({label:_t("Create and edit..."),classList:"o_m2o_dropdown_option o_m2o_dropdown_option_create_edit",action:()=>this.openMany2X({context}),});}
if(!records.length&&!this.activeActions.createEdit&&!this.props.quickCreate){options.push({label:_t("No records"),classList:"o_m2o_no_result",unselectable:true,});}
return options;}
async onBarcodeSearch(){const autoCompleteInput=this.autoCompleteContainer.el.querySelector("input");return this.onSearchMore(autoCompleteInput.value);}
async onSearchMore(request){const{resModel,getDomain,context,fieldString}=this.props;const domain=getDomain();let dynamicFilters=[];if(request.length){const nameGets=await this.orm.call(resModel,"name_search",[],{name:request,args:domain,operator:"ilike",limit:this.props.searchMoreLimit,context,});dynamicFilters=[{description:_t("Quick search: %s",request),domain:[["id","in",nameGets.map((nameGet)=>nameGet[0])]],},];}
const title=_t("Search: %s",fieldString);this.selectCreate({domain,context,filters:dynamicFilters,title,});}
onChange({inputValue}){if(!inputValue.length){this.props.update(false);}}}
Many2XAutocomplete.template="web.Many2XAutocomplete";Many2XAutocomplete.components={AutoComplete};Many2XAutocomplete.props={value:{type:String,optional:true},activeActions:Object,context:{type:Object,optional:true},nameCreateField:{type:String,optional:true},setInputFloats:{type:Function,optional:true},update:Function,resModel:String,getDomain:Function,searchLimit:{type:Number,optional:true},quickCreate:{type:[Function,{value:null}],optional:true},noSearchMore:{type:Boolean,optional:true},searchMoreLimit:{type:Number,optional:true},fieldString:String,id:{type:String,optional:true},placeholder:{type:String,optional:true},autoSelect:{type:Boolean,optional:true},isToMany:{type:Boolean,optional:true},autocomplete_container:{type:Function,optional:true},dropdown:{type:Boolean,optional:true},autofocus:{type:Boolean,optional:true},};Many2XAutocomplete.defaultProps={searchLimit:7,searchMoreLimit:320,nameCreateField:"name",value:"",setInputFloats:()=>{},quickCreate:null,context:{},dropdown:true,};const AvatarMany2XAutocomplete=__exports.AvatarMany2XAutocomplete=class AvatarMany2XAutocomplete extends Many2XAutocomplete{mapRecordToOption(result){return{...super.mapRecordToOption(result),resModel:this.props.resModel,};}
get optionsSource(){return{...super.optionsSource,optionTemplate:"web.AvatarMany2XAutocomplete",};}}
__exports.useOpenMany2XRecord=useOpenMany2XRecord;function useOpenMany2XRecord({resModel,onRecordSaved,onRecordDiscarded,fieldString,activeActions,isToMany,onClose=(isNew)=>{},}){const addDialog=useOwnedDialogs();const orm=useService("orm");return async function openDialog({resId=false,forceModel=null,title,context},immediate=false){const model=forceModel||resModel;let viewId;if(resId!==false){viewId=await orm.call(model,"get_formview_id",[[resId]],{context,});}
let resolve=()=>{};if(!title){title=resId?_t("Open: %s",fieldString):_t("Create %s",fieldString);}
const{create:canCreate,write:canWrite}=activeActions;const mode=(resId?canWrite:canCreate)?"edit":"readonly";addDialog(FormViewDialog,{preventCreate:!canCreate,preventEdit:!canWrite,title,context,mode,resId,resModel:model,viewId,onRecordSaved,onRecordDiscarded,isToMany,},{onClose:()=>{resolve();const isNew=!resId;onClose(isNew);},});if(!immediate){return new Promise((_resolve)=>{resolve=_resolve;});}};}
const X2ManyFieldDialog=__exports.X2ManyFieldDialog=class X2ManyFieldDialog extends Component{setup(){this.archInfo=this.props.archInfo;this.record=this.props.record;this.title=this.props.title;this.contentClass=computeViewClassName("form",this.archInfo.xmlDoc);useSubEnv({config:this.props.config});this.env.dialogData.dismiss=()=>this.discard();useBus(this.record.model.bus,"update",()=>this.render(true));this.modalRef=useChildRef();const reload=()=>this.record.load();useViewButtons(this.props.record.model,this.modalRef,{reload,beforeExecuteAction:this.beforeExecuteActionButton.bind(this),});this.canCreate=!this.record.resId;if(this.archInfo.xmlDoc.querySelector("footer:not(field footer)")){this.archInfo={...this.archInfo,xmlDoc:this.archInfo.xmlDoc.cloneNode(true)};this.footerArchInfo=Object.assign({},this.archInfo);this.footerArchInfo.xmlDoc=createElement("t");this.footerArchInfo.xmlDoc.append(...this.archInfo.xmlDoc.querySelectorAll("footer:not(field footer)"));this.footerArchInfo.arch=this.footerArchInfo.xmlDoc.outerHTML;this.archInfo.arch=this.archInfo.xmlDoc.outerHTML;}
const{autofocusFieldId,disableAutofocus}=this.archInfo;if(!disableAutofocus){useEffect((isInEdition)=>{let elementToFocus;if(isInEdition){elementToFocus=(autofocusFieldId&&this.modalRef.el.querySelector(`#${autofocusFieldId}`))||this.modalRef.el.querySelector(".o_field_widget input");}else{elementToFocus=this.modalRef.el.querySelector("button.btn-primary");}
if(elementToFocus){elementToFocus.focus();}else{this.modalRef.el.focus();}},()=>[this.record.isInEdition]);}}
async beforeExecuteActionButton(clickParams){if(clickParams.special!=="cancel"){return this.record.save();}}
async discard(){if(this.record.isInEdition){await this.record.discard();}
this.props.close();}
save({saveAndNew}){return executeButtonCallback(this.modalRef.el,async()=>{if(await this.record.checkValidity({displayNotification:true})){await this.props.save(this.record);if(saveAndNew){await this.record.switchMode("readonly");this.record=await this.props.addNew();}}else{return false;}
if(!saveAndNew){this.props.close();}
return true;});}
async remove(){await this.props.delete();this.props.close();}
async saveAndNew(){const saved=await this.save({saveAndNew:true});if(saved){if(this.title){this.title=this.title.replace(_t("Open:"),_t("New:"));}
this.render(true);}}}
X2ManyFieldDialog.components={Dialog,FormRenderer,ViewButton};X2ManyFieldDialog.props={archInfo:Object,close:Function,record:Object,addNew:Function,save:Function,title:String,delete:{optional:true},deleteButtonLabel:{optional:true},config:Object,};X2ManyFieldDialog.template="web.X2ManyFieldDialog";async function getFormViewInfo({list,context,activeField,viewService,userService,env}){let formArchInfo=activeField.views.form;let fields=activeField.fields;const comodel=list.resModel;if(!formArchInfo){const{fields:formFields,relatedModels,views,}=await viewService.loadViews({context:makeContext([list.context,context]),resModel:comodel,views:[[false,"form"]],});const xmlDoc=parseXML(views.form.arch);formArchInfo=new FormArchParser().parse(xmlDoc,relatedModels,comodel);fields={...list.fields,...formFields};}
await loadSubViews(formArchInfo.fieldNodes,fields,{},comodel,viewService,userService,env.isSmall);return{archInfo:formArchInfo,fields};}
__exports.useAddInlineRecord=useAddInlineRecord;function useAddInlineRecord({addNew}){let creatingRecord=false;async function addInlineRecord({context,editable}){if(!creatingRecord){creatingRecord=true;try{await addNew({context,mode:"edit",position:editable});}finally{creatingRecord=false;}}}
return addInlineRecord;}
__exports.useOpenX2ManyRecord=useOpenX2ManyRecord;function useOpenX2ManyRecord({resModel,activeField,activeActions,getList,updateRecord,saveRecord,isMany2Many,}){const viewService=useService("view");const userService=useService("user");const env=useEnv();const addDialog=useOwnedDialogs();const viewMode=activeField.viewMode;async function openRecord({record,mode,context,title,onClose}){if(!title){title=record?_t("Open: %s",activeField.string):_t("Create %s",activeField.string);}
const list=getList();const{archInfo,fields:_fields}=await getFormViewInfo({list,context,activeField,viewService,userService,env,});const{activeFields,fields}=extractFieldsFromArchInfo(archInfo,_fields);let deleteRecord;let deleteButtonLabel=undefined;const isDuplicate=!!record;const params={activeFields,fields,mode};if(record){const{delete:canDelete,onDelete}=activeActions;deleteRecord=viewMode==="kanban"&&canDelete?()=>onDelete(record):null;deleteButtonLabel=activeActions.type==="one2many"?_t("Delete"):_t("Remove");}else{params.context=makeContext([list.context,context]);params.withoutParent=isMany2Many;}
record=await list.extendRecord(params,record);const _onClose=()=>{list.editedRecord?.switchMode("readonly");onClose?.();};addDialog(X2ManyFieldDialog,{config:env.config,archInfo,record,addNew:()=>{return getList().extendRecord(params);},save:(rec)=>{if(isDuplicate&&rec.id===record.id){return updateRecord(rec);}else{return saveRecord(rec);}},title,delete:deleteRecord,deleteButtonLabel:deleteButtonLabel,},{onClose:_onClose});}
let recordIsOpen=false;return(params)=>{if(recordIsOpen){return;}
recordIsOpen=true;const onClose=params.onClose;params={...params,onClose:(...args)=>{recordIsOpen=false;if(onClose){return onClose(...args);}},};try{return openRecord(params);}catch(e){recordIsOpen=false;throw e;}};}
__exports.useX2ManyCrud=useX2ManyCrud;function useX2ManyCrud(getList,isMany2Many){let saveRecord;if(isMany2Many){saveRecord=async(object)=>{const list=getList();if(Array.isArray(object)){return list.addAndRemove({add:object});}else{if(!object.resId||object.isDirty){await object.save();}
return list.linkTo(object.resId);}};}else{saveRecord=async(record)=>{return getList().validateExtendedRecord(record);};}
const updateRecord=async(record)=>{if(isMany2Many){await record.save();}
return getList().validateExtendedRecord(record);};const removeRecord=(record)=>{const list=getList();if(isMany2Many){return list.forget(record);}
return list.delete(record);};return{saveRecord,updateRecord,removeRecord,};}
return __exports;});;

/* /web/static/src/views/fields/remaining_days/remaining_days_field.js */
odoo.define('@web/views/fields/remaining_days/remaining_days_field',['@odoo/owl','@web/core/l10n/dates','@web/core/l10n/localization','@web/core/l10n/translation','@web/core/registry','@web/views/fields/datetime/datetime_field','@web/views/fields/standard_field_props'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{formatDate,formatDateTime}=require("@web/core/l10n/dates");const{localization}=require("@web/core/l10n/localization");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{DateTimeField}=require("@web/views/fields/datetime/datetime_field");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{DateTime}=luxon;const RemainingDaysField=__exports.RemainingDaysField=class RemainingDaysField extends Component{static components={DateTimeField};static props=standardFieldProps;static template="web.RemainingDaysField";get diffDays(){const{record,name}=this.props;const value=record.data[name];if(!value){return null;}
const today=DateTime.local().startOf("day");const diff=value.startOf("day").diff(today,"days");return Math.floor(diff.days);}
get diffString(){if(this.diffDays===null){return"";}
switch(this.diffDays){case-1:return _t("Yesterday");case 0:return _t("Today");case 1:return _t("Tomorrow");}
if(Math.abs(this.diffDays)>99){return this.formattedValue;}
if(this.diffDays<0){return _t("%s days ago",-this.diffDays);}
return _t("In %s days",this.diffDays);}
get formattedValue(){const{record,name}=this.props;return record.fields[name].type==="datetime"?formatDateTime(record.data[name],{format:localization.dateFormat}):formatDate(record.data[name]);}}
const remainingDaysField=__exports.remainingDaysField={component:RemainingDaysField,displayName:_t("Remaining Days"),supportedTypes:["date","datetime"],};registry.category("fields").add("remaining_days",remainingDaysField);return __exports;});;

/* /web/static/src/views/fields/selection/filterable_selection_field.js */
odoo.define('@web/views/fields/selection/filterable_selection_field',['@web/core/registry','@web/views/fields/selection/selection_field'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{SelectionField,selectionField}=require("@web/views/fields/selection/selection_field");const FilterableSelectionField=__exports.FilterableSelectionField=class FilterableSelectionField extends SelectionField{get options(){let options=super.options;if(this.props.whitelisted_values){options=options.filter((option)=>{return option[0]===this.props.record.data[this.props.name]||this.props.whitelisted_values.includes(option[0])});}else if(this.props.blacklisted_values){options=options.filter((option)=>{return option[0]===this.props.record.data[this.props.name]||!this.props.blacklisted_values.includes(option[0]);});}
return options;}};FilterableSelectionField.props={...SelectionField.props,whitelisted_values:{type:Array,optional:true},blacklisted_values:{type:Array,optional:true},};const filterableSelectionField=__exports.filterableSelectionField={...selectionField,component:FilterableSelectionField,supportedOptions:[{label:"Whitelisted Values",name:"whitelisted_values",type:"string",},{label:"Blacklisted Values",name:"blacklisted_values",type:"string",}],extractProps({options}){const props=selectionField.extractProps(...arguments);props.whitelisted_values=options.whitelisted_values;props.blacklisted_values=options.blacklisted_values;return props;},};registry.category("fields").add("filterable_selection",filterableSelectionField);return __exports;});;

/* /web/static/src/views/fields/selection/selection_field.js */
odoo.define('@web/views/fields/selection/selection_field',['@odoo/owl','@web/core/l10n/translation','@web/core/registry','@web/views/fields/relational_utils','@web/views/fields/standard_field_props'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useSpecialData}=require("@web/views/fields/relational_utils");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const SelectionField=__exports.SelectionField=class SelectionField extends Component{static template="web.SelectionField";static props={...standardFieldProps,placeholder:{type:String,optional:true},required:{type:Boolean,optional:true},domain:{type:Array,optional:true},autosave:{type:Boolean,optional:true},};static defaultProps={autosave:false,};setup(){this.type=this.props.record.fields[this.props.name].type;if(this.type==="many2one"){this.specialData=useSpecialData((orm,props)=>{const{relation}=props.record.fields[props.name];return orm.call(relation,"name_search",["",props.domain]);});}}
get options(){switch(this.type){case"many2one":return[...this.specialData.data];case"selection":return this.props.record.fields[this.props.name].selection.filter((option)=>option[0]!==false&&option[1]!=="");default:return[];}}
get string(){switch(this.type){case"many2one":return this.props.record.data[this.props.name]?this.props.record.data[this.props.name][1]:"";case"selection":return this.props.record.data[this.props.name]!==false?this.options.find((o)=>o[0]===this.props.record.data[this.props.name])[1]:"";default:return"";}}
get value(){const rawValue=this.props.record.data[this.props.name];return this.type==="many2one"&&rawValue?rawValue[0]:rawValue;}
stringify(value){return JSON.stringify(value);}
onChange(ev){const value=JSON.parse(ev.target.value);switch(this.type){case"many2one":if(value===false){this.props.record.update({[this.props.name]:false},{save:this.props.autosave});}else{this.props.record.update({[this.props.name]:this.options.find((option)=>option[0]===value),},{save:this.props.autosave});}
break;case"selection":this.props.record.update({[this.props.name]:value},{save:this.props.autosave});break;}}}
const selectionField=__exports.selectionField={component:SelectionField,displayName:_t("Selection"),supportedTypes:["many2one","selection"],isEmpty:(record,fieldName)=>record.data[fieldName]===false,extractProps({attrs,viewType},dynamicInfo){const props={autosave:viewType==="kanban",placeholder:attrs.placeholder,required:dynamicInfo.required,domain:dynamicInfo.domain(),};if(viewType==="kanban"){props.readonly=dynamicInfo.readonly;}
return props;},};registry.category("fields").add("selection",selectionField);registry.category("fields").add("kanban.selection",selectionField);return __exports;});;

/* /web/static/src/views/fields/signature/signature_field.js */
odoo.define('@web/views/fields/signature/signature_field',['@web/core/l10n/translation','@web/core/registry','@web/core/signature/signature_dialog','@web/core/utils/hooks','@web/core/utils/urls','@web/core/utils/binary','@web/views/fields/image/image_field','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{SignatureDialog}=require("@web/core/signature/signature_dialog");const{useService}=require("@web/core/utils/hooks");const{url}=require("@web/core/utils/urls");const{isBinarySize}=require("@web/core/utils/binary");const{fileTypeMagicWordMap,imageCacheKey}=require("@web/views/fields/image/image_field");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component,useState}=require("@odoo/owl");const placeholder="/web/static/img/placeholder.png";const SignatureField=__exports.SignatureField=class SignatureField extends Component{static template="web.SignatureField";static props={...standardFieldProps,defaultFont:{type:String},fullName:{type:String,optional:true},height:{type:Number,optional:true},previewImage:{type:String,optional:true},width:{type:Number,optional:true},};setup(){this.displaySignatureRatio=3;this.dialogService=useService("dialog");this.state=useState({isValid:true,});}
get rawCacheKey(){return this.props.record.data.write_date;}
get getUrl(){const{name,previewImage,record}=this.props;if(this.state.isValid&&this.value){if(isBinarySize(this.value)){return url("/web/image",{model:record.resModel,id:record.resId,field:previewImage||name,unique:imageCacheKey(this.rawCacheKey),});}else{const magic=fileTypeMagicWordMap[this.value[0]]||"png";return`data:image/${magic};base64,${this.props.record.data[this.props.name]}`;}}
return placeholder;}
get sizeStyle(){let{width,height}=this.props;if(!this.value){if(width&&height){width=Math.min(width,this.displaySignatureRatio*height);height=width/this.displaySignatureRatio;}else if(width){height=width/this.displaySignatureRatio;}else if(height){width=height*this.displaySignatureRatio;}}
let style="";if(width){style+=`width:${width}px; max-width:${width}px;`;}
if(height){style+=`height:${height}px; max-height:${height}px;`;}
return style;}
get value(){return this.props.record.data[this.props.name];}
onClickSignature(){if(!this.props.readonly){const nameAndSignatureProps={displaySignatureRatio:3,signatureType:"signature",noInputName:true,};const{fullName,record}=this.props;let defaultName="";if(fullName){let signName;const fullNameData=record.data[fullName];if(record.fields[fullName].type==="many2one"){signName=fullNameData&&fullNameData[1];}else{signName=fullNameData;}
defaultName=signName===""?undefined:signName;}
nameAndSignatureProps.defaultFont=this.props.defaultFont;const dialogProps={defaultName,nameAndSignatureProps,uploadSignature:(signature)=>this.uploadSignature(signature),};this.dialogService.add(SignatureDialog,dialogProps);}}
onLoadFailed(){this.state.isValid=false;this.notification.add(_t("Could not display the selected image"),{type:"danger",});}
uploadSignature({signatureImage}){return this.props.record.update({[this.props.name]:signatureImage[1]||false});}}
const signatureField=__exports.signatureField={component:SignatureField,fieldDependencies:[{name:"write_date",type:"datetime"}],supportedOptions:[{label:_t("Prefill with"),name:"full_name",type:"field",availableTypes:["char","many2one"],help:_t("The selected field will be used to pre-fill the signature"),},{label:_t("Default font"),name:"default_font",type:"string",},{label:_t("Size"),name:"size",type:"selection",choices:[{label:_t("Small"),value:"[0,90]"},{label:_t("Medium"),value:"[0,180]"},{label:_t("Large"),value:"[0,270]"},],},{label:_t("Preview image field"),name:"preview_image",type:"field",availableTypes:["binary"],},],extractProps:({attrs,options})=>({defaultFont:options.default_font||"",fullName:options.full_name,height:options.size?options.size[1]||undefined:attrs.height,previewImage:options.preview_image,width:options.size?options.size[0]||undefined:attrs.width,}),};registry.category("fields").add("signature",signatureField);return __exports;});;

/* /web/static/src/views/fields/standard_field_props.js */
odoo.define('@web/views/fields/standard_field_props',[],function(require){'use strict';let __exports={};const standardFieldProps=__exports.standardFieldProps={id:{type:String,optional:true},name:{type:String},readonly:{type:Boolean,optional:true},record:{type:Object},};return __exports;});;

/* /web/static/src/views/fields/stat_info/stat_info_field.js */
odoo.define('@web/views/fields/stat_info/stat_info_field',['@web/core/l10n/translation','@web/core/registry','@web/views/utils','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{archParseBoolean}=require("@web/views/utils");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const formatters=registry.category("formatters");const StatInfoField=__exports.StatInfoField=class StatInfoField extends Component{static template="web.StatInfoField";static props={...standardFieldProps,labelField:{type:String,optional:true},noLabel:{type:Boolean,optional:true},digits:{type:Array,optional:true},string:{type:String,optional:true},};get digits(){const fieldDigits=this.props.record.fields[this.props.name].digits;return!this.props.digits&&Array.isArray(fieldDigits)?fieldDigits:this.props.digits;}
get formattedValue(){const formatter=formatters.get(this.props.record.fields[this.props.name].type);return formatter(this.props.record.data[this.props.name]||0,{digits:this.digits});}
get label(){return this.props.labelField?this.props.record.data[this.props.labelField]:this.props.string;}}
const statInfoField=__exports.statInfoField={component:StatInfoField,displayName:_t("Stat Info"),supportedOptions:[{label:_t("Label field"),name:"label_field",type:"field",availableTypes:["char"],},],supportedTypes:["float","integer","monetary"],isEmpty:()=>false,extractProps:({attrs,options,string})=>{let digits;if(attrs.digits){digits=JSON.parse(attrs.digits);}else if(options.digits){digits=options.digits;}
return{digits,labelField:options.label_field,noLabel:archParseBoolean(attrs.nolabel),string,};},};registry.category("fields").add("statinfo",statInfoField);return __exports;});;

/* /web/static/src/views/fields/state_selection/state_selection_field.js */
odoo.define('@web/views/fields/state_selection/state_selection_field',['@odoo/owl','@web/core/commands/command_hook','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/l10n/translation','@web/core/registry','@web/views/fields/formatters','@web/views/fields/standard_field_props'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{useCommand}=require("@web/core/commands/command_hook");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{formatSelection}=require("@web/views/fields/formatters");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const StateSelectionField=__exports.StateSelectionField=class StateSelectionField extends Component{static template="web.StateSelectionField";static components={Dropdown,DropdownItem,};static props={...standardFieldProps,showLabel:{type:Boolean,optional:true},withCommand:{type:Boolean,optional:true},autosave:{type:Boolean,optional:true},};static defaultProps={showLabel:true,};setup(){this.colorPrefix="o_status_";this.colors={blocked:"red",done:"green",};if(this.props.withCommand){const hotkeys=["D","F","G"];for(const[index,[value,label]]of this.options.entries()){useCommand(_t("Set kanban state as %s",label),()=>{this.updateRecord(value);},{category:"smart_action",hotkey:hotkeys[index]&&"alt+"+hotkeys[index],isAvailable:()=>this.props.record.data[this.props.name]!==value,});}}}
get options(){return this.props.record.fields[this.props.name].selection.map(([state,label])=>{return[state,this.props.record.data[`legend_${state}`]||label];});}
get currentValue(){return this.props.record.data[this.props.name]||this.options[0][0];}
get label(){if(this.props.record.data[this.props.name]&&this.props.record.data[`legend_${this.props.record.data[this.props.name][0]}`]){return this.props.record.data[`legend_${this.props.record.data[this.props.name][0]}`];}
return formatSelection(this.currentValue,{selection:this.options});}
statusColor(value){return this.colors[value]?this.colorPrefix+this.colors[value]:"";}
async updateRecord(value){await this.props.record.update({[this.props.name]:value},{save:this.props.autosave});}}
const stateSelectionField=__exports.stateSelectionField={component:StateSelectionField,displayName:_t("Label Selection"),supportedOptions:[{label:_t("Autosave"),name:"autosave",type:"boolean",default:true,help:_t("If checked, the record will be saved immediately when the field is modified."),},{label:_t("Hide label"),name:"hide_label",type:"boolean",},],supportedTypes:["selection"],extractProps({options,viewType},dynamicInfo){return{showLabel:'hide_label'in options?!options.hide_label:false,withCommand:viewType==="form",readonly:dynamicInfo.readonly,autosave:"autosave"in options?!!options.autosave:true,};},};registry.category("fields").add("state_selection",stateSelectionField);return __exports;});;

/* /web/static/src/views/fields/statusbar/statusbar_field.js */
odoo.define('@web/views/fields/statusbar/statusbar_field',['@odoo/owl','@web/core/browser/browser','@web/core/commands/command_hook','@web/core/domain','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/l10n/translation','@web/core/registry','@web/core/utils/arrays','@web/core/utils/strings','@web/core/utils/timing','@web/views/fields/relational_utils','@web/views/fields/standard_field_props'],function(require){'use strict';let __exports={};const{Component,onWillRender,useEffect,useExternalListener,useRef}=require("@odoo/owl");const{browser}=require("@web/core/browser/browser");const{useCommand}=require("@web/core/commands/command_hook");const{Domain}=require("@web/core/domain");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{groupBy}=require("@web/core/utils/arrays");const{escape}=require("@web/core/utils/strings");const{throttleForAnimation}=require("@web/core/utils/timing");const{useSpecialData}=require("@web/views/fields/relational_utils");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const hide=(...els)=>els.forEach((el)=>el.classList.add("d-none"));const show=(...els)=>els.forEach((el)=>el.classList.remove("d-none"));const StatusBarField=__exports.StatusBarField=class StatusBarField extends Component{static template="web.StatusBarField";static components={Dropdown,DropdownItem,};static props={...standardFieldProps,domain:{type:typeof Domain,optional:true},foldField:{type:String,optional:true},isDisabled:{type:Boolean,optional:true},visibleSelection:{type:Array,element:String,optional:true},withCommand:{type:Boolean,optional:true},};setup(){this.items={};this.beforeRef=useRef("before");this.rootRef=useRef("root");this.afterRef=useRef("after");this.dropdownRef=useRef("dropdown");let status="idle";const adjust=()=>{status="adjusting";this.adjustVisibleItems();this.render();browser.requestAnimationFrame(()=>(status="idle"));};useEffect(()=>status==="shouldAdjust"&&adjust(),()=>[status]);onWillRender(()=>{if(status!=="adjusting"){Object.assign(this.items,this.getSortedItems());status="shouldAdjust";}});useExternalListener(window,"resize",throttleForAnimation(adjust));if(this.field.type==="many2one"){this.specialData=useSpecialData((orm,props)=>{const{foldField,name:fieldName,record}=props;const{relation}=record.fields[fieldName];const fieldNames=["display_name"];if(foldField){fieldNames.push(foldField);}
const value=props.record.data[fieldName];let domain=props.domain;if(domain.length&&value){domain=Domain.or([[["id","=",value[0]]],domain]).toList(props.record.evalContext);}
return orm.searchRead(relation,domain,fieldNames);});}
if(this.props.withCommand){const moveToCommandName=_t("Move to %s...",escape(this.field.string));useCommand(moveToCommandName,()=>({placeholder:moveToCommandName,providers:[{provide:()=>this.getAllItems().map((item)=>({name:item.label,action:()=>this.selectItem(item),})),},],}),{category:"smart_action",hotkey:"alt+shift+x",isAvailable:()=>!this.props.isDisabled,});useCommand(_t("Move to next %s",this.field.string),()=>{const items=this.getAllItems();const nextIndex=items.findIndex((item)=>item.isSelected)+1;this.selectItem(items[nextIndex]);},{category:"smart_action",hotkey:"alt+x",isAvailable:()=>!this.props.isDisabled&&!this.getAllItems().at(-1).isSelected,});}}
get field(){return this.props.record.fields[this.props.name];}
adjustVisibleItems(){const itemEls=[...this.rootRef.el.querySelectorAll(".o_arrow_button:not(.dropdown-toggle)"),];const selectedIndex=itemEls.findIndex((el)=>el.classList.contains("o_arrow_button_current"));const itemsBefore=itemEls.slice(selectedIndex+2).reverse();const itemsAfter=itemEls.slice(0,Math.max(selectedIndex-1,0)).reverse();show(...itemEls);hide(this.dropdownRef.el,this.beforeRef.el);if(this.items.folded.length){show(this.afterRef.el);itemEls.forEach((el)=>el.classList.remove("o_first"));}else{hide(this.afterRef.el);itemEls[0]?.classList.add("o_first");}
this.items.before=[];this.items.after=[...this.items.folded];const itemsToAssign=this.getAllItems().filter((item)=>!item.isFolded);while(this.areItemsWrapping()){if(itemsBefore.length){show(this.beforeRef.el);hide(itemsBefore.shift());this.items.before.push(itemsToAssign.shift());}else if(itemsAfter.length){show(this.afterRef.el);hide(itemsAfter.pop());this.items.after.unshift(itemsToAssign.pop());}else{show(this.dropdownRef.el);hide(this.beforeRef.el,this.afterRef.el,...itemEls);break;}}}
areItemsWrapping(){const root=this.rootRef.el;const firstItem=root.querySelector(":scope > :not(.d-none)");if(!firstItem){return false;}
const{height:currentHeight}=root.getBoundingClientRect();const{height:targetHeight}=firstItem.getBoundingClientRect();return currentHeight>targetHeight;}
getAllItems(){const{foldField,name,record}=this.props;const currentValue=record.data[name];if(this.field.type==="many2one"){return this.specialData.data.map((option)=>({value:option.id,label:option.display_name,isFolded:option[foldField],isSelected:Boolean(currentValue&&option.id===currentValue[0]),}));}else{let{selection}=this.field;const{visibleSelection}=this.props;if(visibleSelection?.length){selection=selection.filter(([value])=>value===currentValue||visibleSelection.includes(value));}
return selection.map(([value,label])=>({value,label,isFolded:false,isSelected:value===currentValue,}));}}
getCurrentLabel(){return this.getAllItems().find((item)=>item.isSelected)?.label||_t("More");}
getDropdownItemClassNames(item){const classNames=[];if(item.isSelected){classNames.push("active");}
if(item.isSelected||this.props.isDisabled){classNames.push("disabled");}
return classNames.join(" ");}
getItemTooltip(item){if(item.isSelected){return _t("Current state");}
if(this.props.isDisabled){return _t("Not active state");}
return _t("Not active state, click to change it");}
getSortedItems(){const before=[];const after=[];const{true:inline=[],false:folded=[]}=groupBy(this.getAllItems(),(item)=>item.isSelected||!item.isFolded);inline.reverse();after.push(...folded);return{inline,before,after,folded};}
async selectItem(item){const{name,record}=this.props;const value=this.field.type==="many2one"?[item.value,item.label]:item.value;await record.update({[name]:value});await record.save();}
onDropdownItemSelected(ev){this.selectItem(ev.detail.payload);}}
const statusBarField=__exports.statusBarField={component:StatusBarField,displayName:_t("Status"),supportedOptions:[{label:_t("Clickable"),name:"clickable",type:"boolean",default:true,},{label:_t("Fold field"),name:"fold_field",type:"field",availableTypes:["boolean"],help:_t("Boolean field from the model used in the relation, which indicates whether the state is folded or not."),},],supportedTypes:["many2one","selection"],isEmpty:(record,fieldName)=>!record.data[fieldName],extractProps:({attrs,options,viewType},dynamicInfo)=>({isDisabled:!options.clickable||dynamicInfo.readonly,visibleSelection:attrs.statusbar_visible?.trim().split(/\s*,\s*/g),withCommand:viewType==="form",foldField:options.fold_field,domain:dynamicInfo.domain(),}),};registry.category("fields").add("statusbar",statusBarField);return __exports;});;

/* /web/static/src/views/fields/text/text_field.js */
odoo.define('@web/views/fields/text/text_field',['@web/core/l10n/translation','@web/core/registry','@web/core/utils/autoresize','@web/core/utils/hooks','@web/views/fields/dynamic_placeholder_hook','@web/views/fields/input_field_hook','@web/views/fields/parsers','@web/views/fields/standard_field_props','@web/views/fields/translation_button','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{useAutoresize}=require("@web/core/utils/autoresize");const{useSpellCheck}=require("@web/core/utils/hooks");const{useDynamicPlaceholder}=require("@web/views/fields/dynamic_placeholder_hook");const{useInputField}=require("@web/views/fields/input_field_hook");const{parseInteger}=require("@web/views/fields/parsers");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{TranslationButton}=require("@web/views/fields/translation_button");const{Component,useExternalListener,useEffect,useRef}=require("@odoo/owl");const TextField=__exports.TextField=class TextField extends Component{static template="web.TextField";static components={TranslationButton,};static props={...standardFieldProps,lineBreaks:{type:Boolean,optional:true},placeholder:{type:String,optional:true},dynamicPlaceholder:{type:Boolean,optional:true},dynamicPlaceholderModelReferenceField:{type:String,optional:true},rowCount:{type:Number,optional:true},};static defaultProps={lineBreaks:true,dynamicPlaceholder:false,rowCount:2,};setup(){this.divRef=useRef("div");this.textareaRef=useRef("textarea");if(this.props.dynamicPlaceholder){const dynamicPlaceholder=useDynamicPlaceholder(this.textareaRef);useExternalListener(document,"keydown",dynamicPlaceholder.onKeydown);useEffect(()=>dynamicPlaceholder.updateModel(this.props.dynamicPlaceholderModelReferenceField));}
useInputField({getValue:()=>this.props.record.data[this.props.name]||"",refName:"textarea",preventLineBreaks:!this.props.lineBreaks,});useSpellCheck({refName:"textarea"});useAutoresize(this.textareaRef,{minimumHeight:this.minimumHeight});}
get isTranslatable(){return this.props.record.fields[this.props.name].translate;}
get minimumHeight(){return this.props.lineBreaks?50:0;}
get rowCount(){return this.props.lineBreaks?this.props.rowCount:1;}}
const textField=__exports.textField={component:TextField,displayName:_t("Multiline Text"),supportedOptions:[{label:_t("Enable line breaks"),name:"line_breaks",type:"boolean",default:true,},],supportedTypes:["html","text"],extractProps:({attrs,options})=>({placeholder:attrs.placeholder,dynamicPlaceholder:options?.dynamic_placeholder||false,dynamicPlaceholderModelReferenceField:options?.dynamic_placeholder_model_reference_field||"",rowCount:attrs.rows&&parseInteger(attrs.rows),lineBreaks:options?.line_breaks!==undefined?Boolean(options.line_breaks):true,}),};registry.category("fields").add("text",textField);const ListTextField=__exports.ListTextField=class ListTextField extends TextField{static defaultProps={...super.defaultProps,rowCount:1,};get minimumHeight(){return 0;}
get rowCount(){return this.props.rowCount;}}
const listTextField=__exports.listTextField={...textField,component:ListTextField,};registry.category("fields").add("list.text",listTextField);return __exports;});;

/* /web/static/src/views/fields/timezone_mismatch/timezone_mismatch_field.js */
odoo.define('@web/views/fields/timezone_mismatch/timezone_mismatch_field',['@web/core/l10n/dates','@web/core/l10n/translation','@web/core/registry','@web/views/fields/selection/selection_field'],function(require){'use strict';let __exports={};const{formatDateTime}=require("@web/core/l10n/dates");const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{selectionField,SelectionField}=require("@web/views/fields/selection/selection_field");const{DateTime}=luxon;const TimezoneMismatchField=__exports.TimezoneMismatchField=class TimezoneMismatchField extends SelectionField{static template="web.TimezoneMismatchField";static props={...super.props,tzOffsetField:{type:String,optional:true},mismatchTitle:{type:String,optional:true},};static defaultProps={...super.defaultProps,tzOffsetField:"tz_offset",mismatchTitle:_t("Timezone Mismatch : This timezone is different from that of your browser.\nPlease, set the same timezone as your browser's to avoid time discrepancies in your system."),};get mismatch(){const userOffset=this.props.record.data[this.props.tzOffsetField];if(userOffset&&this.props.record.data[this.props.name]){const offset=-new Date().getTimezoneOffset();let browserOffset=offset<0?"-":"+";browserOffset+=Math.abs(offset/60).toFixed(0).padStart(2,"0");browserOffset+=Math.abs(offset%60).toFixed(0).padStart(2,"0");return browserOffset!==userOffset;}else if(!this.props.record.data[this.props.name]){return true;}
return false;}
get mismatchTitle(){if(!this.props.record.data[this.props.name]){return _t("Set a timezone on your user");}
return this.props.mismatchTitle;}
get options(){if(!this.mismatch){return super.options;}
return super.options.map((option)=>{const[value,label]=option;if(value===this.props.record.data[this.props.name]){const offset=this.props.record.data[this.props.tzOffsetField].match(/([+-])([0-9]{2})([0-9]{2})/);const sign=offset[1]==="-"?-1:1;const userOffset=sign*(parseInt(offset[2])*60+parseInt(offset[3]));const browserOffset=-new Date().getTimezoneOffset();const userUTCDatetime=DateTime.utc().plus({minutes:userOffset-browserOffset,});return[value,`${label} (${formatDateTime(userUTCDatetime)})`];}
return[value,label];});}}
const timezoneMismatchField=__exports.timezoneMismatchField={...selectionField,component:TimezoneMismatchField,additionalClasses:["d-flex"],supportedOptions:[...(selectionField.supportedOptions||[]),{label:_t("Mismatch title"),name:"mismatch_title",type:"string",},{label:_t("Timezone offset field"),name:"tz_offset_field",type:"field",availableTypes:["char"],},],extractProps({options}){const props=selectionField.extractProps(...arguments);props.tzOffsetField=options.tz_offset_field;props.mismatchTitle=options.mismatch_title;return props;},};registry.category("fields").add("timezone_mismatch",timezoneMismatchField);return __exports;});;

/* /web/static/src/views/fields/translation_button.js */
odoo.define('@web/views/fields/translation_button',['@web/core/l10n/localization','@web/core/utils/hooks','@web/views/fields/translation_dialog','@odoo/owl'],function(require){'use strict';let __exports={};const{localization}=require("@web/core/l10n/localization");const{useOwnedDialogs,useService}=require("@web/core/utils/hooks");const{TranslationDialog}=require("@web/views/fields/translation_dialog");const{Component}=require("@odoo/owl");__exports.useTranslationDialog=useTranslationDialog;function useTranslationDialog(){const addDialog=useOwnedDialogs();async function openTranslationDialog({record,fieldName}){const saved=await record.save();if(!saved){return;}
const{resModel,resId}=record;addDialog(TranslationDialog,{fieldName:fieldName,resId:resId,resModel:resModel,userLanguageValue:record.data[fieldName]||"",isComingFromTranslationAlert:false,onSave:async()=>{await record.load();},});}
return openTranslationDialog;}
const TranslationButton=__exports.TranslationButton=class TranslationButton extends Component{setup(){this.user=useService("user");this.translationDialog=useTranslationDialog();}
get isMultiLang(){return localization.multiLang;}
get lang(){return this.user.lang.split("_")[0].toUpperCase();}
onClick(){const{fieldName,record}=this.props;this.translationDialog({fieldName,record});}}
TranslationButton.template="web.TranslationButton";TranslationButton.props={fieldName:{type:String},record:{type:Object},};return __exports;});;

/* /web/static/src/views/fields/translation_dialog.js */
odoo.define('@web/views/fields/translation_dialog',['@web/core/dialog/dialog','@web/core/utils/hooks','@web/core/l10n/translation','@odoo/owl'],function(require){'use strict';let __exports={};const{Dialog}=require("@web/core/dialog/dialog");const{useService}=require("@web/core/utils/hooks");const{loadLanguages,_t}=require("@web/core/l10n/translation");const{Component,onWillStart}=require("@odoo/owl");const TranslationDialog=__exports.TranslationDialog=class TranslationDialog extends Component{setup(){super.setup();this.title=_t("Translate: %s",this.props.fieldName);this.orm=useService("orm");this.user=useService("user");this.terms=[];this.updatedTerms={};onWillStart(async()=>{const languages=await loadLanguages(this.orm);const[translations,context]=await this.loadTranslations(languages);let id=1;translations.forEach((t)=>(t.id=id++));this.props.isText=context.translation_type==="text";this.props.showSource=context.translation_show_source;this.terms=translations.map((term)=>{const relatedLanguage=languages.find((l)=>l[0]===term.lang);const termInfo={...term,langName:relatedLanguage[1],value:term.value||"",};if(term.lang===this.user.lang&&!this.props.showSource&&!this.props.isComingFromTranslationAlert){this.updatedTerms[term.id]=this.props.userLanguageValue;termInfo.value=this.props.userLanguageValue;}
return termInfo;});this.terms.sort((a,b)=>a.langName.localeCompare(b.langName));});}
get domain(){const domain=this.props.domain;if(this.props.searchName){domain.push(["name","=",`${this.props.searchName}`]);}
return domain;}
async loadTranslations(languages){return this.orm.call(this.props.resModel,"get_field_translations",[[this.props.resId],this.props.fieldName,]);}
async onSave(){const translations={};this.terms.map((term)=>{const updatedTermValue=this.updatedTerms[term.id];if(term.id in this.updatedTerms&&term.value!==updatedTermValue){if(this.props.showSource){if(!translations[term.lang]){translations[term.lang]={};}
const oldTermValue=term.value?term.value:term.source;translations[term.lang][oldTermValue]=updatedTermValue||term.source;}else{translations[term.lang]=updatedTermValue||false;}}});await this.orm.call(this.props.resModel,"update_field_translations",[[this.props.resId],this.props.fieldName,translations,]);await this.props.onSave();this.props.close();}}
TranslationDialog.template="web.TranslationDialog";TranslationDialog.components={Dialog};return __exports;});;

/* /web/static/src/views/fields/url/url_field.js */
odoo.define('@web/views/fields/url/url_field',['@web/core/registry','@web/core/l10n/translation','@web/views/fields/input_field_hook','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{_t}=require("@web/core/l10n/translation");const{useInputField}=require("@web/views/fields/input_field_hook");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const UrlField=__exports.UrlField=class UrlField extends Component{static template="web.UrlField";static props={...standardFieldProps,placeholder:{type:String,optional:true},text:{type:String,optional:true},websitePath:{type:Boolean,optional:true},};setup(){useInputField({getValue:()=>this.props.record.data[this.props.name]||""});}
get formattedHref(){let value=this.props.record.data[this.props.name];if(value&&!this.props.websitePath){const regex=/^((ftp|http)s?:\/)?\//i;value=!regex.test(value)?`http://${value}`:value;}
return value;}}
const urlField=__exports.urlField={component:UrlField,displayName:_t("URL"),supportedOptions:[{label:_t("Is a website path"),name:"website_path",type:"boolean",help:_t("If True, the url will be used as it is, without any prefix added to it."),},],supportedTypes:["char"],extractProps:({attrs,options})=>({text:attrs.text,websitePath:options.website_path,placeholder:attrs.placeholder,}),};registry.category("fields").add("url",urlField);class FormUrlField extends UrlField{static template="web.FormUrlField";}
const formUrlField=__exports.formUrlField={...urlField,component:FormUrlField,};registry.category("fields").add("form.url",formUrlField);return __exports;});;

/* /web/static/src/views/fields/x2many/list_x2many_field.js */
odoo.define('@web/views/fields/x2many/list_x2many_field',['@web/core/registry','@web/views/fields/formatters','@web/views/fields/standard_field_props','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{formatX2many}=require("@web/views/fields/formatters");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{Component}=require("@odoo/owl");const ListX2ManyField=__exports.ListX2ManyField=class ListX2ManyField extends Component{static template="web.ListX2ManyField";static props={...standardFieldProps};get formattedValue(){return formatX2many(this.props.record.data[this.props.name]);}}
const listX2ManyField=__exports.listX2ManyField={component:ListX2ManyField,useSubView:false,};registry.category("fields").add("list.one2many",listX2ManyField);registry.category("fields").add("list.many2many",listX2ManyField);return __exports;});;

/* /web/static/src/views/fields/x2many/x2many_field.js */
odoo.define('@web/views/fields/x2many/x2many_field',['@web/core/context','@web/core/py_js/py','@web/core/l10n/translation','@web/core/pager/pager','@web/core/registry','@web/views/fields/relational_utils','@web/views/fields/standard_field_props','@web/views/kanban/kanban_renderer','@web/views/list/list_renderer','@web/views/utils','@web/views/view_button/view_button','@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{makeContext}=require("@web/core/context");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{_t}=require("@web/core/l10n/translation");const{Pager}=require("@web/core/pager/pager");const{registry}=require("@web/core/registry");const{useActiveActions,useAddInlineRecord,useOpenX2ManyRecord,useSelectCreate,useX2ManyCrud,}=require("@web/views/fields/relational_utils");const{standardFieldProps}=require("@web/views/fields/standard_field_props");const{KanbanRenderer}=require("@web/views/kanban/kanban_renderer");const{ListRenderer}=require("@web/views/list/list_renderer");const{computeViewClassName}=require("@web/views/utils");const{ViewButton}=require("@web/views/view_button/view_button");const{useService}=require("@web/core/utils/hooks");const{Component}=require("@odoo/owl");const X2ManyField=__exports.X2ManyField=class X2ManyField extends Component{static template="web.X2ManyField";static components={Pager,KanbanRenderer,ListRenderer,ViewButton};static props={...standardFieldProps,addLabel:{type:String,optional:true},editable:{type:String,optional:true},viewMode:{type:String,optional:true},widget:{type:String,optional:true},crudOptions:{type:Object,optional:true},string:{type:String,optional:true},relatedFields:{type:Object,optional:true},views:{type:Object,optional:true},domain:{type:[Array,Function],optional:true},context:{type:Object},};setup(){this.field=this.props.record.fields[this.props.name];const{saveRecord,updateRecord,removeRecord}=useX2ManyCrud(()=>this.list,this.isMany2Many);this.archInfo=this.props.views?.[this.props.viewMode]||{};const classes=this.props.viewMode?["o_field_x2many",`o_field_x2many_${this.props.viewMode}`]:["o_field_x2many"];this.className=computeViewClassName(this.props.viewMode,this.archInfo.xmlDoc,classes);const{activeActions,creates}=this.archInfo;if(this.props.viewMode==="kanban"){this.creates=creates.length?creates:[{type:"create",string:this.props.addLabel||_t("Add"),class:"o-kanban-button-new",},];}
const subViewActiveActions=activeActions;this.activeActions=useActiveActions({crudOptions:Object.assign({},this.props.crudOptions,{onDelete:removeRecord,}),fieldType:this.isMany2Many?"many2many":"one2many",subViewActiveActions,getEvalParams:(props)=>{return{evalContext:props.record.evalContext,readonly:props.readonly,};},});this.addInLine=useAddInlineRecord({addNew:(...args)=>this.list.addNewRecord(...args),});const openRecord=useOpenX2ManyRecord({resModel:this.list.resModel,activeField:this.activeField,activeActions:this.activeActions,getList:()=>this.list,saveRecord,updateRecord,isMany2Many:this.isMany2Many,});this._openRecord=(params)=>{const activeElement=document.activeElement;openRecord({...params,onClose:()=>{if(activeElement){activeElement.focus();}},});};this.canOpenRecord=this.props.viewMode==="list"?!(this.archInfo.editable||this.props.editable):true;const selectCreate=useSelectCreate({resModel:this.props.record.data[this.props.name].resModel,activeActions:this.activeActions,onSelected:(resIds)=>saveRecord(resIds),onCreateEdit:({context})=>this._openRecord({context}),onUnselect:this.isMany2Many?undefined:()=>saveRecord(),});this.selectCreate=(params)=>{const p=Object.assign({},params);const currentIds=this.props.record.data[this.props.name].currentIds.filter((id)=>typeof id==="number");p.domain=[...(p.domain||[]),"!",["id","in",currentIds]];return selectCreate(p);};this.action=useService("action");}
get activeField(){return{fields:this.props.relatedFields,views:this.props.views,viewMode:this.props.viewMode,string:this.props.string,};}
get displayControlPanelButtons(){return(this.props.viewMode==="kanban"&&("link"in this.activeActions?this.activeActions.link:this.activeActions.create)&&!this.props.readonly);}
get isMany2Many(){return this.field.type==="many2many"||this.props.widget==="many2many";}
get list(){return this.props.record.data[this.props.name];}
get nestedKeyOptionalFieldsData(){return{field:this.props.name,model:this.props.record.resModel,viewMode:"form",};}
get pagerProps(){const list=this.list;return{offset:list.offset,limit:list.limit,total:list.count,onUpdate:async({offset,limit})=>{const initialLimit=this.list.limit;const leaved=await list.leaveEditMode();if(leaved){if(initialLimit===limit&&initialLimit===this.list.limit+1){offset-=1;limit-=1;}
await list.load({limit,offset});this.render();}},withAccessKey:false,};}
get rendererProps(){const{archInfo}=this;const props={archInfo,list:this.list,openRecord:this.openRecord.bind(this),evalViewModifier:(modifier)=>{return evaluateBooleanExpr(modifier,this.list.evalContext);},};if(this.props.viewMode==="kanban"){const recordsDraggable=!this.props.readonly&&archInfo.recordsDraggable;props.archInfo={...archInfo,recordsDraggable};props.readonly=this.props.readonly;props.deleteRecord=(record)=>{if(this.isMany2Many){return this.list.forget(record);}
return this.list.delete(record);};return props;}
const editable=(this.archInfo.activeActions.edit&&archInfo.editable)||this.props.editable;props.activeActions=this.activeActions;props.cycleOnTab=false;props.editable=!this.props.readonly&&editable;props.nestedKeyOptionalFieldsData=this.nestedKeyOptionalFieldsData;props.onAdd=(params)=>{params.editable=!this.props.readonly&&("editable"in params?params.editable:editable);this.onAdd(params);};const openFormView=archInfo.editable?archInfo.openFormView:false;props.onOpenFormView=openFormView?this.switchToForm.bind(this):undefined;return props;}
async switchToForm(record){await this.props.record.save();this.action.doAction({type:"ir.actions.act_window",views:[[false,"form"]],res_id:record.resId,res_model:this.list.resModel,},{props:{resIds:this.list.resIds},});}
async onAdd({context,editable}={}){const domain=typeof this.props.domain==="function"?this.props.domain():this.props.domain;context=makeContext([this.props.context,context]);if(this.isMany2Many){const{string}=this.props;const title=_t("Add: %s",string);return this.selectCreate({domain,context,title});}
if(editable){if(this.list.editedRecord){const proms=[];this.list.model.bus.trigger("NEED_LOCAL_CHANGES",{proms});await Promise.all([...proms,this.list.editedRecord._updatePromise]);await this.list.leaveEditMode({canAbandon:false});}
if(!this.list.editedRecord){return this.addInLine({context,editable});}
return;}
return this._openRecord({context});}
async openRecord(record){if(this.canOpenRecord){return this._openRecord({record,context:this.props.context,mode:this.props.readonly?"readonly":"edit",});}}}
const x2ManyField=__exports.x2ManyField={component:X2ManyField,displayName:_t("Relational table"),supportedTypes:["one2many","many2many"],useSubView:true,extractProps:({attrs,relatedFields,viewMode,views,widget,options,string},dynamicInfo)=>{const props={addLabel:attrs["add-label"],context:dynamicInfo.context,domain:dynamicInfo.domain,crudOptions:options,string,};if(viewMode){props.views=views;props.viewMode=viewMode;props.relatedFields=relatedFields;}
if(widget){props.widget=widget;}
return props;},};registry.category("fields").add("one2many",x2ManyField);registry.category("fields").add("many2many",x2ManyField);return __exports;});;

/* /web/static/src/views/form/button_box/button_box.js */
odoo.define('@web/views/form/button_box/button_box',['@web/core/utils/hooks','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@odoo/owl'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{Component,onWillRender}=require("@odoo/owl");const ButtonBox=__exports.ButtonBox=class ButtonBox extends Component{setup(){const ui=useService("ui");onWillRender(()=>{const maxVisibleButtons=[3,4,5,7,4,5,8][ui.size]||8;const allVisibleButtons=Object.entries(this.props.slots).filter(([_,slot])=>this.isSlotVisible(slot)).map(([slotName])=>slotName);if(allVisibleButtons.length<=maxVisibleButtons){this.visibleButtons=allVisibleButtons;this.additionalButtons=[];this.isFull=allVisibleButtons.length===maxVisibleButtons;}else{this.visibleButtons=allVisibleButtons.slice(0,maxVisibleButtons-1);this.additionalButtons=allVisibleButtons.slice(maxVisibleButtons-1);this.isFull=true;}});}
isSlotVisible(slot){return!("isVisible"in slot)||slot.isVisible;}}
ButtonBox.template="web.Form.ButtonBox";ButtonBox.components={Dropdown,DropdownItem};ButtonBox.props={slots:Object,class:{type:String,optional:true},};ButtonBox.defaultProps={class:"",};return __exports;});;

/* /web/static/src/views/form/form_arch_parser.js */
odoo.define('@web/views/form/form_arch_parser',['@web/core/utils/xml','@web/views/fields/field','@web/views/widgets/widget','@web/views/utils'],function(require){'use strict';let __exports={};const{visitXML}=require("@web/core/utils/xml");const{Field}=require("@web/views/fields/field");const{Widget}=require("@web/views/widgets/widget");const{archParseBoolean,getActiveActions}=require("@web/views/utils");const FormArchParser=__exports.FormArchParser=class FormArchParser{parse(xmlDoc,models,modelName){const jsClass=xmlDoc.getAttribute("js_class");const disableAutofocus=archParseBoolean(xmlDoc.getAttribute("disable_autofocus")||"");const activeActions=getActiveActions(xmlDoc);const fieldNodes={};const widgetNodes={};let widgetNextId=0;const fieldNextIds={};let autofocusFieldId=null;visitXML(xmlDoc,(node)=>{if(node.tagName==="field"){const fieldInfo=Field.parseFieldNode(node,models,modelName,"form",jsClass);if(!(fieldInfo.name in fieldNextIds)){fieldNextIds[fieldInfo.name]=0;}
const fieldId=`${fieldInfo.name}_${fieldNextIds[fieldInfo.name]++}`;fieldNodes[fieldId]=fieldInfo;node.setAttribute("field_id",fieldId);if(archParseBoolean(node.getAttribute("default_focus")||"")){autofocusFieldId=fieldId;}
if(fieldInfo.type==="properties"){activeActions.addPropertyFieldValue=true;}
return false;}else if(node.tagName==="div"&&node.classList.contains("oe_chatter")){return false;}else if(node.tagName==="widget"){const widgetInfo=Widget.parseWidgetNode(node);const widgetId=`widget_${++widgetNextId}`;widgetNodes[widgetId]=widgetInfo;node.setAttribute("widget_id",widgetId);}});return{activeActions,autofocusFieldId,disableAutofocus,fieldNodes,widgetNodes,xmlDoc,};}}
return __exports;});;

/* /web/static/src/views/form/form_compiler.js */
odoo.define('@web/views/form/form_compiler',['@web/core/registry','@web/core/ui/ui_service','@web/core/utils/xml','@web/views/utils','@web/views/view_compiler'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{SIZES}=require("@web/core/ui/ui_service");const{append,combineAttributes,createElement,createTextNode,getTag,}=require("@web/core/utils/xml");const{toStringExpression}=require("@web/views/utils");const{copyAttributes,getModifier,isComponentNode,isTextNode,makeSeparator,}=require("@web/views/view_compiler");const{ViewCompiler}=require("@web/views/view_compiler");const compilersRegistry=registry.category("form_compilers");function appendAttf(el,attr,string){const attrKey=`t-attf-${attr}`;const attrVal=el.getAttribute(attrKey);el.setAttribute(attrKey,appendToExpr(attrVal,string));}
function appendToExpr(expr,string){const re=/{{.*}}/;const oldString=re.exec(expr);return oldString?`${oldString} {{${string} }}`:`{{${string} }}`;}
__exports.objectToString=objectToString;function objectToString(obj){return`{${Object.entries(obj)
        .map((t) => t.join(":"))
        .join(",")}}`;}
const FormCompiler=__exports.FormCompiler=class FormCompiler extends ViewCompiler{setup(){this.encounteredFields={};this.labels={};this.noteBookId=0;this.compilers.push(...compilersRegistry.getAll(),{selector:"div[name='button_box']",fn:this.compileButtonBox},{selector:"form",fn:this.compileForm,doNotCopyAttributes:true},{selector:"group",fn:this.compileGroup},{selector:"header",fn:this.compileHeader},{selector:"label",fn:this.compileLabel,doNotCopyAttributes:true},{selector:"notebook",fn:this.compileNotebook},{selector:"setting",fn:this.compileSetting},{selector:"separator",fn:this.compileSeparator},{selector:"sheet",fn:this.compileSheet});}
compile(key,params={}){const compiled=super.compile(...arguments);if(!params.isSubView){compiled.children[0].setAttribute("t-ref","compiled_view_root");}
return compiled;}
createLabelFromField(fieldId,fieldName,fieldString,label,params){let labelText=label.textContent||fieldString;if(label.hasAttribute("data-no-label")){labelText=toStringExpression("");}else{labelText=labelText?toStringExpression(labelText):`__comp__.props.record.fields['${fieldName}'].string`;}
const formLabel=createElement("FormLabel",{id:`'${fieldId}'`,fieldName:`'${fieldName}'`,record:`__comp__.props.record`,fieldInfo:`__comp__.props.archInfo.fieldNodes['${fieldId}']`,className:`"${label.className}"`,string:labelText,});const condition=label.getAttribute("t-if");if(condition){formLabel.setAttribute("t-if",condition);}
return formLabel;}
getLabels(fieldName){const labels=this.labels[fieldName]||[];this.labels[fieldName]=null;return labels;}
pushLabel(fieldName,label){this.labels[fieldName]=this.labels[fieldName]||[];this.labels[fieldName].push(label);}
compileButtonBox(el,params){if(!el.children.length){return this.compileGenericNode(el,params);}
el.classList.remove("oe_button_box");const buttonBox=createElement("ButtonBox");buttonBox.setAttribute("t-if","!__comp__.env.inDialog");let slotId=0;let hasContent=false;for(const child of el.children){const invisible=getModifier(child,"invisible");if(!params.compileInvisibleNodes&&(invisible==="True"||invisible==="1")){continue;}
hasContent=true;let isVisibleExpr;if(!invisible||invisible==="False"||invisible==="0"){isVisibleExpr="true";}else if(invisible==="True"||invisible==="1"){isVisibleExpr="false";}else{isVisibleExpr=`!__comp__.evaluateBooleanExpr(${JSON.stringify(
                    invisible
                )},__comp__.props.record.evalContextWithVirtualIds)`;}
const mainSlot=createElement("t",{"t-set-slot":`slot_${slotId++}`,isVisible:isVisibleExpr,});if(child.tagName==="button"||child.children.tagName==="button"){child.classList.add("oe_stat_button","btn","btn-outline-secondary","flex-grow-1","flex-lg-grow-0");}
if(child.tagName==="field"){child.classList.add("d-inline-block","mb-0","z-index-0");}
append(mainSlot,this.compileNode(child,params,false));append(buttonBox,mainSlot);}
return hasContent?buttonBox:"";}
compileButton(el,params){return super.compileButton(el,params);}
compileField(el,params){const field=super.compileField(el,params);const fieldName=el.getAttribute("name");const fieldString=el.getAttribute("string");const fieldId=el.getAttribute("field_id");const labelsForAttr=el.getAttribute("id")||fieldName;const labels=this.getLabels(labelsForAttr);const dynamicLabel=(label)=>{const formLabel=this.createLabelFromField(fieldId,fieldName,fieldString,label,{...params,currentFieldArchNode:el,});if(formLabel){label.replaceWith(formLabel);}else{label.remove();}
return formLabel;};for(const label of labels){dynamicLabel(label);}
this.encounteredFields[fieldName]=dynamicLabel;return field;}
compileForm(el,params){const sheetNode=el.querySelector("sheet");const displayClasses=sheetNode?`d-flex {{ __comp__.uiService.size < ${SIZES.XXL} ? "flex-column" : "flex-nowrap h-100" }}`:"d-block";const stateClasses="{{ __comp__.props.record.dirty ? 'o_form_dirty' : !__comp__.props.record.isNew ? 'o_form_saved' : '' }}";const form=createElement("div",{class:"o_form_renderer","t-att-class":"__comp__.props.class","t-attf-class":`{{__comp__.props.record.isInEdition ? 'o_form_editable' : 'o_form_readonly'}} ${displayClasses} ${stateClasses}`,});if(!sheetNode){for(const child of el.childNodes){if(child.attributes?.name?.value!=="button_box"){append(form,this.compileNode(child,params));}}
form.classList.add("o_form_nosheet");}else{let compiledList=[];for(const child of el.childNodes){const compiled=this.compileNode(child,params);if(getTag(child,true)==="sheet"){append(form,compiled);compiled.prepend(...compiledList);compiledList=[];}else if(compiled){compiledList.push(compiled);}}
append(form,compiledList);}
return form;}
compileGroup(el,params){const isOuterGroup=[...el.children].some((c)=>getTag(c,true)==="group");const formGroup=createElement(isOuterGroup?"OuterGroup":"InnerGroup");let slotId=0;let sequence=0;if(el.hasAttribute("col")){formGroup.setAttribute("maxCols",el.getAttribute("col"));}
if(el.hasAttribute("string")){const titleSlot=createElement("t",{"t-set-slot":"title"},[makeSeparator(el.getAttribute("string")),]);append(formGroup,titleSlot);}
let forceNewline=false;for(const child of el.children){if(getTag(child,true)==="newline"){forceNewline=true;continue;}
const invisible=getModifier(child,"invisible");if(!params.compileInvisibleNodes&&(invisible==="True"||invisible==="1")){continue;}
const mainSlot=createElement("t",{"t-set-slot":`item_${slotId++}`,type:"'item'",sequence:sequence++,"t-slot-scope":"scope",});let itemSpan=parseInt(child.getAttribute("colspan")||"1",10);if(forceNewline){mainSlot.setAttribute("newline",true);forceNewline=false;}
if(getTag(child,true)==="separator"){itemSpan=parseInt(formGroup.getAttribute("maxCols")||2,10);}
if(child.matches("div[class='clearfix']:empty")){itemSpan=parseInt(formGroup.getAttribute("maxCols")||2,10);}
let slotContent;if(getTag(child,true)==="field"){const addLabel=child.hasAttribute("nolabel")?child.getAttribute("nolabel")!=="1":true;slotContent=this.compileNode(child,{...params,currentSlot:mainSlot},false);if(slotContent&&addLabel&&!isOuterGroup&&!isTextNode(slotContent)){itemSpan=itemSpan===1?itemSpan+1:itemSpan;const fieldName=child.getAttribute("name");const fieldId=slotContent.getAttribute("id")||fieldName;const props={id:`${fieldId}`,fieldName:`'${fieldName}'`,record:`__comp__.props.record`,string:child.hasAttribute("string")?toStringExpression(child.getAttribute("string")):`__comp__.props.record.fields.${fieldName}.string`,fieldInfo:`__comp__.props.archInfo.fieldNodes[${fieldId}]`,};mainSlot.setAttribute("props",objectToString(props));mainSlot.setAttribute("Component","__comp__.constructor.components.FormLabel");mainSlot.setAttribute("subType","'item_component'");}}else{if(child.classList.contains("o_wrap_label")||child.classList.contains("o_td_label")||getTag(child,true)==="label"){mainSlot.setAttribute("subType","'label'");child.classList.remove("o_wrap_label");}
slotContent=this.compileNode(child,{...params,currentSlot:mainSlot},false);}
if(slotContent&&!isTextNode(slotContent)){let isVisibleExpr;if(!invisible||invisible==="False"||invisible==="0"){isVisibleExpr="true";}else if(invisible==="True"||invisible==="1"){isVisibleExpr="false";}else{isVisibleExpr=`!__comp__.evaluateBooleanExpr(${JSON.stringify(
                        invisible
                    )},__comp__.props.record.evalContextWithVirtualIds)`;}
mainSlot.setAttribute("isVisible",isVisibleExpr);if(itemSpan>0){mainSlot.setAttribute("itemSpan",`${itemSpan}`);}
const groupClassExpr=`scope && scope.className`;if(isComponentNode(slotContent)){if(getTag(slotContent)==="FormLabel"){mainSlot.prepend(createElement("t",{"t-set":"addClass","t-value":groupClassExpr,}));combineAttributes(slotContent,"className",`(addClass ? " " + addClass : "")`,`+`);}else if(getTag(child,true)!=="button"){if(slotContent.hasAttribute("class")){mainSlot.prepend(createElement("t",{"t-set":"addClass","t-value":groupClassExpr,}));combineAttributes(slotContent,"class",`(addClass ? " " + addClass : "")`,`+`);}else{slotContent.setAttribute("class",groupClassExpr);}}}else{appendAttf(slotContent,"class",`${groupClassExpr} || ""`);}
append(mainSlot,slotContent);append(formGroup,mainSlot);}}
return formGroup;}
compileHeader(el,params){const statusBar=createElement("div");statusBar.className="o_form_statusbar position-relative d-flex justify-content-between mb-0 mb-md-2 pb-2 pb-md-0";const buttons=[];const others=[];for(const child of el.childNodes){const compiled=this.compileNode(child,params);if(!compiled||isTextNode(compiled)){continue;}
if(getTag(child,true)==="field"){compiled.setAttribute("showTooltip",true);others.push(compiled);}else{if(compiled.tagName==="ViewButton"){compiled.setAttribute("defaultRank","'btn-secondary'");}
buttons.push(compiled);}}
let slotId=0;const statusBarButtons=createElement("StatusBarButtons");for(const button of buttons){const slot=createElement("t",{"t-set-slot":`button_${slotId++}`,isVisible:button.getAttribute("t-if")||true,});append(slot,button);append(statusBarButtons,slot);}
append(statusBar,statusBarButtons);append(statusBar,others);return statusBar;}
compileLabel(el,params){const forAttr=el.getAttribute("for");if(forAttr){let label=createElement("label");copyAttributes(el,label);const string=el.getAttribute("string");if(string){append(label,createTextNode(string));}else if(string===""){label.setAttribute("data-no-label","true");}
if(this.encounteredFields[forAttr]){label=this.encounteredFields[forAttr](label);}else{this.pushLabel(forAttr,label);}
return label;}
const res=this.compileGenericNode(el,params);copyAttributes(el,res);return res;}
compileNotebook(el,params){const noteBookId=this.noteBookId++;const noteBook=createElement("Notebook");const pageAnchors=[...document.querySelectorAll("[href^=\\#]")].map((a)=>CSS.escape(a.getAttribute("href").substring(1))).filter((a)=>a.length);const noteBookAnchors={};if(el.hasAttribute("class")){noteBook.setAttribute("className",toStringExpression(el.getAttribute("class")));el.removeAttribute("class");}
noteBook.setAttribute("defaultPage",`__comp__.props.record.isNew ? undefined : __comp__.props.activeNotebookPages[${noteBookId}]`);noteBook.setAttribute("onPageUpdate",`(page) => __comp__.props.onNotebookPageChange(${noteBookId}, page)`);for(const child of el.children){if(getTag(child,true)!=="page"){continue;}
const invisible=getModifier(child,"invisible");if(!params.compileInvisibleNodes&&(invisible==="True"||invisible==="1")){continue;}
const pageSlot=createElement("t");append(noteBook,pageSlot);const pageId=`page_${this.id++}`;const pageTitle=toStringExpression(child.getAttribute("string")||child.getAttribute("name")||"");const pageNodeName=toStringExpression(child.getAttribute("name")||"");pageSlot.setAttribute("t-set-slot",pageId);pageSlot.setAttribute("title",pageTitle);pageSlot.setAttribute("name",pageNodeName);if(child.className){pageSlot.setAttribute("className",`"${child.className}"`);}
if(child.getAttribute("autofocus")==="autofocus"){noteBook.setAttribute("defaultPage",`__comp__.props.record.isNew ? "${pageId}" : (__comp__.props.activeNotebookPages[${noteBookId}] || "${pageId}")`);}
for(const anchor of child.querySelectorAll("[href^=\\#]")){const anchorValue=CSS.escape(anchor.getAttribute("href").substring(1));if(!anchorValue.length){continue;}
pageAnchors.push(anchorValue);noteBookAnchors[anchorValue]={origin:`'${pageId}'`,};}
let isVisibleExpr;if(!invisible||invisible==="False"||invisible==="0"){isVisibleExpr="true";}else if(invisible==="True"||invisible==="1"){isVisibleExpr="false";}else{isVisibleExpr=`!__comp__.evaluateBooleanExpr(${JSON.stringify(
                    invisible
                )},__comp__.props.record.evalContextWithVirtualIds)`;}
pageSlot.setAttribute("isVisible",isVisibleExpr);for(const contents of child.children){append(pageSlot,this.compileNode(contents,{...params,currentSlot:pageSlot}));}}
if(pageAnchors.length){for(const anchor of pageAnchors){let pageId=1;for(const child of el.children){if(child.querySelector(`#${anchor}`)){noteBookAnchors[anchor].target=`'page_${pageId}'`;noteBookAnchors[anchor]=objectToString(noteBookAnchors[anchor]);break;}
pageId++;}}
noteBook.setAttribute("anchors",objectToString(noteBookAnchors));}
return noteBook;}
compileSetting(el,params){const setting=createElement(params.componentName||"Setting",{title:toStringExpression(el.getAttribute("title")||""),help:toStringExpression(el.getAttribute("help")||""),companyDependent:el.getAttribute("company_dependent")==="1"||"false",documentation:toStringExpression(el.getAttribute("documentation")||""),record:`__comp__.props.record`,});let string=toStringExpression(el.getAttribute("string")||"");let addLabel=true;Array.from(el.children).forEach((child,index)=>{if(getTag(child,true)==="field"&&index===0){const fieldSlot=createElement("t",{"t-set-slot":"fieldSlot"});const field=this.compileNode(child,params);if(field){append(fieldSlot,field);setting.setAttribute("fieldInfo",field.getAttribute("fieldInfo"));addLabel=child.hasAttribute("nolabel")?child.getAttribute("nolabel")!=="1":true;const fieldName=child.getAttribute("name");string=child.hasAttribute("string")?toStringExpression(child.getAttribute("string")):string;setting.setAttribute("fieldName",toStringExpression(fieldName));setting.setAttribute("fieldId",toStringExpression(child.getAttribute("field_id")));}
append(setting,fieldSlot);}else{append(setting,this.compileNode(child,params));}});setting.setAttribute("string",string);setting.setAttribute("addLabel",addLabel);return setting;}
compileSeparator(el,params={}){const separator=makeSeparator(el.getAttribute("string"));copyAttributes(el,separator);return this.applyInvisible(getModifier(el,"invisible"),separator,params);}
compileSheet(el,params){const sheetBG=createElement("div");sheetBG.className="o_form_sheet_bg";const sheetFG=createElement("div");sheetFG.className="o_form_sheet position-relative";append(sheetBG,sheetFG);for(const child of el.childNodes){const compiled=this.compileNode(child,params);if(!compiled){continue;}
if(compiled.nodeName==="ButtonBox"){continue;}
if(getTag(child,true)==="field"){compiled.setAttribute("showTooltip",true);}
append(sheetFG,compiled);}
return sheetBG;}}
return __exports;});;

/* /web/static/src/views/form/form_controller.js */
odoo.define('@web/views/form/form_controller',['@web/core/l10n/translation','@web/core/browser/feature_detection','@web/core/confirmation_dialog/confirmation_dialog','@web/core/context','@web/core/debug/debug_context','@web/core/registry','@web/core/ui/ui_service','@web/core/utils/hooks','@web/core/utils/objects','@web/core/utils/xml','@web/core/py_js/py','@web/search/layout','@web/search/pager_hook','@web/views/standard_view_props','@web/views/utils','@web/views/view_button/view_button_hook','@web/views/view_hook','@web/views/view_button/view_button','@web/views/fields/field','@web/model/model','@web/model/relational_model/utils','@web/views/view_compiler','@web/search/cog_menu/cog_menu','@web/search/action_menus/action_menus','@web/views/form/button_box/button_box','@web/views/form/form_compiler','@web/views/form/form_error_dialog/form_error_dialog','@web/views/form/form_status_indicator/form_status_indicator','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{hasTouch}=require("@web/core/browser/feature_detection");const{deleteConfirmationMessage,ConfirmationDialog,}=require("@web/core/confirmation_dialog/confirmation_dialog");const{makeContext}=require("@web/core/context");const{useDebugCategory}=require("@web/core/debug/debug_context");const{registry}=require("@web/core/registry");const{SIZES}=require("@web/core/ui/ui_service");const{useBus,useService}=require("@web/core/utils/hooks");const{omit}=require("@web/core/utils/objects");const{createElement,parseXML}=require("@web/core/utils/xml");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{Layout}=require("@web/search/layout");const{usePager}=require("@web/search/pager_hook");const{standardViewProps}=require("@web/views/standard_view_props");const{isX2Many}=require("@web/views/utils");const{executeButtonCallback,useViewButtons}=require("@web/views/view_button/view_button_hook");const{useSetupView}=require("@web/views/view_hook");const{ViewButton}=require("@web/views/view_button/view_button");const{Field}=require("@web/views/fields/field");const{useModel}=require("@web/model/model");const{addFieldDependencies,extractFieldsFromArchInfo}=require("@web/model/relational_model/utils");const{useViewCompiler}=require("@web/views/view_compiler");const{CogMenu}=require("@web/search/cog_menu/cog_menu");const{STATIC_ACTIONS_GROUP_NUMBER}=require("@web/search/action_menus/action_menus");const{ButtonBox}=require("@web/views/form/button_box/button_box");const{FormCompiler}=require("@web/views/form/form_compiler");const{FormErrorDialog}=require("@web/views/form/form_error_dialog/form_error_dialog");const{FormStatusIndicator}=require("@web/views/form/form_status_indicator/form_status_indicator");const{Component,onRendered,useEffect,useRef,useState}=require("@odoo/owl");const viewRegistry=registry.category("views");__exports.loadSubViews=loadSubViews;async function loadSubViews(fieldNodes,fields,context,resModel,viewService,userService,isSmall){for(const fieldInfo of Object.values(fieldNodes)){const fieldName=fieldInfo.name;const field=fields[fieldName];if(!isX2Many(field)){continue;}
if(fieldInfo.invisible==="True"||fieldInfo.invisible==="1"){continue;}
if(!fieldInfo.field.useSubView){continue;}
fieldInfo.views=fieldInfo.views||{};let viewType=fieldInfo.viewMode||"list,kanban";viewType=viewType.replace("tree","list");if(viewType.includes(",")){viewType=isSmall?"kanban":"list";}
fieldInfo.viewMode=viewType;if(fieldInfo.views[viewType]){continue;}
const fieldContext={};const regex=/'([a-z]*_view_ref)' *: *'(.*?)'/g;let matches;while((matches=regex.exec(fieldInfo.context))!==null){fieldContext[matches[1]]=matches[2];}
const refinedContext={};for(const key in context){if(key.indexOf("_view_ref")===-1){refinedContext[key]=context[key];}}
refinedContext.base_model_name=resModel;const comodel=field.relation;const{fields:comodelFields,relatedModels,views,}=await viewService.loadViews({resModel:comodel,views:[[false,viewType]],context:makeContext([fieldContext,userService.context,refinedContext]),});const{ArchParser}=viewRegistry.get(viewType);const xmlDoc=parseXML(views[viewType].arch);const archInfo=new ArchParser().parse(xmlDoc,relatedModels,comodel);fieldInfo.views[viewType]={...archInfo,limit:archInfo.limit||40,fields:comodelFields,};fieldInfo.relatedFields=comodelFields;}}
const FormController=__exports.FormController=class FormController extends Component{setup(){this.evaluateBooleanExpr=evaluateBooleanExpr;this.dialogService=useService("dialog");this.router=useService("router");this.orm=useService("orm");this.user=useService("user");this.viewService=useService("view");this.ui=useService("ui");useBus(this.ui.bus,"resize",this.render);this.archInfo=this.props.archInfo;const{create,edit}=this.archInfo.activeActions;this.canCreate=create&&!this.props.preventCreate;this.canEdit=edit&&!this.props.preventEdit;this.duplicateId=false;this.display={...this.props.display};if(this.env.inDialog){this.display.controlPanel=false;}
const beforeFirstLoad=async()=>{await loadSubViews(this.archInfo.fieldNodes,this.props.fields,this.props.context,this.props.resModel,this.viewService,this.user,this.env.isSmall);const{activeFields,fields}=extractFieldsFromArchInfo(this.archInfo,this.props.fields);if(this.display.controlPanel){addFieldDependencies(activeFields,fields,[{name:"display_name",type:"char",readonly:true},]);}
this.model.config.activeFields=activeFields;this.model.config.fields=fields;};this.model=useState(useModel(this.props.Model,this.modelParams,{beforeFirstLoad}));this.cpButtonsRef=useRef("cpButtons");useEffect(()=>{if(!this.env.inDialog){this.updateURL();}});const footers=[...this.archInfo.xmlDoc.querySelectorAll("footer:not(field footer)")];if(footers.length){this.footerArchInfo=Object.assign({},this.archInfo);this.footerArchInfo.xmlDoc=createElement("t");this.footerArchInfo.xmlDoc.append(...footers);this.footerArchInfo.arch=this.footerArchInfo.xmlDoc.outerHTML;this.archInfo.arch=this.archInfo.xmlDoc.outerHTML;}
const xmlDocButtonBox=this.archInfo.xmlDoc.querySelector("div[name='button_box']:not(field div)");if(xmlDocButtonBox){const buttonBoxTemplates=useViewCompiler(this.props.Compiler||FormCompiler,{ButtonBox:xmlDocButtonBox},{isSubView:true});this.buttonBoxTemplate=buttonBoxTemplates.ButtonBox;}
this.rootRef=useRef("root");useViewButtons(this.model,this.rootRef,{beforeExecuteAction:this.beforeExecuteActionButton.bind(this),afterExecuteAction:this.afterExecuteActionButton.bind(this),});const state=this.props.state||{};const activeNotebookPages={...state.activeNotebookPages};this.onNotebookPageChange=(notebookId,page)=>{if(page){activeNotebookPages[notebookId]=page;}};useSetupView({rootRef:this.rootRef,beforeLeave:()=>this.beforeLeave(),beforeUnload:(ev)=>this.beforeUnload(ev),getLocalState:()=>{return{activeNotebookPages:!this.model.root.isNew?activeNotebookPages:{},modelState:this.model.exportState(),resId:this.model.root.resId,};},});useDebugCategory("form",{component:this});usePager(()=>{if(!this.model.root.isNew){const resIds=this.model.root.resIds;return{offset:resIds.indexOf(this.model.root.resId),limit:1,total:resIds.length,onUpdate:({offset})=>this.onPagerUpdate({offset,resIds}),};}});onRendered(()=>{this.env.config.setDisplayName(this.displayName());});const{disableAutofocus}=this.archInfo;if(!disableAutofocus){useEffect((isInEdition)=>{if(!isInEdition&&!this.rootRef.el.querySelector(".o_content").contains(document.activeElement)){const elementToFocus=this.rootRef.el.querySelector(".o_content button.btn-primary");if(elementToFocus){elementToFocus.focus();}}},()=>[this.model.root.isInEdition]);}}
get modelParams(){let mode=this.props.mode||"edit";if(!this.canEdit&&this.props.resId){mode="readonly";}
return{config:{resModel:this.props.resModel,resId:this.props.resId||false,resIds:this.props.resIds||(this.props.resId?[this.props.resId]:[]),fields:this.props.fields,activeFields:{},isMonoRecord:true,mode,context:this.props.context,},state:this.props.state?.modelState,hooks:{onWillLoadRoot:this.onWillLoadRoot.bind(this),onWillSaveRecord:this.onWillSaveRecord.bind(this),onRecordSaved:this.onRecordSaved.bind(this),},useSendBeaconToSaveUrgently:true,};}
onWillLoadRoot(){this.duplicateId=undefined;}
async onRecordSaved(record,changes){if(this.duplicateId===record.id){const translationChanges={};for(const fieldName in changes){if(record.fields[fieldName].translate){translationChanges[fieldName]=changes[fieldName];}}
if(Object.keys(translationChanges).length){await this.orm.call(this.model.root.resModel,"web_override_translations",[[this.model.root.resId],translationChanges,]);}}}
async onWillSaveRecord(){}
async onSaveError(error,{discard}){const proceed=await new Promise((resolve)=>{this.model.dialog.add(FormErrorDialog,{message:error.data.message,onDiscard:()=>{discard();resolve(true);},onStayHere:()=>resolve(false),});});return proceed;}
displayName(){return this.model.root.data.display_name||(this.model.root.isNew&&_t("New"))||"";}
async onPagerUpdate({offset,resIds}){const dirty=await this.model.root.isDirty();if(dirty){return this.model.root.save({onError:this.onSaveError.bind(this),nextId:resIds[offset],});}else{return this.model.load({resId:resIds[offset]});}}
async beforeLeave(){if(this.model.root.dirty){return this.model.root.save({reload:false,onError:this.onSaveError.bind(this),});}}
async beforeUnload(ev){const succeeded=await this.model.root.urgentSave();if(!succeeded){ev.preventDefault();ev.returnValue="Unsaved changes";}}
updateURL(){this.router.pushState({id:this.model.root.resId||undefined});}
getStaticActionMenuItems(){const{activeActions}=this.archInfo;return{archive:{isAvailable:()=>this.archiveEnabled&&this.model.root.isActive,sequence:10,description:_t("Archive"),icon:"oi oi-archive",callback:()=>{this.dialogService.add(ConfirmationDialog,this.archiveDialogProps);},},unarchive:{isAvailable:()=>this.archiveEnabled&&!this.model.root.isActive,sequence:20,icon:"oi oi-unarchive",description:_t("Unarchive"),callback:()=>this.model.root.unarchive(),},duplicate:{isAvailable:()=>activeActions.create&&activeActions.duplicate,sequence:30,icon:"fa fa-clone",description:_t("Duplicate"),callback:()=>this.duplicateRecord(),},delete:{isAvailable:()=>activeActions.delete&&!this.model.root.isNew,sequence:40,icon:"fa fa-trash-o",description:_t("Delete"),callback:()=>this.deleteRecord(),skipSave:true,},addPropertyFieldValue:{isAvailable:()=>activeActions.addPropertyFieldValue,sequence:50,icon:"fa fa-cogs",description:_t("Add Properties"),callback:()=>this.model.bus.trigger("PROPERTY_FIELD:ADD_PROPERTY_VALUE"),},};}
get archiveDialogProps(){return{body:_t("Are you sure that you want to archive this record?"),confirmLabel:_t("Archive"),confirm:()=>this.model.root.archive(),cancel:()=>{},};}
get actionMenuItems(){const{actionMenus}=this.props.info;const staticActionItems=Object.entries(this.getStaticActionMenuItems()).filter(([key,item])=>item.isAvailable===undefined||item.isAvailable()).sort(([k1,item1],[k2,item2])=>(item1.sequence||0)-(item2.sequence||0)).map(([key,item])=>Object.assign({key},omit(item,"isAvailable","sequence"),{groupNumber:STATIC_ACTIONS_GROUP_NUMBER,}));return{action:[...staticActionItems,...(actionMenus.action||[])],print:actionMenus.print,};}
get archiveEnabled(){return"active"in this.model.root.activeFields?!this.props.fields.active.readonly:"x_active"in this.model.root.activeFields?!this.props.fields.x_active.readonly:false;}
async shouldExecuteAction(item){const dirty=await this.model.root.isDirty();if((dirty||this.model.root.isNew)&&!item.skipSave){let hasError=false;const isSaved=await this.model.root.save({onError:(...args)=>{hasError=true;return this.onSaveError(...args);},});return isSaved&&!hasError;}
return true;}
async duplicateRecord(){await this.model.root.duplicate();this.duplicateId=this.model.root.id;}
get deleteConfirmationDialogProps(){return{title:_t("Bye-bye, record!"),body:deleteConfirmationMessage,confirm:async()=>{await this.model.root.delete();if(!this.model.root.resId){this.env.config.historyBack();}},confirmLabel:_t("Delete"),cancel:()=>{},cancelLabel:_t("No, keep it"),};}
async deleteRecord(){this.dialogService.add(ConfirmationDialog,this.deleteConfirmationDialogProps);}
async beforeExecuteActionButton(clickParams){const record=this.model.root;if(clickParams.special!=="cancel"){let saved=false;if(clickParams.special==="save"&&this.props.saveRecord){saved=await this.props.saveRecord(record,clickParams);}else{const params={reload:!(this.env.inDialog&&clickParams.close)};saved=await record.save(params);}
if(saved!==false&&this.props.onSave){this.props.onSave(record,clickParams);}
return saved;}else if(this.props.onDiscard){this.props.onDiscard(record);}}
async afterExecuteActionButton(clickParams){}
async create(){const canProceed=await this.model.root.save({onError:this.onSaveError.bind(this),});if(canProceed){await executeButtonCallback(this.ui.activeElement,()=>this.model.load({resId:false}));}}
async save(params){const record=this.model.root;let saved=false;if(this.props.saveRecord){saved=await this.props.saveRecord(record,params);}else{saved=await record.save(params);}
if(saved&&this.props.onSave){this.props.onSave(record,params);}
return saved;}
saveButtonClicked(params={}){return executeButtonCallback(this.ui.activeElement,()=>this.save(params));}
async discard(){if(this.props.discardRecord){this.props.discardRecord(this.model.root);return;}
await this.model.root.discard();if(this.props.onDiscard){this.props.onDiscard(this.model.root);}
if(this.model.root.isNew||this.env.inDialog){this.env.config.historyBack();}}
get className(){const result={};const{size}=this.ui;if(size<=SIZES.XS){result.o_xxs_form_view=true;}else if(!this.env.inDialog&&size===SIZES.XXL){result["o_xxl_form_view h-100"]=true;}
if(this.props.className){result[this.props.className]=true;}
result["o_field_highlight"]=size<SIZES.SM||hasTouch();return result;}}
FormController.template=`web.FormView`;FormController.components={FormStatusIndicator,Layout,ButtonBox,ViewButton,Field,CogMenu,};FormController.props={...standardViewProps,discardRecord:{type:Function,optional:true},mode:{optional:true,validate:(m)=>["edit","readonly"].includes(m),},saveRecord:{type:Function,optional:true},removeRecord:{type:Function,optional:true},Model:Function,Renderer:Function,Compiler:Function,archInfo:Object,buttonTemplate:String,preventCreate:{type:Boolean,optional:true},preventEdit:{type:Boolean,optional:true},onDiscard:{type:Function,optional:true},onSave:{type:Function,optional:true},};FormController.defaultProps={preventCreate:false,preventEdit:false,};return __exports;});;

/* /web/static/src/views/form/form_error_dialog/form_error_dialog.js */
odoo.define('@web/views/form/form_error_dialog/form_error_dialog',['@web/core/dialog/dialog','@odoo/owl'],function(require){'use strict';let __exports={};const{Dialog}=require("@web/core/dialog/dialog");const{Component}=require("@odoo/owl");const FormErrorDialog=__exports.FormErrorDialog=class FormErrorDialog extends Component{async discard(){await this.props.onDiscard();this.props.close();}
async stay(){await this.props.onStayHere();this.props.close();}}
FormErrorDialog.template="web.FormErrorDialog";FormErrorDialog.components={Dialog};return __exports;});;

/* /web/static/src/views/form/form_group/form_group.js */
odoo.define('@web/views/form/form_group/form_group',['@odoo/owl','@web/core/utils/arrays'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{sortBy}=require("@web/core/utils/arrays");class Group extends Component{_getItems(){const items=Object.entries(this.props.slots||{}).filter(([k,v])=>v.type==="item");return sortBy(items,(i)=>i[1].sequence);}
getItems(){return this._getItems();}
get allClasses(){return this.props.class;}}
Group.props=["class?","slots?","maxCols?","style?"];Group.defaultProps={maxCols:2,};const OuterGroup=__exports.OuterGroup=class OuterGroup extends Group{getItems(){const nbCols=this.props.maxCols;const colSize=Math.max(1,Math.round(12/nbCols));const items=super.getItems().filter(([k,v])=>!("isVisible"in v)||v.isVisible);return items.map((item)=>{const[slotName,slot]=item;const itemSpan=slot.itemSpan||1;return{name:slotName,size:itemSpan*colSize,newline:slot.newline,colspan:itemSpan,};});}}
OuterGroup.template="web.Form.OuterGroup";OuterGroup.defaultProps={...Group.defaultProps,slots:[],hasOuterTemplate:true,};const InnerGroup=__exports.InnerGroup=class InnerGroup extends Group{getTemplate(subType){return this.constructor.templates[subType]||this.constructor.templates.default;}
getRows(){const maxCols=this.props.maxCols;const rows=[];let currentRow=[];let reservedSpace=0;const items=this.getItems();while(items.length){const[slotName,slot]=items.shift();if(!slot.isVisible){continue;}
const{newline,itemSpan}=slot;if(newline){rows.push(currentRow);currentRow=[];reservedSpace=0;}
const fullItemSpan=itemSpan||1;if(fullItemSpan+reservedSpace>maxCols){rows.push(currentRow);currentRow=[];reservedSpace=0;}
const isVisible=!("isVisible"in slot)||slot.isVisible;currentRow.push({...slot,name:slotName,itemSpan,isVisible});reservedSpace+=itemSpan||1;currentRow.isVisible=currentRow.isVisible||isVisible;}
rows.push(currentRow);rows.forEach((row)=>{let labelCount=0;const dataCells=[];for(const c of row){if(c.subType==="label"){labelCount++;}else if(c.subType==="item_component"){labelCount++;dataCells.push(c);}else{dataCells.push(c);}}
const sizeOfDataCell=100/(maxCols-labelCount);dataCells.forEach((c)=>{const itemSpan=c.subType==="item_component"?c.itemSpan-1:c.itemSpan;c.width=(itemSpan||1)*sizeOfDataCell;});});return rows;}}
InnerGroup.template="web.Form.InnerGroup";return __exports;});;

/* /web/static/src/views/form/form_label.js */
odoo.define('@web/views/form/form_label',['@web/views/fields/field','@web/session','@web/views/fields/field_tooltip','@web/core/l10n/translation','@odoo/owl'],function(require){'use strict';let __exports={};const{fieldVisualFeedback}=require("@web/views/fields/field");const{session}=require("@web/session");const{getTooltipInfo}=require("@web/views/fields/field_tooltip");const{_t}=require("@web/core/l10n/translation");const{Component}=require("@odoo/owl");const FormLabel=__exports.FormLabel=class FormLabel extends Component{get className(){const{invalid,empty,readonly}=fieldVisualFeedback(this.props.fieldInfo.field,this.props.record,this.props.fieldName,this.props.fieldInfo);const classes=this.props.className?[this.props.className]:[];if(invalid){classes.push("o_field_invalid");}
if(empty){classes.push("o_form_label_empty");}
if(readonly&&!this.props.notMuttedLabel){classes.push("o_form_label_readonly");}
return classes.join(" ");}
get hasTooltip(){return Boolean(odoo.debug)||this.tooltipHelp;}
get tooltipHelp(){const field=this.props.record.fields[this.props.fieldName];let help=this.props.fieldInfo.help||field.help||"";if(field.company_dependent&&session.display_switch_company_menu){help+=(help?"\n\n":"")+_t("Values set here are company-specific.");}
return help;}
get tooltipInfo(){if(!odoo.debug){return JSON.stringify({field:{help:this.tooltipHelp,},});}
return getTooltipInfo({viewMode:"form",resModel:this.props.record.resModel,field:this.props.record.fields[this.props.fieldName],fieldInfo:this.props.fieldInfo,help:this.tooltipHelp,});}}
FormLabel.template="web.FormLabel";FormLabel.props={fieldInfo:{type:Object},record:{type:Object},fieldName:{type:String},className:{type:String,optional:true},string:{type:String},id:{type:String},notMuttedLabel:{type:Boolean,optional:true},};return __exports;});;

/* /web/static/src/views/form/form_renderer.js */
odoo.define('@web/views/form/form_renderer',['@web/core/py_js/py','@web/core/notebook/notebook','@web/views/form/setting/setting','@web/views/fields/field','@web/core/browser/browser','@web/core/browser/feature_detection','@web/core/utils/hooks','@web/core/utils/timing','@web/views/form/button_box/button_box','@web/views/form/form_group/form_group','@web/views/view_button/view_button','@web/views/view_compiler','@web/views/view_hook','@web/views/widgets/widget','@web/views/form/form_compiler','@web/views/form/form_label','@web/views/form/status_bar_buttons/status_bar_buttons','@odoo/owl'],function(require){'use strict';let __exports={};const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{Notebook}=require("@web/core/notebook/notebook");const{Setting}=require("@web/views/form/setting/setting");const{Field}=require("@web/views/fields/field");const{browser}=require("@web/core/browser/browser");const{hasTouch}=require("@web/core/browser/feature_detection");const{useService}=require("@web/core/utils/hooks");const{useDebounced}=require("@web/core/utils/timing");const{ButtonBox}=require("@web/views/form/button_box/button_box");const{InnerGroup,OuterGroup}=require("@web/views/form/form_group/form_group");const{ViewButton}=require("@web/views/view_button/view_button");const{useViewCompiler}=require("@web/views/view_compiler");const{useBounceButton}=require("@web/views/view_hook");const{Widget}=require("@web/views/widgets/widget");const{FormCompiler}=require("@web/views/form/form_compiler");const{FormLabel}=require("@web/views/form/form_label");const{StatusBarButtons}=require("@web/views/form/status_bar_buttons/status_bar_buttons");const{Component,onMounted,onWillUnmount,useEffect,useSubEnv,useRef,useState,xml,}=require("@odoo/owl");const FormRenderer=__exports.FormRenderer=class FormRenderer extends Component{setup(){this.evaluateBooleanExpr=evaluateBooleanExpr;const{archInfo,Compiler,record}=this.props;const templates={FormRenderer:archInfo.xmlDoc};this.state=useState({});this.templates=useViewCompiler(Compiler||FormCompiler,templates);useSubEnv({model:record.model});useBounceButton(useRef("compiled_view_root"),(target)=>{return!record.isInEdition&&!!target.closest(".oe_title, .o_inner_group");});this.uiService=useService("ui");this.onResize=useDebounced(this.render,200);onMounted(()=>browser.addEventListener("resize",this.onResize));onWillUnmount(()=>browser.removeEventListener("resize",this.onResize));const{autofocusFieldId}=archInfo;const rootRef=useRef("compiled_view_root");if(this.shouldAutoFocus){useEffect((isNew,rootEl)=>{if(!rootEl){return;}
let elementToFocus;if(isNew){const focusableSelectors=['input[type="text"]',"textarea","[contenteditable]",];elementToFocus=(autofocusFieldId&&rootEl.querySelector(`#${autofocusFieldId}`))||rootEl.querySelector(focusableSelectors.map((sel)=>`.o_content .o_field_widget ${sel}`).join(", "));}
if(elementToFocus){elementToFocus.focus();}},()=>[this.props.record.isNew,rootRef.el]);}
if(this.env.inDialog){const fieldNodeIds=Object.keys(this.props.archInfo.fieldNodes);const elementsByNodeIds={};onMounted(()=>{if(!rootRef.el){return;}
for(const id of fieldNodeIds){const els=[...document.querySelectorAll(`[id=${id}]`)].filter((el)=>!rootRef.el.contains(el));if(els.length){els[0].removeAttribute("id");elementsByNodeIds[id]=els[0];}}});onWillUnmount(()=>{for(const[id,el]of Object.entries(elementsByNodeIds)){el.setAttribute("id",id);}});}}
get shouldAutoFocus(){return!hasTouch()&&!this.props.archInfo.disableAutofocus;}}
FormRenderer.template=xml`<t t-call="{{ templates.FormRenderer }}" t-call-context="{ __comp__: Object.assign(Object.create(this), { this: this }) }" />`;FormRenderer.components={Field,FormLabel,ButtonBox,ViewButton,Widget,Notebook,Setting,OuterGroup,InnerGroup,StatusBarButtons,};FormRenderer.props={archInfo:Object,Compiler:{type:Function,optional:true},record:Object,class:{type:String,optional:1},translateAlert:{type:[Object,{value:null}],optional:true},onNotebookPageChange:{type:Function,optional:true},activeNotebookPages:{type:Object,optional:true},setFieldAsDirty:{type:Function,optional:true},};FormRenderer.defaultProps={activeNotebookPages:{},onNotebookPageChange:()=>{},};return __exports;});;

/* /web/static/src/views/form/form_status_indicator/form_status_indicator.js */
odoo.define('@web/views/form/form_status_indicator/form_status_indicator',['@odoo/owl','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{Component,useEffect,useRef,useState}=require("@odoo/owl");const{useBus}=require("@web/core/utils/hooks");const FormStatusIndicator=__exports.FormStatusIndicator=class FormStatusIndicator extends Component{setup(){this.state=useState({fieldIsDirty:false,});useBus(this.props.model.bus,"FIELD_IS_DIRTY",(ev)=>(this.state.fieldIsDirty=ev.detail));useEffect(()=>{if(!this.props.model.root.isNew&&this.indicatorMode==="invalid"){this.saveButton.el.setAttribute("disabled","1");}else{this.saveButton.el.removeAttribute("disabled");}},()=>[this.props.model.root.isValid]);this.saveButton=useRef("save");}
get displayButtons(){return this.indicatorMode!=="saved";}
get indicatorMode(){if(this.props.model.root.isNew){return this.props.model.root.isValid?"dirty":"invalid";}else if(!this.props.model.root.isValid){return"invalid";}else if(this.props.model.root.dirty||this.state.fieldIsDirty){return"dirty";}else{return"saved";}}
async discard(){await this.props.discard();}
async save(){await this.props.save();}}
FormStatusIndicator.template="web.FormStatusIndicator";FormStatusIndicator.props={model:Object,save:Function,discard:Function,};return __exports;});;

/* /web/static/src/views/form/form_view.js */
odoo.define('@web/views/form/form_view',['@web/core/registry','@web/model/relational_model/relational_model','@web/views/form/form_renderer','@web/views/form/form_arch_parser','@web/views/form/form_controller','@web/views/form/form_compiler'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{RelationalModel}=require("@web/model/relational_model/relational_model");const{FormRenderer}=require("@web/views/form/form_renderer");const{FormArchParser}=require("@web/views/form/form_arch_parser");const{FormController}=require("@web/views/form/form_controller");const{FormCompiler}=require("@web/views/form/form_compiler");const formView=__exports.formView={type:"form",display_name:"Form",multiRecord:false,searchMenuTypes:[],Controller:FormController,Renderer:FormRenderer,ArchParser:FormArchParser,Model:RelationalModel,Compiler:FormCompiler,buttonTemplate:"web.FormView.Buttons",props:(genericProps,view)=>{const{ArchParser}=view;const{arch,relatedModels,resModel}=genericProps;const archInfo=new ArchParser().parse(arch,relatedModels,resModel);return{...genericProps,Model:view.Model,Renderer:view.Renderer,buttonTemplate:genericProps.buttonTemplate||view.buttonTemplate,Compiler:view.Compiler,archInfo,};},};registry.category("views").add("form",formView);return __exports;});;

/* /web/static/src/views/form/setting/setting.js */
odoo.define('@web/views/form/setting/setting',['@web/session','@odoo/owl','@web/views/form/form_label','@web/views/widgets/documentation_link/documentation_link'],function(require){'use strict';let __exports={};const{session}=require("@web/session");const{Component}=require("@odoo/owl");const{FormLabel}=require("@web/views/form/form_label");const{DocumentationLink}=require("@web/views/widgets/documentation_link/documentation_link");const Setting=__exports.Setting=class Setting extends Component{setup(){if(this.props.fieldName){this.fieldType=this.props.record.fields[this.props.fieldName].type;if(this.props.fieldInfo.readonly==="True"){this.notMuttedLabel=true;}}}
get classNames(){const{class:_class}=this.props;const classNames={o_setting_box:true,"col-12":true,"col-lg-6":true,[_class]:Boolean(_class),};return classNames;}
get displayCompanyDependentIcon(){return(this.labelString&&this.props.companyDependent&&session.display_switch_company_menu);}
get labelString(){if(this.props.string){return this.props.string;}
const label=this.props.record&&this.props.record.fields[this.props.fieldName]&&this.props.record.fields[this.props.fieldName].string;return label||"";}}
Setting.components={FormLabel,DocumentationLink,};Setting.template="web.Setting";Setting.props={title:{type:String,optional:1},fieldId:{type:String,optional:1},help:{type:String,optional:1},fieldName:{type:String,optional:1},fieldInfo:{type:Object,optional:1},class:{type:String,optional:1},record:{type:Object,optional:1},documentation:{type:String,optional:1},string:{type:String,optional:1},addLabel:{type:Boolean},companyDependent:{type:Boolean,optional:1},slots:{type:Object,optional:1},};return __exports;});;

/* /web/static/src/views/form/status_bar_buttons/status_bar_buttons.js */
odoo.define('@web/views/form/status_bar_buttons/status_bar_buttons',['@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@odoo/owl'],function(require){'use strict';let __exports={};const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{Component}=require("@odoo/owl");const StatusBarButtons=__exports.StatusBarButtons=class StatusBarButtons extends Component{get visibleSlotNames(){if(!this.props.slots){return[];}
return Object.entries(this.props.slots).filter((entry)=>entry[1].isVisible).map((entry)=>entry[0]);}}
StatusBarButtons.template="web.StatusBarButtons";StatusBarButtons.components={Dropdown,DropdownItem,};StatusBarButtons.props={slots:{type:Object,optional:1},};return __exports;});;

/* /web/static/src/views/graph/graph_arch_parser.js */
odoo.define('@web/views/graph/graph_arch_parser',['@web/core/utils/xml','@web/search/utils/misc','@web/views/utils'],function(require){'use strict';let __exports={};const{visitXML}=require("@web/core/utils/xml");const{GROUPABLE_TYPES}=require("@web/search/utils/misc");const{archParseBoolean}=require("@web/views/utils");const MODES=["bar","line","pie"];const ORDERS=["ASC","DESC","asc","desc",null];const GraphArchParser=__exports.GraphArchParser=class GraphArchParser{parse(arch,fields={}){const archInfo={fields,fieldAttrs:{},groupBy:[],measures:[]};visitXML(arch,(node)=>{switch(node.tagName){case"graph":{if(node.hasAttribute("disable_linking")){archInfo.disableLinking=archParseBoolean(node.getAttribute("disable_linking"));}
if(node.hasAttribute("stacked")){archInfo.stacked=archParseBoolean(node.getAttribute("stacked"));}
if(node.hasAttribute("cumulated")){archInfo.cumulated=archParseBoolean(node.getAttribute("cumulated"));}
if(node.hasAttribute("cumulated_start")){archInfo.cumulatedStart=archParseBoolean(node.getAttribute("cumulated_start"));}
const mode=node.getAttribute("type");if(mode&&MODES.includes(mode)){archInfo.mode=mode;}
const order=node.getAttribute("order");if(order&&ORDERS.includes(order)){archInfo.order=order.toUpperCase();}
const title=node.getAttribute("string");if(title){archInfo.title=title;}
break;}
case"field":{const fieldName=node.getAttribute("name");if(fieldName==="id"){break;}
const string=node.getAttribute("string");if(string){if(!archInfo.fieldAttrs[fieldName]){archInfo.fieldAttrs[fieldName]={};}
archInfo.fieldAttrs[fieldName].string=string;}
const widget=node.getAttribute("widget");if(widget){if(!archInfo.fieldAttrs[fieldName]){archInfo.fieldAttrs[fieldName]={};}
archInfo.fieldAttrs[fieldName].widget=widget;}
if(node.getAttribute("invisible")==="True"||node.getAttribute("invisible")==="1"){if(!archInfo.fieldAttrs[fieldName]){archInfo.fieldAttrs[fieldName]={};}
archInfo.fieldAttrs[fieldName].isInvisible=true;break;}
const isMeasure=node.getAttribute("type")==="measure";if(isMeasure){archInfo.measures.push(fieldName);archInfo.measure=fieldName;}else{const{type}=archInfo.fields[fieldName];if(GROUPABLE_TYPES.includes(type)){let groupBy=fieldName;const interval=node.getAttribute("interval");if(interval){groupBy+=`:${interval}`;}
archInfo.groupBy.push(groupBy);}}
break;}}});return archInfo;}}
return __exports;});;

/* /web/static/src/views/graph/graph_controller.js */
odoo.define('@web/views/graph/graph_controller',['@web/search/layout','@web/model/model','@web/views/standard_view_props','@web/views/view_hook','@web/search/search_bar/search_bar','@web/search/search_bar/search_bar_toggler','@web/search/cog_menu/cog_menu','@odoo/owl'],function(require){'use strict';let __exports={};const{Layout}=require("@web/search/layout");const{useModelWithSampleData}=require("@web/model/model");const{standardViewProps}=require("@web/views/standard_view_props");const{useSetupView}=require("@web/views/view_hook");const{SearchBar}=require("@web/search/search_bar/search_bar");const{useSearchBarToggler}=require("@web/search/search_bar/search_bar_toggler");const{CogMenu}=require("@web/search/cog_menu/cog_menu");const{Component,useRef}=require("@odoo/owl");const GraphController=__exports.GraphController=class GraphController extends Component{setup(){this.model=useModelWithSampleData(this.props.Model,this.props.modelParams);useSetupView({rootRef:useRef("root"),getLocalState:()=>{return{metaData:this.model.metaData};},getContext:()=>this.getContext(),});this.searchBarToggler=useSearchBarToggler();}
getContext(){const{measure,groupBy,mode}=this.model.metaData;const context={graph_measure:measure,graph_mode:mode,graph_groupbys:groupBy.map((gb)=>gb.spec),};if(mode!=="pie"){context.graph_order=this.model.metaData.order;context.graph_stacked=this.model.metaData.stacked;if(mode==="line"){context.graph_cumulated=this.model.metaData.cumulated;}}
return context;}}
GraphController.template="web.GraphView";GraphController.components={Layout,SearchBar,CogMenu};GraphController.props={...standardViewProps,Model:Function,modelParams:Object,Renderer:Function,buttonTemplate:String,};return __exports;});;

/* /web/static/src/views/graph/graph_model.js */
odoo.define('@web/views/graph/graph_model',['@web/core/l10n/translation','@web/core/utils/arrays','@web/core/utils/concurrency','@web/search/utils/dates','@web/search/utils/group_by','@web/search/utils/misc','@web/model/model','@web/views/utils','@web/core/domain'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{sortBy,groupBy}=require("@web/core/utils/arrays");const{KeepLast,Race}=require("@web/core/utils/concurrency");const{rankInterval}=require("@web/search/utils/dates");const{getGroupBy}=require("@web/search/utils/group_by");const{GROUPABLE_TYPES}=require("@web/search/utils/misc");const{Model}=require("@web/model/model");const{computeReportMeasures,processMeasure}=require("@web/views/utils");const{Domain}=require("@web/core/domain");const SEP=__exports.SEP=" / ";const SEQUENTIAL_TYPES=__exports.SEQUENTIAL_TYPES=["date","datetime"];class DateClasses{constructor(array){this.__referenceIndex=null;this.__array=array;for(let i=0;i<this.__array.length;i++){const arr=this.__array[i];if(arr.length&&this.__referenceIndex===null){this.__referenceIndex=i;}}}
classLabel(index,o){return`${this.__array[index].indexOf(o)}`;}
classMembers(classLabel){const classNumber=Number(classLabel);const classMembers=new Set();for(const arr of this.__array){if(arr[classNumber]!==undefined){classMembers.add(arr[classNumber]);}}
return[...classMembers];}
representative(classLabel,index){const classNumber=Number(classLabel);const i=index===undefined?this.__referenceIndex:index;if(i===null){return null;}
return this.__array[i][classNumber];}
arrayLength(index){return this.__array[index].length;}}
const GraphModel=__exports.GraphModel=class GraphModel extends Model{setup(params){this.keepLast=new KeepLast();this.race=new Race();const _fetchDataPoints=this._fetchDataPoints.bind(this);this._fetchDataPoints=(...args)=>{return this.race.add(_fetchDataPoints(...args));};this.initialGroupBy=null;this.metaData=params;this.data=null;this.searchParams=null;this.lineOverlayDataset=null;}
async load(searchParams){this.searchParams=searchParams;if(!this.initialGroupBy){this.initialGroupBy=searchParams.context.graph_groupbys||this.metaData.groupBy;}
const metaData=this._buildMetaData();await this._fetchDataPoints(metaData);}
hasData(){return this.dataPoints.length>0;}
async updateMetaData(params){if("measure"in params){const metaData=this._buildMetaData(params);await this._fetchDataPoints(metaData);this.useSampleModel=false;}else{await this.race.getCurrentProm();this.metaData=Object.assign({},this.metaData,params);this._prepareData();}
this.notify();}
_buildMetaData(params){const{comparison,domain,context,groupBy}=this.searchParams;const metaData=Object.assign({},this.metaData,{context});if(comparison){metaData.domains=comparison.domains;metaData.comparisonField=comparison.fieldName;}else{metaData.domains=[{arrayRepr:domain,description:null}];}
metaData.measure=context.graph_measure||metaData.measure;metaData.mode=context.graph_mode||metaData.mode;metaData.groupBy=groupBy.length?groupBy:this.initialGroupBy;if(metaData.mode!=="pie"){metaData.order="graph_order"in context?context.graph_order:metaData.order;if(comparison){metaData.stacked=false;}else if("graph_stacked"in context){metaData.stacked=context.graph_stacked;}
if(metaData.mode==="line"){metaData.cumulated="graph_cumulated"in context?context.graph_cumulated:metaData.cumulated;}}
this._normalize(metaData);metaData.measures=computeReportMeasures(metaData.fields,metaData.fieldAttrs,[...(metaData.viewMeasures||[]),metaData.measure,]);return Object.assign(metaData,params);}
async _fetchDataPoints(metaData){this.dataPoints=await this.keepLast.add(this._loadDataPoints(metaData));this.metaData=metaData;this._prepareData();}
_getData(dataPoints){const{comparisonField,groupBy,mode}=this.metaData;let identify=false;if(comparisonField&&groupBy.length&&groupBy[0].fieldName===comparisonField){identify=true;}
const dateClasses=identify?this._getDateClasses(dataPoints):null;let labels=[];const labelMap={};for(const dataPt of dataPoints){const x=dataPt.labels.slice(0,mode==="pie"?undefined:1);const trueLabel=x.length?x.join(SEP):_t("Total");if(dateClasses){x[0]=dateClasses.classLabel(dataPt.originIndex,x[0]);}
const key=JSON.stringify(x);if(labelMap[key]===undefined){labelMap[key]=labels.length;if(dateClasses){if(mode==="pie"){x[0]=dateClasses.classMembers(x[0]).join(", ");}else{x[0]=dateClasses.representative(x[0]);}}
const label=x.length?x.join(SEP):_t("Total");labels.push(label);}
dataPt.labelIndex=labelMap[key];dataPt.trueLabel=trueLabel;}
const datasetsTmp={};for(const dataPt of dataPoints){const{domain,labelIndex,originIndex,trueLabel,value,identifier,cumulatedStart,}=dataPt;const datasetLabel=this._getDatasetLabel(dataPt);if(!(datasetLabel in datasetsTmp)){let dataLength=labels.length;if(mode!=="pie"&&dateClasses){dataLength=dateClasses.arrayLength(originIndex);}
datasetsTmp[datasetLabel]={data:new Array(dataLength).fill(0),cumulatedStart,trueLabels:labels.slice(0,dataLength),domains:new Array(dataLength).fill([]),label:datasetLabel,originIndex:originIndex,identifiers:new Set(),};}
datasetsTmp[datasetLabel].data[labelIndex]=value;datasetsTmp[datasetLabel].domains[labelIndex]=domain;datasetsTmp[datasetLabel].trueLabels[labelIndex]=trueLabel;datasetsTmp[datasetLabel].identifiers.add(identifier);}
let datasets=sortBy(Object.values(datasetsTmp),"originIndex");if(mode==="pie"){datasets=datasets.filter((dataset)=>dataset.data.some((v)=>Boolean(v)));const labelsToKeepIndexes={};labels.forEach((_,index)=>{if(datasets.some((dataset)=>Boolean(dataset.data[index]))){labelsToKeepIndexes[index]=true;}});labels=labels.filter((_,index)=>labelsToKeepIndexes[index]);for(const dataset of datasets){dataset.data=dataset.data.filter((_,index)=>labelsToKeepIndexes[index]);dataset.domains=dataset.domains.filter((_,index)=>labelsToKeepIndexes[index]);dataset.trueLabels=dataset.trueLabels.filter((_,index)=>labelsToKeepIndexes[index]);}}
return{datasets,labels};}
_getLabel(description){if(!description){return _t("Sum");}else{return _t("Sum (%s)",description);}}
_getLineOverlayDataset(){const{domains,stacked}=this.metaData;const data=this.data;let lineOverlayDataset=null;if(stacked){const stacks=groupBy(data.datasets,(dataset)=>dataset.originIndex);if(Object.keys(stacks).length==1){const[[originIndex,datasets]]=Object.entries(stacks);if(datasets.length>1){const data=[];for(const dataset of datasets){for(let i=0;i<dataset.data.length;i++){data[i]=(data[i]||0)+dataset.data[i];}}
lineOverlayDataset={label:this._getLabel(domains[originIndex].description),data,trueLabels:datasets[0].trueLabels,};}}}
return lineOverlayDataset;}
_getDatasetLabel(dataPoint){const{measure,measures,domains,mode}=this.metaData;const{labels,originIndex}=dataPoint;if(mode==="pie"){return domains[originIndex].description||"";}
let datasetLabel=labels.slice(1).join(SEP);if(domains.length>1){datasetLabel=domains[originIndex].description+(datasetLabel?SEP+datasetLabel:"");}
datasetLabel=datasetLabel||measures[measure].string;return datasetLabel;}
_getDateClasses(dataPoints){const{domains}=this.metaData;const dateSets=domains.map(()=>new Set());for(const{labels,originIndex}of dataPoints){const date=labels[0];dateSets[originIndex].add(date);}
const arrays=dateSets.map((dateSet)=>[...dateSet]);return new DateClasses(arrays);}
_getDefaultFilterLabel(field){return _t("None");}
_getProcessedDataPoints(){const{domains,groupBy,mode,order}=this.metaData;let processedDataPoints=[];if(mode==="line"){processedDataPoints=this.dataPoints.filter((dataPoint)=>dataPoint.labels[0]!==this._getDefaultFilterLabel(groupBy[0]));}else if(mode==="pie"){processedDataPoints=this.dataPoints.filter((dataPoint)=>dataPoint.value>0&&dataPoint.count!==0);}else{processedDataPoints=this.dataPoints.filter((dataPoint)=>dataPoint.count!==0);}
if(order!==null&&mode!=="pie"&&domains.length===1&&groupBy.length>0){const groupedDataPoints={};for(const dataPt of processedDataPoints){const key=dataPt.labels[0];if(!groupedDataPoints[key]){groupedDataPoints[key]=[];}
groupedDataPoints[key].push(dataPt);}
const groups=Object.values(groupedDataPoints);const groupTotal=(group)=>group.reduce((sum,dataPt)=>sum+dataPt.value,0);processedDataPoints=sortBy(groups,groupTotal,order.toLowerCase()).flat();}
return processedDataPoints;}
async _loadDataPoints(metaData){const{measure,domains,fields,groupBy,resModel,cumulatedStart}=metaData;const fieldName=groupBy[0]?.fieldName;const sequential_field=cumulatedStart&&SEQUENTIAL_TYPES.includes(fields[fieldName]?.type)?fieldName:null;const sequential_spec=sequential_field&&groupBy[0].spec;const measures=["__count"];if(measure!=="__count"){let{group_operator,type}=fields[measure];if(type==="many2one"){group_operator="count_distinct";}
if(group_operator===undefined){throw new Error(`No aggregate function has been provided for the measure '${measure}'`);}
measures.push(`${measure}:${group_operator}`);}
const numbering={};const proms=domains.map(async(domain,originIndex)=>{const data=await this.orm.webReadGroup(resModel,domain.arrayRepr,measures,groupBy.map((gb)=>gb.spec),{lazy:false,context:{fill_temporal:true,...this.searchParams.context},});let start=false;if(cumulatedStart&&sequential_field&&data.groups.length&&domain.arrayRepr.some((leaf)=>leaf.length===3&&leaf[0]==sequential_field)){const first_date=data.groups[0].__range[sequential_spec].from;const new_domain=Domain.combine([new Domain([[sequential_field,"<",first_date]]),Domain.removeDomainLeaves(domain.arrayRepr,[sequential_field]),],"AND").toList();start=await this.orm.webReadGroup(resModel,new_domain,measures,groupBy.filter((gb)=>gb.fieldName!=sequential_field).map((gb)=>gb.spec),{lazy:false,context:{...this.searchParams.context},});}
const dataPoints=[];const cumulatedStartValue={};if(start){for(const group of start.groups){const rawValues=[];for(const gb of groupBy.filter((gb)=>gb.fieldName!=sequential_field)){rawValues.push({[gb.spec]:group[gb.spec]});}
cumulatedStartValue[JSON.stringify(rawValues)]=group[measure];}}
for(const group of data.groups){const{__domain,__count}=group;const labels=[];const rawValues=[];for(const gb of groupBy){let label;const val=group[gb.spec];rawValues.push({[gb.spec]:val});const fieldName=gb.fieldName;const{type}=fields[fieldName];if(type==="boolean"){label=`${val}`;}else if(val===false){label=this._getDefaultFilterLabel(gb);}else if(["many2many","many2one"].includes(type)){const[id,name]=val;const key=JSON.stringify([fieldName,name]);if(!numbering[key]){numbering[key]={};}
const numbers=numbering[key];if(!numbers[id]){numbers[id]=Object.keys(numbers).length+1;}
const num=numbers[id];label=num===1?name:`${name} (${num})`;}else if(type==="selection"){const selected=fields[fieldName].selection.find((s)=>s[0]===val);label=selected[1];}else{label=val;}
labels.push(label);}
let value=group[measure];if(value instanceof Array){value=1;}
if(!Number.isInteger(value)){metaData.allIntegers=false;}
const group_id=JSON.stringify(rawValues.slice(1));dataPoints.push({count:__count,domain:__domain,value,labels,originIndex,identifier:JSON.stringify(rawValues),cumulatedStart:cumulatedStartValue[group_id]||0,});}
return dataPoints;});const promResults=await Promise.all(proms);return promResults.flat();}
_normalize(metaData){const{fields}=metaData;const groupBy=[];for(const gb of metaData.groupBy){let ngb=gb;if(typeof gb==="string"){ngb=getGroupBy(gb,fields);}
groupBy.push(ngb);}
const processedGroupBy=[];for(const gb of groupBy){const{fieldName,interval}=gb;const{sortable,type,store}=fields[fieldName];if((type==="many2many"?!store:!sortable)||["id","__count"].includes(fieldName)||!GROUPABLE_TYPES.includes(type)){continue;}
const index=processedGroupBy.findIndex((gb)=>gb.fieldName===fieldName);if(index===-1){processedGroupBy.push(gb);}else if(interval){const registeredInterval=processedGroupBy[index].interval;if(rankInterval(registeredInterval)<rankInterval(interval)){processedGroupBy.splice(index,1,gb);}}}
metaData.groupBy=processedGroupBy;metaData.measure=processMeasure(metaData.measure);}
_prepareData(){const processedDataPoints=this._getProcessedDataPoints();this.data=this._getData(processedDataPoints);this.lineOverlayDataset=null;if(this.metaData.mode==="bar"){this.lineOverlayDataset=this._getLineOverlayDataset();}}}
return __exports;});;

/* /web/static/src/views/graph/graph_renderer.js */
odoo.define('@web/views/graph/graph_renderer',['@web/core/l10n/translation','@web/core/registry','@web/core/colors/colors','@web/views/fields/formatters','@web/views/graph/graph_model','@web/core/utils/arrays','@web/core/assets','@web/core/utils/render','@web/core/utils/hooks','@odoo/owl','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/browser/cookie'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{getBorderWhite,DEFAULT_BG,getColor,hexToRGBA}=require("@web/core/colors/colors");const{formatFloat}=require("@web/views/fields/formatters");const{SEP}=require("@web/views/graph/graph_model");const{sortBy}=require("@web/core/utils/arrays");const{loadBundle}=require("@web/core/assets");const{renderToString}=require("@web/core/utils/render");const{useService}=require("@web/core/utils/hooks");const{Component,onWillUnmount,useEffect,useRef,onWillStart}=require("@odoo/owl");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{cookie}=require("@web/core/browser/cookie");const NO_DATA=_t("No data");const formatters=registry.category("formatters");const LINE_FILL_TRANSPARENCY=__exports.LINE_FILL_TRANSPARENCY=0.4;function getMaxWidth(chartArea){const{left,right}=chartArea;return Math.floor((right-left)/1.618)+"px";}
function shortenLabel(label){const groups=label.toString().split(SEP);let shortLabel=groups.slice(0,3).join(SEP);if(shortLabel.length>30){shortLabel=`${shortLabel.slice(0, 30)}...`;}else if(groups.length>3){shortLabel=`${shortLabel}${SEP}...`;}
return shortLabel;}
const GraphRenderer=__exports.GraphRenderer=class GraphRenderer extends Component{setup(){this.model=this.props.model;this.rootRef=useRef("root");this.canvasRef=useRef("canvas");this.containerRef=useRef("container");this.actionService=useService("action");this.chart=null;this.tooltip=null;this.legendTooltip=null;onWillStart(async()=>{await loadBundle("web.chartjs_lib");});useEffect(()=>this.renderChart());onWillUnmount(this.onWillUnmount);}
onWillUnmount(){if(this.chart){this.chart.destroy();}}
adjustTooltipHeight(tooltip,maxTooltipHeight){const sizeOneLine=tooltip.querySelector("tbody tr").clientHeight;const tbodySize=tooltip.querySelector("tbody").clientHeight;const toKeep=Math.max(0,Math.floor((maxTooltipHeight-(tooltip.clientHeight-tbodySize))/sizeOneLine)-1);const lines=tooltip.querySelectorAll("tbody tr");const toRemove=lines.length-toKeep;if(toRemove>0){for(let index=toKeep;index<lines.length;++index){lines[index].remove();}
const tr=document.createElement("tr");const td=document.createElement("td");tr.classList.add("o_show_more","text-center","fw-bold");td.setAttribute("colspan","2");td.innerText=_t("...");tr.appendChild(td);tooltip.querySelector("tbody").appendChild(tr);}}
customTooltip(data,metaData,context){const tooltipModel=context.tooltip;const{measure,measures,disableLinking,mode}=metaData;this.containerRef.el.style.cursor="";this.removeTooltips();if(tooltipModel.opacity===0||tooltipModel.dataPoints.length===0){return;}
if(!disableLinking&&mode!=="line"){this.containerRef.el.style.cursor="pointer";}
const chartAreaTop=this.chart.chartArea.top;const viewContentTop=this.containerRef.el.getBoundingClientRect().top;const innerHTML=renderToString("web.GraphRenderer.CustomTooltip",{maxWidth:getMaxWidth(this.chart.chartArea),measure:measures[measure].string,mode:this.model.metaData.mode,tooltipItems:this.getTooltipItems(data,metaData,tooltipModel),});const template=Object.assign(document.createElement("template"),{innerHTML});const tooltip=template.content.firstChild;this.containerRef.el.prepend(tooltip);let top;const tooltipHeight=tooltip.clientHeight;const minTopAllowed=Math.floor(chartAreaTop);const maxTopAllowed=Math.floor(window.innerHeight-(viewContentTop+tooltipHeight))-2;const y=Math.floor(tooltipModel.y);if(minTopAllowed<=maxTopAllowed){if(y<=maxTopAllowed){if(y>=minTopAllowed){top=y;}else{top=minTopAllowed;}}else{top=maxTopAllowed;}}else{top=minTopAllowed;const maxTooltipHeight=window.innerHeight-(viewContentTop+chartAreaTop)-2;this.adjustTooltipHeight(tooltip,maxTooltipHeight);}
this.fixTooltipLeftPosition(tooltip,tooltipModel.x);tooltip.style.top=Math.floor(top)+"px";this.tooltip=tooltip;}
fixTooltipLeftPosition(tooltip,x){let left;const tooltipWidth=tooltip.clientWidth;const minLeftAllowed=Math.floor(this.chart.chartArea.left+2);const maxLeftAllowed=Math.floor(this.chart.chartArea.right-tooltipWidth-2);x=Math.floor(x);if(x<minLeftAllowed){left=minLeftAllowed;}else if(x>maxLeftAllowed){left=maxLeftAllowed;}else{left=x;}
tooltip.style.left=`${left}px`;}
formatValue(value,allIntegers=true,formatType=""){const largeNumber=Math.abs(value)>=1000;if(formatType){return formatters.get(formatType)(value);}
if(allIntegers&&!largeNumber){return String(value);}
if(largeNumber){return formatFloat(value,{humanReadable:true,decimals:2,minDigits:1});}
return formatFloat(value);}
getBarChartData(){const{domains,stacked}=this.model.metaData;const{data,lineOverlayDataset}=this.model;for(let index=0;index<data.datasets.length;++index){const dataset=data.datasets[index];if(stacked){dataset.stack=domains[dataset.originIndex].description||"";}
dataset.backgroundColor=getColor(index,cookie.get("color_scheme"));}
if(lineOverlayDataset){const color=cookie.get("color_scheme")==="dark"?"ffffff":"000000";Object.assign(lineOverlayDataset,{type:"line",order:-1,tension:0,fill:false,borderWidth:2,borderDash:[5,4],borderColor:hexToRGBA(color,LINE_FILL_TRANSPARENCY),pointHitRadius:5,pointRadius:5,pointHoverRadius:10,backgroundColor:hexToRGBA(color,LINE_FILL_TRANSPARENCY),});return{...data,datasets:[...data.datasets,lineOverlayDataset],};}
return data;}
getChartConfig(){const{mode}=this.model.metaData;let data;switch(mode){case"bar":data=this.getBarChartData();break;case"line":data=this.getLineChartData();break;case"pie":data=this.getPieChartData();}
const options=this.prepareOptions();return{data,options,type:mode};}
getElementOptions(){const{mode,stacked}=this.model.metaData;const elementOptions={};if(mode==="bar"){elementOptions.bar={borderWidth:1};}else if(mode==="line"){elementOptions.line={fill:stacked,tension:0};}
return elementOptions;}
getLegendOptions(){const{mode}=this.model.metaData;const data=this.model.data;const refLength=mode==="pie"?data.labels.length:data.datasets.length;const legendOptions={display:refLength<=20,position:"top",onHover:this.onlegendHover.bind(this),onLeave:this.onLegendLeave.bind(this),};if(mode==="line"){legendOptions.onClick=this.onLegendClick.bind(this);}
if(mode==="pie"){legendOptions.labels={generateLabels:(chart)=>{return chart.data.labels.map((label,index)=>{const hidden=!chart.getDataVisibility(index);const fullText=label;const text=shortenLabel(fullText);const fillStyle=label===NO_DATA?DEFAULT_BG:getColor(index,cookie.get("color_scheme"));const fontColor=cookie.get("color_scheme")==="dark"?getColor(15,cookie.get("color_scheme")):null;return{text,fullText,fillStyle,hidden,index,fontColor};});},};}else{const referenceColor=mode==="bar"?"backgroundColor":"borderColor";legendOptions.labels={generateLabels:(chart)=>{const{data}=chart;const labels=data.datasets.map((dataset,index)=>{return{text:shortenLabel(dataset.label),fullText:dataset.label,fillStyle:dataset[referenceColor],hidden:!chart.isDatasetVisible(index),lineCap:dataset.borderCapStyle,lineDash:dataset.borderDash,lineDashOffset:dataset.borderDashOffset,lineJoin:dataset.borderJoinStyle,lineWidth:dataset.borderWidth,strokeStyle:dataset[referenceColor],pointStyle:dataset.pointStyle,datasetIndex:index,fontColor:cookie.get("color_scheme")==="dark"?getColor(15,cookie.get("color_scheme")):null,};});return labels;},};}
return legendOptions;}
getLineChartData(){const{groupBy,domains,stacked,cumulated}=this.model.metaData;const data=this.model.data;const color0=getColor(0,cookie.get("color_scheme"));const color1=getColor(1,cookie.get("color_scheme"));for(let index=0;index<data.datasets.length;++index){const dataset=data.datasets[index];if(groupBy.length<=1&&domains.length>1){if(dataset.originIndex===0){dataset.fill="origin";dataset.backgroundColor=hexToRGBA(color0,LINE_FILL_TRANSPARENCY);dataset.borderColor=color0;}else if(dataset.originIndex===1){dataset.borderColor=color1;}else{dataset.borderColor=getColor(index,cookie.get("color_scheme"));}}else{dataset.borderColor=getColor(index,cookie.get("color_scheme"));}
if(cumulated){let accumulator=dataset.cumulatedStart;dataset.data=dataset.data.map((value)=>{accumulator+=value;return accumulator;});}
if(data.labels.length===1){dataset.data.unshift(undefined);dataset.trueLabels.unshift(undefined);dataset.domains.unshift(undefined);}
dataset.pointBackgroundColor=dataset.borderColor;dataset.pointBorderColor="rgba(0,0,0,0.2)";if(stacked){dataset.backgroundColor=hexToRGBA(dataset.borderColor,LINE_FILL_TRANSPARENCY);}}
if(data.datasets.length===1&&data.datasets[0].originIndex===0){const dataset=data.datasets[0];dataset.fill="origin";dataset.backgroundColor=hexToRGBA(color0,LINE_FILL_TRANSPARENCY);}
data.labels=data.labels.length>1?data.labels:["",...data.labels,""];return data;}
getPieChartData(){const{domains}=this.model.metaData;const data=this.model.data;const colors=data.labels.map((_,index)=>getColor(index,cookie.get("color_scheme")));const borderColor=getBorderWhite(cookie.get("color_scheme"));for(const dataset of data.datasets){dataset.backgroundColor=colors;dataset.borderColor=borderColor;}
const representedOriginIndexes=new Set(data.datasets.map((dataset)=>dataset.originIndex));let addNoDataToLegend=false;const fakeData=new Array(data.labels.length+1);fakeData[data.labels.length]=1;const fakeTrueLabels=new Array(data.labels.length+1);fakeTrueLabels[data.labels.length]=NO_DATA;for(let index=0;index<domains.length;++index){if(!representedOriginIndexes.has(index)){data.datasets.push({label:domains[index].description,data:fakeData,trueLabels:fakeTrueLabels,backgroundColor:[...colors,DEFAULT_BG],borderColor,});addNoDataToLegend=true;}}
if(addNoDataToLegend){data.labels.push(NO_DATA);}
return data;}
getScaleOptions(){const labels=this.model.data.labels;const{allIntegers,fieldAttrs,fields,groupBy,measure,measures,mode,stacked}=this.model.metaData;if(mode==="pie"){return{};}
const xAxe={type:"category",title:{display:Boolean(groupBy.length),text:groupBy.length?fields[groupBy[0].fieldName].string:"",color:cookie.get("color_scheme")==="dark"?getColor(15,cookie.get("color_scheme")):null,},ticks:{callback:(val,index)=>{const value=labels[index];return shortenLabel(value);},color:cookie.get("color_scheme")==="dark"?getColor(15,cookie.get("color_scheme")):null,},};const yAxe={type:"linear",title:{text:measures[measure].string,color:cookie.get("color_scheme")==="dark"?getColor(15,cookie.get("color_scheme")):null,},ticks:{callback:(value)=>this.formatValue(value,allIntegers,fieldAttrs[measure]?.widget),color:cookie.get("color_scheme")==="dark"?getColor(15,cookie.get("color_scheme")):null,},suggestedMax:0,suggestedMin:0,stacked:mode==="line"&&stacked?stacked:undefined,};return{x:xAxe,y:yAxe};}
getTooltipItems(data,metaData,tooltipModel){const{allIntegers,domains,mode,groupBy,measure}=metaData;const sortedDataPoints=sortBy(tooltipModel.dataPoints,"raw","desc");const items=[];for(const item of sortedDataPoints){const index=item.dataIndex;const dataset=data.datasets[item.datasetIndex]||this.model.lineOverlayDataset;let label=dataset.trueLabels[index];let value=dataset.data[index];const measureWidget=metaData.fieldAttrs[measure]?.widget;value=this.formatValue(value,allIntegers,measureWidget);let boxColor;let percentage;if(mode==="pie"){if(label===NO_DATA){value=this.formatValue(0,allIntegers,measureWidget);}
if(domains.length>1){label=`${dataset.label} / ${label}`;}
boxColor=dataset.backgroundColor[index];const totalData=dataset.data.reduce((a,b)=>a+b,0);percentage=totalData&&((dataset.data[index]*100)/totalData).toFixed(2);}else{if(groupBy.length>1||domains.length>1){label=`${label} / ${dataset.label}`;}
boxColor=mode==="bar"?dataset.backgroundColor:dataset.borderColor;}
items.push({label,value,boxColor,percentage});}
return items;}
getTooltipOptions(){const{data,metaData}=this.model;const{mode}=metaData;const tooltipOptions={enabled:false,external:this.customTooltip.bind(this,data,metaData),};if(mode==="line"){tooltipOptions.mode="index";tooltipOptions.intersect=false;}
return tooltipOptions;}
onGraphClicked(ev){const[activeElement]=this.chart.getElementsAtEventForMode(ev,"nearest",{intersect:true},false);if(!activeElement){return;}
const{datasetIndex,index}=activeElement;const{domains}=this.chart.data.datasets[datasetIndex];if(domains){this.onGraphClickedFinal(domains[index]);}}
onLegendClick(ev,legendItem){this.removeTooltips();const index=legendItem.datasetIndex;const meta=this.chart.getDatasetMeta(index);meta.hidden=meta.hidden===null?!this.chart.data.datasets[index].hidden:null;this.chart.update();}
onlegendHover(ev,legendItem){ev=ev.native;this.canvasRef.el.style.cursor="pointer";const{fullText,text}=legendItem;if(this.legendTooltip||text===fullText){return;}
const viewContentTop=this.canvasRef.el.getBoundingClientRect().top;const legendTooltip=Object.assign(document.createElement("div"),{className:"o_tooltip_legend popover p-3 pe-none",innerText:fullText,});legendTooltip.style.top=`${ev.clientY - viewContentTop}px`;legendTooltip.style.maxWidth=getMaxWidth(this.chart.chartArea);this.containerRef.el.appendChild(legendTooltip);this.fixTooltipLeftPosition(legendTooltip,ev.clientX);this.legendTooltip=legendTooltip;}
onLegendLeave(){this.canvasRef.el.style.cursor="";this.removeLegendTooltip();}
prepareOptions(){const{disableLinking,mode}=this.model.metaData;const options={maintainAspectRatio:false,scales:this.getScaleOptions(),plugins:{legend:this.getLegendOptions(),tooltip:this.getTooltipOptions(),},elements:this.getElementOptions(),};if(!disableLinking&&mode!=="line"){options.onClick=this.onGraphClicked.bind(this);}
return options;}
removeLegendTooltip(){if(this.legendTooltip){this.legendTooltip.remove();this.legendTooltip=null;}}
removeTooltips(){if(this.tooltip){this.tooltip.remove();this.tooltip=null;}
this.removeLegendTooltip();}
renderChart(){if(this.chart){this.chart.destroy();}
const config=this.getChartConfig();this.chart=new Chart(this.canvasRef.el,config);}
openView(domain,views,context){this.actionService.doAction({context,domain,name:this.model.metaData.title,res_model:this.model.metaData.resModel,target:"current",type:"ir.actions.act_window",views,},{viewType:"list",});}
onGraphClickedFinal(domain){const{context}=this.model.metaData;Object.keys(context).forEach((x)=>{if(x==="group_by"||x.startsWith("search_default_")){delete context[x];}});const views={};for(const[viewId,viewType]of this.env.config.views||[]){views[viewType]=viewId;}
function getView(viewType){return[views[viewType]||false,viewType];}
const actionViews=[getView("list"),getView("form")];this.openView(domain,actionViews,context);}
onMeasureSelected({measure}){this.model.updateMetaData({measure});}
onModeSelected(mode){this.model.updateMetaData({mode});}
toggleOrder(order){const{order:currentOrder}=this.model.metaData;const nextOrder=currentOrder===order?null:order;this.model.updateMetaData({order:nextOrder});}
toggleStacked(){const{stacked}=this.model.metaData;this.model.updateMetaData({stacked:!stacked});}
toggleCumulated(){const{cumulated}=this.model.metaData;this.model.updateMetaData({cumulated:!cumulated});}}
GraphRenderer.template="web.GraphRenderer";GraphRenderer.components={Dropdown,DropdownItem};GraphRenderer.props=["class?","model","buttonTemplate"];return __exports;});;

/* /web/static/src/views/graph/graph_search_model.js */
odoo.define('@web/views/graph/graph_search_model',['@web/search/search_model'],function(require){'use strict';let __exports={};const{SearchModel}=require("@web/search/search_model");const GraphSearchModel=__exports.GraphSearchModel=class GraphSearchModel extends SearchModel{_getIrFilterDescription(){this.preparingIrFilterDescription=true;const result=super._getIrFilterDescription(...arguments);this.preparingIrFilterDescription=false;return result;}
_getSearchItemGroupBys(activeItem){const{searchItemId}=activeItem;const{context,type}=this.searchItems[searchItemId];if(!this.preparingIrFilterDescription&&type==="favorite"&&context.graph_groupbys){return context.graph_groupbys;}
return super._getSearchItemGroupBys(...arguments);}}
return __exports;});;

/* /web/static/src/views/graph/graph_view.js */
odoo.define('@web/views/graph/graph_view',['@web/core/l10n/translation','@web/core/registry','@web/views/graph/graph_arch_parser','@web/views/graph/graph_model','@web/views/graph/graph_controller','@web/views/graph/graph_renderer','@web/views/graph/graph_search_model'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{GraphArchParser}=require("@web/views/graph/graph_arch_parser");const{GraphModel}=require("@web/views/graph/graph_model");const{GraphController}=require("@web/views/graph/graph_controller");const{GraphRenderer}=require("@web/views/graph/graph_renderer");const{GraphSearchModel}=require("@web/views/graph/graph_search_model");const viewRegistry=registry.category("views");const graphView=__exports.graphView={type:"graph",display_name:_t("Graph"),icon:"fa fa-area-chart",multiRecord:true,Controller:GraphController,Renderer:GraphRenderer,Model:GraphModel,ArchParser:GraphArchParser,SearchModel:GraphSearchModel,searchMenuTypes:["filter","groupBy","comparison","favorite"],buttonTemplate:"web.GraphView.Buttons",props:(genericProps,view)=>{let modelParams;if(genericProps.state){modelParams=genericProps.state.metaData;}else{const{arch,fields,resModel}=genericProps;const parser=new view.ArchParser();const archInfo=parser.parse(arch,fields);modelParams={disableLinking:Boolean(archInfo.disableLinking),fieldAttrs:archInfo.fieldAttrs,fields:fields,groupBy:archInfo.groupBy,measure:archInfo.measure||"__count",viewMeasures:archInfo.measures,mode:archInfo.mode||"bar",order:archInfo.order||null,resModel:resModel,stacked:"stacked"in archInfo?archInfo.stacked:true,cumulated:archInfo.cumulated||false,cumulatedStart:archInfo.cumulatedStart||false,title:archInfo.title||_t("Untitled"),};}
return{...genericProps,modelParams,Model:view.Model,Renderer:view.Renderer,buttonTemplate:view.buttonTemplate,};},};viewRegistry.add("graph",graphView);return __exports;});;

/* /web/static/src/views/kanban/kanban_arch_parser.js */
odoo.define('@web/views/kanban/kanban_arch_parser',['@web/core/utils/xml','@web/search/utils/order_by','@web/views/fields/field','@web/views/widgets/widget','@web/views/utils'],function(require){'use strict';let __exports={};const{extractAttributes,visitXML}=require("@web/core/utils/xml");const{stringToOrderBy}=require("@web/search/utils/order_by");const{Field}=require("@web/views/fields/field");const{Widget}=require("@web/views/widgets/widget");const{archParseBoolean,getActiveActions,processButton}=require("@web/views/utils");const KANBAN_BOX_ATTRIBUTE=__exports.KANBAN_BOX_ATTRIBUTE="kanban-box";const KANBAN_MENU_ATTRIBUTE=__exports.KANBAN_MENU_ATTRIBUTE="kanban-menu";const KANBAN_TOOLTIP_ATTRIBUTE=__exports.KANBAN_TOOLTIP_ATTRIBUTE="kanban-tooltip";const KanbanArchParser=__exports.KanbanArchParser=class KanbanArchParser{parse(xmlDoc,models,modelName){const fields=models[modelName];const className=xmlDoc.getAttribute("class")||null;let defaultOrder=stringToOrderBy(xmlDoc.getAttribute("default_order")||null);const defaultGroupBy=xmlDoc.getAttribute("default_group_by");const limit=xmlDoc.getAttribute("limit");const countLimit=xmlDoc.getAttribute("count_limit");const recordsDraggable=archParseBoolean(xmlDoc.getAttribute("records_draggable"),true);const groupsDraggable=archParseBoolean(xmlDoc.getAttribute("groups_draggable"),true);const activeActions=getActiveActions(xmlDoc);activeActions.archiveGroup=archParseBoolean(xmlDoc.getAttribute("archivable"),true);activeActions.createGroup=archParseBoolean(xmlDoc.getAttribute("group_create"),true);activeActions.deleteGroup=archParseBoolean(xmlDoc.getAttribute("group_delete"),true);activeActions.editGroup=archParseBoolean(xmlDoc.getAttribute("group_edit"),true);activeActions.quickCreate=activeActions.create&&archParseBoolean(xmlDoc.getAttribute("quick_create"),true);const onCreate=xmlDoc.getAttribute("on_create");const quickCreateView=xmlDoc.getAttribute("quick_create_view");const tooltipInfo={};let handleField=null;const fieldNodes={};const fieldNextIds={};const widgetNodes={};let widgetNextId=0;const jsClass=xmlDoc.getAttribute("js_class");const action=xmlDoc.getAttribute("action");const type=xmlDoc.getAttribute("type");const openAction=action&&type?{action,type}:null;const templateDocs={};let headerButtons=[];const creates=[];let button_id=0;visitXML(xmlDoc,(node)=>{if(node.hasAttribute("t-name")){templateDocs[node.getAttribute("t-name")]=node;return;}
if(node.tagName==="header"){headerButtons=[...node.children].filter((node)=>node.tagName==="button").map((node)=>({...processButton(node),type:"button",id:button_id++,})).filter((button)=>button.invisible!=="True"&&button.invisible!=="1");return false;}else if(node.tagName==="control"){for(const childNode of node.children){if(childNode.tagName==="button"){creates.push({type:"button",...processButton(childNode),});}else if(childNode.tagName==="create"){creates.push({type:"create",context:childNode.getAttribute("context"),string:childNode.getAttribute("string"),});}}
return false;}
if(node.tagName==="field"){const widget=node.getAttribute("widget");if(!widget&&models[modelName][node.getAttribute("name")].type==="many2many"){node.setAttribute("widget","many2many_tags");}
const fieldInfo=Field.parseFieldNode(node,models,modelName,"kanban",jsClass);if(!node.hasAttribute("force_save")){fieldInfo.forceSave=true;}
const name=fieldInfo.name;if(!(fieldInfo.name in fieldNextIds)){fieldNextIds[fieldInfo.name]=0;}
const fieldId=`${fieldInfo.name}_${fieldNextIds[fieldInfo.name]++}`;fieldNodes[fieldId]=fieldInfo;node.setAttribute("field_id",fieldId);if(fieldInfo.options.group_by_tooltip){tooltipInfo[name]=fieldInfo.options.group_by_tooltip;}
if(fieldInfo.isHandle){handleField=name;}}
if(node.tagName==="widget"){const widgetInfo=Widget.parseWidgetNode(node);const widgetId=`widget_${++widgetNextId}`;widgetNodes[widgetId]=widgetInfo;node.setAttribute("widget_id",widgetId);}
if(node.tagName==="img"){const attSrc=node.getAttribute("t-att-src");if(attSrc&&/\bkanban_image\b/.test(attSrc)&&!Object.values(fieldNodes).some((f)=>f.name==="write_date")){fieldNodes.write_date_0={name:"write_date",type:"datetime"};}}});let progressAttributes=false;const progressBar=xmlDoc.querySelector("progressbar");if(progressBar){progressAttributes=this.parseProgressBar(progressBar,fields);}
const cardDoc=templateDocs[KANBAN_BOX_ATTRIBUTE];if(!cardDoc){throw new Error(`Missing '${KANBAN_BOX_ATTRIBUTE}' template.`);}
const cardColorEl=cardDoc.querySelector("[color]");const cardColorField=cardColorEl&&cardColorEl.getAttribute("color");const colorEl=xmlDoc.querySelector("templates .oe_kanban_colorpicker[data-field]");const colorField=(colorEl&&colorEl.getAttribute("data-field"))||"color";if(!defaultOrder.length&&handleField){defaultOrder=stringToOrderBy(handleField);}
return{activeActions,className,creates,defaultGroupBy,fieldNodes,widgetNodes,handleField,headerButtons,colorField,defaultOrder,onCreate,openAction,quickCreateView,recordsDraggable,groupsDraggable,limit:limit&&parseInt(limit,10),countLimit:countLimit&&parseInt(countLimit,10),progressAttributes,cardColorField,templateDocs,tooltipInfo,examples:xmlDoc.getAttribute("examples"),xmlDoc,};}
parseProgressBar(progressBar,fields){const attrs=extractAttributes(progressBar,["field","colors","sum_field","help"]);return{fieldName:attrs.field,colors:JSON.parse(attrs.colors),sumField:fields[attrs.sum_field]||false,help:attrs.help,};}}
return __exports;});;

/* /web/static/src/views/kanban/kanban_column_examples_dialog.js */
odoo.define('@web/views/kanban/kanban_column_examples_dialog',['@web/core/dialog/dialog','@web/core/notebook/notebook','@web/core/l10n/translation','@odoo/owl'],function(require){'use strict';let __exports={};const{Dialog}=require("@web/core/dialog/dialog");const{Notebook}=require("@web/core/notebook/notebook");const{_t}=require("@web/core/l10n/translation");const{Component,useRef}=require("@odoo/owl");const random=(min,max)=>Math.floor(Math.random()*(max-min)+min);class KanbanExamplesNotebookTemplate extends Component{static defaultProps={columns:[],foldedColumns:[],};setup(){this.columns=[];const hasBullet=this.props.bullets&&this.props.bullets.length;const allColumns=[...this.props.columns,...this.props.foldedColumns];for(const title of allColumns){const col={title,records:[]};this.columns.push(col);for(let i=0;i<random(1,5);i++){const rec={id:i};if(hasBullet&&Math.random()>0.3){const sampleId=Math.floor(Math.random()*this.props.bullets.length);rec.bullet=this.props.bullets[sampleId];}
col.records.push(rec);}}}}
KanbanExamplesNotebookTemplate.template="web.KanbanExamplesNotebookTemplate";const KanbanColumnExamplesDialog=__exports.KanbanColumnExamplesDialog=class KanbanColumnExamplesDialog extends Component{setup(){this.navList=useRef("navList");this.pages=[];this.activePage=null;this.props.examples.forEach((eg)=>{this.pages.push({Component:KanbanExamplesNotebookTemplate,title:eg.name,props:eg,id:eg.name,});});}
onPageUpdate(page){this.activePage=page;}
applyExamples(){const index=this.props.examples.findIndex((e)=>e.name===this.activePage);this.props.applyExamples(index);this.props.close();}}
KanbanColumnExamplesDialog.template="web.KanbanColumnExamplesDialog";KanbanColumnExamplesDialog.components={Dialog,Notebook};KanbanColumnExamplesDialog.title=_t("Kanban Examples");return __exports;});;

/* /web/static/src/views/kanban/kanban_column_quick_create.js */
odoo.define('@web/views/kanban/kanban_column_quick_create',['@web/core/l10n/translation','@web/core/hotkeys/hotkey_hook','@web/core/utils/hooks','@web/views/kanban/kanban_column_examples_dialog','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{useHotkey}=require("@web/core/hotkeys/hotkey_hook");const{useAutofocus,useService}=require("@web/core/utils/hooks");const{KanbanColumnExamplesDialog}=require("@web/views/kanban/kanban_column_examples_dialog");const{Component,useExternalListener,useState,useRef}=require("@odoo/owl");const KanbanColumnQuickCreate=__exports.KanbanColumnQuickCreate=class KanbanColumnQuickCreate extends Component{setup(){this.dialog=useService("dialog");this.root=useRef("root");this.state=useState({hasInputFocused:false,});useAutofocus();this.inputRef=useRef("autofocus");useExternalListener(window,"mousedown",(ev)=>{this.mousedownTarget=ev.target;});useExternalListener(window,"click",(ev)=>{const target=this.mousedownTarget||ev.target;const gotClickedInside=this.root.el.contains(target);if(!gotClickedInside){this.fold();}
this.mousedownTarget=null;},{capture:true});useHotkey("escape",()=>this.fold());}
get canShowExamples(){const{allowedGroupBys=[],examples=[]}=this.props.exampleData||{};const hasExamples=Boolean(examples.length);return hasExamples&&allowedGroupBys.includes(this.props.groupByField.name);}
get relatedFieldName(){return this.props.groupByField.string;}
fold(){this.props.onFoldChange(true);}
unfold(){this.props.onFoldChange(false);}
validate(){const title=this.inputRef.el.value.trim();if(title.length){this.props.onValidate(title);this.inputRef.el.value="";}}
showExamples(){this.dialog.add(KanbanColumnExamplesDialog,{examples:this.props.exampleData.examples,applyExamplesText:this.props.exampleData.applyExamplesText||_t("Use This For My Kanban"),applyExamples:(index)=>{const{examples,foldField}=this.props.exampleData;const{columns,foldedColumns=[]}=examples[index];for(const groupName of columns){this.props.onValidate(groupName);}
for(const groupName of foldedColumns){this.props.onValidate(groupName,foldField);}},});}
onInputKeydown(ev){if(ev.key==="Enter"){this.validate();}}}
KanbanColumnQuickCreate.props={exampleData:[Object,{value:null}],onFoldChange:Function,onValidate:Function,folded:Boolean,groupByField:Object,};KanbanColumnQuickCreate.template="web.KanbanColumnQuickCreate";return __exports;});;

/* /web/static/src/views/kanban/kanban_compiler.js */
odoo.define('@web/views/kanban/kanban_compiler',['@web/core/utils/xml','@web/views/utils','@web/views/view_compiler'],function(require){'use strict';let __exports={};const{append,combineAttributes,createElement,extractAttributes,getTag,}=require("@web/core/utils/xml");const{toStringExpression}=require("@web/views/utils");const{toInterpolatedStringExpression,ViewCompiler}=require("@web/views/view_compiler");const ACTION_TYPES=["action","object"];const SPECIAL_TYPES=[...ACTION_TYPES,"edit","open","delete","url","set_cover"];const KanbanCompiler=__exports.KanbanCompiler=class KanbanCompiler extends ViewCompiler{setup(){this.ctx.readonly="read_only_mode";this.compilers.push({selector:".oe_kanban_colorpicker",fn:this.compileColorPicker},{selector:"t[t-call]",fn:this.compileTCall},{selector:"img",fn:this.compileImage});}
compileButton(el,params){if(el.hasAttribute("data-type")){for(const{name,value}of el.attributes){el.setAttribute(name.replace(/^data-/,""),value);}}
const type=el.getAttribute("type");if(!SPECIAL_TYPES.includes(type)){return super.compileButton(el,params);}
combineAttributes(el,"class",["oe_kanban_action",`oe_kanban_action_${getTag(el, true)}`,]);if(ACTION_TYPES.includes(type)){if(!el.hasAttribute("debounce")){el.setAttribute("debounce",300);}
return super.compileButton(el,params);}
const nodeParams=extractAttributes(el,["type"]);if(type==="set_cover"){const{"auto-open":autoOpen,"data-field":fieldName}=extractAttributes(el,["auto-open","data-field",]);Object.assign(nodeParams,{autoOpen,fieldName});}
const strParams=Object.entries(nodeParams).map(([k,v])=>[k,toStringExpression(v)].join(":")).join(",");el.setAttribute("t-on-click",`()=>__comp__.triggerAction({${strParams}})`);const compiled=createElement(el.nodeName);for(const{name,value}of el.attributes){compiled.setAttribute(name,value);}
if(getTag(el,true)==="a"&&!compiled.hasAttribute("href")){compiled.setAttribute("href","#");}
for(const child of el.childNodes){append(compiled,this.compileNode(child,params));}
return compiled;}
compileImage(el){const element=el.cloneNode(true);element.setAttribute("loading","lazy");return element;}
compileColorPicker(){return createElement("t",{"t-call":"web.KanbanColorPicker","t-call-context":"__comp__",});}
compileField(el,params){let compiled;let isSpan=false;const recordExpr=params.recordExpr||'__comp__.props.record';const dataPointIdExpr=params.dataPointIdExpr||`${recordExpr}.id`;if(!el.hasAttribute("widget")){isSpan=true;const fieldId=el.getAttribute("field_id");compiled=createElement("span",{"t-out":params.formattedValueExpr||`__comp__.getFormattedValue("${fieldId}")`,});}else{compiled=super.compileField(el,params);const fieldId=el.getAttribute("field_id");compiled.setAttribute("id",`'${fieldId}_' + ${dataPointIdExpr}`);const readonlyAttr=compiled.getAttribute("readonly");if(readonlyAttr){compiled.setAttribute("readonly",`${recordExpr}.isInEdition || (${readonlyAttr})`);}else{compiled.setAttribute("readonly",`${recordExpr}.isInEdition`);}}
const{bold,display}=extractAttributes(el,["bold","display"]);const classNames=[];if(display==="right"){classNames.push("float-end");}else if(display==="full"){classNames.push("o_text_block");}
if(bold){classNames.push("o_text_bold");}
if(classNames.length>0){const clsFormatted=isSpan?classNames.join(" "):toStringExpression(classNames.join(" "));compiled.setAttribute("class",clsFormatted);}
const attrs={};for(const attr of el.attributes){attrs[attr.name]=attr.value;}
if(el.hasAttribute("widget")){const attrsParts=Object.entries(attrs).map(([key,value])=>{if(key.startsWith("t-attf-")){key=key.slice(7);value=toInterpolatedStringExpression(value);}else if(key.startsWith("t-att-")){key=key.slice(6);value=`"" + (${value})`;}else if(key.startsWith("t-att")){throw new Error("t-att on <field> nodes is not supported");}else if(!key.startsWith("t-")){value=toStringExpression(value);}
return`'${key}':${value}`;});compiled.setAttribute("attrs",`{${attrsParts.join(",")}}`);}
for(const attr in attrs){if(attr.startsWith("t-")&&!attr.startsWith("t-att")){compiled.setAttribute(attr,attrs[attr]);}}
return compiled;}
compileTCall(el,params){const compiled=this.compileGenericNode(el,params);const tname=el.getAttribute("t-call");if(tname in this.templates){compiled.setAttribute("t-call",`{{__comp__.templates[${toStringExpression(tname)}]}}`);}
return compiled;}}
KanbanCompiler.OWL_DIRECTIVE_WHITELIST=[...ViewCompiler.OWL_DIRECTIVE_WHITELIST,"t-name","t-esc","t-out","t-set","t-value","t-if","t-else","t-elif","t-foreach","t-as","t-key","t-att.*","t-call","t-translation",];return __exports;});;

/* /web/static/src/views/kanban/kanban_controller.js */
odoo.define('@web/views/kanban/kanban_controller',['@web/core/confirmation_dialog/confirmation_dialog','@web/core/l10n/translation','@web/core/utils/hooks','@web/search/cog_menu/cog_menu','@web/core/py_js/py','@web/search/layout','@web/search/pager_hook','@web/search/search_bar/search_bar','@web/search/search_bar/search_bar_toggler','@web/session','@web/views/view_hook','@web/model/model','@web/views/standard_view_props','@web/views/view_button/multi_record_view_button','@web/views/view_button/view_button_hook','@web/model/relational_model/utils','@web/views/kanban/kanban_renderer','@web/views/kanban/progress_bar_hook','@odoo/owl'],function(require){'use strict';let __exports={};const{deleteConfirmationMessage,ConfirmationDialog}=require("@web/core/confirmation_dialog/confirmation_dialog");const{_t}=require("@web/core/l10n/translation");const{useService}=require("@web/core/utils/hooks");const{CogMenu}=require("@web/search/cog_menu/cog_menu");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{Layout}=require("@web/search/layout");const{usePager}=require("@web/search/pager_hook");const{SearchBar}=require("@web/search/search_bar/search_bar");const{useSearchBarToggler}=require("@web/search/search_bar/search_bar_toggler");const{session}=require("@web/session");const{useSetupView}=require("@web/views/view_hook");const{useModelWithSampleData}=require("@web/model/model");const{standardViewProps}=require("@web/views/standard_view_props");const{MultiRecordViewButton}=require("@web/views/view_button/multi_record_view_button");const{useViewButtons}=require("@web/views/view_button/view_button_hook");const{addFieldDependencies,extractFieldsFromArchInfo}=require("@web/model/relational_model/utils");const{KanbanRenderer}=require("@web/views/kanban/kanban_renderer");const{useProgressBar}=require("@web/views/kanban/progress_bar_hook");const{Component,reactive,useRef,useState}=require("@odoo/owl");const QUICK_CREATE_FIELD_TYPES=["char","boolean","many2one","selection","many2many"];const KanbanController=__exports.KanbanController=class KanbanController extends Component{setup(){this.actionService=useService("action");this.dialog=useService("dialog");const{Model,archInfo}=this.props;class KanbanSampleModel extends Model{setup(){super.setup(...arguments);this.initialSampleGroups=undefined;}
hasData(){if(this.root.groups){if(!this.root.groups.length){return true;}
return this.root.groups.some((group)=>group.hasData);}
return super.hasData();}
async load(){if(this.orm.isSample&&this.initialSampleGroups){this.orm.setGroups(this.initialSampleGroups);}
return super.load(...arguments);}
async _webReadGroup(){const result=await super._webReadGroup(...arguments);if(!this.initialSampleGroups){this.initialSampleGroups=JSON.parse(JSON.stringify(result.groups));}
return result;}
removeSampleDataInGroups(){if(this.useSampleModel){for(const group of this.root.groups){const list=group.list;group.count=0;list.count=0;if(list.records){list.records=[];}else{list.groups=[];}}}}}
this.model=useState(useModelWithSampleData(KanbanSampleModel,this.modelParams,this.modelOptions));if(archInfo.progressAttributes){const{activeBars}=this.props.state||{};this.progressBarState=useProgressBar(archInfo.progressAttributes,this.model,this.progressBarAggregateFields,activeBars);}
this.headerButtons=archInfo.headerButtons;const self=this;this.quickCreateState=reactive({get groupId(){return this._groupId||false;},set groupId(groupId){if(self.model.useSampleModel){self.model.removeSampleDataInGroups();self.model.useSampleModel=false;}
this._groupId=groupId;},view:archInfo.quickCreateView,});this.rootRef=useRef("root");useViewButtons(this.model,this.rootRef,{beforeExecuteAction:this.beforeExecuteActionButton.bind(this),afterExecuteAction:this.afterExecuteActionButton.bind(this),});useSetupView({rootRef:this.rootRef,getGlobalState:()=>{return{resIds:this.model.root.records.map((rec)=>rec.resId),};},getLocalState:()=>{return{activeBars:this.progressBarState?.activeBars,modelState:this.model.exportState(),};},});usePager(()=>{const root=this.model.root;const{count,hasLimitedCount,isGrouped,limit,offset}=root;if(!isGrouped){return{offset:offset,limit:limit,total:count,onUpdate:async({offset,limit})=>{await this.model.root.load({offset,limit});await this.onUpdatedPager();},updateTotal:hasLimitedCount?()=>root.fetchCount():undefined,};}});this.searchBarToggler=useSearchBarToggler();}
get modelParams(){const{resModel,archInfo,limit,defaultGroupBy}=this.props;const{activeFields,fields}=extractFieldsFromArchInfo(archInfo,this.props.fields);addFieldDependencies(activeFields,fields,this.progressBarAggregateFields);const modelConfig=this.props.state?.modelState?.config||{resModel,activeFields,fields,openGroupsByDefault:true,};return{config:modelConfig,state:this.props.state?.modelState,limit:archInfo.limit||limit||40,groupsLimit:Number.MAX_SAFE_INTEGER,countLimit:archInfo.countLimit,defaultGroupBy,defaultOrderBy:archInfo.defaultOrder,maxGroupByDepth:1,activeIdsLimit:session.active_ids_limit,hooks:{onRecordSaved:this.onRecordSaved.bind(this),},};}
get modelOptions(){return{};}
get progressBarAggregateFields(){const res=[];const{progressAttributes}=this.props.archInfo;if(progressAttributes&&progressAttributes.sumField){res.push(progressAttributes.sumField);}
return res;}
get className(){if(this.env.isSmall&&this.model.root.isGrouped){const classList=(this.props.className||"").split(" ");classList.push("o_action_delegate_scroll");return classList.join(" ");}
return this.props.className;}
async deleteRecord(record){this.dialog.add(ConfirmationDialog,{title:_t("Bye-bye, record!"),body:deleteConfirmationMessage,confirm:()=>this.model.root.deleteRecords([record]),confirmLabel:_t("Delete"),cancel:()=>{},cancelLabel:_t("No, keep it"),});}
evalViewModifier(modifier){return evaluateBooleanExpr(modifier,{context:this.props.context});}
async openRecord(record,mode){const activeIds=this.model.root.records.map((datapoint)=>datapoint.resId);this.props.selectRecord(record.resId,{activeIds,mode});}
async createRecord(){const{onCreate}=this.props.archInfo;const{root}=this.model;if(this.canQuickCreate&&onCreate==="quick_create"){const firstGroup=root.groups[0];if(firstGroup.isFolded){await firstGroup.toggle();}
this.quickCreateState.groupId=firstGroup.id;}else if(onCreate&&onCreate!=="quick_create"){const options={additionalContext:root.context,onClose:async()=>{await root.load();this.model.useSampleModel=false;this.render(true);},};await this.actionService.doAction(onCreate,options);}else{await this.props.createRecord();}}
get canCreate(){const{create,createGroup}=this.props.archInfo.activeActions;const list=this.model.root;if(!create){return false;}
if(list.isGrouped){if(list.groupByField.type!=="many2one"){return true;}
return list.groups.length||!createGroup;}
return true;}
get canQuickCreate(){const{activeActions}=this.props.archInfo;if(!activeActions.quickCreate){return false;}
const list=this.model.root;if(list.groups&&!list.groups.length){return false;}
return this.isQuickCreateField(list.groupByField);}
onRecordSaved(record){if(this.model.root.isGrouped){const group=this.model.root.groups.find((l)=>l.records.find((r)=>r.id===record.id));this.progressBarState?.updateCounts(group);}}
async beforeExecuteActionButton(clickParams){}
async afterExecuteActionButton(clickParams){}
async onUpdatedPager(){}
scrollTop(){this.rootRef.el.querySelector(".o_content").scrollTo({top:0});}
isQuickCreateField(field){return field&&QUICK_CREATE_FIELD_TYPES.includes(field.type);}}
KanbanController.template=`web.KanbanView`;KanbanController.components={Layout,KanbanRenderer,MultiRecordViewButton,SearchBar,CogMenu};KanbanController.props={...standardViewProps,defaultGroupBy:{validate:(dgb)=>!dgb||typeof dgb==="string",optional:true,},editable:{type:Boolean,optional:true},forceGlobalClick:{type:Boolean,optional:true},onSelectionChanged:{type:Function,optional:true},showButtons:{type:Boolean,optional:true},Compiler:{type:Function,optional:true},Model:Function,Renderer:Function,buttonTemplate:String,archInfo:Object,};KanbanController.defaultProps={createRecord:()=>{},forceGlobalClick:false,selectRecord:()=>{},showButtons:true,};return __exports;});;

/* /web/static/src/views/kanban/kanban_cover_image_dialog.js */
odoo.define('@web/views/kanban/kanban_cover_image_dialog',['@web/core/dialog/dialog','@web/core/file_input/file_input','@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{Dialog}=require("@web/core/dialog/dialog");const{FileInput}=require("@web/core/file_input/file_input");const{useService}=require("@web/core/utils/hooks");const{Component,useState,onWillStart}=require("@odoo/owl");let nextDialogId=1;const KanbanCoverImageDialog=__exports.KanbanCoverImageDialog=class KanbanCoverImageDialog extends Component{setup(){this.id=`o_cover_image_upload_${nextDialogId++}`;this.orm=useService("orm");this.http=useService("http");const{record,fieldName}=this.props;const attachment=(record&&record.data[fieldName])||[];this.state=useState({selectFile:false,selectedAttachmentId:attachment[0],});onWillStart(async()=>{this.attachments=await this.orm.searchRead("ir.attachment",[["res_model","=",record.resModel],["res_id","=",record.resId],["mimetype","ilike","image"],],["id"]);this.state.selectFile=this.props.autoOpen&&this.attachments.length;});}
get hasCoverImage(){return Boolean(this.props.record.data[this.props.fieldName]);}
onUpload([attachment]){if(!attachment){return;}
this.state.selectFile=false;this.selectAttachment(attachment,true);}
selectAttachment(attachment,setSelected){if(this.state.selectedAttachmentId!==attachment.id){this.state.selectedAttachmentId=attachment.id;}else{this.state.selectedAttachmentId=null;}
if(setSelected){this.setCover();}}
removeCover(){this.state.selectedAttachmentId=null;this.setCover();}
async setCover(){const id=this.state.selectedAttachmentId?[this.state.selectedAttachmentId]:false;await this.props.record.update({[this.props.fieldName]:id},{save:true});this.props.close();}
uploadImage(){this.state.selectFile=true;}}
KanbanCoverImageDialog.template="web.KanbanCoverImageDialog";KanbanCoverImageDialog.components={Dialog,FileInput};return __exports;});;

/* /web/static/src/views/kanban/kanban_dropdown_menu_wrapper.js */
odoo.define('@web/views/kanban/kanban_dropdown_menu_wrapper',['@odoo/owl','@web/core/dropdown/dropdown'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{DROPDOWN}=require("@web/core/dropdown/dropdown");const KanbanDropdownMenuWrapper=__exports.KanbanDropdownMenuWrapper=class KanbanDropdownMenuWrapper extends Component{onClick(ev){this.env[DROPDOWN].closeAllParents();}}
KanbanDropdownMenuWrapper.template="web.KanbanDropdownMenuWrapper";KanbanDropdownMenuWrapper.props={slots:Object,};return __exports;});;

/* /web/static/src/views/kanban/kanban_header.js */
odoo.define('@web/views/kanban/kanban_header',['@web/core/l10n/translation','@odoo/owl','@web/core/confirmation_dialog/confirmation_dialog','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/popover/popover_hook','@web/core/utils/functions','@web/core/utils/hooks','@web/core/utils/timing','@web/model/relational_model/utils','@web/views/utils','@web/views/view_components/column_progress','@web/views/view_dialogs/form_view_dialog','@web/core/registry','@web/core/ui/ui_service'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{Component,useRef}=require("@odoo/owl");const{ConfirmationDialog}=require("@web/core/confirmation_dialog/confirmation_dialog");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{usePopover}=require("@web/core/popover/popover_hook");const{memoize}=require("@web/core/utils/functions");const{useService}=require("@web/core/utils/hooks");const{useDebounced}=require("@web/core/utils/timing");const{isRelational}=require("@web/model/relational_model/utils");const{isNull}=require("@web/views/utils");const{ColumnProgress}=require("@web/views/view_components/column_progress");const{FormViewDialog}=require("@web/views/view_dialogs/form_view_dialog");const{registry}=require("@web/core/registry");const{utils}=require("@web/core/ui/ui_service");class KanbanHeaderTooltip extends Component{static template="web.KanbanGroupTooltip";}
const KanbanHeader=__exports.KanbanHeader=class KanbanHeader extends Component{static template="web.KanbanHeader";static components={ColumnProgress,Dropdown,DropdownItem};static props={activeActions:{type:Object},canQuickCreate:{type:Boolean},deleteGroup:{type:Function},dialogClose:{type:Array},group:{type:Object},list:{type:Object},quickCreateState:{type:Object},scrollTop:{type:Function},tooltipInfo:{type:Object},progressBarState:{type:true,optional:true},};setup(){this.dialog=useService("dialog");this.orm=useService("orm");this.rootRef=useRef("root");this.popover=usePopover(KanbanHeaderTooltip);this.onTitleMouseEnter=useDebounced(this.onTitleMouseEnter,400);}
async onTitleMouseEnter(ev){if(!this.hasTooltip){return;}
const tooltip=await this.loadTooltip();if(tooltip.length){this.popover.open(ev.target,{tooltip});}}
onTitleMouseLeave(){this.onTitleMouseEnter.cancel();this.popover.close();}
get _configDropdownContainer(){return this.rootRef.el.closest(`.o_kanban_group[data-id="${this.props.group.id}"]`);}
get configItems(){const args={permissions:this.permissions,props:this.props};return registry.category("kanban_header_config_items").getEntries().map(([key,desc])=>({key,method:desc.method,label:desc.label,isVisible:typeof desc.isVisible==="function"?desc.isVisible(args):desc.isVisible,class:typeof desc.class==="function"?desc.class(args):desc.class,}));}
get progressBar(){return this.props.progressBarState?.getGroupInfo(this.group);}
get group(){return this.props.group;}
_getEmptyGroupLabel(fieldName){return _t("None");}
get groupName(){const{groupByField,displayName}=this.group;let name=displayName;if(groupByField.type==="boolean"){name=name?_t("Yes"):_t("No");}else if(!name){if(isRelational(groupByField)||groupByField.type==="date"||groupByField.type==="datetime"||isNull(name)){name=this._getEmptyGroupLabel(groupByField.name);}}
return name;}
get groupAggregate(){const{group,progressBarState}=this.props;const{sumField}=progressBarState.progressAttributes;return progressBarState.getAggregateValue(group,sumField);}
get hasTooltip(){const{name,type}=this.group.groupByField;return type==="many2one"&&this.group.value&&name in this.props.tooltipInfo;}
loadTooltip=memoize(async()=>{const{name,relation:resModel}=this.group.groupByField;const tooltipInfo=this.props.tooltipInfo[name];const fieldNames=Object.keys(tooltipInfo);const[values]=await this.orm.silent.read(resModel,[this.group.value],["display_name",...fieldNames]);return fieldNames.filter((fieldName)=>values[fieldName]).map((fieldName)=>({title:tooltipInfo[fieldName],value:values[fieldName]}));});archiveGroup(){this.dialog.add(ConfirmationDialog,{body:_t("Are you sure that you want to archive all the records from this column?"),confirmLabel:_t("Archive All"),confirm:()=>this.group.list.archive(),cancel:()=>{},});}
unarchiveGroup(){this.group.list.unarchive();}
deleteGroup(){this.dialog.add(ConfirmationDialog,{body:_t("Are you sure you want to delete this column?"),confirm:async()=>{this.props.deleteGroup(this.group);},confirmLabel:_t("Delete"),cancel:()=>{},});}
editGroup(){const{context,displayName,groupByField,value}=this.group;this.props.dialogClose.push(this.dialog.add(FormViewDialog,{context,resId:value,resModel:groupByField.relation,title:_t("Edit: %s",displayName),onRecordSaved:async()=>{await this.props.list.load();this.props.list.model.notify();},}));}
quickCreate(group){this.props.quickCreateState.groupId=this.group.id;}
toggleGroup(){return this.group.toggle();}
get permissions(){return["canArchiveGroup","canDeleteGroup","canEditGroup","canQuickCreate"].reduce((o,key)=>{Object.defineProperty(o,key,{get:()=>this[key]()});return o;},{});}
canArchiveGroup(){const{archiveGroup}=this.props.activeActions;const hasActiveField="active"in this.group.fields;return archiveGroup&&hasActiveField&&this.group.groupByField.type!=="many2many";}
canDeleteGroup(){const{deleteGroup}=this.props.activeActions;const{groupByField,value}=this.group;return deleteGroup&&isRelational(groupByField)&&value;}
canEditGroup(){const{editGroup}=this.props.activeActions;const{groupByField,value}=this.group;return editGroup&&isRelational(groupByField)&&value;}
canQuickCreate(){return this.props.canQuickCreate;}
async onBarClicked(value){await this.props.progressBarState.selectBar(this.props.group.id,value);this.props.scrollTop();}}
const kanbanHeaderConfigItems=registry.category("kanban_header_config_items");kanbanHeaderConfigItems.add("toggle_group",{label:_t("Fold"),method:"toggleGroup",isVisible:()=>!utils.isSmall(),class:({props})=>({o_kanban_toggle_fold:true,disabled:props.list.model.useSampleModel,}),},{sequence:10});kanbanHeaderConfigItems.add("edit_group",{label:_t("Edit"),method:"editGroup",isVisible:({permissions})=>permissions.canEditGroup,class:"o_column_edit",},{sequence:20});kanbanHeaderConfigItems.add("delete_group",{label:_t("Delete"),method:"deleteGroup",isVisible:({permissions})=>permissions.canDeleteGroup,class:"o_column_delete",},{sequence:30});kanbanHeaderConfigItems.add("archive_group",{label:_t("Archive All"),method:"archiveGroup",isVisible:({permissions})=>permissions.canArchiveGroup,class:"o_column_archive_records",},{sequence:40});kanbanHeaderConfigItems.add("unarchive_group",{label:_t("Unarchive All"),method:"unarchiveGroup",isVisible:({permissions})=>permissions.canArchiveGroup,class:"o_column_unarchive_records",},{sequence:50});return __exports;});;

/* /web/static/src/views/kanban/kanban_record.js */
odoo.define('@web/views/kanban/kanban_record',['@web/core/l10n/translation','@web/core/colorlist/colorlist','@web/core/py_js/py','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/registry','@web/core/tooltip/tooltip_hook','@web/core/utils/hooks','@web/core/utils/urls','@web/model/relational_model/utils','@web/views/fields/field','@web/views/fields/image/image_field','@web/views/view_button/view_button','@web/views/view_compiler','@web/views/widgets/widget','@web/views/utils','@web/views/kanban/kanban_arch_parser','@web/views/kanban/kanban_compiler','@web/views/kanban/kanban_cover_image_dialog','@web/views/kanban/kanban_dropdown_menu_wrapper','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{ColorList}=require("@web/core/colorlist/colorlist");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{registry}=require("@web/core/registry");const{useTooltip}=require("@web/core/tooltip/tooltip_hook");const{useService}=require("@web/core/utils/hooks");const{url}=require("@web/core/utils/urls");const{useRecordObserver}=require("@web/model/relational_model/utils");const{Field}=require("@web/views/fields/field");const{fileTypeMagicWordMap,imageCacheKey}=require("@web/views/fields/image/image_field");const{ViewButton}=require("@web/views/view_button/view_button");const{useViewCompiler}=require("@web/views/view_compiler");const{Widget}=require("@web/views/widgets/widget");const{getFormattedValue}=require("@web/views/utils");const{KANBAN_BOX_ATTRIBUTE,KANBAN_MENU_ATTRIBUTE,KANBAN_TOOLTIP_ATTRIBUTE,}=require("@web/views/kanban/kanban_arch_parser");const{KanbanCompiler}=require("@web/views/kanban/kanban_compiler");const{KanbanCoverImageDialog}=require("@web/views/kanban/kanban_cover_image_dialog");const{KanbanDropdownMenuWrapper}=require("@web/views/kanban/kanban_dropdown_menu_wrapper");const{Component,onMounted,onWillUpdateProps,useRef,useState,useEffect}=require("@odoo/owl");const{COLORS}=ColorList;const formatters=registry.category("formatters");const CANCEL_GLOBAL_CLICK=__exports.CANCEL_GLOBAL_CLICK=["a",".dropdown",".oe_kanban_action","[data-bs-toggle]"].join(",");const ALLOW_GLOBAL_CLICK=[".oe_kanban_global_click",".oe_kanban_global_click_edit"].join(",");function getColorClass(value){return`oe_kanban_color_${getColorIndex(value)}`;}
function getColorIndex(value){if(typeof value==="number"){return Math.round(value)%COLORS.length;}else if(typeof value==="string"){const charCodeSum=[...value].reduce((acc,_,i)=>acc+value.charCodeAt(i),0);return charCodeSum%COLORS.length;}else{return 0;}}
function getColorName(value){return COLORS[getColorIndex(value)];}
__exports.getRawValue=getRawValue;function getRawValue(record,fieldName){const field=record.fields[fieldName];const value=record.data[fieldName];switch(field.type){case"one2many":case"many2many":{return value.count?value.currentIds:[];}
case"many2one":{return(value&&value[0])||false;}
case"date":case"datetime":{return value&&value.toISO();}
default:{return value;}}}
function getValue(record,fieldName){const field=record.fields[fieldName];const value=record.data[fieldName];const formatter=formatters.get(field.type,String);return formatter(value,{field,data:record.data});}
__exports.getFormattedRecord=getFormattedRecord;function getFormattedRecord(record){const formattedRecord={id:{value:record.resId,raw_value:record.resId,},};for(const fieldName of record.fieldNames){formattedRecord[fieldName]={value:getValue(record,fieldName),raw_value:getRawValue(record,fieldName),};}
return formattedRecord;}
__exports.getImageSrcFromRecordInfo=getImageSrcFromRecordInfo;function getImageSrcFromRecordInfo(record,model,field,idOrIds,placeholder){const id=(Array.isArray(idOrIds)?idOrIds[0]:idOrIds)||null;const isCurrentRecord=record.resModel===model&&(record.resId===id||(!record.resId&&!id));const fieldVal=record.data[field];if(isCurrentRecord&&fieldVal&&!isBinSize(fieldVal)){const type=fileTypeMagicWordMap[fieldVal[0]];return`data:image/${type};base64,${fieldVal}`;}else if(placeholder&&(!model||!field||!id||!fieldVal)){return placeholder;}else{const params={model,field,id,};if(isCurrentRecord){params.unique=imageCacheKey(record.data.write_date);}
return url("/web/image",params);}}
function isBinSize(value){return/^\d+(\.\d*)? [^0-9]+$/.test(value);}
__exports.isHtmlEmpty=isHtmlEmpty;function isHtmlEmpty(innerHTML=""){const div=Object.assign(document.createElement("div"),{innerHTML});return div.innerText.trim()==="";}
const KanbanRecord=__exports.KanbanRecord=class KanbanRecord extends Component{setup(){this.evaluateBooleanExpr=evaluateBooleanExpr;this.action=useService("action");this.dialog=useService("dialog");this.notification=useService("notification");this.user=useService("user");const{Compiler,templates}=this.props;const ViewCompiler=Compiler||this.constructor.Compiler;this.templates=useViewCompiler(ViewCompiler,templates);if(this.constructor.KANBAN_MENU_ATTRIBUTE in templates){this.showMenu=true;}
if(KANBAN_TOOLTIP_ATTRIBUTE in templates){useTooltip("root",{info:{...this,record:getFormattedRecord(this.props.record)},template:this.templates[KANBAN_TOOLTIP_ATTRIBUTE],});}
this.dataState=useState({record:{},widget:{}});this.createWidget(this.props);onWillUpdateProps(this.createWidget);useRecordObserver((record)=>Object.assign(this.dataState.record,getFormattedRecord(record)));this.rootRef=useRef("root");onMounted(()=>{this.allowGlobalClick=!!this.rootRef.el.querySelector(ALLOW_GLOBAL_CLICK);});useEffect((color)=>{if(!color){return;}
const classList=this.rootRef.el.firstElementChild.classList;const colorClasses=[...classList].filter((c)=>c.startsWith("oe_kanban_color_"));colorClasses.forEach((cls)=>classList.remove(cls));classList.add(getColorClass(color));},()=>[this.props.record.data[this.props.archInfo.colorField]]);}
get record(){return this.dataState.record;}
getFormattedValue(fieldId){const{archInfo,record}=this.props;const{attrs,name}=archInfo.fieldNodes[fieldId];return getFormattedValue(record,name,attrs);}
createWidget(props){const{archInfo,list}=props;const{activeActions}=archInfo;const deletable=activeActions.delete&&(!list.groupByField||list.groupByField.type!=="many2many");const editable=activeActions.edit;this.dataState.widget={deletable,editable,isHtmlEmpty,};}
getRecordClasses(){const{archInfo,canResequence,forceGlobalClick,record,progressBarState}=this.props;const classes=["o_kanban_record d-flex"];if(canResequence){classes.push("o_draggable");}
if(forceGlobalClick||archInfo.openAction){classes.push("oe_kanban_global_click");}
if(progressBarState){const{fieldName,colors}=progressBarState.progressAttributes;const value=record.data[fieldName];const color=colors[value];classes.push(`oe_kanban_card_${color}`);}
if(archInfo.cardColorField){const value=record.data[archInfo.cardColorField];classes.push(getColorClass(value));}
if(!this.props.list.isGrouped){classes.push("flex-grow-1 flex-md-shrink-1 flex-shrink-0");}
return classes.join(" ");}
onGlobalClick(ev){if(ev.target.closest(CANCEL_GLOBAL_CLICK)){return;}
const{archInfo,forceGlobalClick,openRecord,record}=this.props;if(!forceGlobalClick&&archInfo.openAction){this.action.doActionButton({name:archInfo.openAction.action,type:archInfo.openAction.type,resModel:record.resModel,resId:record.resId,resIds:record.resIds,context:record.context,onClose:async()=>{await record.model.root.load();},});}else if(forceGlobalClick||this.allowGlobalClick){openRecord(record);}}
async selectColor(colorIndex){const{archInfo,record}=this.props;await record.update({[archInfo.colorField]:colorIndex},{save:true});}
triggerAction(params){const{archInfo,openRecord,deleteRecord,record}=this.props;const{type}=params;switch(type){case"edit":{return openRecord(record,"edit");}
case"open":{return openRecord(record);}
case"delete":{return deleteRecord(record);}
case"set_cover":{const{autoOpen,fieldName}=params;const widgets=Object.values(archInfo.fieldNodes).filter((x)=>x.name===fieldName).map((x)=>x.widget);const field=record.fields[fieldName];if(field.type==="many2one"&&field.relation==="ir.attachment"&&widgets.includes("attachment_image")){this.dialog.add(KanbanCoverImageDialog,{autoOpen,fieldName,record});}else{const warning=_t(`Could not set the cover image: incorrect field ("%s") is provided in the view.`,fieldName);this.notification.add({title:warning,type:"danger"});}
break;}
default:{return this.notification.add(_t("Kanban: no action for type: ")+type,{type:"danger",});}}}
get renderingContext(){return{context:this.props.record.context,JSON,kanban_color:getColorClass,kanban_getcolor:getColorIndex,kanban_getcolorname:getColorName,kanban_image:(...args)=>getImageSrcFromRecordInfo(this.props.record,...args),luxon,read_only_mode:this.props.readonly,record:this.dataState.record,selection_mode:this.props.forceGlobalClick,user_context:this.user.context,widget:this.dataState.widget,__comp__:Object.assign(Object.create(this),{this:this}),};}}
KanbanRecord.components={Dropdown,DropdownItem,KanbanDropdownMenuWrapper,Field,KanbanCoverImageDialog,ViewButton,Widget,};KanbanRecord.defaultProps={colors:COLORS,deleteRecord:()=>{},openRecord:()=>{},};KanbanRecord.props=["archInfo","canResequence?","colors?","Compiler?","forceGlobalClick?","group?","list","deleteRecord?","openRecord?","readonly?","record","templates","progressBarState?",];KanbanRecord.Compiler=KanbanCompiler;KanbanRecord.KANBAN_BOX_ATTRIBUTE=KANBAN_BOX_ATTRIBUTE;KanbanRecord.KANBAN_MENU_ATTRIBUTE=KANBAN_MENU_ATTRIBUTE;KanbanRecord.menuTemplate="web.KanbanRecordMenu";KanbanRecord.template="web.KanbanRecord";return __exports;});;

/* /web/static/src/views/kanban/kanban_record_quick_create.js */
odoo.define('@web/views/kanban/kanban_record_quick_create',['@web/core/l10n/translation','@web/core/utils/xml','@web/core/hotkeys/hotkey_hook','@web/core/utils/hooks','@odoo/owl','@web/core/network/rpc_service','@web/model/relational_model/utils','@web/views/form/form_view','@web/views/view','@web/views/view_dialogs/form_view_dialog'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{parseXML}=require("@web/core/utils/xml");const{useHotkey}=require("@web/core/hotkeys/hotkey_hook");const{useOwnedDialogs,useService}=require("@web/core/utils/hooks");const{Component,onMounted,onWillStart,useExternalListener,useRef,useState,useSubEnv,}=require("@odoo/owl");const{RPCError}=require("@web/core/network/rpc_service");const{extractFieldsFromArchInfo}=require("@web/model/relational_model/utils");const{formView}=require("@web/views/form/form_view");const{getDefaultConfig}=require("@web/views/view");const{FormViewDialog}=require("@web/views/view_dialogs/form_view_dialog");const DEFAULT_QUICK_CREATE_VIEW={arch:`
        <form>
            <field name="display_name" placeholder="Title" required="True" />
        </form>`,};const DEFAULT_QUICK_CREATE_FIELDS={display_name:{string:"Display name",type:"char"},};const ACTION_SELECTORS=[".o_kanban_quick_add",".o_kanban_load_more button",".o-kanban-button-new",];class KanbanQuickCreateController extends Component{static props={Model:Function,Renderer:Function,Compiler:Function,resModel:String,onValidate:Function,onCancel:Function,fields:{type:Object},context:{type:Object},archInfo:{type:Object},};static template="web.KanbanQuickCreateController";setup(){super.setup();this.uiService=useService("ui");this.rootRef=useRef("root");this.state=useState({disabled:false});this.addDialog=useOwnedDialogs();const{activeFields,fields}=extractFieldsFromArchInfo(this.props.archInfo,this.props.fields);const modelServices=Object.fromEntries(this.props.Model.services.map((servName)=>{return[servName,useService(servName)];}));modelServices.orm=useService("orm");const config={resModel:this.props.resModel,resId:false,resIds:[],fields,activeFields,isMonoRecord:true,mode:"edit",context:this.props.context,};this.model=useState(new this.props.Model(this.env,{config},modelServices));onWillStart(()=>this.model.load());onMounted(()=>{this.uiActiveElement=this.uiService.activeElement;});useExternalListener(window,"mousedown",(ev)=>{this.mousedownTarget=ev.target;});useExternalListener(window,"click",(ev)=>{if(this.uiActiveElement!==this.uiService.activeElement){return;}
const target=this.mousedownTarget||ev.target;const gotClickedInside=target.closest(".o_datetime_picker")||target.closest(".ui-autocomplete")||this.rootRef.el.contains(target);if(!gotClickedInside){let force=false;for(const selector of ACTION_SELECTORS){const closestEl=target.closest(selector);if(closestEl){force=true;break;}}
this.cancel(force);}
this.mousedownTarget=null;},{capture:true});useHotkey("enter",()=>this.validate("add"),{bypassEditableProtection:true});useHotkey("escape",()=>this.cancel(true));}
async validate(mode){let resId=undefined;if(this.state.disabled){return;}
this.state.disabled=true;const keys=Object.keys(this.model.root.activeFields);if(keys.length===1&&keys[0]==="display_name"){const isValid=await this.model.root.checkValidity();if(isValid){try{[resId]=await this.model.orm.call(this.props.resModel,"name_create",[this.model.root.data.display_name],{context:this.props.context,});}catch(e){this.showFormDialogInError(e);}}else{this.model.notification.add(_t("Display Name"),{title:_t("Invalid fields: "),type:"danger",});}}else{await this.model.root.save({reload:false,onError:(e)=>this.showFormDialogInError(e),});resId=this.model.root.resId;}
if(resId){await this.props.onValidate(resId,mode);if(mode==="add"){await this.model.load({resId:false});}}
this.state.disabled=false;}
async cancel(force){if(this.state.disabled){return;}
if(force||!(await this.model.root.isDirty())){this.props.onCancel();}}
showFormDialogInError(e){if(!(e instanceof RPCError)){throw e;}
const context=this.props.context;const values=this.model.root.data;context.default_name=values.name||values.display_name;this.addDialog(FormViewDialog,{resModel:this.props.resModel,context,title:_t("Create"),onRecordSaved:async(record)=>{await this.props.onValidate(record.resId,"add");await this.model.load();},});}
get className(){return"o_kanban_quick_create o_field_highlight shadow";}}
const KanbanRecordQuickCreate=__exports.KanbanRecordQuickCreate=class KanbanRecordQuickCreate extends Component{static components={KanbanQuickCreateController};static template="web.KanbanRecordQuickCreate";static props={quickCreateView:{type:[String,{value:null}],optional:1},onValidate:Function,onCancel:Function,group:Object,};setup(){this.state=useState({isLoaded:false,});this.viewService=useService("view");onWillStart(()=>{this.getQuickCreateProps(this.props).then(()=>{this.state.isLoaded=true;});});useSubEnv({config:getDefaultConfig(),});}
async getQuickCreateProps(props){let quickCreateFields=DEFAULT_QUICK_CREATE_FIELDS;let quickCreateForm=DEFAULT_QUICK_CREATE_VIEW;let quickCreateRelatedModels={};if(props.quickCreateView){const{fields,relatedModels,views}=await this.viewService.loadViews({context:{...props.context,form_view_ref:props.quickCreateView},resModel:props.group.resModel,views:[[false,"form"]],});quickCreateFields=fields;quickCreateForm=views.form;quickCreateRelatedModels=relatedModels;}
const models={...quickCreateRelatedModels,[props.group.resModel]:quickCreateFields,};const archInfo=new formView.ArchParser().parse(parseXML(quickCreateForm.arch),models,props.group.resModel);this.quickCreateProps={Model:formView.Model,Renderer:formView.Renderer,Compiler:formView.Compiler,resModel:props.group.resModel,onValidate:props.onValidate,onCancel:props.onCancel,fields:quickCreateFields,context:props.group.context,archInfo,};}}
return __exports;});;

/* /web/static/src/views/kanban/kanban_renderer.js */
odoo.define('@web/views/kanban/kanban_renderer',['@web/core/l10n/translation','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/hotkeys/hotkey_hook','@web/core/registry','@web/core/utils/hooks','@web/core/utils/sortable_owl','@web/views/utils','@web/views/view_components/column_progress','@web/views/view_hook','@web/views/kanban/kanban_column_quick_create','@web/views/kanban/kanban_header','@web/views/kanban/kanban_record','@web/views/kanban/kanban_record_quick_create','@odoo/owl','@web/core/py_js/py'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{useHotkey}=require("@web/core/hotkeys/hotkey_hook");const{registry}=require("@web/core/registry");const{useBus,useService}=require("@web/core/utils/hooks");const{useSortable}=require("@web/core/utils/sortable_owl");const{isNull}=require("@web/views/utils");const{ColumnProgress}=require("@web/views/view_components/column_progress");const{useBounceButton}=require("@web/views/view_hook");const{KanbanColumnQuickCreate}=require("@web/views/kanban/kanban_column_quick_create");const{KanbanHeader}=require("@web/views/kanban/kanban_header");const{KanbanRecord}=require("@web/views/kanban/kanban_record");const{KanbanRecordQuickCreate}=require("@web/views/kanban/kanban_record_quick_create");const{Component,onPatched,onWillDestroy,onWillPatch,useRef,useState}=require("@odoo/owl");const{evaluateExpr}=require("@web/core/py_js/py");const DRAGGABLE_GROUP_TYPES=["many2one"];const MOVABLE_RECORD_TYPES=["char","boolean","integer","selection","many2one"];function validateColumnQuickCreateExamples(data){const{allowedGroupBys=[],examples=[],foldField=""}=data;if(!allowedGroupBys.length){throw new Error("The example data must contain an array of allowed groupbys");}
if(!examples.length){throw new Error("The example data must contain an array of examples");}
const someHasFoldedColumns=examples.some(({foldedColumns=[]})=>foldedColumns.length);if(!foldField&&someHasFoldedColumns){throw new Error("The example data must contain a fold field if there are folded columns");}}
const KanbanRenderer=__exports.KanbanRenderer=class KanbanRenderer extends Component{static template="web.KanbanRenderer";static components={Dropdown,DropdownItem,ColumnProgress,KanbanColumnQuickCreate,KanbanHeader,KanbanRecord,KanbanRecordQuickCreate,};static props=["archInfo","Compiler?","list","deleteRecord","openRecord","readonly","evalViewModifier","forceGlobalClick?","noContentHelp?","scrollTop?","canQuickCreate?","quickCreateState?","progressBarState?",];static defaultProps={scrollTop:()=>{},quickCreateState:{groupId:false},tooltipInfo:{},};setup(){this.dialogClose=[];this.state=useState({processedIds:[],columnQuickCreateIsFolded:!this.props.list.isGrouped||this.props.list.groups.length>0,});this.dialog=useService("dialog");this.exampleData=registry.category("kanban_examples").get(this.props.archInfo.examples,null);if(this.exampleData){validateColumnQuickCreateExamples(this.exampleData);}
this.ghostColumns=this.generateGhostColumns();let dataRecordId;let dataGroupId;this.rootRef=useRef("root");if(this.canUseSortable){useSortable({enable:()=>this.canResequenceRecords,ref:this.rootRef,elements:".o_draggable",ignore:".dropdown,select",groups:()=>this.props.list.isGrouped&&".o_kanban_group",connectGroups:()=>this.canMoveRecords,cursor:"move",onDragStart:(params)=>{const{element,group}=params;dataRecordId=element.dataset.id;dataGroupId=group&&group.dataset.id;return this.sortStart(params);},onDragEnd:(params)=>this.sortStop(params),onGroupEnter:(params)=>this.sortRecordGroupEnter(params),onGroupLeave:(params)=>this.sortRecordGroupLeave(params),onDrop:(params)=>this.sortRecordDrop(dataRecordId,dataGroupId,params),});useSortable({enable:()=>this.canResequenceGroups,ref:this.rootRef,elements:".o_group_draggable",handle:".o_column_title",cursor:"move",onDragStart:(params)=>{const{element}=params;dataGroupId=element.dataset.id;return this.sortStart(params);},onDragEnd:(params)=>this.sortStop(params),onDrop:(params)=>this.sortGroupDrop(dataGroupId,params),});}
useBounceButton(this.rootRef,(clickedEl)=>{if(!this.props.list.count||this.props.list.model.useSampleModel){return clickedEl.matches([".o_kanban_renderer",".o_kanban_group",".o_kanban_header",".o_column_quick_create",".o_view_nocontent_smiling_face",].join(", "));}
return false;});onWillDestroy(()=>{this.dialogClose.forEach((close)=>close());});if(this.env.searchModel){useBus(this.env.searchModel,"focus-view",()=>{const{model}=this.props.list;if(model.useSampleModel||!model.hasData()){return;}
const firstCard=this.rootRef.el.querySelector(".o_kanban_record");if(firstCard){firstCard.focus();}});}
useHotkey("Enter",({target})=>{if(!target.classList.contains("o_kanban_record")){return;}
const firstLink=target.querySelector(".oe_kanban_global_click, a, button");if(firstLink&&firstLink instanceof HTMLElement){firstLink.click();}
return;},{area:()=>this.rootRef.el});const arrowsOptions={area:()=>this.rootRef.el,allowRepeat:true};if(this.env.searchModel){useHotkey("ArrowUp",({area})=>{if(!this.focusNextCard(area,"up")){this.env.searchModel.trigger("focus-search");}},arrowsOptions);}
useHotkey("ArrowDown",({area})=>this.focusNextCard(area,"down"),arrowsOptions);useHotkey("ArrowLeft",({area})=>this.focusNextCard(area,"left"),arrowsOptions);useHotkey("ArrowRight",({area})=>this.focusNextCard(area,"right"),arrowsOptions);let previousScrollTop=0;onWillPatch(()=>{previousScrollTop=this.rootRef.el.scrollTop;});onPatched(()=>{this.rootRef.el.scrollTop=previousScrollTop;});}
get canUseSortable(){return!this.env.isSmall;}
get canMoveRecords(){if(!this.canResequenceRecords){return false;}
const groupByField=this.props.list.groupByField;if(!groupByField){return true;}
const fieldNodes=Object.values(this.props.archInfo.fieldNodes).filter((fieldNode)=>fieldNode.name===groupByField.name);let isReadonly=this.props.list.fields[groupByField.name].readonly;if(!isReadonly&&fieldNodes.length){isReadonly=fieldNodes.every((fieldNode)=>{if(!fieldNode.readonly){return false;}
try{return evaluateExpr(fieldNode.readonly,this.props.list.evalContext);}catch{return false;}});}
return!isReadonly&&this.isMovableField(groupByField);}
get canResequenceGroups(){if(!this.props.list.isGrouped){return false;}
const{type}=this.props.list.groupByField;const{groupsDraggable}=this.props.archInfo;return groupsDraggable&&DRAGGABLE_GROUP_TYPES.includes(type);}
get canResequenceRecords(){const{isGrouped,orderBy}=this.props.list;const{handleField,recordsDraggable}=this.props.archInfo;return Boolean(recordsDraggable&&(isGrouped||(handleField&&(!orderBy[0]||orderBy[0].name===handleField))));}
get showNoContentHelper(){const{model,isGrouped,groupByField,groups}=this.props.list;if(model.useSampleModel){return true;}
if(isGrouped){if(this.props.quickCreateState.groupId){return false;}
if(this.canCreateGroup()&&!this.state.columnQuickCreateIsFolded){return false;}
if(groups.length===0){return groupByField.type!=="many2one";}}
return!model.hasData();}
getGroupsOrRecords(){const{list}=this.props;if(list.isGrouped){return[...list.groups].sort((a,b)=>(a.value&&!b.value?1:!a.value&&b.value?-1:0)).map((group,i)=>({group,key:isNull(group.value)?`group_key_${i}`:String(group.value),}));}else{return list.records.map((record)=>({record,key:record.id}));}}
getGroupClasses(group,isGroupProcessing){const classes=[];if(!isGroupProcessing&&this.canResequenceGroups&&group.value){classes.push("o_group_draggable");}
if(!group.count){classes.push("o_kanban_no_records");}
if(!this.env.isSmall&&group.isFolded){classes.push("o_column_folded","flex-basis-0");}
if(this.props.progressBarState&&!group.isFolded){const progressBarInfo=this.props.progressBarState.getGroupInfo(group);if(progressBarInfo.activeBar){const progressBar=progressBarInfo.bars.find((b)=>b.value===progressBarInfo.activeBar);classes.push("o_kanban_group_show",`o_kanban_group_show_${progressBar.color}`);}}
return classes.join(" ");}
getGroupUnloadedCount(group){const records=group.list.records.filter((r)=>!r.isInQuickCreation);const count=this.props.progressBarState?.getGroupCount(group)||group.count;return count-records.length;}
generateGhostColumns(){let colNames;if(this.exampleData&&this.exampleData.ghostColumns){colNames=this.exampleData.ghostColumns;}else{colNames=[1,2,3,4].map((num)=>_t("Column %s",num));}
return colNames.map((colName)=>({name:colName,cards:new Array(Math.floor(Math.random()*4)+2),}));}
isProcessing(id){return this.state.processedIds.includes(id);}
isMovableField(field){return MOVABLE_RECORD_TYPES.includes(field.type);}
canCreateGroup(){const{activeActions}=this.props.archInfo;return activeActions.createGroup&&this.props.list.groupByField.type==="many2one";}
canQuickCreate(){return this.props.canQuickCreate;}
async validateQuickCreate(recordId,mode,group){this.props.quickCreateState.groupId=false;if(mode==="add"){this.props.quickCreateState.groupId=group.id;}
const record=await group.addExistingRecord(recordId,true);group.model.bus.trigger("group-updated",{group:group,withProgressBars:true,});if(mode==="edit"){await this.props.openRecord(record,"edit");}else{this.props.progressBarState?.updateCounts(group);}}
cancelQuickCreate(){this.props.quickCreateState.groupId=false;}
async deleteGroup(group){await this.props.list.deleteGroups([group]);if(this.props.list.groups.length===0){this.state.columnQuickCreateIsFolded=false;}}
toggleGroup(group){return group.toggle();}
loadMore(group){return group.list.load({limit:group.list.records.length+group.model.initialLimit});}
toggleProcessing(id,isProcessing){if(isProcessing){this.state.processedIds=[...this.state.processedIds,id];}else{this.state.processedIds=this.state.processedIds.filter((processedId)=>processedId!==id);}}
async onGroupClick(group,ev){if(!this.env.isSmall&&group.isFolded){await group.toggle();this.props.scrollTop();}}
async sortGroupDrop(dataGroupId,{previous}){this.toggleProcessing(dataGroupId,true);const refId=previous?previous.dataset.id:null;try{await this.props.list.resequence(dataGroupId,refId);}finally{this.toggleProcessing(dataGroupId,false);}}
async sortRecordDrop(dataRecordId,dataGroupId,{element,parent,previous}){if(!this.props.list.isGrouped||parent.classList.contains("o_kanban_hover")||parent.dataset.id===element.parentElement.dataset.id){this.toggleProcessing(dataRecordId,true);parent?.classList.remove("o_kanban_hover");while(previous&&!previous.dataset.id){previous=previous.previousElementSibling;}
const refId=previous?previous.dataset.id:null;const targetGroupId=parent?.dataset.id;try{await this.props.list.moveRecord(dataRecordId,dataGroupId,refId,targetGroupId);}finally{this.toggleProcessing(dataRecordId,false);}
if(dataGroupId!==targetGroupId){const group=this.props.list.groups.find((g)=>g.id===dataGroupId);this.props.progressBarState?.updateAggreagteGroup(group);}}}
sortRecordGroupEnter({group}){group.classList.add("o_kanban_hover");}
sortRecordGroupLeave({group}){group.classList.remove("o_kanban_hover");}
sortStart({element}){element.classList.add("shadow");}
sortStop({element,group}){element.classList.remove("shadow");if(group){group.classList.remove("o_kanban_hover");}}
focusNextCard(area,direction){const{isGrouped}=this.props.list;const closestCard=document.activeElement.closest(".o_kanban_record");if(!closestCard){return;}
const groups=isGrouped?[...area.querySelectorAll(".o_kanban_group")]:[area];const cards=[...groups].map((group)=>[...group.querySelectorAll(".o_kanban_record")]).filter((group)=>group.length);let iGroup;let iCard;for(iGroup=0;iGroup<cards.length;iGroup++){const i=cards[iGroup].indexOf(closestCard);if(i!==-1){iCard=i;break;}}
let nextCard;switch(direction){case"down":nextCard=iCard<cards[iGroup].length-1&&cards[iGroup][iCard+1];break;case"up":nextCard=iCard>0&&cards[iGroup][iCard-1];break;case"right":if(isGrouped){nextCard=iGroup<cards.length-1&&cards[iGroup+1][0];}else{nextCard=iCard<cards[0].length-1&&cards[0][iCard+1];}
break;case"left":if(isGrouped){nextCard=iGroup>0&&cards[iGroup-1][0];}else{nextCard=iCard>0&&cards[0][iCard-1];}
break;}
if(nextCard&&nextCard instanceof HTMLElement){nextCard.focus();return true;}}}
return __exports;});;

/* /web/static/src/views/kanban/kanban_view.js */
odoo.define('@web/views/kanban/kanban_view',['@web/core/registry','@web/model/relational_model/relational_model','@web/views/kanban/kanban_arch_parser','@web/views/kanban/kanban_compiler','@web/views/kanban/kanban_controller','@web/views/kanban/kanban_renderer'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{RelationalModel}=require("@web/model/relational_model/relational_model");const{KanbanArchParser}=require("@web/views/kanban/kanban_arch_parser");const{KanbanCompiler}=require("@web/views/kanban/kanban_compiler");const{KanbanController}=require("@web/views/kanban/kanban_controller");const{KanbanRenderer}=require("@web/views/kanban/kanban_renderer");const kanbanView=__exports.kanbanView={type:"kanban",display_name:"Kanban",icon:"oi oi-view-kanban",multiRecord:true,ArchParser:KanbanArchParser,Controller:KanbanController,Model:RelationalModel,Renderer:KanbanRenderer,Compiler:KanbanCompiler,buttonTemplate:"web.KanbanView.Buttons",props:(genericProps,view)=>{const{arch,relatedModels,resModel}=genericProps;const{ArchParser}=view;const archInfo=new ArchParser().parse(arch,relatedModels,resModel);const defaultGroupBy=genericProps.searchMenuTypes.includes("groupBy")&&archInfo.defaultGroupBy;return{...genericProps,Model:view.Model,Renderer:view.Renderer,buttonTemplate:view.buttonTemplate,archInfo,defaultGroupBy,};},};registry.category("views").add("kanban",kanbanView);return __exports;});;

/* /web/static/src/views/kanban/progress_bar_hook.js */
odoo.define('@web/views/kanban/progress_bar_hook',['@odoo/owl','@web/core/domain','@web/core/l10n/translation','@web/model/relational_model/utils'],function(require){'use strict';let __exports={};const{reactive}=require("@odoo/owl");const{Domain}=require("@web/core/domain");const{_t}=require("@web/core/l10n/translation");const{extractInfoFromGroupData}=require("@web/model/relational_model/utils");const FALSE=Symbol("False");function _findGroup(groups,groupByField,value){return groups.find((g)=>g[groupByField.name]===value)||{};}
function _createFilterDomain(fieldName,bars,value){let filterDomain=undefined;if(value===FALSE){const keys=bars.filter((x)=>x.value!==FALSE).map((x)=>x.value);filterDomain=["!",[fieldName,"in",keys]];}else{filterDomain=[[fieldName,"=",value]];}
return filterDomain;}
function _groupsToAggregateValues(groups,groupBy,fields){const groupByFieldName=groupBy[0].split(":")[0];return groups.map((g)=>{const groupInfo=extractInfoFromGroupData(g,groupBy,fields);return Object.assign(groupInfo.aggregates,{[groupByFieldName]:groupInfo.serverValue});});}
class ProgressBarState{constructor(progressAttributes,model,aggregateFields,activeBars={}){this.progressAttributes=progressAttributes;this.model=model;this._groupsInfo={};this._aggregateFields=aggregateFields;this.activeBars=activeBars;this._aggregateValues=[];this._pbCounts=null;}
getGroupInfo(group){if(!this._groupsInfo[group.id]){const aggValues=_findGroup(this._aggregateValues,group.groupByField,group.serverValue);const index=this._aggregateValues.indexOf(aggValues);if(index>-1){this._aggregateValues.splice(index,1);}
this._aggregateValues.push({...group.aggregates,[group.groupByField.name]:group.serverValue,});let groupValue=group.displayName||group.value;if(groupValue===true){groupValue="True";}else if(groupValue===false){groupValue="False";}
const pbCount=this._pbCounts[groupValue];const{fieldName,colors}=this.progressAttributes;const{selection:fieldSelection}=this.model.root.fields[fieldName];const selection=fieldSelection&&Object.fromEntries(fieldSelection);const bars=Object.entries(colors).map(([value,color])=>{let string;if(selection){string=selection[value];}else{string=String(value);}
return{count:(pbCount&&pbCount[value])||0,value,string,color,};});bars.push({count:group.count-bars.map((r)=>r.count).reduce((a,b)=>a+b,0),value:FALSE,string:_t("Other"),color:"200",});if(this.activeBars[group.serverValue]){this.activeBars[group.serverValue].count=bars.find((x)=>x.value===this.activeBars[group.serverValue].value).count;if(this.activeBars[group.serverValue].count===0){group.applyFilter(undefined).then(()=>{delete this.activeBars[group.serverValue];group.model.notify();});}
if(this._aggregateFields.length){this.activeBars[group.serverValue].aggregates=_findGroup(this._aggregateValues,group.groupByField,group.serverValue);}}
const self=this;const progressBar={get activeBar(){return self.activeBars[group.serverValue]?.value||null;},bars,};this._groupsInfo[group.id]=progressBar;}
return this._groupsInfo[group.id];}
getAggregateValue(group,aggregateField){const title=aggregateField?aggregateField.string:_t("Count");let value=0;if(!this.activeBars[group.serverValue]){value=group.count;if(aggregateField){value=_findGroup(this._aggregateValues,group.groupByField,group.serverValue)[aggregateField.name]||0;}}else{value=this.activeBars[group.serverValue].count;if(aggregateField){value=(this.activeBars[group.serverValue]?.aggregates&&this.activeBars[group.serverValue]?.aggregates[aggregateField.name])||0;}}
return{title,value};}
async selectBar(groupId,bar){const group=this.model.root.groups.find((group)=>group.id===groupId);const progressBar=this.getGroupInfo(group);const nextActiveBar={};if(bar.value&&this.activeBars[group.serverValue]?.value!==bar.value){nextActiveBar.value=bar.value;}else{group.applyFilter(undefined).then(()=>{delete this.activeBars[group.serverValue];group.model.notify();});return;}
const{bars}=progressBar;const filterDomain=_createFilterDomain(this.progressAttributes.fieldName,bars,nextActiveBar.value);const proms=[];proms.push(group.applyFilter(filterDomain).then((res)=>{const groupInfo=this.getGroupInfo(group);nextActiveBar.count=groupInfo.bars.find((x)=>x.value===nextActiveBar.value).count;}));if(this._aggregateFields.length){proms.push(this._updateAggregateGroup(group,bars,nextActiveBar));}
await Promise.all(proms);this.activeBars[group.serverValue]=nextActiveBar;}
_updateAggregateGroup(group,bars,activeBar){const filterDomain=_createFilterDomain(this.progressAttributes.fieldName,bars,activeBar.value);const{context,fields,groupBy,resModel}=this.model.root;const kwargs={context};const fieldNames=[...this._aggregateFields.map((f)=>f.name),group.groupByField.name];const domain=filterDomain?Domain.and([group.groupDomain,filterDomain]).toList():group.groupDomain;return this.model.orm.webReadGroup(resModel,domain,fieldNames,groupBy,kwargs).then((res)=>{if(res.length){const groupByField=group.groupByField;const aggrValues=_groupsToAggregateValues(res.groups,groupBy,fields);activeBar.aggregates=_findGroup(aggrValues,groupByField,group.serverValue);}});}
updateCounts(group){this._updateProgressBar();if(this._aggregateFields.length){this._updateAggregates();this.updateAggreagteGroup(group);}
for(const group of this.model.root.groups){if(this.activeBars[group.serverValue]&&group.list.count===0){this.selectBar(group.id,{value:null});}}}
updateAggreagteGroup(group){if(group&&this.activeBars[group.serverValue]){const{bars}=this.getGroupInfo(group);this._updateAggregateGroup(group,bars,this.activeBars[group.serverValue]);}}
async _updateAggregates(){const{context,fields,groupBy,domain,resModel}=this.model.root;const fieldsName=this._aggregateFields.map((f)=>f.name);const firstGroupByName=groupBy[0].split(":")[0];const kwargs={context};const res=await this.model.orm.webReadGroup(resModel,domain,[...fieldsName,firstGroupByName],groupBy,kwargs);this._aggregateValues=_groupsToAggregateValues(res.groups,groupBy,fields);}
async _updateProgressBar(){const groupBy=this.model.root.groupBy;const defaultGroupBy=this.model.root.defaultGroupBy;if(groupBy.length||defaultGroupBy){const resModel=this.model.root.resModel;const domain=this.model.root.domain;const context=this.model.root.context;const{colors,fieldName:field,help}=this.progressAttributes;const groupsId=this.model.root.groups.map((g)=>g.id).join();const res=await this.model.orm.call(resModel,"read_progress_bar",[],{domain,group_by:groupBy.length?groupBy[0]:defaultGroupBy,progress_bar:{colors,field,help},context,});if(groupsId!==this.model.root.groups.map((g)=>g.id).join()){return;}
this._pbCounts=res;for(const group of this.model.root.groups){if(!group.isFolded){const groupInfo=this.getGroupInfo(group);let groupValue=group.displayName||group.value;if(groupValue===true){groupValue="True";}else if(groupValue===false){groupValue="False";}
const counts=res[groupValue];for(const bar of groupInfo.bars){bar.count=(counts&&counts[bar.value])||0;}
groupInfo.bars.find((b)=>b.value===FALSE).count=counts?group.count-Object.values(counts).reduce((a,b)=>a+b,0):group.count;if(this.activeBars[group.serverValue]){this.activeBars[group.serverValue].count=groupInfo.bars.find((x)=>x.value===this.activeBars[group.serverValue].value).count;}}}}}
async loadProgressBar({context,domain,groupBy,resModel}){if(groupBy.length){const{colors,fieldName:field,help}=this.progressAttributes;const res=await this.model.orm.call(resModel,"read_progress_bar",[],{domain,group_by:groupBy[0],progress_bar:{colors,field,help},context,});this._pbCounts=res;}}
getGroupCount(group){const progressBarInfo=this.getGroupInfo(group);if(progressBarInfo.activeBar){const progressBar=progressBarInfo.bars.find((b)=>b.value===progressBarInfo.activeBar);return progressBar.count;}}}
__exports.useProgressBar=useProgressBar;function useProgressBar(progressAttributes,model,aggregateFields,activeBars){const progressBarState=reactive(new ProgressBarState(progressAttributes,model,aggregateFields,activeBars));let prom;const onWillLoadRoot=model.hooks.onWillLoadRoot;model.hooks.onWillLoadRoot=(config)=>{onWillLoadRoot();prom=progressBarState.loadProgressBar({context:config.context,domain:config.domain,groupBy:config.groupBy,resModel:config.resModel,});};const onRootLoaded=model.hooks.onRootLoaded;model.hooks.onRootLoaded=async()=>{await onRootLoaded();return prom;};return progressBarState;}
return __exports;});;

/* /web/static/src/views/list/export_all/export_all.js */
odoo.define('@web/views/list/export_all/export_all',['@web/core/dropdown/dropdown_item','@web/core/registry','@web/views/utils','@web/search/action_menus/action_menus','@odoo/owl'],function(require){'use strict';let __exports={};const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{registry}=require("@web/core/registry");const{archParseBoolean}=require("@web/views/utils");const{STATIC_ACTIONS_GROUP_NUMBER}=require("@web/search/action_menus/action_menus");const{Component}=require("@odoo/owl");const cogMenuRegistry=registry.category("cogMenu");const ExportAll=__exports.ExportAll=class ExportAll extends Component{static template="web.ExportAll";static components={DropdownItem};async onDirectExportData(){this.env.searchModel.trigger('direct-export-data');}}
const exportAllItem=__exports.exportAllItem={Component:ExportAll,groupNumber:STATIC_ACTIONS_GROUP_NUMBER,isDisplayed:async(env)=>env.config.viewType==="list"&&!env.model.root.selection.length&&await env.model.user.hasGroup("base.group_allow_export")&&archParseBoolean(env.config.viewArch.getAttribute("export_xlsx"),true),};cogMenuRegistry.add("export-all-menu",exportAllItem,{sequence:10});return __exports;});;

/* /web/static/src/views/list/list_arch_parser.js */
odoo.define('@web/views/list/list_arch_parser',['@web/views/fields/field','@web/core/utils/xml','@web/search/utils/order_by','@web/views/utils','@web/views/view_compiler','@web/model/relational_model/utils','@web/views/widgets/widget'],function(require){'use strict';let __exports={};const{Field}=require("@web/views/fields/field");const{visitXML}=require("@web/core/utils/xml");const{stringToOrderBy}=require("@web/search/utils/order_by");const{archParseBoolean,getActiveActions,getDecoration,processButton}=require("@web/views/utils");const{encodeObjectForTemplate}=require("@web/views/view_compiler");const{combineModifiers}=require("@web/model/relational_model/utils");const{Widget}=require("@web/views/widgets/widget");const GroupListArchParser=__exports.GroupListArchParser=class GroupListArchParser{parse(arch,models,modelName,jsClass){const fieldNodes={};const fieldNextIds={};const buttons=[];let buttonId=0;visitXML(arch,(node)=>{if(node.tagName==="button"){buttons.push({...processButton(node),id:buttonId++,});return false;}else if(node.tagName==="field"){const fieldInfo=Field.parseFieldNode(node,models,modelName,"list",jsClass);if(!(fieldInfo.name in fieldNextIds)){fieldNextIds[fieldInfo.name]=0;}
const fieldId=`${fieldInfo.name}_${fieldNextIds[fieldInfo.name]++}`;fieldNodes[fieldId]=fieldInfo;node.setAttribute("field_id",fieldId);return false;}});return{fieldNodes,buttons};}}
const ListArchParser=__exports.ListArchParser=class ListArchParser{parseFieldNode(node,models,modelName){return Field.parseFieldNode(node,models,modelName,"list");}
parseWidgetNode(node,models,modelName){return Widget.parseWidgetNode(node);}
processButton(node){return processButton(node);}
parse(xmlDoc,models,modelName){const fieldNodes={};const widgetNodes={};let widgetNextId=0;const columns=[];const fields=models[modelName];let buttonId=0;const groupBy={buttons:{},fields:{},};let headerButtons=[];const creates=[];const groupListArchParser=new GroupListArchParser();let buttonGroup;let handleField=null;const treeAttr={};let nextId=0;const fieldNextIds={};visitXML(xmlDoc,(node)=>{if(node.tagName!=="button"){buttonGroup=undefined;}
if(node.tagName==="button"){const button={...this.processButton(node),defaultRank:"btn-link",type:"button",id:buttonId++,};if(buttonGroup){buttonGroup.buttons.push(button);buttonGroup.column_invisible=combineModifiers(buttonGroup.column_invisible,node.getAttribute("column_invisible"),"AND");}else{buttonGroup={id:`column_${nextId++}`,type:"button_group",buttons:[button],hasLabel:false,column_invisible:node.getAttribute("column_invisible"),};columns.push(buttonGroup);}}else if(node.tagName==="field"){const fieldInfo=this.parseFieldNode(node,models,modelName);if(!(fieldInfo.name in fieldNextIds)){fieldNextIds[fieldInfo.name]=0;}
const fieldId=`${fieldInfo.name}_${fieldNextIds[fieldInfo.name]++}`;fieldNodes[fieldId]=fieldInfo;node.setAttribute("field_id",fieldId);if(fieldInfo.isHandle){handleField=fieldInfo.name;}
const label=fieldInfo.field.label;columns.push({...fieldInfo,id:`column_${nextId++}`,className:node.getAttribute("class"),optional:node.getAttribute("optional")||false,type:"field",hasLabel:!(archParseBoolean(fieldInfo.attrs.nolabel)||fieldInfo.field.noLabel),label:(fieldInfo.widget&&label&&label.toString())||fieldInfo.string,});return false;}else if(node.tagName==="widget"){const widgetInfo=this.parseWidgetNode(node);const widgetId=`widget_${++widgetNextId}`;widgetNodes[widgetId]=widgetInfo;node.setAttribute("widget_id",widgetId);const widgetProps={name:widgetInfo.name,node:encodeObjectForTemplate({attrs:widgetInfo.attrs}).slice(1,-1),className:node.getAttribute("class")||"",};columns.push({...widgetInfo,props:widgetProps,id:`column_${nextId++}`,type:"widget",});}else if(node.tagName==="groupby"&&node.getAttribute("name")){const fieldName=node.getAttribute("name");const coModelName=fields[fieldName].relation;const groupByArchInfo=groupListArchParser.parse(node,models,coModelName);groupBy.buttons[fieldName]=groupByArchInfo.buttons;groupBy.fields[fieldName]={fieldNodes:groupByArchInfo.fieldNodes,fields:models[coModelName],};return false;}else if(node.tagName==="header"){headerButtons=[...node.children].map((node)=>({...this.processButton(node),type:"button",id:buttonId++,}));return false;}else if(node.tagName==="control"){for(const childNode of node.children){if(childNode.tagName==="button"){creates.push({type:"button",...processButton(childNode),});}else if(childNode.tagName==="create"){creates.push({type:"create",context:childNode.getAttribute("context"),string:childNode.getAttribute("string"),});}}
return false;}else if(["tree","list"].includes(node.tagName)){const activeActions={...getActiveActions(xmlDoc),exportXlsx:archParseBoolean(xmlDoc.getAttribute("export_xlsx"),true),};treeAttr.activeActions=activeActions;treeAttr.className=xmlDoc.getAttribute("class")||null;let editableAttr=xmlDoc.getAttribute("editable");if(editableAttr&&!["top","bottom"].includes(editableAttr)){editableAttr=archParseBoolean(editableAttr)?"bottom":null;}
treeAttr.editable=editableAttr;treeAttr.multiEdit=activeActions.edit?archParseBoolean(node.getAttribute("multi_edit")||""):false;treeAttr.openFormView=treeAttr.editable?archParseBoolean(xmlDoc.getAttribute("open_form_view")||""):false;const limitAttr=node.getAttribute("limit");treeAttr.limit=limitAttr&&parseInt(limitAttr,10);const countLimitAttr=node.getAttribute("count_limit");treeAttr.countLimit=countLimitAttr&&parseInt(countLimitAttr,10);const groupsLimitAttr=node.getAttribute("groups_limit");treeAttr.groupsLimit=groupsLimitAttr&&parseInt(groupsLimitAttr,10);treeAttr.noOpen=archParseBoolean(node.getAttribute("no_open")||"");treeAttr.rawExpand=xmlDoc.getAttribute("expand");treeAttr.decorations=getDecoration(xmlDoc);treeAttr.defaultGroupBy=xmlDoc.getAttribute("default_group_by");treeAttr.defaultOrder=stringToOrderBy(xmlDoc.getAttribute("default_order")||null);const action=xmlDoc.getAttribute("action");const type=xmlDoc.getAttribute("type");treeAttr.openAction=action&&type?{action,type}:null;}});if(!treeAttr.defaultOrder.length&&handleField){const handleFieldSort=`${handleField}, id`;treeAttr.defaultOrder=stringToOrderBy(handleFieldSort);}
return{creates,headerButtons,fieldNodes,widgetNodes,columns,groupBy,xmlDoc,...treeAttr,};}}
return __exports;});;

/* /web/static/src/views/list/list_confirmation_dialog.js */
odoo.define('@web/views/list/list_confirmation_dialog',['@web/core/dialog/dialog','@web/core/l10n/translation','@web/views/fields/field','@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{Dialog}=require("@web/core/dialog/dialog");const{_t}=require("@web/core/l10n/translation");const{Field}=require("@web/views/fields/field");const{useAutofocus}=require("@web/core/utils/hooks");const{Component}=require("@odoo/owl");const ListConfirmationDialog=__exports.ListConfirmationDialog=class ListConfirmationDialog extends Component{setup(){useAutofocus();}
_cancel(){if(this.props.cancel){this.props.cancel();}
this.props.close();}
async _confirm(){if(this.props.confirm){await this.props.confirm();}
this.props.close();}}
ListConfirmationDialog.template="web.ListView.ConfirmationModal";ListConfirmationDialog.components={Dialog,Field};ListConfirmationDialog.props={close:Function,title:{validate:(m)=>{return(typeof m==="string"||(typeof m==="object"&&typeof m.toString==="function"));},optional:true,},confirm:{type:Function,optional:true},cancel:{type:Function,optional:true},isDomainSelected:Boolean,fields:Object,nbRecords:Number,nbValidRecords:Number,record:Object,};ListConfirmationDialog.defaultProps={title:_t("Confirmation"),};return __exports;});;

/* /web/static/src/views/list/list_controller.js */
odoo.define('@web/views/list/list_controller',['@web/core/l10n/translation','@web/core/confirmation_dialog/confirmation_dialog','@web/core/network/download','@web/core/py_js/py','@web/core/utils/arrays','@web/core/utils/hooks','@web/core/utils/objects','@web/search/action_menus/action_menus','@web/search/layout','@web/search/pager_hook','@web/model/model','@web/model/relational_model/dynamic_record_list','@web/model/relational_model/utils','@web/views/standard_view_props','@web/views/view_button/multi_record_view_button','@web/views/view_button/view_button','@web/views/view_button/view_button_hook','@web/views/view_dialogs/export_data_dialog','@web/views/view_hook','@web/views/list/list_confirmation_dialog','@web/search/search_bar/search_bar','@web/search/search_bar/search_bar_toggler','@web/search/cog_menu/cog_menu','@web/session','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{deleteConfirmationMessage,ConfirmationDialog,}=require("@web/core/confirmation_dialog/confirmation_dialog");const{download}=require("@web/core/network/download");const{evaluateExpr,evaluateBooleanExpr}=require("@web/core/py_js/py");const{unique}=require("@web/core/utils/arrays");const{useService,useBus}=require("@web/core/utils/hooks");const{omit}=require("@web/core/utils/objects");const{ActionMenus,STATIC_ACTIONS_GROUP_NUMBER}=require("@web/search/action_menus/action_menus");const{Layout}=require("@web/search/layout");const{usePager}=require("@web/search/pager_hook");const{useModelWithSampleData}=require("@web/model/model");const{DynamicRecordList}=require("@web/model/relational_model/dynamic_record_list");const{extractFieldsFromArchInfo}=require("@web/model/relational_model/utils");const{standardViewProps}=require("@web/views/standard_view_props");const{MultiRecordViewButton}=require("@web/views/view_button/multi_record_view_button");const{ViewButton}=require("@web/views/view_button/view_button");const{executeButtonCallback,useViewButtons}=require("@web/views/view_button/view_button_hook");const{ExportDataDialog}=require("@web/views/view_dialogs/export_data_dialog");const{useSetupView}=require("@web/views/view_hook");const{ListConfirmationDialog}=require("@web/views/list/list_confirmation_dialog");const{SearchBar}=require("@web/search/search_bar/search_bar");const{useSearchBarToggler}=require("@web/search/search_bar/search_bar_toggler");const{CogMenu}=require("@web/search/cog_menu/cog_menu");const{session}=require("@web/session");const{Component,onMounted,onWillPatch,onWillStart,useEffect,useRef,useState,useSubEnv,}=require("@odoo/owl");const ListController=__exports.ListController=class ListController extends Component{setup(){this.actionService=useService("action");this.dialogService=useService("dialog");this.userService=useService("user");this.rpc=useService("rpc");this.rootRef=useRef("root");this.archInfo=this.props.archInfo;const openFormView=this.props.editable?this.archInfo.openFormView:false;this.onOpenFormView=openFormView?this.openRecord.bind(this):undefined;this.activeActions=this.archInfo.activeActions;this.editable=this.activeActions.edit&&this.props.editable?this.archInfo.editable:false;this.model=useState(useModelWithSampleData(this.props.Model,this.modelParams));this.hasMousedownDiscard=false;this.nextActionAfterMouseup=null;this.optionalActiveFields=[];onWillStart(async()=>{this.isExportEnable=await this.userService.hasGroup("base.group_allow_export");});onMounted(()=>{const{rendererScrollPositions}=this.props.state||{};if(rendererScrollPositions){const renderer=this.rootRef.el.querySelector(".o_list_renderer");renderer.scrollLeft=rendererScrollPositions.left;renderer.scrollTop=rendererScrollPositions.top;}});this.archiveEnabled="active"in this.props.fields?!this.props.fields.active.readonly:"x_active"in this.props.fields?!this.props.fields.x_active.readonly:false;useSubEnv({model:this.model});useViewButtons(this.model,this.rootRef,{beforeExecuteAction:this.beforeExecuteActionButton.bind(this),afterExecuteAction:this.afterExecuteActionButton.bind(this),});useSetupView({rootRef:this.rootRef,beforeLeave:async()=>{return this.model.root.leaveEditMode();},beforeUnload:async(ev)=>{const editedRecord=this.model.root.editedRecord;if(editedRecord){const isValid=await editedRecord.urgentSave();if(!isValid){ev.preventDefault();ev.returnValue="Unsaved changes";}}},getLocalState:()=>{const renderer=this.rootRef.el.querySelector(".o_list_renderer");return{modelState:this.model.exportState(),rendererScrollPositions:{left:renderer.scrollLeft,top:renderer.scrollTop,},};},getOrderBy:()=>{return this.model.root.orderBy;},});usePager(()=>{const{count,hasLimitedCount,isGrouped,limit,offset}=this.model.root;return{offset:offset,limit:limit,total:count,onUpdate:async({offset,limit},hasNavigated)=>{if(this.model.root.editedRecord){if(!(await this.model.root.editedRecord.save())){return;}}
await this.model.root.load({limit,offset});if(hasNavigated){this.onPageChangeScroll();}},updateTotal:!isGrouped&&hasLimitedCount?()=>this.model.root.fetchCount():undefined,};});useEffect(()=>{if(this.props.onSelectionChanged){const resIds=this.model.root.selection.map((record)=>record.resId);this.props.onSelectionChanged(resIds);}},()=>[this.model.root.selection.length]);this.searchBarToggler=useSearchBarToggler();this.firstLoad=true;onWillPatch(()=>{this.firstLoad=false;});useBus(this.env.searchModel,"direct-export-data",this.onDirectExportData.bind(this));}
get modelParams(){const{defaultGroupBy,rawExpand}=this.archInfo;const{activeFields,fields}=extractFieldsFromArchInfo(this.archInfo,this.props.fields);const groupByInfo={};for(const fieldName in this.archInfo.groupBy.fields){const fieldNodes=this.archInfo.groupBy.fields[fieldName].fieldNodes;const fields=this.archInfo.groupBy.fields[fieldName].fields;groupByInfo[fieldName]=extractFieldsFromArchInfo({fieldNodes},fields);}
const modelConfig=this.props.state?.modelState?.config||{resModel:this.props.resModel,fields,activeFields,openGroupsByDefault:rawExpand?evaluateExpr(rawExpand,this.props.context):false,};return{config:modelConfig,state:this.props.state?.modelState,groupByInfo,limit:this.archInfo.limit||this.props.limit,countLimit:this.archInfo.countLimit,defaultOrderBy:this.archInfo.defaultOrder,defaultGroupBy:this.props.searchMenuTypes.includes("groupBy")?defaultGroupBy:false,groupsLimit:this.archInfo.groupsLimit,multiEdit:this.archInfo.multiEdit,activeIdsLimit:session.active_ids_limit,hooks:{onRecordSaved:this.onRecordSaved.bind(this),onWillSaveRecord:this.onWillSaveRecord.bind(this),onWillSaveMulti:this.onWillSaveMulti.bind(this),onSavedMulti:this.onSavedMulti.bind(this),onWillSetInvalidField:this.onWillSetInvalidField.bind(this),},};}
async onRecordSaved(record){}
async onWillSaveRecord(record){}
async createRecord({group}={}){const list=(group&&group.list)||this.model.root;if(this.editable&&!list.isGrouped){if(!(list instanceof DynamicRecordList)){throw new Error("List should be a DynamicRecordList");}
await list.leaveEditMode();if(!list.editedRecord){await(group||list).addNewRecord(this.editable==="top");}
this.render();}else{await this.props.createRecord();}}
async openRecord(record){await record.save();if(this.archInfo.openAction){this.actionService.doActionButton({name:this.archInfo.openAction.action,type:this.archInfo.openAction.type,resModel:record.resModel,resId:record.resId,resIds:record.resIds,context:record.context,onClose:async()=>{await record.model.root.load();},});}else{const activeIds=this.model.root.records.map((datapoint)=>datapoint.resId);this.props.selectRecord(record.resId,{activeIds});}}
async onClickCreate(){return executeButtonCallback(this.rootRef.el,()=>this.createRecord());}
async onClickDiscard(){return executeButtonCallback(this.rootRef.el,()=>this.model.root.leaveEditMode({discard:true}));}
async onClickSave(){return executeButtonCallback(this.rootRef.el,async()=>{const saved=await this.model.root.editedRecord.save();if(saved){await this.model.root.leaveEditMode();}});}
onMouseDownDiscard(mouseDownEvent){this.hasMousedownDiscard=true;document.addEventListener("mouseup",(mouseUpEvent)=>{this.hasMousedownDiscard=false;if(mouseUpEvent.target!==mouseDownEvent.target){if(this.nextActionAfterMouseup){this.nextActionAfterMouseup();}}
this.nextActionAfterMouseup=null;},{capture:true,once:true});}
onPageChangeScroll(){if(this.rootRef&&this.rootRef.el){this.rootRef.el.querySelector(".o_content").scrollTop=0;}}
getSelectedResIds(){return this.model.root.getResIds(true);}
getStaticActionMenuItems(){const list=this.model.root;const isM2MGrouped=list.groupBy.some((groupBy)=>{const fieldName=groupBy.split(":")[0];return list.fields[fieldName].type==="many2many";});return{export:{isAvailable:()=>this.isExportEnable,sequence:10,icon:"fa fa-upload",description:_t("Export"),callback:()=>this.onExportData(),},archive:{isAvailable:()=>this.archiveEnabled&&!isM2MGrouped,sequence:20,icon:"oi oi-archive",description:_t("Archive"),callback:()=>{this.dialogService.add(ConfirmationDialog,this.archiveDialogProps);},},unarchive:{isAvailable:()=>this.archiveEnabled&&!isM2MGrouped,sequence:30,icon:"oi oi-unarchive",description:_t("Unarchive"),callback:()=>this.toggleArchiveState(false),},duplicate:{isAvailable:()=>this.activeActions.duplicate&&!isM2MGrouped,sequence:35,icon:"fa fa-clone",description:_t("Duplicate"),callback:()=>this.duplicateRecords(),},delete:{isAvailable:()=>this.activeActions.delete&&!isM2MGrouped,sequence:40,icon:"fa fa-trash-o",description:_t("Delete"),callback:()=>this.onDeleteSelectedRecords(),},};}
get archiveDialogProps(){return{body:_t("Are you sure that you want to archive all the selected records?"),confirmLabel:_t("Archive"),confirm:()=>{this.toggleArchiveState(true);},cancel:()=>{},};}
get actionMenuItems(){const{actionMenus}=this.props.info;const staticActionItems=Object.entries(this.getStaticActionMenuItems()).filter(([key,item])=>item.isAvailable===undefined||item.isAvailable()).sort(([k1,item1],[k2,item2])=>(item1.sequence||0)-(item2.sequence||0)).map(([key,item])=>Object.assign({key,groupNumber:STATIC_ACTIONS_GROUP_NUMBER},omit(item,"isAvailable")));return{action:[...staticActionItems,...(actionMenus.action||[])],print:actionMenus.print,};}
async onSelectDomain(){await this.model.root.selectDomain(true);if(this.props.onSelectionChanged){const resIds=await this.model.root.getResIds(true);this.props.onSelectionChanged(resIds);}}
onUnselectAll(){this.model.root.selection.forEach((record)=>{record.toggleSelection(false);});this.model.root.selectDomain(false);}
evalViewModifier(modifier){return evaluateBooleanExpr(modifier,this.model.root.evalContext);}
get className(){return this.props.className;}
get nbSelected(){return this.model.root.selection.length;}
get isPageSelected(){const root=this.model.root;return root.selection.length===root.records.length;}
get isDomainSelected(){return this.model.root.isDomainSelected;}
get nbTotal(){const list=this.model.root;return list.isGrouped?list.recordCount:list.count;}
onOptionalFieldsChanged(optionalActiveFields){this.optionalActiveFields=optionalActiveFields;}
get defaultExportList(){return unique(this.props.archInfo.columns.filter((col)=>col.type==="field").filter((col)=>!col.optional||this.optionalActiveFields[col.name]).map((col)=>this.props.fields[col.name]).filter((field)=>field.exportable!==false));}
get display(){const{controlPanel}=this.props.display;if(!controlPanel){return this.props.display;}
return{...this.props.display,controlPanel:{...controlPanel,layoutActions:!this.nbSelected,},};}
async downloadExport(fields,import_compat,format){let ids=false;if(!this.isDomainSelected){const resIds=await this.getSelectedResIds();ids=resIds.length>0&&resIds;}
const exportedFields=fields.map((field)=>({name:field.name||field.id,label:field.label||field.string,store:field.store,type:field.field_type||field.type,}));if(import_compat){exportedFields.unshift({name:"id",label:_t("External ID"),});}
await download({data:{data:JSON.stringify({import_compat,context:this.props.context,domain:this.model.root.domain,fields:exportedFields,groupby:this.model.root.groupBy,ids,model:this.model.root.resModel,}),},url:`/web/export/${format}`,});}
async getExportedFields(model,import_compat,parentParams){return await this.rpc("/web/export/get_fields",{...parentParams,model,import_compat,});}
async onExportData(){const dialogProps={context:this.props.context,defaultExportList:this.defaultExportList,download:this.downloadExport.bind(this),getExportedFields:this.getExportedFields.bind(this),root:this.model.root,};this.dialogService.add(ExportDataDialog,dialogProps);}
async onDirectExportData(){await this.downloadExport(this.defaultExportList,false,"xlsx");}
async toggleArchiveState(archive){if(archive){return this.model.root.archive(true);}
return this.model.root.unarchive(true);}
async duplicateRecords(){return this.model.root.duplicateRecords();}
get deleteConfirmationDialogProps(){const root=this.model.root;let body=deleteConfirmationMessage;if(root.isDomainSelected||root.selection.length>1){body=_t("Are you sure you want to delete these records?");}
return{title:_t("Bye-bye, record!"),body,confirmLabel:_t("Delete"),confirm:()=>this.model.root.deleteRecords(),cancel:()=>{},cancelLabel:_t("No, keep it"),};}
async onDeleteSelectedRecords(){this.dialogService.add(ConfirmationDialog,this.deleteConfirmationDialogProps);}
discardSelection(){this.model.root.records.forEach((record)=>{record.toggleSelection(false);});}
async beforeExecuteActionButton(clickParams){if(clickParams.special!=="cancel"&&this.model.root.editedRecord){return this.model.root.editedRecord.save();}}
async afterExecuteActionButton(clickParams){}
onWillSaveMulti(editedRecord,changes,validSelectedRecords){if(this.hasMousedownDiscard){this.nextActionAfterMouseup=()=>this.model.root.multiSave(editedRecord);return false;}
if(validSelectedRecords.length>1){const{isDomainSelected,selection}=this.model.root;return new Promise((resolve)=>{const dialogProps={confirm:()=>resolve(true),cancel:()=>{if(this.model.root.editedRecord){this.model.root.leaveEditMode({discard:true});}else{editedRecord.discard();}
resolve(false);},isDomainSelected,fields:Object.keys(changes).map((fieldName)=>{const fieldNode=Object.values(this.archInfo.fieldNodes).find((fieldNode)=>fieldNode.name===fieldName);const label=fieldNode&&fieldNode.string;return{name:fieldName,label:label||editedRecord.fields[fieldName].string,fieldNode,widget:fieldNode&&fieldNode.widget,};}),nbRecords:selection.length,nbValidRecords:validSelectedRecords.length,record:editedRecord,};const focusedCellBeforeDialog=document.activeElement.closest(".o_data_cell");this.dialogService.add(ListConfirmationDialog,dialogProps,{onClose:()=>{if(focusedCellBeforeDialog){focusedCellBeforeDialog.focus();}
this.model.root.leaveEditMode({discard:true});resolve(false);},});});}
return true;}
onWillSetInvalidField(record,fieldName){if(this.hasMousedownDiscard){this.nextActionAfterMouseup=()=>record.setInvalidField(fieldName);return false;}
return true;}
onSavedMulti(records){records.forEach((record)=>{record.selected=false;});}}
ListController.template=`web.ListView`;ListController.components={ActionMenus,Layout,ViewButton,MultiRecordViewButton,SearchBar,CogMenu,};ListController.props={...standardViewProps,allowSelectors:{type:Boolean,optional:true},editable:{type:Boolean,optional:true},onSelectionChanged:{type:Function,optional:true},showButtons:{type:Boolean,optional:true},Model:Function,Renderer:Function,buttonTemplate:String,archInfo:Object,};ListController.defaultProps={allowSelectors:true,createRecord:()=>{},editable:true,selectRecord:()=>{},showButtons:true,};return __exports;});;

/* /web/static/src/views/list/list_renderer.js */
odoo.define('@web/views/list/list_renderer',['@web/core/browser/browser','@web/core/checkbox/checkbox','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/hotkeys/hotkey_service','@web/core/pager/pager','@web/core/py_js/py','@web/core/registry','@web/core/utils/hooks','@web/core/utils/sortable_owl','@web/core/utils/ui','@web/views/fields/field','@web/views/fields/field_tooltip','@web/views/utils','@web/model/relational_model/utils','@web/views/view_button/view_button','@web/views/view_hook','@web/views/widgets/widget','@web/core/l10n/localization','@web/core/utils/functions','@odoo/owl','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{CheckBox}=require("@web/core/checkbox/checkbox");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{getActiveHotkey}=require("@web/core/hotkeys/hotkey_service");const{Pager}=require("@web/core/pager/pager");const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{registry}=require("@web/core/registry");const{useBus,useService}=require("@web/core/utils/hooks");const{useSortable}=require("@web/core/utils/sortable_owl");const{getTabableElements}=require("@web/core/utils/ui");const{Field,getPropertyFieldInfo}=require("@web/views/fields/field");const{getTooltipInfo}=require("@web/views/fields/field_tooltip");const{getClassNameFromDecoration}=require("@web/views/utils");const{combineModifiers}=require("@web/model/relational_model/utils");const{ViewButton}=require("@web/views/view_button/view_button");const{useBounceButton}=require("@web/views/view_hook");const{Widget}=require("@web/views/widgets/widget");const{getFormattedValue}=require("@web/views/utils");const{localization}=require("@web/core/l10n/localization");const{uniqueId}=require("@web/core/utils/functions");const{Component,onMounted,onPatched,onWillPatch,onWillUpdateProps,useEffect,useExternalListener,useRef,useState,}=require("@odoo/owl");const{_t}=require("@web/core/l10n/translation");const formatters=registry.category("formatters");const DEFAULT_GROUP_PAGER_COLSPAN=1;const FIELD_CLASSES={char:"o_list_char",float:"o_list_number",integer:"o_list_number",monetary:"o_list_number",text:"o_list_text",many2one:"o_list_many2one",};const FIXED_FIELD_COLUMN_WIDTHS={boolean:"70px",date:"92px",datetime:"146px",float:"92px",integer:"74px",monetary:"104px",handle:"33px",};function containsActiveElement(parent){const{activeElement}=document;return parent!==activeElement&&parent.contains(activeElement);}
function getElementToFocus(cell,index){return getTabableElements(cell).at(index)||cell;}
class OptionalFieldsDropdown extends Dropdown{static template="web.ListRenderer.OptionalFieldsDropdown";static props={...Dropdown.props,listRendererClass:String,};onWindowClicked(ev){if(ev.target.closest(".o_optional_columns_dropdown.o-dropdown--menu")){return;}
super.onWindowClicked(...arguments);}}
const ListRenderer=__exports.ListRenderer=class ListRenderer extends Component{setup(){this.uiService=useService("ui");this.allColumns=this.processAllColumn(this.props.archInfo.columns,this.props.list);this.notificationService=useService("notification");this.keyOptionalFields=this.createKeyOptionalFields();this.getOptionalActiveFields();this.cellClassByColumn={};this.groupByButtons=this.props.archInfo.groupBy.buttons;this.state=useState({columns:this.getActiveColumns(this.props.list),});this.withHandleColumn=this.state.columns.some((col)=>col.widget==="handle");useExternalListener(document,"click",this.onGlobalClick.bind(this));this.tableRef=useRef("table");this.longTouchTimer=null;this.touchStartMs=0;this.resizing=false;this.preventReorder=false;this.creates=this.props.archInfo.creates.length?this.props.archInfo.creates:[{type:"create",string:_t("Add a line")}];this.cellToFocus=null;this.activeRowId=null;onMounted(async()=>{await Promise.resolve();this.activeElement=this.uiService.activeElement;});onWillPatch(()=>{const activeRow=document.activeElement.closest(".o_data_row.o_selected_row");this.activeRowId=activeRow?activeRow.dataset.id:null;});onWillUpdateProps((nextProps)=>{this.allColumns=this.processAllColumn(nextProps.archInfo.columns,nextProps.list);this.state.columns=this.getActiveColumns(nextProps.list);});let dataRowId;this.rootRef=useRef("root");this.resequencePromise=Promise.resolve();useSortable({enable:()=>this.canResequenceRows,ref:this.rootRef,elements:".o_row_draggable",handle:".o_handle_cell",cursor:"grabbing",onDragStart:(params)=>{const{element}=params;dataRowId=element.dataset.id;return this.sortStart(params);},onDragEnd:(params)=>this.sortStop(params),onDrop:(params)=>this.sortDrop(dataRowId,params),});if(this.env.searchModel){useBus(this.env.searchModel,"focus-view",()=>{if(this.props.list.model.useSampleModel){return;}
const nextTh=this.tableRef.el.querySelector("thead th");const toFocus=getElementToFocus(nextTh);this.focus(toFocus);this.tableRef.el.querySelector("tbody").classList.add("o_keyboard_navigation");});}
useBus(this.props.list.model.bus,"FIELD_IS_DIRTY",(ev)=>(this.lastIsDirty=ev.detail));useBounceButton(this.rootRef,()=>{return this.showNoContentHelper;});useEffect((editedRecord)=>{if(editedRecord){this.keepColumnWidths=true;}},()=>[this.props.list.editedRecord]);useEffect(()=>{this.freezeColumnWidths();},()=>[this.state.columns,this.isEmpty,this.props.list.offset,this.props.list.limit]);useExternalListener(window,"resize",()=>{this.columnWidths=null;this.freezeColumnWidths();});useExternalListener(window,"keydown",(ev)=>{this.shiftKeyMode=ev.shiftKey;});useExternalListener(window,"keyup",(ev)=>{this.shiftKeyMode=ev.shiftKey;const hotkey=getActiveHotkey(ev);if(hotkey==="shift"){this.shiftKeyedRecord=undefined;}});useExternalListener(window,"blur",(ev)=>{this.shiftKeyMode=false;});onPatched(async()=>{await Promise.resolve();if(this.activeElement!==this.uiService.activeElement){return;}
const editedRecord=this.props.list.editedRecord;if(editedRecord&&this.activeRowId!==editedRecord.id){if(this.cellToFocus&&this.cellToFocus.record===editedRecord){const column=this.cellToFocus.column;const forward=this.cellToFocus.forward;this.focusCell(column,forward);}else if(this.lastEditedCell){this.focusCell(this.lastEditedCell.column,true);}else{this.focusCell(this.state.columns[0]);}}
this.cellToFocus=null;this.lastEditedCell=null;});this.isRTL=localization.direction==="rtl";this.uniqueRendererClass=uniqueId("o_list_renderer_");}
displaySaveNotification(){this.notificationService.add(_t('Please click on the "save" button first'),{type:"danger",});}
getActiveColumns(list){return this.allColumns.filter((col)=>{if(list.isGrouped&&col.widget==="handle"){return false;}
if(col.optional&&!this.optionalActiveFields[col.name]){return false;}
if(this.evalColumnInvisible(col.column_invisible)){return false;}
return true;});}
get hasSelectors(){return this.props.allowSelectors&&!this.env.isSmall;}
add(params){if(this.canCreate){this.props.onAdd(params);}}
processAllColumn(allColumns,list){return allColumns.flatMap((column)=>{if(column.type==="field"&&list.fields[column.name].type==="properties"){return this.getPropertyFieldColumns(column,list);}else{return[column];}});}
getPropertyFieldColumns(column,list){return Object.values(list.fields).filter((field)=>field.relatedPropertyField&&field.relatedPropertyField.fieldName===column.name&&field.type!=='separator').map((propertyField)=>{return{...getPropertyFieldInfo(propertyField),id:`${column.id}_${propertyField.name}`,column_invisible:combineModifiers(propertyField.column_invisible,column.column_invisible,"OR"),classNames:column.classNames,optional:"hide",type:"field",hasLabel:true,label:propertyField.string,sortable:false,attrs:["integer","float"].includes(propertyField.type)?{sum:propertyField.string}:{},};});}
getFieldProps(record,column){return{readonly:this.isCellReadonly(column,record)||this.isRecordReadonly(record),};}
freezeColumnWidths(){if(!this.keepColumnWidths){this.columnWidths=null;}
const table=this.tableRef.el;const headers=[...table.querySelectorAll("thead th:not(.o_list_actions_header)")];if(!this.columnWidths||!this.columnWidths.length){table.style.tableLayout="auto";headers.forEach((th)=>{th.style.width=null;th.style.maxWidth=null;});this.setDefaultColumnWidths();this.columnWidths=this.computeColumnWidthsFromContent();table.style.tableLayout="fixed";}
headers.forEach((th,index)=>{if(!th.style.width){th.style.width=`${Math.floor(this.columnWidths[index])}px`;}});}
setDefaultColumnWidths(){const widths=this.state.columns.map((col)=>this.calculateColumnWidth(col));const sumOfRelativeWidths=widths.filter(({type})=>type==="relative").reduce((sum,{value})=>sum+value,0);const columnOffset=this.hasSelectors?2:1;widths.forEach(({type,value},i)=>{const headerEl=this.tableRef.el.querySelector(`th:nth-child(${i + columnOffset})`);if(type==="absolute"){if(this.isEmpty){headerEl.style.width=value;}else{headerEl.style.minWidth=value;}}else if(type==="relative"&&this.isEmpty){headerEl.style.width=`${((value / sumOfRelativeWidths) * 100).toFixed(2)}%`;}});}
computeColumnWidthsFromContent(){const table=this.tableRef.el;table.classList.add("o_list_computing_widths");const headers=[...table.querySelectorAll("thead th")];const columnWidths=headers.map((th)=>th.getBoundingClientRect().width);const getWidth=(th)=>columnWidths[headers.indexOf(th)]||0;const getTotalWidth=()=>columnWidths.reduce((tot,width)=>tot+width,0);const shrinkColumns=(thsToShrink,shrinkAmount)=>{let canKeepShrinking=true;for(const th of thsToShrink){const index=headers.indexOf(th);let maxWidth=columnWidths[index]-shrinkAmount;if(maxWidth<92){maxWidth=92;canKeepShrinking=false;}
th.style.maxWidth=`${Math.floor(maxWidth)}px`;columnWidths[index]=maxWidth;}
return canKeepShrinking;};const sortedThs=[...table.querySelectorAll("thead th:not(.o_list_button)")].sort((a,b)=>getWidth(b)-getWidth(a));const allowedWidth=table.parentNode.getBoundingClientRect().width;let totalWidth=getTotalWidth();for(let index=1;totalWidth>allowedWidth;index++){const largestCols=sortedThs.slice(0,index);const currentWidth=getWidth(largestCols[0]);for(;currentWidth===getWidth(sortedThs[index]);index++){largestCols.push(sortedThs[index]);}
const nextLargest=sortedThs[index];const toRemove=Math.ceil((totalWidth-allowedWidth)/largestCols.length);const shrinkAmount=Math.min(toRemove,currentWidth-getWidth(nextLargest));const canKeepShrinking=shrinkColumns(largestCols,shrinkAmount);if(!canKeepShrinking){break;}
totalWidth=getTotalWidth();}
table.classList.remove("o_list_computing_widths");return columnWidths;}
get activeActions(){return this.props.activeActions||{};}
get canResequenceRows(){if(!this.props.list.canResequence()){return false;}
const{handleField,orderBy}=this.props.list;return!orderBy.length||(orderBy.length&&orderBy[0].name===handleField);}
get isEmpty(){return!this.props.list.records.length;}
get fields(){return this.props.list.fields;}
get nbCols(){let nbCols=this.state.columns.length;if(this.hasSelectors){nbCols++;}
if(this.activeActions.onDelete||this.displayOptionalFields){nbCols++;}
if(this.props.onOpenFormView){nbCols++;}
return nbCols;}
canUseFormatter(column,record){if(column.widget){return false;}
if(record.isInEdition&&(record.model.multiEdit||this.isInlineEditable(record))){return false;}
return true;}
isRecordReadonly(record){if(record.isNew){return false;}
if(this.props.activeActions?.edit===false){return true;}
if(record.isInEdition&&!this.isInlineEditable(record)&&!record.model.multiEdit){return true;}
return false;}
focusCell(column,forward=true){const index=column?this.state.columns.findIndex((col)=>col.id===column.id&&col.name===column.name):-1;let columns;if(index===-1&&!forward){columns=this.state.columns.slice(0).reverse();}else{columns=[...this.state.columns.slice(index,this.state.columns.length),...this.state.columns.slice(0,index),];}
const editedRecord=this.props.list.editedRecord;for(const column of columns){if(column.type!=="field"){continue;}
if(!this.isCellReadonly(column,editedRecord)){const cell=this.tableRef.el.querySelector(`.o_selected_row td[name='${column.name}']`);if(cell){const toFocus=getElementToFocus(cell);if(cell!==toFocus){this.focus(toFocus);this.lastEditedCell={column,record:editedRecord};break;}}}}}
focus(el){if(!el){return;}
el.focus();if(["text","search","url","tel","password","textarea"].includes(el.type)&&el.selectionStart===el.selectionEnd){el.selectionStart=0;el.selectionEnd=el.value.length;}}
editGroupRecord(group){const{resId,resModel}=group.record;this.env.services.action.doAction({context:{create:false,},res_model:resModel,res_id:resId,type:"ir.actions.act_window",views:[[false,"form"]],flags:{mode:"edit"},});}
createKeyOptionalFields(){let keyParts={fields:this.props.list.fieldNames,model:this.props.list.resModel,viewMode:"list",viewId:this.env.config.viewId,};if(this.props.nestedKeyOptionalFieldsData){keyParts=Object.assign(keyParts,{model:this.props.nestedKeyOptionalFieldsData.model,viewMode:this.props.nestedKeyOptionalFieldsData.viewMode,relationalField:this.props.nestedKeyOptionalFieldsData.field,subViewType:"list",});}
const parts=["model","viewMode","viewId","relationalField","subViewType"];const viewIdentifier=["optional_fields"];parts.forEach((partName)=>{if(partName in keyParts){viewIdentifier.push(keyParts[partName]);}});keyParts.fields.sort((left,right)=>(left<right?-1:1)).forEach((fieldName)=>{return viewIdentifier.push(fieldName);});return viewIdentifier.join(",");}
get optionalFieldGroups(){const propertyGroups={};const optionalFields=[];const optionalColumns=this.allColumns.filter((col)=>col.optional&&!this.evalColumnInvisible(col.column_invisible));for(const col of optionalColumns){const optionalField={label:col.label,name:col.name,value:this.optionalActiveFields[col.name],};if(!col.relatedPropertyField){optionalFields.push(optionalField);}else{const{displayName,id}=col.relatedPropertyField;if(propertyGroups[id]){propertyGroups[id].optionalFields.push(optionalField);}else{propertyGroups[id]={id,displayName,optionalFields:[optionalField]};}}}
if(optionalFields.length){return[{optionalFields},...Object.values(propertyGroups)];}
return Object.values(propertyGroups);}
get hasOptionalFields(){return this.allColumns.some((col)=>col.optional&&!this.evalColumnInvisible(col.column_invisible));}
get displayOptionalFields(){return this.hasOptionalFields;}
nbRecordsInGroup(group){if(group.isFolded){return 0;}else if(group.list.isGrouped){let count=0;for(const gr of group.list.groups){count+=this.nbRecordsInGroup(gr);}
return count;}else{return group.list.records.length;}}
get selectAll(){const list=this.props.list;const nbDisplayedRecords=list.records.length;if(list.isDomainSelected){return true;}else{return nbDisplayedRecords>0&&list.selection.length===nbDisplayedRecords;}}
get aggregates(){let values;if(this.props.list.selection&&this.props.list.selection.length){values=this.props.list.selection.map((r)=>r.data);}else if(this.props.list.isGrouped){values=this.props.list.groups.map((g)=>g.aggregates);}else{values=this.props.list.records.map((r)=>r.data);}
const aggregates={};for(const column of this.allColumns){if(column.type!=="field"){continue;}
const fieldName=column.name;if(fieldName in this.optionalActiveFields&&!this.optionalActiveFields[fieldName]){continue;}
const field=this.fields[fieldName];const fieldValues=values.map((v)=>v[fieldName]).filter((v)=>v||v===0);if(!fieldValues.length){continue;}
const type=field.type;if(type!=="integer"&&type!=="float"&&type!=="monetary"){continue;}
const{attrs,widget}=column;let currencyId;if(type==="monetary"||widget==="monetary"){const currencyField=column.options.currency_field||this.fields[fieldName].currency_field||"currency_id";if(!(currencyField in this.props.list.activeFields)){aggregates[fieldName]={help:_t("No currency provided"),value:"",};continue;}
currencyId=values[0][currencyField]&&values[0][currencyField][0];if(currencyId){const sameCurrency=values.every((value)=>currencyId===value[currencyField][0]);if(!sameCurrency){aggregates[fieldName]={help:_t("Different currencies cannot be aggregated"),value:"",};continue;}}}
const func=(attrs.sum&&"sum")||(attrs.avg&&"avg")||(attrs.max&&"max")||(attrs.min&&"min");if(func){let aggregateValue=0;if(func==="max"){aggregateValue=Math.max(-Infinity,...fieldValues);}else if(func==="min"){aggregateValue=Math.min(Infinity,...fieldValues);}else if(func==="avg"){aggregateValue=fieldValues.reduce((acc,val)=>acc+val)/fieldValues.length;}else if(func==="sum"){aggregateValue=fieldValues.reduce((acc,val)=>acc+val);}
const formatter=formatters.get(widget,false)||formatters.get(type,false);const formatOptions={digits:attrs.digits?JSON.parse(attrs.digits):undefined,escape:true,};if(currencyId){formatOptions.currencyId=currencyId;}
aggregates[fieldName]={help:attrs[func],value:formatter?formatter(aggregateValue,formatOptions):aggregateValue,};}}
return aggregates;}
formatAggregateValue(group,column){const{widget,attrs}=column;const field=this.props.list.fields[column.name];const aggregateValue=group.aggregates[column.name];if(!(column.name in group.aggregates)){return"";}
const formatter=formatters.get(widget,false)||formatters.get(field.type,false);const formatOptions={digits:attrs.digits?JSON.parse(attrs.digits):field.digits,escape:true,};return formatter?formatter(aggregateValue,formatOptions):aggregateValue;}
getGroupLevel(group){return this.props.list.groupBy.length-group.list.groupBy.length-1;}
getColumnClass(column){const classNames=["align-middle"];if(this.isSortable(column)){classNames.push("o_column_sortable","position-relative","cursor-pointer");}else{classNames.push("cursor-default");}
const orderBy=this.props.list.orderBy;if(orderBy.length&&column.widget!=="handle"&&orderBy[0].name===column.name&&column.hasLabel){classNames.push("table-active");}
if(this.isNumericColumn(column)){classNames.push("o_list_number_th");}
if(column.type==="button_group"){classNames.push("o_list_button");}
if(column.widget){classNames.push(`o_${column.widget}_cell`);}
return classNames.join(" ");}
getColumns(record){return this.state.columns;}
isNumericColumn(column){const{type}=this.fields[column.name];return["float","integer","monetary"].includes(type);}
shouldReverseHeader(column){return this.isNumericColumn(column)&&!this.isRTL;}
isSortable(column){const{hasLabel,name,options}=column;const{sortable}=this.fields[name];return(sortable||options.allow_order)&&hasLabel;}
getSortableIconClass(column){const{orderBy}=this.props.list;const classNames=this.isSortable(column)?["fa","fa-lg"]:["d-none"];if(orderBy.length&&orderBy[0].name===column.name){classNames.push(orderBy[0].asc?"fa-angle-up":"fa-angle-down");}else{classNames.push("fa-angle-down","opacity-0","opacity-75-hover");}
return classNames.join(" ");}
getRowClass(record){const classNames=this.props.archInfo.decorations.filter((decoration)=>evaluateBooleanExpr(decoration.condition,record.evalContextWithVirtualIds)).map((decoration)=>decoration.class);if(record.selected){classNames.push("table-info");}
if(record.isInEdition){classNames.push("o_selected_row");}
if(record.selected){classNames.push("o_data_row_selected");}
if(this.canResequenceRows){classNames.push("o_row_draggable");}
return classNames.join(" ");}
getCellClass(column,record){if(column.relatedPropertyField&&!(column.name in record.data)){return"";}
if(!this.cellClassByColumn[column.id]){const classNames=["o_data_cell"];if(column.type==="button_group"){classNames.push("o_list_button");}else if(column.type==="field"){classNames.push("o_field_cell");if(column.attrs&&column.attrs.class&&this.canUseFormatter(column,record)){classNames.push(column.attrs.class);}
const typeClass=FIELD_CLASSES[this.fields[column.name].type];if(typeClass){classNames.push(typeClass);}
if(column.widget){classNames.push(`o_${column.widget}_cell`);}}
this.cellClassByColumn[column.id]=classNames;}
const classNames=[...this.cellClassByColumn[column.id]];if(column.type==="field"){if(evaluateBooleanExpr(column.required,record.evalContextWithVirtualIds)){classNames.push("o_required_modifier");}
if(record.isFieldInvalid(column.name)){classNames.push("o_invalid_cell");}
if(this.isCellReadonly(column,record)){classNames.push("o_readonly_modifier");}
if(this.canUseFormatter(column,record)){const{decorations}=column;for(const decoName in decorations){if(evaluateBooleanExpr(decorations[decoName],record.evalContextWithVirtualIds)){classNames.push(getClassNameFromDecoration(decoName));}}}
if(record.isInEdition&&this.props.list.editedRecord&&this.isCellReadonly(column,this.props.list.editedRecord)){classNames.push("text-muted");}else{classNames.push("cursor-pointer");}}
return classNames.join(" ");}
isCellReadonly(column,record){return!!(this.isRecordReadonly(record)||(column.relatedPropertyField&&record.selected&&record.model.multiEdit)||evaluateBooleanExpr(column.readonly,record.evalContextWithVirtualIds));}
getCellTitle(column,record){const fieldType=this.fields[column.name].type;if(!(fieldType in FIXED_FIELD_COLUMN_WIDTHS)&&!["json","one2many","many2many"].includes(fieldType)){return this.getFormattedValue(column,record);}}
getFieldClass(column){return column.attrs&&column.attrs.class;}
getFormattedValue(column,record){const fieldName=column.name;if(column.options.enable_formatting===false){return record.data[fieldName];}
return getFormattedValue(record,fieldName,column.attrs);}
evalInvisible(invisible,record){return evaluateBooleanExpr(invisible,record.evalContextWithVirtualIds);}
evalColumnInvisible(columnInvisible){return this.props.evalViewModifier(columnInvisible);}
getGroupDisplayName(group){if(group.groupByField.type==="boolean"){return group.value===undefined?_t("None"):group.value?_t("Yes"):_t("No");}else{return group.value===undefined||group.value===false?_t("None"):group.displayName;}}
get canCreate(){return"link"in this.activeActions?this.activeActions.link:this.activeActions.create;}
get isX2Many(){return this.activeActions.type!=="view";}
get getEmptyRowIds(){let nbEmptyRow=Math.max(0,4-this.props.list.records.length);if(nbEmptyRow>0&&this.displayRowCreates){nbEmptyRow-=1;}
return Array.from(Array(nbEmptyRow).keys());}
get displayRowCreates(){return this.isX2Many&&this.canCreate;}
getFirstAggregateIndex(group){return this.state.columns.findIndex((col)=>col.name in group.aggregates);}
getLastAggregateIndex(group){const reversedColumns=[...this.state.columns].reverse();const index=reversedColumns.findIndex((col)=>col.name in group.aggregates);return index>-1?this.state.columns.length-index-1:-1;}
getAggregateColumns(group){const firstIndex=this.getFirstAggregateIndex(group);const lastIndex=this.getLastAggregateIndex(group);return this.state.columns.slice(firstIndex,lastIndex+1);}
getGroupNameCellColSpan(group){const firstAggregateIndex=this.getFirstAggregateIndex(group);let colspan;if(firstAggregateIndex>-1){colspan=firstAggregateIndex;}else{colspan=Math.max(1,this.state.columns.length-DEFAULT_GROUP_PAGER_COLSPAN);if(this.displayOptionalFields){colspan++;}}
if(this.hasSelectors){colspan++;}
return colspan;}
getGroupPagerCellColspan(group){const lastAggregateIndex=this.getLastAggregateIndex(group);let colspan;if(lastAggregateIndex>-1){colspan=this.state.columns.length-lastAggregateIndex-1;if(this.displayOptionalFields){colspan++;}}else{colspan=this.state.columns.length>1?DEFAULT_GROUP_PAGER_COLSPAN:0;}
if(this.props.onOpenFormView){colspan++;}
return colspan;}
getGroupPagerProps(group){const list=group.list;return{offset:list.offset,limit:list.limit,total:list.isGrouped?list.count:group.count,onUpdate:async({offset,limit})=>{await list.load({limit,offset});this.render(true);},withAccessKey:false,};}
getOptionalActiveFields(){this.optionalActiveFields={};let optionalActiveFields=browser.localStorage.getItem(this.keyOptionalFields);const optionalColumn=this.allColumns.filter((col)=>col.type==="field"&&col.optional);if(optionalActiveFields){optionalActiveFields=optionalActiveFields.split(",");optionalColumn.forEach((col)=>{this.optionalActiveFields[col.name]=optionalActiveFields.includes(col.name);});}else if(optionalActiveFields!==""){for(const col of optionalColumn){this.optionalActiveFields[col.name]=col.optional==="show";}}
if(this.props.onOptionalFieldsChanged){this.props.onOptionalFieldsChanged(this.optionalActiveFields);}}
onClickSortColumn(column){if(this.preventReorder){this.preventReorder=false;return;}
if(this.props.list.editedRecord||this.props.list.model.useSampleModel){return;}
const fieldName=column.name;const list=this.props.list;if(this.isSortable(column)){list.sortBy(fieldName);}}
onButtonCellClicked(record,column,ev){if(!ev.target.closest("button")){this.onCellClicked(record,column,ev);}}
async onCellClicked(record,column,ev){if(ev.target.special_click){return;}
const recordAfterResequence=async()=>{const recordIndex=this.props.list.records.indexOf(record);await this.resequencePromise;record=this.props.list.records[recordIndex]||record;};if((this.props.list.model.multiEdit&&record.selected)||this.isInlineEditable(record)){if(record.isInEdition&&this.props.list.editedRecord===record){const cell=this.tableRef.el.querySelector(`.o_selected_row td[name='${column.name}']`);if(cell&&containsActiveElement(cell)){this.lastEditedCell={column,record};return;}
this.focusCell(column);this.cellToFocus=null;}else{await recordAfterResequence();await this.props.list.enterEditMode(record);this.cellToFocus={column,record};if(column.type==="field"&&record.fields[column.name].type==="boolean"&&(!column.widget||column.widget==="boolean")){if(!this.isCellReadonly(column,record)&&!this.evalInvisible(column.invisible,record)){await record.update({[column.name]:!record.data[column.name]});}}}}else if(this.props.list.editedRecord&&this.props.list.editedRecord!==record){this.props.list.leaveEditMode();}else if(!this.props.archInfo.noOpen){this.props.openRecord(record);}}
async onDeleteRecord(record){this.keepColumnWidths=true;const editedRecord=this.props.list.editedRecord;if(editedRecord&&editedRecord!==record){const leaved=await this.props.list.leaveEditMode();if(!leaved){return;}}
if(this.activeActions.onDelete){this.activeActions.onDelete(record);}}
findFocusFutureCell(cell,cellIsInGroupRow,direction){const row=cell.parentElement;const children=[...row.children];const index=children.indexOf(cell);let futureCell;switch(direction){case"up":{let futureRow=row.previousElementSibling;futureRow=futureRow||row.parentElement.previousElementSibling?.lastElementChild;if(futureRow){const addCell=[...futureRow.children].find((c)=>c.classList.contains("o_group_field_row_add"));const nextIsGroup=futureRow.classList.contains("o_group_header");const rowTypeSwitched=cellIsInGroupRow!==nextIsGroup;let defaultIndex=0;if(cellIsInGroupRow){defaultIndex=this.hasSelectors?1:0;}
futureCell=addCell||(futureRow&&futureRow.children[rowTypeSwitched?defaultIndex:index]);}
break;}
case"down":{let futureRow=row.nextElementSibling;futureRow=futureRow||row.parentElement.nextElementSibling?.firstElementChild;if(futureRow){const addCell=[...futureRow.children].find((c)=>c.classList.contains("o_group_field_row_add"));const nextIsGroup=futureRow.classList.contains("o_group_header");const rowTypeSwitched=cellIsInGroupRow!==nextIsGroup;let defaultIndex=0;if(cellIsInGroupRow){defaultIndex=this.hasSelectors?1:0;}
futureCell=addCell||(futureRow&&futureRow.children[rowTypeSwitched?defaultIndex:index]);}
break;}
case"left":{futureCell=children[index-1];break;}
case"right":{futureCell=children[index+1];break;}}
return futureCell&&getElementToFocus(futureCell);}
isInlineEditable(record){return!!this.props.editable;}
onCellKeydown(ev,group=null,record=null){if(this.props.list.model.useSampleModel){return;}
const hotkey=getActiveHotkey(ev);if(ev.target.tagName==="TEXTAREA"&&hotkey==="enter"){return;}
const closestCell=ev.target.closest("td, th");if(this.toggleFocusInsideCell(hotkey,closestCell)){return;}
const handled=this.props.list.editedRecord?this.onCellKeydownEditMode(hotkey,closestCell,group,record):this.onCellKeydownReadOnlyMode(hotkey,closestCell,group,record);if(handled){this.lastCreatingAction=false;this.tableRef.el.querySelector("tbody").classList.add("o_keyboard_navigation");ev.preventDefault();ev.stopPropagation();}}
findNextFocusableOnRow(row,cell){const children=[...row.children];const index=children.indexOf(cell);const nextCells=children.slice(index+1);for(const c of nextCells){if(!c.classList.contains("o_data_cell")){continue;}
if(c.firstElementChild&&c.firstElementChild.classList.contains("o_readonly_modifier")){continue;}
const toFocus=getElementToFocus(c,0);if(toFocus!==c){return toFocus;}}
return null;}
findPreviousFocusableOnRow(row,cell){const children=[...row.children];const index=children.indexOf(cell);const previousCells=children.slice(0,index);for(const c of previousCells.reverse()){if(!c.classList.contains("o_data_cell")){continue;}
if(c.firstElementChild&&c.firstElementChild.classList.contains("o_readonly_modifier")){continue;}
const toFocus=getElementToFocus(c,-1);if(toFocus!==c){return toFocus;}}
return null;}
expandCheckboxes(record,direction){const{records}=this.props.list;if(!record&&direction==="down"){const defaultRecord=records[0];this.shiftKeyedRecord=defaultRecord;defaultRecord.toggleSelection(true);return true;}
const recordIndex=records.indexOf(record);const shiftKeyedRecordIndex=records.indexOf(this.shiftKeyedRecord);let nextRecord;let isExpanding;switch(direction){case"up":if(recordIndex<=0){return false;}
nextRecord=records[recordIndex-1];isExpanding=shiftKeyedRecordIndex>recordIndex-1;break;case"down":if(recordIndex===records.length-1){return false;}
nextRecord=records[recordIndex+1];isExpanding=shiftKeyedRecordIndex<recordIndex+1;break;}
if(isExpanding){record.toggleSelection(true);nextRecord.toggleSelection(true);}else{record.toggleSelection(false);}
return true;}
applyCellKeydownMultiEditMode(hotkey,cell,group,record){const{list}=this.props;const row=cell.parentElement;let toFocus,futureRecord;const index=list.selection.indexOf(record);if(this.lastIsDirty&&["tab","shift+tab","enter"].includes(hotkey)){list.leaveEditMode();return true;}
if(this.applyCellKeydownEditModeStayOnRow(hotkey,cell,group,record)){return true;}
switch(hotkey){case"tab":futureRecord=list.selection[index+1]||list.selection[0];if(record===futureRecord){toFocus=this.findNextFocusableOnRow(row,cell);this.focus(toFocus);return true;}
break;case"shift+tab":futureRecord=list.selection[index-1]||list.selection[list.selection.length-1];if(record===futureRecord){toFocus=this.findPreviousFocusableOnRow(row,cell);this.focus(toFocus);return true;}
this.cellToFocus={forward:false,record:futureRecord};break;case"enter":if(list.selection.length===1){list.leaveEditMode();return true;}
futureRecord=list.selection[index+1]||list.selection[0];break;}
if(futureRecord){list.enterEditMode(futureRecord);return true;}
return false;}
applyCellKeydownEditModeGroup(hotkey,_cell,group,record){const{editable}=this.props;const groupIndex=group.list.records.indexOf(record);const isLastOfGroup=groupIndex===group.list.records.length-1;const isDirty=record.dirty||this.lastIsDirty;const isEnterBehavior=hotkey==="enter"&&(!record.canBeAbandoned||isDirty);const isTabBehavior=hotkey==="tab"&&!record.canBeAbandoned&&isDirty;if(isLastOfGroup&&this.canCreate&&editable==="bottom"&&(isEnterBehavior||isTabBehavior)){this.add({group});return true;}
return false;}
applyCellKeydownEditModeStayOnRow(hotkey,cell,group,record){let toFocus;const row=cell.parentElement;switch(hotkey){case"tab":toFocus=this.findNextFocusableOnRow(row,cell);break;case"shift+tab":toFocus=this.findPreviousFocusableOnRow(row,cell);break;}
if(toFocus){this.focus(toFocus);return true;}
return false;}
onCellKeydownEditMode(hotkey,cell,group,record){const{cycleOnTab,list}=this.props;const row=cell.parentElement;const applyMultiEditBehavior=record&&record.selected&&list.model.multiEdit;const topReCreate=this.props.editable==="top"&&record.isNew;if(applyMultiEditBehavior&&this.applyCellKeydownMultiEditMode(hotkey,cell,group,record)){return true;}
if(this.applyCellKeydownEditModeStayOnRow(hotkey,cell,group,record)){return true;}
if(group&&this.applyCellKeydownEditModeGroup(hotkey,cell,group,record)){return true;}
switch(hotkey){case"tab":{const index=list.records.indexOf(record);const lastIndex=topReCreate?0:list.records.length-1;if(index===lastIndex){if(this.displayRowCreates){if(record.isNew&&!record.dirty){list.leaveEditMode();return false;}
const{context}=this.creates[0];this.add({context});}else if(this.canCreate&&!record.canBeAbandoned&&(record.dirty||this.lastIsDirty)){this.add({group});}else if(cycleOnTab){if(record.canBeAbandoned){list.leaveEditMode();}
const futureRecord=list.records[0];if(record===futureRecord){const toFocus=this.findNextFocusableOnRow(row);this.focus(toFocus);}else{list.enterEditMode(futureRecord);}}else{return false;}}else{const futureRecord=list.records[index+1];list.enterEditMode(futureRecord);}
break;}
case"shift+tab":{const index=list.records.indexOf(record);if(index===0){if(cycleOnTab){if(record.canBeAbandoned){list.leaveEditMode();}
const futureRecord=list.records[list.records.length-1];if(record===futureRecord){const toFocus=this.findPreviousFocusableOnRow(row);this.focus(toFocus);}else{this.cellToFocus={forward:false,record:futureRecord};list.enterEditMode(futureRecord);}}else{list.leaveEditMode();return false;}}else{const futureRecord=list.records[index-1];this.cellToFocus={forward:false,record:futureRecord};list.enterEditMode(futureRecord);}
break;}
case"enter":{const index=list.records.indexOf(record);let futureRecord=list.records[index+1];if(topReCreate&&index===0){futureRecord=null;}
if(!futureRecord&&!this.canCreate){futureRecord=list.records[0];}
if(futureRecord){list.leaveEditMode({validate:true}).then((canProceed)=>{if(canProceed){list.enterEditMode(futureRecord);}});}else if(this.lastIsDirty||!record.canBeAbandoned||this.displayRowCreates){this.add({group});}else{futureRecord=list.records.at(0);list.enterEditMode(futureRecord);}
break;}
case"escape":{list.leaveEditMode({discard:true});const firstAddButton=this.tableRef.el.querySelector(".o_field_x2many_list_row_add a");if(firstAddButton){this.focus(firstAddButton);}else if(group&&record.isNew){const children=[...row.parentElement.children];const index=children.indexOf(row);for(let i=index+1;i<children.length;i++){const row=children[i];if(row.classList.contains("o_group_header")){break;}
const addCell=[...row.children].find((c)=>c.classList.contains("o_group_field_row_add"));if(addCell){const toFocus=addCell.querySelector("a");this.focus(toFocus);return true;}}
this.focus(cell);}else{this.focus(cell);}
break;}
default:return false;}
return true;}
onCellKeydownReadOnlyMode(hotkey,cell,group,record){const cellIsInGroupRow=Boolean(group&&!record);const applyMultiEditBehavior=record&&record.selected&&this.props.list.model.multiEdit;let toFocus;switch(hotkey){case"arrowup":toFocus=this.findFocusFutureCell(cell,cellIsInGroupRow,"up");if(!toFocus&&this.env.searchModel){this.env.searchModel.trigger("focus-search");return true;}
break;case"arrowdown":toFocus=this.findFocusFutureCell(cell,cellIsInGroupRow,"down");break;case"arrowleft":if(cellIsInGroupRow&&!group.isFolded){this.toggleGroup(group);return true;}
if(cell.classList.contains("o_field_x2many_list_row_add")){const a=document.activeElement;toFocus=a.previousElementSibling;}else{toFocus=this.findFocusFutureCell(cell,cellIsInGroupRow,"left");}
break;case"arrowright":if(cellIsInGroupRow&&group.isFolded){this.toggleGroup(group);return true;}
if(cell.classList.contains("o_field_x2many_list_row_add")){const a=document.activeElement;toFocus=a.nextElementSibling;}else{toFocus=this.findFocusFutureCell(cell,cellIsInGroupRow,"right");}
break;case"tab":if(cellIsInGroupRow){const buttons=Array.from(cell.querySelectorAll(".o_group_buttons button"));const currentButton=document.activeElement.closest("button");const index=buttons.indexOf(currentButton);toFocus=buttons[index+1]||currentButton;}
break;case"shift+tab":if(cellIsInGroupRow){const buttons=Array.from(cell.querySelectorAll(".o_group_buttons button"));const currentButton=document.activeElement.closest("button");const index=buttons.indexOf(currentButton);toFocus=buttons[index-1]||currentButton;}
break;case"shift+arrowdown":{if(this.expandCheckboxes(record,"down")){toFocus=this.findFocusFutureCell(cell,cellIsInGroupRow,"down");}
break;}
case"shift+arrowup":{if(this.expandCheckboxes(record,"up")){toFocus=this.findFocusFutureCell(cell,cellIsInGroupRow,"up");}
break;}
case"shift+space":this.toggleRecordSelection(record);toFocus=getElementToFocus(cell);break;case"shift":this.shiftKeyedRecord=record;break;case"enter":if(!group&&!record){return false;}
if(cell.classList.contains("o_list_record_remove")){this.onDeleteRecord(record);return true;}
if(cellIsInGroupRow){const button=document.activeElement.closest("button");if(button){button.click();}else{this.toggleGroup(group);}
return true;}
if(this.isInlineEditable(record)||applyMultiEditBehavior){const column=this.state.columns.find((c)=>c.name===cell.getAttribute("name"));this.cellToFocus={column,record};this.props.list.enterEditMode(record);return true;}
if(!this.props.archInfo.noOpen){this.props.openRecord(record);return true;}
break;default:return false;}
if(toFocus){this.focus(toFocus);return true;}
return false;}
async onCreateAction(context){if(this.createProm){return;}
this.add({context});this.createProm=Promise.resolve();this.createProm.then(()=>{this.lastCreatingAction=true;});await this.createProm;this.createProm=null;}
onFocusIn(ev){const{relatedTarget,target}=ev;const fromOutside=!this.rootRef.el.contains(relatedTarget);if(!fromOutside){return;}
const isX2MRowAdder=target.tagName==="A"&&target.parentElement.classList.contains("o_field_x2many_list_row_add");const withinSameUIActiveElement=this.uiService.getActiveElementOf(relatedTarget)===this.activeElement;if(withinSameUIActiveElement&&isX2MRowAdder){const{context}=this.creates[0];this.onCreateAction(context);}}
saveOptionalActiveFields(){browser.localStorage.setItem(this.keyOptionalFields,Object.keys(this.optionalActiveFields).filter((fieldName)=>this.optionalActiveFields[fieldName]));}
get showNoContentHelper(){const{model}=this.props.list;return this.props.noContentHelp&&(model.useSampleModel||!model.hasData());}
showGroupPager(group){return(!group.isFolded&&group.list.limit<(group.list.isGrouped?group.list.count:group.count));}
toggleFocusInsideCell(hotkey,cell){if(!["tab","shift+tab"].includes(hotkey)||!containsActiveElement(cell)){return false;}
const focusableEls=getTabableElements(cell).filter((el)=>el===document.activeElement||["INPUT","TEXTAREA"].includes(el.tagName));const index=focusableEls.indexOf(document.activeElement);return((hotkey==="tab"&&index<focusableEls.length-1)||(hotkey==="shift+tab"&&index>0));}
toggleGroup(group){group.toggle();}
get canSelectRecord(){return!this.props.list.editedRecord&&!this.props.list.model.useSampleModel;}
toggleSelection(){const list=this.props.list;if(!this.canSelectRecord){return;}
return list.toggleSelection();}
toggleRecordSelection(record,ev){if(!this.canSelectRecord){return;}
if(this.shiftKeyMode&&this.lastCheckedRecord){this.toggleRecordShiftSelection(record);}else{record.toggleSelection();}
this.lastCheckedRecord=record;this.props.list.selectDomain(false);}
toggleRecordShiftSelection(record){const{records}=this.props.list;const recordIndex=records.indexOf(record);const lastCheckedRecordIndex=records.indexOf(this.lastCheckedRecord);const start=Math.min(recordIndex,lastCheckedRecordIndex);const end=Math.max(recordIndex,lastCheckedRecordIndex);const{selected}=record;for(let i=start;i<=end;i++){records[i].toggleSelection(!selected);}}
async toggleOptionalField(fieldName){this.optionalActiveFields[fieldName]=!this.optionalActiveFields[fieldName];if(this.props.onOptionalFieldsChanged){this.props.onOptionalFieldsChanged(this.optionalActiveFields);}
this.state.columns=this.getActiveColumns(this.props.list);this.saveOptionalActiveFields(this.allColumns.filter((col)=>this.optionalActiveFields[col.name]&&col.optional));}
toggleOptionalFieldGroup(groupId){const fieldNames=this.allColumns.filter((col)=>col.type==="field"&&col.relatedPropertyField&&col.relatedPropertyField.id===groupId).map((col)=>col.name);const active=!fieldNames.every((fieldName)=>this.optionalActiveFields[fieldName]);for(const fieldName of fieldNames){this.optionalActiveFields[fieldName]=active;}
this.state.columns=this.getActiveColumns(this.props.list);this.saveOptionalActiveFields(this.allColumns.filter((col)=>this.optionalActiveFields[col.name]&&col.optional));}
onGlobalClick(ev){if(!this.props.list.editedRecord){return;}
this.tableRef.el.querySelector("tbody").classList.remove("o_keyboard_navigation");const target=ev.target;if(this.tableRef.el.contains(target)&&target.closest(".o_data_row")){return;}
if(this.activeElement!==this.uiService.activeElement){return;}
if(target.closest(".o_datetime_picker")){return;}
if(ev.target.closest(".ui-autocomplete")){return;}
this.props.list.leaveEditMode();}
calculateColumnWidth(column){if(column.options&&column.attrs.width){return{type:"absolute",value:column.attrs.width};}
if(column.type!=="field"){return{type:"relative",value:1};}
const type=column.widget||this.fields[column.name].type;if(type in FIXED_FIELD_COLUMN_WIDTHS){return{type:"absolute",value:FIXED_FIELD_COLUMN_WIDTHS[type]};}
return{type:"relative",value:1};}
get isDebugMode(){return Boolean(odoo.debug);}
makeTooltip(column){return getTooltipInfo({viewMode:"list",resModel:this.props.list.resModel,field:this.fields[column.name],fieldInfo:column,});}
onColumnTitleMouseUp(){if(this.resizing){this.preventReorder=true;}}
onStartResize(ev){this.resizing=true;const table=this.tableRef.el;const th=ev.target.closest("th");const handler=th.querySelector(".o_resize");table.style.width=`${Math.floor(table.getBoundingClientRect().width)}px`;const thPosition=[...th.parentNode.children].indexOf(th);const resizingColumnElements=[...table.getElementsByTagName("tr")].filter((tr)=>tr.children.length===th.parentNode.children.length).map((tr)=>tr.children[thPosition]);const initialX=ev.clientX;const initialWidth=th.getBoundingClientRect().width;const initialTableWidth=table.getBoundingClientRect().width;const resizeStoppingEvents=["keydown","pointerdown","pointerup"];if(!this.rootRef.el.style.width){this.rootRef.el.style.width=`${Math.floor(
                this.rootRef.el.getBoundingClientRect().width
            )}px`;}
table.classList.add("o_resizing");for(const el of resizingColumnElements){el.classList.add("o_column_resizing");handler.classList.add("bg-primary","opacity-100");handler.classList.remove("bg-black-25","opacity-50-hover");}
const resizeHeader=(ev)=>{ev.preventDefault();ev.stopPropagation();const delta=ev.clientX-initialX;const newWidth=Math.max(10,initialWidth+delta);const tableDelta=newWidth-initialWidth;th.style.width=`${Math.floor(newWidth)}px`;th.style.maxWidth=`${Math.floor(newWidth)}px`;table.style.width=`${Math.floor(initialTableWidth + tableDelta)}px`;};window.addEventListener("pointermove",resizeHeader);const stopResize=(ev)=>{this.resizing=false;this.keepColumnWidths=true;if(ev.type==="pointerdown"&&ev.button===0){return;}
ev.preventDefault();ev.stopPropagation();table.classList.remove("o_resizing");for(const el of resizingColumnElements){el.classList.remove("o_column_resizing");handler.classList.remove("bg-primary","opacity-100");handler.classList.add("bg-black-25","opacity-50-hover");}
window.removeEventListener("pointermove",resizeHeader);for(const eventType of resizeStoppingEvents){window.removeEventListener(eventType,stopResize);}
document.activeElement.blur();};for(const eventType of resizeStoppingEvents){window.addEventListener(eventType,stopResize);}}
resetLongTouchTimer(){if(this.longTouchTimer){browser.clearTimeout(this.longTouchTimer);this.longTouchTimer=null;}}
onRowTouchStart(record,ev){if(!this.props.allowSelectors){return;}
if(this.props.list.selection.length){ev.stopPropagation();}
this.touchStartMs=Date.now();if(this.longTouchTimer===null){this.longTouchTimer=browser.setTimeout(()=>{this.toggleRecordSelection(record);this.resetLongTouchTimer();},this.constructor.LONG_TOUCH_THRESHOLD);}}
onRowTouchEnd(record){const elapsedTime=Date.now()-this.touchStartMs;if(elapsedTime<this.constructor.LONG_TOUCH_THRESHOLD){this.resetLongTouchTimer();}}
onRowTouchMove(record){this.resetLongTouchTimer();}
async sortDrop(dataRowId,{element,previous}){await this.props.list.leaveEditMode();element.classList.remove("o_row_draggable");const refId=previous?previous.dataset.id:null;this.resequencePromise=this.props.list.resequence(dataRowId,refId,{handleField:this.props.list.handleField,});await this.resequencePromise;element.classList.add("o_row_draggable");}
sortStart({element}){const table=this.tableRef.el;const headers=[...table.querySelectorAll("thead th")];const cells=[...element.querySelectorAll("td")];let headerIndex=0;for(const cell of cells){let width=0;for(let i=0;i<cell.colSpan;i++){const header=headers[headerIndex+i];const style=getComputedStyle(header);width+=parseFloat(style.width);}
cell.style.width=`${width}px`;headerIndex+=cell.colSpan;}}
sortStop({element}){for(const cell of element.querySelectorAll("td")){cell.style.width=null;}}
ignoreEventInSelectionMode(ev){const{list}=this.props;if(this.env.isSmall&&list.selection&&list.selection.length){ev.stopPropagation();ev.preventDefault();}}
onClickCapture(record,ev){const{list}=this.props;if(this.env.isSmall&&list.selection&&list.selection.length){ev.stopPropagation();ev.preventDefault();this.toggleRecordSelection(record);}}}
ListRenderer.template="web.ListRenderer";ListRenderer.rowsTemplate="web.ListRenderer.Rows";ListRenderer.recordRowTemplate="web.ListRenderer.RecordRow";ListRenderer.groupRowTemplate="web.ListRenderer.GroupRow";ListRenderer.components={DropdownItem,Field,ViewButton,CheckBox,Dropdown:OptionalFieldsDropdown,Pager,Widget};ListRenderer.props=["activeActions?","list","archInfo","openRecord","evalViewModifier","onAdd?","cycleOnTab?","allowSelectors?","editable?","onOpenFormView?","noContentHelp?","nestedKeyOptionalFieldsData?","onOptionalFieldsChanged?",];ListRenderer.defaultProps={hasSelectors:false,cycleOnTab:true};ListRenderer.LONG_TOUCH_THRESHOLD=400;return __exports;});;

/* /web/static/src/views/list/list_view.js */
odoo.define('@web/views/list/list_view',['@web/core/registry','@web/model/relational_model/relational_model','@web/views/list/list_arch_parser','@web/views/list/list_controller','@web/views/list/list_renderer'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{RelationalModel}=require("@web/model/relational_model/relational_model");const{ListArchParser}=require("@web/views/list/list_arch_parser");const{ListController}=require("@web/views/list/list_controller");const{ListRenderer}=require("@web/views/list/list_renderer");const listView=__exports.listView={type:"list",display_name:"List",icon:"oi oi-view-list",multiRecord:true,Controller:ListController,Renderer:ListRenderer,ArchParser:ListArchParser,Model:RelationalModel,buttonTemplate:"web.ListView.Buttons",limit:80,props:(genericProps,view)=>{const{ArchParser}=view;const{arch,relatedModels,resModel}=genericProps;const archInfo=new ArchParser().parse(arch,relatedModels,resModel);return{...genericProps,Model:view.Model,Renderer:view.Renderer,buttonTemplate:view.buttonTemplate,archInfo,};},};registry.category("views").add("list",listView);return __exports;});;

/* /web/static/src/views/onboarding_banner.js */
odoo.define('@web/views/onboarding_banner',['@web/core/assets','@web/core/utils/hooks','@web/views/view_hook','@odoo/owl','@web/core/transition'],function(require){'use strict';let __exports={};const{loadCSS,loadJS}=require("@web/core/assets");const{useService}=require("@web/core/utils/hooks");const{useActionLinks}=require("@web/views/view_hook");const{Component,markup,onWillStart,useRef,xml}=require("@odoo/owl");const{useTransition}=require("@web/core/transition");const OnboardingBanner=__exports.OnboardingBanner=class OnboardingBanner extends Component{setup(){this.rpc=useService("rpc");this.user=useService("user");this.onboardingContainerRef=useRef("onboardingContainer");const resModel="searchModel"in this.env?this.env.searchModel.resModel:undefined;this._handleActionLinks=useActionLinks({resModel,reload:async()=>{this.bannerHTML=await this.loadBanner(this.env.config.bannerRoute);this.render();},});this.transition=useTransition({name:"o-vertical-slide",initialVisibility:true,leaveDuration:400,});this.handleActionLinks=(event)=>{if(event.target.dataset.oHideBanner){const container=this.onboardingContainerRef.el;container.style.height=`${container.getBoundingClientRect().height}px`;this.transition.shouldMount=false;}
this._handleActionLinks(event);};onWillStart(this.onWillStart);}
async onWillStart(){this.bannerHTML=await this.loadBanner(this.env.config.bannerRoute);}
async loadBanner(bannerRoute){let response=await this.rpc(bannerRoute,{context:this.user.context});if(response.code===503){response=await this.rpc(bannerRoute,{context:this.user.context});}
if(!response.html){return;}
const banner=new DOMParser().parseFromString(response.html,"text/html");await Promise.all([...[...banner.querySelectorAll(`script[type="text/javascript"]`)].map((el)=>{el.remove();return loadJS(el.getAttribute("src"));}),...[...banner.querySelectorAll(`link[rel="stylesheet"]`)].map((el)=>{el.remove();return loadCSS(el.getAttribute("href"));}),]);return markup(new XMLSerializer().serializeToString(banner));}}
OnboardingBanner.template=xml`<div t-if="transition.shouldMount" t-attf-class="o_onboarding_container w-100 {{transition.className}}" t-ref="onboardingContainer" t-on-click="handleActionLinks" t-out="bannerHTML"/>`;OnboardingBanner.props={};return __exports;});;

/* /web/static/src/views/pivot/pivot_arch_parser.js */
odoo.define('@web/views/pivot/pivot_arch_parser',['@web/core/utils/xml','@web/views/utils'],function(require){'use strict';let __exports={};const{visitXML}=require("@web/core/utils/xml");const{archParseBoolean}=require("@web/views/utils");const PivotArchParser=__exports.PivotArchParser=class PivotArchParser{parse(arch){const archInfo={activeMeasures:[],colGroupBys:[],defaultOrder:null,fieldAttrs:{},rowGroupBys:[],widgets:{},};visitXML(arch,(node)=>{switch(node.tagName){case"pivot":{if(node.hasAttribute("disable_linking")){archInfo.disableLinking=archParseBoolean(node.getAttribute("disable_linking"));}
if(node.hasAttribute("default_order")){archInfo.defaultOrder=node.getAttribute("default_order");}
if(node.hasAttribute("string")){archInfo.title=node.getAttribute("string");}
if(node.hasAttribute("display_quantity")){archInfo.displayQuantity=archParseBoolean(node.getAttribute("display_quantity"));}
break;}
case"field":{let fieldName=node.getAttribute("name");archInfo.fieldAttrs[fieldName]={};if(node.hasAttribute("string")){archInfo.fieldAttrs[fieldName].string=node.getAttribute("string");}
if(node.getAttribute("invisible")==="True"||node.getAttribute("invisible")==="1"){archInfo.fieldAttrs[fieldName].isInvisible=true;break;}
if(node.hasAttribute("interval")){fieldName+=":"+node.getAttribute("interval");}
if(node.hasAttribute("widget")){archInfo.widgets[fieldName]=node.getAttribute("widget");}
if(node.getAttribute("type")==="measure"||node.hasAttribute("operator")){archInfo.activeMeasures.push(fieldName);}
if(node.getAttribute("type")==="col"){archInfo.colGroupBys.push(fieldName);}
if(node.getAttribute("type")==="row"){archInfo.rowGroupBys.push(fieldName);}
break;}}});return archInfo;}}
return __exports;});;

/* /web/static/src/views/pivot/pivot_controller.js */
odoo.define('@web/views/pivot/pivot_controller',['@web/search/layout','@web/model/model','@web/views/standard_view_props','@web/views/view_hook','@web/search/search_bar/search_bar','@web/search/search_bar/search_bar_toggler','@web/search/cog_menu/cog_menu','@odoo/owl'],function(require){'use strict';let __exports={};const{Layout}=require("@web/search/layout");const{useModelWithSampleData}=require("@web/model/model");const{standardViewProps}=require("@web/views/standard_view_props");const{useSetupView}=require("@web/views/view_hook");const{SearchBar}=require("@web/search/search_bar/search_bar");const{useSearchBarToggler}=require("@web/search/search_bar/search_bar_toggler");const{CogMenu}=require("@web/search/cog_menu/cog_menu");const{Component,useRef}=require("@odoo/owl");const PivotController=__exports.PivotController=class PivotController extends Component{setup(){this.model=useModelWithSampleData(this.props.Model,this.props.modelParams);useSetupView({rootRef:useRef("root"),getLocalState:()=>{const{data,metaData}=this.model;return{data,metaData};},getContext:()=>this.getContext(),});this.searchBarToggler=useSearchBarToggler();}
getContext(){return{pivot_measures:this.model.metaData.activeMeasures,pivot_column_groupby:this.model.metaData.fullColGroupBys,pivot_row_groupby:this.model.metaData.fullRowGroupBys,};}}
PivotController.template="web.PivotView";PivotController.components={Layout,SearchBar,CogMenu};PivotController.props={...standardViewProps,Model:Function,modelParams:Object,Renderer:Function,buttonTemplate:{type:String,optional:true},};return __exports;});;

/* /web/static/src/views/pivot/pivot_group_by_menu.js */
odoo.define('@web/views/pivot/pivot_group_by_menu',['@web/core/dropdown/dropdown','@web/core/utils/arrays','@web/core/utils/hooks','@web/search/custom_group_by_item/custom_group_by_item','@web/search/properties_group_by_item/properties_group_by_item','@web/core/dropdown/checkbox_item','@web/search/utils/dates','@web/search/utils/misc','@odoo/owl'],function(require){'use strict';let __exports={};const{Dropdown}=require("@web/core/dropdown/dropdown");const{sortBy}=require("@web/core/utils/arrays");const{useBus}=require("@web/core/utils/hooks");const{CustomGroupByItem}=require("@web/search/custom_group_by_item/custom_group_by_item");const{PropertiesGroupByItem}=require("@web/search/properties_group_by_item/properties_group_by_item");const{CheckboxItem}=require("@web/core/dropdown/checkbox_item");const{getIntervalOptions}=require("@web/search/utils/dates");const{FACET_ICONS,GROUPABLE_TYPES}=require("@web/search/utils/misc");const{Component}=require("@odoo/owl");const PivotGroupByMenu=__exports.PivotGroupByMenu=class PivotGroupByMenu extends Component{setup(){this.icon=FACET_ICONS.groupBy;this.dropdownProps=Object.keys(this.props).filter((key)=>key in Dropdown.props).reduce((obj,key)=>({...obj,[key]:this.props[key]}),{});const fields=[];for(const[fieldName,field]of Object.entries(this.env.searchModel.searchViewFields)){if(this.validateField(fieldName,field)){fields.push(Object.assign({name:fieldName},field));}}
this.fields=sortBy(fields,"string");useBus(this.env.searchModel,"update",this.render);}
get hideCustomGroupBy(){return this.env.searchModel.hideCustomGroupBy||false;}
get items(){let items=this.env.searchModel.getSearchItems((searchItem)=>["groupBy","dateGroupBy"].includes(searchItem.type));items=items.filter((i)=>!i.custom);if(items.length===0){items=this.fields;}
let groupNumber=1+Math.max(0,...items.map(({groupNumber:n})=>n));for(const[fieldName,customGroupBy]of this.props.customGroupBys.entries()){items.push({...customGroupBy,name:fieldName,groupNumber:groupNumber++});}
return items.map((item)=>({...item,id:item.id||item.name,fieldName:item.fieldName||item.name,description:item.description||item.string,isActive:false,options:item.options||["date","datetime"].includes(item.type)?getIntervalOptions():undefined,}));}
validateField(fieldName,field){const{sortable,store,type}=field;return((type==="many2many"?store:sortable)&&fieldName!=="id"&&GROUPABLE_TYPES.includes(type));}
onGroupBySelected({itemId,optionId}){const item=this.items.find(({id})=>id===itemId);this.props.onItemSelected({itemId,optionId,fieldName:item.fieldName,interval:optionId,groupId:this.props.cell.groupId,});}
onAddCustomGroup(fieldName){this.props.onAddCustomGroupBy(fieldName);}}
PivotGroupByMenu.components={CustomGroupByItem,Dropdown,CheckboxItem,PropertiesGroupByItem,};PivotGroupByMenu.template="web.PivotGroupByMenu";PivotGroupByMenu.defaultProps={showCaretDown:false,};PivotGroupByMenu.props={...Dropdown.props,showCaretDown:{type:Boolean,optional:true},cell:Object,customGroupBys:Object,onAddCustomGroupBy:Function,onItemSelected:Function,};return __exports;});;

/* /web/static/src/views/pivot/pivot_model.js */
odoo.define('@web/views/pivot/pivot_model',['@web/core/l10n/translation','@web/core/domain','@web/core/utils/arrays','@web/core/utils/concurrency','@web/search/utils/dates','@web/model/model','@web/views/utils'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{Domain}=require("@web/core/domain");const{cartesian,sections,sortBy,symmetricalDifference}=require("@web/core/utils/arrays");const{KeepLast,Race}=require("@web/core/utils/concurrency");const{DEFAULT_INTERVAL}=require("@web/search/utils/dates");const{Model}=require("@web/model/model");const{computeReportMeasures,processMeasure}=require("@web/views/utils");function computeVariation(value,comparisonValue){if(isNaN(value)||isNaN(comparisonValue)){return NaN;}
if(comparisonValue===0){if(value===0){return 0;}else if(value>0){return 1;}else{return-1;}}
return(value-comparisonValue)/Math.abs(comparisonValue);}
const PivotModel=__exports.PivotModel=class PivotModel extends Model{setup(params){this.keepLast=new KeepLast();this.race=new Race();const _loadData=this._loadData.bind(this);this._loadData=(...args)=>{return this.race.add(_loadData(...args));};let sortedColumn=params.metaData.sortedColumn||null;if(!sortedColumn&&params.metaData.defaultOrder){const defaultOrder=params.metaData.defaultOrder.split(" ");sortedColumn={groupId:[[],[]],measure:defaultOrder[0],order:defaultOrder[1]?defaultOrder[1]:"asc",};}
this.searchParams={context:{},domain:[],domains:[],groupBy:[],};this.data=params.data||{colGroupTree:null,rowGroupTree:null,groupDomains:{},measurements:{},counts:{},numbering:{},};const metaData=Object.assign({},params.metaData,{customGroupBys:params.metaData.customGroupBys||new Map(),expandedRowGroupBys:params.metaData.expandedRowGroupBys||[],expandedColGroupBys:params.metaData.expandedColGroupBys||[],sortedColumn,});this.metaData=this._buildMetaData(metaData);this.reload=false;this.nextActiveMeasures=null;}
async addGroupBy(params){if(this.race.getCurrentProm()){return;}
const{groupId,fieldName,type,custom}=params;let{interval}=params;const metaData=this._buildMetaData();if(custom&&!metaData.customGroupBys.has(fieldName)){const field=metaData.fields[fieldName];if(!interval&&["date","datetime"].includes(field.type)){interval=DEFAULT_INTERVAL;}
metaData.customGroupBys.set(fieldName,{...field,id:fieldName,});}
let groupBy=fieldName;if(interval){groupBy=`${groupBy}:${interval}`;}
if(type==="row"){metaData.expandedRowGroupBys.push(groupBy);}else{metaData.expandedColGroupBys.push(groupBy);}
const config={metaData,data:this.data};await this._expandGroup(groupId,type,config);this.metaData=metaData;this.notify();}
closeGroup(groupId,type){if(this.race.getCurrentProm()){return;}
let groupBys;let expandedGroupBys;let keyPart;let group;let tree;if(type==="row"){groupBys=this.metaData.rowGroupBys;expandedGroupBys=this.metaData.expandedRowGroupBys;tree=this.data.rowGroupTree;group=this._findGroup(this.data.rowGroupTree,groupId[0]);keyPart=0;}else{groupBys=this.metaData.colGroupBys;expandedGroupBys=this.metaData.expandedColGroupBys;tree=this.data.colGroupTree;group=this._findGroup(this.data.colGroupTree,groupId[1]);keyPart=1;}
const groupIdPart=groupId[keyPart];const range=groupIdPart.map((_,index)=>index);function keep(key){const idPart=JSON.parse(key)[keyPart];return(range.some((index)=>groupIdPart[index]!==idPart[index])||idPart.length===groupIdPart.length);}
function omitKeys(object){const newObject={};for(const key in object){if(keep(key)){newObject[key]=object[key];}}
return newObject;}
this.data.measurements=omitKeys(this.data.measurements);this.data.counts=omitKeys(this.data.counts);this.data.groupDomains=omitKeys(this.data.groupDomains);group.directSubTrees.clear();delete group.sortedKeys;var newGroupBysLength=this._getTreeHeight(tree)-1;if(newGroupBysLength<=groupBys.length){expandedGroupBys.splice(0);groupBys.splice(newGroupBysLength);}else{expandedGroupBys.splice(newGroupBysLength-groupBys.length);}
this.notify();}
async expandAll(){const config={metaData:this.metaData,data:this.data};await this._loadData(config,false);this.notify();}
async expandGroup(groupId,type){if(this.race.getCurrentProm()){return;}
const config={metaData:this.metaData,data:this.data};await this._expandGroup(groupId,type,config);this.notify();}
exportData(){const measureCount=this.metaData.activeMeasures.length;const originCount=this.metaData.origins.length;const table=this.getTable();const headers=table.headers;let colGroupHeaderRows;let measureRow=[];let originRow=[];function processHeader(header){const inTotalColumn=header.groupId[1].length===0;return{title:header.title,width:header.width,height:header.height,is_bold:!!header.measure&&inTotalColumn,};}
if(originCount>1){colGroupHeaderRows=headers.slice(0,headers.length-2);measureRow=headers[headers.length-2].map(processHeader);originRow=headers[headers.length-1].map(processHeader);}else{colGroupHeaderRows=headers.slice(0,headers.length-1);measureRow=headers[headers.length-1].map(processHeader);}
colGroupHeaderRows[0].splice(0,1);colGroupHeaderRows=colGroupHeaderRows.map((headerRow)=>{return headerRow.map(processHeader);});const tableRows=table.rows.map((row)=>{return{title:row.title,indent:row.indent,values:row.subGroupMeasurements.map((measurement)=>{let value=measurement.value;if(value===undefined){value="";}else if(measurement.originIndexes.length>1){value=value*100;}
return{is_bold:measurement.isBold,value:value,};}),};});return{model:this.metaData.resModel,title:this.metaData.title,col_group_headers:colGroupHeaderRows,measure_headers:measureRow,origin_headers:originRow,rows:tableRows,measure_count:measureCount,origin_count:originCount,};}
async flip(){await this.race.getCurrentProm();let temp=this.data.rowGroupTree;this.data.rowGroupTree=this.data.colGroupTree;this.data.colGroupTree=temp;temp=this.metaData.rowGroupBys;this.metaData.rowGroupBys=this.metaData.colGroupBys;this.metaData.colGroupBys=temp;temp=this.metaData.expandedColGroupBys;this.metaData.expandedColGroupBys=this.metaData.expandedRowGroupBys;this.metaData.expandedRowGroupBys=temp;function twistKey(key){return JSON.stringify(JSON.parse(key).reverse());}
function twist(object){const newObject={};Object.keys(object).forEach((key)=>{const value=object[key];newObject[twistKey(key)]=value;});return newObject;}
this.data.measurements=twist(this.data.measurements);this.data.counts=twist(this.data.counts);this.data.groupDomains=twist(this.data.groupDomains);this.notify();}
getGroupDomain(group){const config={metaData:this.metaData,data:this.data};return this._getGroupDomain(group,config);}
getTable(){const headers=this._getTableHeaders();return{headers:headers,rows:this._getTableRows(this.data.rowGroupTree,headers[headers.length-1]),};}
getTableWidth(){var leafCounts=this._getLeafCounts(this.data.colGroupTree);return leafCounts[JSON.stringify(this.data.colGroupTree.root.values)]+2;}
hasData(){return this._hasData(this.data);}
async load(searchParams){this.searchParams=searchParams;const processedMeasures=processMeasure(searchParams.context.pivot_measures);const activeMeasures=processedMeasures||this.metaData.activeMeasures;const metaData=this._buildMetaData({activeMeasures});if(!this.reload){metaData.rowGroupBys=searchParams.context.pivot_row_groupby||(searchParams.groupBy.length?searchParams.groupBy:metaData.rowGroupBys);this.reload=true;}else{metaData.rowGroupBys=searchParams.groupBy.length?searchParams.groupBy:searchParams.context.pivot_row_groupby||metaData.rowGroupBys;}
metaData.colGroupBys=searchParams.context.pivot_column_groupby||this.metaData.colGroupBys;if(JSON.stringify(metaData.rowGroupBys)!==JSON.stringify(this.metaData.rowGroupBys)){metaData.expandedRowGroupBys=[];}
if(JSON.stringify(metaData.colGroupBys)!==JSON.stringify(this.metaData.colGroupBys)){metaData.expandedColGroupBys=[];}
const allActivesMeasures=new Set(this.metaData.activeMeasures);if(processedMeasures){processedMeasures.forEach((e)=>allActivesMeasures.add(e));}
metaData.measures=computeReportMeasures(metaData.fields,metaData.fieldAttrs,[...allActivesMeasures,]);const config={metaData,data:this.data};return this._loadData(config);}
sortRows(sortedColumn){if(this.race.getCurrentProm()){return;}
const config={metaData:this.metaData,data:this.data};this._sortRows(sortedColumn,config);this.notify();}
async toggleMeasure(fieldName){const metaData=this._buildMetaData();this.nextActiveMeasures=this.nextActiveMeasures||metaData.activeMeasures;metaData.activeMeasures=this.nextActiveMeasures;const index=metaData.activeMeasures.indexOf(fieldName);if(index!==-1){metaData.activeMeasures.splice(index,1);await Promise.resolve(this.race.getCurrentProm());this.metaData=metaData;}else{metaData.activeMeasures.push(fieldName);const config={metaData,data:this.data};await this._loadData(config);this.useSampleModel=false;}
this.nextActiveMeasures=null;this.notify();}
_addGroup(groupTree,labels,values){let tree=groupTree;values.slice(0,values.length-1).forEach(function(value){tree=tree.directSubTrees.get(value);});const value=values[values.length-1];if(tree.directSubTrees.has(value)){return;}
tree.directSubTrees.set(value,{root:{labels:labels,values:values,},directSubTrees:new Map(),});}
_buildMetaData(params){const metaData=Object.assign({},this.metaData,params);metaData.activeMeasures=[...metaData.activeMeasures];metaData.colGroupBys=[...metaData.colGroupBys];metaData.rowGroupBys=[...metaData.rowGroupBys];metaData.expandedColGroupBys=[...metaData.expandedColGroupBys];metaData.expandedRowGroupBys=[...metaData.expandedRowGroupBys];metaData.customGroupBys=new Map([...metaData.customGroupBys]);metaData.sortedColumn=metaData.sortedColumn?{...metaData.sortedColumn}:null;if(this.searchParams.comparison){const domains=this.searchParams.comparison.domains.slice().reverse();metaData.domains=domains.map((d)=>d.arrayRepr);metaData.origins=domains.map((d)=>d.description);}else{metaData.domains=[this.searchParams.domain];metaData.origins=[""];}
Object.defineProperty(metaData,"fullColGroupBys",{get(){return metaData.colGroupBys.concat(metaData.expandedColGroupBys);},});Object.defineProperty(metaData,"fullRowGroupBys",{get(){return metaData.rowGroupBys.concat(metaData.expandedRowGroupBys);},});return metaData;}
async _expandGroup(groupId,type,config){const{metaData}=config;const group={rowValues:groupId[0],colValues:groupId[1],type:type,};const groupValues=type==="row"?groupId[0]:groupId[1];const groupBys=type==="row"?metaData.fullRowGroupBys:metaData.fullColGroupBys;if(groupValues.length>=groupBys.length){throw new Error("Cannot expand group");}
const groupBy=groupBys[groupValues.length];let leftDivisors;let rightDivisors;if(group.type==="row"){leftDivisors=[[groupBy]];rightDivisors=sections(metaData.fullColGroupBys);}else{leftDivisors=sections(metaData.fullRowGroupBys);rightDivisors=[[groupBy]];}
const divisors=cartesian(leftDivisors,rightDivisors);delete group.type;await this._subdivideGroup(group,divisors,config);}
_findGroup(groupTree,values){let tree=groupTree;values.slice(0,values.length).forEach((value)=>{tree=tree.directSubTrees.get(value);});return tree;}
_getCellValue(groupId,measure,originIndexes,config){var key=JSON.stringify(groupId);if(!config.data.measurements[key]){return;}
var values=originIndexes.map((originIndex)=>{return config.data.measurements[key][originIndex][measure];});if(originIndexes.length>1){return computeVariation(values[1],values[0]);}else{return values[0];}}
_getGroupBySpecs(rowGroupBy,colGroupBy){const set=rowGroupBy.concat(colGroupBy).reduce((acc,gb)=>{acc.add(this._normalize(gb));return acc;},new Set());return[...set];}
_getGroupDomain(group,config){const{data}=config;var key=JSON.stringify([group.rowValues,group.colValues]);return data.groupDomains[key][group.originIndex];}
_getGroupLabels(group,groupBys,config){return groupBys.map((gb)=>{const groupBy=this._normalize(gb);return this._sanitizeLabel(group[groupBy],groupBy,config);});}
async _getGroupSubdivision(group,rowGroupBy,colGroupBy,config){const groupDomain=this._getGroupDomain(group,config);const measureSpecs=this._getMeasureSpecs(config);const groupBy=this._getGroupBySpecs(rowGroupBy,colGroupBy);const kwargs={lazy:false,context:this.searchParams.context};const subGroups=await this.orm.readGroup(config.metaData.resModel,groupDomain,measureSpecs,groupBy,kwargs);return{group:group,subGroups:subGroups,rowGroupBy:rowGroupBy,colGroupBy:colGroupBy,};}
_getGroupValues(group,groupBys){return groupBys.map((gb)=>{const groupBy=this._normalize(gb);return this._sanitizeValue(group[groupBy]);});}
_getLeafCounts(tree){const leafCounts={};let leafCount;if(!tree.directSubTrees.size){leafCount=1;}else{leafCount=[...tree.directSubTrees.values()].reduce((acc,subTree)=>{const subLeafCounts=this._getLeafCounts(subTree);Object.assign(leafCounts,subLeafCounts);return acc+leafCounts[JSON.stringify(subTree.root.values)];},0);}
leafCounts[JSON.stringify(tree.root.values)]=leafCount;return leafCounts;}
_getMeasurements(group,config){const{metaData}=config;return metaData.activeMeasures.reduce((measurements,measureName)=>{var measurement=group[measureName];if(measurement instanceof Array){measurement=1;}
if(metaData.measures[measureName].type==="boolean"&&measurement instanceof Boolean){measurement=measurement?1:0;}
if(metaData.origins.length>1&&!measurement){measurement=0;}
measurements[measureName]=measurement;return measurements;},{});}
_getMeasuresRow(columns){const sortedColumn=this.metaData.sortedColumn||{};const measureRow=[];columns.forEach((column)=>{this.metaData.activeMeasures.forEach((measureName)=>{const measureCell={groupId:column.groupId,height:1,measure:measureName,title:this.metaData.measures[measureName].string,width:2*this.metaData.origins.length-1,};if(sortedColumn.measure===measureName&&JSON.stringify(sortedColumn.groupId)===JSON.stringify(column.groupId)){measureCell.order=sortedColumn.order;}
measureRow.push(measureCell);});});return measureRow;}
_getMeasureSpecs(config){const{metaData}=config;return metaData.activeMeasures.reduce((acc,measure)=>{if(measure==="__count"){acc.push(measure);return acc;}
const field=this.metaData.fields[measure];if(field.type==="many2one"){field.group_operator="count_distinct";}
if(field.group_operator===undefined){throw new Error("No aggregate function has been provided for the measure '"+measure+"'");}
acc.push(measure+":"+field.group_operator);return acc;},[]);}
_getNumberedLabel(label,fieldName,config){const{data}=config;const id=label[0];const name=label[1];data.numbering[fieldName]=data.numbering[fieldName]||{};data.numbering[fieldName][name]=data.numbering[fieldName][name]||{};const numbers=data.numbering[fieldName][name];numbers[id]=numbers[id]||Object.keys(numbers).length+1;return name+(numbers[id]>1?"  ("+numbers[id]+")":"");}
_getOriginsRow(columns){const sortedColumn=this.metaData.sortedColumn||{};const originRow=[];columns.forEach((column)=>{const groupId=column.groupId;const measure=column.measure;const isSorted=sortedColumn.measure===measure&&JSON.stringify(sortedColumn.groupId)===JSON.stringify(groupId);const isSortedByOrigin=isSorted&&!sortedColumn.originIndexes[1];const isSortedByVariation=isSorted&&sortedColumn.originIndexes[1];this.metaData.origins.forEach((origin,originIndex)=>{const originCell={groupId:groupId,height:1,measure:measure,originIndexes:[originIndex],title:origin,width:1,};if(isSortedByOrigin&&sortedColumn.originIndexes[0]===originIndex){originCell.order=sortedColumn.order;}
originRow.push(originCell);if(originIndex>0){const variationCell={groupId:groupId,height:1,measure:measure,originIndexes:[originIndex-1,originIndex],title:_t("Variation"),width:1,};if(isSortedByVariation&&sortedColumn.originIndexes[1]===originIndex){variationCell.order=sortedColumn.order;}
originRow.push(variationCell);}});});return originRow;}
_getTableHeaders(){const colGroupBys=this.metaData.fullColGroupBys;const height=colGroupBys.length+1;const measureCount=this.metaData.activeMeasures.length;const originCount=this.metaData.origins.length;const leafCounts=this._getLeafCounts(this.data.colGroupTree);let headers=[];const measureColumns=[];const colGroupRows=new Array(height).fill(0).map(()=>[]);colGroupRows[0].push({height:height+1+(originCount>1?1:0),title:"",width:1,});function generateTreeHeaders(tree,fields){const group=tree.root;const rowIndex=group.values.length;const row=colGroupRows[rowIndex];const groupId=[[],group.values];const isLeaf=!tree.directSubTrees.size;const leafCount=leafCounts[JSON.stringify(tree.root.values)];const cell={groupId:groupId,height:isLeaf?colGroupBys.length+1-rowIndex:1,isLeaf:isLeaf,isFolded:isLeaf&&colGroupBys.length>group.values.length,label:rowIndex===0?undefined:fields[colGroupBys[rowIndex-1].split(":")[0]].string,title:group.labels.length?group.labels[group.labels.length-1]:_t("Total"),width:leafCount*measureCount*(2*originCount-1),};row.push(cell);if(isLeaf){measureColumns.push(cell);}
[...tree.directSubTrees.values()].forEach((subTree)=>{generateTreeHeaders(subTree,fields);});}
generateTreeHeaders(this.data.colGroupTree,this.metaData.fields);if(leafCounts[JSON.stringify(this.data.colGroupTree.root.values)]>1){var groupId=[[],[]];var totalTopRightCell={groupId:groupId,height:height,title:"",width:measureCount*(2*originCount-1),};colGroupRows[0].push(totalTopRightCell);measureColumns.push(totalTopRightCell);}
headers=headers.concat(colGroupRows);var measuresRow=this._getMeasuresRow(measureColumns);headers.push(measuresRow);if(originCount>1){headers.push(this._getOriginsRow(measuresRow));}
return headers;}
_getTableRows(tree,columns){let rows=[];const group=tree.root;const rowGroupId=[group.values,[]];const title=group.labels.length?group.labels[group.labels.length-1]:_t("Total");const indent=group.labels.length;const isLeaf=!tree.directSubTrees.size;const rowGroupBys=this.metaData.fullRowGroupBys;const subGroupMeasurements=columns.map((column)=>{const colGroupId=column.groupId;const groupIntersectionId=[rowGroupId[0],colGroupId[1]];const measure=column.measure;const originIndexes=column.originIndexes||[0];const value=this._getCellValue(groupIntersectionId,measure,originIndexes,{data:this.data,});const measurement={groupId:groupIntersectionId,originIndexes:originIndexes,measure:measure,value:value,isBold:!groupIntersectionId[0].length||!groupIntersectionId[1].length,};return measurement;});rows.push({title:title,label:indent===0?undefined:this.metaData.fields[rowGroupBys[indent-1].split(":")[0]].string,groupId:rowGroupId,indent:indent,isLeaf:isLeaf,isFolded:isLeaf&&rowGroupBys.length>group.values.length,subGroupMeasurements:subGroupMeasurements,});const subTreeKeys=tree.sortedKeys||[...tree.directSubTrees.keys()];subTreeKeys.forEach((subTreeKey)=>{const subTree=tree.directSubTrees.get(subTreeKey);rows=rows.concat(this._getTableRows(subTree,columns));});return rows;}
_getTreeHeight(tree){const subTreeHeights=[...tree.directSubTrees.values()].map(this._getTreeHeight.bind(this));return Math.max(0,Math.max.apply(null,subTreeHeights))+1;}
_hasData(data){return(data.counts[JSON.stringify([[],[]])]||[]).some((count)=>{return count>0;});}
async _loadData(config,prune=true){config.data={};const{data,metaData}=config;data.rowGroupTree={root:{labels:[],values:[]},directSubTrees:new Map()};data.colGroupTree={root:{labels:[],values:[]},directSubTrees:new Map()};data.measurements={};data.counts={};data.groupDomains={};data.numbering={};const key=JSON.stringify([[],[]]);data.groupDomains[key]=metaData.domains.slice(0);const group={rowValues:[],colValues:[]};const leftDivisors=sections(metaData.fullRowGroupBys);const rightDivisors=sections(metaData.fullColGroupBys);const divisors=cartesian(leftDivisors,rightDivisors);await this._subdivideGroup(group,divisors.slice(0,1),config);await this._subdivideGroup(group,divisors.slice(1),config);if(prune&&this._hasData(data)&&this._hasData(this.data)){if(symmetricalDifference(metaData.rowGroupBys,this.metaData.rowGroupBys).length===0){this._pruneTree(data.rowGroupTree,this.data.rowGroupTree);}
if(symmetricalDifference(metaData.colGroupBys,this.metaData.colGroupBys).length===0){this._pruneTree(data.colGroupTree,this.data.colGroupTree);}}
this.data=config.data;this.metaData=config.metaData;}
_normalize(gb){const[fieldName,interval]=gb.split(":");const field=this.metaData.fields[fieldName];if(["date","datetime"].includes(field.type)){return`${fieldName}:${interval || "month"}`;}else{return fieldName;}}
_prepareData(group,groupSubdivisions,config){const{data,metaData}=config;const groupRowValues=group.rowValues;let groupRowLabels=[];let rowSubTree=data.rowGroupTree;let root;if(groupRowValues.length){rowSubTree=this._findGroup(data.rowGroupTree,groupRowValues);root=rowSubTree.root;groupRowLabels=root.labels;}
const groupColValues=group.colValues;let groupColLabels=[];if(groupColValues.length){root=this._findGroup(data.colGroupTree,groupColValues).root;groupColLabels=root.labels;}
groupSubdivisions.forEach((groupSubdivision)=>{groupSubdivision.subGroups.forEach((subGroup)=>{const rowValues=groupRowValues.concat(this._getGroupValues(subGroup,groupSubdivision.rowGroupBy));const rowLabels=groupRowLabels.concat(this._getGroupLabels(subGroup,groupSubdivision.rowGroupBy,config));const colValues=groupColValues.concat(this._getGroupValues(subGroup,groupSubdivision.colGroupBy));const colLabels=groupColLabels.concat(this._getGroupLabels(subGroup,groupSubdivision.colGroupBy,config));if(!colValues.length&&rowValues.length){this._addGroup(data.rowGroupTree,rowLabels,rowValues);}
if(colValues.length&&!rowValues.length){this._addGroup(data.colGroupTree,colLabels,colValues);}
const key=JSON.stringify([rowValues,colValues]);const originIndex=groupSubdivision.group.originIndex;if(!(key in data.measurements)){data.measurements[key]=metaData.origins.map(()=>{return this._getMeasurements({},config);});}
data.measurements[key][originIndex]=this._getMeasurements(subGroup,config);if(!(key in data.counts)){data.counts[key]=metaData.origins.map(function(){return 0;});}
data.counts[key][originIndex]=subGroup.__count;if(!(key in data.groupDomains)){data.groupDomains[key]=metaData.origins.map(function(){return Domain.FALSE.toList();});}
if(subGroup.__domain){data.groupDomains[key][originIndex]=subGroup.__domain;}});});if(metaData.sortedColumn){this._sortRows(metaData.sortedColumn,config);}}
_pruneTree(tree,oldTree){if(!oldTree.directSubTrees.size){tree.directSubTrees.clear();delete tree.sortedKeys;return;}
[...tree.directSubTrees.keys()].forEach((subTreeKey)=>{const subTree=tree.directSubTrees.get(subTreeKey);if(!oldTree.directSubTrees.has(subTreeKey)){subTree.directSubTrees.clear();delete subTree.sortedKeys;}else{const oldSubTree=oldTree.directSubTrees.get(subTreeKey);this._pruneTree(subTree,oldSubTree);}});}
_getEmptyGroupLabel(fieldName){return _t("None");}
_sanitizeLabel(value,groupBy,config){const{metaData}=config;const fieldName=groupBy.split(":")[0];if(fieldName&&metaData.fields[fieldName]&&metaData.fields[fieldName].type==="boolean"){return value===undefined?_t("None"):value?_t("Yes"):_t("No");}
if(value===false){return this._getEmptyGroupLabel(fieldName);}
if(value instanceof Array){return this._getNumberedLabel(value,fieldName,config);}
if(fieldName&&metaData.fields[fieldName]&&metaData.fields[fieldName].type==="selection"){const selected=metaData.fields[fieldName].selection.find((o)=>o[0]===value);return selected?selected[1]:value;}
return value;}
_sanitizeValue(value){if(value instanceof Array){return value[0];}
return value;}
async _subdivideGroup(group,divisors,config){const{data,metaData}=config;const key=JSON.stringify([group.rowValues,group.colValues]);const proms=metaData.origins.reduce((acc,origin,originIndex)=>{if(!data.counts[key]||data.counts[key][originIndex]>0){const subGroup={rowValues:group.rowValues,colValues:group.colValues,originIndex:originIndex,};divisors.forEach((divisor)=>{acc.push(this._getGroupSubdivision(subGroup,divisor[0],divisor[1],config));});}
return acc;},[]);const groupSubdivisions=await this.keepLast.add(Promise.all(proms));if(groupSubdivisions.length){this._prepareData(group,groupSubdivisions,config);}}
_sortRows(sortedColumn,config){const metaData=config.metaData||this.metaData;const data=config.data||this.data;const colGroupValues=sortedColumn.groupId[1];sortedColumn.originIndexes=sortedColumn.originIndexes||[0];metaData.sortedColumn=sortedColumn;const sortFunction=(tree)=>{return(subTreeKey)=>{const subTree=tree.directSubTrees.get(subTreeKey);const groupIntersectionId=[subTree.root.values,colGroupValues];const value=this._getCellValue(groupIntersectionId,sortedColumn.measure,sortedColumn.originIndexes,{data})||0;return sortedColumn.order==="asc"?value:-value;};};this._sortTree(sortFunction,data.rowGroupTree);}
_sortTree(sortFunction,tree){tree.sortedKeys=sortBy([...tree.directSubTrees.keys()],sortFunction(tree));[...tree.directSubTrees.values()].forEach((subTree)=>{this._sortTree(sortFunction,subTree);});}}
return __exports;});;

/* /web/static/src/views/pivot/pivot_renderer.js */
odoo.define('@web/views/pivot/pivot_renderer',['@web/core/l10n/translation','@web/core/checkbox/checkbox','@web/core/l10n/localization','@web/core/registry','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/views/fields/formatters','@web/views/pivot/pivot_group_by_menu','@odoo/owl','@web/core/network/download','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{CheckBox}=require("@web/core/checkbox/checkbox");const{localization}=require("@web/core/l10n/localization");const{registry}=require("@web/core/registry");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{formatPercentage}=require("@web/views/fields/formatters");const{PivotGroupByMenu}=require("@web/views/pivot/pivot_group_by_menu");const{Component,onWillUpdateProps,useRef}=require("@odoo/owl");const{download}=require("@web/core/network/download");const{useService}=require("@web/core/utils/hooks");const formatters=registry.category("formatters");const PivotRenderer=__exports.PivotRenderer=class PivotRenderer extends Component{setup(){this.actionService=useService("action");this.model=this.props.model;this.table=this.model.getTable();this.l10n=localization;this.tableRef=useRef("table");onWillUpdateProps(this.onWillUpdateProps);}
onWillUpdateProps(){this.table=this.model.getTable();}
getFormattedValue(cell){const field=this.model.metaData.measures[cell.measure];let formatType=this.model.metaData.widgets[cell.measure];if(!formatType){const fieldType=field.type;formatType=["many2one","reference"].includes(fieldType)?"integer":fieldType;}
const formatter=formatters.get(formatType);return formatter(cell.value,field);}
getFormattedVariation(cell){if(isNaN(cell.value)){return"-";}
return formatPercentage(cell.value,this.model.metaData.fields[cell.measure]);}
getPadding(cell){return 5+cell.indent*30;}
onAddCustomGroupBy(type,groupId,fieldName){this.model.addGroupBy({groupId,fieldName,custom:true,type});}
onGroupBySelected(type,payload){this.model.addGroupBy({...payload,type});}
onHeaderClick(cell,type){if(cell.isLeaf&&cell.isFolded){this.model.expandGroup(cell.groupId,type);}else if(!cell.isLeaf){this.model.closeGroup(cell.groupId,type);}}
onMeasureClick(cell){this.model.sortRows({groupId:cell.groupId,measure:cell.measure,order:(cell.order||"desc")==="asc"?"desc":"asc",originIndexes:cell.originIndexes,});}
onMouseEnter(ev){var index=[...ev.currentTarget.parentNode.children].indexOf(ev.currentTarget);if(ev.currentTarget.tagName==="TH"){if(!ev.currentTarget.classList.contains("o_pivot_origin_row")&&this.model.metaData.origins.length===2){index=3*index;}
index+=1;}
this.tableRef.el.querySelectorAll("td:nth-child("+(index+1)+")").forEach((elt)=>elt.classList.add("o_cell_hover"));}
onMouseLeave(){this.tableRef.el.querySelectorAll(".o_cell_hover").forEach((elt)=>elt.classList.remove("o_cell_hover"));}
onDownloadButtonClicked(){if(this.model.getTableWidth()>16384){throw new Error(_t("For Excel compatibility, data cannot be exported if there are more than 16384 columns.\n\nTip: try to flip axis, filter further or reduce the number of measures."));}
const table=this.model.exportData();download({url:"/web/pivot/export_xlsx",data:{data:JSON.stringify(table)},});}
onExpandButtonClicked(){this.model.expandAll();}
onFlipButtonClicked(){this.model.flip();}
onMeasureSelected({measure}){this.model.toggleMeasure(measure);}
openView(domain,views,context){this.actionService.doAction({type:"ir.actions.act_window",name:this.model.metaData.title,res_model:this.model.metaData.resModel,views:views,view_mode:"list",target:"current",context,domain,});}
onOpenView(cell){if(cell.value===undefined||this.model.metaData.disableLinking){return;}
const context=Object.assign({},this.model.searchParams.context);Object.keys(context).forEach((x)=>{if(x==="group_by"||x.startsWith("search_default_")){delete context[x];}});const{views=[]}=this.env.config;this.views=["list","form"].map((viewType)=>{const view=views.find((view)=>view[1]===viewType);return[view?view[0]:false,viewType];});const group={rowValues:cell.groupId[0],colValues:cell.groupId[1],originIndex:cell.originIndexes[0],};this.openView(this.model.getGroupDomain(group),this.views,context);}}
PivotRenderer.template="web.PivotRenderer";PivotRenderer.components={Dropdown,DropdownItem,CheckBox,PivotGroupByMenu};PivotRenderer.props=["model","buttonTemplate?"];PivotRenderer.defaultProps={buttonTemplate:"web.PivotView.Buttons",};return __exports;});;

/* /web/static/src/views/pivot/pivot_search_model.js */
odoo.define('@web/views/pivot/pivot_search_model',['@web/search/search_model'],function(require){'use strict';let __exports={};const{SearchModel}=require("@web/search/search_model");const PivotSearchModel=__exports.PivotSearchModel=class PivotSearchModel extends SearchModel{_getIrFilterDescription(){this.preparingIrFilterDescription=true;const result=super._getIrFilterDescription(...arguments);this.preparingIrFilterDescription=false;return result;}
_getSearchItemGroupBys(activeItem){const{searchItemId}=activeItem;const{context,type}=this.searchItems[searchItemId];if(!this.preparingIrFilterDescription&&type==="favorite"&&context.pivot_row_groupby){return context.pivot_row_groupby;}
return super._getSearchItemGroupBys(...arguments);}}
return __exports;});;

/* /web/static/src/views/pivot/pivot_view.js */
odoo.define('@web/views/pivot/pivot_view',['@web/core/l10n/translation','@web/core/registry','@web/views/pivot/pivot_arch_parser','@web/views/pivot/pivot_controller','@web/views/pivot/pivot_model','@web/views/pivot/pivot_renderer','@web/views/pivot/pivot_search_model'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{PivotArchParser}=require("@web/views/pivot/pivot_arch_parser");const{PivotController}=require("@web/views/pivot/pivot_controller");const{PivotModel}=require("@web/views/pivot/pivot_model");const{PivotRenderer}=require("@web/views/pivot/pivot_renderer");const{PivotSearchModel}=require("@web/views/pivot/pivot_search_model");const viewRegistry=registry.category("views");const pivotView=__exports.pivotView={type:"pivot",display_name:_t("Pivot"),icon:"oi oi-view-pivot",multiRecord:true,Controller:PivotController,Renderer:PivotRenderer,Model:PivotModel,ArchParser:PivotArchParser,SearchModel:PivotSearchModel,searchMenuTypes:["filter","groupBy","comparison","favorite"],props:(genericProps,view)=>{const modelParams={};if(genericProps.state){modelParams.data=genericProps.state.data;modelParams.metaData=genericProps.state.metaData;}else{const{arch,fields,resModel}=genericProps;const archInfo=new view.ArchParser().parse(arch);if(!archInfo.activeMeasures.length||archInfo.displayQuantity){archInfo.activeMeasures.unshift("__count");}
modelParams.metaData={activeMeasures:archInfo.activeMeasures,colGroupBys:archInfo.colGroupBys,defaultOrder:archInfo.defaultOrder,disableLinking:Boolean(archInfo.disableLinking),fields:fields,fieldAttrs:archInfo.fieldAttrs,resModel:resModel,rowGroupBys:archInfo.rowGroupBys,title:archInfo.title||_t("Untitled"),widgets:archInfo.widgets,};}
return{...genericProps,Model:view.Model,modelParams,Renderer:view.Renderer,};},};viewRegistry.add("pivot",pivotView);return __exports;});;

/* /web/static/src/views/standard_view_props.js */
odoo.define('@web/views/standard_view_props',[],function(require){'use strict';let __exports={};const standardViewProps=__exports.standardViewProps={info:{type:Object,},resModel:String,arch:{type:Element},bannerRoute:{type:String,optional:true},className:{type:String,optional:true},comparison:{type:[Object,{value:null}],optional:true},context:{type:Object},createRecord:{type:Function,optional:true},display:{type:Object,optional:true},domain:{type:Array},fields:{type:Object},globalState:{type:Object,optional:true},groupBy:{type:Array,element:String},limit:{type:Number,optional:true},noBreadcrumbs:{type:Boolean,optional:true},orderBy:{type:Array,element:Object},relatedModels:{type:Object,optional:true},resId:{type:[Number,Boolean],optional:true},resIds:{type:Array,optional:true},searchMenuTypes:{type:Array,element:String},selectRecord:{type:Function,optional:true},state:{type:Object,optional:true},useSampleModel:{type:Boolean},};return __exports;});;

/* /web/static/src/views/utils.js */
odoo.define('@web/views/utils',['@web/core/l10n/translation','@web/core/registry','@web/model/relational_model/utils'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{registry}=require("@web/core/registry");const{combineModifiers}=require("@web/model/relational_model/utils");const X2M_TYPES=__exports.X2M_TYPES=["one2many","many2many"];const NUMERIC_TYPES=["integer","float","monetary"];const BUTTON_CLICK_PARAMS=__exports.BUTTON_CLICK_PARAMS=["name","type","args","context","close","confirm","confirm-title","confirm-label","special","effect","help","debounce","noSaveDialog",];__exports.archParseBoolean=archParseBoolean;function archParseBoolean(str,trueIfEmpty=false){return str?!/^false|0$/i.test(str):trueIfEmpty;}
function getViewClass(type){const isValidType=Boolean(type)&&registry.category("views").contains(type);return isValidType&&`o_${type}_view`;}
__exports.computeViewClassName=computeViewClassName;function computeViewClassName(viewType,rootNode,additionalClassList=[]){const subType=rootNode?.getAttribute("js_class");const classList=rootNode?.getAttribute("class")?.split(" ")||[];const uniqueClasses=new Set([getViewClass(viewType),getViewClass(subType),...classList,...additionalClassList,]);return Array.from(uniqueClasses).filter((c)=>c).join(" ");}
const computeReportMeasures=__exports.computeReportMeasures=(fields,fieldAttrs,activeMeasures)=>{const measures={__count:{name:"__count",string:_t("Count"),type:"integer"},};for(const[fieldName,field]of Object.entries(fields)){if(fieldName==="id"||!field.store){continue;}
const{isInvisible}=fieldAttrs[fieldName]||{};if(isInvisible){continue;}
if(["integer","float","monetary"].includes(field.type)&&field.group_operator!==undefined){measures[fieldName]=field;}}
for(const measure of activeMeasures){if(!measures[measure]){measures[measure]=fields[measure];}}
for(const fieldName in fieldAttrs){if(fieldAttrs[fieldName].string&&fieldName in measures){measures[fieldName].string=fieldAttrs[fieldName].string;}}
const sortedMeasures=Object.entries(measures).sort(([m1,f1],[m2,f2])=>{if(m1==="__count"||m2==="__count"){return m1==="__count"?1:-1;}
return f1.string.toLowerCase().localeCompare(f2.string.toLowerCase());});return Object.fromEntries(sortedMeasures);};__exports.getFormattedValue=getFormattedValue;function getFormattedValue(record,fieldName,attrs){const field=record.fields[fieldName];const formatter=registry.category("formatters").get(field.type,(val)=>val);const formatOptions={escape:false,data:record.data,isPassword:"password"in attrs,digits:attrs.digits?JSON.parse(attrs.digits):field.digits,field:record.fields[fieldName],};return record.data[fieldName]!==undefined?formatter(record.data[fieldName],formatOptions):"";}
__exports.getActiveActions=getActiveActions;function getActiveActions(rootNode){const activeActions={type:"view",edit:archParseBoolean(rootNode.getAttribute("edit"),true),create:archParseBoolean(rootNode.getAttribute("create"),true),delete:archParseBoolean(rootNode.getAttribute("delete"),true),};activeActions.duplicate=activeActions.create&&archParseBoolean(rootNode.getAttribute("duplicate"),true);return activeActions;}
__exports.getClassNameFromDecoration=getClassNameFromDecoration;function getClassNameFromDecoration(decoration){if(decoration==="bf"){return"fw-bold";}else if(decoration==="it"){return"fst-italic";}
return`text-${decoration}`;}
__exports.getDecoration=getDecoration;function getDecoration(rootNode){const decorations=[];for(const name of rootNode.getAttributeNames()){if(name.startsWith("decoration-")){decorations.push({class:getClassNameFromDecoration(name.replace("decoration-","")),condition:rootNode.getAttribute(name),});}}
return decorations;}
__exports.isX2Many=isX2Many;function isX2Many(field){return field&&X2M_TYPES.includes(field.type);}
__exports.isNumeric=isNumeric;function isNumeric(field){return NUMERIC_TYPES.includes(field.type);}
__exports.isNull=isNull;function isNull(value){return[null,undefined].includes(value);}
__exports.processButton=processButton;function processButton(node){const withDefault={close:(val)=>archParseBoolean(val,false),context:(val)=>val||"{}",};const clickParams={};for(const{name,value}of node.attributes){if(BUTTON_CLICK_PARAMS.includes(name)){clickParams[name]=withDefault[name]?withDefault[name](value):value;}}
return{className:node.getAttribute("class")||"",disabled:!!node.getAttribute("disabled")||false,icon:node.getAttribute("icon")||false,title:node.getAttribute("title")||undefined,string:node.getAttribute("string")||undefined,options:JSON.parse(node.getAttribute("options")||"{}"),display:node.getAttribute("display")||"selection",clickParams,column_invisible:node.getAttribute("column_invisible"),invisible:combineModifiers(node.getAttribute("column_invisible"),node.getAttribute("invisible"),"OR"),readonly:node.getAttribute("readonly"),required:node.getAttribute("required"),};}
__exports.processMeasure=processMeasure;function processMeasure(measure){if(Array.isArray(measure)){return measure.map(processMeasure);}
return measure==="__count__"?"__count":measure;}
__exports.toStringExpression=toStringExpression;function toStringExpression(str){return`\`${str.replaceAll("`", "\\`")}\``;}
__exports.uuid=uuid;function uuid(){const array=new Uint8Array(8);window.crypto.getRandomValues(array);return[...array].map((b)=>b.toString(16).padStart(2,"0")).join("");}
return __exports;});;

/* /web/static/src/views/view.js */
odoo.define('@web/views/view',['@web/core/py_js/py','@web/core/registry','@web/core/utils/concurrency','@web/core/utils/hooks','@web/core/utils/objects','@web/core/utils/strings','@web/core/utils/xml','@web/search/layout','@web/search/with_search/with_search','@web/views/onboarding_banner','@web/views/view_hook','@web/views/utils','@odoo/owl'],function(require){'use strict';let __exports={};const{evaluateBooleanExpr}=require("@web/core/py_js/py");const{registry}=require("@web/core/registry");const{KeepLast}=require("@web/core/utils/concurrency");const{useService}=require("@web/core/utils/hooks");const{deepCopy,pick}=require("@web/core/utils/objects");const{nbsp}=require("@web/core/utils/strings");const{parseXML}=require("@web/core/utils/xml");const{extractLayoutComponents}=require("@web/search/layout");const{WithSearch}=require("@web/search/with_search/with_search");const{OnboardingBanner}=require("@web/views/onboarding_banner");const{useActionLinks}=require("@web/views/view_hook");const{computeViewClassName}=require("@web/views/utils");const{Component,markRaw,onWillUpdateProps,onWillStart,toRaw,useSubEnv,reactive,}=require("@odoo/owl");const viewRegistry=registry.category("views");__exports.getDefaultConfig=getDefaultConfig;function getDefaultConfig(){let displayName;const config={actionId:false,actionType:false,actionFlags:{},breadcrumbs:reactive([{get name(){return displayName;},},]),disableSearchBarAutofocus:false,getDisplayName:()=>displayName,historyBack:()=>{},pagerProps:{},setDisplayName:(newDisplayName)=>{displayName=newDisplayName;config.breadcrumbs.push(undefined);config.breadcrumbs.pop();},viewSwitcherEntries:[],views:[],Banner:OnboardingBanner,};return config;}
const ViewNotFoundError=__exports.ViewNotFoundError=class ViewNotFoundError extends Error{}
const CALLBACK_RECORDER_NAMES=["__beforeLeave__","__getGlobalState__","__getLocalState__","__getContext__","__getOrderBy__",];const STANDARD_PROPS=["resModel","type","arch","fields","relatedModels","viewId","views","actionMenus","loadActionMenus","searchViewArch","searchViewFields","searchViewId","irFilters","loadIrFilters","comparison","context","domain","groupBy","orderBy","useSampleModel","noContentHelp","className","display","globalState","activateFavorite","dynamicFilters","hideCustomGroupBy","searchMenuTypes",...CALLBACK_RECORDER_NAMES,"searchPanel","searchModel",];const ACTIONS=["create","delete","edit","group_create","group_delete","group_edit"];const View=__exports.View=class View extends Component{setup(){const{arch,fields,resModel,searchViewArch,searchViewFields,type}=this.props;if(!resModel){throw Error(`View props should have a "resModel" key`);}
if(!type){throw Error(`View props should have a "type" key`);}
if((arch&&!fields)||(!arch&&fields)){throw new Error(`"arch" and "fields" props must be given together`);}
if((searchViewArch&&!searchViewFields)||(!searchViewArch&&searchViewFields)){throw new Error(`"searchViewArch" and "searchViewFields" props must be given together`);}
this.viewService=useService("view");this.withSearchProps=null;useSubEnv({keepLast:new KeepLast(),config:{...getDefaultConfig(),...this.env.config,},...Object.fromEntries(CALLBACK_RECORDER_NAMES.map((name)=>[name,this.props[name]||null])),});this.handleActionLinks=useActionLinks({resModel});onWillStart(()=>this.loadView(this.props));onWillUpdateProps((nextProps)=>this.onWillUpdateProps(nextProps));}
async loadView(props){let descr=viewRegistry.get(props.type);const type=descr.type;let{viewId,searchViewId}=props;const views=deepCopy(props.views||this.env.config.views);const view=views.find((v)=>v[1]===type)||[];if(view.length){view[0]=viewId!==undefined?viewId:view[0];viewId=view[0];}else{view.push(viewId||false,type);views.push(view);}
const searchView=views.find((v)=>v[1]==="search");if(searchView){searchView[0]=searchViewId!==undefined?searchViewId:searchView[0];searchViewId=searchView[0];}else if(searchViewId!==undefined){views.push([searchViewId,"search"]);}
const{context,resModel,loadActionMenus,loadIrFilters}=props;let{arch,fields,relatedModels,searchViewArch,searchViewFields,irFilters,actionMenus,}=props;const loadView=!arch||(!actionMenus&&loadActionMenus);const loadSearchView=(searchViewId!==undefined&&!searchViewArch)||(!irFilters&&loadIrFilters);let viewDescription={viewId,resModel,type};let searchViewDescription;if(loadView||loadSearchView){const result=await this.viewService.loadViews({context,resModel,views},{actionId:this.env.config.actionId,loadActionMenus,loadIrFilters});viewDescription=result.views[type];searchViewDescription=result.views.search;if(loadSearchView){searchViewId=searchViewId||searchViewDescription.id;if(!searchViewArch){searchViewArch=searchViewDescription.arch;searchViewFields=result.fields;}
if(!irFilters){irFilters=searchViewDescription.irFilters;}}
this.env.config.views=views;fields=fields||markRaw(result.fields);relatedModels=relatedModels||markRaw(result.relatedModels);}
if(!arch){arch=viewDescription.arch;}
if(!actionMenus){actionMenus=viewDescription.actionMenus;}
const archXmlDoc=parseXML(arch.replace(/&amp;nbsp;/g,nbsp));for(const action of ACTIONS){if(action in this.props.context&&!this.props.context[action]){archXmlDoc.setAttribute(action,"0");}}
let subType=archXmlDoc.getAttribute("js_class");const bannerRoute=archXmlDoc.getAttribute("banner_route");const sample=archXmlDoc.getAttribute("sample");const className=computeViewClassName(type,archXmlDoc,["o_view_controller",...(props.className||"").split(" "),]);if(subType){if(viewRegistry.contains(subType)){descr=viewRegistry.get(subType);}else{subType=null;}}
Object.assign(this.env.config,{viewArch:archXmlDoc,viewId:viewDescription.id,viewType:type,viewSubType:subType,bannerRoute,noBreadcrumbs:props.noBreadcrumbs,...extractLayoutComponents(descr),});const info={actionMenus,mode:props.display.mode,irFilters,searchViewArch,searchViewFields,searchViewId,};const viewProps={info,arch:archXmlDoc,fields,relatedModels,resModel,useSampleModel:false,className,};if(viewDescription.custom_view_id){viewProps.info.customViewId=viewDescription.custom_view_id;}
if(props.globalState){viewProps.globalState=props.globalState;}
if("useSampleModel"in props){viewProps.useSampleModel=props.useSampleModel;}else if(sample){viewProps.useSampleModel=evaluateBooleanExpr(sample);}
for(const key in props){if(!STANDARD_PROPS.includes(key)){viewProps[key]=props[key];}}
const{noContentHelp}=props;if(noContentHelp){viewProps.info.noContentHelp=noContentHelp;}
const searchMenuTypes=props.searchMenuTypes||descr.searchMenuTypes||this.constructor.searchMenuTypes;viewProps.searchMenuTypes=searchMenuTypes;const finalProps=descr.props?descr.props(viewProps,descr,this.env.config):viewProps;this.Controller=descr.Controller;this.componentProps=finalProps;this.withSearchProps={...toRaw(props),hideCustomGroupBy:props.hideCustomGroupBy||descr.hideCustomGroupBy,searchMenuTypes,SearchModel:descr.SearchModel,};if(searchViewId!==undefined){this.withSearchProps.searchViewId=searchViewId;}
if(searchViewArch){this.withSearchProps.searchViewArch=searchViewArch;this.withSearchProps.searchViewFields=searchViewFields;}
if(irFilters){this.withSearchProps.irFilters=irFilters;}
if(descr.display){const viewDisplay=deepCopy(descr.display);const display={...this.withSearchProps.display};for(const key in viewDisplay){if(typeof display[key]==="object"){Object.assign(display[key],viewDisplay[key]);}else if(!(key in display)||display[key]){display[key]=viewDisplay[key];}}
this.withSearchProps.display=display;}
for(const key in this.withSearchProps){if(!(key in WithSearch.props)){delete this.withSearchProps[key];}}}
onWillUpdateProps(nextProps){const oldProps=pick(this.props,"arch","type","resModel");const newProps=pick(nextProps,"arch","type","resModel");if(JSON.stringify(oldProps)!==JSON.stringify(newProps)){return this.loadView(nextProps);}
const{comparison,context,domain,groupBy,orderBy}=nextProps;Object.assign(this.withSearchProps,{comparison,context,domain,groupBy,orderBy});}}
View._download=async function(){};View.template="web.View";View.components={WithSearch};View.defaultProps={display:{},context:{},loadActionMenus:false,loadIrFilters:false,className:"",};View.props={"*":true,};View.searchMenuTypes=["filter","groupBy","favorite"];return __exports;});;

/* /web/static/src/views/view_button/multi_record_view_button.js */
odoo.define('@web/views/view_button/multi_record_view_button',['@web/views/view_button/view_button'],function(require){'use strict';let __exports={};const{ViewButton}=require("@web/views/view_button/view_button");const MultiRecordViewButton=__exports.MultiRecordViewButton=class MultiRecordViewButton extends ViewButton{async onClick(){const{clickParams,list}=this.props;const resIds=await list.getResIds(true);clickParams.buttonContext={active_domain:this.props.domain,active_ids:resIds,active_model:list.resModel,};this.env.onClickViewButton({clickParams,getResParams:()=>({context:list.context,evalContext:list.evalContext,resModel:list.resModel,resIds,}),});}}
MultiRecordViewButton.props=[...ViewButton.props,"list","domain"];return __exports;});;

/* /web/static/src/views/view_button/view_button.js */
odoo.define('@web/views/view_button/view_button',['@web/core/dropdown/dropdown','@web/core/utils/objects','@web/core/utils/timing','@odoo/owl'],function(require){'use strict';let __exports={};const{DROPDOWN}=require("@web/core/dropdown/dropdown");const{pick}=require("@web/core/utils/objects");const{debounce:debounceFn}=require("@web/core/utils/timing");const{Component}=require("@odoo/owl");const explicitRankClasses=["btn-primary","btn-secondary","btn-link","btn-success","btn-info","btn-warning","btn-danger",];const odooToBootstrapClasses={oe_highlight:"btn-primary",oe_link:"btn-link",};function iconFromString(iconString){const icon={};if(iconString.startsWith("fa-")){icon.tag="i";icon.class=`o_button_icon fa fa-fw ${iconString}`;}else if(iconString.startsWith("oi-")){icon.tag="i";icon.class=`o_button_icon oi oi-fw ${iconString}`;}else{icon.tag="img";icon.src=iconString;}
return icon;}
const ViewButton=__exports.ViewButton=class ViewButton extends Component{setup(){if(this.props.icon){this.icon=iconFromString(this.props.icon);}
const{debounce}=this.clickParams;if(debounce){this.onClick=debounceFn(this.onClick.bind(this),debounce,true);}
this.tooltip=JSON.stringify({debug:Boolean(odoo.debug),button:{string:this.props.string,help:this.clickParams.help,context:this.clickParams.context,invisible:this.props.attrs?.invisible,column_invisible:this.props.attrs?.column_invisible,readonly:this.props.attrs?.readonly,required:this.props.attrs?.required,special:this.clickParams.special,type:this.clickParams.type,name:this.clickParams.name,title:this.props.title,},context:this.props.record&&this.props.record.context,model:(this.props.record&&this.props.record.resModel)||this.props.resModel,});}
get clickParams(){return{context:this.props.context,...this.props.clickParams};}
get hasBigTooltip(){return Boolean(odoo.debug)||this.clickParams.help;}
get hasSmallToolTip(){return!this.hasBigTooltip&&this.props.title;}
get disabled(){const{name,type,special}=this.clickParams;return(!name&&!type&&!special)||this.props.disabled;}
onClick(ev){if(this.props.tag==="a"){ev.preventDefault();}
if(this.props.onClick){return this.props.onClick();}
this.env.onClickViewButton({clickParams:this.clickParams,getResParams:()=>pick(this.props.record,"context","evalContext","resModel","resId","resIds"),beforeExecute:()=>{if(this.env[DROPDOWN]){this.env[DROPDOWN].close();}},});}
getClassName(){const classNames=[];let hasExplicitRank=false;if(this.props.className){for(let cls of this.props.className.split(" ")){if(cls in odooToBootstrapClasses){cls=odooToBootstrapClasses[cls];}
classNames.push(cls);if(!hasExplicitRank&&explicitRankClasses.includes(cls)){hasExplicitRank=true;}}}
if(this.props.tag==="button"){const hasOtherClasses=classNames.length;classNames.unshift("btn");if((!hasExplicitRank&&this.props.defaultRank)||!hasOtherClasses){classNames.push(this.props.defaultRank||"btn-secondary");}
if(this.props.size){classNames.push(`btn-${this.props.size}`);}}
return classNames.join(" ");}}
ViewButton.template="views.ViewButton";ViewButton.props=["id?","tag?","record?","attrs?","className?","context?","clickParams?","icon?","defaultRank?","disabled?","size?","tabindex?","title?","style?","string?","slots?","onClick?",];ViewButton.defaultProps={tag:"button",className:"",clickParams:{},};return __exports;});;

/* /web/static/src/views/view_button/view_button_hook.js */
odoo.define('@web/views/view_button/view_button_hook',['@web/core/utils/hooks','@web/core/py_js/py','@web/core/confirmation_dialog/confirmation_dialog','@odoo/owl'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{evaluateExpr}=require("@web/core/py_js/py");const{ConfirmationDialog}=require("@web/core/confirmation_dialog/confirmation_dialog");const{status,useComponent,useEnv,useSubEnv}=require("@odoo/owl");__exports.executeButtonCallback=executeButtonCallback;async function executeButtonCallback(el,fct){let btns=[];function disableButtons(){btns=[...btns,...el.querySelectorAll("button:not([disabled])")];for(const btn of btns){btn.setAttribute("disabled","1");}}
function enableButtons(){for(const btn of btns){btn.removeAttribute("disabled");}}
disableButtons();let res;try{res=await fct();}finally{enableButtons();}
return res;}
function undefinedAsTrue(val){return typeof val==="undefined"||val;}
__exports.useViewButtons=useViewButtons;function useViewButtons(model,ref,options={}){const action=useService("action");const dialog=useService("dialog");const comp=useComponent();const env=useEnv();const beforeExecuteAction=options.beforeExecuteAction||(()=>{return true;});const afterExecuteAction=options.afterExecuteAction||(()=>{});useSubEnv({async onClickViewButton({clickParams,getResParams,beforeExecute}){async function execute(){let _continue=true;if(beforeExecute){_continue=undefinedAsTrue(await beforeExecute());}
_continue=_continue&&undefinedAsTrue(await beforeExecuteAction(clickParams));if(!_continue){return;}
const closeDialog=(clickParams.close||clickParams.special)&&env.dialogData?.close;const params=getResParams();const resId=params.resId;const resIds=params.resIds||model.resIds;let buttonContext={};if(clickParams.context){if(typeof clickParams.context==="string"){buttonContext=evaluateExpr(clickParams.context,params.evalContext);}else{buttonContext=clickParams.context;}}
if(clickParams.buttonContext){Object.assign(buttonContext,clickParams.buttonContext);}
const doActionParams=Object.assign({},clickParams,{resModel:params.resModel||model.resModel,resId,resIds,context:params.context||{},buttonContext,onClose:async()=>{if(!closeDialog&&status(comp)!=="destroyed"){const reload=options.reload||(()=>model.load());await reload();}},});let error;try{await action.doActionButton(doActionParams);}catch(_e){error=_e;}
await afterExecuteAction(clickParams);if(closeDialog){closeDialog();}
if(error){return Promise.reject(error);}}
if(clickParams.confirm){executeButtonCallback(getEl(),async()=>{await new Promise((resolve)=>{const dialogProps={...(clickParams["confirm-title"]&&{title:clickParams["confirm-title"],}),...(clickParams["confirm-label"]&&{confirmLabel:clickParams["confirm-label"],}),body:clickParams.confirm,confirm:()=>execute(),cancel:()=>{},};dialog.add(ConfirmationDialog,dialogProps,{onClose:resolve});});});}else{return executeButtonCallback(getEl(),execute);}},});function getEl(){if(env.inDialog){const el=ref.el;return el?el.closest(".modal"):null;}else{return ref.el;}}}
return __exports;});;

/* /web/static/src/views/view_compiler.js */
odoo.define('@web/views/view_compiler',['@web/core/utils/xml','@web/views/utils','@odoo/owl'],function(require){'use strict';let __exports={};const{append,combineAttributes,createElement,createTextNode,getTag,}=require("@web/core/utils/xml");const{toStringExpression,BUTTON_CLICK_PARAMS}=require("@web/views/utils");const{xml}=require("@odoo/owl");const BUTTON_STRING_PROPS=["string","size","title","icon","id"];const INTERP_REGEXP=/(\{\{|#\{)(.*?)(\}{1,2})/g;__exports.toInterpolatedStringExpression=toInterpolatedStringExpression;function toInterpolatedStringExpression(str){const matches=str.matchAll(INTERP_REGEXP);const parts=[];let searchString=str;for(const[match,head,expr]of matches){const index=searchString.indexOf(head);const left=searchString.slice(0,index);if(left){parts.push(toStringExpression(left));}
parts.push(`(${expr})`);searchString=searchString.slice(index+match.length);}
parts.push(toStringExpression(searchString));return parts.join("+");}
__exports.appendAttr=appendAttr;function appendAttr(el,attr,string){const attrKey=`t-att-${attr}`;const attrVal=el.getAttribute(attrKey);el.setAttribute(attrKey,appendToStringifiedObject(attrVal,string));}
function appendToStringifiedObject(originalTattr,string){const re=/{(.*)}/;const oldString=re.exec(originalTattr);if(oldString){string=`${oldString[1]},${string}`;}
return`{${string}}`;}
__exports.assignOwlDirectives=assignOwlDirectives;function assignOwlDirectives(target,...sources){for(const source of sources){for(const{name,value}of source.attributes){if(name.startsWith("t-attf-")){const propName=name.slice(7);const interpolatedExpression=toInterpolatedStringExpression(value);target.setAttribute(propName,interpolatedExpression);}else if(name.startsWith("t-att-")){const propName=name.slice(6);target.setAttribute(propName,value);}else if(name.startsWith("t-")){target.setAttribute(name,value);}}}
return target;}
__exports.copyAttributes=copyAttributes;function copyAttributes(el,compiled){const isComponent=isComponentNode(compiled);const classes=el.className;if(classes){if(isComponent){const cls=compiled.className;compiled.setAttribute("class",cls?`'${classes} ' + ${cls}`:`'${classes}'`);}else{compiled.classList.add(...classes.split(/\s+/).filter(Boolean));}}
let att=el.getAttribute("style");if(att){if(isComponent){att=toStringExpression(att);}
compiled.setAttribute("style",att);}}
__exports.decodeObjectForTemplate=decodeObjectForTemplate;function decodeObjectForTemplate(str){return JSON.parse(decodeURI(str));}
__exports.encodeObjectForTemplate=encodeObjectForTemplate;function encodeObjectForTemplate(obj){return`"${encodeURI(JSON.stringify(obj))}"`;}
__exports.getModifier=getModifier;function getModifier(el,modifierName){return el.getAttribute(modifierName);}
function getTitleTag(node){return getTag(node)[0].toUpperCase()+getTag(node).slice(1);}
function isComment(node){return node.nodeType===8;}
__exports.isComponentNode=isComponentNode;function isComponentNode(el){return(getTag(el)===getTitleTag(el)||(getTag(el,true)==="t"&&"t-component"in el.attributes));}
__exports.isTextNode=isTextNode;function isTextNode(node){return node.nodeType===3;}
__exports.makeSeparator=makeSeparator;function makeSeparator(title){const separator=createElement("div");separator.className="o_horizontal_separator mt-4 mb-3 text-uppercase fw-bolder small";separator.textContent=title;return separator;}
const ViewCompiler=__exports.ViewCompiler=class ViewCompiler{constructor(templates){this.id=1;this.compilers=[{selector:"a[type]:not([data-bs-toggle]),a[data-type]:not([data-bs-toggle])",fn:this.compileButton,},{selector:"button:not([data-bs-toggle])",fn:this.compileButton,doNotCopyAttributes:true,},{selector:"field",fn:this.compileField},{selector:"widget",fn:this.compileWidget},];this.templates=templates;this.ctx={readonly:"__comp__.props.readonly"};this.owlDirectiveRegexesWhitelist=this.constructor.OWL_DIRECTIVE_WHITELIST.map((d)=>new RegExp(d));this.setup();}
setup(){}
applyInvisible(invisible,compiled,params){if(!invisible||invisible==="False"){return compiled;}
if(invisible==="True"||invisible==="1"){return;}
const recordExpr=params.recordExpr||"__comp__.props.record";let isVisileExpr=`!__comp__.evaluateBooleanExpr(${JSON.stringify(
            invisible
        )},${recordExpr}.evalContextWithVirtualIds)`;if(compiled.hasAttribute("t-if")){const formerTif=compiled.getAttribute("t-if");isVisileExpr=`( ${formerTif} ) and ${isVisileExpr}`;}
compiled.setAttribute("t-if",isVisileExpr);return compiled;}
compile(key,params={}){const root=this.templates[key].cloneNode(true);const child=this.compileNode(root,params);const newRoot=createElement("t",[child]);newRoot.setAttribute("t-translation","off");return newRoot;}
compileNode(node,params={},evalInvisible=true){if(isComment(node)){return;}
if(isTextNode(node)){return createTextNode(node.nodeValue);}
this.validateNode(node);let invisible;if(evalInvisible){invisible=getModifier(node,"invisible");if(!params.compileInvisibleNodes&&(invisible==="True"||invisible==="1")){return;}}
const compiler=this.compilers.find((cp)=>node.matches(cp.selector));let compiledNode;if(compiler){compiledNode=compiler.fn.call(this,node,params);if(!compiler.doNotCopyAttributes&&compiledNode){copyAttributes(node,compiledNode);}}else{compiledNode=this.compileGenericNode(node,params);}
if(evalInvisible&&compiledNode){compiledNode=this.applyInvisible(invisible,compiledNode,params);}
return compiledNode;}
compileButton(el,params){let tag=getTag(el,true);const type=el.getAttribute("type");if(tag==="a"&&type==="url"){tag="button";}
const recordExpr=params.recordExpr||"__comp__.props.record";const button=createElement("ViewButton",{tag:toStringExpression(tag),record:recordExpr,});assignOwlDirectives(button,el);combineAttributes(button,"className",[toStringExpression(el.className),button.className],"+` `+");el.removeAttribute("class");button.removeAttribute("class");const clickParams={};const attrs={};for(const{name,value}of el.attributes){if(BUTTON_CLICK_PARAMS.includes(name)){clickParams[name]=value;}else if(BUTTON_STRING_PROPS.includes(name)){button.setAttribute(name,toStringExpression(value));}else if(!name.startsWith("t-")){attrs[name]=value;}}
button.setAttribute("clickParams",JSON.stringify(clickParams));button.setAttribute("attrs",JSON.stringify(attrs));const buttonContent=[];for(const child of el.childNodes){const compiled=this.compileNode(child,params);if(compiled){buttonContent.push(compiled);}}
if(buttonContent.length){const contentSlot=createElement("t");contentSlot.setAttribute("t-set-slot","contents");append(button,contentSlot);for(const buttonChild of buttonContent){append(contentSlot,buttonChild);}}
return button;}
compileField(el,params){const fieldName=el.getAttribute("name");const fieldId=el.getAttribute("field_id");const field=createElement("Field");const recordExpr=params.recordExpr||"__comp__.props.record";field.setAttribute("id",`'${fieldId}'`);field.setAttribute("name",`'${fieldName}'`);field.setAttribute("record",recordExpr);field.setAttribute("fieldInfo",`__comp__.props.archInfo.fieldNodes['${fieldId}']`);field.setAttribute("readonly",`__comp__.props.archInfo.activeActions?.edit === false and !${recordExpr}.isNew`);if(el.hasAttribute("widget")){field.setAttribute("type",`'${el.getAttribute("widget")}'`);}
return field;}
compileGenericNode(el,params){const compiled=createElement(el.nodeName.toLowerCase());const metaAttrs=["column_invisible","invisible","readonly","required"];for(const attr of el.attributes){if(metaAttrs.includes(attr.name)){continue;}
compiled.setAttribute(attr.name,attr.value);}
for(const child of el.childNodes){append(compiled,this.compileNode(child,params));}
if(el.hasAttribute("t-foreach")&&!el.hasAttribute("t-key")){compiled.setAttribute("t-key",`${el.getAttribute("t-as")}_index`);console.warn(`Missing attribute "t-key" in "t-foreach" statement.`);}
return compiled;}
compileWidget(el){const widgetId=el.getAttribute("widget_id");const props={record:"__comp__.props.record"};if(el.hasAttribute("name")){props.name=`'${el.getAttribute("name")}'`;}
if(el.hasAttribute("class")){props.className=`'${el.getAttribute("class")}'`;}
props.widgetInfo=`__comp__.props.archInfo.widgetNodes['${widgetId}']`;const widget=createElement("Widget",props);return assignOwlDirectives(widget,el);}
validateNode(node){const attributes=Object.values(node.attributes).map((attr)=>attr.name);const regexes=this.owlDirectiveRegexesWhitelist;for(const attr of attributes){if(attr.startsWith("t-")&&!regexes.some((regex)=>regex.test(attr))){console.warn(`Forbidden directive ${attr} used in arch`);}}}}
ViewCompiler.OWL_DIRECTIVE_WHITELIST=[];let templateCache=Object.create(null);__exports.useViewCompiler=useViewCompiler;function useViewCompiler(ViewCompiler,templates,params){const compiledTemplates={};let compiler;for(const tname in templates){const key=`${ViewCompiler.name}/${templates[tname].outerHTML}`;if(!templateCache[key]){compiler=compiler||new ViewCompiler(templates);templateCache[key]=xml`${compiler.compile(tname, params).outerHTML}`;}
compiledTemplates[tname]=templateCache[key];}
return compiledTemplates;}
__exports.resetViewCompilerCache=resetViewCompilerCache;function resetViewCompilerCache(){templateCache=Object.create(null);}
return __exports;});;

/* /web/static/src/views/view_components/animated_number.js */
odoo.define('@web/views/view_components/animated_number',['@web/core/browser/browser','@web/views/fields/formatters','@odoo/owl'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{formatInteger}=require("@web/views/fields/formatters");const{Component,onWillUpdateProps,onWillUnmount,useState}=require("@odoo/owl");const AnimatedNumber=__exports.AnimatedNumber=class AnimatedNumber extends Component{static template="web.AnimatedNumber";static props={value:Number,duration:Number,animationClass:{type:String,optional:true},currency:{type:[Object,Boolean],optional:true},title:{type:String,optional:true},slots:{type:Object,shape:{prefix:{type:Object,optional:true},},optional:true,},};static enableAnimations=true;setup(){this.formatInteger=formatInteger;this.state=useState({value:this.props.value});this.handle=null;onWillUpdateProps((nextProps)=>{const{value:from}=this.props;const{value:to,duration}=nextProps;if(!this.constructor.enableAnimations||!duration||to<=from){browser.cancelAnimationFrame(this.handle);this.state.value=to;return;}
const startTime=Date.now();const animate=()=>{const progress=(Date.now()-startTime)/duration;if(progress>=1){this.state.value=to;}else{this.state.value=from+(to-from)*progress;this.handle=browser.requestAnimationFrame(animate);}};browser.cancelAnimationFrame(this.handle);animate();});onWillUnmount(()=>browser.cancelAnimationFrame(this.handle));}
format(value){return this.formatInteger(value,{humanReadable:true,decimals:0,minDigits:3});}}
return __exports;});;

/* /web/static/src/views/view_components/column_progress.js */
odoo.define('@web/views/view_components/column_progress',['@odoo/owl','@web/views/view_components/animated_number'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{AnimatedNumber}=require("@web/views/view_components/animated_number");const ColumnProgress=__exports.ColumnProgress=class ColumnProgress extends Component{static components={AnimatedNumber,};static template="web.ColumnProgress";static props={aggregate:{type:Object},group:{type:Object},onBarClicked:{type:Function,optional:true},progressBar:{type:Object},};static defaultProps={onBarClicked:()=>{},};async onBarClick(bar){await this.props.onBarClicked(bar);}}
return __exports;});;

/* /web/static/src/views/view_components/view_scale_selector.js */
odoo.define('@web/views/view_components/view_scale_selector',['@odoo/owl','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const ViewScaleSelector=__exports.ViewScaleSelector=class ViewScaleSelector extends Component{static components={Dropdown,DropdownItem,};static template="web.ViewScaleSelector";static props={scales:{type:Object},currentScale:{type:String},isWeekendVisible:{type:Boolean,optional:true},setScale:{type:Function},toggleWeekendVisibility:{type:Function,optional:true},dropdownClass:{type:String,optional:true},};get scales(){return Object.entries(this.props.scales).map(([key,value])=>({key,...value}));}}
return __exports;});;

/* /web/static/src/views/view_dialogs/export_data_dialog.js */
odoo.define('@web/views/view_dialogs/export_data_dialog',['@web/core/l10n/translation','@web/core/browser/browser','@web/core/checkbox/checkbox','@web/core/dialog/dialog','@web/core/utils/arrays','@web/core/utils/hooks','@web/core/utils/search','@web/core/utils/sortable_owl','@web/core/utils/timing','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{browser}=require("@web/core/browser/browser");const{CheckBox}=require("@web/core/checkbox/checkbox");const{Dialog}=require("@web/core/dialog/dialog");const{unique}=require("@web/core/utils/arrays");const{useService}=require("@web/core/utils/hooks");const{fuzzyLookup}=require("@web/core/utils/search");const{useSortable}=require("@web/core/utils/sortable_owl");const{useDebounced}=require("@web/core/utils/timing");const{Component,useRef,useState,onMounted,onWillStart,onWillUnmount}=require("@odoo/owl");class DeleteExportListDialog extends Component{async onDelete(){await this.props.delete();this.props.close();}}
DeleteExportListDialog.components={Dialog};DeleteExportListDialog.template="web.DeleteExportListDialog";class ExportDataItem extends Component{setup(){this.state=useState({subfields:[],});onWillStart(()=>{if(this.props.isExpanded){return this.toggleItem(this.props.field.id,false);}});}
async toggleItem(id,isUserToggle){if(this.props.isFieldExpandable(id)){if(this.state.subfields.length){this.state.subfields=[];}else{const subfields=await this.props.loadFields(id,!isUserToggle);if(subfields){this.state.subfields=isUserToggle?subfields:this.props.filterSubfields(subfields);}else{this.state.subfields=[];}}}}
onDoubleClick(id){if(!this.props.isFieldExpandable(id)&&!this.isFieldSelected(id)){this.props.onAdd(id);}}
isFieldSelected(current){return this.props.exportList.find(({id})=>id===current);}}
ExportDataItem.template="web.ExportDataItem";ExportDataItem.components={ExportDataItem};ExportDataItem.props={exportList:{type:Object,optional:true},field:{type:Object,optional:true},filterSubfields:Function,isDebug:Boolean,isExpanded:Boolean,isFieldExpandable:Function,onAdd:Function,loadFields:Function,};const ExportDataDialog=__exports.ExportDataDialog=class ExportDataDialog extends Component{setup(){this.dialog=useService("dialog");this.notification=useService("notification");this.orm=useService("orm");this.rpc=useService("rpc");this.draggableRef=useRef("draggable");this.exportListRef=useRef("exportList");this.searchRef=useRef("search");this.knownFields={};this.expandedFields={};this.availableFormats=[];this.templates=[];this.state=useState({exportList:[],isCompatible:false,isEditingTemplate:false,search:[],selectedFormat:0,templateId:null,isSmall:this.env.isSmall,disabled:false,});this.title=_t("Export Data");this.newTemplateText=_t("New template");this.removeFieldText=_t("Remove field");this.debouncedOnResize=useDebounced(this.updateSize,300);useSortable({ref:this.draggableRef,elements:".o_export_field",enable:!this.state.isSmall,cursor:"grabbing",onDrop:async({element,previous,next})=>{const indexes=[element,previous,next].map((e)=>e&&Object.values(this.state.exportList).findIndex(({id})=>id===e.dataset.field_id));let target;if(indexes[0]<indexes[1]){target=previous?indexes[1]:0;}else{target=next?indexes[2]:this.state.exportList.length-1;}
this.onDraggingEnd(indexes[0],target);},});onWillStart(async()=>{this.availableFormats=await this.rpc("/web/export/formats");this.templates=await this.orm.searchRead("ir.exports",[["resource","=",this.props.root.resModel]],[],{context:this.props.context,});await this.fetchFields();});onMounted(()=>{browser.addEventListener("resize",this.debouncedOnResize);this.updateSize();});onWillUnmount(()=>browser.removeEventListener("resize",this.debouncedOnResize));}
get fieldsAvailable(){if(this.searchRef.el&&this.searchRef.el.value){return this.state.search.length&&Object.values(this.state.search);}
return Object.values(this.knownFields);}
get isDebug(){return Boolean(odoo.debug);}
get rootFields(){if(this.searchRef.el&&this.searchRef.el.value){const rootFromSearchResults=this.fieldsAvailable.map((f)=>{if(f.parent){const parentEl=this.knownFields[f.parent.id];return this.knownFields[parentEl.parent?parentEl.parent.id:parentEl.id];}
return this.knownFields[f.id];});return unique(rootFromSearchResults);}
return this.fieldsAvailable.filter(({parent})=>!parent);}
filterSubfields(subfields){let subfieldsFromSearchResults=[];let searchResults;if(this.searchRef.el&&this.searchRef.el.value){searchResults=this.lookup(this.searchRef.el.value);}
const fieldsAvailable=Object.values(searchResults||this.knownFields);if(this.searchRef.el&&this.searchRef.el.value){subfieldsFromSearchResults=fieldsAvailable.filter((f)=>f.parent&&this.knownFields[f.parent.id].parent).map((f)=>f.parent);}
const availableSubFields=unique([...fieldsAvailable,...subfieldsFromSearchResults]);return subfields.filter((a)=>availableSubFields.some((b)=>a.id===b.id));}
updateSize(){this.state.isSmall=this.env.isSmall;}
async fetchFields(){this.state.search=[];this.knownFields={};this.expandedFields={};await this.loadFields();await this.setDefaultExportList();if(this.searchRef.el){this.searchRef.el.value="";}
if(this.state.templateId){this.loadExportList(this.state.templateId);}}
enterTemplateEdition(){if(this.state.templateId&&!this.state.isEditingTemplate){this.state.isEditingTemplate=true;}}
isFieldExpandable(id){return this.knownFields[id].children&&id.split("/").length<3;}
async loadExportList(value){this.state.templateId=value==="new_template"?value:Number(value);this.state.isEditingTemplate=value==="new_template";if(!value||value==="new_template"){return;}
const fields=await this.rpc("/web/export/namelist",{model:this.props.root.resModel,export_id:Number(value),});this.state.exportList=fields.map(({label,name})=>{return{string:label,id:name,};});}
async loadFields(id,preventLoad=false){let model=this.props.root.resModel;let parentField,parentParams;if(id){if(this.expandedFields[id]){return this.expandedFields[id].fields;}
parentField=this.knownFields[id];model=parentField.params&&parentField.params.model;parentParams={...parentField.params,parent_field_type:parentField.field_type,parent_field:parentField,parent_name:parentField.string,exclude:[parentField.relation_field],};}
if(preventLoad){return;}
const fields=await this.props.getExportedFields(model,this.state.isCompatible,parentParams);for(const field of fields){field.parent=parentField;if(!this.knownFields[field.id]){this.knownFields[field.id]=field;}}
if(id){this.expandedFields[id]={fields};}
return fields;}
onDraggingEnd(item,target){this.state.exportList.splice(target,0,this.state.exportList.splice(item,1)[0]);}
onAddItemExportList(fieldId){this.state.exportList.push(this.knownFields[fieldId]);this.enterTemplateEdition();}
onRemoveItemExportList(fieldId){const item=this.state.exportList.findIndex(({id})=>id===fieldId);this.state.exportList.splice(item,1);this.enterTemplateEdition();}
async onChangeExportList(ev){this.loadExportList(ev.target.value);}
async onSaveExportTemplate(){const name=this.exportListRef.el.value;if(!name){return this.notification.add(_t("Please enter save field list name"),{type:"danger",});}
const[id]=await this.orm.create("ir.exports",[{name,export_fields:this.state.exportList.map((field)=>[0,0,{name:field.id,},]),resource:this.props.root.resModel,},],{context:this.props.context});this.state.isEditingTemplate=false;this.state.templateId=id;this.templates.push({id,name});}
onCancelExportTemplate(){this.state.isEditingTemplate=false;if(this.state.templateId==="new_template"){this.state.templateId=null;return;}
this.loadExportList(this.state.templateId);}
async onClickExportButton(){if(!this.state.exportList.length){return this.notification.add(_t("Please select fields to save export list..."),{type:"danger",});}
this.state.disabled=true;await this.props.download(this.state.exportList,this.state.isCompatible,this.availableFormats[this.state.selectedFormat].tag);this.state.disabled=false;}
async onDeleteExportTemplate(){this.dialog.add(DeleteExportListDialog,{text:_t("Do you really want to delete this export template?"),delete:async()=>{const id=Number(this.state.templateId);await this.orm.unlink("ir.exports",[id],{context:this.props.context});this.templates.splice(this.templates.findIndex((i)=>i.id===id),1);this.state.templateId=null;this.setDefaultExportList();},});}
onSearch(ev){this.state.search=this.lookup(ev.target.value);}
lookup(value){let lookupResult=fuzzyLookup(value,Object.values(this.knownFields),(field)=>field.string.split("/").reverse().join("/"));if(this.isDebug){lookupResult=unique([...lookupResult,...Object.values(this.knownFields).filter((f)=>{return f.id.includes(value);}),]);}
return lookupResult;}
onToggleCompatibleExport(value){this.state.isCompatible=value;this.fetchFields();}
async setDefaultExportList(){this.state.exportList=Object.values(this.knownFields).filter((e)=>e.default_export||this.props.defaultExportList.find((i)=>i.name===e.id));}
setFormat(ev){if(ev.target.checked){this.state.selectedFormat=this.availableFormats.findIndex(({tag})=>tag===ev.target.value);}}}
ExportDataDialog.components={CheckBox,Dialog,ExportDataItem};ExportDataDialog.props={close:{type:Function},context:{type:Object,optional:true},defaultExportList:{type:Array},download:{type:Function},getExportedFields:{type:Function},root:{type:Object},};ExportDataDialog.template="web.ExportDataDialog";return __exports;});;

/* /web/static/src/views/view_dialogs/form_view_dialog.js */
odoo.define('@web/views/view_dialogs/form_view_dialog',['@web/core/dialog/dialog','@web/core/utils/hooks','@web/views/view','@odoo/owl'],function(require){'use strict';let __exports={};const{Dialog}=require("@web/core/dialog/dialog");const{useChildRef}=require("@web/core/utils/hooks");const{View}=require("@web/views/view");const{Component,onMounted}=require("@odoo/owl");const FormViewDialog=__exports.FormViewDialog=class FormViewDialog extends Component{setup(){super.setup();this.modalRef=useChildRef();this.env.dialogData.dismiss=()=>this.discardRecord();const buttonTemplate=this.props.isToMany?"web.FormViewDialog.ToMany.buttons":"web.FormViewDialog.ToOne.buttons";this.viewProps={type:"form",buttonTemplate,context:this.props.context||{},display:{controlPanel:false},mode:this.props.mode||"edit",resId:this.props.resId||false,resModel:this.props.resModel,viewId:this.props.viewId||false,preventCreate:this.props.preventCreate,preventEdit:this.props.preventEdit,discardRecord:this.discardRecord.bind(this),saveRecord:async(record,{saveAndNew})=>{const saved=await record.save({reload:false});if(saved){await this.props.onRecordSaved(record);if(saveAndNew){const context=Object.assign({},this.props.context);Object.keys(context).forEach((k)=>{if(k.startsWith("default_")){delete context[k];}});await record.model.load({resId:false,context});}else{this.props.close();}}
return saved;},};if(this.props.removeRecord){this.viewProps.removeRecord=async()=>{await this.props.removeRecord();this.props.close();};}
onMounted(()=>{if(this.modalRef.el.querySelector(".modal-footer").childElementCount>1){const defaultButton=this.modalRef.el.querySelector(".modal-footer button.o-default-button");if(defaultButton){defaultButton.classList.add("d-none");}}});}
async discardRecord(){if(this.props.onRecordDiscarded){await this.props.onRecordDiscarded();}
this.props.close();}}
FormViewDialog.components={Dialog,View};FormViewDialog.props={close:Function,resModel:String,context:{type:Object,optional:true},mode:{optional:true,validate:(m)=>["edit","readonly"].includes(m),},onRecordSaved:{type:Function,optional:true},onRecordDiscarded:{type:Function,optional:true},removeRecord:{type:Function,optional:true},resId:{type:[Number,Boolean],optional:true},title:{type:String,optional:true},viewId:{type:[Number,Boolean],optional:true},preventCreate:{type:Boolean,optional:true},preventEdit:{type:Boolean,optional:true},isToMany:{type:Boolean,optional:true},size:Dialog.props.size,};FormViewDialog.defaultProps={onRecordSaved:()=>{},preventCreate:false,preventEdit:false,isToMany:false,};FormViewDialog.template="web.FormViewDialog";return __exports;});;

/* /web/static/src/views/view_dialogs/select_create_dialog.js */
odoo.define('@web/views/view_dialogs/select_create_dialog',['@web/core/dialog/dialog','@web/core/l10n/translation','@web/core/utils/hooks','@web/views/view','@web/core/utils/strings','@web/views/view_dialogs/form_view_dialog','@odoo/owl','@web/core/registry'],function(require){'use strict';let __exports={};const{Dialog}=require("@web/core/dialog/dialog");const{_t}=require("@web/core/l10n/translation");const{useService}=require("@web/core/utils/hooks");const{View}=require("@web/views/view");const{escape}=require("@web/core/utils/strings");const{FormViewDialog}=require("@web/views/view_dialogs/form_view_dialog");const{Component,markup,useState}=require("@odoo/owl");const{registry}=require("@web/core/registry");const SelectCreateDialog=__exports.SelectCreateDialog=class SelectCreateDialog extends Component{setup(){this.viewService=useService("view");this.dialogService=useService("dialog");this.state=useState({resIds:[]});const translatedText=_t("No records found!");this.busy=false;this.baseViewProps={display:{searchPanel:false},editable:false,noBreadcrumbs:true,noContentHelp:markup(`<p>${escape(translatedText)}</p>`),showButtons:false,selectRecord:(resId)=>this.select([resId]),onSelectionChanged:(resIds)=>{this.state.resIds=resIds;},};}
get viewProps(){const type=this.env.isSmall?"kanban":"list";const props={loadIrFilters:true,...this.baseViewProps,context:this.props.context,domain:this.props.domain,dynamicFilters:this.props.dynamicFilters,resModel:this.props.resModel,searchViewId:this.props.searchViewId,type,};if(type==="list"){props.allowSelectors=this.props.multiSelect;}else if(type==="kanban"){props.forceGlobalClick=true;}
return props;}
async executeOnceAndClose(callback){if(!this.busy){this.busy=true;try{await callback();}catch(e){this.busy=false;throw e;}
this.props.close();}}
async select(resIds){if(this.props.onSelected){this.executeOnceAndClose(()=>this.props.onSelected(resIds));}}
async unselect(){if(this.props.onUnselect){this.executeOnceAndClose(()=>this.props.onUnselect());}}
get canUnselect(){return this.env.isSmall&&!!this.props.onUnselect;}
async createEditRecord(){if(this.props.onCreateEdit){await this.props.onCreateEdit();this.props.close();}else{this.dialogService.add(FormViewDialog,{context:this.props.context,resModel:this.props.resModel,onRecordSaved:(record)=>{this.props.onSelected([record.resId]);this.props.close();},});}}}
SelectCreateDialog.components={Dialog,View};SelectCreateDialog.template="web.SelectCreateDialog";SelectCreateDialog.props={context:{type:Object,optional:true},domain:{type:Array,optional:true},dynamicFilters:{type:Array,optional:true},resModel:String,searchViewId:{type:[Number,{value:false}],optional:true},multiSelect:{type:Boolean,optional:true},onSelected:{type:Function,optional:true},close:{type:Function,optional:true},onCreateEdit:{type:Function,optional:true},title:{type:String,optional:true},noCreate:{type:Boolean,optional:true},onUnselect:{type:Function,optional:true},};SelectCreateDialog.defaultProps={dynamicFilters:[],multiSelect:true,searchViewId:false,domain:[],context:{},};registry.category("dialogs").add("select_create",SelectCreateDialog);return __exports;});;

/* /web/static/src/views/view_hook.js */
odoo.define('@web/views/view_hook',['@web/core/debug/debug_context','@web/webclient/actions/action_hook','@web/core/registry','@web/core/utils/hooks','@web/core/browser/browser','@web/core/py_js/py','@odoo/owl'],function(require){'use strict';let __exports={};const{useDebugCategory}=require("@web/core/debug/debug_context");const{useSetupAction}=require("@web/webclient/actions/action_hook");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{browser}=require("@web/core/browser/browser");const{evaluateExpr}=require("@web/core/py_js/py");const{useComponent,useEffect,xml}=require("@odoo/owl");__exports.useSetupView=useSetupView;function useSetupView(params){const component=useComponent();useDebugCategory("view",{component});useSetupAction(params);}
__exports.useViewArch=useViewArch;function useViewArch(arch,params={}){const CATEGORY="__processed_archs__";arch=arch.trim();const processedRegistry=registry.category(CATEGORY);let processedArch;if(!processedRegistry.contains(arch)){processedArch={};processedRegistry.add(arch,processedArch);}else{processedArch=processedRegistry.get(arch);}
const{compile,extract}=params;if(!("template"in processedArch)&&compile){processedArch.template=xml`${compile(arch)}`;}
if(!("extracted"in processedArch)&&extract){processedArch.extracted=extract(arch);}
return processedArch;}
__exports.useActionLinks=useActionLinks;function useActionLinks({resModel,reload}){const component=useComponent();const keepLast=component.env.keepLast;const orm=useService("orm");const{doAction}=useService("action");function checkAndCollapseBootstrap(target){if(target.dataset.bsToggle==="collapse"){$(target).trigger("click.bs.collapse.data-api");}}
async function handler(ev){ev.preventDefault();ev.stopPropagation();let target=ev.target;if(target.tagName!=="A"){target=target.closest("a");}
const data=target.dataset;if(data.method!==undefined&&data.model!==undefined){const options={};if(data.reloadOnClose){options.onClose=reload||(()=>component.render());}
const action=await keepLast.add(orm.call(data.model,data.method));if(action!==undefined){keepLast.add(Promise.resolve(doAction(action,options)));}}else if(target.getAttribute("name")){const options={};if(data.context){options.additionalContext=evaluateExpr(data.context);}
keepLast.add(doAction(target.getAttribute("name"),options));}else{let views;const resId=data.resid?parseInt(data.resid,10):null;if(data.views){views=evaluateExpr(data.views);}else{views=resId?[[false,"form"]]:[[false,"list"],[false,"form"],];}
const action={name:target.getAttribute("title")||target.textContent.trim(),type:"ir.actions.act_window",res_model:data.model||resModel,target:"current",views,domain:data.domain?evaluateExpr(data.domain):[],};if(resId){action.res_id=resId;}
const options={};if(data.context){options.additionalContext=evaluateExpr(data.context);}
keepLast.add(doAction(action,options));}
checkAndCollapseBootstrap(target);}
return(ev)=>{const a=ev.target.closest(`a[type="action"]`);if(a&&ev.currentTarget.contains(a)){handler(ev);}};}
__exports.useBounceButton=useBounceButton;function useBounceButton(containerRef,shouldBounce){let timeout;const ui=useService("ui");useEffect((containerEl)=>{if(!containerEl){return;}
const handler=(ev)=>{const button=ui.activeElement.querySelector("[data-bounce-button]");if(button&&shouldBounce(ev.target)){button.classList.add("o_catch_attention");browser.clearTimeout(timeout);timeout=browser.setTimeout(()=>{button.classList.remove("o_catch_attention");},400);}};containerEl.addEventListener("click",handler);return()=>containerEl.removeEventListener("click",handler);},()=>[containerRef.el]);}
return __exports;});;

/* /web/static/src/views/view_service.js */
odoo.define('@web/views/view_service',['@web/core/registry','@web/core/orm_service'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{UPDATE_METHODS}=require("@web/core/orm_service");const viewService=__exports.viewService={dependencies:["orm"],start(env,{orm}){let cache={};function clearCache(){cache={};const processedArchs=registry.category("__processed_archs__");processedArchs.content={};processedArchs.trigger("UPDATE");}
env.bus.addEventListener("CLEAR-CACHES",clearCache);env.bus.addEventListener("RPC:RESPONSE",(ev)=>{const{model,method}=ev.detail.data.params;if(["ir.ui.view","ir.filters"].includes(model)){if(UPDATE_METHODS.includes(method)){clearCache();}}});async function loadViews(params,options={}){const{context,resModel,views}=params;const loadViewsOptions={action_id:options.actionId||false,load_filters:options.loadIrFilters||false,toolbar:(!context?.disable_toolbar&&options.loadActionMenus)||false,};for(const key in options){if(!["actionId","loadIrFilters","loadActionMenus"].includes(key)){loadViewsOptions[key]=options[key];}}
if(env.isSmall){loadViewsOptions.mobile=true;}
const filteredContext=Object.fromEntries(Object.entries(context||{}).filter(([k,v])=>k=="lang"||k.endsWith("_view_ref")));const key=JSON.stringify([resModel,views,filteredContext,loadViewsOptions]);if(!cache[key]){cache[key]=orm.call(resModel,"get_views",[],{context:filteredContext,views,options:loadViewsOptions,}).then((result)=>{const{models,views}=result;const viewDescriptions={fields:models[resModel],relatedModels:models,views:{},};for(const viewType in views){const{arch,toolbar,id,filters,custom_view_id}=views[viewType];const viewDescription={arch,id,custom_view_id};if(toolbar){viewDescription.actionMenus=toolbar;}
if(filters){viewDescription.irFilters=filters;}
viewDescriptions.views[viewType]=viewDescription;}
return viewDescriptions;}).catch((error)=>{delete cache[key];return Promise.reject(error);});}
return cache[key];}
return{loadViews};},};registry.category("services").add("view",viewService);return __exports;});;

/* /web/static/src/views/widgets/attach_document/attach_document.js */
odoo.define('@web/views/widgets/attach_document/attach_document',['@web/core/file_input/file_input','@web/core/registry','@web/core/utils/hooks','@web/core/utils/files','@web/views/widgets/standard_widget_props','@odoo/owl'],function(require){'use strict';let __exports={};const{FileInput}=require("@web/core/file_input/file_input");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{checkFileSize}=require("@web/core/utils/files");const{standardWidgetProps}=require("@web/views/widgets/standard_widget_props");const{Component}=require("@odoo/owl");const AttachDocumentWidget=__exports.AttachDocumentWidget=class AttachDocumentWidget extends Component{static template="web.AttachDocument";static components={FileInput,};static props={...standardWidgetProps,string:{type:String},action:{type:String,optional:true},highlight:{type:Boolean},};setup(){this.http=useService("http");this.notification=useService("notification");this.fileInput=document.createElement("input");this.fileInput.type="file";this.fileInput.accept="*";this.fileInput.multiple=true;this.fileInput.onchange=this.onInputChange.bind(this);}
async onInputChange(){const ufile=[...this.fileInput.files];for(const file of ufile){if(!checkFileSize(file.size,this.notification)){return null;}}
const fileData=await this.http.post("/web/binary/upload_attachment",{csrf_token:odoo.csrf_token,ufile:ufile,model:this.props.record.resModel,id:this.props.record.resId,},"text");const parsedFileData=JSON.parse(fileData);if(parsedFileData.error){throw new Error(parsedFileData.error);}
await this.onFileUploaded(parsedFileData);}
async triggerUpload(){if(await this.beforeOpen()){this.fileInput.click();}}
async onFileUploaded(files){const{action,record}=this.props;if(action){const{resId,resModel}=record;await this.env.services.orm.call(resModel,action,[resId],{attachment_ids:files.map((file)=>file.id),});await record.load();}}
beforeOpen(){return this.props.record.save();}}
const attachDocumentWidget=__exports.attachDocumentWidget={component:AttachDocumentWidget,extractProps:({attrs})=>{const{action,highlight,string}=attrs;return{action,highlight:!!highlight,string,};},};registry.category("view_widgets").add("attach_document",attachDocumentWidget);return __exports;});;

/* /web/static/src/views/widgets/documentation_link/documentation_link.js */
odoo.define('@web/views/widgets/documentation_link/documentation_link',['@web/session','@web/views/widgets/standard_widget_props','@odoo/owl','@web/core/registry'],function(require){'use strict';let __exports={};const{session}=require("@web/session");const{standardWidgetProps}=require("@web/views/widgets/standard_widget_props");const{Component}=require("@odoo/owl");const{registry}=require("@web/core/registry");const LINK_REGEX=new RegExp("^https?://");const DocumentationLink=__exports.DocumentationLink=class DocumentationLink extends Component{static template="web.DocumentationLink";static props={...standardWidgetProps,record:{type:Object,optional:1},path:{type:String},};get url(){if(LINK_REGEX.test(this.props.path)){return this.props.path;}else{const serverVersion=session.server_version_info.includes("final")?`${session.server_version_info[0]}.${session.server_version_info[1]}`.replace("~","-"):"master";return"https://www.odoo.com/documentation/"+serverVersion+this.props.path;}}}
const documentationLink=__exports.documentationLink={component:DocumentationLink,extractProps:({attrs})=>{const{path}=attrs;return{path,};},additionalClasses:["d-inline"],};registry.category("view_widgets").add("documentation_link",documentationLink);return __exports;});;

/* /web/static/src/views/widgets/notification_alert/notification_alert.js */
odoo.define('@web/views/widgets/notification_alert/notification_alert',['@web/core/browser/browser','@web/core/registry','@web/views/widgets/standard_widget_props','@odoo/owl'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{registry}=require("@web/core/registry");const{standardWidgetProps}=require("@web/views/widgets/standard_widget_props");const{Component}=require("@odoo/owl");const NotificationAlert=__exports.NotificationAlert=class NotificationAlert extends Component{static props=standardWidgetProps;static template="web.NotificationAlert";get isNotificationBlocked(){return browser.Notification&&browser.Notification.permission==="denied";}}
const notificationAlert=__exports.notificationAlert={component:NotificationAlert,};registry.category("view_widgets").add("notification_alert",notificationAlert);return __exports;});;

/* /web/static/src/views/widgets/ribbon/ribbon.js */
odoo.define('@web/views/widgets/ribbon/ribbon',['@web/core/registry','@web/views/widgets/standard_widget_props','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{standardWidgetProps}=require("@web/views/widgets/standard_widget_props");const{Component}=require("@odoo/owl");class RibbonWidget extends Component{static template="web.Ribbon";static props={...standardWidgetProps,text:{type:String},title:{type:String,optional:true},bgClass:{type:String,optional:true},};static defaultProps={title:"",bgClass:"text-bg-success",};get classes(){let classes=this.props.bgClass;if(this.props.text.length>15){classes+=" o_small";}else if(this.props.text.length>10){classes+=" o_medium";}
return classes;}}
const ribbonWidget=__exports.ribbonWidget={component:RibbonWidget,extractProps:({attrs})=>{return{text:attrs.title||attrs.text,title:attrs.tooltip,bgClass:attrs.bg_color,};},};registry.category("view_widgets").add("web_ribbon",ribbonWidget);return __exports;});;

/* /web/static/src/views/widgets/signature/signature.js */
odoo.define('@web/views/widgets/signature/signature',['@web/core/registry','@web/core/signature/signature_dialog','@web/core/utils/hooks','@web/views/widgets/standard_widget_props','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{SignatureDialog}=require("@web/core/signature/signature_dialog");const{useService}=require("@web/core/utils/hooks");const{standardWidgetProps}=require("@web/views/widgets/standard_widget_props");const{Component}=require("@odoo/owl");const SignatureWidget=__exports.SignatureWidget=class SignatureWidget extends Component{static template="web.SignatureWidget";static props={...standardWidgetProps,fullName:{type:String,optional:true},highlight:{type:Boolean,optional:true},string:{type:String},signatureField:{type:String,optional:true},};setup(){this.dialogService=useService("dialog");this.orm=useService("orm");}
onClickSignature(){const nameAndSignatureProps={mode:"draw",displaySignatureRatio:3,signatureType:"signature",noInputName:true,};const{fullName,record}=this.props;let defaultName="";if(fullName){let signName;const fullNameData=record.data[fullName];if(record.fields[fullName].type==="many2one"){signName=fullNameData&&fullNameData[1];}else{signName=fullNameData;}
defaultName=signName===""?undefined:signName;}
nameAndSignatureProps.defaultFont=this.props.defaultFont;const dialogProps={defaultName,nameAndSignatureProps,uploadSignature:(data)=>this.uploadSignature(data),};this.dialogService.add(SignatureDialog,dialogProps);}
async uploadSignature({signatureImage}){const file=signatureImage[1];const{model,resModel,resId}=this.props.record;await this.env.services.orm.write(resModel,[resId],{[this.props.signatureField]:file,});await this.props.record.load();model.notify();}}
const signatureWidget=__exports.signatureWidget={component:SignatureWidget,extractProps:({attrs})=>{const{full_name:fullName,highlight,signature_field,string}=attrs;return{fullName,highlight:!!highlight,string,signatureField:signature_field||"signature",};},};registry.category("view_widgets").add("signature",signatureWidget);return __exports;});;

/* /web/static/src/views/widgets/standard_widget_props.js */
odoo.define('@web/views/widgets/standard_widget_props',[],function(require){'use strict';let __exports={};const standardWidgetProps=__exports.standardWidgetProps={readonly:{type:Boolean,optional:true},record:{type:Object},};return __exports;});;

/* /web/static/src/views/widgets/week_days/week_days.js */
odoo.define('@web/views/widgets/week_days/week_days',['@web/core/registry','@web/core/checkbox/checkbox','@web/core/l10n/localization','@web/core/l10n/translation','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{CheckBox}=require("@web/core/checkbox/checkbox");const{localization}=require("@web/core/l10n/localization");const{_t}=require("@web/core/l10n/translation");const{Component}=require("@odoo/owl");const WEEKDAYS=["sun","mon","tue","wed","thu","fri","sat"];const WeekDays=__exports.WeekDays=class WeekDays extends Component{static template="web.WeekDays";static components={CheckBox};get weekdays(){return[...WEEKDAYS.slice(localization.weekStart%WEEKDAYS.length,WEEKDAYS.length),...WEEKDAYS.slice(0,localization.weekStart%WEEKDAYS.length),];}
get data(){return Object.fromEntries(this.weekdays.map((day)=>[day,this.props.record.data[day]]));}
onChange(day,checked){this.props.record.update({[day]:checked});}}
const weekDays=__exports.weekDays={component:WeekDays,fieldDependencies:[{name:"sun",type:"boolean",string:_t("Sun"),readonly:false},{name:"mon",type:"boolean",string:_t("Mon"),readonly:false},{name:"tue",type:"boolean",string:_t("Tue"),readonly:false},{name:"wed",type:"boolean",string:_t("Wed"),readonly:false},{name:"thu",type:"boolean",string:_t("Thu"),readonly:false},{name:"fri",type:"boolean",string:_t("Fri"),readonly:false},{name:"sat",type:"boolean",string:_t("Sat"),readonly:false},],};registry.category("view_widgets").add("week_days",weekDays);return __exports;});;

/* /web/static/src/views/widgets/widget.js */
odoo.define('@web/views/widgets/widget',['@web/core/py_js/py','@web/core/registry','@odoo/owl'],function(require){'use strict';let __exports={};const{evaluateExpr,evaluateBooleanExpr}=require("@web/core/py_js/py");const{registry}=require("@web/core/registry");const{Component,xml}=require("@odoo/owl");const viewWidgetRegistry=registry.category("view_widgets");const Widget=__exports.Widget=class Widget extends Component{setup(){if(this.props.widgetInfo){this.widget=this.props.widgetInfo.widget;}else{this.widget=viewWidgetRegistry.get(this.props.name);}}
get classNames(){const classNames={o_widget:true,[`o_widget_${this.props.name}`]:true,[this.props.className]:Boolean(this.props.className),};if(this.widget.additionalClasses){for(const cls of this.widget.additionalClasses){classNames[cls]=true;}}
return classNames;}
get widgetProps(){const record=this.props.record;let readonlyFromModifiers=false;let propsFromNode={};if(this.props.widgetInfo){const widgetInfo=this.props.widgetInfo;readonlyFromModifiers=evaluateBooleanExpr(widgetInfo.attrs.readonly,record.evalContextWithVirtualIds);const dynamicInfo={readonly:readonlyFromModifiers,};propsFromNode=this.widget.extractProps?this.widget.extractProps(widgetInfo,dynamicInfo):{};}
return{record,readonly:!record.isInEdition||readonlyFromModifiers||false,...propsFromNode,};}}
Widget.template=xml`
    <div t-att-class="classNames" t-att-style="props.style">
        <t t-component="widget.component" t-props="widgetProps" />
    </div>`;Widget.parseWidgetNode=function(node){const name=node.getAttribute("name");const widget=viewWidgetRegistry.get(name);const widgetInfo={name,widget,options:{},attrs:{},};for(const{name,value}of node.attributes){if(["name","widget"].includes(name)){continue;}
if(name==="options"){widgetInfo.options=evaluateExpr(value);}else if(!name.startsWith("t-att")){widgetInfo.attrs[name]=value;}}
return widgetInfo;};Widget.props={"*":true,};return __exports;});;

/* /web/static/src/search/action_menus/action_menus.js */
odoo.define('@web/search/action_menus/action_menus',['@web/core/browser/browser','@web/core/context','@web/session','@web/core/dropdown/dropdown','@web/core/dropdown/dropdown_item','@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{makeContext}=require("@web/core/context");const{session}=require("@web/session");const{Dropdown}=require("@web/core/dropdown/dropdown");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{useService}=require("@web/core/utils/hooks");const{Component,onWillStart,onWillUpdateProps}=require("@odoo/owl");const STATIC_ACTIONS_GROUP_NUMBER=__exports.STATIC_ACTIONS_GROUP_NUMBER=1;const ACTIONS_GROUP_NUMBER=__exports.ACTIONS_GROUP_NUMBER=100;const ActionMenus=__exports.ActionMenus=class ActionMenus extends Component{setup(){this.orm=useService("orm");this.actionService=useService("action");onWillStart(async()=>{this.actionItems=await this.getActionItems(this.props);});onWillUpdateProps(async(nextProps)=>{this.actionItems=await this.getActionItems(nextProps);});}
get printItems(){const printActions=this.props.items.print||[];return printActions.map((action)=>({action,description:action.name,key:action.id,}));}
async getActionItems(props){return(props.items.action||[]).map((action)=>{if(action.callback){return Object.assign({key:`action-${action.description}`,groupNumber:ACTIONS_GROUP_NUMBER},action);}else{return{action,description:action.name,key:action.id,groupNumber:action.groupNumber||ACTIONS_GROUP_NUMBER,};}});}
async executeAction(action){let activeIds=this.props.getActiveIds();if(this.props.isDomainSelected){activeIds=await this.orm.search(this.props.resModel,this.props.domain,{limit:session.active_ids_limit,context:this.props.context,});}
const activeIdsContext={active_id:activeIds[0],active_ids:activeIds,active_model:this.props.resModel,};if(this.props.domain){activeIdsContext.active_domain=this.props.domain;}
const context=makeContext([this.props.context,activeIdsContext]);return this.actionService.doAction(action.id,{additionalContext:context,onClose:this.props.onActionExecuted,});}
async onItemSelected(item){if(!(await this.props.shouldExecuteAction(item))){return;}
if(item.callback){item.callback([item]);}else if(item.action){this.executeAction(item.action);}else if(item.url){browser.location=item.url;}}}
ActionMenus.components={Dropdown,DropdownItem,};ActionMenus.props={getActiveIds:Function,context:Object,resModel:String,domain:{type:Array,optional:true},isDomainSelected:{type:Boolean,optional:true},items:{type:Object,shape:{action:{type:Array,optional:true},print:{type:Array,optional:true},},},onActionExecuted:{type:Function,optional:true},shouldExecuteAction:{type:Function,optional:true},};ActionMenus.defaultProps={onActionExecuted:()=>{},shouldExecuteAction:()=>true,};ActionMenus.template="web.ActionMenus";return __exports;});;

/* /web/static/src/search/cog_menu/cog_menu.js */
odoo.define('@web/search/cog_menu/cog_menu',['@web/core/registry','@web/core/dropdown/dropdown','@web/search/action_menus/action_menus','@odoo/owl'],function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{Dropdown}=require("@web/core/dropdown/dropdown");const{ActionMenus}=require("@web/search/action_menus/action_menus");const{onWillStart,onWillUpdateProps}=require("@odoo/owl");const cogMenuRegistry=registry.category("cogMenu");const CogMenu=__exports.CogMenu=class CogMenu extends ActionMenus{static template="web.CogMenu";static components={...ActionMenus.components,Dropdown,};static props={...ActionMenus.props,getActiveIds:{type:ActionMenus.props.getActiveIds,optional:true},context:{type:ActionMenus.props.context,optional:true},resModel:{type:ActionMenus.props.resModel,optional:true},items:{...ActionMenus.props.items,optional:true},};static defaultProps={...ActionMenus.defaultProps,items:{},};setup(){super.setup();onWillStart(async()=>{this.registryItems=await this._registryItems();});onWillUpdateProps(async()=>{this.registryItems=await this._registryItems();});}
get hasItems(){return this.cogItems.length||this.printItems.length;}
async _registryItems(){const items=[];for(const item of cogMenuRegistry.getAll()){if("isDisplayed"in item?await item.isDisplayed(this.env):true){items.push({Component:item.Component,groupNumber:item.groupNumber,key:item.Component.name,});}}
return items;}
get cogItems(){return[...this.actionItems,...this.registryItems].sort((item1,item2)=>{const grp=(item1.groupNumber||0)-(item2.groupNumber||0);if(grp!==0){return grp;}
return(item1.sequence||0)-(item2.sequence||0);});}}
return __exports;});;

/* /web/static/src/search/control_panel/control_panel.js */
odoo.define('@web/search/control_panel/control_panel',['@web/core/l10n/translation','@web/core/browser/browser','@web/core/hotkeys/hotkey_service','@web/core/pager/pager','@web/core/utils/hooks','@web/search/search_bar/search_bar','@web/core/dropdown/dropdown','@web/core/commands/command_hook','@web/core/dropdown/dropdown_item','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{browser}=require("@web/core/browser/browser");const{getActiveHotkey}=require("@web/core/hotkeys/hotkey_service");const{Pager}=require("@web/core/pager/pager");const{useService}=require("@web/core/utils/hooks");const{SearchBar}=require("@web/search/search_bar/search_bar");const{Dropdown}=require("@web/core/dropdown/dropdown");const{useCommand}=require("@web/core/commands/command_hook");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{Component,useState,onMounted,useExternalListener,useRef,useEffect}=require("@odoo/owl");const STICKY_CLASS="o_mobile_sticky";const ControlPanel=__exports.ControlPanel=class ControlPanel extends Component{setup(){this.actionService=useService("action");this.pagerProps=this.env.config.pagerProps?useState(this.env.config.pagerProps):undefined;this.breadcrumbs=useState(this.env.config.breadcrumbs);this.root=useRef("root");this.state=useState({showSearchBar:false,showMobileSearch:false,showViewSwitcher:false,});this.onScrollThrottledBound=this.onScrollThrottled.bind(this);const{viewSwitcherEntries,viewType}=this.env.config;for(const view of viewSwitcherEntries||[]){useCommand(_t("Show %s view",view.name),()=>this.onViewClicked(view.type),{category:"view_switcher",isAvailable:()=>view.type!==viewType,});}
useExternalListener(window,"click",this.onWindowClick);useEffect(()=>{if(!this.env.isSmall||("adaptToScroll"in this.display&&!this.display.adaptToScroll)){return;}
const scrollingEl=this.getScrollingElement();scrollingEl.addEventListener("scroll",this.onScrollThrottledBound);this.root.el.style.top="0px";return()=>{scrollingEl.removeEventListener("scroll",this.onScrollThrottledBound);};});onMounted(()=>{if(!this.env.isSmall||("adaptToScroll"in this.display&&!this.display.adaptToScroll)){return;}
this.oldScrollTop=0;this.lastScrollTop=0;this.initialScrollTop=this.getScrollingElement().scrollTop;});this.mainButtons=useRef("mainButtons");useEffect(()=>{const dropdownButtons=this.mainButtons.el.querySelectorAll(".o_control_panel_collapsed_create.dropdown-menu button");if(!dropdownButtons.length){this.mainButtons.el.querySelectorAll(".o_control_panel_collapsed_create.dropdown-menu, .o_control_panel_collapsed_create.dropdown-toggle").forEach((el)=>el.classList.add("d-none"));this.mainButtons.el.querySelectorAll(".o_control_panel_collapsed_create.btn-group").forEach((el)=>el.classList.remove("btn-group"));return;}
for(const button of dropdownButtons){for(const cl of Array.from(button.classList)){button.classList.toggle(cl,!cl.startsWith("btn-"));}
button.classList.add("dropdown-item","btn","btn-link");}});}
getScrollingElement(){return this.root.el.parentElement;}
resetSearchState(){Object.assign(this.state,{showSearchBar:false,showMobileSearch:false,showViewSwitcher:false,});}
get display(){return{layoutActions:true,...this.props.display,};}
onBreadcrumbClicked(jsId){this.actionService.restore(jsId);}
onScrollThrottled(){if(this.isScrolling){return;}
this.isScrolling=true;browser.requestAnimationFrame(()=>(this.isScrolling=false));const scrollTop=this.getScrollingElement().scrollTop;const delta=Math.round(scrollTop-this.oldScrollTop);if(scrollTop>this.initialScrollTop){this.root.el.classList.add(STICKY_CLASS);if(delta<0){this.lastScrollTop=Math.min(0,this.lastScrollTop-delta);}else{this.lastScrollTop=Math.max(-this.root.el.offsetHeight,-this.root.el.offsetTop-delta);}
this.root.el.style.top=`${this.lastScrollTop}px`;}else{this.root.el.classList.remove(STICKY_CLASS);this.lastScrollTop=0;}
this.oldScrollTop=scrollTop;}
onViewClicked(viewType){this.resetSearchState();this.actionService.switchView(viewType);}
onWindowClick(ev){if(this.state.showViewSwitcher&&!ev.target.closest(".o_cp_switch_buttons")){this.state.showViewSwitcher=false;}}
onMainButtonsKeydown(ev){const hotkey=getActiveHotkey(ev);if(hotkey==="arrowdown"){this.env.searchModel.trigger("focus-view");ev.preventDefault();ev.stopPropagation();}}}
ControlPanel.components={Pager,SearchBar,Dropdown,DropdownItem,};ControlPanel.template="web.ControlPanel";ControlPanel.props={display:{type:Object,optional:true},slots:{type:Object,optional:true},};return __exports;});;

/* /web/static/src/search/custom_favorite_item/custom_favorite_item.js */
odoo.define('@web/search/custom_favorite_item/custom_favorite_item',['@web/core/l10n/translation','@web/core/dropdown/accordion_item','@web/core/checkbox/checkbox','@web/core/registry','@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{AccordionItem}=require("@web/core/dropdown/accordion_item");const{CheckBox}=require("@web/core/checkbox/checkbox");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{Component,useRef,useState}=require("@odoo/owl");const favoriteMenuRegistry=registry.category("favoriteMenu");const CustomFavoriteItem=__exports.CustomFavoriteItem=class CustomFavoriteItem extends Component{setup(){this.notificationService=useService("notification");this.descriptionRef=useRef("description");this.state=useState({description:this.env.config.getDisplayName(),isDefault:false,isShared:false,});}
saveFavorite(ev){if(!this.state.description){this.notificationService.add(_t("A name for your favorite filter is required."),{type:"danger",});ev.stopPropagation();return this.descriptionRef.el.focus();}
const favorites=this.env.searchModel.getSearchItems((s)=>s.type==="favorite"&&s.description===this.state.description);if(favorites.length){this.notificationService.add(_t("A filter with same name already exists."),{type:"danger",});ev.stopPropagation();return this.descriptionRef.el.focus();}
const{description,isDefault,isShared}=this.state;this.env.searchModel.createNewFavorite({description,isDefault,isShared});Object.assign(this.state,{description:this.env.config.getDisplayName(),isDefault:false,isShared:false,});}
onDefaultCheckboxChange(checked){this.state.isDefault=checked;if(checked){this.state.isShared=false;}}
onShareCheckboxChange(checked){this.state.isShared=checked;if(checked){this.state.isDefault=false;}}
onInputKeydown(ev){switch(ev.key){case"Enter":ev.preventDefault();this.saveFavorite(ev);break;case"Escape":ev.preventDefault();ev.target.blur();break;}}}
CustomFavoriteItem.template="web.CustomFavoriteItem";CustomFavoriteItem.components={CheckBox,AccordionItem};CustomFavoriteItem.props={};favoriteMenuRegistry.add("custom-favorite-item",{Component:CustomFavoriteItem,groupNumber:3},{sequence:0});return __exports;});;

/* /web/static/src/search/custom_group_by_item/custom_group_by_item.js */
odoo.define('@web/search/custom_group_by_item/custom_group_by_item',['@odoo/owl'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const CustomGroupByItem=__exports.CustomGroupByItem=class CustomGroupByItem extends Component{get choices(){return this.props.fields.map((f)=>({label:f.string,value:f.name}));}
onSelected(ev){if(ev.target.value){this.props.onAddCustomGroup(ev.target.value);ev.target.value="";}}}
CustomGroupByItem.template="web.CustomGroupByItem";CustomGroupByItem.props={fields:Array,onAddCustomGroup:Function,};return __exports;});;

/* /web/static/src/search/layout.js */
odoo.define('@web/search/layout',['@odoo/owl','@web/search/control_panel/control_panel','@web/search/search_panel/search_panel'],function(require){'use strict';let __exports={};const{Component,useRef}=require("@odoo/owl");const{ControlPanel}=require("@web/search/control_panel/control_panel");const{SearchPanel}=require("@web/search/search_panel/search_panel");__exports.extractLayoutComponents=extractLayoutComponents;function extractLayoutComponents(params){const layoutComponents={ControlPanel:params.ControlPanel||ControlPanel,SearchPanel:params.SearchPanel||SearchPanel,};if(params.Banner){layoutComponents.Banner=params.Banner;}
return layoutComponents;}
const Layout=__exports.Layout=class Layout extends Component{setup(){this.components=extractLayoutComponents(this.env.config);this.contentRef=useRef("content");}
get controlPanelSlots(){const slots={...this.props.slots};delete slots.default;return slots;}
get display(){const{controlPanel}=this.props.display;if(!controlPanel||!this.env.inDialog){return this.props.display;}
return{...this.props.display,controlPanel,};}}
Layout.template="web.Layout";Layout.props={className:{type:String,optional:true},display:{type:Object,optional:true},slots:{type:Object,optional:true},};Layout.defaultProps={display:{},};return __exports;});;

/* /web/static/src/search/pager_hook.js */
odoo.define('@web/search/pager_hook',['@odoo/owl'],function(require){'use strict';let __exports={};const{useEnv,useSubEnv,useState,onWillRender}=require("@odoo/owl");__exports.usePager=usePager;function usePager(getProps){const env=useEnv();const pagerState=useState({});useSubEnv({config:{...env.config,pagerProps:pagerState,},});onWillRender(()=>{Object.assign(pagerState,getProps()||{total:0});});}
return __exports;});;

/* /web/static/src/search/properties_group_by_item/properties_group_by_item.js */
odoo.define('@web/search/properties_group_by_item/properties_group_by_item',['@web/core/dropdown/accordion_item','@web/core/dropdown/checkbox_item','@web/core/dropdown/dropdown_item','@odoo/owl'],function(require){'use strict';let __exports={};const{AccordionItem,ACCORDION}=require("@web/core/dropdown/accordion_item");const{CheckboxItem}=require("@web/core/dropdown/checkbox_item");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{Component,useState,useChildSubEnv}=require("@odoo/owl");const PropertiesGroupByItem=__exports.PropertiesGroupByItem=class PropertiesGroupByItem extends Component{static template="web.PropertiesGroupByItem";static components={AccordionItem,CheckboxItem,DropdownItem};static props={item:Object,onGroup:Function,};setup(){this.state=useState({groupByItems:[]});useChildSubEnv({[ACCORDION]:{accordionStateChanged:this.beforeOpen.bind(this),},});}
get isActive(){return this.state.groupByItems.some((item)=>item.isActive);}
get isSingleParent(){const uniqueNames=new Set(this.state.groupByItems.map((item)=>item.definitionRecordId));return uniqueNames.size<2;}
async beforeOpen(){if(this.definitionLoaded){return;}
this.definitionLoaded=true;await this.env.searchModel.fillSearchViewItemsProperty();this._updateGroupByItems();}
onGroup(ids){this.props.onGroup(ids);this._updateGroupByItems();}
_updateGroupByItems(){this.state.groupByItems=this.env.searchModel.getSearchItems((searchItem)=>["groupBy","dateGroupBy"].includes(searchItem.type)&&searchItem.isProperty&&searchItem.propertyFieldName===this.props.item.fieldName);}}
return __exports;});;

/* /web/static/src/search/search_arch_parser.js */
odoo.define('@web/search/search_arch_parser',['@web/core/context','@web/core/l10n/translation','@web/core/py_js/py','@web/core/utils/xml','@web/search/utils/dates'],function(require){'use strict';let __exports={};const{makeContext}=require("@web/core/context");const{_t}=require("@web/core/l10n/translation");const{evaluateExpr,evaluateBooleanExpr}=require("@web/core/py_js/py");const{visitXML}=require("@web/core/utils/xml");const{DEFAULT_INTERVAL,DEFAULT_PERIOD}=require("@web/search/utils/dates");const ALL=_t("All");const DEFAULT_LIMIT=200;const DEFAULT_VIEWS_WITH_SEARCH_PANEL=["kanban","list"];function getContextGroubBy(context){try{return makeContext([context]).group_by.split(":");}catch{return[];}}
function reduceType(type){if(type==="dateFilter"){return"filter";}
if(type==="dateGroupBy"){return"groupBy";}
return type;}
const SearchArchParser=__exports.SearchArchParser=class SearchArchParser{constructor(searchViewDescription,fields,searchDefaults={},searchPanelDefaults={}){const{irFilters,arch}=searchViewDescription;this.fields=fields||{};this.irFilters=irFilters||[];this.arch=arch||"<search/>";this.labels=[];this.preSearchItems=[];this.searchPanelInfo={className:"",viewTypes:DEFAULT_VIEWS_WITH_SEARCH_PANEL,};this.sections=[];this.searchDefaults=searchDefaults;this.searchPanelDefaults=searchPanelDefaults;this.currentGroup=[];this.currentTag=null;this.groupNumber=0;this.pregroupOfGroupBys=[];}
parse(){visitXML(this.arch,(node,visitChildren)=>{switch(node.tagName){case"search":this.visitSearch(node,visitChildren);break;case"searchpanel":return this.visitSearchPanel(node);case"group":this.visitGroup(node,visitChildren);break;case"separator":this.visitSeparator();break;case"field":this.visitField(node);break;case"filter":this.visitFilter(node);break;}});return{labels:this.labels,preSearchItems:this.preSearchItems,searchPanelInfo:this.searchPanelInfo,sections:this.sections,};}
pushGroup(tag=null){if(this.currentGroup.length){if(this.currentTag==="groupBy"){this.pregroupOfGroupBys.push(...this.currentGroup);}else{this.preSearchItems.push(this.currentGroup);}}
this.currentTag=tag;this.currentGroup=[];this.groupNumber++;}
visitField(node){this.pushGroup("field");const preField={type:"field"};if(node.hasAttribute("invisible")){preField.invisible=node.getAttribute("invisible");}
if(node.hasAttribute("domain")){preField.domain=node.getAttribute("domain");}
if(node.hasAttribute("filter_domain")){preField.filterDomain=node.getAttribute("filter_domain");}else if(node.hasAttribute("operator")){preField.operator=node.getAttribute("operator");}
if(node.hasAttribute("context")){preField.context=node.getAttribute("context");}
if(node.hasAttribute("name")){const name=node.getAttribute("name");const fieldType=this.fields[name].type;preField.fieldName=name;preField.fieldType=fieldType;if(fieldType!=="properties"&&name in this.searchDefaults){preField.isDefault=true;let value=this.searchDefaults[name];value=Array.isArray(value)?value[0]:value;let operator=preField.operator;if(!operator){let type=fieldType;if(node.hasAttribute("widget")){type=node.getAttribute("widget");}
if(["char","html","many2many","one2many","text"].includes(type)){operator="ilike";}else{operator="=";}}
preField.defaultRank=-10;const{selection,context,relation}=this.fields[name];preField.defaultAutocompleteValue={label:`${value}`,operator,value};if(fieldType==="selection"){const option=selection.find((sel)=>sel[0]===value);if(!option){throw Error();}
preField.defaultAutocompleteValue.label=option[1];}else if(fieldType==="many2one"){this.labels.push((orm)=>{return orm.call(relation,"read",[value,["display_name"]],{context}).then((results)=>{preField.defaultAutocompleteValue.label=results[0]["display_name"];});});}}}else{throw Error();}
if(node.hasAttribute("string")){preField.description=node.getAttribute("string");}else if(preField.fieldName){preField.description=this.fields[preField.fieldName].string;}else{preField.description="";}
this.currentGroup.push(preField);}
visitFilter(node){const preSearchItem={type:"filter"};if(node.hasAttribute("context")){const context=node.getAttribute("context");const[fieldName,defaultInterval]=getContextGroubBy(context);const groupByField=this.fields[fieldName];if(groupByField){preSearchItem.type="groupBy";preSearchItem.fieldName=fieldName;preSearchItem.fieldType=groupByField.type;if(["date","datetime"].includes(groupByField.type)){preSearchItem.type="dateGroupBy";preSearchItem.defaultIntervalId=defaultInterval||DEFAULT_INTERVAL;}}else{preSearchItem.context=context;}}
if(reduceType(preSearchItem.type)!==this.currentTag){this.pushGroup(reduceType(preSearchItem.type));}
if(preSearchItem.type==="filter"){if(node.hasAttribute("date")){const fieldName=node.getAttribute("date");preSearchItem.type="dateFilter";preSearchItem.fieldName=fieldName;preSearchItem.fieldType=this.fields[fieldName].type;preSearchItem.defaultGeneratorIds=[DEFAULT_PERIOD];if(node.hasAttribute("default_period")){preSearchItem.defaultGeneratorIds=node.getAttribute("default_period").split(",");}}else{let stringRepr="[]";if(node.hasAttribute("domain")){stringRepr=node.getAttribute("domain");}
preSearchItem.domain=stringRepr;}}
if(node.hasAttribute("invisible")){preSearchItem.invisible=node.getAttribute("invisible");const fieldName=preSearchItem.fieldName;if(fieldName&&!this.fields[fieldName]){return;}}
preSearchItem.groupNumber=this.groupNumber;if(node.hasAttribute("name")){const name=node.getAttribute("name");preSearchItem.name=name;if(name in this.searchDefaults){preSearchItem.isDefault=true;if(["groupBy","dateGroupBy"].includes(preSearchItem.type)){const value=this.searchDefaults[name];preSearchItem.defaultRank=typeof value==="number"?value:100;}else{preSearchItem.defaultRank=-5;}}}
if(node.hasAttribute("string")){preSearchItem.description=node.getAttribute("string");}else if(preSearchItem.fieldName){preSearchItem.description=this.fields[preSearchItem.fieldName].string;}else if(node.hasAttribute("help")){preSearchItem.description=node.getAttribute("help");}else if(node.hasAttribute("name")){preSearchItem.description=node.getAttribute("name");}else{preSearchItem.description="";}
this.currentGroup.push(preSearchItem);}
visitGroup(node,visitChildren){this.pushGroup();visitChildren();this.pushGroup();}
visitSearch(node,visitChildren){visitChildren();this.pushGroup();if(this.pregroupOfGroupBys.length){this.preSearchItems.push(this.pregroupOfGroupBys);}}
visitSearchPanel(searchPanelNode){let hasCategoryWithCounters=false;let hasFilterWithDomain=false;let nextSectionId=1;if(searchPanelNode.hasAttribute("class")){this.searchPanelInfo.className=searchPanelNode.getAttribute("class");}
if(searchPanelNode.hasAttribute("view_types")){this.searchPanelInfo.viewTypes=searchPanelNode.getAttribute("view_types").split(",");}
for(const node of searchPanelNode.children){if(node.nodeType!==1||node.tagName!=="field"){continue;}
if(node.getAttribute("invisible")==="True"||node.getAttribute("invisible")==="1"){continue;}
const attrs={};for(const attrName of node.getAttributeNames()){attrs[attrName]=node.getAttribute(attrName);}
const type=attrs.select==="multi"?"filter":"category";const section={color:attrs.color||null,description:attrs.string||this.fields[attrs.name].string,enableCounters:evaluateBooleanExpr(attrs.enable_counters),expand:evaluateBooleanExpr(attrs.expand),fieldName:attrs.name,icon:attrs.icon||null,id:nextSectionId++,limit:evaluateExpr(attrs.limit||String(DEFAULT_LIMIT)),type,values:new Map(),};if(type==="category"){section.activeValueId=this.searchPanelDefaults[attrs.name];section.icon=section.icon||"fa-folder";section.hierarchize=evaluateBooleanExpr(attrs.hierarchize||"1");section.values.set(false,{childrenIds:[],display_name:ALL.toString(),id:false,bold:true,parentId:false,});hasCategoryWithCounters=hasCategoryWithCounters||section.enableCounters;}else{section.domain=attrs.domain||"[]";section.groupBy=attrs.groupby||null;section.icon=section.icon||"fa-filter";hasFilterWithDomain=hasFilterWithDomain||section.domain!=="[]";}
this.sections.push([section.id,section]);}
if(hasCategoryWithCounters&&hasFilterWithDomain){for(const section of this.sections){if(section.type==="category"){section.enableCounters=false;}}
console.warn("Warning: categories with counters are incompatible with filters having a domain attribute.","All category counters have been disabled to avoid inconsistencies.");}
return false;}
visitSeparator(){this.pushGroup();}}
return __exports;});;

/* /web/static/src/search/search_bar/search_bar.js */
odoo.define('@web/search/search_bar/search_bar',['@web/core/domain','@web/core/l10n/dates','@web/core/registry','@web/core/utils/concurrency','@web/core/utils/hooks','@web/core/domain_selector_dialog/domain_selector_dialog','@web/core/utils/search','@web/core/l10n/translation','@web/search/search_bar_menu/search_bar_menu','@odoo/owl'],function(require){'use strict';let __exports={};const{Domain}=require("@web/core/domain");const{serializeDate,serializeDateTime}=require("@web/core/l10n/dates");const{registry}=require("@web/core/registry");const{KeepLast}=require("@web/core/utils/concurrency");const{useAutofocus,useBus,useService}=require("@web/core/utils/hooks");const{DomainSelectorDialog}=require("@web/core/domain_selector_dialog/domain_selector_dialog");const{fuzzyTest}=require("@web/core/utils/search");const{_t}=require("@web/core/l10n/translation");const{SearchBarMenu}=require("@web/search/search_bar_menu/search_bar_menu");const{Component,useExternalListener,useRef,useState}=require("@odoo/owl");const parsers=registry.category("parsers");const CHAR_FIELDS=["char","html","many2many","many2one","one2many","text","properties"];const FOLDABLE_TYPES=["properties","many2one","many2many"];let nextItemId=1;const SearchBar=__exports.SearchBar=class SearchBar extends Component{setup(){this.dialogService=useService("dialog");this.fields=this.env.searchModel.searchViewFields;this.searchItemsFields=this.env.searchModel.getSearchItems((f)=>f.type==="field");this.root=useRef("root");this.ui=useService("ui");this.state=useState({expanded:[],focusedIndex:0,query:"",});this.items=useState([]);this.subItems={};this.orm=useService("orm");this.keepLast=new KeepLast();this.inputRef=this.env.config.disableSearchBarAutofocus||!this.props.autofocus?useRef("autofocus"):useAutofocus();useBus(this.env.searchModel,"focus-search",()=>{this.inputRef.el.focus();});useBus(this.env.searchModel,"update",this.render);useExternalListener(window,"click",this.onWindowClick);useExternalListener(window,"keydown",this.onWindowKeydown);}
getSearchItem(id){return this.env.searchModel.searchItems[id];}
async computeState(options={}){const query="query"in options?options.query:this.state.query;const expanded="expanded"in options?options.expanded:this.state.expanded;const focusedIndex="focusedIndex"in options?options.focusedIndex:this.state.focusedIndex;const subItems="subItems"in options?options.subItems:this.subItems;const tasks=[];for(const id of expanded){const searchItem=this.getSearchItem(id);if(searchItem.type==="field"&&searchItem.fieldType==="properties"){tasks.push({id,prom:this.getSearchItemsProperties(searchItem)});}else if(!subItems[id]){tasks.push({id,prom:this.computeSubItems(searchItem,query)});}}
const prom=this.keepLast.add(Promise.all(tasks.map((task)=>task.prom)));if(tasks.length){const taskResults=await prom;tasks.forEach((task,index)=>{subItems[task.id]=taskResults[index];});}
this.state.expanded=expanded;this.state.query=query;this.state.focusedIndex=focusedIndex;this.subItems=subItems;this.inputRef.el.value=query;const trimmedQuery=this.state.query.trim();this.items.length=0;if(!trimmedQuery){return;}
for(const searchItem of this.searchItemsFields){this.items.push(...this.getItems(searchItem,trimmedQuery));}}
getItems(searchItem,trimmedQuery){const items=[];const isFieldProperty=searchItem.type==="field_property";const fieldType=this.getFieldType(searchItem);let preposition=this.getPreposition(searchItem);if((isFieldProperty&&FOLDABLE_TYPES.includes(fieldType))||fieldType==="properties"){preposition=null;}
if(["selection","boolean","tags"].includes(fieldType)){const booleanOptions=[[true,_t("Yes")],[false,_t("No")],];let options;if(isFieldProperty){const{selection,tags}=searchItem.propertyFieldDefinition||{};options=selection||tags||booleanOptions;}else{options=this.fields[searchItem.fieldName].selection||booleanOptions;}
for(const[value,label]of options){if(fuzzyTest(trimmedQuery.toLowerCase(),label.toLowerCase())){items.push({id:nextItemId++,searchItemDescription:searchItem.description,preposition,searchItemId:searchItem.id,label,operator:searchItem.operator||"=",value,isFieldProperty,});}}
return items;}
const parser=parsers.contains(fieldType)?parsers.get(fieldType):(str)=>str;let value;try{switch(fieldType){case"date":{value=serializeDate(parser(trimmedQuery));break;}
case"datetime":{value=serializeDateTime(parser(trimmedQuery));break;}
case"many2one":{value=trimmedQuery;break;}
default:{value=parser(trimmedQuery);}}}catch{return[];}
const item={id:nextItemId++,searchItemDescription:searchItem.description,preposition,searchItemId:searchItem.id,label:this.state.query,operator:searchItem.operator||(CHAR_FIELDS.includes(fieldType)?"ilike":"="),value,isFieldProperty,};if(isFieldProperty){item.isParent=FOLDABLE_TYPES.includes(fieldType);item.unselectable=FOLDABLE_TYPES.includes(fieldType);item.propertyItemId=searchItem.propertyItemId;}else if(fieldType==="properties"){item.isParent=true;item.unselectable=true;}else if(fieldType==="many2one"){item.isParent=true;}
if(item.isParent){item.isExpanded=this.state.expanded.includes(item.searchItemId);}
items.push(item);if(item.isExpanded){if(searchItem.type==="field"&&searchItem.fieldType==="properties"){for(const subItem of this.subItems[searchItem.id]){items.push(...this.getItems(subItem,trimmedQuery));}}else{items.push(...this.subItems[searchItem.id]);}}
return items;}
getPreposition(searchItem){const fieldType=this.getFieldType(searchItem);return["date","datetime"].includes(fieldType)?_t("at"):_t("for");}
getFieldType(searchItem){const{type}=searchItem.type==="field_property"?searchItem.propertyFieldDefinition:this.fields[searchItem.fieldName];const fieldType=type==="reference"?"char":type;return fieldType}
getSearchItemsProperties(searchItem){return this.env.searchModel.getSearchItemsProperties(searchItem);}
async computeSubItems(searchItem,query){const field=this.fields[searchItem.fieldName];let domain=[];if(searchItem.domain){try{domain=new Domain(searchItem.domain).toList();}catch{}}
const relation=searchItem.type==="field_property"?searchItem.propertyFieldDefinition.comodel:field.relation;const options=await this.orm.call(relation,"name_search",[],{args:domain,context:{...this.env.searchModel.globalContext,...field.context},limit:8,name:query.trim(),});const subItems=[];if(options.length){const operator=searchItem.operator||"=";for(const[value,label]of options){subItems.push({id:nextItemId++,isChild:true,searchItemId:searchItem.id,value,label,operator,});}}else{subItems.push({id:nextItemId++,isChild:true,searchItemId:searchItem.id,label:_t("(no result)"),unselectable:true,});}
return subItems;}
focusFacet(index){const facets=this.root.el.getElementsByClassName("o_searchview_facet");if(facets.length){if(index===undefined){facets[facets.length-1].focus();}else{facets[index].focus();}}}
removeFacet(facet){this.env.searchModel.deactivateGroup(facet.groupId);this.inputRef.el.focus();}
resetState(){this.computeState({expanded:[],focusedIndex:0,query:"",subItems:[]});this.inputRef.el.focus();}
selectItem(item){const searchItem=this.getSearchItem(item.searchItemId);if((searchItem.type==="field"&&searchItem.fieldType==="properties")||(searchItem.type==="field_property"&&item.unselectable)){this.toggleItem(item,!item.isExpanded);return;}
if(!item.unselectable){const{searchItemId,label,operator,value}=item;this.env.searchModel.addAutoCompletionValues(searchItemId,{label,operator,value});}
this.resetState();}
toggleItem(item,shouldExpand){const id=item.searchItemId;const expanded=[...this.state.expanded];const index=expanded.findIndex((id0)=>id0===id);if(shouldExpand===true){if(index<0){expanded.push(id);}}else{if(index>=0){expanded.splice(index,1);}}
this.computeState({expanded});}
onFacetLabelClick(target,facet){const{domain,groupId}=facet;if(!domain){return;}
const{resModel}=this.env.searchModel;this.dialogService.add(DomainSelectorDialog,{resModel,domain,context:this.env.searchModel.domainEvalContext,onConfirm:(domain)=>this.env.searchModel.splitAndAddDomain(domain,groupId),disableConfirmButton:(domain)=>domain===`[]`,title:_t("Modify Condition"),isDebugMode:this.env.searchModel.isDebugMode,});}
onFacetKeydown(facet,facetIndex,ev){switch(ev.key){case"ArrowLeft":{if(facetIndex===0){this.inputRef.el.focus();}else{this.focusFacet(facetIndex-1);}
break;}
case"ArrowRight":{const facets=this.root.el.getElementsByClassName("o_searchview_facet");if(facetIndex===facets.length-1){this.inputRef.el.focus();}else{this.focusFacet(facetIndex+1);}
break;}
case"Backspace":{this.removeFacet(facet);break;}}}
onFacetRemove(facet){this.removeFacet(facet);}
onItemMousemove(focusedIndex){this.state.focusedIndex=focusedIndex;this.inputRef.el.focus();}
onSearchKeydown(ev){if(ev.isComposing){return;}
const focusedItem=this.items[this.state.focusedIndex];let focusedIndex;switch(ev.key){case"ArrowDown":ev.preventDefault();if(this.items.length){if(this.state.focusedIndex>=this.items.length-1){focusedIndex=0;}else{focusedIndex=this.state.focusedIndex+1;}}else{this.env.searchModel.trigger("focus-view");}
break;case"ArrowUp":ev.preventDefault();if(this.items.length){if(this.state.focusedIndex===0||this.state.focusedIndex>this.items.length-1){focusedIndex=this.items.length-1;}else{focusedIndex=this.state.focusedIndex-1;}}
break;case"ArrowLeft":if(focusedItem&&focusedItem.isParent&&focusedItem.isExpanded){ev.preventDefault();this.toggleItem(focusedItem,false);}else if(focusedItem&&focusedItem.isChild){ev.preventDefault();focusedIndex=this.items.findIndex((item)=>item.isParent&&item.searchItemId===focusedItem.searchItemId);}else if(focusedItem&&focusedItem.isFieldProperty){ev.preventDefault();focusedIndex=this.items.findIndex((item)=>item.isParent&&item.searchItemId===focusedItem.propertyItemId);}else if(ev.target.selectionStart===0){this.focusFacet();}else{}
break;case"ArrowRight":if(ev.target.selectionStart===this.state.query.length){if(focusedItem&&focusedItem.isParent){ev.preventDefault();if(focusedItem.isExpanded){focusedIndex=this.state.focusedIndex+1;}else{this.toggleItem(focusedItem,true);}}else if(ev.target.selectionStart===this.state.query.length){this.focusFacet(0);}}
break;case"Backspace":if(!this.state.query.length){const facets=this.env.searchModel.facets;if(facets.length){this.removeFacet(facets[facets.length-1]);}}
break;case"Enter":if(!this.state.query.length){this.env.searchModel.search();break;}else if(focusedItem){ev.preventDefault();this.selectItem(focusedItem);}
break;case"Tab":if(this.state.query.length&&focusedItem){ev.preventDefault();this.selectItem(focusedItem);}
break;case"Escape":this.resetState();break;}
if(focusedIndex!==undefined){this.state.focusedIndex=focusedIndex;}}
onSearchInput(ev){const query=ev.target.value;if(query.trim()){this.computeState({query,expanded:[],focusedIndex:0,subItems:[]});}else if(this.items.length){this.resetState();}}
onToggleSearchBar(){this.state.showSearchBar=!this.state.showSearchBar;}
onWindowClick(ev){if(this.items.length&&!this.root.el.contains(ev.target)){this.resetState();}}
onWindowKeydown(ev){if(this.items.length&&ev.key==="Escape"){this.resetState();}}}
SearchBar.template="web.SearchBar";SearchBar.components={SearchBarMenu,};SearchBar.props={autofocus:{type:Boolean,optional:true},slots:{type:Object,optional:true,shape:{default:{optional:true},"search-bar-additional-menu":{optional:true},},},};SearchBar.defaultProps={autofocus:true,};return __exports;});;

/* /web/static/src/search/search_bar/search_bar_toggler.js */
odoo.define('@web/search/search_bar/search_bar_toggler',['@odoo/owl','@web/core/browser/browser','@web/core/utils/hooks','@web/core/utils/timing'],function(require){'use strict';let __exports={};const{Component,useEffect,useState}=require("@odoo/owl");const{browser}=require("@web/core/browser/browser");const{useService}=require("@web/core/utils/hooks");const{useDebounced}=require("@web/core/utils/timing");const SearchBarToggler=__exports.SearchBarToggler=class SearchBarToggler extends Component{}
SearchBarToggler.template="web.SearchBar.Toggler";SearchBarToggler.props={isSmall:Boolean,showSearchBar:Boolean,toggleSearchBar:Function,};__exports.useSearchBarToggler=useSearchBarToggler;function useSearchBarToggler(){const ui=useService("ui");let isToggled=false;const state=useState({isSmall:ui.isSmall,showSearchBar:false,});const updateState=()=>{state.isSmall=ui.isSmall;state.showSearchBar=!ui.isSmall||isToggled;};updateState();function toggleSearchBar(){isToggled=!isToggled;updateState();}
const onResize=useDebounced(updateState,200);useEffect(()=>{browser.addEventListener("resize",onResize);return()=>browser.removeEventListener("resize",onResize);},()=>[]);return{state,component:SearchBarToggler,get props(){return{isSmall:state.isSmall,showSearchBar:state.showSearchBar,toggleSearchBar,};},};}
return __exports;});;

/* /web/static/src/search/search_bar_menu/search_bar_menu.js */
odoo.define('@web/search/search_bar_menu/search_bar_menu',['@odoo/owl','@web/core/confirmation_dialog/confirmation_dialog','@web/core/domain_selector_dialog/domain_selector_dialog','@web/core/dropdown/dropdown','@web/search/properties_group_by_item/properties_group_by_item','@web/core/dropdown/dropdown_item','@web/core/registry','@web/core/utils/arrays','@web/core/utils/hooks','@web/core/dropdown/accordion_item','@web/search/custom_group_by_item/custom_group_by_item','@web/core/dropdown/checkbox_item','@web/search/utils/misc','@web/core/domain_selector/utils','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{ConfirmationDialog}=require("@web/core/confirmation_dialog/confirmation_dialog");const{DomainSelectorDialog}=require("@web/core/domain_selector_dialog/domain_selector_dialog");const{Dropdown}=require("@web/core/dropdown/dropdown");const{PropertiesGroupByItem}=require("@web/search/properties_group_by_item/properties_group_by_item");const{DropdownItem}=require("@web/core/dropdown/dropdown_item");const{registry}=require("@web/core/registry");const{sortBy}=require("@web/core/utils/arrays");const{useBus,useService}=require("@web/core/utils/hooks");const{AccordionItem}=require("@web/core/dropdown/accordion_item");const{CustomGroupByItem}=require("@web/search/custom_group_by_item/custom_group_by_item");const{CheckboxItem}=require("@web/core/dropdown/checkbox_item");const{FACET_ICONS,GROUPABLE_TYPES}=require("@web/search/utils/misc");const{useGetDefaultLeafDomain}=require("@web/core/domain_selector/utils");const{_t}=require("@web/core/l10n/translation");const favoriteMenuRegistry=registry.category("favoriteMenu");const SearchBarMenu=__exports.SearchBarMenu=class SearchBarMenu extends Component{static template="web.SearchBarMenu";static components={Dropdown,DropdownItem,CheckboxItem,CustomGroupByItem,AccordionItem,PropertiesGroupByItem,};static props={slots:{type:Object,optional:true,shape:{default:{optional:true},},},};setup(){this.facet_icons=FACET_ICONS;this.dialogService=useService("dialog");this.getDefaultLeafDomain=useGetDefaultLeafDomain();const fields=[];for(const[fieldName,field]of Object.entries(this.env.searchModel.searchViewFields)){if(this.validateField(fieldName,field)){fields.push(Object.assign({name:fieldName},field));}}
this.fields=sortBy(fields,"string");this.dialogService=useService("dialog");useBus(this.env.searchModel,"update",this.render);}
get filterItems(){return this.env.searchModel.getSearchItems((searchItem)=>["filter","dateFilter"].includes(searchItem.type));}
async onAddCustomFilterClick(){const{domainEvalContext:context,resModel}=this.env.searchModel;const domain=await this.getDefaultLeafDomain(resModel);this.dialogService.add(DomainSelectorDialog,{resModel,defaultConnector:"|",domain,context,onConfirm:(domain)=>this.env.searchModel.splitAndAddDomain(domain),disableConfirmButton:(domain)=>domain===`[]`,title:_t("Add Custom Filter"),confirmButtonText:_t("Add"),discardButtonText:_t("Cancel"),isDebugMode:this.env.searchModel.isDebugMode,});}
onFilterSelected({itemId,optionId}){if(optionId){this.env.searchModel.toggleDateFilter(itemId,optionId);}else{this.env.searchModel.toggleSearchItem(itemId);}}
get hideCustomGroupBy(){return this.env.searchModel.hideCustomGroupBy||false;}
get groupByItems(){return this.env.searchModel.getSearchItems((searchItem)=>["groupBy","dateGroupBy"].includes(searchItem.type)&&!searchItem.isProperty);}
validateField(fieldName,field){const{sortable,store,type}=field;return((type==="many2many"?store:sortable)&&fieldName!=="id"&&GROUPABLE_TYPES.includes(type));}
onGroupBySelected({itemId,optionId}){if(optionId){this.env.searchModel.toggleDateGroupBy(itemId,optionId);}else{this.env.searchModel.toggleSearchItem(itemId);}}
onAddCustomGroup(fieldName){this.env.searchModel.createNewGroupBy(fieldName);}
get showComparisonMenu(){return(this.env.searchModel.searchMenuTypes.has("comparison")&&this.env.searchModel.getSearchItems((i)=>i.type==="comparison").length>0);}
get comparisonItems(){return this.env.searchModel.getSearchItems((searchItem)=>searchItem.type==="comparison");}
onComparisonSelected(itemId){this.env.searchModel.toggleSearchItem(itemId);}
get favoriteItems(){const favorites=this.env.searchModel.getSearchItems((searchItem)=>searchItem.type==="favorite");const registryMenus=[];for(const item of favoriteMenuRegistry.getAll()){if("isDisplayed"in item?item.isDisplayed(this.env):true){registryMenus.push({Component:item.Component,groupNumber:item.groupNumber,key:item.Component.name,});}}
return[...favorites,...registryMenus];}
onFavoriteSelected(itemId){this.env.searchModel.toggleSearchItem(itemId);}
openConfirmationDialog(itemId){const{userId}=this.favoriteItems.find((item)=>item.id===itemId);const dialogProps={title:_t("Warning"),body:userId?_t("Are you sure that you want to remove this filter?"):_t("This filter is global and will be removed for everyone."),confirmLabel:_t("Delete Filter"),confirm:()=>this.env.searchModel.deleteFavorite(itemId),cancel:()=>{},};this.dialogService.add(ConfirmationDialog,dialogProps);}}
return __exports;});;

/* /web/static/src/search/search_model.js */
odoo.define('@web/search/search_model',['@web/core/context','@web/core/domain','@web/core/py_js/py','@web/core/utils/arrays','@web/core/utils/objects','@web/search/search_arch_parser','@web/search/utils/dates','@web/search/utils/misc','@odoo/owl','@web/core/tree_editor/condition_tree','@web/core/l10n/translation','@web/core/domain_selector/utils'],function(require){'use strict';let __exports={};const{makeContext}=require("@web/core/context");const{Domain}=require("@web/core/domain");const{evaluateExpr}=require("@web/core/py_js/py");const{sortBy,groupBy}=require("@web/core/utils/arrays");const{deepCopy}=require("@web/core/utils/objects");const{SearchArchParser}=require("@web/search/search_arch_parser");const{constructDateDomain,DEFAULT_INTERVAL,getComparisonOptions,getIntervalOptions,getPeriodOptions,rankInterval,yearSelected,}=require("@web/search/utils/dates");const{FACET_ICONS,FACET_COLORS}=require("@web/search/utils/misc");const{EventBus,toRaw}=require("@odoo/owl");const{domainFromTree,treeFromDomain}=require("@web/core/tree_editor/condition_tree");const{_t}=require("@web/core/l10n/translation");const{useGetDomainTreeDescription}=require("@web/core/domain_selector/utils");const{DateTime}=luxon;function hasValues(section){const{errorMsg,type,values}=section;if(errorMsg){return true;}
switch(type){case"category":{return values&&values.size>1;}
case"filter":{return values&&values.size>0;}}}
function mapToArray(map){const result=[];for(const[key,val]of map){const valCopy=Object.assign({},val);result.push([key,valCopy]);}
return result;}
function arraytoMap(array){return new Map(array);}
function execute(op,source,target){const{query,nextId,nextGroupId,nextGroupNumber,searchItems,searchPanelInfo,sections}=source;target.nextGroupId=nextGroupId;target.nextGroupNumber=nextGroupNumber;target.nextId=nextId;target.query=query;target.searchItems=searchItems;target.searchPanelInfo=searchPanelInfo;target.sections=op(sections);for(const[,section]of target.sections){section.values=op(section.values);if(section.groups){section.groups=op(section.groups);for(const[,group]of section.groups){group.values=op(group.values);}}}}
const FAVORITE_PRIVATE_GROUP=1;const FAVORITE_SHARED_GROUP=2;const SearchModel=__exports.SearchModel=class SearchModel extends EventBus{constructor(env,services,args){super();this.env=env;this.setup(services,args);}
setup(services){const{field:fieldService,name:nameService,orm,user,view}=services;this.orm=orm;this.fieldService=fieldService;this.userService=user;this.viewService=view;this.getDomainTreeDescription=useGetDomainTreeDescription(fieldService,nameService);this.referenceMoment=DateTime.local();this.comparisonOptions=getComparisonOptions();this.intervalOptions=getIntervalOptions();this.optionGenerators=getPeriodOptions(this.referenceMoment);}
async load(config){const{resModel}=config;if(!resModel){throw Error(`SearchPanel config should have a "resModel" key`);}
this.resModel=resModel;this._reset();const{comparison,context,domain,groupBy,hideCustomGroupBy,orderBy}=config;this.globalComparison=comparison;this.globalContext=toRaw(Object.assign({},context));this.globalDomain=domain||[];this.globalGroupBy=groupBy||[];this.globalOrderBy=orderBy||[];this.hideCustomGroupBy=hideCustomGroupBy;this.searchMenuTypes=new Set(config.searchMenuTypes||["filter","groupBy","favorite"]);let{irFilters,loadIrFilters,searchViewArch,searchViewFields,searchViewId}=config;const loadSearchView=searchViewId!==undefined&&(!searchViewArch||!searchViewFields||(!irFilters&&loadIrFilters));const searchViewDescription={};if(loadSearchView){const result=await this.viewService.loadViews({context:this.globalContext,resModel,views:[[searchViewId,"search"]],},{actionId:this.env.config.actionId,loadIrFilters:loadIrFilters||false,});Object.assign(searchViewDescription,result.views.search);searchViewFields=searchViewFields||result.fields;}
if(searchViewArch){searchViewDescription.arch=searchViewArch;}
if(irFilters){searchViewDescription.irFilters=irFilters;}
if(searchViewId!==undefined){searchViewDescription.viewId=searchViewId;}
this.searchViewArch=searchViewDescription.arch||"<search/>";this.searchViewFields=searchViewFields||{};if(searchViewDescription.irFilters){this.irFilters=searchViewDescription.irFilters;}
if(searchViewDescription.viewId!==undefined){this.searchViewId=searchViewDescription.viewId;}
const{searchDefaults,searchPanelDefaults}=this._extractSearchDefaultsFromGlobalContext();if(config.state){this._importState(config.state);this.__legacyParseSearchPanelArchAnyway(searchViewDescription,searchViewFields);this.display=this._getDisplay(config.display);if(!this.searchPanelInfo.loaded){return this._reloadSections();}
return;}
this.blockNotification=true;this.searchItems={};this.query=[];this.nextId=1;this.nextGroupId=1;this.nextGroupNumber=1;const parser=new SearchArchParser(searchViewDescription,searchViewFields,searchDefaults,searchPanelDefaults);const{labels,preSearchItems,searchPanelInfo,sections}=parser.parse();this.searchPanelInfo={...searchPanelInfo,loaded:false,shouldReload:false};await Promise.all(labels.map((cb)=>cb(this.orm)));for(const preGroup of preSearchItems||[]){this._createGroupOfSearchItems(preGroup);}
this.nextGroupNumber=1+Math.max(...Object.values(this.searchItems).map((i)=>i.groupNumber||0),0);const dateFilters=Object.values(this.searchItems).filter((searchElement)=>searchElement.type==="dateFilter");if(dateFilters.length){this._createGroupOfComparisons(dateFilters);}
const{dynamicFilters}=config;if(dynamicFilters){this._createGroupOfDynamicFilters(dynamicFilters);}
const defaultFavoriteId=this._createGroupOfFavorites(this.irFilters||[]);const activateFavorite="activateFavorite"in config?config.activateFavorite:true;this._activateDefaultSearchItems(activateFavorite?defaultFavoriteId:null);this.sections=new Map(sections||[]);this.display=this._getDisplay(config.display);if(this.display.searchPanel){this.searchDomain=this._getDomain({withSearchPanel:false});this.sectionsPromise=this._fetchSections(this.categories,this.filters).then(()=>{for(const{fieldName,values}of this.filters){const filterDefaults=searchPanelDefaults[fieldName]||[];for(const valueId of filterDefaults){const value=values.get(valueId);if(value){value.checked=true;}}}});if(Object.keys(searchPanelDefaults).length||this._shouldWaitForData(false)){await this.sectionsPromise;}}
this.blockNotification=false;}
async reload(config={}){this._reset();const{comparison,context,domain,groupBy,orderBy}=config;this.globalContext=Object.assign({},context);this.globalDomain=domain||[];this.globalComparison=comparison;this.globalGroupBy=groupBy||[];this.globalOrderBy=orderBy||[];this._extractSearchDefaultsFromGlobalContext();await this._reloadSections();}
get categories(){return[...this.sections.values()].filter((s)=>s.type==="category");}
get context(){if(!this._context){this._context=makeContext([this.globalContext,this._getContext()]);}
return deepCopy(this._context);}
get domain(){if(!this._domain){this._domain=this._getDomain();}
return deepCopy(this._domain);}
get domainString(){return this._getDomain({raw:true}).toString();}
get domainEvalContext(){return Object.assign({},this.globalContext,this.userService.context);}
get comparison(){if(!this.searchMenuTypes.has("comparison")){return null;}
if(this._comparison===undefined){if(this.globalComparison){this._comparison=this.globalComparison;}else{const comparison=this.getFullComparison();if(comparison){const{fieldName,range,rangeDescription,comparisonRange,comparisonRangeDescription,}=comparison;const domains=[{arrayRepr:Domain.and([this.domain,range]).toList(),description:rangeDescription,},{arrayRepr:Domain.and([this.domain,comparisonRange]).toList(),description:comparisonRangeDescription,},];this._comparison={domains,fieldName};}else{this._comparison=null;}}}
return deepCopy(this._comparison);}
get facets(){const isValidType=(type)=>!["groupBy","comparison"].includes(type)||this.searchMenuTypes.has(type);const facets=[];for(const facet of this._getFacets()){if(!isValidType(facet.type)){continue;}
facets.push(facet);}
return facets;}
get filters(){return[...this.sections.values()].filter((s)=>s.type==="filter");}
get groupBy(){if(!this.searchMenuTypes.has("groupBy")){return[];}
if(!this._groupBy){this._groupBy=this._getGroupBy();}
return deepCopy(this._groupBy);}
get orderBy(){if(!this._orderBy){this._orderBy=this._getOrderBy();}
return deepCopy(this._orderBy);}
get isDebugMode(){return!!this.env.debug;}
addAutoCompletionValues(searchItemId,autocompleteValue){const searchItem=this.searchItems[searchItemId];if(!["field","field_property"].includes(searchItem.type)){return;}
const{label,value,operator}=autocompleteValue;const queryElem=this.query.find((queryElem)=>queryElem.searchItemId===searchItemId&&"autocompleteValue"in queryElem&&queryElem.autocompleteValue.value===value&&queryElem.autocompleteValue.operator===operator);if(!queryElem){this.query.push({searchItemId,autocompleteValue});}else{queryElem.autocompleteValue.label=label;}
this._notify();}
clearQuery(){this.query=[];this._notify();}
async createNewFavorite(params){const{preFavorite,irFilter}=this._getIrFilterDescription(params);const serverSideId=await this._createIrFilters(irFilter);this.blockNotification=true;this.clearQuery();const favorite={...preFavorite,type:"favorite",id:this.nextId,groupId:this.nextGroupId,groupNumber:preFavorite.userId?FAVORITE_PRIVATE_GROUP:FAVORITE_SHARED_GROUP,removable:true,serverSideId,};this.searchItems[this.nextId]=favorite;this.query.push({searchItemId:this.nextId});this.nextGroupId++;this.nextId++;this.blockNotification=false;this._notify();}
async _createIrFilters(irFilter){const serverSideId=await this.orm.call("ir.filters","create_or_replace",[irFilter]);this.env.bus.trigger("CLEAR-CACHES");return serverSideId;}
createNewFilters(prefilters){if(!prefilters.length){return[];}
prefilters.forEach((preFilter)=>{const filter=Object.assign(preFilter,{groupId:this.nextGroupId,groupNumber:this.nextGroupNumber,id:this.nextId,type:"filter",});this.searchItems[this.nextId]=filter;this.query.push({searchItemId:this.nextId});this.nextId++;});this.nextGroupId++;this.nextGroupNumber++;this._notify();}
createNewGroupBy(fieldName,{interval,invisible}={}){const field=this.searchViewFields[fieldName];const{string,type:fieldType}=field;const firstGroupBy=Object.values(this.searchItems).find((f)=>f.type==="groupBy");const preSearchItem={description:string||fieldName,fieldName,fieldType,groupId:firstGroupBy?firstGroupBy.groupId:this.nextGroupId++,groupNumber:this.nextGroupNumber,id:this.nextId,custom:true,};if(invisible){preSearchItem.invisible="True";}
if(["date","datetime"].includes(fieldType)){this.searchItems[this.nextId]=Object.assign({type:"dateGroupBy",defaultIntervalId:interval||DEFAULT_INTERVAL},preSearchItem);this.toggleDateGroupBy(this.nextId);}else{this.searchItems[this.nextId]=Object.assign({type:"groupBy"},preSearchItem);this.toggleSearchItem(this.nextId);}
this.nextGroupNumber++;this.nextId++;this._notify();}
deactivateGroup(groupId){this.query=this.query.filter((queryElem)=>{const searchItem=this.searchItems[queryElem.searchItemId];return searchItem.groupId!==groupId;});this._checkComparisonStatus();this._notify();}
async deleteFavorite(favoriteId){const searchItem=this.searchItems[favoriteId];if(searchItem.type!=="favorite"){return;}
await this._deleteIrFilters(searchItem);const index=this.query.findIndex((queryElem)=>queryElem.searchItemId===favoriteId);delete this.searchItems[favoriteId];if(index>=0){this.query.splice(index,1);}
this._notify();}
async _deleteIrFilters(searchItem){const{serverSideId}=searchItem;await this.orm.unlink("ir.filters",[serverSideId]);this.env.bus.trigger("CLEAR-CACHES");}
exportState(){const state={};execute(mapToArray,this,state);return state;}
getFullComparison(){let searchItem=null;for(const queryElem of this.query.slice().reverse()){const item=this.searchItems[queryElem.searchItemId];if(item.type==="comparison"){searchItem=item;break;}else if(item.type==="favorite"&&item.comparison){searchItem=item;break;}}
if(!searchItem){return null;}else if(searchItem.type==="favorite"){return searchItem.comparison;}
const{dateFilterId,comparisonOptionId}=searchItem;const{fieldName,fieldType,description:dateFilterDescription,}=this.searchItems[dateFilterId];const selectedGeneratorIds=this._getSelectedGeneratorIds(dateFilterId);const{domain:range,description:rangeDescription}=constructDateDomain(this.referenceMoment,fieldName,fieldType,selectedGeneratorIds);const{domain:comparisonRange,description:comparisonRangeDescription}=constructDateDomain(this.referenceMoment,fieldName,fieldType,selectedGeneratorIds,comparisonOptionId);return{comparisonId:comparisonOptionId,fieldName,fieldDescription:dateFilterDescription,range:range.toList(),rangeDescription,comparisonRange:comparisonRange.toList(),comparisonRangeDescription,};}
getIrFilterValues(params){const{irFilter}=this._getIrFilterDescription(params);return irFilter;}
getPreFavoriteValues(params){const{preFavorite}=this._getIrFilterDescription(params);return preFavorite;}
getSearchItems(predicate){const searchItems=[];Object.values(this.searchItems).forEach((searchItem)=>{const isInvisible="invisible"in searchItem&&evaluateExpr(searchItem.invisible,this.globalContext);if(!isInvisible&&(!predicate||predicate(searchItem))){const enrichedSearchitem=this._enrichItem(searchItem);if(enrichedSearchitem){searchItems.push(enrichedSearchitem);}}});if(searchItems.some((f)=>f.type==="favorite")){searchItems.sort((f1,f2)=>f1.groupNumber-f2.groupNumber);}
return searchItems;}
getSections(predicate){let sections=[...this.sections.values()].map((section)=>Object.assign({},section,{empty:!hasValues(section)}));if(predicate){sections=sections.filter(predicate);}
return sections.sort((s1,s2)=>s1.index-s2.index);}
search(){this.trigger("update");}
async splitAndAddDomain(domain,groupId){const group=groupId?this._getGroups().find((g)=>g.id===groupId):null;let context;if(group){const contexts=[];for(const activeItem of group.activeItems){const context=this._getSearchItemContext(activeItem);if(context){contexts.push(context);}}
context=makeContext(contexts);}
const tree=treeFromDomain(domain,{distributeNot:!this.isDebugMode});const trees=!tree.negate&&tree.value==="&"?tree.children:[tree];const promises=trees.map(async(tree)=>{const description=await this.getDomainTreeDescription(this.resModel,tree);const preFilter={description,domain:domainFromTree(tree),invisible:"True",type:"filter",};if(context){preFilter.context=context;}
return preFilter;});const preFilters=await Promise.all(promises);this.blockNotification=true;if(group){const firstActiveItem=group.activeItems[0];const firstSearchItem=this.searchItems[firstActiveItem.searchItemId];const{type}=firstSearchItem;if(type==="favorite"){const activeItemGroupBys=this._getSearchItemGroupBys(firstActiveItem);for(const activeItemGroupBy of activeItemGroupBys){const[fieldName,interval]=activeItemGroupBy.split(":");this.createNewGroupBy(fieldName,{interval,invisible:true});}
const index=this.query.length-activeItemGroupBys.length;this.query=[...this.query.slice(index),...this.query.slice(0,index)];}
this.deactivateGroup(groupId);}
for(const preFilter of preFilters){this.createNewFilters([preFilter]);}
this.blockNotification=false;this._notify();}
toggleCategoryValue(sectionId,valueId){const category=this.sections.get(sectionId);category.activeValueId=valueId;this._notify();}
toggleFilterValues(sectionId,valueIds,forceTo=null){const filter=this.sections.get(sectionId);for(const valueId of valueIds){const value=filter.values.get(valueId);value.checked=forceTo===null?!value.checked:forceTo;}
this._notify();}
toggleSearchItem(searchItemId){const searchItem=this.searchItems[searchItemId];switch(searchItem.type){case"dateFilter":case"dateGroupBy":case"field_property":case"field":{return;}}
const index=this.query.findIndex((queryElem)=>queryElem.searchItemId===searchItemId);if(index>=0){this.query.splice(index,1);}else{if(searchItem.type==="favorite"){this.query=[];}else if(searchItem.type==="comparison"){this.query=this.query.filter((queryElem)=>{const{type}=this.searchItems[queryElem.searchItemId];return type!=="comparison";});}
this.query.push({searchItemId});}
this._notify();}
toggleDateFilter(searchItemId,generatorId){const searchItem=this.searchItems[searchItemId];if(searchItem.type!=="dateFilter"){return;}
const generatorIds=generatorId?[generatorId]:searchItem.defaultGeneratorIds;for(const generatorId of generatorIds){const index=this.query.findIndex((queryElem)=>queryElem.searchItemId===searchItemId&&"generatorId"in queryElem&&queryElem.generatorId===generatorId);if(index>=0){this.query.splice(index,1);if(!yearSelected(this._getSelectedGeneratorIds(searchItemId))){this.query=this.query.filter((queryElem)=>queryElem.searchItemId!==searchItemId);}}else{this.query.push({searchItemId,generatorId});if(!yearSelected(this._getSelectedGeneratorIds(searchItemId))){const{defaultYearId}=this.optionGenerators.find((o)=>o.id===generatorId);this.query.push({searchItemId,generatorId:defaultYearId});}}}
this._checkComparisonStatus();this._notify();}
toggleDateGroupBy(searchItemId,intervalId){const searchItem=this.searchItems[searchItemId];if(searchItem.type!=="dateGroupBy"){return;}
intervalId=intervalId||searchItem.defaultIntervalId;const index=this.query.findIndex((queryElem)=>queryElem.searchItemId===searchItemId&&"intervalId"in queryElem&&queryElem.intervalId===intervalId);if(index>=0){this.query.splice(index,1);}else{this.query.push({searchItemId,intervalId});}
this._notify();}
async getSearchItemsProperties(searchItem){if(searchItem.type!=="field"||searchItem.fieldType!=="properties"){return[];}
const field=this.searchViewFields[searchItem.fieldName];const definitionRecord=field.definition_record;const result=await this._fetchPropertiesDefinition(this.resModel,searchItem.fieldName);const searchItemIds=new Set();const existingFieldProperties={};for(const item of Object.values(this.searchItems)){if(item.type==="field_property"&&item.propertyItemId===searchItem.id){existingFieldProperties[item.propertyFieldDefinition.name]=item;}}
for(const{definitionRecordId,definitionRecordName,definitions}of result){for(const definition of definitions){if(definition.type==="separator"){continue;}
const existingSearchItem=existingFieldProperties[definition.name];if(existingSearchItem){existingSearchItem.description=`${definition.string} (${definitionRecordName})`;searchItemIds.add(existingSearchItem.id);continue;}
const id=this.nextId++;const newSearchItem={id,type:"field_property",fieldName:searchItem.fieldName,propertyDomain:[definitionRecord,"=",definitionRecordId],propertyFieldDefinition:definition,propertyItemId:searchItem.id,description:`${definition.string} (${definitionRecordName})`,groupId:this.nextGroupId++,};if(["many2many","tags"].includes(definition.type)){newSearchItem.operator="in";}
this.searchItems[id]=newSearchItem;searchItemIds.add(id);}}
return this.getSearchItems((searchItem)=>searchItemIds.has(searchItem.id));}
async fillSearchViewItemsProperty(){if(!this.searchViewFields){return;}
const fields=Object.values(this.searchViewFields);for(const field of fields){if(field.type!=="properties"){continue;}
const result=await this._fetchPropertiesDefinition(this.resModel,field.name);const searchItemsNames=Object.values(this.searchItems).filter((item)=>item.isProperty&&["groupBy","dateGroupBy"].includes(item.type)).map((item)=>item.fieldName);for(const{definitionRecordId,definitionRecordName,definitions}of result){const groupNames=definitions.map((definition)=>`group_by_${field.name}.${definition.name}`);Object.values(this.searchItems).forEach((searchItem)=>{if(searchItem.isProperty&&searchItem.definitionRecordId===definitionRecordId&&["groupBy","dateGroupBy"].includes(searchItem.type)&&!groupNames.includes(searchItem.name)){searchItem.type="group_by_property_deleted";}});for(const definition of definitions){const fullName=`${field.name}.${definition.name}`;this.searchViewFields[fullName]={name:fullName,readonly:false,relation:definition.comodel,required:false,searchable:false,selection:definition.selection,sortable:true,store:true,string:`${definition.string} (${definitionRecordName})`,type:definition.type,relatedPropertyField:field,};if(!searchItemsNames.includes(fullName)){const groupByItem={description:definition.string,definitionRecordId,definitionRecordName,fieldName:fullName,fieldType:definition.type,isProperty:true,name:`group_by_${field.name}.${definition.name}`,propertyFieldName:field.name,type:["datetime","date"].includes(definition.type)?"dateGroupBy":"groupBy",};this._createGroupOfSearchItems([groupByItem]);}}}}}
async _fetchPropertiesDefinition(resModel,fieldName){const domain=[];if(this.context.active_id){domain.push(["id","=",this.context.active_id]);}
const definitions=await this.fieldService.loadPropertyDefinitions(resModel,fieldName,domain);const result=groupBy(Object.values(definitions),(definition)=>definition.record_id);return Object.entries(result).map(([recordId,definitions])=>{return{definitionRecordId:parseInt(recordId),definitionRecordName:definitions[0]?.record_name,definitions,};});}
_activateDefaultSearchItems(defaultFavoriteId){if(defaultFavoriteId){this.toggleSearchItem(defaultFavoriteId);}else{Object.values(this.searchItems).filter((f)=>f.isDefault&&f.type!=="favorite").sort((f1,f2)=>(f1.defaultRank||100)-(f2.defaultRank||100)).forEach((f)=>{if(f.type==="dateFilter"){this.toggleDateFilter(f.id);}else if(f.type==="dateGroupBy"){this.toggleDateGroupBy(f.id);}else if(f.type==="field"){this.addAutoCompletionValues(f.id,f.defaultAutocompleteValue);}else{this.toggleSearchItem(f.id);}});}}
_checkComparisonStatus(){const activeComparison=this._getActiveComparison();if(!activeComparison){return;}
const{dateFilterId,id}=activeComparison;const dateFilterIsActive=this.query.some((queryElem)=>queryElem.searchItemId===dateFilterId);if(!dateFilterIsActive){this.query=this.query.filter((queryElem)=>queryElem.searchItemId!==id);}}
_createCategoryTree(sectionId,result){const category=this.sections.get(sectionId);let{error_msg,parent_field:parentField,values}=result;if(error_msg){category.errorMsg=error_msg;values=[];}
if(category.hierarchize){category.parentField=parentField;}
for(const value of values){category.values.set(value.id,Object.assign({},value,{childrenIds:[],parentId:value[parentField]||false,}));}
for(const value of values){const{parentId}=category.values.get(value.id);if(parentId&&category.values.has(parentId)){category.values.get(parentId).childrenIds.push(value.id);}}
category.rootIds=[false];for(const value of values){const{parentId}=category.values.get(value.id);if(!parentId){category.rootIds.push(value.id);}}
const valueIds=[false,...values.map((val)=>val.id)];this._ensureCategoryValue(category,valueIds);}
_createFilterTree(sectionId,result){const filter=this.sections.get(sectionId);let{error_msg,values}=result;if(error_msg){filter.errorMsg=error_msg;values=[];}
values.forEach((value)=>{const oldValue=filter.values.get(value.id);value.checked=oldValue?oldValue.checked:false;});filter.values=new Map();const groupIds=[];if(filter.groupBy){const groups=new Map();for(const value of values){const groupId=value.group_id;if(!groups.has(groupId)){if(groupId){groupIds.push(groupId);}
groups.set(groupId,{id:groupId,name:value.group_name,values:new Map(),tooltip:value.group_tooltip,sequence:value.group_sequence,color_index:value.color_index,});const oldGroup=filter.groups&&filter.groups.get(groupId);groups.get(groupId).state=(oldGroup&&oldGroup.state)||false;}
groups.get(groupId).values.set(value.id,value);}
filter.groups=groups;filter.sortedGroupIds=sortBy(groupIds,(id)=>groups.get(id).sequence||groups.get(id).name);for(const group of filter.groups.values()){for(const[valueId,value]of group.values){filter.values.set(valueId,value);}}}else{for(const value of values){filter.values.set(value.id,value);}}}
_createGroupOfComparisons(dateFilters){const preSearchItem=[];for(const dateFilter of dateFilters){for(const comparisonOption of this.comparisonOptions){const{id:dateFilterId,description}=dateFilter;const preFilter={type:"comparison",comparisonOptionId:comparisonOption.id,description:`${description}: ${comparisonOption.description}`,dateFilterId,};preSearchItem.push(preFilter);}}
this._createGroupOfSearchItems(preSearchItem);}
_createGroupOfDynamicFilters(dynamicFilters){const pregroup=dynamicFilters.map((filter)=>{return{groupNumber:this.nextGroupNumber,description:filter.description,domain:filter.domain,isDefault:"is_default"in filter?filter.is_default:true,type:"filter",};});this.nextGroupNumber++;this._createGroupOfSearchItems(pregroup);}
_createGroupOfFavorites(irFilters){let defaultFavoriteId=null;irFilters.forEach((irFilter)=>{const favorite=this._irFilterToFavorite(irFilter);this._createGroupOfSearchItems([favorite]);if(favorite.isDefault){defaultFavoriteId=favorite.id;}});return defaultFavoriteId;}
_createGroupOfSearchItems(pregroup){pregroup.forEach((preSearchItem)=>{const searchItem=Object.assign(preSearchItem,{groupId:this.nextGroupId,id:this.nextId,});this.searchItems[this.nextId]=searchItem;this.nextId++;});this.nextGroupId++;}
_enrichItem(searchItem){if(searchItem.type==="field"&&searchItem.fieldType==="properties"){return{...searchItem};}
const queryElements=this.query.filter((queryElem)=>queryElem.searchItemId===searchItem.id);const isActive=Boolean(queryElements.length);const enrichSearchItem=Object.assign({isActive},searchItem);function _enrichOptions(options,selectedIds){return options.map((o)=>{const{description,id,groupNumber}=o;const isActive=selectedIds.some((optionId)=>optionId===id);return{description,id,groupNumber,isActive};});}
switch(searchItem.type){case"comparison":{const{dateFilterId}=searchItem;const dateFilterIsActive=this.query.some((queryElem)=>queryElem.searchItemId===dateFilterId);if(!dateFilterIsActive){return null;}
break;}
case"dateFilter":enrichSearchItem.options=_enrichOptions(this.optionGenerators,queryElements.map((queryElem)=>queryElem.generatorId));break;case"dateGroupBy":enrichSearchItem.options=_enrichOptions(this.intervalOptions,queryElements.map((queryElem)=>queryElem.intervalId));break;case"field":case"field_property":enrichSearchItem.autocompleteValues=queryElements.map((queryElem)=>queryElem.autocompleteValue);break;}
return enrichSearchItem;}
_ensureCategoryValue(category,valueIds){if(!valueIds.includes(category.activeValueId)){category.activeValueId=valueIds[0];}}
_extractSearchDefaultsFromGlobalContext(){const searchDefaults={};const searchPanelDefaults={};for(const key in this.globalContext){const defaultValue=this.globalContext[key];const searchDefaultMatch=/^search_default_(.*)$/.exec(key);if(searchDefaultMatch){if(defaultValue){searchDefaults[searchDefaultMatch[1]]=defaultValue;}
delete this.globalContext[key];continue;}
const searchPanelDefaultMatch=/^searchpanel_default_(.*)$/.exec(key);if(searchPanelDefaultMatch){searchPanelDefaults[searchPanelDefaultMatch[1]]=defaultValue;delete this.globalContext[key];}}
return{searchDefaults,searchPanelDefaults};}
async _fetchCategories(categories){const filterDomain=this._getFilterDomain();const searchDomain=this.searchDomain;await Promise.all(categories.map(async(category)=>{const result=await this.orm.call(this.resModel,"search_panel_select_range",[category.fieldName],{category_domain:this._getCategoryDomain(category.id),context:this.globalContext,enable_counters:category.enableCounters,expand:category.expand,filter_domain:filterDomain,hierarchize:category.hierarchize,limit:category.limit,search_domain:searchDomain,});this._createCategoryTree(category.id,result);}));}
async _fetchFilters(filters){const evalContext={};for(const category of this.categories){evalContext[category.fieldName]=category.activeValueId;}
const categoryDomain=this._getCategoryDomain();const searchDomain=this.searchDomain;await Promise.all(filters.map(async(filter)=>{const result=await this.orm.call(this.resModel,"search_panel_select_multi_range",[filter.fieldName],{category_domain:categoryDomain,comodel_domain:new Domain(filter.domain).toList(evalContext),context:this.globalContext,enable_counters:filter.enableCounters,filter_domain:this._getFilterDomain(filter.id),expand:filter.expand,group_by:filter.groupBy||false,group_domain:this._getGroupDomain(filter),limit:filter.limit,search_domain:searchDomain,});this._createFilterTree(filter.id,result);}));}
async _fetchSections(categoriesToLoad,filtersToLoad){await this._fetchCategories(categoriesToLoad);await this._fetchFilters(filtersToLoad);this.searchPanelInfo.loaded=true;}
_getActiveComparison(){for(const queryElem of this.query){const searchItem=this.searchItems[queryElem.searchItemId];if(searchItem.type==="comparison"){return searchItem;}}
return null;}
_getCategoryDomain(excludedCategoryId){const domain=[];for(const category of this.categories){if(category.id===excludedCategoryId||!category.activeValueId){continue;}
const field=this.searchViewFields[category.fieldName];const operator=field.type==="many2one"&&category.parentField?"child_of":"=";domain.push([category.fieldName,operator,category.activeValueId]);}
return domain;}
_getContext(){const groups=this._getGroups();const contexts=[this.userService.context];for(const group of groups){for(const activeItem of group.activeItems){const context=this._getSearchItemContext(activeItem);if(context){contexts.push(context);}}}
let context;try{context=makeContext(contexts);return context;}catch(error){throw new Error(_t("Failed to evaluate the context: %(context)s.\n%(error)s",{context,error:error.message,}));}}
_getDateFilterDomain(dateFilter,generatorIds,key="domain"){const{fieldName,fieldType}=dateFilter;const dateFilterRange=constructDateDomain(this.referenceMoment,fieldName,fieldType,generatorIds);return dateFilterRange[key];}
_getDisplay(display={}){const{viewTypes}=this.searchPanelInfo;const{bannerRoute,viewType}=this.env.config;return{controlPanel:"controlPanel"in display?display.controlPanel:{},searchPanel:this.sections.size&&(!viewType||viewTypes.includes(viewType))&&("searchPanel"in display?display.searchPanel:true),banner:Boolean(bannerRoute),};}
_getDomain(params={}){const withSearchPanel="withSearchPanel"in params?params.withSearchPanel:true;const withGlobal="withGlobal"in params?params.withGlobal:true;const groups=this._getGroups();const domains=[];if(withGlobal){domains.push(this.globalDomain);}
for(const group of groups){const groupActiveItemDomains=[];for(const activeItem of group.activeItems){const domain=this._getSearchItemDomain(activeItem);if(domain){groupActiveItemDomains.push(domain);}}
const groupDomain=Domain.or(groupActiveItemDomains);domains.push(groupDomain);}
if(this.display.searchPanel&&withSearchPanel){domains.push(this._getSearchPanelDomain());}
let domain;try{domain=Domain.and(domains);return params.raw?domain:domain.toList(this.domainEvalContext);}catch(error){throw new Error(_t("Failed to evaluate the domain: %(domain)s.\n%(error)s",{domain:domain.toString(),error:error.message,}));}}
_getFacets(){const facets=[];const groups=this._getGroups();for(const group of groups){const groupActiveItemDomains=[];const values=[];let title;let type;for(const activeItem of group.activeItems){const domain=this._getSearchItemDomain(activeItem,{withDateFilterDomain:true,});if(domain){groupActiveItemDomains.push(domain);}
const searchItem=this.searchItems[activeItem.searchItemId];switch(searchItem.type){case"field_property":case"field":{type="field";title=searchItem.description;for(const autocompleteValue of activeItem.autocompletValues){values.push(autocompleteValue.label);}
break;}
case"groupBy":{type="groupBy";values.push(searchItem.description);break;}
case"dateGroupBy":{type="groupBy";for(const intervalId of activeItem.intervalIds){const option=this.intervalOptions.find((o)=>o.id===intervalId);values.push(`${searchItem.description}: ${option.description}`);}
break;}
case"dateFilter":{type="filter";const periodDescription=this._getDateFilterDomain(searchItem,activeItem.generatorIds,"description");values.push(`${searchItem.description}: ${periodDescription}`);break;}
default:{type=searchItem.type;values.push(searchItem.description);}}}
const facet={groupId:group.id,type,values,separator:type==="groupBy"?">":_t("or"),};if(type==="field"){facet.title=title;}else{facet.icon=FACET_ICONS[type];facet.color=FACET_COLORS[type];}
if(groupActiveItemDomains.length){facet.domain=Domain.or(groupActiveItemDomains).toString();}
facets.push(facet);}
return facets;}
_getFieldDomain(field,autocompleteValues){const domains=autocompleteValues.map(({label,value,operator})=>{let domain;if(field.filterDomain){domain=new Domain(field.filterDomain).toList({self:label.trim(),raw_value:value,});}else if(field.type==="field"){domain=[[field.fieldName,operator,value]];}else if(field.type==="field_property"){domain=[field.propertyDomain,[`${field.fieldName}.${field.propertyFieldDefinition.name}`,operator,value],];}
return new Domain(domain);});return Domain.or(domains);}
_getFilterDomain(excludedFilterId){const domain=[];function addCondition(fieldName,valueMap){const ids=[];for(const[valueId,value]of valueMap){if(value.checked){ids.push(valueId);}}
if(ids.length){domain.push([fieldName,"in",ids]);}}
for(const filter of this.filters){if(filter.id===excludedFilterId){continue;}
const{fieldName,groups,values}=filter;if(groups){for(const group of groups.values()){addCondition(fieldName,group.values);}}else{addCondition(fieldName,values);}}
return domain;}
_getGroupBy(){const groups=this._getGroups();const groupBys=[];for(const group of groups){for(const activeItem of group.activeItems){const activeItemGroupBys=this._getSearchItemGroupBys(activeItem);if(activeItemGroupBys){groupBys.push(...activeItemGroupBys);}}}
const groupBy=groupBys.length?groupBys:this.globalGroupBy.slice();return typeof groupBy==="string"?[groupBy]:groupBy;}
_getGroupDomain(filter){const{fieldName,groups,enableCounters}=filter;const{type:fieldType}=this.searchViewFields[fieldName];if(!enableCounters||!groups){return{many2one:[],many2many:{},}[fieldType];}
let groupDomain=null;if(fieldType==="many2one"){for(const group of groups.values()){const valueIds=[];let active=false;for(const[valueId,value]of group.values){const{checked}=value;valueIds.push(valueId);if(checked){active=true;}}
if(active){if(groupDomain){groupDomain=[[0,"=",1]];break;}else{groupDomain=[[fieldName,"in",valueIds]];}}}}else if(fieldType==="many2many"){const checkedValueIds=new Map();groups.forEach(({values},groupId)=>{values.forEach(({checked},valueId)=>{if(checked){if(!checkedValueIds.has(groupId)){checkedValueIds.set(groupId,[]);}
checkedValueIds.get(groupId).push(valueId);}});});groupDomain={};for(const[gId,ids]of checkedValueIds.entries()){for(const groupId of groups.keys()){if(gId!==groupId){const key=JSON.stringify(groupId);if(!groupDomain[key]){groupDomain[key]=[];}
groupDomain[key].push([fieldName,"in",ids]);}}}}
return groupDomain;}
_getGroups(){const preGroups=[];for(const queryElem of this.query){const{searchItemId}=queryElem;const{groupId}=this.searchItems[searchItemId];let preGroup=preGroups.find((group)=>group.id===groupId);if(!preGroup){preGroup={id:groupId,queryElements:[]};preGroups.push(preGroup);}
preGroup.queryElements.push(queryElem);}
const groups=[];for(const preGroup of preGroups){const{queryElements,id}=preGroup;const activeItems=[];for(const queryElem of queryElements){const{searchItemId}=queryElem;let activeItem=activeItems.find(({searchItemId:id})=>id===searchItemId);if("generatorId"in queryElem){if(!activeItem){activeItem={searchItemId,generatorIds:[]};activeItems.push(activeItem);}
activeItem.generatorIds.push(queryElem.generatorId);}else if("intervalId"in queryElem){if(!activeItem){activeItem={searchItemId,intervalIds:[]};activeItems.push(activeItem);}
activeItem.intervalIds.push(queryElem.intervalId);}else if("autocompleteValue"in queryElem){if(!activeItem){activeItem={searchItemId,autocompletValues:[]};activeItems.push(activeItem);}
activeItem.autocompletValues.push(queryElem.autocompleteValue);}else{if(!activeItem){activeItem={searchItemId};activeItems.push(activeItem);}}}
for(const activeItem of activeItems){if("intervalIds"in activeItem){activeItem.intervalIds.sort((g1,g2)=>rankInterval(g1)-rankInterval(g2));}}
groups.push({id,activeItems});}
return groups;}
_getIrFilterDescription(params={}){const{description,isDefault,isShared}=params;const fns=this.env.__getContext__.callbacks;const localContext=Object.assign({},...fns.map((fn)=>fn()));const gs=this.env.__getOrderBy__.callbacks;let localOrderBy;if(gs.length){localOrderBy=gs.flatMap((g)=>g());}
const context=makeContext([this._getContext(),localContext]);const userContext=this.userService.context;for(const key in context){if(key in userContext||/^search(panel)?_default_/.test(key)){delete context[key];}}
const domain=this._getDomain({raw:true,withGlobal:false}).toString();const groupBys=this._getGroupBy();const comparison=this.getFullComparison();const orderBy=localOrderBy||this._getOrderBy();const userId=isShared?false:this.userService.userId;const preFavorite={description,isDefault,domain,context,groupBys,orderBy,userId,};const irFilter={name:description,action_id:this.env.config.actionId,model_id:this.resModel,domain,is_default:isDefault,sort:JSON.stringify(orderBy.map((o)=>`${o.name}${o.asc === false ? " desc" : ""}`)),user_id:userId,context:{group_by:groupBys,...context},};if(comparison){preFavorite.comparison=comparison;irFilter.context.comparison=comparison;}
return{preFavorite,irFilter};}
_getOrderBy(){const groups=this._getGroups();const orderBy=[];for(const group of groups){for(const activeItem of group.activeItems){const{searchItemId}=activeItem;const searchItem=this.searchItems[searchItemId];if(searchItem.type==="favorite"){orderBy.push(...searchItem.orderBy);}}}
return orderBy.length?orderBy:this.globalOrderBy;}
_getSearchItemContext(activeItem){const{searchItemId}=activeItem;const searchItem=this.searchItems[searchItemId];switch(searchItem.type){case"field":{let context={};if(searchItem.context){try{const self=activeItem.autocompletValues.map((autocompleValue)=>autocompleValue.value);context=evaluateExpr(searchItem.context,{self});if(typeof context!=="object"){throw Error();}}catch(error){throw new Error(_t("Failed to evaluate the context: %(context)s.\n%(error)s",{context:searchItem.context,error:error.message,}));}}
if(searchItem.isDefault&&searchItem.fieldType==="many2one"){context[`default_${searchItem.fieldName}`]=searchItem.defaultAutocompleteValue.value;}
return context;}
case"favorite":case"filter":{return makeContext([searchItem.context&&deepCopy(searchItem.context)]);}
default:{return null;}}}
_getSearchItemDomain(activeItem,options={}){const{searchItemId}=activeItem;const searchItem=this.searchItems[searchItemId];switch(searchItem.type){case"field_property":case"field":{return this._getFieldDomain(searchItem,activeItem.autocompletValues);}
case"dateFilter":{const{dateFilterId}=this._getActiveComparison()||{};if(options.withDateFilterDomain||!(this.searchMenuTypes.has("comparison")&&dateFilterId===searchItemId)){return this._getDateFilterDomain(searchItem,activeItem.generatorIds);}
return new Domain([]);}
case"filter":case"favorite":{return searchItem.domain;}
default:{return null;}}}
_getSearchItemGroupBys(activeItem){const{searchItemId}=activeItem;const searchItem=this.searchItems[searchItemId];switch(searchItem.type){case"dateGroupBy":{const{fieldName}=searchItem;return activeItem.intervalIds.map((intervalId)=>`${fieldName}:${intervalId}`);}
case"groupBy":{return[searchItem.fieldName];}
case"favorite":{return searchItem.groupBys;}
default:{return null;}}}
_getSelectedGeneratorIds(dateFilterId){const selectedOptionIds=[];for(const queryElem of this.query){if(queryElem.searchItemId===dateFilterId&&"generatorId"in queryElem){selectedOptionIds.push(queryElem.generatorId);}}
return selectedOptionIds;}
_getSearchPanelDomain(){return Domain.and([this._getCategoryDomain(),this._getFilterDomain()]);}
_importState(state){execute(arraytoMap,state,this);}
_irFilterToFavorite(irFilter){let userId=false;if(Array.isArray(irFilter.user_id)){userId=irFilter.user_id[0];}
const groupNumber=userId?FAVORITE_PRIVATE_GROUP:FAVORITE_SHARED_GROUP;const context=evaluateExpr(irFilter.context,this.userService.context);let groupBys=[];if(context.group_by){groupBys=context.group_by;delete context.group_by;}
let comparison;if(context.comparison){comparison=context.comparison;if(typeof comparison.range==="string"){comparison.range=new Domain(comparison.range).toList();}
if(typeof comparison.comparisonRange==="string"){comparison.comparisonRange=new Domain(comparison.comparisonRange).toList();}
delete context.comparison;}
let sort;try{sort=JSON.parse(irFilter.sort);}catch(err){if(err instanceof SyntaxError){sort=[];}else{throw err;}}
const orderBy=sort.map((order)=>{let fieldName;let asc;const sqlNotation=order.split(" ");if(sqlNotation.length>1){fieldName=sqlNotation[0];asc=sqlNotation[1]==="asc";}else{fieldName=order[0]==="-"?order.slice(1):order;asc=order[0]==="-"?false:true;}
return{asc:asc,name:fieldName,};});const favorite={context,description:irFilter.name,domain:irFilter.domain,groupBys,groupNumber,orderBy,removable:true,serverSideId:irFilter.id,type:"favorite",userId,};if(irFilter.is_default){favorite.isDefault=irFilter.is_default;}
if(comparison){favorite.comparison=comparison;}
return favorite;}
async _notify(){if(this.blockNotification){return;}
this._reset();await this._reloadSections();this.trigger("update");}
async _reloadSections(){this.blockNotification=true;const searchDomain=this._getDomain({withSearchPanel:false});const searchDomainChanged=this.searchPanelInfo.shouldReload||JSON.stringify(this.searchDomain)!==JSON.stringify(searchDomain);this.searchDomain=searchDomain;const toFetch=(section)=>section.enableCounters||(searchDomainChanged&&!section.expand);const categoriesToFetch=this.categories.filter(toFetch);const filtersToFetch=this.filters.filter(toFetch);if(searchDomainChanged||Boolean(categoriesToFetch.length+filtersToFetch.length)){if(this.display.searchPanel){this.sectionsPromise=this._fetchSections(categoriesToFetch,filtersToFetch);if(this._shouldWaitForData(searchDomainChanged)){await this.sectionsPromise;}}
this.searchPanelInfo.shouldReload=!this.display.searchPanel;}
this.blockNotification=false;}
_reset(){delete this._comparison;this._context=null;this._domain=null;this._groupBy=null;this._orderBy=null;}
_shouldWaitForData(searchDomainChanged){if(this.categories.length&&this.filters.some((filter)=>filter.domain!=="[]")){return true;}
if(!this.searchDomain.length){return false;}
return[...this.sections.values()].some((section)=>!section.expand&&searchDomainChanged);}
__legacyParseSearchPanelArchAnyway(searchViewDescription,searchViewFields){if(this.searchPanelInfo){return;}
const parser=new SearchArchParser(searchViewDescription,searchViewFields);const{searchPanelInfo}=parser.parse();this.searchPanelInfo={...searchPanelInfo,loaded:false,shouldReload:false};}}
return __exports;});;

/* /web/static/src/search/search_panel/search_panel.js */
odoo.define('@web/search/search_panel/search_panel',['@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{useBus}=require("@web/core/utils/hooks");const{Component,onMounted,onWillUpdateProps,onWillStart,useRef,useState}=require("@odoo/owl");const isFilter=(s)=>s.type==="filter";const isActiveCategory=(s)=>s.type==="category"&&s.activeValueId;const nameOfCheckedValues=(values)=>{const names=[];for(const[,value]of values){if(value.checked){names.push(value.display_name);}}
return names;};const SearchPanel=__exports.SearchPanel=class SearchPanel extends Component{setup(){this.state=useState({active:{},expanded:{},showMobileSearch:false,});this.root=useRef("root");this.scrollTop=0;this.hasImportedState=false;this.importState(this.props.importedState);useBus(this.env.searchModel,"update",async()=>{await this.env.searchModel.sectionsPromise;this.updateActiveValues();this.render();});onWillStart(async()=>{await this.env.searchModel.sectionsPromise;this.expandDefaultValue();this.updateActiveValues();});onWillUpdateProps(async()=>{await this.env.searchModel.sectionsPromise;this.updateActiveValues();});onMounted(()=>{this.updateGroupHeadersChecked();if(this.hasImportedState){this.root.el.scroll({top:this.scrollTop});}});}
get sections(){return this.env.searchModel.getSections((s)=>!s.empty);}
exportState(){const exported={expanded:this.state.expanded,scrollTop:this.root.el.scrollTop,};return JSON.stringify(exported);}
importState(stringifiedState){this.hasImportedState=Boolean(stringifiedState);if(this.hasImportedState){const state=JSON.parse(stringifiedState);this.state.expanded=state.expanded;this.scrollTop=state.scrollTop;}}
expandDefaultValue(){if(this.hasImportedState){return;}
const categories=this.env.searchModel.getSections((s)=>s.type==="category");for(const category of categories){this.state.expanded[category.id]={};if(category.activeValueId){const ancestorIds=this.getAncestorValueIds(category,category.activeValueId);for(const ancestorId of ancestorIds){this.state.expanded[category.id][ancestorId]=true;}}}}
getAncestorValueIds(category,categoryValueId){const{parentId}=category.values.get(categoryValueId);return parentId?[...this.getAncestorValueIds(category,parentId),parentId]:[];}
getCategorySelection(){const activeCategories=this.env.searchModel.getSections(isActiveCategory);const selection=[];for(const category of activeCategories){const parentIds=this.getAncestorValueIds(category,category.activeValueId);const orderedCategoryNames=[...parentIds,category.activeValueId].map((valueId)=>category.values.get(valueId).display_name);selection.push({values:orderedCategoryNames,icon:category.icon,color:category.color,});}
return selection;}
getFilterSelection(){const filters=this.env.searchModel.getSections(isFilter);const selection=[];for(const{groups,values,icon,color}of filters){let filterValues;if(groups){filterValues=Object.keys(groups).map((groupId)=>nameOfCheckedValues(groups[groupId].values)).flat();}else if(values){filterValues=nameOfCheckedValues(values);}
if(filterValues.length){selection.push({values:filterValues,icon,color});}}
return selection;}
async toggleCategory(category,value){if(value.childrenIds.length){const categoryState=this.state.expanded[category.id];if(categoryState[value.id]&&category.activeValueId===value.id){delete categoryState[value.id];}else{categoryState[value.id]=true;}}
if(category.activeValueId!==value.id){this.env.searchModel.toggleCategoryValue(category.id,value.id);}}
toggleFilterGroup(filterId,{values}){const valueIds=[];const checked=[...values.values()].every((value)=>this.state.active[filterId][value.id]);values.forEach(({id})=>{valueIds.push(id);this.state.active[filterId][id]=!checked;});this.env.searchModel.toggleFilterValues(filterId,valueIds,!checked);}
toggleFilterValue(filterId,valueId,{currentTarget}){this.state.active[filterId][valueId]=currentTarget.checked;this.updateGroupHeadersChecked();this.env.searchModel.toggleFilterValues(filterId,[valueId]);}
updateActiveValues(){for(const section of this.sections){if(section.type==="category"){this.state.active[section.id]=section.activeValueId;}else{this.state.active[section.id]={};if(section.groups){for(const group of section.groups.values()){for(const value of group.values.values()){this.state.active[section.id][value.id]=value.checked;}}}
if(section&&section.values){for(const value of section.values.values()){this.state.active[section.id][value.id]=value.checked;}}}}}
updateGroupHeadersChecked(){const groups=this.root.el.querySelectorAll(":scope .o_search_panel_filter_group");for(const group of groups){const header=group.querySelector(":scope .o_search_panel_group_header input");const vals=[...group.querySelectorAll(":scope .o_search_panel_filter_value input")];header.checked=false;header.indeterminate=false;if(vals.every((v)=>v.checked)){header.checked=true;}else if(vals.some((v)=>v.checked)){header.indeterminate=true;}}}}
SearchPanel.props={importedState:{type:String,optional:true},};SearchPanel.subTemplates={category:"web.SearchPanel.Category",filtersGroup:"web.SearchPanel.FiltersGroup",};SearchPanel.template="web.SearchPanel";return __exports;});;

/* /web/static/src/search/utils/dates.js */
odoo.define('@web/search/utils/dates',['@web/core/l10n/translation','@web/core/domain','@web/core/l10n/dates','@web/core/l10n/localization'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{Domain}=require("@web/core/domain");const{serializeDate,serializeDateTime}=require("@web/core/l10n/dates");const{localization}=require("@web/core/l10n/localization");const DEFAULT_PERIOD=__exports.DEFAULT_PERIOD="this_month";const QUARTERS=__exports.QUARTERS={1:{description:_t("Q1"),coveredMonths:[1,2,3]},2:{description:_t("Q2"),coveredMonths:[4,5,6]},3:{description:_t("Q3"),coveredMonths:[7,8,9]},4:{description:_t("Q4"),coveredMonths:[10,11,12]},};const MONTH_OPTIONS=__exports.MONTH_OPTIONS={this_month:{id:"this_month",groupNumber:1,format:"MMMM",plusParam:{},granularity:"month",},last_month:{id:"last_month",groupNumber:1,format:"MMMM",plusParam:{months:-1},granularity:"month",},antepenultimate_month:{id:"antepenultimate_month",groupNumber:1,format:"MMMM",plusParam:{months:-2},granularity:"month",},};const QUARTER_OPTIONS=__exports.QUARTER_OPTIONS={fourth_quarter:{id:"fourth_quarter",groupNumber:1,description:QUARTERS[4].description,setParam:{quarter:4},granularity:"quarter",},third_quarter:{id:"third_quarter",groupNumber:1,description:QUARTERS[3].description,setParam:{quarter:3},granularity:"quarter",},second_quarter:{id:"second_quarter",groupNumber:1,description:QUARTERS[2].description,setParam:{quarter:2},granularity:"quarter",},first_quarter:{id:"first_quarter",groupNumber:1,description:QUARTERS[1].description,setParam:{quarter:1},granularity:"quarter",},};const YEAR_OPTIONS=__exports.YEAR_OPTIONS={this_year:{id:"this_year",groupNumber:2,format:"yyyy",plusParam:{},granularity:"year",},last_year:{id:"last_year",groupNumber:2,format:"yyyy",plusParam:{years:-1},granularity:"year",},antepenultimate_year:{id:"antepenultimate_year",groupNumber:2,format:"yyyy",plusParam:{years:-2},granularity:"year",},};const PERIOD_OPTIONS=__exports.PERIOD_OPTIONS=Object.assign({},MONTH_OPTIONS,QUARTER_OPTIONS,YEAR_OPTIONS);const DEFAULT_INTERVAL=__exports.DEFAULT_INTERVAL="month";const INTERVAL_OPTIONS=__exports.INTERVAL_OPTIONS={year:{description:_t("Year"),id:"year",groupNumber:1},quarter:{description:_t("Quarter"),id:"quarter",groupNumber:1},month:{description:_t("Month"),id:"month",groupNumber:1},week:{description:_t("Week"),id:"week",groupNumber:1},day:{description:_t("Day"),id:"day",groupNumber:1},};const COMPARISON_OPTIONS=__exports.COMPARISON_OPTIONS={previous_period:{description:_t("Previous Period"),id:"previous_period",},previous_year:{description:_t("Previous Year"),id:"previous_year",plusParam:{years:-1},},};const PER_YEAR=__exports.PER_YEAR={year:1,quarter:4,month:12,};__exports.constructDateDomain=constructDateDomain;function constructDateDomain(referenceMoment,fieldName,fieldType,selectedOptionIds,comparisonOptionId){let plusParam;let selectedOptions;if(comparisonOptionId){[plusParam,selectedOptions]=getComparisonParams(referenceMoment,selectedOptionIds,comparisonOptionId);}else{selectedOptions=getSelectedOptions(referenceMoment,selectedOptionIds);}
const yearOptions=selectedOptions.year;const otherOptions=[...(selectedOptions.quarter||[]),...(selectedOptions.month||[])];sortPeriodOptions(yearOptions);sortPeriodOptions(otherOptions);const ranges=[];for(const yearOption of yearOptions){const constructRangeParams={referenceMoment,fieldName,fieldType,plusParam,};if(otherOptions.length){for(const option of otherOptions){const setParam=Object.assign({},yearOption.setParam,option?option.setParam:{});const{granularity}=option;const range=constructDateRange(Object.assign({granularity,setParam},constructRangeParams));ranges.push(range);}}else{const{granularity,setParam}=yearOption;const range=constructDateRange(Object.assign({granularity,setParam},constructRangeParams));ranges.push(range);}}
const domain=Domain.combine(ranges.map((range)=>range.domain),"OR");const description=ranges.map((range)=>range.description).join("/");return{domain,description};}
__exports.constructDateRange=constructDateRange;function constructDateRange(params){const{referenceMoment,fieldName,fieldType,granularity,setParam,plusParam}=params;if("quarter"in setParam){setParam.month=QUARTERS[setParam.quarter].coveredMonths[0];delete setParam.quarter;}
const date=referenceMoment.set(setParam).plus(plusParam||{});const leftDate=date.startOf(granularity);const rightDate=date.endOf(granularity);let leftBound;let rightBound;if(fieldType==="date"){leftBound=serializeDate(leftDate);rightBound=serializeDate(rightDate);}else{leftBound=serializeDateTime(leftDate);rightBound=serializeDateTime(rightDate);}
const domain=new Domain(["&",[fieldName,">=",leftBound],[fieldName,"<=",rightBound]]);const descriptions=[date.toFormat("yyyy")];const method=localization.direction==="rtl"?"push":"unshift";if(granularity==="month"){descriptions[method](date.toFormat("MMMM"));}else if(granularity==="quarter"){const quarter=date.quarter;descriptions[method](QUARTERS[quarter].description.toString());}
const description=descriptions.join(" ");return{domain,description};}
__exports.getComparisonOptions=getComparisonOptions;function getComparisonOptions(){return getOptionsWithDescriptions(COMPARISON_OPTIONS);}
__exports.getComparisonParams=getComparisonParams;function getComparisonParams(referenceMoment,selectedOptionIds,comparisonOptionId){const comparisonOption=COMPARISON_OPTIONS[comparisonOptionId];const selectedOptions=getSelectedOptions(referenceMoment,selectedOptionIds);if(comparisonOption.plusParam){return[comparisonOption.plusParam,selectedOptions];}
const plusParam={};let globalGranularity="year";if(selectedOptions.month){globalGranularity="month";}else if(selectedOptions.quarter){globalGranularity="quarter";}
const granularityFactor=PER_YEAR[globalGranularity];const years=selectedOptions.year.map((o)=>o.setParam.year);const yearMin=Math.min(...years);const yearMax=Math.max(...years);let optionMin=0;let optionMax=0;if(selectedOptions.quarter){const quarters=selectedOptions.quarter.map((o)=>o.setParam.quarter);if(globalGranularity==="month"){delete selectedOptions.quarter;for(const quarter of quarters){for(const month of QUARTERS[quarter].coveredMonths){const monthOption=selectedOptions.month.find((o)=>o.setParam.month===month);if(!monthOption){selectedOptions.month.push({setParam:{month},granularity:"month",});}}}}else{optionMin=Math.min(...quarters);optionMax=Math.max(...quarters);}}
if(selectedOptions.month){const months=selectedOptions.month.map((o)=>o.setParam.month);optionMin=Math.min(...months);optionMax=Math.max(...months);}
const num=-1+granularityFactor*(yearMin-yearMax)+optionMin-optionMax;const key=globalGranularity==="year"?"years":globalGranularity==="month"?"months":"quarters";plusParam[key]=num;return[plusParam,selectedOptions];}
__exports.getIntervalOptions=getIntervalOptions;function getIntervalOptions(){return getOptionsWithDescriptions(INTERVAL_OPTIONS);}
__exports.getPeriodOptions=getPeriodOptions;function getPeriodOptions(referenceMoment){const options=[];const originalOptions=Object.values(PERIOD_OPTIONS);for(const option of originalOptions){const{id,groupNumber}=option;let description;let defaultYear;switch(option.granularity){case"quarter":description=option.description.toString();defaultYear=referenceMoment.set(option.setParam).year;break;case"month":case"year":{const date=referenceMoment.plus(option.plusParam);description=date.toFormat(option.format);defaultYear=date.year;break;}}
const setParam=getSetParam(option,referenceMoment);options.push({id,groupNumber,description,defaultYear,setParam});}
const periodOptions=[];for(const option of options){const{id,groupNumber,description,defaultYear}=option;const yearOption=options.find((o)=>o.setParam&&o.setParam.year===defaultYear);periodOptions.push({id,groupNumber,description,defaultYearId:yearOption.id,});}
return periodOptions;}
__exports.getOptionsWithDescriptions=getOptionsWithDescriptions;function getOptionsWithDescriptions(OPTIONS){const options=[];for(const option of Object.values(OPTIONS)){options.push(Object.assign({},option,{description:option.description.toString()}));}
return options;}
__exports.getSelectedOptions=getSelectedOptions;function getSelectedOptions(referenceMoment,selectedOptionIds){const selectedOptions={year:[]};for(const optionId of selectedOptionIds){const option=PERIOD_OPTIONS[optionId];const setParam=getSetParam(option,referenceMoment);const granularity=option.granularity;if(!selectedOptions[granularity]){selectedOptions[granularity]=[];}
selectedOptions[granularity].push({granularity,setParam});}
return selectedOptions;}
__exports.getSetParam=getSetParam;function getSetParam(periodOption,referenceMoment){if(periodOption.granularity==="quarter"){return periodOption.setParam;}
const date=referenceMoment.plus(periodOption.plusParam);const granularity=periodOption.granularity;const setParam={[granularity]:date[granularity]};return setParam;}
__exports.rankInterval=rankInterval;function rankInterval(intervalOptionId){return Object.keys(INTERVAL_OPTIONS).indexOf(intervalOptionId);}
__exports.sortPeriodOptions=sortPeriodOptions;function sortPeriodOptions(options){options.sort((o1,o2)=>{var _a,_b;const granularity1=o1.granularity;const granularity2=o2.granularity;if(granularity1===granularity2){return(((_a=o1.setParam[granularity1])!==null&&_a!==void 0?_a:0)-
((_b=o2.setParam[granularity1])!==null&&_b!==void 0?_b:0));}
return granularity1<granularity2?-1:1;});}
__exports.yearSelected=yearSelected;function yearSelected(selectedOptionIds){return selectedOptionIds.some((optionId)=>Object.keys(YEAR_OPTIONS).includes(optionId));}
return __exports;});;

/* /web/static/src/search/utils/group_by.js */
odoo.define('@web/search/utils/group_by',['@web/search/utils/dates'],function(require){'use strict';let __exports={};const{DEFAULT_INTERVAL,INTERVAL_OPTIONS}=require("@web/search/utils/dates");function errorMsg(descr){return`Invalid groupBy description: ${descr}`;}
__exports.getGroupBy=getGroupBy;function getGroupBy(descr,fields){let fieldName;let interval;let spec;[fieldName,interval]=descr.split(":");if(!fieldName){throw Error();}
if(fields){if(!fields[fieldName]){throw Error(errorMsg(descr));}
const fieldType=fields[fieldName].type;if(["date","datetime"].includes(fieldType)){if(!interval){interval=DEFAULT_INTERVAL;}else if(!Object.keys(INTERVAL_OPTIONS).includes(interval)){throw Error(errorMsg(descr));}
spec=`${fieldName}:${interval}`;}else if(interval){throw Error(errorMsg(descr));}else{spec=fieldName;interval=null;}}else{if(interval){if(!Object.keys(INTERVAL_OPTIONS).includes(interval)){throw Error(errorMsg(descr));}
spec=`${fieldName}:${interval}`;}else{spec=fieldName;interval=null;}}
return{fieldName,interval,spec,toJSON(){return spec;},};}
return __exports;});;

/* /web/static/src/search/utils/misc.js */
odoo.define('@web/search/utils/misc',[],function(require){'use strict';let __exports={};const FACET_ICONS=__exports.FACET_ICONS={filter:"fa fa-filter",groupBy:"oi oi-group",favorite:"fa fa-star",comparison:"fa fa-adjust",};const FACET_COLORS=__exports.FACET_COLORS={filter:"primary",groupBy:"action",favorite:"warning",comparison:"danger",};const GROUPABLE_TYPES=__exports.GROUPABLE_TYPES=["boolean","char","date","datetime","integer","many2one","many2many","selection","tags",];return __exports;});;

/* /web/static/src/search/utils/order_by.js */
odoo.define('@web/search/utils/order_by',[],function(require){'use strict';let __exports={};__exports.orderByToString=orderByToString;function orderByToString(orderBy){return orderBy.map((o)=>`${o.name} ${o.asc ? "ASC" : "DESC"}`).join(", ");}
__exports.stringToOrderBy=stringToOrderBy;function stringToOrderBy(string){if(!string){return[];}
return string.split(",").map((order)=>{const splitOrder=order.trim().split(" ");if(splitOrder.length===2){return{name:splitOrder[0],asc:splitOrder[1].toLowerCase()==="asc",};}else{return{name:splitOrder[0],asc:true,};}});}
return __exports;});;

/* /web/static/src/search/with_search/with_search.js */
odoo.define('@web/search/with_search/with_search',['@web/webclient/actions/action_hook','@odoo/owl','@web/search/search_model','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{CallbackRecorder,useSetupAction}=require("@web/webclient/actions/action_hook");const{Component,onWillStart,onWillUpdateProps,toRaw,useSubEnv}=require("@odoo/owl");const{SearchModel}=require("@web/search/search_model");const{useBus,useService}=require("@web/core/utils/hooks");const SEARCH_KEYS=__exports.SEARCH_KEYS=["comparison","context","domain","groupBy","orderBy"];const WithSearch=__exports.WithSearch=class WithSearch extends Component{setup(){if(!this.env.__getContext__){useSubEnv({__getContext__:new CallbackRecorder()});}
if(!this.env.__getOrderBy__){useSubEnv({__getOrderBy__:new CallbackRecorder()});}
const SearchModelClass=this.props.SearchModel||SearchModel;this.searchModel=new SearchModelClass(this.env,{user:useService("user"),orm:useService("orm"),view:useService("view"),field:useService("field"),name:useService("name"),},this.props.searchModelArgs);useSubEnv({searchModel:this.searchModel});useBus(this.searchModel,"update",this.render);useSetupAction({getGlobalState:()=>{return{searchModel:JSON.stringify(this.searchModel.exportState()),};},});onWillStart(async()=>{const config={...toRaw(this.props)};if(config.globalState&&config.globalState.searchModel){config.state=JSON.parse(config.globalState.searchModel);delete config.globalState;}
await this.searchModel.load(config);});onWillUpdateProps(async(nextProps)=>{const config={};for(const key of SEARCH_KEYS){if(nextProps[key]!==undefined){config[key]=nextProps[key];}}
await this.searchModel.reload(config);});}}
WithSearch.template="web.WithSearch";WithSearch.props={slots:Object,SearchModel:{type:Function,optional:true},resModel:String,globalState:{type:Object,optional:true},searchModelArgs:{type:Object,optional:true},display:{type:Object,optional:true},comparison:{type:[Object,{value:null}],optional:true},context:{type:Object,optional:true},domain:{type:Array,element:[String,Array],optional:true},groupBy:{type:Array,element:String,optional:true},orderBy:{type:Array,element:Object,optional:true},searchViewArch:{type:String,optional:true},searchViewFields:{type:Object,optional:true},searchViewId:{type:[Number,Boolean],optional:true},irFilters:{type:Array,element:Object,optional:true},loadIrFilters:{type:Boolean,optional:true},activateFavorite:{type:Boolean,optional:true},dynamicFilters:{type:Array,element:Object,optional:true},hideCustomGroupBy:{type:Boolean,optional:true},searchMenuTypes:{type:Array,element:String,optional:true},};return __exports;});;

/* /web/static/src/webclient/actions/action_container.js */
odoo.define('@web/webclient/actions/action_container',['@web/webclient/actions/action_dialog','@odoo/owl'],function(require){'use strict';let __exports={};const{ActionDialog}=require("@web/webclient/actions/action_dialog");const{Component,xml,onWillDestroy}=require("@odoo/owl");const ActionContainer=__exports.ActionContainer=class ActionContainer extends Component{setup(){this.info={};this.onActionManagerUpdate=({detail:info})=>{this.info=info;this.render();};this.env.bus.addEventListener("ACTION_MANAGER:UPDATE",this.onActionManagerUpdate);onWillDestroy(()=>{this.env.bus.removeEventListener("ACTION_MANAGER:UPDATE",this.onActionManagerUpdate);});}}
ActionContainer.components={ActionDialog};ActionContainer.template=xml`
    <t t-name="web.ActionContainer">
      <div class="o_action_manager">
        <t t-if="info.Component" t-component="info.Component" className="'o_action'" t-props="info.componentProps" t-key="info.id"/>
      </div>
    </t>`;ActionContainer.props={};return __exports;});;

/* /web/static/src/webclient/actions/action_dialog.js */
odoo.define('@web/webclient/actions/action_dialog',['@web/core/dialog/dialog','@web/core/debug/debug_menu','@web/core/debug/debug_context','@odoo/owl'],function(require){'use strict';let __exports={};const{Dialog}=require("@web/core/dialog/dialog");const{DebugMenu}=require("@web/core/debug/debug_menu");const{useOwnDebugContext}=require("@web/core/debug/debug_context");const{useEffect}=require("@odoo/owl");const ActionDialog=__exports.ActionDialog=class ActionDialog extends Dialog{setup(){super.setup();useOwnDebugContext();useEffect(()=>{if(this.modalRef.el.querySelector(".modal-footer").childElementCount>1){const defaultButton=this.modalRef.el.querySelector(".modal-footer button.o-default-button");defaultButton.classList.add("d-none");}},()=>[]);}}
ActionDialog.components={...Dialog.components,DebugMenu};ActionDialog.template="web.ActionDialog";ActionDialog.props={...Dialog.props,close:Function,slots:{optional:true},ActionComponent:{optional:true},actionProps:{optional:true},actionType:{optional:true},title:{optional:true},};ActionDialog.defaultProps={...Dialog.defaultProps,withBodyPadding:false,};return __exports;});;

/* /web/static/src/webclient/actions/action_hook.js */
odoo.define('@web/webclient/actions/action_hook',['@odoo/owl'],function(require){'use strict';let __exports={};const{onMounted,useComponent,useEffect,useExternalListener}=require("@odoo/owl");const scrollSymbol=__exports.scrollSymbol=Symbol("scroll");const CallbackRecorder=__exports.CallbackRecorder=class CallbackRecorder{constructor(){this.setup();}
setup(){this._callbacks=[];}
get callbacks(){return this._callbacks.map(({callback})=>callback);}
add(owner,callback){if(!callback){throw new Error("Missing callback");}
this._callbacks.push({owner,callback});}
remove(owner){this._callbacks=this._callbacks.filter((s)=>s.owner!==owner);}}
__exports.useCallbackRecorder=useCallbackRecorder;function useCallbackRecorder(callbackRecorder,callback){const component=useComponent();useEffect(()=>{callbackRecorder.add(component,callback);return()=>callbackRecorder.remove(component);},()=>[]);}
__exports.useSetupAction=useSetupAction;function useSetupAction(params={}){const component=useComponent();const{__beforeLeave__,__getGlobalState__,__getLocalState__,__getContext__,__getOrderBy__,}=component.env;const{beforeUnload,beforeLeave,getGlobalState,getLocalState,rootRef}=params;if(beforeUnload){useExternalListener(window,"beforeunload",beforeUnload);}
if(__beforeLeave__&&beforeLeave){useCallbackRecorder(__beforeLeave__,beforeLeave);}
if(__getGlobalState__&&(getGlobalState||rootRef)){useCallbackRecorder(__getGlobalState__,()=>{const state={};if(getGlobalState){Object.assign(state,getGlobalState());}
if(rootRef){const searchPanelEl=rootRef.el.querySelector(".o_content .o_search_panel");if(searchPanelEl){state[scrollSymbol]={searchPanel:{left:searchPanelEl.scrollLeft,top:searchPanelEl.scrollTop,},};}}
return state;});if(rootRef){onMounted(()=>{const{globalState}=component.props;const scrolling=globalState&&globalState[scrollSymbol];if(scrolling){const searchPanelEl=rootRef.el.querySelector(".o_content .o_search_panel");if(searchPanelEl){searchPanelEl.scrollLeft=(scrolling.searchPanel&&scrolling.searchPanel.left)||0;searchPanelEl.scrollTop=(scrolling.searchPanel&&scrolling.searchPanel.top)||0;}}});}}
if(__getLocalState__&&(getLocalState||rootRef)){useCallbackRecorder(__getLocalState__,()=>{const state={};if(getLocalState){Object.assign(state,getLocalState());}
if(rootRef){if(component.env.isSmall){state[scrollSymbol]={root:{left:rootRef.el.scrollLeft,top:rootRef.el.scrollTop},};}else{const contentEl=rootRef.el.querySelector(".o_component_with_search_panel > .o_renderer_with_searchpanel,"
+".o_component_with_search_panel > .o_renderer")||rootRef.el.querySelector(".o_content");if(contentEl){state[scrollSymbol]={content:{left:contentEl.scrollLeft,top:contentEl.scrollTop},};}}}
return state;});if(rootRef){onMounted(()=>{const{state}=component.props;const scrolling=state&&state[scrollSymbol];if(scrolling){if(component.env.isSmall){rootRef.el.scrollTop=(scrolling.root&&scrolling.root.top)||0;rootRef.el.scrollLeft=(scrolling.root&&scrolling.root.left)||0;}else if(scrolling.content){const contentEl=rootRef.el.querySelector(".o_component_with_search_panel > .o_renderer_with_searchpanel,"
+".o_component_with_search_panel > .o_renderer")||rootRef.el.querySelector(".o_content");if(contentEl){contentEl.scrollTop=scrolling.content.top||0;contentEl.scrollLeft=scrolling.content.left||0;}}}});}}
if(__getContext__&&params.getContext){useCallbackRecorder(__getContext__,params.getContext);}
if(__getOrderBy__&&params.getOrderBy){useCallbackRecorder(__getOrderBy__,params.getOrderBy);}}
return __exports;});;

/* /web/static/src/webclient/actions/action_service.js */
odoo.define('@web/webclient/actions/action_service',['@web/core/l10n/translation','@web/core/browser/browser','@web/core/context','@web/core/debug/debug_context','@web/core/py_js/py','@web/core/registry','@web/core/utils/concurrency','@web/core/utils/hooks','@web/views/view','@web/webclient/actions/action_dialog','@web/webclient/actions/action_hook','@web/webclient/actions/reports/report_action','@web/core/orm_service','@web/search/control_panel/control_panel','@odoo/owl','@web/webclient/actions/reports/utils'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{browser}=require("@web/core/browser/browser");const{makeContext}=require("@web/core/context");const{useDebugCategory}=require("@web/core/debug/debug_context");const{evaluateExpr}=require("@web/core/py_js/py");const{registry}=require("@web/core/registry");const{Deferred,KeepLast}=require("@web/core/utils/concurrency");const{useBus,useService}=require("@web/core/utils/hooks");const{View,ViewNotFoundError}=require("@web/views/view");const{ActionDialog}=require("@web/webclient/actions/action_dialog");const{CallbackRecorder}=require("@web/webclient/actions/action_hook");const{ReportAction}=require("@web/webclient/actions/reports/report_action");const{UPDATE_METHODS}=require("@web/core/orm_service");const{ControlPanel}=require("@web/search/control_panel/control_panel");const{Component,markup,onMounted,onWillUnmount,onError,useChildSubEnv,xml,reactive,}=require("@odoo/owl");const{downloadReport,getReportUrl}=require("@web/webclient/actions/reports/utils");class BlankComponent extends Component{static props=["onMounted","withControlPanel","*"];static template=xml`
        <ControlPanel display="{disableDropdown: true}" t-if="props.withControlPanel and !env.isSmall">
            <t t-set-slot="layout-buttons">
                <button class="btn btn-primary invisible"> empty </button>
            </t>
        </ControlPanel>`;static components={ControlPanel};setup(){useChildSubEnv({config:{breadcrumbs:[],noBreadcrumbs:true}});onMounted(()=>this.props.onMounted());}}
const actionHandlersRegistry=registry.category("action_handlers");const actionRegistry=registry.category("actions");const viewRegistry=registry.category("views");__exports.clearUncommittedChanges=clearUncommittedChanges;async function clearUncommittedChanges(env){const callbacks=[];env.bus.trigger("CLEAR-UNCOMMITTED-CHANGES",callbacks);const res=await Promise.all(callbacks.map((fn)=>fn()));return!res.includes(false);}
const standardActionServiceProps=__exports.standardActionServiceProps={action:Object,actionId:{type:Number,optional:true},className:String,globalState:{type:Object,optional:true},state:{type:Object,optional:true},};function parseActiveIds(ids){const activeIds=[];if(typeof ids==="string"){activeIds.push(...ids.split(",").map(Number));}else if(typeof ids==="number"){activeIds.push(ids);}
return activeIds;}
const DIALOG_SIZES={"extra-large":"xl",large:"lg",medium:"md",small:"sm",};const ControllerNotFoundError=__exports.ControllerNotFoundError=class ControllerNotFoundError extends Error{}
const InvalidButtonParamsError=__exports.InvalidButtonParamsError=class InvalidButtonParamsError extends Error{}
const CTX_KEY_REGEX=/^(?:(?:default_|search_default_|show_).+|.+_view_ref|group_by|group_by_no_leaf|active_id|active_ids|orderedBy)$/;const ControllerComponentTemplate=xml`<t t-component="Component" t-props="componentProps"/>`;function makeActionManager(env){const keepLast=new KeepLast();let id=0;let controllerStack=[];let dialogCloseProm;let actionCache={};let dialog=null;let nextDialog=null;const actionParams=_getActionParams();if(actionParams&&typeof actionParams.actionRequest==="number"){const{actionRequest,options}=actionParams;_loadAction(actionRequest,options.additionalContext);}
env.bus.addEventListener("CLEAR-CACHES",()=>{actionCache={};});env.bus.addEventListener("RPC:RESPONSE",(ev)=>{const{model,method}=ev.detail.data.params;if(model==="ir.actions.act_window"&&UPDATE_METHODS.includes(method)){actionCache={};}});function _removeDialog(){if(dialog){const{onClose,remove}=dialog;dialog=null;remove();return onClose;}}
function _getCurrentController(){const stack=controllerStack;return stack.length?stack[stack.length-1]:null;}
async function _loadAction(actionRequest,context={}){if(typeof actionRequest==="string"&&actionRegistry.contains(actionRequest)){return{target:"current",tag:actionRequest,type:"ir.actions.client",};}
if(typeof actionRequest==="string"||typeof actionRequest==="number"){const additional_context={active_id:context.active_id,active_ids:context.active_ids,active_model:context.active_model,};const key=`${JSON.stringify(actionRequest)},${JSON.stringify(additional_context)}`;let action;if(!actionCache[key]){actionCache[key]=env.services.rpc("/web/action/load",{action_id:actionRequest,additional_context,});action=await actionCache[key];if(action.help){action.help=markup(action.help);}}else{action=await actionCache[key];}
if(!action){return{type:"ir.actions.client",tag:"invalid_action",id:actionRequest,};}
return Object.assign({},action);}
return actionRequest;}
function _preprocessAction(action,context={}){try{action._originalAction=JSON.stringify(action);}catch{}
action.context=makeContext([context,action.context],env.services.user.context);const domain=action.domain||[];action.domain=typeof domain==="string"?evaluateExpr(domain,Object.assign({},env.services.user.context,action.context)):domain;if(action.help){const htmlHelp=document.createElement("div");htmlHelp.innerHTML=action.help;if(!htmlHelp.innerText.trim()){delete action.help;}}
action={...action};action.jsId=`action_${++id}`;if(action.type==="ir.actions.act_window"||action.type==="ir.actions.client"){action.target=action.target||"current";}
if(action.type==="ir.actions.act_window"){action.views=[...action.views.map((v)=>[v[0],v[1]==="tree"?"list":v[1]])];action.controllers={};const target=action.target;if(target!=="inline"&&!(target==="new"&&action.views[0][1]==="form")){const searchViewId=action.search_view_id?action.search_view_id[0]:false;action.views.push([searchViewId,"search"]);}}
return action;}
function _getView(viewType){const currentController=controllerStack[controllerStack.length-1];if(currentController.action.type!=="ir.actions.act_window"){throw new Error(`switchView called but the current controller isn't a view`);}
const view=currentController.views.find((view)=>view.type===viewType);return view||null;}
function _getBreadcrumbs(stack){return stack.filter((controller)=>controller.action.tag!=="menu").map((controller)=>{return{jsId:controller.jsId,get name(){return controller.displayName;},};});}
function _getActionParams(){const state=env.services.router.current.hash;const options={clearBreadcrumbs:true};let actionRequest=null;if(state.action){const context={};if(state.active_id){context.active_id=state.active_id;}
if(state.active_ids){context.active_ids=parseActiveIds(state.active_ids);}else if(state.active_id){context.active_ids=[state.active_id];}
if(actionRegistry.contains(state.action)){actionRequest={context,params:state,tag:state.action,type:"ir.actions.client",};}else{actionRequest=state.action;context.params=state;Object.assign(options,{additionalContext:context,viewType:state.view_type,});if(state.id){options.props={resId:state.id};}}}else if(state.model){if(state.id){actionRequest={res_model:state.model,res_id:state.id,type:"ir.actions.act_window",views:[[state.view_id?state.view_id:false,"form"]],};}else if(state.view_type){const storedAction=browser.sessionStorage.getItem("current_action");const lastAction=JSON.parse(storedAction||"{}");if(lastAction.help){lastAction.help=markup(lastAction.help);}
if(lastAction.res_model===state.model){if(lastAction.context){delete lastAction.context.allowed_company_ids;}
actionRequest=lastAction;options.viewType=state.view_type;}}}
if(!actionRequest&&env.services.user.home_action_id){actionRequest=env.services.user.home_action_id;}
return actionRequest?{actionRequest,options}:null;}
function _getActionInfo(action,props){return{props:Object.assign({},props,{action,actionId:action.id}),config:{actionId:action.id,actionType:"ir.actions.client",actionFlags:action.flags,},displayName:action.display_name||action.name||"",};}
function _getActionMode(action){if(action.target==="new"){return"new";}
if(action.type==="ir.actions.client"){const clientAction=actionRegistry.get(action.tag);if(clientAction.target){return clientAction.target;}}
if(controllerStack.some((c)=>c.action.target==="fullscreen")){return"fullscreen";}
return"current";}
function _getSwitchViewParams(){const state=env.services.router.current.hash;if(state.action&&!actionRegistry.contains(state.action)){const currentController=controllerStack[controllerStack.length-1];const currentActionId=currentController&&currentController.action&&currentController.action.id;if(currentController&&currentController.action.type==="ir.actions.act_window"&&currentActionId===state.action){const props={resId:state.id||false,};const viewType=state.view_type||currentController.view.type;return{viewType,props};}}
return null;}
function _getViewInfo(view,action,views,props={}){const target=action.target;const viewSwitcherEntries=views.filter((v)=>v.multiRecord===view.multiRecord).map((v)=>{const viewSwitcherEntry={icon:v.icon,name:v.display_name.toString(),type:v.type,multiRecord:v.multiRecord,};if(view.type===v.type){viewSwitcherEntry.active=true;}
return viewSwitcherEntry;});const context=action.context||{};let groupBy=context.group_by||[];if(typeof groupBy==="string"){groupBy=[groupBy];}
const viewProps=Object.assign({},props,{context,display:{mode:target==="new"?"inDialog":target},domain:action.domain||[],groupBy,loadActionMenus:target!=="new"&&target!=="inline",loadIrFilters:action.views.some((v)=>v[1]==="search"),resModel:action.res_model,type:view.type,selectRecord:async(resId,{activeIds,mode})=>{if(target!=="new"&&_getView("form")){await switchView("form",{mode,resId,resIds:activeIds});}},createRecord:async()=>{if(target!=="new"&&_getView("form")){await switchView("form",{resId:false});}},});if(view.type==="form"){if(action.target==="new"){viewProps.mode="edit";if(!viewProps.onSave){viewProps.onSave=(record,params)=>{if(params&&params.closable){doAction({type:"ir.actions.act_window_close"});}};}}
if(action.flags&&"mode"in action.flags){viewProps.mode=action.flags.mode;}}
if(target==="inline"){viewProps.searchMenuTypes=[];}
const specialKeys=["help","useSampleModel","limit","count"];for(const key of specialKeys){if(key in action){if(key==="help"){viewProps.noContentHelp=action.help;}else{viewProps[key]=action[key];}}}
if(context.search_disable_custom_filters){viewProps.activateFavorite=false;}
if(action.res_id&&!viewProps.resId){viewProps.resId=action.res_id;}
viewProps.noBreadcrumbs="no_breadcrumbs"in action.context?action.context.no_breadcrumbs:target==="new";delete action.context.no_breadcrumbs;return{props:viewProps,config:{actionId:action.id,actionType:"ir.actions.act_window",actionFlags:action.flags,views:action.views,viewSwitcherEntries,},displayName:action.display_name||action.name||"",};}
function _computeStackIndex(options){let index=null;if(options.clearBreadcrumbs){index=0;}else if(options.stackPosition==="replaceCurrentAction"){const currentController=controllerStack[controllerStack.length-1];if(currentController){index=controllerStack.findIndex((ct)=>ct.action.jsId===currentController.action.jsId);}}else if(options.stackPosition==="replacePreviousAction"){let last;for(let i=controllerStack.length-1;i>=0;i--){const action=controllerStack[i].action.jsId;if(!last){last=action;}
if(action!==last){last=action;break;}}
if(last){index=controllerStack.findIndex((ct)=>ct.action.jsId===last);}}else if("index"in options){index=options.index;}else{index=controllerStack.length;}
return index;}
async function _updateUI(controller,options={}){let resolve;let reject;let dialogCloseResolve;let removeDialogFn;const currentActionProm=new Promise((_res,_rej)=>{resolve=_res;reject=_rej;});const action=controller.action;const index=_computeStackIndex(options);const controllerArray=[controller];if(options.lazyController){controllerArray.unshift(options.lazyController);}
const nextStack=controllerStack.slice(0,index).concat(controllerArray);controller.config.breadcrumbs=reactive(action.target==="new"?[]:_getBreadcrumbs(nextStack));controller.config.getDisplayName=()=>controller.displayName;controller.config.setDisplayName=(displayName)=>{controller.displayName=displayName;if(controller===_getCurrentController()){env.services.title.setParts({action:controller.displayName});}
if(action.target!=="new"){controller.config.breadcrumbs.push(undefined);controller.config.breadcrumbs.pop();}};controller.config.historyBack=()=>{const previousController=controllerStack[controllerStack.length-2];if(previousController&&!dialog){restore(previousController.jsId);}else{_executeCloseAction();}};class ControllerComponent extends Component{setup(){this.Component=controller.Component;this.titleService=useService("title");useDebugCategory("action",{action});useChildSubEnv({config:controller.config,});if(action.target!=="new"){this.__beforeLeave__=new CallbackRecorder();this.__getGlobalState__=new CallbackRecorder();this.__getLocalState__=new CallbackRecorder();useBus(env.bus,"CLEAR-UNCOMMITTED-CHANGES",(ev)=>{const callbacks=ev.detail;const beforeLeaveFns=this.__beforeLeave__.callbacks;callbacks.push(...beforeLeaveFns);});if(this.constructor.Component!==View){useChildSubEnv({__beforeLeave__:this.__beforeLeave__,__getGlobalState__:this.__getGlobalState__,__getLocalState__:this.__getLocalState__,});}}
this.isMounted=false;onMounted(this.onMounted);onWillUnmount(this.onWillUnmount);onError(this.onError);}
onError(error){if(this.isMounted){Promise.resolve().then(()=>{throw error;});}else{reject(error);if(action.target==="new"){removeDialogFn?.();}else{const lastCt=controllerStack[controllerStack.length-1];if(lastCt){if(lastCt.jsId!==controller.jsId){restore(lastCt.jsId);}}else{env.bus.trigger("ACTION_MANAGER:UPDATE",{});}}}}
onMounted(){if(action.target==="new"){dialogCloseProm=new Promise((_r)=>{dialogCloseResolve=_r;}).then(()=>{dialogCloseProm=undefined;});dialog=nextDialog;}else{controller.getGlobalState=()=>{const exportFns=this.__getGlobalState__.callbacks;if(exportFns.length){return Object.assign({},...exportFns.map((fn)=>fn()));}};controller.getLocalState=()=>{const exportFns=this.__getLocalState__.callbacks;if(exportFns.length){return Object.assign({},...exportFns.map((fn)=>fn()));}};const nextStackActionIds=nextStack.map((c)=>c.action.jsId);const toDestroy=new Set();for(const c of controllerStack){if(!nextStackActionIds.includes(c.action.jsId)){toDestroy.add(c);}}
for(const c of toDestroy){if(c.exportedState&&c.exportedState.__legacy_widget__){c.exportedState.__legacy_widget__.destroy();}}
controllerStack=nextStack;pushState(controller);this.titleService.setParts({action:controller.displayName});browser.sessionStorage.setItem("current_action",action._originalAction||"{}");}
resolve();env.bus.trigger("ACTION_MANAGER:UI-UPDATED",_getActionMode(action));this.isMounted=true;}
onWillUnmount(){if(action.target==="new"&&dialogCloseResolve){dialogCloseResolve();}}
get componentProps(){const componentProps={...this.props};if(this.constructor.Component===View){componentProps.__beforeLeave__=this.__beforeLeave__;componentProps.__getGlobalState__=this.__getGlobalState__;componentProps.__getLocalState__=this.__getLocalState__;}
return componentProps;}}
ControllerComponent.template=ControllerComponentTemplate;ControllerComponent.Component=controller.Component;ControllerComponent.props={"*":true,};if(action.target==="new"){const actionDialogProps={ActionComponent:ControllerComponent,actionProps:controller.props,actionType:action.type,};if(action.name){actionDialogProps.title=action.name;}
const size=DIALOG_SIZES[action.context.dialog_size];if(size){actionDialogProps.size=size;}
const onClose=_removeDialog();removeDialogFn=env.services.dialog.add(ActionDialog,actionDialogProps,{onClose:()=>{const onClose=_removeDialog();if(onClose){onClose();}},});if(nextDialog){nextDialog.remove();}
nextDialog={remove:removeDialogFn,onClose:onClose||options.onClose,};return currentActionProm;}
const currentController=_getCurrentController();if(currentController&&currentController.getLocalState){currentController.exportedState=currentController.getLocalState();}
if(controller.exportedState){controller.props.state=controller.exportedState;}
if(currentController&&currentController.getGlobalState){currentController.action.globalState=Object.assign({},currentController.action.globalState,currentController.getGlobalState());}
if(controller.action.globalState){controller.props.globalState=controller.action.globalState;}
const closingProm=_executeCloseAction();if(options.clearBreadcrumbs&&!options.noEmptyTransition){const def=new Deferred();env.bus.trigger("ACTION_MANAGER:UPDATE",{id:++id,Component:BlankComponent,componentProps:{onMounted:()=>def.resolve(),withControlPanel:action.type==="ir.actions.act_window",},});await def;}
if(options.onActionReady){options.onActionReady(action);}
controller.__info__={id:++id,Component:ControllerComponent,componentProps:controller.props,};env.services.dialog.closeAll();env.bus.trigger("ACTION_MANAGER:UPDATE",controller.__info__);return Promise.all([currentActionProm,closingProm]).then((r)=>r[0]);}
function _executeActURLAction(action,options){let url=action.url;if(url&&!(url.startsWith("http")||url.startsWith("/"))){url="/"+url;}
if(action.target==="download"||action.target==="self"){browser.location.assign(url);}else{const w=browser.open(url,"_blank");if(!w||w.closed||typeof w.closed==="undefined"){const msg=_t("A popup window has been blocked. You may need to change your "+"browser settings to allow popup windows for this page.");env.services.notification.add(msg,{sticky:true,type:"warning",});}
if(action.close){return doAction({type:"ir.actions.act_window_close"},{onClose:options.onClose});}else if(options.onClose){options.onClose();}}}
async function _executeActWindowAction(action,options){const views=[];for(const[,type]of action.views){if(type!=="search"&&viewRegistry.contains(type)){views.push(viewRegistry.get(type));}}
if(!views.length){throw new Error(`No view found for act_window action ${action.id}`);}
let view=options.viewType&&views.find((v)=>v.type===options.viewType);let lazyView;if(view&&!view.multiRecord){lazyView=views[0].multiRecord?views[0]:undefined;}else if(!view){view=views[0];}
if(env.isSmall){view=_findView(views,view.multiRecord,action.mobile_view_mode)||view;if(lazyView){lazyView=_findView(views,lazyView.multiRecord,action.mobile_view_mode)||lazyView;}}
const controller={jsId:`controller_${++id}`,Component:View,action,view,views,..._getViewInfo(view,action,views,options.props),};action.controllers[view.type]=controller;const updateUIOptions={clearBreadcrumbs:options.clearBreadcrumbs,onClose:options.onClose,stackPosition:options.stackPosition,onActionReady:options.onActionReady,noEmptyTransition:options.noEmptyTransition,};if(lazyView){updateUIOptions.lazyController={jsId:`controller_${++id}`,Component:View,action,view:lazyView,views,..._getViewInfo(lazyView,action,views),};}
return _updateUI(controller,updateUIOptions);}
function _findView(views,multiRecord,viewType){return views.find((v)=>v.type===viewType&&v.multiRecord==multiRecord);}
async function _executeClientAction(action,options){const clientAction=actionRegistry.get(action.tag);if(clientAction.prototype instanceof Component){if(action.target!=="new"){const canProceed=await clearUncommittedChanges(env);if(!canProceed){return;}
if(clientAction.target){action.target=clientAction.target;}}
const controller={jsId:`controller_${++id}`,Component:clientAction,action,..._getActionInfo(action,options.props),};return _updateUI(controller,{clearBreadcrumbs:options.clearBreadcrumbs,stackPosition:options.stackPosition,onClose:options.onClose,onActionReady:options.onActionReady,noEmptyTransition:options.noEmptyTransition,});}else{const next=await clientAction(env,action);if(next){return doAction(next,options);}}}
function _executeReportClientAction(action,options){const props=Object.assign({},options.props,{data:action.data,display_name:action.display_name,name:action.name,report_file:action.report_file,report_name:action.report_name,report_url:getReportUrl(action,"html",env.services.user.context),context:Object.assign({},action.context),});const controller={jsId:`controller_${++id}`,Component:ReportAction,action,..._getActionInfo(action,props),};return _updateUI(controller,{clearBreadcrumbs:options.clearBreadcrumbs,stackPosition:options.stackPosition,onClose:options.onClose,});}
async function _executeReportAction(action,options){const handlers=registry.category("ir.actions.report handlers").getAll();for(const handler of handlers){const result=await handler(action,options,env);if(result){return result;}}
if(action.report_type==="qweb-html"){return _executeReportClientAction(action,options);}else if(action.report_type==="qweb-pdf"||action.report_type==="qweb-text"){const type=action.report_type.slice(5);let success,message;env.services.ui.block();try{const downloadContext={...env.services.user.context};if(action.context){Object.assign(downloadContext,action.context);}
({success,message}=await downloadReport(env.services.rpc,action,type,downloadContext));}finally{env.services.ui.unblock();}
if(message){env.services.notification.add(message,{sticky:true,title:_t("Report"),});}
if(!success){return _executeReportClientAction(action,options);}
const{onClose}=options;if(action.close_on_report_download){return doAction({type:"ir.actions.act_window_close"},{onClose});}else if(onClose){onClose();}}else{console.error(`The ActionManager can't handle reports of type ${action.report_type}`,action);}}
async function _executeServerAction(action,options){const runProm=env.services.rpc("/web/action/run",{action_id:action.id,context:makeContext([env.services.user.context,action.context]),});let nextAction=await keepLast.add(runProm);if(nextAction.help){nextAction.help=markup(nextAction.help);}
nextAction=nextAction||{type:"ir.actions.act_window_close"};return doAction(nextAction,options);}
async function _executeCloseAction(params={}){let onClose;if(dialog){onClose=_removeDialog();}else{onClose=params.onClose;}
if(onClose){await onClose(params.onCloseInfo);}
return dialogCloseProm;}
async function doAction(actionRequest,options={}){const actionProm=_loadAction(actionRequest,options.additionalContext);let action=await keepLast.add(actionProm);action=_preprocessAction(action,options.additionalContext);options.clearBreadcrumbs=action.target==="main"||options.clearBreadcrumbs;switch(action.type){case"ir.actions.act_url":return _executeActURLAction(action,options);case"ir.actions.act_window":if(action.target!=="new"){const canProceed=await clearUncommittedChanges(env);if(!canProceed){return new Promise(()=>{});}}
return _executeActWindowAction(action,options);case"ir.actions.act_window_close":return _executeCloseAction({onClose:options.onClose,onCloseInfo:action.infos});case"ir.actions.client":return _executeClientAction(action,options);case"ir.actions.report":return _executeReportAction(action,options);case"ir.actions.server":return _executeServerAction(action,options);default:{const handler=actionHandlersRegistry.get(action.type,null);if(handler!==null){return handler({env,action,options});}
throw new Error(`The ActionManager service can't handle actions of type ${action.type}`);}}}
async function doActionButton(params){let action;const context=makeContext([params.context,params.buttonContext]);if(params.special){action={type:"ir.actions.act_window_close",infos:{special:true}};}else if(params.type==="object"){let args=params.resId?[[params.resId]]:[params.resIds];if(params.args){let additionalArgs;try{additionalArgs=JSON.parse(params.args.replace(/'/g,'"'));}catch{browser.console.error("Could not JSON.parse arguments",params.args);}
args=args.concat(additionalArgs);}
const callProm=env.services.rpc("/web/dataset/call_button",{args,kwargs:{context},method:params.name,model:params.resModel,});action=await keepLast.add(callProm);action=action&&typeof action==="object"?action:{type:"ir.actions.act_window_close"};if(action.help){action.help=markup(action.help);}}else if(params.type==="action"){context.active_id=params.resId||null;context.active_ids=params.resIds;context.active_model=params.resModel;action=await keepLast.add(_loadAction(params.name,context));}else{throw new InvalidButtonParamsError("Missing type for doActionButton request");}
const currentCtx={};for(const key in params.context){if(key.match(CTX_KEY_REGEX)===null){currentCtx[key]=params.context[key];}}
const activeCtx={active_model:params.resModel};if(params.resId){activeCtx.active_id=params.resId;activeCtx.active_ids=[params.resId];}
action.context=makeContext([currentCtx,params.buttonContext,activeCtx,action.context]);const effect=params.effect?evaluateExpr(params.effect):action.effect;const options={onClose:params.onClose};await doAction(action,options);if(params.close){await _executeCloseAction();}
if(effect){env.services.effect.add(effect);}}
async function switchView(viewType,props={}){await keepLast.add(Promise.resolve());if(dialog){return;}
const controller=controllerStack[controllerStack.length-1];const view=_getView(viewType);if(!view){throw new ViewNotFoundError(_t("No view of type '%s' could be found in the current action.",viewType));}
const newController=controller.action.controllers[viewType]||{jsId:`controller_${++id}`,Component:View,action:controller.action,views:controller.views,view,};const canProceed=await clearUncommittedChanges(env);if(!canProceed){return;}
Object.assign(newController,_getViewInfo(view,controller.action,controller.views,props));controller.action.controllers[viewType]=newController;let index;if(view.multiRecord){index=controllerStack.findIndex((ct)=>ct.action.jsId===controller.action.jsId);index=index>-1?index:controllerStack.length-1;}else{index=controllerStack.findIndex((ct)=>ct.action.jsId===controller.action.jsId&&!ct.view.multiRecord);index=index>-1?index:controllerStack.length;}
return _updateUI(newController,{index});}
async function restore(jsId){await keepLast.add(Promise.resolve());let index;if(!jsId){index=controllerStack.length-2;}else{index=controllerStack.findIndex((controller)=>controller.jsId===jsId);}
if(index<0){const msg=jsId?"Invalid controller to restore":"No controller to restore";throw new ControllerNotFoundError(msg);}
const canProceed=await clearUncommittedChanges(env);if(!canProceed){return;}
const controller=controllerStack[index];if(controller.action.type==="ir.actions.act_window"){const{action,exportedState,view,views}=controller;const props={...controller.props};if(exportedState&&"resId"in exportedState){props.resId=exportedState.resId;}
Object.assign(controller,_getViewInfo(view,action,views,props));}
return _updateUI(controller,{index});}
async function loadState(){const switchViewParams=_getSwitchViewParams();if(switchViewParams){const{viewType,props}=switchViewParams;const view=_getView(viewType);if(view){await switchView(viewType,props);return true;}}else{const actionParams=_getActionParams();if(actionParams){const{actionRequest,options}=actionParams;await doAction(actionRequest,options);return true;}}
return false;}
function pushState(controller){const newState={};const action=controller.action;if(action.id){newState.action=action.id;}else if(action.type==="ir.actions.client"){newState.action=action.tag;}
if(action.context){const activeId=action.context.active_id;if(activeId){newState.active_id=activeId;}
const activeIds=action.context.active_ids;if(activeIds&&!(activeIds.length===1&&activeIds[0]===activeId)){newState.active_ids=activeIds.join(",");}}
if(action.type==="ir.actions.act_window"){const props=controller.props;newState.model=props.resModel;newState.view_type=props.type;newState.id=props.resId||(props.state&&props.state.resId)||undefined;}
env.services.router.pushState(newState,{replace:true});}
return{doAction,doActionButton,switchView,restore,loadState,async loadAction(actionRequest,context){const action=await _loadAction(actionRequest,context);return _preprocessAction(action,context);},get currentController(){return _getCurrentController();},};}
const actionService=__exports.actionService={dependencies:["effect","localization","notification","router","rpc","title","ui","user","dialog",],start(env){return makeActionManager(env);},};registry.category("services").add("action",actionService);return __exports;});;

/* /web/static/src/webclient/actions/client_actions.js */
odoo.define('@web/webclient/actions/client_actions',['@web/core/l10n/translation','@web/core/browser/browser','@web/core/browser/router_service','@web/core/registry','@web/core/utils/hooks','@web/core/utils/strings','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{browser}=require("@web/core/browser/browser");const{routeToUrl}=require("@web/core/browser/router_service");const{registry}=require("@web/core/registry");const{useService}=require("@web/core/utils/hooks");const{escape,sprintf}=require("@web/core/utils/strings");const{Component,markup,onMounted,xml}=require("@odoo/owl");__exports.displayNotificationAction=displayNotificationAction;function displayNotificationAction(env,action){const params=action.params||{};const options={className:params.className||"",sticky:params.sticky||false,title:params.title,type:params.type||"info",};const links=(params.links||[]).map((link)=>{return`<a href="${escape(link.url)}" target="_blank">${escape(link.label)}</a>`;});const message=markup(sprintf(escape(params.message),...links));env.services.notification.add(message,options);return params.next;}
registry.category("actions").add("display_notification",displayNotificationAction);class InvalidAction extends Component{setup(){this.notification=useService("notification");onMounted(this.onMounted);}
onMounted(){const message=_t("No action with id '%s' could be found",this.props.actionId);this.notification.add(message,{type:"danger"});}}
InvalidAction.template=xml`<div class="o_invalid_action"></div>`;registry.category("actions").add("invalid_action",InvalidAction);function reload(env,action){const{menu_id,action_id}=action.params||{};const{router}=env.services;const route={...router.current};if(menu_id||action_id){route.hash={};if(menu_id){route.hash.menu_id=menu_id;}
if(action_id){route.hash.action=action_id;}}
route.search={...route.search};if("reload"in route.search){delete route.search.reload;}else{route.search.reload=true;}
const url=browser.location.origin+routeToUrl(route);env.bus.trigger("CLEAR-CACHES");browser.location.assign(url);}
registry.category("actions").add("reload",reload);async function home(env){await new Promise((resolve)=>{const waitForServer=(delay)=>{browser.setTimeout(async()=>{env.services.rpc("/web/webclient/version_info",{}).then(resolve).catch(()=>waitForServer(250));},delay);};waitForServer(1000);});const url="/"+(browser.location.search||"");browser.location.assign(url);}
registry.category("actions").add("home",home);async function reloadContext(env,action){await env.services.rpc("/web/session/get_session_info");reload(env,action);}
registry.category("actions").add("reload_context",reloadContext);async function softReload(env,action){const controller=env.services.action.currentController;if(controller){await env.services.action.restore(controller.jsId);}}
registry.category("actions").add("soft_reload",softReload);return __exports;});;

/* /web/static/src/webclient/actions/debug_items.js */
odoo.define('@web/webclient/actions/debug_items',['@web/core/l10n/translation','@web/core/debug/debug_utils','@web/core/registry'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{editModelDebug}=require("@web/core/debug/debug_utils");const{registry}=require("@web/core/registry");const debugRegistry=registry.category("debug");function actionSeparator({action}){if(!action.id||!action.res_model){return null;}
return{type:"separator",sequence:100,};}
function accessSeparator({accessRights,action}){const{canSeeModelAccess,canSeeRecordRules}=accessRights;if(!action.res_model||(!canSeeModelAccess&&!canSeeRecordRules)){return null;}
return{type:"separator",sequence:200,};}
function editAction({action,env}){if(!action.id){return null;}
const description=_t("Edit Action");return{type:"item",description,callback:()=>{editModelDebug(env,description,action.type,action.id);},sequence:110,};}
function viewFields({action,env}){if(!action.res_model){return null;}
const description=_t("View Fields");return{type:"item",description,callback:async()=>{const modelId=(await env.services.orm.search("ir.model",[["model","=",action.res_model]],{limit:1,}))[0];env.services.action.doAction({res_model:"ir.model.fields",name:description,views:[[false,"list"],[false,"form"],],domain:[["model_id","=",modelId]],type:"ir.actions.act_window",context:{default_model_id:modelId,},});},sequence:120,};}
function manageFilters({action,env}){if(!action.res_model){return null;}
const description=_t("Manage Filters");return{type:"item",description,callback:()=>{env.services.action.doAction({res_model:"ir.filters",name:description,views:[[false,"list"],[false,"form"],],type:"ir.actions.act_window",context:{search_default_my_filters:true,search_default_model_id:action.res_model,},});},sequence:130,};}
function viewAccessRights({accessRights,action,env}){if(!action.res_model||!accessRights.canSeeModelAccess){return null;}
const description=_t("View Access Rights");return{type:"item",description,callback:async()=>{const modelId=(await env.services.orm.search("ir.model",[["model","=",action.res_model]],{limit:1,}))[0];env.services.action.doAction({res_model:"ir.model.access",name:description,views:[[false,"list"],[false,"form"],],domain:[["model_id","=",modelId]],type:"ir.actions.act_window",context:{default_model_id:modelId,},});},sequence:210,};}
function viewRecordRules({accessRights,action,env}){if(!action.res_model||!accessRights.canSeeRecordRules){return null;}
const description=_t("Model Record Rules");return{type:"item",description:_t("View Record Rules"),callback:async()=>{const modelId=(await env.services.orm.search("ir.model",[["model","=",action.res_model]],{limit:1,}))[0];env.services.action.doAction({res_model:"ir.rule",name:description,views:[[false,"list"],[false,"form"],],domain:[["model_id","=",modelId]],type:"ir.actions.act_window",context:{default_model_id:modelId,},});},sequence:220,};}
debugRegistry.category("action").add("actionSeparator",actionSeparator).add("editAction",editAction).add("viewFields",viewFields).add("manageFilters",manageFilters).add("accessSeparator",accessSeparator).add("viewAccessRights",viewAccessRights).add("viewRecordRules",viewRecordRules);return __exports;});;

/* /web/static/src/webclient/actions/reports/report_action.js */
odoo.define('@web/webclient/actions/reports/report_action',['@web/core/utils/hooks','@web/search/layout','@web/views/view','@web/webclient/actions/action_hook','@web/webclient/actions/reports/report_hook','@odoo/owl'],function(require){'use strict';let __exports={};const{useService}=require("@web/core/utils/hooks");const{Layout}=require("@web/search/layout");const{getDefaultConfig}=require("@web/views/view");const{useSetupAction}=require("@web/webclient/actions/action_hook");const{useEnrichWithActionLinks}=require("@web/webclient/actions/reports/report_hook");const{Component,useRef,useSubEnv}=require("@odoo/owl");const ReportAction=__exports.ReportAction=class ReportAction extends Component{setup(){useSubEnv({config:{...getDefaultConfig(),...this.env.config,},});useSetupAction();this.action=useService("action");this.title=this.props.display_name||this.props.name;this.reportUrl=this.props.report_url;this.iframe=useRef("iframe");useEnrichWithActionLinks(this.iframe);}
onIframeLoaded(ev){const iframeDocument=ev.target.contentWindow.document;iframeDocument.body.classList.add("o_in_iframe","container-fluid");iframeDocument.body.classList.remove("container");}
print(){this.action.doAction({type:"ir.actions.report",report_type:"qweb-pdf",report_name:this.props.report_name,report_file:this.props.report_file,data:this.props.data||{},context:this.props.context||{},display_name:this.title,});}}
ReportAction.components={Layout};ReportAction.template="web.ReportAction";return __exports;});;

/* /web/static/src/webclient/actions/reports/report_hook.js */
odoo.define('@web/webclient/actions/reports/report_hook',['@odoo/owl'],function(require){'use strict';let __exports={};const{useComponent,useEffect}=require("@odoo/owl");__exports.useEnrichWithActionLinks=useEnrichWithActionLinks;function useEnrichWithActionLinks(ref,selector=null){const comp=useComponent();useEffect((element)=>{if(element.matches("iframe")){element.onload=()=>enrich(comp,element,selector,true);}else{enrich(comp,element,selector);}},()=>[ref.el]);}
function enrich(component,targetElement,selector,isIFrame=false){let doc=window.document;if(isIFrame){targetElement=targetElement.contentDocument;doc=targetElement;}
const targets=[];if(selector){targets.push(...targetElement.querySelectorAll(selector));}else{targets.push(targetElement);}
for(const currentTarget of targets){const elementsToWrap=currentTarget.querySelectorAll("[res-id][res-model][view-type]");for(const element of elementsToWrap.values()){const wrapper=doc.createElement("a");wrapper.setAttribute("href","#");wrapper.addEventListener("click",(ev)=>{ev.preventDefault();component.env.services.action.doAction({type:"ir.actions.act_window",view_mode:element.getAttribute("view-type"),res_id:Number(element.getAttribute("res-id")),res_model:element.getAttribute("res-model"),views:[[element.getAttribute("view-id"),element.getAttribute("view-type")]],});});element.parentNode.insertBefore(wrapper,element);wrapper.appendChild(element);}}}
return __exports;});;

/* /web/static/src/webclient/company_service.js */
odoo.define('@web/webclient/company_service',['@web/core/browser/browser','@web/core/registry','@web/session','@web/core/orm_service','@web/core/browser/cookie'],function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{registry}=require("@web/core/registry");const{session}=require("@web/session");const{UPDATE_METHODS}=require("@web/core/orm_service");const{cookie}=require("@web/core/browser/cookie");const CIDS_HASH_SEPARATOR="-";function parseCompanyIds(cids,separator=","){if(typeof cids==="string"){return cids.split(separator).map(Number);}else if(typeof cids==="number"){return[cids];}
return[];}
function formatCompanyIds(cids,separator=","){return cids.join(separator);}
function computeActiveCompanyIds(cids){const{user_companies}=session;let activeCompanyIds=cids||[];const availableCompaniesFromSession=user_companies.allowed_companies;const notAllowedCompanies=activeCompanyIds.filter((id)=>!(id in availableCompaniesFromSession));if(!activeCompanyIds.length||notAllowedCompanies.length){activeCompanyIds=[user_companies.current_company];}
return activeCompanyIds;}
function getCompanyIdsFromBrowser(hash){let cids;if("cids"in hash){let separator=CIDS_HASH_SEPARATOR;if(typeof hash.cids==="string"&&!hash.cids.includes(CIDS_HASH_SEPARATOR)){separator=",";}
cids=parseCompanyIds(hash.cids,separator);}else if(cookie.get("cids")){cids=parseCompanyIds(cookie.get("cids"));}
return cids||[];}
const errorHandlerRegistry=registry.category("error_handlers");function accessErrorHandler(env,error,originalError){const router=env.services.router;const hash=router.current.hash;if(!hash._company_switching){return false;}
if(originalError?.exceptionName==="odoo.exceptions.AccessError"){const{model,id,view_type}=hash;if(!model||!id||view_type!=="form"){return false;}
router.pushState({view_type:undefined});browser.setTimeout(()=>{env.bus.trigger("ROUTE_CHANGE");});if(error.event){error.event.preventDefault();}
return true;}
return false;}
const companyService=__exports.companyService={dependencies:["user","router","action"],start(env,{user,router,action}){errorHandlerRegistry.add("accessErrorHandlerCompanies",accessErrorHandler);const allowedCompanies=session.user_companies.allowed_companies;const disallowedAncestorCompanies=session.user_companies.disallowed_ancestor_companies;const allowedCompaniesWithAncestors={...allowedCompanies,...disallowedAncestorCompanies,};const activeCompanyIds=computeActiveCompanyIds(getCompanyIdsFromBrowser(router.current.hash));const cidsHash=formatCompanyIds(activeCompanyIds,CIDS_HASH_SEPARATOR);router.replaceState({cids:cidsHash},{lock:true});cookie.set("cids",formatCompanyIds(activeCompanyIds));user.updateContext({allowed_company_ids:activeCompanyIds});env.bus.addEventListener("RPC:RESPONSE",(ev)=>{const{data,error}=ev.detail;const{model,method}=data.params;if(!error&&model==="res.company"&&UPDATE_METHODS.includes(method)){if(!browser.localStorage.getItem("running_tour")){action.doAction("reload_context");}}});return{allowedCompanies,allowedCompaniesWithAncestors,disallowedAncestorCompanies,get activeCompanyIds(){return activeCompanyIds.slice();},get currentCompany(){return allowedCompanies[activeCompanyIds[0]];},getCompany(companyId){return allowedCompaniesWithAncestors[companyId];},setCompanies(companyIds,includeChildCompanies=true){const newCompanyIds=companyIds.length?companyIds:[activeCompanyIds[0]];function addCompanies(companyIds){for(const companyId of companyIds){if(!newCompanyIds.includes(companyId)){newCompanyIds.push(companyId);addCompanies(allowedCompanies[companyId].child_ids);}}}
if(includeChildCompanies){addCompanies(companyIds.flatMap((companyId)=>allowedCompanies[companyId].child_ids));}
const cidsHash=formatCompanyIds(newCompanyIds,CIDS_HASH_SEPARATOR);router.pushState({cids:cidsHash},{lock:true});router.pushState({_company_switching:true});cookie.set("cids",formatCompanyIds(newCompanyIds));browser.setTimeout(()=>browser.location.reload());},};},};registry.category("services").add("company",companyService);return __exports;});;

/* /pos_restaurant/static/src/app/bill_screen/bill_screen.js */
odoo.define('@pos_restaurant/app/bill_screen/bill_screen',['@point_of_sale/app/screens/receipt_screen/receipt_screen','@point_of_sale/app/screens/receipt_screen/receipt/order_receipt','@web/core/registry'],function(require){'use strict';let __exports={};const{ReceiptScreen}=require("@point_of_sale/app/screens/receipt_screen/receipt_screen");const{OrderReceipt}=require("@point_of_sale/app/screens/receipt_screen/receipt/order_receipt");const{registry}=require("@web/core/registry");const BillScreen=__exports.BillScreen=class BillScreen extends ReceiptScreen{static template="pos_restaurant.BillScreen";static components={OrderReceipt};confirm(){if(!this.env.isMobile){this.props.resolve({confirmed:true,payload:null});this.pos.closeTempScreen();}}
async printReceipt(){await super.printReceipt();this.currentOrder._printed=false;}
get isBill(){return true;}}
registry.category("pos_screens").add("BillScreen",BillScreen);return __exports;});;

/* /pos_restaurant/static/src/app/control_buttons/orderline_note_button/orderline_note_button.js */
odoo.define('@pos_restaurant/app/control_buttons/orderline_note_button/orderline_note_button',['@web/core/l10n/translation','@point_of_sale/app/screens/product_screen/product_screen','@web/core/utils/hooks','@point_of_sale/app/utils/input_popups/textarea_popup','@odoo/owl','@point_of_sale/app/store/pos_hook'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{useService}=require("@web/core/utils/hooks");const{TextAreaPopup}=require("@point_of_sale/app/utils/input_popups/textarea_popup");const{Component}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const OrderlineNoteButton=__exports.OrderlineNoteButton=class OrderlineNoteButton extends Component{static template="pos_restaurant.OrderlineNoteButton";setup(){this.pos=usePos();this.popup=useService("popup");}
get selectedOrderline(){return this.pos.get_order().get_selected_orderline();}
async click(){if(!this.selectedOrderline){return;}
const oldNote=this.selectedOrderline.getNote();const{confirmed,payload:inputNote}=await this.popup.add(TextAreaPopup,{startingValue:this.selectedOrderline.getNote(),title:_t("Add internal Note"),});if(confirmed){this.selectedOrderline.setNote(inputNote);}
return{confirmed,inputNote,oldNote};}}
ProductScreen.addControlButton({component:OrderlineNoteButton,condition:function(){return this.pos.config.iface_orderline_notes;},});return __exports;});;

/* /pos_restaurant/static/src/app/control_buttons/print_bill_button/print_bill_button.js */
odoo.define('@pos_restaurant/app/control_buttons/print_bill_button/print_bill_button',['@point_of_sale/app/store/pos_hook','@point_of_sale/app/screens/product_screen/product_screen','@odoo/owl','@point_of_sale/app/screens/receipt_screen/receipt/order_receipt','@web/core/utils/hooks','@point_of_sale/app/utils/hooks'],function(require){'use strict';let __exports={};const{usePos}=require("@point_of_sale/app/store/pos_hook");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{Component}=require("@odoo/owl");const{OrderReceipt}=require("@point_of_sale/app/screens/receipt_screen/receipt/order_receipt");const{useService}=require("@web/core/utils/hooks");const{useAsyncLockedMethod}=require("@point_of_sale/app/utils/hooks");const PrintBillButton=__exports.PrintBillButton=class PrintBillButton extends Component{static template="pos_restaurant.PrintBillButton";setup(){this.pos=usePos();this.printer=useService("printer");this.click=useAsyncLockedMethod(this.click);}
_isDisabled(){const order=this.pos.get_order();if(!order){return false;}
return order.get_orderlines().length===0;}
async click(){(await this.printer.print(OrderReceipt,{data:this.pos.get_order().export_for_printing(),formatCurrency:this.env.utils.formatCurrency,}))||this.pos.showTempScreen("BillScreen");}}
ProductScreen.addControlButton({component:PrintBillButton,condition:function(){return this.pos.config.iface_printbill;},});return __exports;});;

/* /pos_restaurant/static/src/app/control_buttons/split_bill_button/split_bill_button.js */
odoo.define('@pos_restaurant/app/control_buttons/split_bill_button/split_bill_button',['@point_of_sale/app/store/pos_hook','@point_of_sale/app/screens/product_screen/product_screen','@odoo/owl'],function(require){'use strict';let __exports={};const{usePos}=require("@point_of_sale/app/store/pos_hook");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{Component}=require("@odoo/owl");const SplitBillButton=__exports.SplitBillButton=class SplitBillButton extends Component{static template="pos_restaurant.SplitBillButton";setup(){this.pos=usePos();}
_isDisabled(){const order=this.pos.get_order();return(order.get_orderlines().reduce((totalProduct,orderline)=>totalProduct+orderline.quantity,0)<2);}
async click(){this.pos.showScreen("SplitBillScreen");}}
ProductScreen.addControlButton({component:SplitBillButton,condition:function(){return this.pos.config.iface_splitbill;},});return __exports;});;

/* /pos_restaurant/static/src/app/control_buttons/table_guests_button/table_guests_button.js */
odoo.define('@pos_restaurant/app/control_buttons/table_guests_button/table_guests_button',['@web/core/l10n/translation','@point_of_sale/app/screens/product_screen/product_screen','@web/core/utils/hooks','@point_of_sale/app/utils/input_popups/number_popup','@point_of_sale/app/errors/popups/error_popup','@odoo/owl','@point_of_sale/app/store/pos_hook'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{useService}=require("@web/core/utils/hooks");const{NumberPopup}=require("@point_of_sale/app/utils/input_popups/number_popup");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{Component}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const TableGuestsButton=__exports.TableGuestsButton=class TableGuestsButton extends Component{static template="pos_restaurant.TableGuestsButton";setup(){this.pos=usePos();this.popup=useService("popup");}
get currentOrder(){return this.pos.get_order();}
get nGuests(){return this.currentOrder?this.currentOrder.getCustomerCount():0;}
async click(){const{confirmed,payload:inputNumber}=await this.popup.add(NumberPopup,{startingValue:this.nGuests,cheap:true,title:_t("Guests?"),isInputSelected:true,});if(confirmed){const guestCount=parseInt(inputNumber,10)||0;const max_capacity=2**31-1;if(guestCount>max_capacity){await this.popup.add(ErrorPopup,{title:_t("Blocked action"),body:_t("You cannot put a number that exceeds %s ",max_capacity),});return;}
if(guestCount==0&&this.currentOrder.orderlines.length===0){this.pos.removeOrder(this.currentOrder);this.pos.showScreen("FloorScreen");}
this.currentOrder.setCustomerCount(guestCount);}}}
ProductScreen.addControlButton({component:TableGuestsButton,condition:function(){return this.pos.config.module_pos_restaurant;},});return __exports;});;

/* /pos_restaurant/static/src/app/control_buttons/transfer_order_button/transfer_order_button.js */
odoo.define('@pos_restaurant/app/control_buttons/transfer_order_button/transfer_order_button',['@point_of_sale/app/store/pos_hook','@point_of_sale/app/screens/product_screen/product_screen','@odoo/owl'],function(require){'use strict';let __exports={};const{usePos}=require("@point_of_sale/app/store/pos_hook");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{Component}=require("@odoo/owl");const TransferOrderButton=__exports.TransferOrderButton=class TransferOrderButton extends Component{static template="pos_restaurant.TransferOrderButton";setup(){this.pos=usePos();}
async click(){this.pos.setCurrentOrderToTransfer();this.pos.showScreen("FloorScreen");}}
ProductScreen.addControlButton({component:TransferOrderButton,condition:function(){return this.pos.config.module_pos_restaurant;},});return __exports;});;

/* /pos_restaurant/static/src/app/floor_screen/edit_bar.js */
odoo.define('@pos_restaurant/app/floor_screen/edit_bar',['@odoo/owl','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{Component,useExternalListener,useState}=require("@odoo/owl");const{useService}=require("@web/core/utils/hooks");const EditBar=__exports.EditBar=class EditBar extends Component{static template="pos_restaurant.EditBar";static props={selectedTables:Object,nbrFloors:Number,floorMapScrollTop:Number,isColorPicker:Boolean,toggleColorPicker:Function,createTable:Function,duplicateTableOrFloor:Function,renameTable:Function,changeSeatsNum:Function,changeToCircle:Function,changeToSquare:Function,setTableColor:Function,setFloorColor:Function,deleteFloorOrTable:Function,toggleEditMode:Function,};setup(){this.ui=useState(useService("ui"));useExternalListener(window,"click",this.onOutsideClick);}
onOutsideClick(){if(this.props.isColorPicker){this.props.isColorPicker=false;}}
getSelectedTablesShape(){let shape="round";this.props.selectedTables.forEach((table)=>{if(table.shape=="square"){shape="square";}});return shape;}}
return __exports;});;

/* /pos_restaurant/static/src/app/floor_screen/editable_table.js */
odoo.define('@pos_restaurant/app/floor_screen/editable_table',['@point_of_sale/app/utils/movable_hook','@odoo/owl','@pos_restaurant/app/floor_screen/table','@point_of_sale/app/store/pos_hook'],function(require){'use strict';let __exports={};const{getLimits,useMovable,constrain}=require("@point_of_sale/app/utils/movable_hook");const{onWillUnmount,useEffect,useRef,Component}=require("@odoo/owl");const{Table}=require("@pos_restaurant/app/floor_screen/table");const{usePos}=require("@point_of_sale/app/store/pos_hook");const MIN_TABLE_SIZE=30;const EditableTable=__exports.EditableTable=class EditableTable extends Component{static template="pos_restaurant.EditableTable";static props={onSaveTable:Function,limit:{type:Object,shape:{el:[HTMLElement,{value:null}]}},table:Table.props.table,selectedTables:Array,};setup(){this.pos=usePos();useEffect(this._setElementStyle.bind(this));this.root=useRef("root");this.handles={"top left":["minX","minY"],"top right":["maxX","minY"],"bottom left":["minX","maxY"],"bottom right":["maxX","maxY"],};useMovable({ref:this.root,onMoveStart:()=>this.onMoveStart(),onMove:(delta)=>this.onMove(delta),});for(const[handle,toMove]of Object.entries(this.handles)){useMovable({ref:useRef(handle),onMoveStart:()=>this.onMoveStart(),onMove:(delta)=>this.onResizeHandleMove(toMove,delta),});}
onWillUnmount(()=>this.props.onSaveTable(this.props.table));}
onMoveStart(){if(this.pos.floorPlanStyle=="kanban"){return;}
this.startTable={...this.props.table};this.selectedTablesCopy={};for(let i=0;i<this.props.selectedTables.length;i++){this.selectedTablesCopy[i]={...this.props.selectedTables[i]};}
document.addEventListener("click",(ev)=>ev.stopPropagation(),{capture:true,once:true,});}
onMove({dx,dy}){if(this.pos.floorPlanStyle=="kanban"){return;}
const{minX,minY,maxX,maxY}=getLimits(this.root.el,this.props.limit.el);for(const[index,table]of Object.entries(this.selectedTablesCopy)){const position_h=table.position_h;const position_v=table.position_v;this.props.selectedTables[index].position_h=constrain(position_h+dx,minX,maxX);this.props.selectedTables[index].position_v=constrain(position_v+dy,minY,maxY);}
this._setElementStyle();}
onResizeHandleMove([moveX,moveY],{dx,dy}){if(this.pos.floorPlanStyle=="kanban"){return;}
const{width,height,position_h:minX,position_v:minY}=this.startTable;const newTable={minX,minY,maxX:minX+width,maxY:minY+height};const limits=getLimits(this.root.el,this.props.limit.el);const{width:elWidth,height:elHeight}=this.root.el.getBoundingClientRect();const bounds={maxX:[minX+MIN_TABLE_SIZE,limits.maxX+elWidth],minX:[limits.minX,newTable.maxX-MIN_TABLE_SIZE],maxY:[minY+MIN_TABLE_SIZE,limits.maxY+elHeight],minY:[limits.minY,newTable.maxY-MIN_TABLE_SIZE],};newTable[moveX]=constrain(newTable[moveX]+dx,...bounds[moveX]);newTable[moveY]=constrain(newTable[moveY]+dy,...bounds[moveY]);this.props.table.position_h=newTable.minX;this.props.table.position_v=newTable.minY;this.props.table.width=newTable.maxX-newTable.minX;this.props.table.height=newTable.maxY-newTable.minY;this._setElementStyle();}
computeHandleStyle(handleName){const table=this.props.table;let offset=-24;if(table.shape==="round"){offset+=Math.min(table.width/2,table.height/2)*0.2929;}
return handleName.split(" ").map((dir)=>`${dir}: ${offset}px;`).join(" ");}
_setElementStyle(){const table=this.props.table;if(this.pos.floorPlanStyle=="kanban"){const floor=table.floor;const index=floor.tables.indexOf(table);const minWidth=100+20;const nbrHorizontal=Math.floor(window.innerWidth/minWidth);const widthTable=(window.innerWidth-nbrHorizontal*10)/nbrHorizontal;const position_h=widthTable*(index%nbrHorizontal)+5+(index%nbrHorizontal)*10;const position_v=(widthTable+25)*Math.floor(index/nbrHorizontal)+
10+
Math.floor(index/nbrHorizontal)*10;Object.assign(this.root.el.style,{left:`${position_h}px`,top:`${position_v}px`,width:`${widthTable}px`,height:`${widthTable}px`,background:table.color||"rgb(53, 211, 116)","line-height":`${widthTable}px`,"border-radius":table.shape==="round"?"1000px":"3px","font-size":widthTable>=150?"32px":"16px",opacity:"0.7",});return;}
Object.assign(this.root.el.style,{left:`${table.position_h}px`,top:`${table.position_v}px`,width:`${table.width}px`,height:`${table.height}px`,background:table.color||"rgb(53, 211, 116)","line-height":`${table.height}px`,"border-radius":table.shape==="round"?"1000px":"3px","font-size":table.height>=150&&table.width>=150?"32px":"16px",});}}
return __exports;});;

/* /pos_restaurant/static/src/app/floor_screen/floor_screen.js */
odoo.define('@pos_restaurant/app/floor_screen/floor_screen',['@web/core/l10n/translation','@web/core/utils/strings','@web/core/network/rpc_service','@web/core/utils/timing','@web/core/registry','@point_of_sale/app/utils/input_popups/text_input_popup','@point_of_sale/app/utils/input_popups/number_popup','@point_of_sale/app/utils/confirm_popup/confirm_popup','@point_of_sale/app/errors/popups/error_popup','@pos_restaurant/app/floor_screen/editable_table','@pos_restaurant/app/floor_screen/edit_bar','@pos_restaurant/app/floor_screen/table','@point_of_sale/app/store/pos_hook','@web/core/utils/hooks','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{sprintf}=require("@web/core/utils/strings");const{ConnectionLostError}=require("@web/core/network/rpc_service");const{debounce}=require("@web/core/utils/timing");const{registry}=require("@web/core/registry");const{TextInputPopup}=require("@point_of_sale/app/utils/input_popups/text_input_popup");const{NumberPopup}=require("@point_of_sale/app/utils/input_popups/number_popup");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{EditableTable}=require("@pos_restaurant/app/floor_screen/editable_table");const{EditBar}=require("@pos_restaurant/app/floor_screen/edit_bar");const{Table}=require("@pos_restaurant/app/floor_screen/table");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{useService}=require("@web/core/utils/hooks");const{Component,onPatched,onMounted,onWillUnmount,useRef,useState,onWillStart,}=require("@odoo/owl");const FloorScreen=__exports.FloorScreen=class FloorScreen extends Component{static components={EditableTable,EditBar,Table};static template="pos_restaurant.FloorScreen";static props={isShown:Boolean,floor:{type:true,optional:true}};static storeOnOrder=false;setup(){this.pos=usePos();this.popup=useService("popup");this.orm=useService("orm");const floor=this.pos.currentFloor;this.state=useState({selectedFloorId:floor?floor.id:null,selectedTableIds:[],floorBackground:floor?floor.background_color:null,floorMapScrollTop:0,isColorPicker:false,});this.floorMapRef=useRef("floor-map-ref");this.addFloorRef=useRef("add-floor-ref");this.map=useRef("map");onPatched(this.onPatched);onMounted(this.onMounted);onWillUnmount(this.onWillUnmount);onWillStart(this.onWillStart);}
onPatched(){this.floorMapRef.el.style.background=this.state.floorBackground;if(!this.pos.isEditMode&&this.pos.floors.length>0){this.addFloorRef.el.style.display="none";}else{this.addFloorRef.el.style.display="initial";}
this.state.floorMapScrollTop=this.floorMapRef.el.getBoundingClientRect().top;}
async onWillStart(){this.pos.searchProductWord="";const table=this.pos.table;if(table){const orders=this.pos.get_order_list();const tableOrders=orders.filter((order)=>order.tableId===table.id&&!order.finalized);const qtyChange=tableOrders.reduce((acc,order)=>{const quantityChange=order.getOrderChanges();const quantitySkipped=order.getOrderChanges(true);acc.changed+=quantityChange.count;acc.skipped+=quantitySkipped.count;return acc;},{changed:0,skipped:0});table.changes_count=qtyChange.changed;table.skip_changes=qtyChange.skipped;}
await this.pos.unsetTable();}
onMounted(){this.pos.openCashControl();this.floorMapRef.el.style.background=this.state.floorBackground;if(!this.pos.isEditMode&&this.pos.floors.length>0){this.addFloorRef.el.style.display="none";}else{this.addFloorRef.el.style.display="initial";}
this.state.floorMapScrollTop=this.floorMapRef.el.getBoundingClientRect().top;}
onWillUnmount(){clearInterval(this.tableLongpolling);}
_computePinchHypo(ev,callbackFunction){const touches=ev.touches;if(touches.length===2){const deltaX=touches[0].pageX-touches[1].pageX;const deltaY=touches[0].pageY-touches[1].pageY;callbackFunction(Math.hypot(deltaX,deltaY));}}
_onPinchStart(ev){ev.currentTarget.style.setProperty("touch-action","none");this._computePinchHypo(ev,this.startPinch.bind(this));}
_onPinchEnd(ev){ev.currentTarget.style.removeProperty("touch-action");}
_onPinchMove(ev){debounce(this._computePinchHypo,10,true)(ev,this.movePinch.bind(this));}
_onDeselectTable(){this.state.selectedTableIds=[];}
async _createTableHelper(copyTable,duplicateFloor=false){const existingTable=this.activeFloor.tables;let newTable;if(copyTable){newTable=Object.assign({},copyTable);if(!duplicateFloor){newTable.position_h+=10;newTable.position_v+=10;}
delete newTable.id;newTable.order_count=0;}else{let posV=0;let posH=10;const referenceScreenWidth=1180;const spaceBetweenTable=15*(screen.width/referenceScreenWidth);const h_min=spaceBetweenTable;const h_max=screen.width;const v_max=screen.height;let potentialWidth=100*(h_max/referenceScreenWidth);if(potentialWidth>130){potentialWidth=130;}else if(potentialWidth<75){potentialWidth=75;}
const heightTable=potentialWidth;const widthTable=potentialWidth;const positionTable=[];existingTable.forEach((table)=>{positionTable.push([table.position_v,table.position_v+table.height,table.position_h,table.position_h+table.width,]);});positionTable.sort((tableA,tableB)=>{if(tableA[0]<tableB[0]){return-1;}else if(tableA[0]>tableB[0]){return 1;}else if(tableA[2]<tableB[2]){return-1;}else{return 1;}});let actualHeight=100;let impossible=true;while(actualHeight<=v_max-heightTable-spaceBetweenTable&&impossible){const tableIntervals=[[h_min,h_min,v_max],[h_max,h_max,v_max],];for(let i=0;i<positionTable.length;i++){if(positionTable[i][0]>=actualHeight+heightTable+spaceBetweenTable){continue;}else if(positionTable[i][1]+spaceBetweenTable<=actualHeight){continue;}else{tableIntervals.push([positionTable[i][2],positionTable[i][3],positionTable[i][1],]);}}
tableIntervals.sort((a,b)=>{if(a[0]<b[0]){return-1;}else if(a[0]>b[0]){return 1;}else if(a[1]<b[1]){return-1;}else{return 1;}});let nextHeight=v_max;for(let i=0;i<tableIntervals.length-1;i++){if(tableIntervals[i][2]<nextHeight){nextHeight=tableIntervals[i][2];}
if(tableIntervals[i+1][0]-tableIntervals[i][1]>widthTable+spaceBetweenTable){impossible=false;posV=actualHeight;posH=tableIntervals[i][1]+spaceBetweenTable;break;}}
actualHeight=nextHeight+spaceBetweenTable;}
if(impossible){posV=positionTable[0][0]+10;posH=positionTable[0][2]+10;}
newTable={position_v:posV,position_h:posH,width:widthTable,height:heightTable,shape:"square",seats:2,color:"rgb(53, 211, 116)",};}
if(!duplicateFloor){newTable.name=this._getNewTableName();}
newTable.floor_id=[this.activeFloor.id,""];newTable.floor=this.activeFloor;await this._save(newTable);this.activeTables.push(newTable);this.activeFloor.table_ids.push(newTable.id);return newTable;}
_getNewTableName(){let firstNum=1;const tablesNameNumber=this.activeTables.map((table)=>+table.name).sort(function(a,b){return a-b;});for(let i=0;i<tablesNameNumber.length;i++){if(tablesNameNumber[i]==firstNum){firstNum+=1;}else{break;}}
return firstNum.toString();}
async _save(table){const tableCopy={floor_id:table.floor.id,color:table.color,height:table.height,name:table.name,position_h:table.position_h,position_v:table.position_v,seats:table.seats,shape:table.shape,width:table.width,};if(table.id){await this.orm.write("restaurant.table",[table.id],tableCopy);}else{const tableId=await this.orm.create("restaurant.table",[tableCopy]);table.id=tableId[0];this.pos.tables_by_id[tableId]=table;}}
async _renameFloor(floorId,newName){await this.orm.call("restaurant.floor","rename_floor",[floorId,newName]);}
get activeFloor(){return this.state.selectedFloorId?this.pos.floors_by_id[this.state.selectedFloorId]:null;}
get activeTables(){return this.activeFloor?this.activeFloor.tables:null;}
get isFloorEmpty(){return this.activeTables?this.activeTables.length===0:true;}
get selectedTables(){const tables=[];this.state.selectedTableIds.forEach((id)=>{tables.push(this.pos.tables_by_id[id]);});return tables;}
get nbrFloors(){return this.pos.floors.length;}
movePinch(hypot){const delta=hypot/this.scalehypot;const value=this.initalScale*delta;this.setScale(value);}
startPinch(hypot){this.scalehypot=hypot;this.initalScale=this.getScale();}
getScale(){const scale=this.map.el.style.getPropertyValue("--scale");const parsedScaleValue=parseFloat(scale);return isNaN(parsedScaleValue)?1:parsedScaleValue;}
setScale(value){if(value>0){this.map.el.style.setProperty("--scale",value);}}
selectFloor(floor){this.pos.currentFloor=floor;this.state.selectedFloorId=floor.id;this.state.floorBackground=this.activeFloor.background_color;this.state.selectedTableIds=[];}
toggleEditMode(){this.pos.toggleEditMode();if(!this.pos.isEditMode&&this.pos.floors.length>0){this.addFloorRef.el.style.display="none";}else{this.addFloorRef.el.style.display="initial";}
this.state.selectedTableIds=[];}
async onSelectTable(table,ev){if(this.pos.isEditMode){if(ev.ctrlKey||ev.metaKey){this.state.selectedTableIds.push(table.id);}else{this.state.selectedTableIds=[];this.state.selectedTableIds.push(table.id);}}else{if(this.pos.orderToTransfer&&table.order_count>0){const{confirmed}=await this.popup.add(ConfirmPopup,{title:_t("Table is not empty"),body:_t("The table already contains an order. Do you want to proceed and transfer the order here?"),confirmText:_t("Yes"),});if(!confirmed){table=this.pos.tables_by_id[this.pos.orderToTransfer.tableId];this.pos.orderToTransfer=null;}}
if(this.pos.orderToTransfer){await this.pos.transferTable(table);}else{try{await this.pos.setTable(table);}catch(e){if(!(e instanceof ConnectionLostError)){throw e;}
Promise.reject(e);}}
const order=this.pos.get_order();this.pos.showScreen(order.get_screen_data().name);}}
async onSaveTable(table){if(this.pos.tables_by_id[table.id]&&this.pos.tables_by_id[table.id].active){await this._save(table);}}
async addFloor(){const{confirmed,payload:newName}=await this.popup.add(TextInputPopup,{title:_t("New Floor"),placeholder:_t("Floor name"),});if(!confirmed){return;}
const floor=await this.orm.call("restaurant.floor","create_from_ui",[newName,"#ACADAD",this.pos.config.id,]);this.pos.floors_by_id[floor.id]=floor;this.pos.floors.push(floor);this.selectFloor(floor);this.pos.isEditMode=true;}
async createTable(){const newTable=await this._createTableHelper();newTable.skip_changes=0;newTable.changes_count=0;newTable.order_count=0;if(newTable){this.state.selectedTableIds=[];this.state.selectedTableIds.push(newTable.id);}}
async duplicateTableOrFloor(){if(this.selectedTables.length==0){const floor=this.activeFloor;const tables=this.activeFloor.tables;const newFloorName=floor.name+" (copy)";const newFloor=await this.orm.call("restaurant.floor","create_from_ui",[newFloorName,floor.background_color,this.pos.config.id,]);this.pos.floors_by_id[newFloor.id]=newFloor;this.pos.floors.push(newFloor);this.selectFloor(newFloor);for(const table of tables){await this._createTableHelper(table,true);}
return;}
const selectedTables=this.selectedTables;this._onDeselectTable();for(const table of selectedTables){const newTable=await this._createTableHelper(table);if(newTable){this.state.selectedTableIds.push(newTable.id);}}}
async renameTable(){const selectedTables=this.selectedTables;const selectedFloor=this.activeFloor;if(selectedTables.length>1){return;}
if(selectedTables.length==0){const{confirmed,payload:newName}=await this.popup.add(TextInputPopup,{startingValue:selectedFloor.name,title:_t("Floor Name ?"),});if(!confirmed){return;}
if(newName!==selectedFloor.name){selectedFloor.name=newName;await this._renameFloor(selectedFloor.id,newName);}
return;}
const selectedTable=selectedTables[0];const{confirmed,payload:newName}=await this.popup.add(TextInputPopup,{startingValue:selectedTable.name,title:_t("Table Name?"),});if(!confirmed){return;}
if(newName!==selectedTable.name){selectedTable.name=newName;await this._save(selectedTable);}}
async changeSeatsNum(){const selectedTables=this.selectedTables;if(selectedTables.length==0){return;}
const{confirmed,payload:inputNumber}=await this.popup.add(NumberPopup,{startingValue:0,cheap:true,title:_t("Number of Seats?"),isInputSelected:true,});if(!confirmed){return;}
const newSeatsNum=parseInt(inputNumber,10);selectedTables.forEach(async(selectedTable)=>{if(newSeatsNum!==selectedTable.seats){selectedTable.seats=newSeatsNum;await this._save(selectedTable);}});}
async changeToCircle(){await this.changeShape("round");}
async changeToSquare(){await this.changeShape("square");}
async changeShape(form){if(this.selectedTables.length==0){return;}
this.selectedTables.forEach(async(selectedTable)=>{selectedTable.shape=form;await this._save(selectedTable);});}
async setTableColor(color){const selectedTables=this.selectedTables;selectedTables.forEach(async(selectedTable)=>{selectedTable.color=color;await this._save(selectedTable);});this.state.isColorPicker=false;}
async setFloorColor(color){this.state.floorBackground=color;this.activeFloor.background_color=color;await this.orm.write("restaurant.floor",[this.activeFloor.id],{background_color:color,});this.state.isColorPicker=false;}
toggleColorPicker(){this.state.isColorPicker=!this.state.isColorPicker;}
async deleteFloorOrTable(){if(this.selectedTables.length==0){const{confirmed}=await this.popup.add(ConfirmPopup,{title:`Removing floor ${this.activeFloor.name}`,body:sprintf(_t("Removing a floor cannot be undone. Do you still want to remove %s?"),this.activeFloor.name),});if(!confirmed){return;}
const originalSelectedFloorId=this.activeFloor.id;await this.orm.call("restaurant.floor","deactivate_floor",[originalSelectedFloorId,this.pos.pos_session.id,]);const floor=this.pos.floors_by_id[originalSelectedFloorId];const orderList=[...this.pos.get_order_list()];for(const order of orderList){if(floor.table_ids.includes(order.tableId)){this.pos.removeOrder(order,false);}}
floor.table_ids.forEach((tableId)=>{delete this.pos.tables_by_id[tableId];});delete this.pos.floors_by_id[originalSelectedFloorId];this.pos.floors=this.pos.floors.filter((floor)=>floor.id!=originalSelectedFloorId);this.pos.TICKET_SCREEN_STATE.syncedOrders.cache={};if(this.pos.floors.length>0){this.selectFloor(this.pos.floors[0]);}else{this.pos.isEditMode=false;this.pos.floorPlanStyle="default";this.state.floorBackground=null;}
return;}
const{confirmed}=await this.popup.add(ConfirmPopup,{title:_t("Are you sure?"),body:_t("Removing a table cannot be undone"),});if(!confirmed){return;}
const originalSelectedTableIds=[...this.state.selectedTableIds];const response=await this.orm.call("restaurant.table","are_orders_still_in_draft",[originalSelectedTableIds,]);if(!response){for(const id of originalSelectedTableIds){for(const order of this.pos.get_order_list()){if(order.tableId==id){this.pos.removeOrder(order,false);}}
this.pos.tables_by_id[id].active=false;this.orm.write("restaurant.table",[id],{active:false});this.activeFloor.tables=this.activeTables.filter((table)=>table.id!==id);delete this.pos.tables_by_id[id];}}else{await this.popup.add(ErrorPopup,{title:_t("Delete Error"),body:_t("You cannot delete a table with orders still in draft for this table."),});}
const equalsCheck=(a,b)=>{return JSON.stringify(a)===JSON.stringify(b);};if(equalsCheck(this.state.selectedTableIds,originalSelectedTableIds)){this.state.selectedTableIds=[];}
this.pos.TICKET_SCREEN_STATE.syncedOrders.cache={};}}
registry.category("pos_screens").add("FloorScreen",FloorScreen);return __exports;});;

/* /pos_restaurant/static/src/app/floor_screen/table.js */
odoo.define('@pos_restaurant/app/floor_screen/table',['@odoo/owl','@point_of_sale/app/store/pos_hook'],function(require){'use strict';let __exports={};const{Component,useState}=require("@odoo/owl");const{usePos}=require("@point_of_sale/app/store/pos_hook");const Table=__exports.Table=class Table extends Component{static template="pos_restaurant.Table";static props={onClick:Function,table:{type:Object,shape:{position_h:Number,position_v:Number,width:Number,height:Number,shape:String,color:[String,{value:false}],name:String,seats:Number,"*":true,},},};setup(){this.pos=usePos();this.state=useState({containerHeight:0,containerWidth:0,});}
get fontSize(){const size=this.state.containerHeight/3;return size>20?20:size;}
get badgeStyle(){if(this.props.table.shape!=="round"){return`top: -6px; right: -6px;`;}
const tableHeight=this.state.containerHeight;const tableWidth=this.state.containerWidth;const radius=Math.min(tableWidth,tableHeight)/2;let left=0;let bottom=0;if(tableHeight>tableWidth){left=radius;bottom=radius+(tableHeight-tableWidth);}else{bottom=radius;left=radius+(tableWidth-tableHeight);}
bottom+=0.7*radius-8;left+=0.7*radius-8;return`bottom: ${bottom}px; left: ${left}px;`;}
computePosition(index,nbrHorizontal,widthTable){const position_h=widthTable*(index%nbrHorizontal)+5+(index%nbrHorizontal)*10;const position_v=widthTable*Math.floor(index/nbrHorizontal)+
10+
Math.floor(index/nbrHorizontal)*10;return{position_h,position_v};}
get style(){const table=this.props.table;let style="";let background=table.color?table.color:"rgb(53, 211, 116)";let textColor="white";if(!this.isOccupied()){background="#00000020";const rgb=table.floor.background_color.substring(4,table.floor.background_color.length-1).replace(/ /g,"").split(",");textColor=(0.299*rgb[0]+0.587*rgb[1]+0.114*rgb[2])/255>0.5?"black":"white";}
style+=`
            border: 3px solid ${table.color};
            border-radius: ${table.shape === "round" ? 1000 : 3}px;
            background: ${background};
            box-shadow: 0px 3px rgba(0,0,0,0.07);
            padding: ${table.shape === "round" ? "4px 10px" : "4px 8px"};
            color: ${textColor};`;if(this.pos.floorPlanStyle=="kanban"){const floor=table.floor;const index=floor.tables.indexOf(table);const minWidth=120;const nbrHorizontal=Math.floor(window.innerWidth/minWidth);const widthTable=(window.innerWidth-nbrHorizontal*10)/nbrHorizontal;const{position_h,position_v}=this.computePosition(index,nbrHorizontal,widthTable);this.state.containerHeight=widthTable;this.state.containerWidth=widthTable;style+=`
                width: ${widthTable}px;
                height: ${widthTable}px;
                top: ${position_v}px;
                left: ${position_h}px;
            `;}else{this.state.containerHeight=table.height;this.state.containerWidth=table.width;style+=`
                width: ${table.width}px;
                height: ${table.height}px;
                top: ${table.position_v}px;
                left: ${table.position_h}px;
            `;}
style+=`
            font-size: ${this.fontSize}px;
            line-height: ${this.fontSize}px;`;return style;}
get fill(){const customerCount=this.pos.getCustomerCount(this.props.table.id);return Math.min(1,Math.max(0,customerCount/this.props.table.seats));}
get orderCount(){const table=this.props.table;const unsynced_orders=this.pos.getTableOrders(table.id).filter((o)=>o.server_id===undefined&&(o.orderlines.length!==0||o.paymentlines.length!==0)&&!o.finalized);let result;if(table.changes_count>0){result=table.changes_count;}else if(table.skip_changes>0){result=table.skip_changes;}else{result=table.order_count+unsynced_orders.length;}
return!Number.isNaN(result)?result:0;}
get orderCountClass(){const notifications=this._getNotifications();const countClass={"order-count":true,"notify-printing text-bg-danger":notifications.printing,"notify-skipped text-bg-info":notifications.skipped,"text-bg-dark":!notifications.printing&&!notifications.skipped,};return countClass;}
get customerCountDisplay(){const customerCount=this.pos.getCustomerCount(this.props.table.id);if(customerCount==0){return`${this.props.table.seats}`;}else{return`${customerCount}/${this.props.table.seats}`;}}
_getNotifications(){const table=this.props.table;const hasChangesCount=table.changes_count;const hasSkippedCount=table.skip_changes;return hasChangesCount?{printing:true}:hasSkippedCount?{skipped:true}:{};}
isOccupied(){return(this.pos.getCustomerCount(this.props.table.id)>0||this.props.table.order_count>0);}}
return __exports;});;

/* /pos_restaurant/static/src/app/product_screen/product_screen.js */
odoo.define('@pos_restaurant/app/product_screen/product_screen',['@web/core/utils/patch','@point_of_sale/app/screens/product_screen/product_screen'],function(require){'use strict';let __exports={};const{patch}=require("@web/core/utils/patch");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");patch(ProductScreen.prototype,{bookTable(){this.pos.get_order().setBooked(true);},showBookButton(){return(this.pos.config.module_pos_restaurant&&this.pos.table&&!this.pos.orders.some((o)=>o.tableId===this.pos.table.id&&o.finalized===false&&o.isBooked));},});return __exports;});;

/* /pos_restaurant/static/src/app/split_bill_screen/split_bill_screen.js */
odoo.define('@pos_restaurant/app/split_bill_screen/split_bill_screen',['@point_of_sale/app/store/models','@web/core/registry','@point_of_sale/app/store/pos_hook','@odoo/owl','@point_of_sale/app/generic_components/orderline/orderline','@point_of_sale/app/generic_components/order_widget/order_widget','@web/core/utils/arrays'],function(require){'use strict';let __exports={};const{Order}=require("@point_of_sale/app/store/models");const{registry}=require("@web/core/registry");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{Component,useState}=require("@odoo/owl");const{Orderline}=require("@point_of_sale/app/generic_components/orderline/orderline");const{OrderWidget}=require("@point_of_sale/app/generic_components/order_widget/order_widget");const{groupBy}=require("@web/core/utils/arrays");const SplitBillScreen=__exports.SplitBillScreen=class SplitBillScreen extends Component{static template="pos_restaurant.SplitBillScreen";static components={Orderline,OrderWidget};setup(){this.pos=usePos();this.splitlines=useState(this._initSplitLines(this.pos.get_order()));this.newOrderLines={};this.newOrder=undefined;this._isFinal=false;this.newOrder=new Order({env:this.env},{pos:this.pos,temporary:true,});}
get currentOrder(){return this.pos.get_order();}
get orderlines(){return this.currentOrder.get_orderlines();}
onClickLine(line){for(const l of line.getAllLinesInCombo()){this._splitQuantity(l);this._updateNewOrder(l);}}
getLineData(line){const splitQty=this.splitlines[line.id].quantity;if(!splitQty){return line.getDisplayData();}
return{...line.getDisplayData(),qty:`${splitQty} / ${line.get_quantity_str()}`};}
back(){this.pos.showScreen("ProductScreen");}
proceed(){if(Object.keys(this.splitlines||{})?.length===0){return;}
this._isFinal=true;delete this.newOrder.temporary;if(!this._isFullPayOrder()){this._setQuantityOnCurrentOrder();this.newOrder.set_screen_data({name:"PaymentScreen"});if(this.pos.orderPreparationCategories.size){this.currentOrder.updateLastOrderChange();this.newOrder.updateLastOrderChange();}
this.newOrder.setCustomerCount(1);this.newOrder.originalSplittedOrder=this.currentOrder;const newCustomerCount=this.currentOrder.getCustomerCount()-1;this.currentOrder.setCustomerCount(newCustomerCount||1);this.currentOrder.set_screen_data({name:"ProductScreen"});const reactiveNewOrder=this.pos.makeOrderReactive(this.newOrder);this.pos.orders.add(reactiveNewOrder);this.pos.selectedOrder=reactiveNewOrder;}
this.pos.showScreen("PaymentScreen");}
_initSplitLines(order){const splitlines={};for(const line of order.get_orderlines()){splitlines[line.id]={product:line.get_product().id,quantity:0};}
return splitlines;}
_splitQuantity(line){const split=this.splitlines[line.id];let totalQuantity=0;this.pos.get_order().get_orderlines().forEach(function(orderLine){if(orderLine.get_product().id===split.product){totalQuantity+=orderLine.get_quantity();}});if(line.get_quantity()>0){if(!line.is_pos_groupable()){if(split.quantity!==line.get_quantity()){split.quantity=line.get_quantity();}else{split.quantity=0;}}else{if(split.quantity<totalQuantity){split.quantity+=1;if(split.quantity>line.get_quantity()){split.quantity=line.get_quantity();}}else{split.quantity=0;}}}}
_updateNewOrder(line){const split=this.splitlines[line.id];let orderline=this.newOrderLines[line.id];if(split.quantity){if(!orderline){orderline=line.clone();this.newOrder.add_orderline(orderline);this.newOrderLines[line.id]=orderline;}
orderline.set_quantity(split.quantity,"do not recompute unit price");}else if(orderline){this.newOrder.removeOrderline(orderline);this.newOrderLines[line.id]=null;}}
_isFullPayOrder(){const order=this.pos.get_order();let full=true;const splitlines=this.splitlines;const groupedLines=groupBy(order.get_orderlines(),(line)=>line.get_product().id);Object.keys(groupedLines).forEach(function(lineId){var maxQuantity=groupedLines[lineId].reduce((quantity,line)=>quantity+line.get_quantity(),0);Object.keys(splitlines).forEach((id)=>{const split=splitlines[id];if(split.product===groupedLines[lineId][0].get_product().id){maxQuantity-=split.quantity;}});if(maxQuantity!==0){full=false;}});return full;}
_setQuantityOnCurrentOrder(){const order=this.pos.get_order();for(var id in this.splitlines){var split=this.splitlines[id];var line=this.currentOrder.get_orderline(parseInt(id));if(!this.pos.disallowLineQuantityChange()){line.set_quantity(line.get_quantity()-split.quantity,"do not recompute unit price");}else{if(split.quantity){const decreaseLine=line.clone();decreaseLine.order=order;decreaseLine.noDecrease=true;decreaseLine.set_quantity(-split.quantity);order.add_orderline(decreaseLine);}}}
if(!this.pos.disallowLineQuantityChange()){for(id in this.splitlines){line=this.currentOrder.get_orderline(parseInt(id));if(line&&Math.abs(line.get_quantity())<0.00001){this.currentOrder.removeOrderline(line);}}}}}
registry.category("pos_screens").add("SplitBillScreen",SplitBillScreen);return __exports;});;

/* /pos_restaurant/static/src/app/tip_receipt/tip_receipt.js */
odoo.define('@pos_restaurant/app/tip_receipt/tip_receipt',['@odoo/owl','@point_of_sale/app/screens/receipt_screen/receipt/receipt_header/receipt_header'],function(require){'use strict';let __exports={};const{Component}=require("@odoo/owl");const{ReceiptHeader}=require("@point_of_sale/app/screens/receipt_screen/receipt/receipt_header/receipt_header");const TipReceipt=__exports.TipReceipt=class TipReceipt extends Component{static template="pos_restaurant.TipReceipt";static components={ReceiptHeader};static props=["headerData","data","total"];get total(){return this.props.total;}}
return __exports;});;

/* /pos_restaurant/static/src/app/tip_screen/tip_screen.js */
odoo.define('@pos_restaurant/app/tip_screen/tip_screen',['@web/core/l10n/translation','@web/views/fields/parsers','@web/core/registry','@point_of_sale/app/errors/popups/error_popup','@point_of_sale/app/utils/confirm_popup/confirm_popup','@point_of_sale/app/store/pos_hook','@web/core/utils/hooks','@odoo/owl','@pos_restaurant/app/tip_receipt/tip_receipt'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{parseFloat}=require("@web/views/fields/parsers");const{registry}=require("@web/core/registry");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{useService}=require("@web/core/utils/hooks");const{Component,useRef,onMounted}=require("@odoo/owl");const{TipReceipt}=require("@pos_restaurant/app/tip_receipt/tip_receipt");const TipScreen=__exports.TipScreen=class TipScreen extends Component{static template="pos_restaurant.TipScreen";setup(){this.pos=usePos();this.posReceiptContainer=useRef("pos-receipt-container");this.popup=useService("popup");this.orm=useService("orm");this.printer=useService("printer");this.state=this.currentOrder.uiState.TipScreen;this._totalAmount=this.currentOrder.get_total_with_tax();onMounted(async()=>{await this.printTipReceipt();});}
get overallAmountStr(){const tipAmount=this.env.utils.isValidFloat(this.state.inputTipAmount)?parseFloat(this.state.inputTipAmount):0;const original=this.env.utils.formatCurrency(this.totalAmount);const tip=this.env.utils.formatCurrency(tipAmount);const overall=this.env.utils.formatCurrency(this.totalAmount+tipAmount);return`${original} + ${tip} tip = ${overall}`;}
get totalAmount(){return this._totalAmount;}
get currentOrder(){return this.pos.get_order();}
get percentageTips(){return[{percentage:"15%",amount:0.15*this.totalAmount},{percentage:"20%",amount:0.2*this.totalAmount},{percentage:"25%",amount:0.25*this.totalAmount},];}
async validateTip(){const amount=this.env.utils.isValidFloat(this.state.inputTipAmount)?parseFloat(this.state.inputTipAmount):0;const order=this.pos.get_order();const serverId=this.pos.validated_orders_name_server_id_map[order.name];if(!serverId){this.popup.add(ErrorPopup,{title:_t("Unsynced order"),body:_t("This order is not yet synced to server. Make sure it is synced then try again."),});return;}
if(!amount){await this.orm.call("pos.order","set_no_tip",[serverId]);this.goNextScreen();return;}
if(amount>0.25*this.totalAmount){const{confirmed}=await this.popup.add(ConfirmPopup,{title:"Are you sure?",body:`${this.env.utils.formatCurrency(
                    amount
                )} is more than 25% of the order's total amount. Are you sure of this tip amount?`,});if(!confirmed){return;}}
order.finalized=false;order.set_tip(amount);order.finalized=true;const paymentline=this.pos.get_order().get_paymentlines()[0];if(paymentline.payment_method.payment_terminal){paymentline.amount+=amount;await paymentline.payment_method.payment_terminal.send_payment_adjust(paymentline.cid);}
const tip_line=order.selected_orderline;await this.orm.call("pos.order","set_tip",[serverId,tip_line.export_as_JSON()]);this.goNextScreen();}
goNextScreen(){this.pos.removeOrder(this.currentOrder);if(!this.pos.config.module_pos_restaurant){this.pos.add_new_order();}
const{name,props}=this.nextScreen;this.pos.showScreen(name,props);}
get nextScreen(){return{name:"ReceiptScreen"};}
async printTipReceipt(){const order=this.currentOrder;const receipts=[order.selected_paymentline.ticket,order.selected_paymentline.cashier_receipt,];for(let i=0;i<receipts.length;i++){await this.printer.print(TipReceipt,{headerData:this.pos.getReceiptHeaderData(order),data:receipts[i],total:this.env.utils.formatCurrency(this.totalAmount),},{webPrintFallback:false});}}}
registry.category("pos_screens").add("TipScreen",TipScreen);return __exports;});;

/* /pos_restaurant/static/src/overrides/components/navbar/back_button/back_button.js */
odoo.define('@pos_restaurant/overrides/components/navbar/back_button/back_button',['@point_of_sale/app/navbar/back_button/back_button','@point_of_sale/app/screens/product_screen/product_screen','@pos_restaurant/app/tip_screen/tip_screen','@web/core/utils/patch'],function(require){'use strict';let __exports={};const{BackButton}=require("@point_of_sale/app/navbar/back_button/back_button");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{TipScreen}=require("@pos_restaurant/app/tip_screen/tip_screen");const{patch}=require("@web/core/utils/patch");patch(BackButton.prototype,{get floor(){return this.table?.floor;},get hasTable(){return this.table!=null;},async onClick(){if(this.pos.mainScreen.component&&this.pos.config.module_pos_restaurant){if((this.pos.mainScreen.component===ProductScreen&&this.pos.mobile_pane=="right")||this.pos.mainScreen.component===TipScreen){this.pos.showScreen("FloorScreen",{floor:this.floor});}else{super.onClick(...arguments);}
return;}
super.onClick(...arguments);},});return __exports;});;

/* /pos_restaurant/static/src/overrides/components/navbar/navbar.js */
odoo.define('@pos_restaurant/overrides/components/navbar/navbar',['@point_of_sale/app/navbar/navbar','@web/core/utils/patch'],function(require){'use strict';let __exports={};const{Navbar}=require("@point_of_sale/app/navbar/navbar");const{patch}=require("@web/core/utils/patch");patch(Navbar.prototype,{get orderCount(){if(this.pos.config.module_pos_restaurant&&this.pos.table){return this.pos.getTableOrders(this.pos.table.id).length;}
return super.orderCount;},_shouldLoadOrders(){return super._shouldLoadOrders()||this.pos.config.module_pos_restaurant;},onSwitchButtonClick(){const mode=this.pos.floorPlanStyle=="kanban"?"default":"kanban";localStorage.setItem("floorPlanStyle",mode);this.pos.floorPlanStyle=mode;},toggleEditMode(){this.pos.toggleEditMode();},showBackButton(){return(super.showBackButton(...arguments)||(this.pos.showBackButton()&&this.pos.config.module_pos_restaurant));},});return __exports;});;

/* /pos_restaurant/static/src/overrides/components/order_widget/order_widget.js */
odoo.define('@pos_restaurant/overrides/components/order_widget/order_widget',['@point_of_sale/app/generic_components/order_widget/order_widget','@web/core/utils/patch','@web/core/l10n/translation'],function(require){'use strict';let __exports={};const{OrderWidget}=require("@point_of_sale/app/generic_components/order_widget/order_widget");const{patch}=require("@web/core/utils/patch");const{_t}=require("@web/core/l10n/translation");patch(OrderWidget,{props:{...OrderWidget.props,isConfigRestaurant:{type:Boolean,optional:true},isOrderBooked:{type:Boolean,optional:true},},});patch(OrderWidget.prototype,{emptyCartText(){let text=super.emptyCartText(...arguments);if(this.props.isConfigRestaurant&&!this.props.isOrderBooked){text+=" "+_t("or book the table for later");}
return text;},});return __exports;});;

/* /pos_restaurant/static/src/overrides/components/payment_screen/payment_screen.js */
odoo.define('@pos_restaurant/overrides/components/payment_screen/payment_screen',['@point_of_sale/app/screens/payment_screen/payment_screen','@web/core/utils/patch'],function(require){'use strict';let __exports={};const{PaymentScreen}=require("@point_of_sale/app/screens/payment_screen/payment_screen");const{patch}=require("@web/core/utils/patch");patch(PaymentScreen.prototype,{get nextScreen(){const order=this.currentOrder;if(!this.pos.config.set_tip_after_payment||order.is_tipped){return super.nextScreen;}
const mainPayment=order.get_paymentlines()[0];if(mainPayment&&mainPayment.canBeAdjusted()){return"TipScreen";}
return super.nextScreen;},});return __exports;});;

/* /pos_restaurant/static/src/overrides/components/product_screen/actionpad_widget/actionpad_widget.js */
odoo.define('@pos_restaurant/overrides/components/product_screen/actionpad_widget/actionpad_widget',['@web/core/utils/patch','@point_of_sale/app/screens/product_screen/action_pad/action_pad'],function(require){'use strict';let __exports={};const{patch}=require("@web/core/utils/patch");const{ActionpadWidget}=require("@point_of_sale/app/screens/product_screen/action_pad/action_pad");patch(ActionpadWidget.prototype,{get swapButton(){return this.props.actionType==="payment"&&this.pos.config.module_pos_restaurant;},get currentOrder(){return this.pos.get_order();},get swapButtonClasses(){return{"highlight btn-primary":this.currentOrder?.hasChangesToPrint(),altlight:!this.currentOrder?.hasChangesToPrint()&&this.currentOrder?.hasSkippedChanges(),};},async submitOrder(){if(!this.clicked){this.clicked=true;try{await this.pos.sendOrderInPreparationUpdateLastChange(this.currentOrder);}finally{this.clicked=false;}}},hasQuantity(order){if(!order){return false;}else{return(order.orderlines.reduce((totalQty,line)=>totalQty+line.get_quantity(),0)>0);}},get highlightPay(){return(super.highlightPay&&!this.currentOrder.hasChangesToPrint()&&this.hasQuantity(this.currentOrder));},get categoryCount(){const orderChange=this.currentOrder.getOrderChanges().orderlines;const categories=Object.values(orderChange).reduce((acc,curr)=>{const categoryId=this.pos.db.product_by_id[curr.product_id].pos_categ_ids[0];const category=this.pos.db.category_by_id[categoryId];if(category){if(!acc[category.id]){acc[category.id]={count:curr.quantity,name:category.name,id:category.id,};}else{acc[category.id].count+=curr.quantity;}}
return acc;},{});return Object.values(categories);},get displayCategoryCount(){return this.categoryCount.slice(0,3);},get isCategoryCountOverflow(){if(this.categoryCount.length>3){return true;}
return false;},});return __exports;});;

/* /pos_restaurant/static/src/overrides/components/product_screen/product_screen.js */
odoo.define('@pos_restaurant/overrides/components/product_screen/product_screen',['@point_of_sale/app/screens/product_screen/product_screen','@web/core/utils/patch'],function(require){'use strict';let __exports={};const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{patch}=require("@web/core/utils/patch");patch(ProductScreen.prototype,{get selectedOrderlineQuantity(){const order=this.pos.get_order();const orderline=order.get_selected_orderline();if(this.pos.config.module_pos_restaurant&&this.pos.orderPreparationCategories.size){let orderline_name=orderline.product.display_name;if(orderline.description){orderline_name+=" ("+orderline.description+")";}
const changes=Object.values(order.getOrderChanges().orderlines).find((change)=>change.name==orderline_name);return changes?changes.quantity:false;}
return super.selectedOrderlineQuantity;},get selectedOrderlineTotal(){return this.env.utils.formatCurrency(this.pos.get_order().get_selected_orderline().get_display_price());},get nbrOfChanges(){return this.currentOrder.getOrderChanges().nbrOfChanges;},get swapButton(){return this.pos.config.module_pos_restaurant&&this.pos.orderPreparationCategories.size;},submitOrder(){this.pos.sendOrderInPreparationUpdateLastChange(this.pos.get_order());},get primaryReviewButton(){return(!this.primaryOrderButton&&!this.pos.get_order().is_empty()&&this.pos.config.module_pos_restaurant);},get primaryOrderButton(){return(this.pos.get_order().getOrderChanges().nbrOfChanges!==0&&this.pos.config.module_pos_restaurant);},});return __exports;});;

/* /pos_restaurant/static/src/overrides/components/receipt_screen/receipt_screen.js */
odoo.define('@pos_restaurant/overrides/components/receipt_screen/receipt_screen',['@point_of_sale/app/screens/receipt_screen/receipt_screen','@web/core/utils/patch','@odoo/owl','@pos_restaurant/app/floor_screen/floor_screen'],function(require){'use strict';let __exports={};const{ReceiptScreen}=require("@point_of_sale/app/screens/receipt_screen/receipt_screen");const{patch}=require("@web/core/utils/patch");const{onWillUnmount}=require("@odoo/owl");const{FloorScreen}=require("@pos_restaurant/app/floor_screen/floor_screen");patch(ReceiptScreen.prototype,{setup(){super.setup(...arguments);onWillUnmount(()=>{if(this.pos.mainScreen.component===FloorScreen&&this.currentOrder.finalized){this.pos.removeOrder(this.currentOrder);}});},_addNewOrder(){if(!this.pos.config.module_pos_restaurant){super._addNewOrder(...arguments);}},isResumeVisible(){if(this.pos.config.module_pos_restaurant&&this.pos.table){return this.pos.getTableOrders(this.pos.table.id).length>1;}
return super.isResumeVisible(...arguments);},get nextScreen(){if(this.pos.config.module_pos_restaurant){const table=this.pos.table;return{name:"FloorScreen",props:{floor:table?table.floor:null}};}else{return super.nextScreen;}},});return __exports;});;

/* /pos_restaurant/static/src/overrides/components/ticket_screen/ticket_screen.js */
odoo.define('@pos_restaurant/overrides/components/ticket_screen/ticket_screen',['@web/core/l10n/translation','@point_of_sale/app/screens/ticket_screen/ticket_screen','@web/core/utils/hooks','@web/core/utils/patch','@web/views/fields/parsers','@point_of_sale/app/utils/confirm_popup/confirm_popup','@odoo/owl'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{TicketScreen}=require("@point_of_sale/app/screens/ticket_screen/ticket_screen");const{useAutofocus}=require("@web/core/utils/hooks");const{patch}=require("@web/core/utils/patch");const{parseFloat}=require("@web/views/fields/parsers");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{Component,useState}=require("@odoo/owl");patch(TicketScreen.prototype,{_getScreenToStatusMap(){return Object.assign(super._getScreenToStatusMap(...arguments),{PaymentScreen:this.pos.config.set_tip_after_payment?"OPEN":super._getScreenToStatusMap(...arguments).PaymentScreen,TipScreen:"TIPPING",});},getTable(order){const table=order.getTable();if(table){let floorAndTable="";if(this.pos.floors&&this.pos.floors.length>1){floorAndTable=`${table.floor.name}/`;}
floorAndTable+=table.name;return floorAndTable;}},_getSearchFields(){if(!this.pos.config.module_pos_restaurant){return super._getSearchFields(...arguments);}
return Object.assign({},super._getSearchFields(...arguments),{TABLE:{repr:this.getTable.bind(this),displayName:_t("Table"),modelField:"table_id.name",},});},async _setOrder(order){if(!this.pos.config.module_pos_restaurant||this.pos.table||!order.tableId){return super._setOrder(...arguments);}
const orderTable=order.getTable();await this.pos.setTable(orderTable,order.uid);this.closeTicketScreen();},async onDeleteOrder(order){const confirmed=await super.onDeleteOrder(...arguments);if(confirmed&&this.pos.config.module_pos_restaurant&&this.pos.table&&!this.pos.orders.some((order)=>order.tableId===this.pos.table.id)){return this.pos.showScreen("FloorScreen");}},get allowNewOrders(){return this.pos.config.module_pos_restaurant?Boolean(this.pos.table):super.allowNewOrders;},async settleTips(){for(const order of this.getFilteredOrderList()){const tipAmount=this.env.utils.isValidFloat(order.uiState.TipScreen.inputTipAmount)?parseFloat(order.uiState.TipScreen.inputTipAmount):0;const serverId=this.pos.validated_orders_name_server_id_map[order.name];if(!serverId){console.warn(`${order.name} is not yet sync. Sync it to server before setting a tip.`);}else{const result=await this.setTip(order,serverId,tipAmount);if(!result){break;}}}},async setTip(order,serverId,amount){try{const paymentline=order.get_paymentlines()[0];if(paymentline.payment_method.payment_terminal){paymentline.amount+=amount;this.pos.set_order(order,{silent:true});await paymentline.payment_method.payment_terminal.send_payment_adjust(paymentline.cid);}
if(!amount){await this.setNoTip(serverId);}else{order.finalized=false;order.set_tip(amount);order.finalized=true;const tip_line=order.selected_orderline;await this.orm.call("pos.order","set_tip",[serverId,tip_line.export_as_JSON()]);}
if(order===this.pos.get_order()){this._selectNextOrder(order);}
this.pos.removeOrder(order);return true;}catch{const{confirmed}=await this.popup.add(ConfirmPopup,{title:"Failed to set tip",body:`Failed to set tip to ${order.name}. Do you want to proceed on setting the tips of the remaining?`,});return confirmed;}},async setNoTip(serverId){await this.orm.call("pos.order","set_no_tip",[serverId]);},_getOrderStates(){const result=super._getOrderStates(...arguments);if(this.pos.config.set_tip_after_payment){result.delete("PAYMENT");result.set("OPEN",{text:_t("Open"),indented:true});result.set("TIPPING",{text:_t("Tipping"),indented:true});}
return result;},async onDoRefund(){const order=this.getSelectedOrder();if(this.pos.config.module_pos_restaurant&&order&&!this.pos.table){this.pos.setTable(order.table?order.table:Object.values(this.pos.tables_by_id)[0]);}
super.onDoRefund(...arguments);},isDefaultOrderEmpty(order){if(this.pos.config.module_pos_restaurant){return false;}
return super.isDefaultOrderEmpty(...arguments);},});const TipCell=__exports.TipCell=class TipCell extends Component{static template="pos_restaurant.TipCell";setup(){this.state=useState({isEditing:false});this.orderUiState=this.props.order.uiState.TipScreen;useAutofocus();}
get tipAmountStr(){return this.env.utils.formatCurrency(this.env.utils.isValidFloat(this.orderUiState.inputTipAmount)?parseFloat(this.orderUiState.inputTipAmount):0);}
onBlur(){this.state.isEditing=false;}
onKeydown(event){if(event.key==="Enter"){this.state.isEditing=false;}}
editTip(){this.state.isEditing=true;}}
patch(TicketScreen,{components:{...TicketScreen.components,TipCell},});return __exports;});;

/* /pos_restaurant/static/src/overrides/models/models.js */
odoo.define('@pos_restaurant/overrides/models/models',['@point_of_sale/app/store/models','@web/core/utils/patch'],function(require){'use strict';let __exports={};const{Order,Orderline,Payment}=require("@point_of_sale/app/store/models");const{patch}=require("@web/core/utils/patch");patch(Order.prototype,{setup(_defaultObj,options){super.setup(...arguments);if(this.pos.config.module_pos_restaurant){if(this.defaultTableNeeded(options)){this.tableId=this.pos.table.id;}
this.booked=false;this.customerCount=this.customerCount||1;}},export_as_JSON(){const json=super.export_as_JSON(...arguments);if(this.pos.config.module_pos_restaurant){json.table_id=this.tableId;json.customer_count=this.customerCount;json.booked=this.booked;}
return json;},init_from_JSON(json){super.init_from_JSON(...arguments);if(this.pos.config.module_pos_restaurant){this.tableId=json.table_id;this.customerCount=json.customer_count;}},getCustomerCount(){return this.customerCount;},setCustomerCount(count){this.customerCount=Math.max(count,0);},getTable(){if(this.pos.config.module_pos_restaurant){return this.pos.tables_by_id[this.tableId];}
return null;},defaultTableNeeded(options){return!this.tableId&&!options.json&&this.pos.table;},export_for_printing(){return{...super.export_for_printing(...arguments),set_tip_after_payment:this.pos.config.set_tip_after_payment,isRestaurant:this.pos.config.module_pos_restaurant,};},setBooked(booked){this.booked=booked;if(booked){this.save_to_db();this.pos.ordersToUpdateSet.add(this);}},async add_product(product,options){const result=await super.add_product(...arguments);if(this.pos.config.module_pos_restaurant){this.setBooked(true);}
return result;},});patch(Orderline.prototype,{setup(){super.setup(...arguments);this.note=this.note||"";},clone(){const orderline=super.clone(...arguments);orderline.note=this.note;return orderline;},export_as_JSON(){const json=super.export_as_JSON(...arguments);json.note=this.note;if(this.pos.config.iface_printers){json.uuid=this.uuid;}
return json;},init_from_JSON(json){super.init_from_JSON(...arguments);this.note=json.note;if(this.pos.config.iface_printers){this.uuid=json.uuid;}},get_line_diff_hash(){if(this.getNote()){return this.id+"|"+this.getNote();}else{return""+this.id;}},toggleSkipChange(){if(this.hasChange||this.skipChange){this.skipChange=!this.skipChange;}},getDisplayClasses(){return{...super.getDisplayClasses(),"has-change text-success border-start border-success border-4":this.hasChange,"skip-change text-primary border-start border-primary border-4":this.skipChange,};},});patch(Payment.prototype,{canBeAdjusted(){if(this.payment_method.payment_terminal){return this.payment_method.payment_terminal.canBeAdjusted(this.cid);}
return!this.payment_method.is_cash_count;},});return __exports;});;

/* /pos_restaurant/static/src/overrides/models/payment.js */
odoo.define('@pos_restaurant/overrides/models/payment',['@point_of_sale/app/payment/payment_interface','@web/core/utils/patch'],function(require){'use strict';let __exports={};const{PaymentInterface}=require("@point_of_sale/app/payment/payment_interface");const{patch}=require("@web/core/utils/patch");patch(PaymentInterface.prototype,{canBeAdjusted(cid){return false;},send_payment_adjust(cid){},});return __exports;});;

/* /pos_restaurant/static/src/overrides/models/popup_service.js */
odoo.define('@pos_restaurant/overrides/models/popup_service',['@web/core/utils/patch','@point_of_sale/app/popup/popup_service'],function(require){'use strict';let __exports={};const{patch}=require("@web/core/utils/patch");const{popupService}=require("@point_of_sale/app/popup/popup_service");patch(popupService,{start(){return Object.assign(super.start(...arguments),{closePopupsButError(){const popups=Object.values(this.popups);const isErrorPopupOpen=popups.some((popup)=>popup.component.name.toLowerCase().includes("error"));if(!isErrorPopupOpen){for(const popup of popups){popup.props.close(false);}}
return!isErrorPopupOpen;},});},});return __exports;});;

/* /pos_restaurant/static/src/overrides/models/pos_bus.js */
odoo.define('@pos_restaurant/overrides/models/pos_bus',['@web/core/utils/patch','@point_of_sale/app/bus/pos_bus_service'],function(require){'use strict';let __exports={};const{patch}=require("@web/core/utils/patch");const{PosBus}=require("@point_of_sale/app/bus/pos_bus_service");patch(PosBus.prototype,{setup(){super.setup(...arguments);if(this.pos.config.module_pos_restaurant){this.initTableOrderCount();}},async initTableOrderCount(){const result=await this.orm.call("pos.config","get_tables_order_count_and_printing_changes",[this.pos.config.id]);this.ws_syncTableCount(result);},dispatch(message){super.dispatch(...arguments);if(message.type==="TABLE_ORDER_COUNT"&&this.pos.config.module_pos_restaurant){this.ws_syncTableCount(message.payload);}},async ws_syncTableCount(data){const missingTable=data.find((table)=>!(table.id in this.pos.tables_by_id));if(missingTable){const result=await this.orm.call("pos.session","get_pos_ui_restaurant_floor",[[odoo.pos_session_id],]);if(this.pos.config.module_pos_restaurant){this.pos.floors=result;this.pos.loadRestaurantFloor();}}
for(const floor of this.pos.floors){floor.changes_count=0;}
for(const table of data){const table_obj=this.pos.tables_by_id[table.id];if(table_obj){table_obj.order_count=table.orders;table_obj.changes_count=table.changes;table_obj.skip_changes=table.skip_changes;table_obj.floor.changes_count+=table.changes;}}},});return __exports;});;

/* /pos_restaurant/static/src/overrides/models/pos_store.js */
odoo.define('@pos_restaurant/overrides/models/pos_store',['@web/core/utils/patch','@point_of_sale/app/store/pos_store','@point_of_sale/app/screens/payment_screen/payment_screen','@point_of_sale/app/screens/product_screen/product_screen','@pos_restaurant/app/floor_screen/floor_screen','@pos_restaurant/app/tip_screen/tip_screen','@web/core/network/rpc_service'],function(require){'use strict';let __exports={};const{patch}=require("@web/core/utils/patch");const{PosStore}=require("@point_of_sale/app/store/pos_store");const{PaymentScreen}=require("@point_of_sale/app/screens/payment_screen/payment_screen");const{ProductScreen}=require("@point_of_sale/app/screens/product_screen/product_screen");const{FloorScreen}=require("@pos_restaurant/app/floor_screen/floor_screen");const{TipScreen}=require("@pos_restaurant/app/tip_screen/tip_screen");const{ConnectionLostError}=require("@web/core/network/rpc_service");const NON_IDLE_EVENTS=["mousemove","mousedown","touchstart","touchend","touchmove","click","scroll","keypress",];let IDLE_TIMER_SETTER;patch(PosStore.prototype,{async setup(){this.orderToTransfer=null;this.transferredOrdersSet=new Set();this.isEditMode=false;await super.setup(...arguments);this.floorPlanStyle=localStorage.getItem("floorPlanStyle")||(this.ui.isSmall?"kanban":"default");if(this.config.module_pos_restaurant){this.setActivityListeners();this.showScreen("FloorScreen",{floor:this.table?.floor||null});}
this.currentFloor=this.floors?.length>0?this.floors[0]:null;},setActivityListeners(){IDLE_TIMER_SETTER=this.setIdleTimer.bind(this);for(const event of NON_IDLE_EVENTS){window.addEventListener(event,IDLE_TIMER_SETTER);}},setIdleTimer(){clearTimeout(this.idleTimer);if(this.shouldResetIdleTimer()){this.idleTimer=setTimeout(()=>this.actionAfterIdle(),180000);}},async actionAfterIdle(){const isPopupClosed=this.popup.closePopupsButError();if(isPopupClosed){this.closeTempScreen();const table=this.table;const order=this.get_order();if(order&&order.get_screen_data().name==="ReceiptScreen"){this.removeOrder(order);}
this.showScreen("FloorScreen",{floor:table?.floor});}},getReceiptHeaderData(order){const json=super.getReceiptHeaderData(...arguments);if(this.config.module_pos_restaurant&&order){if(order.getTable()){json.table=order.getTable().name;}
json.customer_count=order.getCustomerCount();}
return json;},shouldResetIdleTimer(){const stayPaymentScreen=this.mainScreen.component===PaymentScreen&&this.get_order().paymentlines.length>0;return(this.config.module_pos_restaurant&&!stayPaymentScreen&&this.mainScreen.component!==FloorScreen);},showScreen(screenName){super.showScreen(...arguments);this.setIdleTimer();},closeScreen(){if(this.config.module_pos_restaurant&&!this.get_order()){return this.showScreen("FloorScreen");}
return super.closeScreen(...arguments);},addOrderIfEmpty(){if(!this.config.module_pos_restaurant){return super.addOrderIfEmpty(...arguments);}},async closePos(){if(IDLE_TIMER_SETTER){for(const event of NON_IDLE_EVENTS){window.removeEventListener(event,IDLE_TIMER_SETTER);}}
return super.closePos(...arguments);},showBackButton(){return(super.showBackButton(...arguments)||this.mainScreen.component===TipScreen||(this.mainScreen.component===ProductScreen&&this.config.module_pos_restaurant));},async _processData(loadedData){await super._processData(...arguments);if(this.config.module_pos_restaurant){this.floors=loadedData["restaurant.floor"];this.loadRestaurantFloor();}},async after_load_server_data(){var res=await super.after_load_server_data(...arguments);if(this.config.module_pos_restaurant){this.table=null;}
return res;},set_start_order(){if(!this.config.module_pos_restaurant){super.set_start_order(...arguments);}},add_new_order(){const order=super.add_new_order(...arguments);this.ordersToUpdateSet.add(order);return order;},async _getTableOrdersFromServer(tableIds){this.set_synch("connecting",1);try{const orders=await this.env.services.orm.silent.call("pos.order","export_for_ui_table_draft",[tableIds]);this.set_synch("connected");return orders;}catch(error){this.set_synch("error");throw error;}},async _syncTableOrdersToServer(){await this.sendDraftToServer();await this._removeOrdersFromServer();this.ordersToUpdateSet.clear();this.transferredOrdersSet.clear();},async _syncTableOrdersFromServer(tableId){await this._removeOrdersFromServer();const ordersJsons=await this._getTableOrdersFromServer([tableId]);await this._addPricelists(ordersJsons);await this._addFiscalPositions(ordersJsons);const tableOrders=this.getTableOrders(tableId);this._replaceOrders(tableOrders,ordersJsons);},async _getOrdersJson(){if(this.config.module_pos_restaurant){const tableIds=[].concat(...this.floors.map((floor)=>floor.tables.map((table)=>table.id)));await this._syncTableOrdersToServer();const ordersJsons=await this._getTableOrdersFromServer(tableIds);await this._loadMissingProducts(ordersJsons);await this._loadMissingPartners(ordersJsons);return ordersJsons;}else{return await super._getOrdersJson();}},_shouldRemoveOrder(order){return super._shouldRemoveOrder(...arguments)&&!this.transferredOrdersSet.has(order);},_shouldCreateOrder(json){return((!this._transferredOrder(json)||this._isSameTable(json))&&(!this.selectedOrder||super._shouldCreateOrder(...arguments)));},_shouldRemoveSelectedOrder(removeSelected){return this.selectedOrder&&super._shouldRemoveSelectedOrder(...arguments);},_isSelectedOrder(json){return!this.selectedOrder||super._isSelectedOrder(...arguments);},_isSameTable(json){const transferredOrder=this._transferredOrder(json);return transferredOrder&&transferredOrder.tableId===json.tableId;},_transferredOrder(json){return[...this.transferredOrdersSet].find((order)=>order.uid===json.uid);},_createOrder(json){const transferredOrder=this._transferredOrder(json);if(this._isSameTable(json)){this.removeOrder(transferredOrder,false);}
return super._createOrder(...arguments);},getDefaultSearchDetails(){if(this.table&&this.table.id){return{fieldName:"TABLE",searchTerm:this.table.name,};}
return super.getDefaultSearchDetails();},loadRestaurantFloor(){this.floors_by_id={};this.tables_by_id={};for(const floor of this.floors){this.floors_by_id[floor.id]=floor;for(const table of floor.tables){this.tables_by_id[table.id]=table;table.floor=floor;}}},async setTable(table,orderUid=null){this.table=table;try{this.loadingOrderState=true;await this._syncTableOrdersFromServer(table.id);}finally{this.loadingOrderState=false;const currentOrder=this.getTableOrders(table.id).find((order)=>orderUid?order.uid===orderUid:!order.finalized);if(currentOrder){this.set_order(currentOrder);}else{this.add_new_order();}}},getTableOrders(tableId){return this.get_order_list().filter((order)=>order.tableId===tableId);},async unsetTable(){try{await this._syncTableOrdersToServer();}catch(e){if(!(e instanceof ConnectionLostError)){throw e;}
Promise.reject(e);}
this.table=null;const order=this.get_order();if(order&&!order.isBooked){this.removeOrder(order);}
this.set_order(null);},setCurrentOrderToTransfer(){this.selectedOrder.setBooked(true);this.orderToTransfer=this.selectedOrder;},async transferTable(table){this.table=table;try{this.loadingOrderState=true;await this._syncTableOrdersFromServer(table.id);}finally{this.loadingOrderState=false;this.orderToTransfer.tableId=table.id;this.set_order(this.orderToTransfer);this.transferredOrdersSet.add(this.orderToTransfer);this.orderToTransfer=null;}},getCustomerCount(tableId){const tableOrders=this.getTableOrders(tableId).filter((order)=>!order.finalized);return tableOrders.reduce((count,order)=>count+order.getCustomerCount(),0);},isOpenOrderShareable(){return super.isOpenOrderShareable(...arguments)||this.config.module_pos_restaurant;},toggleEditMode(){this.isEditMode=!this.isEditMode;},async updateModelsData(models_data){const floors=models_data["restaurant.floor"];if(floors){this.floors=floors;this.loadRestaurantFloor();const result=await this.orm.call("pos.config","get_tables_order_count_and_printing_changes",[this.config.id]);for(const table of result){const table_obj=this.tables_by_id[table.id];if(table_obj){table_obj.order_count=table.orders;table_obj.changes_count=table.changes;table_obj.skip_changes=table.skip_changes;}}}
return super.updateModelsData(models_data);},async addProductToCurrentOrder(product,options={}){if(this.config.module_pos_restaurant&&!this.get_order().booked){this.get_order().setBooked(true);}
return super.addProductToCurrentOrder(...arguments);},});return __exports;});;

/* /pos_epson_printer/static/src/app/epson_printer.js */
odoo.define('@pos_epson_printer/app/epson_printer',['@point_of_sale/app/printer/base_printer','@web/core/l10n/translation','@web/core/assets','@web/core/utils/xml'],function(require){'use strict';let __exports={};const{BasePrinter}=require("@point_of_sale/app/printer/base_printer");const{_t}=require("@web/core/l10n/translation");const{templates}=require("@web/core/assets");const{createElement,append,createTextNode}=require("@web/core/utils/xml");function ePOSPrint(children){let ePOSLayout=templates.querySelector("[t-name='pos_epson_printer.ePOSLayout'");if(!ePOSLayout){throw new Error("'ePOSLayout' not loaded");}
ePOSLayout=ePOSLayout.cloneNode(true);const[eposPrintEl]=ePOSLayout.getElementsByTagName("epos-print");append(eposPrintEl,children);return ePOSLayout.innerHTML.replaceAll(`xmlns=""`,"");}
const EpsonPrinter=__exports.EpsonPrinter=class EpsonPrinter extends BasePrinter{setup({ip}){super.setup(...arguments);this.url=window.location.protocol+"//"+ip;this.address=this.url+"/cgi-bin/epos/service.cgi?devid=local_printer";}
processCanvas(canvas){const rasterData=this.canvasToRaster(canvas);const encodedData=this.encodeRaster(rasterData);return ePOSPrint([createElement("image",{width:canvas.width,height:canvas.height,align:"center",},[createTextNode(encodedData)]),createElement("cut",{type:"feed"}),]);}
openCashbox(){const pulse=ePOSPrint([createElement("pulse")]);this.sendPrintingJob(pulse);}
async sendPrintingJob(img){const res=await fetch(this.address,{method:"POST",body:img,});const body=await res.text();const parser=new DOMParser();const parsedBody=parser.parseFromString(body,"application/xml");const response=parsedBody.querySelector("response");return{result:response.getAttribute("success")==="true",printerErrorCode:response.getAttribute("code"),};}
canvasToRaster(canvas){const imageData=canvas.getContext("2d").getImageData(0,0,canvas.width,canvas.height);const pixels=imageData.data;const width=imageData.width;const height=imageData.height;const errors=Array.from(Array(width),(_)=>Array(height).fill(0));const rasterData=new Array(width*height).fill(0);for(let y=0;y<height;y++){for(let x=0;x<width;x++){let oldColor,newColor;const idx=(y*width+x)*4;oldColor=pixels[idx]*0.299+pixels[idx+1]*0.587+pixels[idx+2]*0.114;oldColor+=errors[x][y];oldColor=Math.min(255,Math.max(0,oldColor));if(oldColor<128){newColor=0;rasterData[y*width+x]=1;}else{newColor=255;rasterData[y*width+x]=0;}
const error=oldColor-newColor;if(error){if(x<width-1){errors[x+1][y]+=(7/16)*error;}
if(x>0&&y<height-1){errors[x-1][y+1]+=(3/16)*error;}
if(y<height-1){errors[x][y+1]+=(5/16)*error;}
if(x<width-1&&y<height-1){errors[x+1][y+1]+=(1/16)*error;}}}}
return rasterData.join("");}
encodeRaster(rasterData){let encodedData="";for(let i=0;i<rasterData.length;i+=8){const sub=rasterData.substr(i,8);encodedData+=String.fromCharCode(parseInt(sub,2));}
return btoa(encodedData);}
getActionError(){const printRes=super.getResultsError();if(window.location.protocol==="https:"){printRes.message.body+=_t("If you are on a secure server (HTTPS) please make sure you manually accepted the certificate by accessing %s. ",this.url);}
return printRes;}
getResultsError(printResult){const errorCode=printResult.printerErrorCode;let message=_t("The printer was successfully reached, but it wasn't able to print.")+"\n";if(errorCode){message+="\n"+_t("The following error code was given by the printer:")+"\n"+errorCode;const extra_messages={DeviceNotFound:_t("Check on the printer configuration for the 'Device ID' setting. "+"It should be set to: ")+"\nlocal_printer",EPTR_REC_EMPTY:_t("No paper was detected by the printer"),};if(errorCode in extra_messages){message+="\n"+extra_messages[errorCode];}
message+="\n"+
_t("To find more details on the error reason, please search online for:")+"\n"+" Epson Server Direct Print "+
errorCode;}else{message+=_t("Please check if the printer has enough paper and is ready to print.");}
return{successful:false,message:{title:_t("Printing failed"),body:message,},};}}
return __exports;});;

/* /pos_epson_printer/static/src/overrides/models/models.js */
odoo.define('@pos_epson_printer/overrides/models/models',['@point_of_sale/app/store/pos_store','@pos_epson_printer/app/epson_printer','@web/core/utils/patch'],function(require){'use strict';let __exports={};const{PosStore}=require("@point_of_sale/app/store/pos_store");const{EpsonPrinter}=require("@pos_epson_printer/app/epson_printer");const{patch}=require("@web/core/utils/patch");patch(PosStore.prototype,{after_load_server_data(){var self=this;return super.after_load_server_data(...arguments).then(function(){if(self.config.other_devices&&self.config.epson_printer_ip){self.hardwareProxy.printer=new EpsonPrinter({ip:self.config.epson_printer_ip});}});},create_printer(config){if(config.printer_type==="epson_epos"){return new EpsonPrinter({ip:config.epson_printer_ip});}else{return super.create_printer(...arguments);}},});return __exports;});;

/* /pos_self_order/static/src/overrides/components/product_card/product_card.js */
odoo.define('@pos_self_order/overrides/components/product_card/product_card',['@point_of_sale/app/generic_components/product_card/product_card','@point_of_sale/app/store/pos_hook','@web/core/utils/patch'],function(require){'use strict';let __exports={};const{ProductCard}=require("@point_of_sale/app/generic_components/product_card/product_card");const{usePos}=require("@point_of_sale/app/store/pos_hook");const{patch}=require("@web/core/utils/patch");patch(ProductCard.prototype,{setup(){super.setup();this.pos=usePos();},isSelfOrderAvailable(product_id){return this.pos.db.product_by_id[product_id].self_order_available;},});return __exports;});;

/* /pos_self_order/static/src/overrides/components/product_info_popup/product_info_popup.js */
odoo.define('@pos_self_order/overrides/components/product_info_popup/product_info_popup',['@point_of_sale/app/screens/product_screen/product_info_popup/product_info_popup','@web/core/utils/hooks','@web/core/utils/patch'],function(require){'use strict';let __exports={};const{ProductInfoPopup}=require("@point_of_sale/app/screens/product_screen/product_info_popup/product_info_popup");const{useService}=require("@web/core/utils/hooks");const{patch}=require("@web/core/utils/patch");patch(ProductInfoPopup.prototype,{setup(){super.setup();this.orm=useService("orm");},async switchSelfAvailability(){await this.orm.write("product.product",[this.props.product.id],{self_order_available:!this.props.product.self_order_available,});this.props.product.self_order_available=!this.props.product.self_order_available;},});return __exports;});;

/* /pos_self_order/static/src/overrides/models/navbar.js */
odoo.define('@pos_self_order/overrides/models/navbar',['@point_of_sale/app/navbar/navbar','@web/core/utils/patch'],function(require){'use strict';let __exports={};const{Navbar}=require("@point_of_sale/app/navbar/navbar");const{patch}=require("@web/core/utils/patch");patch(Navbar.prototype,{_shouldLoadOrders(){return super._shouldLoadOrders()||this.pos.company_has_self_ordering;},});return __exports;});;

/* /pos_self_order/static/src/overrides/models/pos_store.js */
odoo.define('@pos_self_order/overrides/models/pos_store',['@point_of_sale/app/store/pos_store','@point_of_sale/app/store/models','@web/core/utils/patch'],function(require){'use strict';let __exports={};const{PosStore}=require("@point_of_sale/app/store/pos_store");const{Order}=require("@point_of_sale/app/store/models");const{patch}=require("@web/core/utils/patch");patch(PosStore.prototype,{async _processData(loadedData){await super._processData(...arguments);this.company_has_self_ordering=loadedData["company_has_self_ordering"];},});patch(Order.prototype,{defaultTableNeeded(options){return(super.defaultTableNeeded(...arguments)&&!this.name.includes("Kiosk")&&!this.name.includes("Self-Order"));},});return __exports;});;

/* /custom_receipts_for_pos/static/src/js/receipt_design.js */
odoo.define('@custom_receipts_for_pos/js/receipt_design',['@point_of_sale/app/screens/receipt_screen/receipt/order_receipt','@web/core/utils/patch','@odoo/owl','@web/core/utils/hooks'],function(require){'use strict';let __exports={};const{OrderReceipt}=require("@point_of_sale/app/screens/receipt_screen/receipt/order_receipt");const{patch}=require("@web/core/utils/patch");const{useState,Component,xml}=require("@odoo/owl");const{useService}=require("@web/core/utils/hooks");patch(OrderReceipt.prototype,{setup(){super.setup();this.state=useState({template:true,})
this.pos=useState(useService("pos"));},get templateProps(){return{data:this.props.data,order:this.pos.orders,receipt:this.pos.orders[0].export_for_printing(),orderlines:this.pos.orders[0].get_orderlines(),paymentlines:this.pos.orders[0].get_paymentlines()};},get templateComponent(){var mainRef=this;return class extends Component{setup(){}
static template=xml`${mainRef.pos.config.design_receipt}`};},get isTrue(){if(this.env.services.pos.config.is_custom_receipt==false){return true;}
return false;}});return __exports;});;

/* /point_of_sale/static/src/app/main.js */
odoo.define('@point_of_sale/app/main',['@point_of_sale/app/pos_app','@point_of_sale/app/loader/loader','@web/core/assets','@odoo/owl','@web/core/l10n/translation','@web/core/browser/feature_detection','@web/core/l10n/localization','@web/env','@web/session','@web/core/network/rpc_service'],function(require){'use strict';let __exports={};const{Chrome}=require("@point_of_sale/app/pos_app");const{Loader}=require("@point_of_sale/app/loader/loader");const{templates}=require("@web/core/assets");const{App,mount,reactive,whenReady}=require("@odoo/owl");const{_t}=require("@web/core/l10n/translation");const{hasTouch}=require("@web/core/browser/feature_detection");const{localization}=require("@web/core/l10n/localization");const{makeEnv,startServices}=require("@web/env");const{session}=require("@web/session");const{RPCError}=require("@web/core/network/rpc_service");const loader=reactive({isShown:true});whenReady(()=>{mount(Loader,document.body,{templates,translateFn:_t,props:{loader}});});(async function startPosApp(){odoo.info={db:session.db,server_version:session.server_version,server_version_info:session.server_version_info,isEnterprise:session.server_version_info.slice(-1)[0]==="e",};const env=makeEnv();await startServices(env);if(env.services.pos instanceof Error){let message=_t("An error occurred while loading the Point of Sale: \n");if(env.services.pos instanceof RPCError){message+=env.services.pos.data.message;}else{message+=env.services.pos.message;}
window.alert(message);window.location="/web#action=point_of_sale.action_client_pos_menu";}
await whenReady();const app=new App(Chrome,{name:"Odoo Point of Sale",env,templates,dev:env.debug,warnIfNoStaticProps:true,translatableAttributes:["data-tooltip"],translateFn:_t,props:{disableLoader:()=>(loader.isShown=false)},});const root=await app.mount(document.body);const classList=document.body.classList;if(localization.direction==="rtl"){classList.add("o_rtl");}
if(env.services.user.userId===1){classList.add("o_is_superuser");}
if(env.debug){classList.add("o_debug");}
if(hasTouch()){classList.add("o_touch_device");}
odoo.__WOWL_DEBUG__={root};})();return __exports;});;

/* /pos_online_payment/static/src/app/bus/pos_bus_service.js */
odoo.define('@pos_online_payment/app/bus/pos_bus_service',['@web/core/utils/patch','@point_of_sale/app/bus/pos_bus_service'],function(require){'use strict';let __exports={};const{patch}=require("@web/core/utils/patch");const{PosBus}=require("@point_of_sale/app/bus/pos_bus_service");patch(PosBus.prototype,{dispatch(message){super.dispatch(...arguments);if(message.type==="ONLINE_PAYMENTS_NOTIFICATION"){const currentOrder=this.pos.get_order();if(currentOrder&&currentOrder.server_id===message.payload.id){currentOrder.update_online_payments_data_with_server(this.orm,false);}}},});return __exports;});;

/* /pos_online_payment/static/src/app/screens/payment_screen/payment_screen.js */
odoo.define('@pos_online_payment/app/screens/payment_screen/payment_screen',['@web/core/l10n/translation','@point_of_sale/app/screens/payment_screen/payment_screen','@web/core/utils/patch','@pos_online_payment/app/utils/online_payment_popup/online_payment_popup','@point_of_sale/app/utils/confirm_popup/confirm_popup','@point_of_sale/app/errors/popups/error_popup','@web/core/utils/numbers','@point_of_sale/utils'],function(require){'use strict';let __exports={};const{_t}=require("@web/core/l10n/translation");const{PaymentScreen}=require("@point_of_sale/app/screens/payment_screen/payment_screen");const{patch}=require("@web/core/utils/patch");const{OnlinePaymentPopup}=require("@pos_online_payment/app/utils/online_payment_popup/online_payment_popup");const{ConfirmPopup}=require("@point_of_sale/app/utils/confirm_popup/confirm_popup");const{ErrorPopup}=require("@point_of_sale/app/errors/popups/error_popup");const{floatIsZero}=require("@web/core/utils/numbers");const{qrCodeSrc}=require("@point_of_sale/utils");patch(PaymentScreen.prototype,{getRemainingOnlinePaymentLines(){return this.paymentLines.filter((line)=>line.payment_method.is_online_payment&&line.get_payment_status()!=="done");},checkRemainingOnlinePaymentLines(unpaidAmount){const remainingLines=this.getRemainingOnlinePaymentLines();let remainingAmount=0;let amount=0;for(const line of remainingLines){amount=line.get_amount();if(amount<=0){this.popup.add(ErrorPopup,{title:_t("Invalid online payment"),body:_t("Online payments cannot have a negative amount (%s: %s).",line.payment_method.name,this.env.utils.formatCurrency(amount)),});return false;}
remainingAmount+=amount;}
if(!floatIsZero(unpaidAmount-remainingAmount,this.pos.currency.decimal_places)){this.popup.add(ErrorPopup,{title:_t("Invalid online payments"),body:_t("The total amount of remaining online payments to execute (%s) doesn't correspond to the remaining unpaid amount of the order (%s).",this.env.utils.formatCurrency(remainingAmount),this.env.utils.formatCurrency(unpaidAmount)),});return false;}
return true;},async _isOrderValid(isForceValidate){if(!await super._isOrderValid(...arguments)){return false;}
if(!this.payment_methods_from_config.some((pm)=>pm.is_online_payment)){return true;}
if(this.currentOrder.finalized){this.afterOrderValidation(false);return false;}
const onlinePaymentLines=this.getRemainingOnlinePaymentLines();if(onlinePaymentLines.length>0){this.currentOrder.date_order=luxon.DateTime.now();this.currentOrder.save_to_db();this.pos.addOrderToUpdateSet();try{await this.pos.sendDraftToServer();}catch(error){if(error.code==700||error.code==701){this.error=true;}
if("code"in error){await this._handlePushOrderError(error);}
this.showSaveOrderOnServerErrorPopup();return false;}
if(!this.currentOrder.server_id){this.showSaveOrderOnServerErrorPopup();return false;}
if(!this.currentOrder.server_id){this.cancelOnlinePayment(this.currentOrder);this.popup.add(ErrorPopup,{title:_t("Online payment unavailable"),body:_t("The QR Code for paying could not be generated."),});return false;}
const qrCodeImgSrc=qrCodeSrc(`${this.pos.base_url}/pos/pay/${this.currentOrder.server_id}?access_token=${this.currentOrder.access_token}`);let prevOnlinePaymentLine=null;let lastOrderServerOPData=null;for(const onlinePaymentLine of onlinePaymentLines){const onlinePaymentLineAmount=onlinePaymentLine.get_amount();lastOrderServerOPData=await this.currentOrder.update_online_payments_data_with_server(this.pos.orm,onlinePaymentLineAmount);if(!lastOrderServerOPData){this.popup.add(ErrorPopup,{title:_t("Online payment unavailable"),body:_t("There is a problem with the server. The order online payment status cannot be retrieved."),});return false;}
if(!lastOrderServerOPData.is_paid){if(lastOrderServerOPData.modified_payment_lines){this.cancelOnlinePayment(this.currentOrder);this.showModifiedOnlinePaymentsPopup();return false;}
if((prevOnlinePaymentLine&&prevOnlinePaymentLine.get_payment_status()!=="done")||!this.checkRemainingOnlinePaymentLines(lastOrderServerOPData.amount_unpaid)){this.cancelOnlinePayment(this.currentOrder);return false;}
onlinePaymentLine.set_payment_status("waiting");this.currentOrder.select_paymentline(onlinePaymentLine);lastOrderServerOPData=await this.showOnlinePaymentQrCode(qrCodeImgSrc,onlinePaymentLineAmount);if(onlinePaymentLine.get_payment_status()==="waiting"){onlinePaymentLine.set_payment_status(undefined);}
prevOnlinePaymentLine=onlinePaymentLine;}}
if(!lastOrderServerOPData||!lastOrderServerOPData.is_paid){lastOrderServerOPData=await this.currentOrder.update_online_payments_data_with_server(this.pos.orm,0);}
if(!lastOrderServerOPData||!lastOrderServerOPData.is_paid){return false;}
await this.afterPaidOrderSavedOnServer(lastOrderServerOPData.paid_order);return false;}else if(this.currentOrder.server_id){const orderServerOPData=await this.currentOrder.update_online_payments_data_with_server(this.pos.orm,0);if(!orderServerOPData){const{confirmed}=await this.popup.add(ConfirmPopup,{title:_t("Online payment unavailable"),body:_t("There is a problem with the server. The order online payment status cannot be retrieved. Are you sure there is no online payment for this order ?"),confirmText:_t("Yes"),});return confirmed;}
if(orderServerOPData.is_paid){await this.afterPaidOrderSavedOnServer(orderServerOPData.paid_order);return false;}
if(orderServerOPData.modified_payment_lines){this.showModifiedOnlinePaymentsPopup();return false;}}
return true;},cancelOnlinePayment(order){order.update_online_payments_data_with_server(this.pos.orm,0);},showSaveOrderOnServerErrorPopup(){this.popup.add(ErrorPopup,{title:_t("Online payment unavailable"),body:_t("There is a problem with the server. The order cannot be saved and therefore the online payment is not possible."),});},showModifiedOnlinePaymentsPopup(){this.popup.add(ErrorPopup,{title:_t("Updated online payments"),body:_t("There are online payments that were missing in your view."),});},async showOnlinePaymentQrCode(qrCodeData,amount){if(!this.currentOrder.uiState.PaymentScreen){this.currentOrder.uiState.PaymentScreen={};}
this.currentOrder.uiState.PaymentScreen.onlinePaymentData={amount:amount,qrCode:qrCodeData,order:this.currentOrder,};const{confirmed,payload:orderServerOPData}=await this.popup.add(OnlinePaymentPopup,this.currentOrder.uiState.PaymentScreen.onlinePaymentData);if(this.currentOrder.uiState.PaymentScreen){delete this.currentOrder.uiState.PaymentScreen.onlinePaymentData;if(Object.keys(this.currentOrder.uiState.PaymentScreen).length===0){delete this.currentOrder.uiState.PaymentScreen;}}
return confirmed?orderServerOPData:null;},async afterPaidOrderSavedOnServer(orderJSON){if(!orderJSON){this.popup.add(ErrorPopup,{title:_t("Server error"),body:_t("The saved order could not be retrieved."),});return;}
const isInvoiceRequested=this.currentOrder.is_to_invoice();const orderJSONInArray=[orderJSON];await this.pos._loadMissingProducts(orderJSONInArray);await this.pos._loadMissingPartners(orderJSONInArray);const updatedOrder=this.pos.createReactiveOrder(orderJSON);if(!updatedOrder||this.currentOrder.server_id!==updatedOrder.backendId){this.popup.add(ErrorPopup,{title:_t("Order saving issue"),body:_t("The order has not been saved correctly on the server."),});return;}
this.pos.orders.add(updatedOrder);const oldLocalOrder=this.currentOrder;this.pos.set_order(updatedOrder);this.pos.removeOrder(oldLocalOrder,false);this.pos.validated_orders_name_server_id_map[this.currentOrder.name]=this.currentOrder.id;if((this.currentOrder.is_paid_with_cash()||this.currentOrder.get_change())&&this.pos.config.iface_cashdrawer){this.hardwareProxy.printer.openCashbox();}
this.currentOrder.finalized=true;if(isInvoiceRequested){if(!this.currentOrder.account_move){this.popup.add(ErrorPopup,{title:_t("Invoice could not be generated"),body:_t("The invoice could not be generated."),});}else{await this.report.doAction("account.account_invoices",[this.currentOrder.account_move,]);}}
await this.postPushOrderResolve([this.currentOrder.server_id]);this.afterOrderValidation(true);},});return __exports;});;

/* /pos_online_payment/static/src/app/store/models.js */
odoo.define('@pos_online_payment/app/store/models',['@web/core/utils/patch','@point_of_sale/app/store/models','@web/core/utils/numbers'],function(require){'use strict';let __exports={};const{patch}=require("@web/core/utils/patch");const{Order,Payment}=require("@point_of_sale/app/store/models");const{floatIsZero}=require("@web/core/utils/numbers");patch(Order.prototype,{async update_online_payments_data_with_server(orm,next_online_payment_amount){if(!this.server_id){return false;}
try{const opData=await orm.call("pos.order","get_and_set_online_payments_data",[this.server_id,next_online_payment_amount]);return this.process_online_payments_data_from_server(opData);}catch(ex){console.error("update_online_payments_data_with_server failed: ",ex);return null;}},async process_online_payments_data_from_server(opData){if(!opData){return false;}
if(opData.id!==this.server_id){console.error("Called process_online_payments_data_from_server on the wrong order.");}
if("paid_order"in opData){opData.is_paid=true;this.uiState.PaymentScreen?.onlinePaymentPopup?.setReceivedOrderServerOPData(opData);return opData;}else{opData.is_paid=false;}
if("deleted"in opData&&opData["deleted"]){this.server_id=false;}
let newDoneOnlinePayment=false;const opLinesToUpdate=this.paymentlines.filter((line)=>line.payment_method.is_online_payment&&["waiting","done"].includes(line.get_payment_status()));for(const op of opData.online_payments){const matchingLineIndex=opLinesToUpdate.findIndex((pl)=>pl.payment_method.id===op.payment_method_id&&floatIsZero(pl.amount-op.amount,this.pos.currency.decimal_places));let opLine=null;if(matchingLineIndex>-1){opLine=opLinesToUpdate[matchingLineIndex];opLinesToUpdate.splice(matchingLineIndex,1);}
if(!opLine){opLine=new Payment({},{order:this,payment_method:this.pos.payment_methods_by_id[op.payment_method_id],pos:this.pos,});this.paymentlines.add(opLine);opData['modified_payment_lines']=true;}
opLine.set_amount(op.amount);opLine.can_be_reversed=false;if(opLine.get_payment_status()!=="done"){newDoneOnlinePayment=true;}
opLine.set_payment_status("done");}
for(const missingInServerLine of opLinesToUpdate){if(missingInServerLine.get_payment_status()==="done"){this.paymentlines.remove(missingInServerLine);opData['modified_payment_lines']=true;}}
if(newDoneOnlinePayment||opData['modified_payment_lines']){this.uiState.PaymentScreen?.onlinePaymentPopup?.cancel();}
return opData;},});patch(Payment.prototype,{export_as_JSON(){if(this.payment_method.is_online_payment){return null;}else{return super.export_as_JSON();}},canBeAdjusted(){if(this.payment_method.is_online_payment){return false;}else{return super.canBeAdjusted();}},});return __exports;});;

/* /pos_online_payment/static/src/app/utils/online_payment_popup/online_payment_popup.js */
odoo.define('@pos_online_payment/app/utils/online_payment_popup/online_payment_popup',['@point_of_sale/app/popup/abstract_awaitable_popup'],function(require){'use strict';let __exports={};const{AbstractAwaitablePopup}=require("@point_of_sale/app/popup/abstract_awaitable_popup");const OnlinePaymentPopup=__exports.OnlinePaymentPopup=class OnlinePaymentPopup extends AbstractAwaitablePopup{static template="pos_online_payment.OnlinePaymentPopup";setup(){super.setup();if(this.props.order.uiState.PaymentScreen){this.props.order.uiState.PaymentScreen.onlinePaymentPopup=this;}}
setReceivedOrderServerOPData(opData){this.opData=opData;this.confirm();}
async confirm(){super.confirm();delete this.props.order.uiState.PaymentScreen?.onlinePaymentPopup;}
cancel(){super.cancel();delete this.props.order.uiState.PaymentScreen?.onlinePaymentPopup;}
async getPayload(){return this.opData;}}
return __exports;});

                    /*******************************************
                    *  Templates                               *
                    *******************************************/

                    odoo.define('point_of_sale.assets_prod.bundle.xml', ['@web/core/registry'], function(require){
                        'use strict';
                        const { registry } = require('@web/core/registry');
                        registry.category(`xml_templates`).add(`point_of_sale.assets_prod`, `<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
<t t-name="web.ActionSwiper">
        <t t-if="props.onRightSwipe || props.onLeftSwipe">
            <div class="o_actionswiper" t-on-touchend="_onTouchEndSwipe" t-on-touchmove="_onTouchMoveSwipe" t-on-touchstart="_onTouchStartSwipe" t-ref="root">
                <div class="o_actionswiper_overflow_container position-relative overflow-hidden">
                    <div class="o_actionswiper_target_container" t-ref="targetContainer" t-att-style="state.containerStyle" t-att-class="{ o_actionswiper_swiping: state.isSwiping }">
                        <t t-slot="default"/>
                        <t t-if="localizedProps.onRightSwipe and (localizedProps.onRightSwipe.icon or localizedProps.onRightSwipe.bgColor)">
                            <div t-att-style="'max-width: ' + swipedDistance + 'px;'" class="o_actionswiper_right_swipe_area position-absolute overflow-hidden w-100 h-100 d-flex align-items-center justify-content-center rounded-end" t-att-class="localizedProps.onRightSwipe.bgColor">
                                <span><i class="fa fa-2x" t-att-class="localizedProps.onRightSwipe.icon"/></span>
                            </div>
                        </t>
                        <t t-if="localizedProps.onLeftSwipe and (localizedProps.onLeftSwipe.icon or localizedProps.onLeftSwipe.bgColor)">
                            <div t-att-style="'max-width: ' + -swipedDistance + 'px;'" class="o_actionswiper_left_swipe_area position-absolute overflow-hidden w-100 h-100 d-flex align-items-center justify-content-center rounded-start" t-att-class="localizedProps.onLeftSwipe.bgColor">
                                <span><i class="fa fa-2x" t-att-class="localizedProps.onLeftSwipe.icon"/></span>
                            </div>
                        </t>
                    </div>
                </div>
            </div>
        </t>
        <t t-else="">
            <t t-slot="default"/>
        </t>
    </t>
<t t-name="web.AutoComplete">
        <div class="o-autocomplete" t-ref="root" t-att-class="autoCompleteRootClass">
            <input type="text" t-att-id="props.id" class="o-autocomplete--input o_input" autocomplete="off" t-att-placeholder="props.placeholder" role="combobox" t-att-aria-activedescendant="activeSourceOptionId" t-att-aria-expanded="displayOptions ? 'true' : 'false'" aria-autocomplete="list" aria-haspopup="listbox" t-model="state.value" t-on-blur="onInputBlur" t-on-click.stop="onInputClick" t-on-change="onInputChange" t-on-input="onInput" t-on-keydown="onInputKeydown" t-on-focus="onInputFocus" t-ref="input"/>
            <t t-if="displayOptions">
                <ul role="menu" class="o-autocomplete--dropdown-menu ui-widget show" t-att-class="ulDropdownClass" t-ref="sourcesList">
                    <t t-foreach="sources" t-as="source" t-key="source.id">
                        <t t-if="source.isLoading">
                            <li class="ui-menu-item" t-att-class="{                                     'o-autocomplete--dropdown-item': props.dropdown,                                     'd-block': !props.dropdown                                 }">
                                <a t-attf-id="{{props.id or 'autocomplete'}}_{{source_index}}_loading" role="option" href="#" class="dropdown-item ui-menu-item-wrapper" aria-selected="true">
                                    <i class="fa fa-spin fa-circle-o-notch"/> <t t-esc="source.placeholder"/>
                                </a>
                            </li>
                        </t>
                        <t t-else="">
                            <t t-foreach="source.options" t-as="option" t-key="option.id">
                                <li class="o-autocomplete--dropdown-item ui-menu-item d-block" t-att-class="option.classList" t-on-mouseenter="() =&gt; this.onOptionMouseEnter([source_index, option_index])" t-on-mouseleave="() =&gt; this.onOptionMouseLeave([source_index, option_index])" t-on-click="() =&gt; this.onOptionClick([source_index, option_index])" t-on-pointerdown="() =&gt; this.ignoreBlur = true">
                                    <a t-attf-id="{{props.id or 'autocomplete'}}_{{source_index}}_{{option_index}}" role="option" href="#" class="dropdown-item ui-menu-item-wrapper text-truncate" t-att-class="{ 'ui-state-active': isActiveSourceOption([source_index, option_index]) }" t-att-aria-selected="isActiveSourceOption([source_index, option_index]) ? 'true' : 'false'">
                                        <t t-if="source.optionTemplate">
                                            <t t-call="{{ source.optionTemplate }}"/>
                                        </t>
                                        <t t-else="">
                                            <t t-esc="option.label"/>
                                        </t>
                                    </a>
                                </li>
                            </t>
                        </t>
                    </t>
                </ul>
            </t>
        </div>
    </t>

<t t-name="web.CheckBox">
    <div class="o-checkbox form-check" t-attf-class="{{ props.slots ? 'form-check' : '' }}" t-att-class="props.className" t-on-click="onClick" t-ref="root">
        <input t-att-id="props.id or id" type="checkbox" class="form-check-input" t-att-disabled="props.disabled" t-att-checked="props.value" t-att-name="props.name" t-on-change="onChange"/>
        <label t-att-for="props.id or id" class="form-check-label">
            <t t-slot="default"/>
        </label>
    </div>
</t>

<t t-name="web.CodeEditor">
        <div t-ref="editorRef" class="w-100" t-att-class="props.class"/>
    </t>

<t t-name="web.ColorList">
        <div class="o_colorlist d-flex flex-wrap align-items-center mw-100 gap-2" aria-atomic="true" t-ref="colorlist">
            <t t-if="!props.forceExpanded and !state.isExpanded">
                <button t-on-click="onToggle" role="menuitem" t-att-title="colors[props.selectedColor]" t-att-data-color="props.selectedColor" t-att-aria-label="colors[props.selectedColor]" t-attf-class="btn p-0 rounded-0 o_colorlist_toggler o_colorlist_item_color_{{ props.selectedColor }}"/>
            </t>
            <t t-else="" t-foreach="props.colors" t-as="colorId" t-key="colorId">
                <button t-on-click.prevent.stop="() =&gt; this.onColorSelected(colorId)" role="menuitem" t-att-title="colors[colorId]" t-att-data-color="colorId" t-att-aria-label="colors[colorId]" t-attf-class="btn p-0 rounded-0 o_colorlist_item_color_{{ colorId }} {{ colorId === props.selectedColor ? 'o_colorlist_selected' : '' }}"/>
            </t>
        </div>
    </t>

<t t-name="web.Colorpicker">
    <div class="o_colorpicker_widget" t-ref="el">
        <div class="d-flex justify-content-between align-items-stretch mb-2">
            <div class="o_color_pick_area position-relative w-75" t-att-style="props.noTransparency ? 'width: 89%;' : None">
                <div class="o_picker_pointer rounded-circle p-1 position-absolute" tabindex="-1"/>
            </div>
            <div class="o_color_slider position-relative">
                <div class="o_slider_pointer" tabindex="-1"/>
            </div>
            <div class="o_opacity_slider position-relative" t-if="!props.noTransparency">
                <div class="o_opacity_pointer" tabindex="-1"/>
            </div>
        </div>
        <div t-if="props.colorPreview" class="o_color_preview mb-1 w-100 p-2"/>
        <div class="o_color_picker_inputs d-flex justify-content-between mb-2">
            <t t-set="input_classes" t-value="'p-0 border-0 text-center font-monospace bg-transparent'"/>

            <div class="o_hex_div px-1 d-flex align-items-baseline">
                <input type="text" t-attf-class="o_hex_input {{input_classes}}" data-color-method="hex" size="1" t-on-input="_onHexColorInput"/>
                <label class="flex-grow-0 ms-1 mb-0">hex</label>
            </div>
            <div class="o_rgba_div px-1 d-flex align-items-baseline">
                <input type="text" t-attf-class="o_red_input {{input_classes}}" data-color-method="rgb" size="1"/>
                <input type="text" t-attf-class="o_green_input {{input_classes}}" data-color-method="rgb" size="1"/>
                <input type="text" t-attf-class="o_blue_input me-0 {{input_classes}}" data-color-method="rgb" size="1"/>
                <t t-if="!props.noTransparency">
                    <input type="text" t-attf-class="o_opacity_input {{input_classes}}" data-color-method="opacity" size="1"/>
                    <label class="flex-grow-0 ms-1 mb-0">
                        RGBA
                    </label>
                </t>
                <label t-else="" class="flex-grow-0 ms-1 mb-0">
                    RGB
                </label>
            </div>
        </div>
    </div>
</t>

<t t-name="web.DefaultFooter" owl="1">
    <span>
      <span class="fw-bolder text-primary">TIP</span>  search for
      <t t-foreach="elements" t-as="element" t-key="element.namespace">
          <t t-if="!(element_first || element_last)">, </t>
          <t t-if="element_last and !element_first"> and </t>
          <span class="o_namespace btn-link text-primary cursor-pointer" t-on-click="() =&gt; this.onClick(element.namespace)">
              <span t-out="element.namespace" class="fw-bolder text-primary"/><t t-out="element.name"/>
          </span>
      </t>
    </span>
  </t>

  <t t-name="web.DefaultCommandItem">
    <div class="o_command_default d-flex align-items-center justify-content-between px-4 py-2 cursor-pointer">
      <t t-slot="name"/>
      <t t-slot="focusMessage"/>
    </div>
  </t>

  <t t-name="web.HotkeyCommandItem">
    <div class="o_command_hotkey d-flex align-items-center justify-content-between px-4 py-2 cursor-pointer">
      <t t-slot="name"/>
      <span>
        <t t-foreach="getKeysToPress(props)" t-as="key" t-key="key_index">
          <kbd t-out="key" class="d-inline-block px-3 py-1"/>
          <span t-if="!key_last"> + </span>
        </t>
      </span>
    </div>
  </t>

<t t-name="web.CommandPalette">
    <Dialog header="false" footer="false" size="'md'" contentClass="'o_command_palette mt-5'">
      <div t-ref="root">
        <div class="o_command_palette_search input-group mb-2 px-4 py-3 border-bottom">
          <span t-if="state.namespace !== 'default'" class="o_namespace d-flex align-items-center me-1" t-out="state.namespace"/>
          <input class="form-control border-0 p-0" type="text" data-allow-hotkeys="true" t-att-value="state.searchValue" t-ref="autofocus" t-att-placeholder="state.placeholder" t-on-input="onSearchInput" t-on-keydown="onKeyDown" role="combobox" t-attf-aria-activedescendant="o_command_{{state.commands.length ? state.commands.indexOf(state.selectedCommand) : 'empty'}}" aria-expanded="true" aria-autocomplete="list" aria-haspopup="listbox"/>
          <div class="input-group-text border-0 bg-transparent">
              <i t-att-title="state.placeholder" role="img" t-att-aria-label="state.placeholder" class="oi oi-search"/>
          </div>
        </div>

        <div t-ref="listbox" role="listbox" class="o_command_palette_listbox position-relative overflow-auto">
          <div t-if="!state.commands.length" id="o_command_empty" role="option" aria-selected="true" class="o_command_palette_listbox_empty px-4 py-3 fst-italic" t-out="state.emptyMessage"/>
          <t t-if="!isFuzzySearch" t-foreach="commandsByCategory" t-as="category" t-key="category.keyId">
            <div class="o_command_category px-0">
              <span t-if="category.name" class="text-truncate text-uppercase fw-bold fs-6 px-3" t-out="category.name"/>
              <t t-foreach="category.commands" t-as="command" t-key="command.keyId">
                <t t-set="commandIndex" t-value="state.commands.indexOf(command)"/>
                <div t-attf-id="o_command_{{commandIndex}}" class="o_command" role="option" t-att-aria-selected="state.selectedCommand === command ? 'true' : 'false'" t-att-class="{ focused: state.selectedCommand === command }" t-on-click="(event) =&gt; this.onCommandClicked(event, commandIndex)" t-on-mouseenter="() =&gt; this.onCommandMouseEnter(commandIndex)" t-on-close="() =&gt; this.props.closeMe()">
                  <a t-att-href="command.href">
                    <t t-component="command.Component || DefaultCommandItem" name="command.name" searchValue="state.searchValue" t-props="command.props" executeCommand="() =&gt; this.executeCommand(command)">
                      <t t-set-slot="name">
                        <span class="o_command_name text-ellipsis" t-att-title="command.name">
                          <t t-foreach="command.splitName" t-as="name" t-key="name_index">
                            <b t-if="name_index % 2" t-out="name" class="text-primary"/>
                            <t t-else="" t-out="name"/>
                          </t>
                        </span>
                      </t>
                      <t t-set-slot="focusMessage">
                          <small t-if="!isMobileOS and command.href and state.selectedCommand === command" class="o_command_focus text-muted"><kbd><t t-if="isMacOS">CMD</t><t t-else="">CTRL</t></kbd>+<kbd></kbd><span class="ms-1">new tab</span></small>
                      </t>
                    </t>
                  </a>
                </div>
              </t>
            </div>

            <hr class="my-2 mx-0" t-if="!category_last"/>
          </t>
        </div>

        <div t-if="state.FooterComponent" class="o_command_palette_footer mt-2 px-4 py-2 border-top rounded-bottom bg-100 text-muted">
          <t t-component="state.FooterComponent" switchNamespace="(namespace) =&gt; this.debounceSearch(namespace.concat(this.state.searchValue))"/>
        </div>
      </div>
    </Dialog>
  </t>

<t t-name="web.ConfirmationDialog">
    <Dialog size="'md'" title="props.title" modalRef="modalRef">
      <p t-out="props.body" class="text-prewrap"/>
      <t t-set-slot="footer">
        <button class="btn" t-att-class="props.confirmClass" t-on-click="_confirm" t-esc="props.confirmLabel"/>
        <button t-if="props.cancel" class="btn btn-secondary" t-on-click="_cancel" t-esc="props.cancelLabel"/>
      </t>
    </Dialog>
  </t>

  <t t-name="web.AlertDialog">
    <Dialog size="'sm'" title="props.title" contentClass="props.contentClass">
      <p t-out="props.body" class="text-prewrap"/>
      <t t-set-slot="footer">
        <button class="btn" t-att-class="props.confirmClass" t-on-click="_confirm" t-esc="props.confirmLabel"/>
        <button t-if="props.cancel" class="btn btn-secondary" t-on-click="_cancel" t-esc="props.cancelLabel"/>
      </t>
    </Dialog>
  </t>

<t t-name="web.DateTimeInput">
        <input type="text" t-ref="start-date" t-att-id="props.id" class="o_datetime_input o_input cursor-pointer" autocomplete="off" t-att-placeholder="props.placeholder"/>
    </t>
<t t-name="web.DateTimePicker.Days">
        <div class="d-flex gap-3">
            <t t-foreach="items" t-as="month" t-key="month.id">
                <div class="o_date_picker d-grid flex-grow-1 bg-view rounded overflow-auto" t-on-pointerleave="() =&gt; (state.hoveredDate = null)">
                    <t t-foreach="month.daysOfWeek" t-as="dayOfWeek" t-key="dayOfWeek[0]">
                        <div class="o_day_of_week_cell o_text_sm o_cell_md fw-bolder bg-100 border-bottom border-2 d-flex align-items-center justify-content-center" t-att-title="dayOfWeek[1]">
                            <div class="text-nowrap overflow-hidden" t-esc="props.daysOfWeekFormat === 'narrow' ? dayOfWeek[2] : dayOfWeek[0]"/>
                        </div>
                    </t>
                    <t t-foreach="month.weeks" t-as="week" t-key="week.number">
                        <t t-if="props.showWeekNumbers ?? !props.range">
                            <div class="o_week_number_cell o_center o_cell_md o_text_sm bg-100 fw-bolder" t-att-class="{ 'border-bottom': !week_last }" t-esc="week.number"/>
                        </t>
                        <t t-foreach="week.days" t-as="itemInfo" t-key="itemInfo.id">
                            <t t-set="arInfo" t-value="getActiveRangeInfo(itemInfo)"/>
                            <button class="o_date_item_cell o_datetime_button o_center o_cell_md btn p-1 border-0 fw-normal" tabindex="-1" t-att-class="{                                     'o_selected': arInfo.isSelected,                                     o_select_start: arInfo.isSelectStart,                                     o_select_end: arInfo.isSelectEnd,                                     'o_highlighted': arInfo.isHighlighted,                                     o_highlight_start: arInfo.isHighlightStart,                                     o_highlight_end: arInfo.isHighlightEnd,                                     o_current: arInfo.isCurrent,                                     o_today: itemInfo.includesToday,                                     o_out_of_range: itemInfo.isOutOfRange or !itemInfo.isValid,                                     [itemInfo.extraClass]: true,                                 }" t-att-disabled="!itemInfo.isValid" t-on-pointerenter="() =&gt; (state.hoveredDate = itemInfo.range[0])" t-on-click="() =&gt; this.zoomOrSelect(itemInfo)">
                                <span t-esc="itemInfo.label" class="z-index-1"/>
                            </button>
                        </t>
                    </t>
                </div>
            </t>
        </div>
        <div t-attf-class="position-relative d-flex flex-column flex-md-row gap-4 gap-md-3 {{ props.type === 'datetime' ? 'justify-content-center' : 'justify-content-end' }}">
            <div t-attf-class="d-flex gap-3 w-100 {{ props.type === 'datetime' ? 'justify-content-center' : 'd-none' }}">
                <t t-if="props.type === 'datetime'">
                    <t t-foreach="state.timeValues" t-as="timeValue" t-key="timeValue_index">
                        <div t-if="timeValue" class="o_time_picker d-flex align-items-center justify-content-center w-lg-50 w-100 gap-1">
                            <t t-call="web.DateTimePicker.Select">
                                <t t-set="unitIndex" t-value="0"/>
                                <t t-set="unitList" t-value="availableHours"/>
                            </t>
                            <span>:</span>
                            <t t-call="web.DateTimePicker.Select">
                                <t t-set="unitIndex" t-value="1"/>
                                <t t-set="unitList" t-value="availableMinutes"/>
                            </t>
                            <t t-if="availableSeconds.length">
                                <span>:</span>
                                <t t-call="web.DateTimePicker.Select">
                                    <t t-set="unitIndex" t-value="2"/>
                                    <t t-set="unitList" t-value="availableSeconds"/>
                                </t>
                            </t>
                            <t t-if="meridiems">
                                <t t-call="web.DateTimePicker.Select">
                                    <t t-set="unitIndex" t-value="3"/>
                                    <t t-set="unitList" t-value="meridiems"/>
                                </t>
                            </t>
                        </div>
                    </t>
                </t>
            </div>

            <div t-attf-class="o_datetime_buttons {{ props.type === 'datetime' ? 'position-md-absolute h-100 start-0' : '' }}">
                <t t-slot="bottom_left"/>
            </div>
            <div t-attf-class="o_datetime_buttons {{ props.type === 'datetime' ? 'position-md-absolute h-100 end-0' : '' }}">
                <t t-slot="buttons"/>
            </div>
        </div>
    </t>

    <t t-name="web.DateTimePicker.Grid">
        <div class="o_date_item_picker d-grid">
            <t t-foreach="items" t-as="itemInfo" t-key="itemInfo.id">
                <t t-set="arInfo" t-value="getActiveRangeInfo(itemInfo)"/>
                <button class="o_date_item_cell o_datetime_button btn o_center o_cell_lg btn p-1 border-0" tabindex="-1" t-att-class="{                         'o_selected': arInfo.isSelected,                         o_select_start: arInfo.isSelectStart,                         o_select_end: arInfo.isSelectEnd,                         'o_highlighted': arInfo.isHighlighted,                         o_highlight_start: arInfo.isHighlightStart,                         o_highlight_end: arInfo.isHighlightEnd,                         o_today: itemInfo.includesToday,                         o_out_of_range: itemInfo.isOutOfRange or !itemInfo.isValid,                     }" t-att-disabled="!itemInfo.isValid" t-on-click="() =&gt; this.zoomOrSelect(itemInfo)">
                    <span t-esc="itemInfo.label" class="z-index-1"/>
                </button>
            </t>
        </div>
    </t>

    <t t-name="web.DateTimePicker.Select">

        <select class="o_time_picker_select form-control form-control-sm w-auto" tabindex="-1" t-model="timeValue[unitIndex]" t-on-change="() =&gt; this.selectTime(timeValue_index)">
            <t t-foreach="unitList" t-as="unit" t-key="unit[0]">
                <option class="text-center" t-att-value="unit[0]" t-esc="unit[1]" t-att-selected="timeValue[unitIndex] === unit[0].toString()"/>
            </t>
        </select>
    </t>

    <t t-name="web.DateTimePicker">
        <div class="o_datetime_picker d-flex flex-column gap-2 user-select-none" t-att-class="!isLastPrecisionLevel ? 'p-2 p-lg-3' : ''" t-attf-style="--DateTimePicker__Day-template-columns: {{ props.showWeekNumbers ?? !props.range ? 8 : 7 }}">
            <nav class="o_datetime_picker_header btn-group">
                <button class="o_previous btn btn-light flex-grow-0" tabindex="-1" t-att-class="isLastPrecisionLevel ? 'order-1 btn-sm px-1' : ''" t-on-click="previous">
                    <i class="oi oi-chevron-left" t-att-title="activePrecisionLevel.prevTitle"/>
                </button>
                <button class="o_zoom_out o_datetime_button btn btn-light d-flex align-items-center px-0 text-truncate" t-att-class="isLastPrecisionLevel ? 'pe-none text-start' : 'justify-content-around'" tabindex="-1" t-att-title="!isLastPrecisionLevel and activePrecisionLevel.mainTitle" t-on-click="zoomOut">
                    <t t-foreach="titles" t-as="title" t-key="title">
                        <strong t-attf-class="o_header_part fs-5 {{                                 props.range ? 'flex-basis-50' : 'flex-basis-100',                                 isLastPrecisionLevel ? 'fs-6' : 'fs-5'                             }}" t-esc="title"/>
                    </t>
                </button>
                <button class="o_next btn btn-light flex-grow-0" t-att-class="isLastPrecisionLevel ? 'order-2 btn-sm px-1' : ''" tabindex="-1" t-on-click="next">
                    <i class="oi oi-chevron-right" t-att-title="activePrecisionLevel.nextTitle"/>
                </button>
            </nav>
            <t t-if="state.precision === 'days'">
                <t t-call="web.DateTimePicker.Days"/>
            </t>
            <t t-else="">
                <t t-call="web.DateTimePicker.Grid"/>
            </t>
        </div>
    </t>
<t t-name="web.DateTimePickerPopover">
        <DateTimePicker t-props="props.pickerProps">
            <t t-set-slot="buttons">
                <t t-if="isDateTimeRange">
                    <button class="o_apply btn btn-primary btn-sm h-100 w-100 w-md-auto d-flex align-items-center justify-content-center gap-1" tabindex="-1" t-on-click="props.close">
                        <i class="fa fa-check"/>
                        <span>Apply</span>
                    </button>
                </t>
            </t>
            <t t-set-slot="bottom_left">
                <t t-if="isDateTimeRange">
                    <button class="btn btn-secondary btn-sm h-100 w-100 w-md-auto d-flex align-items-center justify-content-center" tabindex="-1" t-on-click="props.close">
                        <span>Close</span>
                    </button>
                </t>
            </t>
        </DateTimePicker>
    </t>
<t t-name="web.DebugMenu">
        <Dropdown class="'o_debug_manager'" beforeOpen="getElements" position="'bottom-end'" togglerClass="\`o-dropdown--narrow \${env.inDialog?'btn btn-link':''}\`" autoOpen="false">
            <t t-set-slot="toggler">
                <i class="fa fa-bug" role="img" aria-label="Open developer tools"/>
            </t>
            <t t-foreach="elements" t-as="element" t-key="element_index">
                <DropdownItem t-if="element.type == 'item'" onSelected="element.callback" href="element.href">
                    <t t-esc="element.description"/>
                </DropdownItem>
                <div t-if="element.type == 'separator'" role="separator" class="dropdown-divider"/>
                <t t-if="element.type == 'component'" t-component="element.Component" t-props="element.props"/>
            </t>
        </Dropdown>
    </t>

<t t-name="web.DebugMenu.SetDefaultDialog">
        <Dialog title="title">
            <table style="width: 100%">
                <tr>
                    <td>
                        <label for="formview_default_fields" class="oe_label oe_align_right">
                            Default:
                        </label>
                    </td>
                    <td class="oe_form_required">
                        <select id="formview_default_fields" class="o_input" t-model="state.fieldToSet">
                            <option value=""/>
                            <option t-foreach="defaultFields" t-as="field" t-att-value="field.name" t-key="field.name">
                                <t t-esc="field.string"/> = <t t-esc="field.displayed"/>
                            </option>
                        </select>
                    </td>
                </tr>
                <tr t-if="conditions.length">
                    <td>
                        <label for="formview_default_conditions" class="oe_label oe_align_right">
                            Condition:
                        </label>
                    </td>
                    <td>
                        <select id="formview_default_conditions" class="o_input" t-model="state.condition">
                            <option value=""/>
                            <option t-foreach="conditions" t-as="cond" t-att-value="cond.name + '=' + cond.value" t-key="cond.name">
                                <t t-esc="cond.string"/>=<t t-esc="cond.displayed"/>
                            </option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input type="radio" id="formview_default_self" value="self" name="scope" t-model="state.scope"/>
                        <label for="formview_default_self" class="oe_label" style="display: inline;">
                            Only you
                        </label>
                        <br/>
                        <input type="radio" id="formview_default_all" value="all" name="scope" t-model="state.scope"/>
                        <label for="formview_default_all" class="oe_label" style="display: inline;">
                            All users
                        </label>
                    </td>
                </tr>
            </table>
            <t t-set-slot="footer">
                <button class="btn btn-secondary" t-on-click="props.close">Close</button>
                <button class="btn btn-secondary" t-on-click="saveDefault">Save default</button>
            </t>
        </Dialog>
    </t>

    <t t-name="web.DebugMenu.GetMetadataDialog">
        <Dialog title="title">
            <table class="table table-sm table-striped">
                <tr>
                    <th>ID:</th>
                    <td><t t-esc="state.id"/></td>
                </tr>
                <tr>
                    <th>XML ID:</th>
                    <td>
                        <t t-if="state.xmlids.length &gt; 1">
                            <t t-foreach="state.xmlids" t-as="imd" t-key="imd['xmlid']">
                                <div t-att-class="&quot;p-0 &quot; + (imd[&quot;xmlid&quot;] === state.xmlid ? &quot;fw-bolder &quot; : &quot;&quot;) + (imd[&quot;noupdate&quot;] === true ? &quot;fst-italic &quot; : &quot;&quot;)" t-esc="imd['xmlid']"/>
                            </t>
                        </t>
                        <t t-elif="state.xmlid" t-esc="state.xmlid"/>
                        <t t-else="">
                            / <a t-on-click="onClickCreateXmlid"> (create)</a>
                        </t>
                    </td>
                </tr>
                <tr>
                    <th>No Update:</th>
                    <td>
                        <t t-esc="state.noupdate"/>
                        <t t-if="state.xmlid">
                            <a t-on-click="toggleNoupdate"> (change)</a>
                        </t>
                    </td>
                </tr>
                <tr>
                    <th>Creation User:</th>
                    <td><t t-esc="state.creator"/></td>
                </tr>
                <tr>
                    <th>Creation Date:</th>
                    <td><t t-esc="state.createDate"/></td>
                </tr>
                <tr>
                    <th>Latest Modification by:</th>
                    <td><t t-esc="state.lastModifiedBy"/></td>
                </tr>
                <tr>
                    <th>Latest Modification Date:</th>
                    <td><t t-esc="state.writeDate"/></td>
                </tr>
            </table>
        </Dialog>
    </t>

    <t t-name="web.DebugMenu.GetViewDialog">
        <Dialog title="title">
            <pre t-esc="props.arch.outerHTML"/>
            <t t-set-slot="footer">
                <button class="btn btn-primary o-default-button" t-on-click="() =&gt; props.close()">Close</button>
            </t>
        </Dialog>
    </t>
<t t-name="web.DebugMenu.ProfilingItem">
        <DropdownItem class="o_debug_profiling_item_wrapper">
            <div class="o_debug_profiling_item d-flex justify-content-between">
                <div class="align-self-center">
                    <div t-if="profiling.state.isEnabled" class="alert alert-info py-2 me-3">Recording...</div>
                    <span class="o_profiling_switch">
                        <span class="form-check form-switch" t-on-click.stop.prevent="() =&gt; this.profiling.toggleProfiling()">
                            <input type="checkbox" class="form-check-input" id="enable_profiling" t-att-checked="profiling.state.isEnabled"/>
                            <label class="form-check-label">Enable profiling</label>
                        </span>
                    </span>
                    <t t-if="profiling.state.isEnabled">
                        <span class="o_profiling_switch form-check form-switch mt-2" t-on-click.stop.prevent="() =&gt; this.profiling.toggleCollector('sql')">
                            <input type="checkbox" class="form-check-input" id="profile_sql" t-att-checked="profiling.isCollectorEnabled('sql')"/>
                            <label class="form-check-label" for="profile_sql">Record sql</label>
                        </span>
                        <span class="o_profiling_switch form-check form-switch mt-2" t-on-click.stop.prevent="() =&gt; this.profiling.toggleCollector('traces_async')">
                            <input type="checkbox" class="form-check-input" id="profile_traces_async" t-att-checked="profiling.isCollectorEnabled('traces_async')"/>
                            <label class="form-check-label" for="profile_traces_async">Record traces</label>
                        </span>
                        <div t-if="profiling.isCollectorEnabled('traces_async')" class="input-group input-group-sm mt-2" t-on-click.stop.prevent="">
                            <div class="input-group-text">Interval</div>
                            <select class="profile_param form-select" t-on-change="(ev) =&gt; this.changeParam('traces_async_interval', ev)">
                                <t t-set="interval" t-value="profiling.state.params.traces_async_interval"/>
                                <option value="">Default</option>
                                <option value="0.001" t-att-selected="interval === '0.001'">0.001</option>
                                <option value="0.01" t-att-selected="interval === '0.01'">0.01</option>
                                <option value="0.1" t-att-selected="interval === '0.1'">0.1</option>
                                <option value="1" t-att-selected="interval === '1'">1</option>
                            </select>
                        </div>
                        <span t-if="profiling.isCollectorEnabled('sql') || profiling.isCollectorEnabled('traces_async')" class="o_profiling_switch form-check form-switch mt-2" t-on-click.stop.prevent="(ev) =&gt; this.toggleParam('execution_context_qweb', ev)">
                            <input type="checkbox" class="form-check-input" id="profile_execution_context_qweb" t-att-checked="!!profiling.state.params.execution_context_qweb"/>
                            <label class="form-check-label" for="profile_execution_context_qweb">Add qweb directive context</label>
                        </span>
                        <span class="o_profiling_switch form-check form-switch mt-2" t-on-click.stop.prevent="() =&gt; this.profiling.toggleCollector('qweb')">
                            <input type="checkbox" class="form-check-input" id="profile_qweb" t-att-checked="profiling.isCollectorEnabled('qweb')"/>
                            <label class="form-check-label" for="profile_qweb">Record qweb</label>
                        </span>
                    </t>
                </div>
                <a href="#" t-on-click.prevent="openProfiles" t-attf-class="btn btn-light align-self-baseline {{profiling.state.isEnabled ? 'py-2' : ''}}">
                    <i class="o_open_profiling oi oi-launch"/>
                </a>
            </div>
        </DropdownItem>
    </t>

<t t-name="web.ProfilingQwebView">
    <div class="oe_form_field o_ace_view_editor oe_ace_open o_profiling_qweb_view">
        <div class="o_select_view_profiling" t-ref="selector">
            <a role="button" class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" href="#"><MenuItem view="state.view" t-if="state.view"/></a>
            <div class="dropdown-menu" role="menu">
                <t t-foreach="viewObjects" t-as="view" t-key="view_index">
                    <a role="menuitem" href="#" t-att-data-id="view.id" t-on-click.prevent="_onSelectView">
                        <MenuItem view="view"/>
                    </a>
                </t>
            </div>
        </div>
        <div class="ace-view-editor" t-ref="ace"/>
        <small class="text-muted">
            It is possible that the "t-call" time does not correspond to the overall time of the
            template. Because the global time (in the drop down) does not take into account the
            duration which is not in the rendering (look for the template, read, inheritance,
            compilation...). During rendering, the global time also takes part of the time to make
            the profile as well as some part not logged in the function generated by the qweb.
        </small>
    </div>
</t>
<t t-name="web.ProfilingQwebView.menuitem">
    <div class="o_delay"><t t-if="props.view.delay" t-esc="props.view.delay"/> ms</div>
    <div class="o_query"><t t-if="props.view.delay" t-esc="props.view.query"/> query</div>
    <t t-esc="props.view.display_name"/>
    <div class="o_key text-muted">(<t t-esc="props.view.id"/>, <t t-esc="props.view.key"/>)</div>
</t>
<t t-name="web.ProfilingQwebView.hover">
    <div class="o_info o_detail">
        <div class="o_delay"><t t-esc="delay"/> <span>ms</span></div>
        <div class="o_query"><t t-esc="query"/> <span>query</span></div>
    </div>
</t>
<t t-name="web.ProfilingQwebView.info">
    <div class="o_info">
        <div t-if="displayDetail" class="o_more">
            <span>*</span>
            <table class="o_detail">
                <thead>
                    <tr><th/><th>ms</th><th>query</th></tr>
                </thead>
                <tbody>
                    <tr t-foreach="groups" t-as="directive" t-key="directive_index">
                        <td><t t-esc="directive"/></td>
                        <td><t t-esc="groups[directive].delays.join(' ')"/></td>
                        <td><t t-esc="groups[directive].querys.join(' ')"/></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="o_delay"><t t-esc="delay"/></div>
        <div class="o_query"><t t-esc="query"/></div>
    </div>
</t>

<t t-name="web.ProfilingSystrayItem">
        <div class="d-flex align-items-center">
            <i class="fa fa-circle text-danger o_debug_recording"/>
        </div>
    </t>

<t t-name="web.Dialog">
        <div class="o_dialog" t-att-id="id" t-att-class="{ o_inactive_modal: !data.isActive }">
            <div role="dialog" class="modal d-block" tabindex="-1" t-att-class="{ o_technical_modal: props.technical, o_modal_full: isFullscreen, o_inactive_modal: !data.isActive }" t-ref="modalRef">
                <div class="modal-dialog modal-dialog-centered" t-attf-class="modal-{{props.size}}">
                    <div class="modal-content" t-att-class="props.contentClass" t-att-style="contentStyle">
                        <header t-if="props.header" class="modal-header">
                            <t t-slot="header" close="data.close" isFullscreen="isFullscreen">
                                <t t-call="web.Dialog.header">
                                    <t t-set="fullscreen" t-value="isFullscreen"/>
                                </t>
                            </t>
                        </header>

                        <footer t-if="props.footer" class="modal-footer justify-content-around justify-content-md-start flex-wrap gap-1 w-100" style="order:2">
                            <t t-slot="footer" close="() =&gt; this.data.close()">
                                <button class="btn btn-primary o-default-button" t-on-click="() =&gt; this.data.close()">
                                    <t>Ok</t>
                                </button>
                            </t>
                        </footer>
                        <main class="modal-body" t-attf-class="{{ props.bodyClass }} {{ !props.withBodyPadding ? 'p-0': '' }}">
                            <t t-slot="default" close="() =&gt; this.data.close()"/>
                        </main>
                    </div>
                </div>
            </div>
        </div>
    </t>

    <t t-name="web.Dialog.header">
        <t t-if="fullscreen">
            <button class="btn oi oi-arrow-left" data-bs-dismiss="modal" aria-label="Close" t-on-click="dismiss"/>
        </t>
        <h4 class="modal-title text-break" t-att-class="{ 'me-auto': fullscreen }">
            <t t-esc="props.title"/>
        </h4>
        <t t-if="!fullscreen">
            <button type="button" class="btn-close" aria-label="Close" tabindex="-1" t-on-click="dismiss"/>
        </t>
    </t>
<t t-name="web.DomainSelector">
        <div class="o_domain_selector w-100" aria-atomic="true" t-att-class="props.className">
            <t t-if="tree">
                <TreeEditor resModel="props.resModel" tree="tree" update.bind="update" readonly="props.readonly" isDebugMode="props.isDebugMode" defaultCondition="defaultCondition" defaultConnector="props.defaultConnector" getOperatorEditorInfo.bind="getOperatorEditorInfo" getDefaultOperator.bind="getDefaultOperator" getPathEditorInfo.bind="getPathEditorInfo">
                    <CheckBox t-if="showArchivedCheckbox" value="includeArchived" disabled="props.readonly" className="'form-switch'" onChange.bind="toggleIncludeArchived">
                        Include archived
                    </CheckBox>
                </TreeEditor>
            </t>
            <t t-else="">
                <div class="o_domain_selector_row d-flex align-items-center">
                    This domain is not supported.
                    <t t-if="!props.readonly">
                        <button class="btn btn-sm btn-primary ms-2" t-on-click="() =&gt; this.resetDomain()">Reset domain</button>
                    </t>
                </div>
            </t>
            <t t-if="props.isDebugMode and (!tree or !props.readonly)">
                <label class="o_domain_selector_debug_container d-block mt-3 border rounded p-3 bg-100 text-muted font-monospace">
                    <span class="small"># Code editor</span>
                    <textarea class="pt-2 border-0 bg-transparent text-body" type="text" t-att-readonly="props.readonly" spellcheck="false" t-att-value="props.domain" t-on-change="(ev) =&gt; this.onDomainChange(ev.target.value)"/>
                </label>
            </t>
        </div>
    </t>

<t t-name="web.DomainSelectorDialog">
        <Dialog title="dialogTitle">
            <div t-if="props.text" class="mb-3" t-out="props.text"/>
            <DomainSelector t-props="domainSelectorProps"/>
            <t t-set-slot="footer">
                <t t-if="props.readonly">
                    <button class="btn btn-secondary" t-on-click="() =&gt; props.close()">Close</button>
                </t>
                <t t-else="">
                    <button class="btn btn-primary" t-att-disabled="disabled" t-on-click="onConfirm" t-ref="confirm"><t t-esc="confirmButtonText"/></button>
                    <button class="btn btn-secondary" t-on-click="onDiscard"><t t-esc="discardButtonText"/></button>
                </t>
            </t>
        </Dialog>
    </t>

<t t-name="web.AccordionItem">
        <div class="o_accordion position-relative">
            <button class="o_menu_item o_accordion_toggle dropdown-item" tabindex="0" t-att-class="{'selected': props.selected, 'open': state.open}" t-attf-class="{{ props.class }}" t-att-aria-expanded="state.open ? 'true' : 'false'" t-esc="props.description" t-on-click="() =&gt; state.open = !state.open"/>
            <t t-if="state.open">
                <div class="o_accordion_values ms-4 border-start">
                    <t t-slot="default"/>
                </div>
            </t>
        </div>
    </t>

<t t-name="web.Dropdown">
    <div class="o-dropdown dropdown" t-att-class="props.class" t-attf-class="         {{ state.directionCaretClass || ''}}         {{ state.open ? 'show' : ''}}         {{ !showCaret ? 'o-dropdown--no-caret' : '' }}       " t-ref="root">
      <button t-if="props.toggler !== 'parent'" type="button" class="dropdown-toggle" t-attf-class="           {{props.togglerClass || ''}}           {{parentDropdown ? 'dropdown-item' : ''}}         " t-att-disabled="props.disabled" t-on-click.stop="onTogglerClick" t-on-mouseenter="onTogglerMouseEnter" t-att-title="props.title" t-att-data-hotkey="props.hotkey" t-att-data-tooltip="props.tooltip" t-att-tabindex="props.skipTogglerTabbing ? -1 : 0" t-att-aria-expanded="state.open ? 'true' : 'false'" t-ref="togglerRef">
        <t t-slot="toggler" open="state.open"/>
      </button>
      <div t-if="state.open" t-attf-class="           o-dropdown--menu dropdown-menu           {{ parentDropdown ? 'o-dropdown--menu-submenu' : '' }}           {{ props.menuDisplay }}         " t-att-class="props.menuClass" role="menu" t-ref="menuRef" t-on-pointerenter="() =&gt; props.holdOnHover and position.lock()" t-on-pointerleave="() =&gt; props.holdOnHover and position.unlock()" t-on-scroll="props.onScroll">
        <t t-slot="default"/>
      </div>
    </div>
  </t>

<t t-name="web.DropdownItem">
    <t t-tag="props.href ? 'a' : 'span'" t-att-href="props.href" class="dropdown-item" t-att-class="props.class" role="menuitem" t-on-click.stop="onClick" t-att-title="props.title" t-att-data-hotkey="props.hotkey" t-att="dataAttributes" tabindex="0">
      <t t-slot="default"/>
    </t>
  </t>


  <t t-name="web.CheckboxItem">
    <t t-tag="props.href ? 'a' : 'span'" t-att-href="props.href" class="dropdown-item" t-att-class="props.class" role="menuitemcheckbox" t-on-click.stop="onClick" t-att-title="props.title" t-att-data-hotkey="props.hotkey" t-att="dataAttributes" tabindex="0" t-att-aria-checked="props.checked ? 'true' : 'false'">
      <t t-slot="default"/>
    </t>
  </t>


  <t t-name="web.RainbowMan">
        <div class="o_reward position-absolute top-0 bottom-0 start-0 end-0 w-100 h-100" t-att-class="{ o_reward_fading: state.isFading }" t-on-animationend="onAnimationEnd">
            <svg class="o_reward_rainbow_man position-absolute top-0 bottom-0 start-0 end-0 m-auto overflow-visible" viewBox="0 0 400 400">
                <defs>
                    <radialGradient id="o_reward_gradient_bg" cx="200" cy="200" r="200" gradientUnits="userSpaceOnUse">
                        <stop offset="0.3" stop-color="#edeff4"/>
                        <stop offset="1" stop-color="#edeff4" stop-opacity="0"/>
                    </radialGradient>
                    <symbol id="o_reward_star">
                        <path d="M33 15.9C26.3558 13.6951 21.1575 8.4597 19 1.8 19 1.2477 18.5523.8 18 .8 17.4477.8 17 1.2477 17 1.8 14.6431 8.6938 9.0262 13.9736 2 15.9 1.3649 15.9.85 16.4149.85 17.05.85 17.6851 1.3649 18.2 2 18.2 8.6215 20.3845 13.8155 25.5785 16 32.2 16 32.7523 16.4477 33.2 17 33.2 17.5523 33.2 18 32.7523 18 32.2 20.3569 25.3062 25.9738 20.0264 33 18.1 33.6351 18.1 34.15 17.5851 34.15 16.95 34.15 16.3149 33.6351 15.8 33 15.8" fill="#FFFFFF"/>
                    </symbol>
                    <symbol id="o_reward_thumb">
                        <path d="M10 52C6 51 3 48 3 44 2 42 3 39 5 38 3 36 2 34 2 32 2 29 3 27 5 26 3 24 2 21 2 19 2 15 7 12 10 12L23 12C23 11 23 11 23 11L23 10C23 8 24 6 25 4 27 2 29 2 31 2 33 2 35 2 36 4 38 5 39 7 39 10L39 38C39 41 37 45 35 47 32 50 28 51 25 52L10 52 10 52Z" fill="#FBFBFC"/>
                        <polygon fill="#ECF1FF" points="25 11 25 51 5 52 5 12"/>
                        <path d="M31 0C28 0 26 1 24 3 22 5 21 7 21 10L10 10C8 10 6 11 4 12 2 14 1 16 1 19 1 21 1 24 2 26 1 27 1 29 1 32 1 34 1 36 2 38 1 40 0 42 1 45 1 50 5 53 10 54L25 54C29 54 33 52 36 49 39 46 41 42 41 38L41 10C41 4 36 0 31 0M31 4C34 4 37 6 37 10L37 38C37 41 35 44 33 46 31 48 28 49 25 50L10 50C7 49 5 47 5 44 4 41 6 38 9 37L9 37C6 37 5 35 5 32 5 28 6 26 9 26L9 26C6 26 5 22 5 19 5 16 8 14 11 14L23 14C24 14 25 12 25 11L25 10C25 7 28 4 31 4" fill="#A1ACBA"/>
                    </symbol>
                </defs>
                <rect width="400" height="400" fill="url(#o_reward_gradient_bg)"/>
                <g transform="translate(47 45) scale(0.9)" class="o_reward_rainbow">
                    <path d="M270,170a100,100,0,0,0-200,0" class="o_reward_rainbow_line" stroke="#FF9E80" stroke-linecap="round" stroke-width="21" fill="none" stroke-dasharray="600 600" stroke-dashoffset="-600"/>
                    <path d="M290,170a120,120,0,0,0-240,0" class="o_reward_rainbow_line" stroke="#FFE57F" stroke-linecap="round" stroke-width="21" fill="none" stroke-dasharray="600 600" stroke-dashoffset="-600"/>
                    <path d="M310,170a140,140,0,0,0-280,0" class="o_reward_rainbow_line" stroke="#80D8FF" stroke-linecap="round" stroke-width="21" fill="none" stroke-dasharray="600 600" stroke-dashoffset="-600"/>
                    <path d="M330,170a160,160,0,0,0-320,0" class="o_reward_rainbow_line" stroke="#C794BA" stroke-linecap="round" stroke-width="21" fill="none" stroke-dasharray="600 600" stroke-dashoffset="-600"/>
                </g>
                <g transform="translate(80 125)">
                    <use href="#o_reward_star" transform-origin="center" class="o_reward_box o_reward_star_01"/>
                </g>
                <g transform="translate(140 75)">
                    <use href="#o_reward_star" transform-origin="center" class="o_reward_box o_reward_star_02"/>
                </g>
                <g transform="translate(230 90)">
                    <use href="#o_reward_star" transform-origin="center" class="o_reward_box o_reward_star_03"/>
                </g>
                <g transform="translate(275 120)">
                    <use href="#o_reward_star" transform-origin="center" class="o_reward_box o_reward_star_04"/>
                </g>
                <g class="o_reward_face_group o_reward_box" transform-origin="center top">
                    <g class="o_reward_shadow_container o_reward_box">
                        <ellipse class="o_reward_shadow o_reward_box" cx="200" cy="105%" rx="100" ry="6" fill="#000" opacity="0.25" transform-origin="center"/>
                    </g>
                    <g class="o_reward_face_wrap o_reward_box" transform-origin="center">
                        <image class="o_reward_face" x="132" y="125" width="136" height="136" t-attf-href="{{props.imgUrl}}"/>
                    </g>
                    <g transform="translate(258 174)">
                        <use href="#o_reward_thumb" class="o_reward_box o_reward_thumbup" transform-origin="center"/>
                    </g>
                </g>
            </svg>
            <div class="o_reward_rainbow_man o_reward_msg_container position-absolute top-0 bottom-0 start-0 end-0 m-auto">
                <div class="o_reward_face_group h-100 w-75 mx-auto">
                    <svg viewBox="0 0 42 60" preserveAspectRatio="xMinYMax meet" width="37" height="65%" class="overflow-visible position-relative ms-5">
                        <g class="o_reward_box">
                            <use href="#o_reward_thumb" x="-60%" y="0" transform="rotate(-90) scale(1 -1)" transform-origin="center"/>
                        </g>
                    </svg>
                    <div class="o_reward_msg mx-4">
                        <div class="o_reward_msg_card">
                            <div class="o_reward_msg_content text-muted px-3 py-4 bg-view d-inline-block border border-light border-top-0">
                                <t t-if="!props.Component">
                                    <t t-out="props.message"/>
                                </t>
                                <t t-else="" t-component="props.Component" t-props="props.props"/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </t>
<t t-name="web.EmojiPicker">
    <div class="o-EmojiPicker bg-view d-flex flex-column justify-content-center" t-att-class="{ 'align-items-center': emojis.length === 0 }" t-on-click="onClick" t-on-keydown="onKeydown">
        <t t-if="emojis.length === 0">
            <span class="o-EmojiPicker-empty"></span>
            <span class="fs-5 text-muted">Failed to load emojis...</span>
        </t>
        <t t-else="">
            <div class="o-EmojiPicker-search d-flex align-items-center mx-2 mt-2 rounded">
                <span class="d-flex mx-1 w-100 rounded o-active">
                    <t t-call="web.EmojiPicker.searchInput">
                        <t t-if="props.state" t-set="localState" t-value="props.state"/>
                        <t t-else="" t-set="localState" t-value="state"/>
                    </t>
                    <i class="oi oi-search p-2 fs-5 rounded-start-0 rounded-3 o-active" title="Search..." role="img" aria-label="Search..."/>
                </span>
            </div>
            <t t-set="itemIndex" t-value="0"/>
            <div class="o-EmojiPicker-content overflow-auto d-flex flex-grow-1 w-100 flex-wrap align-items-center user-select-none mt-1" t-att-class="getEmojis().length === 0 ? 'flex-column justify-content-center' : 'align-content-start'" t-ref="emoji-grid" t-on-scroll="highlightActiveCategory">
                <t t-if="searchTerm and getEmojis().length === 0" class="d-flex flex-column">
                    <span class="o-EmojiPicker-empty"></span>
                    <span class="fs-5 text-muted">No emoji match your search</span>
                </t>
                <t t-if="recentEmojis.length &gt; 0 and !searchTerm">
                    <t t-call="web.EmojiPicker.section">
                        <t t-set="category" t-value="recentCategory"/>
                    </t>
                    <t t-foreach="recentEmojis" t-as="emoji" t-key="'recent_' + emoji_index">
                        <t t-call="web.EmojiPicker.emoji">
                            <t t-set="emoji" t-value="emoji"/>
                        </t>
                        <t t-set="itemIndex" t-value="itemIndex + 1"/>
                    </t>
                </t>
                <t t-set="current" t-value=""/>
                <t t-foreach="getEmojis()" t-as="emoji" t-key="emoji_index">
                    <t t-if="!searchTerm and current !== emoji.category">
                        <t t-set="current" t-value="emoji.category"/>
                        <t t-set="category" t-value="categories.find(c =&gt; c.name === current)"/>
                        <t t-call="web.EmojiPicker.section">
                            <t t-set="category" t-value="category"/>
                        </t>
                    </t>
                    <t t-elif="searchTerm" t-set="categorySortId" t-value="null"/>
                    <t t-call="web.EmojiPicker.emoji">
                        <t t-set="emoji" t-value="emoji"/>
                    </t>
                    <t t-set="itemIndex" t-value="itemIndex + 1"/>
                </t>
            </div>
            <div class="o-EmojiPicker-navbar d-flex flex-shrink-0 w-100 align-items-center bg-100 overflow-auto border-top">
                <t t-if="recentEmojis.length &gt; 0" t-call="web.EmojiPicker.tab">
                    <t t-set="category" t-value="recentCategory"/>
                </t>
                <t t-foreach="categories" t-as="category" t-key="category.sortId">
                    <t t-call="web.EmojiPicker.tab">
                        <t t-set="category" t-value="category"/>
                    </t>
                </t>
            </div>
        </t>
    </div>
</t>

<t t-name="web.EmojiPicker.tab">
    <span class="o-Emoji text-center p-1 cursor-pointer" t-att-class="{'o-active': category.sortId === state.categoryId}" t-att-title="category.name" t-att-data-id="category.sortId" t-on-click="selectCategory">
        <t t-esc="category.title"/>
    </span>
</t>

<t t-name="web.EmojiPicker.section">
    <span class="w-100 fs-7 p-2 position-sticky top-0 bg-view" t-att-data-category="category.sortId"><span class="o-EmojiPicker-sectionIcon" t-esc="category.title"/><span class="ms-2" t-esc="category.displayName"/></span>
    <span class="o-EmojiPicker-category opacity-100 fs-7 py-2" t-att-data-category="category.sortId"/>
</t>

<t t-name="web.EmojiPicker.emoji">
    <span class="o-Emoji cursor-pointer d-flex justify-content-center rounded" t-att-class="{ 'o-active': state.activeEmojiIndex === itemIndex, 'fs-2': !ui.isSmall, 'fs-1': ui.isSmall }" t-att-title="emoji.name" t-att-data-codepoints="emoji.codepoints" t-att-data-index="itemIndex" t-att-data-category="recentCategory.sortId" t-on-click="selectEmoji">
        <span t-esc="emoji.codepoints"/>
    </span>
</t>

<t t-name="web.EmojiPicker.searchInput">
    <input class="form-control border-0 flex-grow-1 rounded-3 rounded-end-0 o-active" placeholder="Search for an emoji" t-model="localState.searchTerm" t-ref="autofocus" t-att-model="localState.searchTerm" t-on-input="() =&gt; this.state.activeEmojiIndex = 0"/>
</t>

<t t-name="web.WarningDialog">
      <Dialog title="title" size="'md'" contentClass="'o_error_dialog'">
        <div role="alert">
          <p t-esc="message" class="text-prewrap"/>
        </div>
        <t t-set-slot="footer">
          <button class="btn btn-primary o-default-button" t-on-click="props.close">Close</button>
        </t>
      </Dialog>
    </t>

    <t t-name="web.RedirectWarningDialog">
      <Dialog title="title" size="'md'" contentClass="'o_error_dialog'">
        <div role="alert">
          <p t-esc="message" class="text-prewrap"/>
        </div>
        <t t-set-slot="footer">
          <button class="btn btn-primary" t-on-click="onClick" t-esc="buttonText"/>
          <button class="btn btn-secondary" t-on-click="props.close">Close</button>
        </t>
      </Dialog>
    </t>

    <t t-name="web.Error504Dialog">
      <Dialog title="this.constructor.title" size="'md'" contentClass="'o_error_dialog'">
        <div role="alert">
            <p class="text-prewrap">
            The operation was interrupted. This usually means that the current operation is taking too much time.
            </p>
        </div>
        <t t-set-slot="footer">
          <button class="btn btn-primary o-default-button" t-on-click="props.close">Close</button>
        </t>
      </Dialog>
    </t>

    <t t-name="web.SessionExpiredDialog">
      <Dialog title="this.constructor.title" size="'md'" contentClass="'o_error_dialog'">
        <div role="alert">
          <p class="text-prewrap">
            Your Odoo session expired. The current page is about to be refreshed.
          </p>
        </div>
        <t t-set-slot="footer">
          <button class="btn btn-primary o-default-button" t-on-click="onClick">Close</button>
        </t>
      </Dialog>
    </t>

    <t t-name="web.ErrorDialog">
      <Dialog title="this.constructor.title" size="'md'" contentClass="'o_error_dialog'">
         <div role="alert">
          <p class="text-prewrap">
            <p><b>An error occurred</b></p>
            <p>Please use the copy button to report the error to your support service.</p>
          </p>

          <button class="btn btn-link" t-on-click="() =&gt; { state.showTraceback = !state.showTraceback }">See details</button>
          <div t-if="state.showTraceback and (props.name or props.message)" class="alert alert-info bg-100 clearfix" role="alert">
            <code t-if="props.name" t-esc="props.name"/>
            <p t-if="props.message" t-esc="props.message"/>
          </div>
          <div t-if="state.showTraceback" class="alert alert-danger o_error_detail" role="alert">
              <pre t-esc="traceback or props.traceback"/>
          </div>
        </div>
        <t t-set-slot="footer">
          <button class="btn btn-primary o-default-button" t-on-click="props.close">Close</button>
          <button class="btn btn-secondary" t-on-click="onClickClipboard">
            <i class="fa fa-clipboard mr8"/><t>Copy error to clipboard</t>
          </button>
        </t>
      </Dialog>
    </t>

<t t-name="web.ExpressionEditor">
        <div class="o_expression_editor w-100" aria-atomic="true">
            <t t-if="tree">
                <TreeEditor resModel="props.resModel" tree="tree" isDebugMode="isDebugMode" update.bind="update" defaultCondition="defaultCondition" getDefaultOperator.bind="getDefaultOperator" getOperatorEditorInfo.bind="getOperatorEditorInfo" getPathEditorInfo.bind="getPathEditorInfo"/>
            </t>
            <t t-else="">
                This expression is not supported.
                <button t-on-click="() =&gt; this.resetExpression()">Reset expression</button>
            </t>
            <t t-if="isDebugMode">
                <div class="o_expression_editor_debug_container d-block mt-3 border rounded p-3 bg-100 text-muted font-monospace">
                    <span class="small"># Code editor</span>
                    <textarea class="pt-2 border-0 bg-transparent text-body" type="text" spellcheck="false" t-att-value="props.expression" t-on-change="(ev) =&gt; this.onExpressionChange(ev.target.value)"/>
                </div>
            </t>
        </div>
    </t>

<t t-name="web.ExpressionEditorDialog">
        <Dialog title="'Edit Condition'">
            <ExpressionEditor t-props="expressionEditorProps"/>
            <t t-set-slot="footer">
                <button class="btn btn-primary" t-on-click="onConfirm" t-ref="confirm">Confirm</button>
                <button class="btn btn-secondary" t-on-click="onDiscard">Discard</button>
            </t>
        </Dialog>
    </t>

<t t-name="web.FileInput">
        <span class="o_file_input" t-att-class="{ 'd-none': props.hidden, 'show opacity-50 pe-none': state.isDisable}" aria-atomic="true">
            <span t-if="!props.hidden" class="o_file_input_trigger" t-on-click.prevent="onTriggerClicked">
                <t t-slot="default">
                    <button class="btn btn-primary">Choose File</button>
                </t>
            </span>
            <input type="file" name="ufile" class="o_input_file d-none" t-att-multiple="props.multiUpload" t-att-accept="props.acceptedFileExtensions" t-ref="file-input" t-att-disabled="state.isDisable" t-on-change="onFileInputChange"/>
        </span>
    </t>

<t t-name="web.FileUploadProgressBar">
        <div class="position-absolute top-0 start-0 h-100 w-100">
            <div class="o-file-upload-progress-bar-value h-100" t-ref="bar" t-att-style="'width: ' + (this.props.fileUpload.progress * 100) + '%;'"/>
            <span class="position-absolute top-0 end-0 cursor-pointer o-file-upload-progress-bar-abort fa fa-times-circle" title="Cancel Upload" aria-label="Cancel Upload" t-on-click.stop.prevent="onCancel"/>
        </div>
    </t>
<t t-name="web.FileUploadProgressContainer">
        <t t-foreach="Object.values(props.fileUploads)" t-as="fileUpload" t-key="fileUpload.id">
            <t t-if="!props.shouldDisplay || props.shouldDisplay(fileUpload)" t-component="props.Component" fileUpload="fileUpload" selector="props.selector"/>
        </t>
    </t>
<t t-name="web.FileUploadProgressKanbanRecord">
        <t t-set="progressTexts" t-value="getProgressTexts()"/>
        <div class="o_kanban_record d-flex flex-grow-1 flex-md-shrink-1 flex-shrink-0">
            <div class="o_kanban_progress_card o_kanban_attachment position-relative p-0 cursor-pointer">
                <div class="o_kanban_image">
                    <div class="o_kanban_image_wrapper">
                        <div class="o_image o_image_thumbnail" t-att-data-mimetype="props.fileUpload.type"/>
                    </div>
                </div>
                <div class="o_kanban_details">
                    <div class="o_kanban_details_wrapper">
                        <div t-att-title="props.fileUpload.title" t-att-aria-label="props.fileUpload.title" class="o_kanban_record_title">
                            <span t-esc="props.fileUpload.title"/>
                        </div>
                        <div class="o_kanban_record_body"/>
                        <div class="o_kanban_record_bottom">
                            <div class="oe_kanban_bottom_left">
                                <div class="o_file_upload_progress_text_left" t-esc="progressTexts.left"/>
                            </div>
                            <div class="oe_kanban_bottom_right">
                                <span class="o_file_upload_progress_text_right" t-esc="progressTexts.right"/>
                            </div>
                        </div>
                    </div>
                </div>
                <FileUploadProgressBar fileUpload="props.fileUpload"/>
            </div>
        </div>
    </t>

    <t t-name="web.FileUploadProgressDataRow">
        <t t-set="progressTexts" t-value="getProgressTexts()"/>
        <div class="o_data_row o_list_progress_card position-relative align-middle p-0">
            <span class="o_file_upload_upload_title" t-esc="props.fileUpload.title"/>
            <span class="o_file_upload_progress_text_left" t-esc="progressTexts.left"/>
            <span class="o_file_upload_progress_text_right" t-esc="progressTexts.right"/>
            <FileUploadProgressBar fileUpload="props.fileUpload"/>
        </div>
    </t>

<t t-name="web.FileViewer">
        <div class="d-flex justify-content-center" t-att-class="{ 'modal fixed-top bottom-0': props.modal }">
            <div class="o-FileViewer flex-column align-items-center d-flex w-100 h-100" tabindex="0" t-ref="autofocus" t-on-keydown.stop="(ev) =&gt; this.onKeydown(ev)">
                <div class="o-FileViewer-header position-absolute top-0 d-flex w-100 bg-black-75 text-400" t-on-click.stop="">
                    <div t-if="isViewable" class="d-flex align-items-center ms-4 me-2">
                        <i t-if="state.file.isImage" class="fa fa-picture-o" role="img" title="Image"/>
                        <i t-if="state.file.isPdf" class="fa fa-file-text" role="img" title="PDF file"/>
                        <i t-if="state.file.isText" class="fa fa-file-text" role="img" title="Text file"/>
                        <i t-if="state.file.isVideo" class="fa fa-video-camera" role="img" title="Video"/>
                    </div>
                    <div class="d-flex align-items-center mx-2 overflow-auto">
                        <span class="text-truncate" t-out="state.file.displayName"/>
                    </div>
                    <div class="flex-grow-1"/>
                    <div class="o-FileViewer-download o-FileViewer-headerButton d-flex align-items-center px-3 cursor-pointer" role="button" title="Download" t-on-click.stop="">
                        <a t-att-href="state.file.downloadUrl" class="text-reset" download="">
                            <i class="fa fa-download fa-fw" role="img"/>
                            <span>Download</span>
                        </a>
                    </div>

                    <div t-on-click.stop="close" class="o-FileViewer-headerButton d-flex align-items-center mb-0 px-3 h4 text-reset cursor-pointer" role="button" title="Close (Esc)" aria-label="Close">
                        <i class="fa fa-fw fa-times" role="img"/>
                    </div>
                </div>
                <div t-on-click.stop="close" t-on-mousemove="onMousemoveView" class="o-FileViewer-main position-absolute top-0 bottom-0 start-0 end-0 align-items-center justify-content-center d-flex" t-att-class="{ 'o_with_img overflow-hidden': state.file.isImage }">
                    <div t-if="state.file.isImage" class="o-FileViewer-zoomer position-absolute align-items-center justify-content-center d-flex w-100 h-100" t-ref="zoomer">
                        <div t-if="!state.imageLoaded" class="position-absolute">
                            <i class="fa fa-3x fa-circle-o-notch fa-fw fa-spin text-white" role="img" title="Loading"/>
                        </div>
                        <img t-on-click.stop="" t-on-load="onImageLoaded" t-on-wheel="onWheelImage" t-on-mousedown.stop="onMousedownImage" t-on-mouseup.stop="onMouseupImage" class="o-FileViewer-view o-FileViewer-viewImage mw-100 mh-100 transition-base" t-att-src="state.file.defaultSource" t-att-style="imageStyle" draggable="false" alt="Viewer" t-ref="image"/>
                    </div>
                    <iframe t-if="state.file.isPdf" class="o-FileViewer-view w-75 h-100 border-0" t-ref="iframeViewerPdf" t-att-class="{ 'w-100': ui.isSmall }" t-att-src="state.file.defaultSource"/>
                    <iframe t-if="state.file.isText" class="o-FileViewer-view o-isText o_text w-75 h-100 border-0" t-att-src="state.file.defaultSource"/>
                    <iframe t-if="state.file.isUrlYoutube" allow="autoplay; encrypted-media" class="o-FileViewer-view w-75 h-100 border-0" t-att-src="state.file.defaultSource" height="315" width="560"/>
                    <video t-if="state.file.isVideo" class="o-FileViewer-view w-75 h-75" t-att-class="{ 'w-100 h-100': ui.isSmall }" t-on-click.stop="" controls="controls">
                        <source t-att-data-type="state.file.mimetype" t-att-src="state.file.defaultSource"/>
                    </video>
                </div>
                <div t-if="state.file.isImage" class="position-absolute bottom-0 d-flex" role="toolbar">
                    <div class="o-FileViewer-toolbarButton p-3 rounded-0" t-on-click.stop="zoomIn" title="Zoom In (+)" role="button">
                        <i class="fa fa-fw fa-plus" role="img"/>
                    </div>
                    <div class="o-FileViewer-toolbarButton p-3 rounded-0" t-att-class="{ 'o_disabled opacity-50': state.scale === 1 }" t-on-click.stop="resetZoom" role="button" title="Reset Zoom (0)">
                        <i class="fa fa-fw fa-search" role="img"/>
                    </div>
                    <div class="o-FileViewer-toolbarButton p-3 rounded-0" t-att-class="{ 'o_disabled opacity-50': state.scale === minScale }" t-on-click.stop="zoomOut" title="Zoom Out (-)" role="button">
                        <i class="fa fa-fw fa-minus" role="img"/>
                    </div>
                    <div class="o-FileViewer-toolbarButton p-3 rounded-0" t-on-click.stop="rotate" title="Rotate (r)" role="button">
                        <i class="fa fa-fw fa-repeat" role="img"/>
                    </div>
                    <div class="o-FileViewer-toolbarButton p-3 rounded-0" t-on-click.stop="onClickPrint" title="Print" role="button">
                        <i class="fa fa-fw fa-print" role="img"/>
                    </div>
                    <div class="o-FileViewer-download o-FileViewer-toolbarButton p-3 rounded-0 cursor-pointer" title="Download" role="button" t-on-click.stop="">
                        <a t-att-href="state.file.downloadUrl" class="text-reset" download="">
                            <i class="fa fa-download fa-fw" role="img"/>
                        </a>
                    </div>
                </div>
                <t t-if="props.files.length &gt; 1">
                    <div class="o-FileViewer-navigation position-absolute top-0 bottom-0 start-0 align-items-center justify-content-center d-flex my-auto ms-3 rounded-circle" t-on-click.stop="previous" title="Previous (Left-Arrow)" aria-label="Previous" role="button">
                        <span class="oi oi-chevron-left" role="img"/>
                    </div>
                    <div class="o-FileViewer-navigation position-absolute top-0 bottom-0 end-0 align-items-center justify-content-center d-flex my-auto me-3 rounded-circle" t-on-click.stop="next" title="Next (Right-Arrow)" aria-label="Next" role="button">
                        <span class="oi oi-chevron-right" role="img"/>
                    </div>
                </t>
            </div>
        </div>
    </t>

<t t-name="web.InstallPrompt">
        <Dialog contentClass="'o_install_prompt position-fixed px-2 py-3 m-2'" size="'md'" footer="false">
            <t t-set-slot="header">
                <div class="d-flex w-100">
                    <h4>How to get the application</h4>
                    <div t-on-click="onClose" type="button" class="btn-close" aria-label="Close"/>
                </div>
            </t>
            <p>Install Odoo on your device to access it easily. Here are the steps to follow:</p>
            <t t-if="isMobileSafari">
                <ul class="list-group list-group-numbered">
                    <li>
                        Tap on the share icon
                    </li>
                    <li>
                        Select "Add to home screen"
                    </li>
                </ul>
            </t>
            <t t-else="">
                <ul class="list-group list-group-numbered">
                    <li>
                        Open "File" menu from your browser
                    </li>
                    <li>
                        Select "Add to dock"
                    </li>
                </ul>
            </t>
        </Dialog>
    </t>
<t t-name="web._ModelFieldSelector">
        <div class="o_model_field_selector d-flex" aria-atomic="true" t-att-class="props.readonly ? 'o_read_mode' : 'o_edit_mode o_input'" t-on-click="(ev) =&gt; this.openPopover(ev.currentTarget)">
            <div class="o_model_field_selector_value flex-grow-1 h-100" tabindex="0" t-att-data-tooltip="state.displayNames.join(' &gt; ')" data-tooltip-position="top">
                <t t-foreach="state.displayNames" t-as="displayName" t-key="displayName_index">
                    <t t-if="!displayName_first">
                        <i class="oi oi-chevron-right m-1" role="img" aria-label="Followed by" title="Followed by"/>
                    </t>
                    <span t-attf-class="o_model_field_selector_chain_part mb-1 #{props.readonly ? 'border-0 fw-bolder' : 'px-1'} text-nowrap">
                        <t t-esc="displayName"/>
                    </span>
                </t>
            </div>
            <div t-if="!props.readonly and state.isInvalid" class="o_model_field_selector_controls ms-2" tabindex="0">
                <i class="fa fa-exclamation-triangle text-warning o_model_field_selector_warning" role="alert" aria-label="Invalid field chain" title="Invalid field chain"/>
            </div>
            <div t-if="!props.readonly and props.allowEmpty and state.displayNames.length" class="o_model_field_selector_controls ms-2" tabindex="0">
                <i class="fa fa-times" t-on-click.stop="clear" aria-label="Clear" title="Clear"/>
            </div>
        </div>
    </t>

<t t-name="web.ModelFieldSelectorPopover">
        <div class="o_model_field_selector_popover" tabindex="0" t-ref="root" t-on-keydown="onInputKeydown">
            <div class="o_model_field_selector_popover_header text-center">
                <t t-if="state.page.previousPage">
                    <i class="oi oi-arrow-left o_model_field_selector_popover_option o_model_field_selector_popover_prev_page" title="Previous" role="img" aria-label="Previous" t-on-click="() =&gt; this.goToPreviousPage()"/>
                </t>
                <div class="o_model_field_selector_popover_title">
                    <t t-esc="state.page.title"/>
                </div>
                <i class="fa fa-times o_model_field_selector_popover_option o_model_field_selector_popover_close" title="Close" role="img" aria-label="Close" t-on-click="props.close"/>
                <t t-if="props.showSearchInput">
                    <div class="o_model_field_selector_popover_search mt-2">
                        <input type="text" placeholder="Search..." class="o_input p-1 border rounded-1 bg-view" t-att-value="state.page.query" t-on-input="(ev) =&gt; this.debouncedSearchFields(ev.target.value)"/>
                    </div>
                </t>
            </div>
            <div class="o_model_field_selector_popover_body">
                <ul class="o_model_field_selector_popover_page">
                    <t t-foreach="state.page.fieldNames" t-as="fieldName" t-key="fieldName">
                        <t t-set="fieldDef" t-value="state.page.fieldDefs[fieldName]"/>
                        <li class="o_model_field_selector_popover_item d-flex border-bottom" t-att-class="{ 'active': fieldName === state.page.focusedFieldName }" t-att-data-name="fieldName">
                            <button class="o_model_field_selector_popover_item_name btn btn-light flex-fill rounded-0 text-start" t-on-click="() =&gt; this.selectField(fieldDef)">
                                <t t-esc="fieldDef.string"/>
                                <t t-if="fieldDef.record_name"> (<t t-esc="fieldDef.record_name"/>)</t>
                                <div t-if="props.isDebugMode" class="text-muted o_model_field_selector_popover_item_title"><t t-esc="fieldName"/> (<t t-esc="fieldDef.type"/>)</div>
                            </button>
                            <t t-if="(!fieldDef.is_property and fieldDef.relation and props.followRelations) or fieldDef.type === 'properties'">
                                <button class="o_model_field_selector_popover_item_relation btn btn-light border-0 border-start rounded-0" t-on-click.stop="() =&gt; this.followRelation(fieldDef)">
                                    <i class="oi oi-chevron-right o_model_field_selector_popover_relation_icon" role="img" aria-label="Relation to follow" title="Relation to follow"/>
                                </button>
                            </t>
                        </li>
                    </t>
                </ul>
            </div>
            <t t-if="showDebugInput">
                <div class="o_model_field_selector_popover_footer">
                    <input type="text" class="o_model_field_selector_debug o_input" t-att-value="state.page.path" t-on-change="(ev) =&gt; this.loadNewPath(ev.target.value)" t-on-keydown="onDebugInputKeydown" t-on-input="(ev) =&gt; this.props.update(ev.target.value, true)"/>
                </div>
            </t>
        </div>
    </t>

<t t-name="web.ModelSelector">
        <div class="o_model_selector" t-ref="autocomplete_container">
            <input t-if="env.isSmall" type="text" class="o_input" readonly="" t-att-id="props.id" t-att-value="props.value"/>
            <AutoComplete t-else="" id="props.id" value="props.value || ''" sources="sources" placeholder="placeholder" autoSelect="props.autoSelect" onSelect.bind="onSelect"/>
            <span class="o_dropdown_button"/>
        </div>
    </t>
<t t-name="web.Notebook">
        <div t-attf-class="o_notebook d-flex w-100 {{ props.orientation === 'horizontal' ? 'horizontal flex-column' : 'vertical flex-row' }} {{ props.className }}" t-if="state.currentPage">
            <div class="o_notebook_headers" t-att-class="{ 'm-0': props.orientation === 'vertical' }">
                <ul t-attf-class="nav nav-tabs {{ props.orientation === 'horizontal' ? 'flex-row flex-nowrap' : 'flex-column p-0' }}">
                    <li t-foreach="navItems" t-as="navItem" t-key="navItem[0]" class="nav-item flex-nowrap cursor-pointer" t-if="navItem[1].isVisible" t-attf-class="{{ navItem[1].isDisabled ? 'disabled' : '' }}">
                        <a class="nav-link" t-attf-class="{{ navItem[0] === state.currentPage ? 'active' : '' }} {{ props.orientation === 'vertical' ? 'p-3 rounded-0' : '' }} {{ navItem[1].className || '' }}" t-att-name="navItem[1].name" t-on-click.prevent="() =&gt; this.activatePage(navItem[0])" href="#" role="tab" tabindex="0">
                            <i t-if="props.icons and props.icons[navItem[0]]" t-attf-class="fa {{ props.icons[navItem[0]] }} me-2"/>
                            <t t-esc="navItem[1].title"/>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="o_notebook_content tab-content">
                <div class="tab-pane active" t-ref="activePane">
                    <t t-if="page" t-component="page.Component" t-key="state.currentPage" t-props="page.props"/>
                    <t t-else="" t-slot="{{ state.currentPage }}"/>
                </div>
            </div>
        </div>
    </t>

<t t-name="web.NotificationWowl">
        <div t-on-mouseenter="this.props.freeze" t-on-mouseleave="this.props.refresh" t-attf-class="o_notification {{props.className}} border border-{{props.type}} mb-2 position-relative" role="alert" aria-live="assertive" aria-atomic="true">
            <strong t-if="props.title" t-attf-class="o_notification_title d-block text-{{props.type}} py-2 ps-3 pe-5" t-out="props.title"/>
            <button type="button" class="o_notification_close btn" aria-label="Close" t-on-click="props.close">
                <i class="oi oi-close"/>
            </button>
            <div t-attf-class="o_notification_body ps-3 pe-5 py-2">
                <div t-if="props.message" class="me-auto o_notification_content" t-out="props.message"/>
                <div t-if="props.buttons.length" class="o_notification_buttons d-flex gap-2 mt-2">
                    <button t-foreach="props.buttons" t-as="button" type="button" t-key="button_index" t-attf-class="btn {{button.primary ? 'btn-primary' : 'btn-secondary'}}" t-on-click="button.onClick">
                    <t t-if="button.icon">
                        <i t-if="button.icon.indexOf('fa-') === 0" role="img" t-att-aria-label="button.name" t-att-title="button.name" t-attf-class="fa fa-fw o_button_icon {{button.icon}}"/>
                        <img t-else="" t-att-src="button.icon" t-att-alt="button.name"/>
                    </t>
                    <span t-esc="button.name"/>
                </button>
                </div>
            </div>
        </div>
    </t>

<t t-name="web.OverlayContainer">
        <div class="o-overlay-container">
            <t t-foreach="sortedOverlays" t-as="overlay" t-key="overlay.id">
                <ErrorHandler onError="(error) =&gt; this.handleError(overlay, error)">
                    <t t-component="overlay.component" t-props="overlay.props"/>
                </ErrorHandler>
            </t>
        </div>
    </t>

<t t-name="web.Pager">
        <nav class="o_pager d-flex gap-2 h-100" aria-label="Pager">
            <span class="o_pager_counter align-self-center" t-on-click.stop="">
                <t t-if="state.isEditing">
                    <input type="text" class="o_pager_value o_input d-inline-block w-auto text-end mb-n1" size="7" t-ref="autofocus" t-att-value="value" t-on-blur="onInputBlur" t-on-change="onInputChange" t-on-keydown.stop="onInputKeydown"/>
                </t>
                <t t-else="">
                    <span class="o_pager_value d-inline-block border-bottom border-transparent mb-n1" t-esc="value" t-on-click="onValueClick"/>
                </t>
                <span> / </span>
                <t t-if="props.updateTotal">
                    <span class="o_pager_limit o_pager_limit_fetch" t-att-class="{ 'disabled': state.isDisabled }" t-on-click.stop="updateTotal"><t t-esc="props.total"/>+</span>
                </t>
                <t t-else="">
                    <span class="o_pager_limit" t-esc="props.total"/>
                </t>
            </span>
            <span class="btn-group d-print-none" aria-atomic="true">

                <button type="button" class="oi oi-chevron-left btn btn-secondary o_pager_previous px-2 rounded-start" aria-label="Previous" data-tooltip="Previous" tabindex="-1" t-att-data-hotkey="props.withAccessKey ? 'p' : false" t-att-disabled="state.isDisabled or isSinglePage" t-on-click.stop="() =&gt; this.navigate(-1)"/>
                <button type="button" class="oi oi-chevron-right btn btn-secondary o_pager_next px-2 rounded-end" aria-label="Next" data-tooltip="Next" tabindex="-1" t-att-data-hotkey="props.withAccessKey ? 'n' : false" t-att-disabled="state.isDisabled or isSinglePage" t-on-click.stop="() =&gt; this.navigate(1)"/>
            </span>
        </nav>
    </t>

<t t-name="web.PopoverWowl">
        <div role="tooltip" class="o_popover popover mw-100" t-att-class="props.class" t-ref="ref">
            <t t-slot="default"/>
            <div t-if="props.arrow" class="popover-arrow"/>
        </div>
    </t>

<t t-name="web.MultiRecordSelector">
        <div class="o_input d-flex flex-wrap gap-1 o_multi_record_selector" t-ref="multiRecordSelector">
            <TagsList tags="tags"/>
            <RecordAutocomplete resModel="props.resModel" value="''" domain="props.domain" context="props.context" className="'flex-grow-1'" fieldString="props.fieldString" placeholder="placeholder" multiSelect="true" getIds.bind="getIds" update.bind="update"/>
        </div>
    </t>

<t t-name="web.RecordAutocomplete">
        <AutoComplete placeholder="props.placeholder" value="props.value" autoSelect="true" resetOnSelect="props.multiSelect" class="props.className" sources="sources" onSelect.bind="onSelect" onChange.bind="onChange"/>
    </t>

<t t-name="web.RecordSelector">
        <RecordAutocomplete resModel="props.resModel" value="displayName" domain="props.domain" context="props.context" className="'h-100 o_record_selector'" fieldString="props.fieldString" placeholder="props.placeholder" multiSelect="false" getIds="() =&gt; []" update.bind="update"/>
    </t>

<t t-name="web_studio.ResizablePanel">
        <div class="o_resizable_panel d-flex flex-column" t-att-class="class" t-ref="containerRef">
            <t t-slot="default"/>
            <div class="o_resizable_panel_handle position-absolute top-0 bottom-0 end-0" t-att-class="props.handleSide === 'start' ? 'start-0' : 'end-0'" t-ref="handleRef"/>
        </div>
    </t>

<t t-name="web.SelectMenu">
        <Dropdown class="\`o_select_menu border w-auto rounded-2 overflow-hidden \${props.class || ''}\`" togglerClass="\`o_select_menu_toggler btn w-100 bg-light \${props.togglerClass || ''} \${canDeselect ? 'o_can_deselect' : ''}\`" menuClass="\`o_select_menu_menu\${props.searchable ? ' py-0' : ''}\${props.multiSelect ? ' o_select_menu_multi_select' : ''} border\`" position="'bottom-fit'" beforeOpen.bind="onBeforeOpen" onScroll.bind="onScroll" onStateChanged.bind="onStateChanged">
            <t t-set-slot="toggler">
                <t t-if="props.multiSelect">
                    <div class="text-wrap text-start">
                        <TagsList tags="multiSelectChoices"/>
                    </div>
                </t>
                <t t-else="">
                    <span class="o_select_menu_toggler_slot text-start text-truncate">
                        <t t-if="!props.slots or !props.slots.default" t-esc="displayValue"/>
                        <t t-else="" t-slot="default"/>
                    </span>
                    <span t-if="canDeselect" t-on-click.stop="() =&gt; this.props.onSelect(null)" class="o_select_menu_toggler_clear p-0 m-0">
                        <i class="fa fa-times"/>
                    </span>
                </t>
                <span class="o_select_menu_toggler_caret p-0 m-0">
                    <i class="fa fa-caret-down"/>
                </span>
            </t>
            <input t-if="props.searchable" type="text" class="dropdown-item o_select_menu_sticky px-3 py-3 position-sticky top-0 start-0 border-bottom" t-ref="inputRef" t-on-input="debouncedOnInput" t-on-keydown="onSearchKeydown" t-att-placeholder="props.searchPlaceholder" autocomplete="selectMenuAutocompleteOff" autocorrect="off" spellcheck="false"/>
            <t t-if="state.choices.length === 0">
                <span class="text-muted fst-italic ms-3">No result found</span>
            </t>
            <t t-foreach="state.displayedOptions" t-as="choice" t-key="choice_index">
                <t t-call="{{ this.constructor.choiceItemTemplate }}">
                    <t t-set="choice" t-value="choice"/>
                </t>
            </t>
            <t t-if="props.slots and props.slots.bottomArea" t-slot="bottomArea" data="state"/>
        </Dropdown>
    </t>

    <t t-name="web.SelectMenu.ChoiceItem">
        <div t-if="choice.isGroup" class="o_select_menu_group sticky-top bg-light px-3 mt-2 fst-italic fw-bolder user-select-none">
            <span t-esc="choice.label"/>
            <hr class="mt-2 mb-1"/>
        </div>
        <DropdownItem t-if="!choice.isGroup" onSelected="() =&gt; this.onItemSelected(choice.value)" class="getItemClass(choice) + ' d-flex align-items-center'">
            <t t-if="props.slots and props.slots.choice" t-slot="choice" data="choice"/>
            <t t-else="">
                <div class="o_select_menu_item_label text-wrap" t-esc="choice.label || choice.value"/>
            </t>
        </DropdownItem>
    </t>

<t t-name="web.sign_svg_text" name="SVG Signature Text">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" t-att-width="width" t-att-height="height">
            <defs>
                <style type="text/css">
                    @font-face {
                        font-family: "font";
                        src: url(data:font/ttf;base64,<t t-esc="font"/>) format("woff");
                        font-weight: normal;
                        font-style: normal;
                    }
                </style>
            </defs>

            <text t-esc="text" x="50%" t-att-y="height * 3 / 5" t-att-font-size="height * 3 / 5" t-att-textLength="width * 4 / 5 * (type === 'signature' ? Math.min(1, text.length / 7) : 1)" t-att-lengthAdjust="'spacing' + (type === 'signature' ? 'AndGlyphs' : '')" t-attf-style="font-family:'font'; stroke: none; fill: {{color}};" text-anchor="middle"/>
        </svg>
    </t>


    <t t-name="web.NameAndSignature">
        <div class="o_web_sign_name_and_signature">
            <div t-if="!props.noInputName" class="o_web_sign_name_group">
                <label class="col-form-label" t-att-for="'o_web_sign_name_input_' + htmlId">Full Name</label>
                <input type="text" name="signer" t-att-id="'o_web_sign_name_input_' + htmlId" class="o_web_sign_name_input form-control" t-on-input="onInputSignName" t-att-value="props.signature.name" t-ref="signNameInput" placeholder="Type your name to sign" required=""/>
            </div>


            <div t-if="state.showSignatureArea" class="o_web_sign_signature_group bg-100 card mt-3" style="overflow: hidden;">
                <div class="card-header bg-transparent">
                    <div class="row g-0">
                        <div t-if="!props.noInputName or defaultName" class="col-auto">
                            <a role="button" href="#" t-on-click.prevent="onClickSignAuto" t-attf-class="o_web_sign_auto_button me-2 btn btn-light {{ state.signMode === 'auto' ? 'active': '' }}">
                                Auto
                            </a>
                        </div>
                        <div class="col-auto">
                            <a role="button" href="#" t-on-click.prevent="() =&gt; this.setMode('draw')" t-attf-class="o_web_sign_draw_button me-2 btn btn-light {{ state.signMode === 'draw' ? 'active': '' }}">
                                Draw
                            </a>
                        </div>
                        <div class="col-auto">
                            <a role="button" href="#" t-on-click.prevent="onClickSignLoad" t-attf-class="o_web_sign_load_button me-2 btn btn-light {{ state.signMode === 'load' ? 'active': '' }}">
                                Load
                            </a>
                        </div>

                        <div class="col-auto division ms-auto"/>

                        <Dropdown t-if="state.signMode === 'auto'" class="'o_web_sign_auto_select_style col-auto'" showCaret="true" togglerClass="'btn btn-link fa fa-font'">
                            <t t-foreach="fonts" t-as="font" t-key="font_index">
                                <DropdownItem onSelected="() =&gt; this.onSelectFont(font_index)">
                                    <img class="img-fluid" t-att-src="getSVGTextFont(font)"/>
                                </DropdownItem>
                            </t>
                        </Dropdown>

                        <div t-if="state.signMode === 'draw'" t-attf-class="o_web_sign_draw_clear col-auto">
                            <a role="button" href="#" t-on-click.prevent="onClickSignDrawClear" class="btn btn-link fa fa-trash"/>
                        </div>

                        <div t-if="state.signMode === 'load'" class="o_web_sign_load_file col-auto">
                            <button type="button" id="loadFileXml" t-on-click="uploadFile" class="btn btn-link fa fa-upload"/>
                            <input t-ref="signInputLoad" type="file" role="button" name="files[]" class="d-none" t-on-change="onChangeSignLoadInput"/>
                        </div>
                    </div>
                </div>

                <div class="o_signature_stroke position-absolute"/>

                <div t-if="state.showSignatureArea" t-ref="signature" t-att-style="signatureStyle" class="o_web_sign_signature p-0 bg-transparent position-relative"/>

                <div t-if="loadIsInvalid" t-attf-class="o_web_sign_load_invalid card-footer d-none">
                    <div class="alert alert-danger mb-0" role="alert">
                        This file is invalid. Please select an image.
                    </div>
                </div>
            </div>
        </div>
    </t>
<t t-name="web.SignatureDialog">
      <Dialog title="title">
         <div>
            <NameAndSignature t-props="nameAndSignatureProps"/>
            <div class="mt16 small">By clicking Adopt &amp; Sign, I agree that the chosen signature/initials will be a valid electronic representation of my hand-written signature/initials for all purposes when it is used on documents, including legally binding contracts.</div>
        </div>
        <t t-set-slot="footer">
          <button class="btn btn-primary" t-att-disabled="signature.isSignatureEmpty" t-on-click="onClickConfirm">Adopt &amp; Sign</button>
          <button class="btn btn-secondary" t-on-click="props.close">Cancel</button>
        </t>
      </Dialog>
    </t>

<t t-name="web.TagsList">
        <t t-foreach="visibleTags" t-as="tag" t-key="tag.id or tag_index">
            <span class="o_tag position-relative d-inline-flex align-items-center user-select-none mw-100" t-att-class="{                     'o_avatar opacity-trigger-hover' : tag.img,                     'o_badge badge rounded-pill lh-1': !tag.img,                 }" t-attf-class="{{ !tag.img ? 'o_tag_color_' + (tag.colorIndex ? tag.colorIndex : '0') : '' }}" tabindex="-1" t-att-data-color="tag.colorIndex" t-att-title="tag.text" t-on-click="(ev) =&gt; tag.onClick and tag.onClick(ev)" t-on-keydown="tag.onKeydown">


                <span t-if="tag.img and props.displayText and tag.onDelete" class="o_avatar_backdrop position-absolute top-0 end-0 bottom-0 start-0 ms-n2 mt-n1 mb-n1 bg-view rounded border shadow opacity-0 opacity-100-hover"/>

                <img t-if="tag.img" t-att-src="tag.img" class="o_avatar o_m2m_avatar position-relative rounded" t-att-class="tag.imageClass"/>

                <i t-if="tag.icon" t-attf-class="p-1 fa {{ tag.icon }}" t-att-class="tag.className"/>

                <div t-if="props.displayText" class="o_tag_badge_text text-truncate" t-att-class="{'position-relative ms-1' : tag.img}" t-out="tag.text"/>

                <a t-if="tag.onDelete" t-on-click.stop.prevent="(ev) =&gt; tag.onDelete and tag.onDelete(ev)" class="o_delete d-flex align-items-center opacity-100-hover" t-att-class="{                             'btn btn-link position-relative py-0 px-1 text-danger opacity-0': tag.img,                             'ps-1 opacity-75': !tag.img                         }" title="Delete" aria-label="Delete" tabIndex="-1" href="#">
                        <i class="oi oi-close align-text-top"/>
                </a>
            </span>
        </t>
        <span t-if="props.tags and otherTags.length" class="o_m2m_avatar_empty rounded-circle text-center fw-bold" data-tooltip-template="web.TagsList.Tooltip" data-tooltip-position="right" t-att-data-tooltip-info="tooltipInfo">
            <span t-if="otherTags.length &gt; 9" t-esc="'9+'"/>
            <span t-else="" t-esc="'+' + otherTags.length"/>
        </span>
    </t>

    <t t-name="web.TagsList.Tooltip">
        <t t-foreach="tags" t-as="tag" t-key="tag.id">
            <div t-esc="tag.text"/>
        </t>
    </t>

<t t-name="web.Tooltip">
        <div class="o-tooltip tooltip-inner text-start">
            <t t-if="props.template" t-call="{{props.template}}" t-call-context="{ env, ...props.info }"/>
            <span t-else="" t-esc="props.tooltip"/>
        </div>
    </t>

<t t-name="web.TreeEditor">
        <div class="o_tree_editor w-100" aria-atomic="true" t-att-class="className">
            <div t-attf-class="o_tree_editor_node d-flex flex-column #{props.readonly ? 'gap-2' : 'gap-1'}">
                <t t-set="node" t-value="tree"/>
                <div class="o_tree_editor_row d-flex align-items-center">
                    <div class="o_tree_editor_connector d-flex flex-grow-1 align-items-center">
                        <t t-if="node.children.length">
                            <span>Match</span>
                            <t t-if="node.children.length &gt; 1">
                                <t t-call="web.TreeEditor.connector.dropdown"/>
                            </t>
                            <t t-else="">
                                <span class="px-1">
                                    <t t-call="web.TreeEditor.connector.title"/>
                                </span>
                            </t>
                            <span>of the following rules:</span>
                        </t>
                        <t t-else="">
                            <span>Match <strong>all records</strong></span>
                        </t>
                    </div>
                    <t t-slot="default"/>
                </div>
                <t t-if="node.children.length" t-call="web.TreeEditor.connector.children"/>
                <t t-if="!props.readonly">
                    <div class="o_tree_editor_row d-flex align-items-center">
                        <a href="#" role="button" t-on-click="() =&gt; this.insertRootLeaf(node)">New Rule</a>
                    </div>
                </t>
            </div>
        </div>
    </t>

    <t t-name="web.TreeEditor.controls">
        <div class="o_tree_editor_node_control_panel d-flex" role="toolbar" aria-label="Domain node">
            <button class="btn px-2 fs-4" role="button" title="Add New Rule" aria-label="Add New Rule" t-on-click="() =&gt; this.insertLeaf(parent, node)" t-on-mouseenter="(ev) =&gt; this.highlightNode(ev.target, true)" t-on-mouseleave="(ev) =&gt; this.highlightNode(ev.target, false)">
                <i class="fa fa-plus"/>
            </button>
            <button class="btn px-2 fs-4" role="button" title="Add branch" aria-label="Add branch" t-on-click="() =&gt; this.insertBranch(parent, node)" t-on-mouseenter="(ev) =&gt; this.highlightNode(ev.target, true)" t-on-mouseleave="(ev) =&gt; this.highlightNode(ev.target, false)">
                <i class="fa fa-sitemap"/>
            </button>
            <button class="btn btn-link px-2 text-danger fs-4" role="button" title="Delete node" aria-label="Delete node" t-on-click="() =&gt; this.delete(parent, node)" t-on-mouseenter="(ev) =&gt; this.highlightNode(ev.target, true)" t-on-mouseleave="(ev) =&gt; this.highlightNode(ev.target, false)">
                <i class="fa fa-trash"/>
            </button>
        </div>
    </t>

    <t t-name="web.TreeEditor.connector.title">
        <t t-set="title">
            <t t-if="node.value === '|'">
                <t t-if="node.negate">none</t>
                <t t-else="">any</t>
            </t>
            <t t-else="">
                <t t-if="node.negate">not all</t>
                <t t-else="">all</t>
            </t>
        </t>
        <t t-esc="title"/>
    </t>

    <t t-name="web.TreeEditor.connector.dropdown">
        <t t-if="props.readonly">
            <strong class="px-1">
                <t t-call="web.TreeEditor.connector.title"/>
            </strong>
        </t>
        <t t-else="">
            <div aria-atomic="true">
                <Dropdown togglerClass="'btn btn-link btn-primary py-0 px-1'" showCaret="true">
                    <t t-set-slot="toggler">
                        <t t-call="web.TreeEditor.connector.title"/>
                    </t>
                    <DropdownItem onSelected="() =&gt; this.updateConnector(node, '&amp;')">all</DropdownItem>
                    <DropdownItem onSelected="() =&gt; this.updateConnector(node, '|')">any</DropdownItem>
                </Dropdown>
            </div>
        </t>
    </t>

    <t t-name="web.TreeEditor.connector.children">
        <t t-foreach="node.children" t-as="child" t-key="child.type + '_' + child_index">
            <div class="o_tree_editor_node" t-att-class="{ 'ps-4': addPadding }">
                <t t-call="web.TreeEditor.{{ child.type }}">
                    <t t-set="parent" t-value="node"/>
                    <t t-set="node" t-value="child"/>
                </t>
            </div>
        </t>
    </t>

    <t t-name="web.TreeEditor.connector">
        <div class="o_tree_editor_row d-flex align-items-center">
            <div class="o_tree_editor_connector d-flex flex-grow-1">
                <t t-call="web.TreeEditor.connector.dropdown"/>
                <span>of:</span>
            </div>
            <t t-if="!props.readonly">
                <t t-call="web.TreeEditor.controls"/>
            </t>
        </div>
        <t t-call="web.TreeEditor.connector.children">
            <t t-set="addPadding" t-value="true"/>
        </t>
    </t>

    <t t-name="web.TreeEditor.condition">
        <div class="o_tree_editor_row d-flex align-items-center">
            <t t-if="props.readonly">
                <t t-call="web.TreeEditor.condition:readonly"/>
            </t>
            <t t-else="">
                <t t-call="web.TreeEditor.condition:editable"/>
                <t t-call="web.TreeEditor.controls"/>
            </t>
        </div>
    </t>

    <t t-name="web.TreeEditor.condition:readonly">
        <t t-set="description" t-value="getDescription(node)"/>
        <div class="o_tree_editor_condition d-flex gap-1 px-2 border bg-100">
            <ModelFieldSelector path="node.path" resModel="props.resModel" readonly="true"/>
            <span class="fst-italic" t-esc="description.operatorDescription"/>
            <t t-if="description.valueDescription">
                <t t-set="values" t-value="description.valueDescription.values"/>
                <t t-set="join" t-value="description.valueDescription.join"/>
                <t t-set="addParenthesis" t-value="description.valueDescription.addParenthesis"/>
                <t t-if="addParenthesis">( </t>
                <t t-foreach="values" t-as="val" t-key="val_index">
                    <span class="text-primary fw-bolder"><t t-esc="val"/></span>
                    <t t-if="!val_last"> <t t-esc="join"/> </t>
                </t>
                <t t-if="addParenthesis"> )</t>
            </t>
        </div>
    </t>

    <t t-name="web.TreeEditor.Editor">
        <t t-if="!info.isSupported(value)">
            <div t-attf-class="o_tree_editor_editor #{_classes}">
                <div class="o_input d-flex align-items-center">
                    <span class="flex-grow-1 text-truncate" t-esc="info.stringify(value)"/>
                    <i role="alert" class="fa fa-exclamation-triangle text-warning mx-2" t-att-title="(typeof info.message === 'function') ? info.message(value) : info.message"/>
                    <i class="fa fa-times" title="Clear" t-on-click="() =&gt; update(info.defaultValue())"/>
                </div>
            </div>
        </t>
        <t t-elif="info.component">
            <div t-attf-class="o_tree_editor_editor #{_classes}">
                <t t-component="info.component" t-props="info.extractProps({ update, value })"/>
            </div>
        </t>
    </t>

    <t t-name="web.TreeEditor.condition:editable">
        <div class="o_tree_editor_condition d-flex flex-grow-1 align-items-end gap-2">
            <t t-call="web.TreeEditor.Editor">
                <t t-set="_classes" t-value="'col col-md-4 pe-0'"/>
                <t t-set="info" t-value="props.getPathEditorInfo(node)"/>
                <t t-set="value" t-value="node.path"/>
                <t t-set="update" t-value="(path) =&gt; this.updatePath(node, path)"/>
            </t>
            <t t-call="web.TreeEditor.Editor">
                <t t-set="_classes" t-value="'col col-md-2 px-3'"/>
                <t t-set="info" t-value="props.getOperatorEditorInfo(node)"/>
                <t t-set="value" t-value="[node.operator, node.negate]"/>
                <t t-set="update" t-value="(operator, negate) =&gt; this.updateLeafOperator(node, operator, negate)"/>
            </t>
            <t t-call="web.TreeEditor.Editor">
                <t t-set="_classes" t-value="'col ps-0 overflow-hidden'"/>
                <t t-set="info" t-value="getValueEditorInfo(node)"/>
                <t t-set="value" t-value="node.value"/>
                <t t-set="update" t-value="(value) =&gt; this.updateLeafValue(node, value)"/>
            </t>
        </div>
    </t>

    <t t-name="web.TreeEditor.complex_condition">
        <div class="o_tree_editor_row d-flex align-items-center">
            <div class="o_tree_editor_complex_condition flex-grow-1">
                <input class="o_input w-100" t-att-value="node.value" t-att-readonly="props.readonly or !isDebugMode" t-on-change="(ev) =&gt; this.updateComplexCondition(node, ev.target.value)"/>
            </div>
            <t t-call="web.TreeEditor.controls"/>
        </div>
    </t>


<t t-name="web.TreeEditor.Input">
        <input type="text" class="o_input" t-att-value="props.startEmpty ? '' : props.value" t-on-change="(ev) =&gt; props.update(ev.target.value)"/>
    </t>

    <t t-name="web.TreeEditor.Select">
        <select class="o_input pe-3 text-truncate" t-on-change="(ev) =&gt; props.update(deserialize(ev.target.value))">
            <option t-if="props.addBlankOption" hidden="true"/>
            <t t-foreach="props.options" t-as="option" t-key="serialize(option[0])">
                <option t-att-value="serialize(option[0])" t-att-selected="!props.addBlankOption and option[0] === props.value" t-esc="option[1]"/>
            </t>
        </select>
    </t>

    <t t-name="web.TreeEditor.Range">
        <div class="d-flex align-items-center">
            <t t-call="web.TreeEditor.Editor">
                <t t-set="_classes" t-value="'overflow-hidden flex-grow-1'"/>
                <t t-set="info" t-value="props.editorInfo"/>
                <t t-set="value" t-value="props.value[0]"/>
                <t t-set="update" t-value="(val) =&gt; this.update(0, val)"/>
            </t>
            <i class="fa fa-long-arrow-right mx-2" aria-label="Arrow icon" title="Arrow"/>
            <t t-call="web.TreeEditor.Editor">
                <t t-set="_classes" t-value="'overflow-hidden flex-grow-1'"/>
                <t t-set="info" t-value="props.editorInfo"/>
                <t t-set="value" t-value="props.value[1]"/>
                <t t-set="update" t-value="(val) =&gt; this.update(1, val)"/>
            </t>
        </div>
    </t>

    <t t-name="web.TreeEditor.List">
        <div class="o_input d-flex flex-wrap gap-1">
            <TagsList tags="tags"/>
            <div class="flex-grow-1">
                <t t-call="web.TreeEditor.Editor">
                    <t t-set="info" t-value="props.editorInfo"/>
                    <t t-set="value" t-value="props.editorInfo.defaultValue()"/>
                    <t t-set="update" t-value="(val) =&gt; this.update(val)"/>
                </t>
            </div>
        </div>
    </t>

<t t-name="web.BarcodeDialog">
        <Dialog title="'Barcode Scanner'" fullscreen="true" footer="false" contentClass="'o-barcode-modal'">
            <CropOverlay onResize.bind="this.onResize" isReady="state.isReady">
                <video t-ref="videoPreview" muted="true" autoplay="true" playsinline="true" class="w-100 h-100"/>
            </CropOverlay>
        </Dialog>
    </t>
<t t-name="web.CropOverlay">
        <div t-ref="crop-container" t-on-mousedown="pointerDown" t-on-touchstart="pointerDown" t-on-mousemove="pointerMove" t-on-touchmove="pointerMove" t-on-mouseup="pointerUp" t-on-touchend="pointerUp" class="d-grid align-content-center justify-content-center h-100 o_crop_container">
            <t t-slot="default"/>
            <t t-if="props.isReady">
                <div class="o_crop_overlay"/>
                <img class="o_crop_icon" src="/web/static/img/transform.svg" draggable="false"/>
            </t>
        </div>
    </t>
<t t-name="web.CalendarCommonPopover">
        <t t-if="env.isSmall">
            <Dialog title="props.record.title" contentClass="'o_calendar_color_'+ props.record.colorIndex">
                <t t-call="{{ constructor.subTemplates.body }}"/>
                <t t-set-slot="footer">
                    <t t-call="{{ constructor.subTemplates.footer }}"/>
                </t>
            </Dialog>
        </t>
        <t t-else="">
            <t t-call="{{ constructor.subTemplates.popover }}"/>
        </t>
    </t>

    <t t-name="web.CalendarCommonPopover.popover">
        <div class="card-header d-flex justify-content-between py-2 pe-2">
            <span class="popover-header border-0 text-truncate" t-esc="props.record.title" t-att-data-tooltip="props.record.title"/>
            <span class="o_cw_popover_close ms-4 mt-2 me-2" t-on-click.stop="() =&gt; props.close()">
                <i class="fc-close fc-icon fc-icon-x"/>
            </span>
        </div>
        <div class="o_cw_body">
            <t t-call="{{ constructor.subTemplates.body }}"/>
            <div class="card-footer d-flex gap-1 border-top" t-att-class="{ 'o_footer_shrink': !hasFooter }">
                <t t-call="{{ constructor.subTemplates.footer }}"/>
            </div>
        </div>
    </t>

    <t t-name="web.CalendarCommonPopover.body">
        <ul class="list-group list-group-flush">
            <li t-if="date" class="list-group-item">
                <i class="fa fa-fw fa-calendar text-400"/>
                <span class="fw-bold ms-2" t-esc="date"/> <small t-if="dateDuration != 'All day'"><b t-esc="dateDuration"/></small>
            </li>
            <li t-if="time" class="list-group-item">
                <i class="fa fa-fw fa-clock-o text-400"/>
                <span class="fw-bold ms-2" t-esc="time"/> <small t-if="timeDuration"><b t-esc="\`(\${timeDuration})\`"/></small>
            </li>
        </ul>
        <ul class="list-group list-group-flush o_cw_popover_fields_secondary">
            <Record resModel="props.model.resModel" resId="props.record.id" fields="props.model.fields" activeFields="activeFields" mode="'readonly'" values="props.record.rawRecord" t-slot-scope="slot">
                <t t-foreach="Object.keys(props.model.popoverFieldNodes)" t-as="fieldId" t-key="fieldId">
                    <t t-set="fieldInfo" t-value="props.model.popoverFieldNodes[fieldId]"/>
                    <t t-if="!isInvisible(fieldInfo, slot.record)">
                        <li class="list-group-item d-flex text-nowrap align-items-center" t-att-class="fieldInfo.attrs.class" t-att-data-tooltip="getFormattedValue(fieldId, slot.record)">
                            <span class="fw-bold me-2" t-if="!fieldInfo.options.noLabel">
                                <t t-if="fieldInfo.options.icon">
                                    <i t-attf-class="fa-fw {{fieldInfo.options.icon}} text-400"/>
                                </t>
                                <t t-else="">
                                    <t t-esc="fieldInfo.string"/>
                                </t>
                            </span>
                            <div class="flex-grow-1 role-container text-truncate">
                                <Field name="fieldInfo.name" class="'w-100'" record="slot.record" fieldInfo="fieldInfo" type="fieldInfo.widget"/>
                            </div>
                        </li>
                    </t>
                </t>
            </Record>
        </ul>
    </t>

    <t t-name="web.CalendarCommonPopover.footer">
        <t t-if="isEventEditable">
            <a href="#" class="btn btn-primary o_cw_popover_edit" t-on-click="onEditEvent">Edit</a>
        </t>
        <t t-if="isEventDeletable">
            <a href="#" class="btn btn-secondary o_cw_popover_delete" t-on-click="onDeleteEvent">Delete</a>
        </t>
    </t>

<t t-name="web.CalendarCommonRenderer">
        <div class="o_calendar_widget" t-ref="fullCalendar"/>
    </t>

    <t t-name="web.CalendarCommonRenderer.event">
        <div class="fc-content" t-att-class="isMonth ? 'd-flex gap-1 text-truncate' : ''">
            <t t-if="!isTimeHidden">
                <span class="d-none d-lg-inline fc-time" t-esc="startTime"/>
                <t> </t>
            </t>
            <div class="o_event_title text-truncate" t-out="title"/>
        </div>
    </t>

    <t t-name="web.CalendarCommonRendererHeader">
        <span class="o_cw_day_name" t-esc="scale == 'day' ? weekdayLong : weekdayShort "/> <span t-if="scale != 'month'" class="fc-day-number o_cw_day_number" t-esc="day"/>
    </t>

<t t-name="web.CalendarController">
        <div t-att-class="className" t-ref="root">
            <Layout className="model.useSampleModel ? 'o_view_sample_data' : ''" display="props.display">
                <t t-set-slot="control-panel-additional-actions">
                    <CogMenu/>
                </t>
                <t t-set-slot="layout-buttons">
                    <t t-call="{{ props.buttonTemplate }}"/>
                </t>
                <t t-set-slot="layout-actions">
                    <SearchBar t-if="searchBarToggler.state.showSearchBar"/>
                </t>
                <t t-set-slot="control-panel-navigation-additional">
                    <t t-component="searchBarToggler.component" t-props="searchBarToggler.props"/>
                </t>
                <div class="o_calendar_container d-flex d-md-grid flex-column h-100 bg-view">
                    <div class="o_calendar_header d-flex align-items-center gap-1 px-3 py-2 border-bottom">
                        <div t-if="!env.isSmall" class="o_calendar_navigation_buttons btn-group">
                            <button class="o_calendar_button_prev btn btn-secondary d-none d-md-block" title="Previous" aria-label="Previous" t-on-click.stop="() =&gt; this.setDate('previous')"><i class="oi oi-arrow-left"/></button>
                            <button class="o_calendar_button_next btn btn-secondary d-none d-md-block" title="Next" aria-label="Next" t-on-click.stop="() =&gt; this.setDate('next')"><i class="oi oi-arrow-right"/></button>
                        </div>
                        <ViewScaleSelector scales="scales" currentScale="model.scale" isWeekendVisible="state.isWeekendVisible" setScale.bind="setScale" toggleWeekendVisibility.bind="toggleWeekendVisibility" dropdownClass="'order-3 order-lg-0'"/>
                        <button class="btn btn-secondary o_calendar_button_today order-2 order-lg-0 ms-auto ms-lg-0" t-att-class="env.isSmall ? 'btn-sm btn-light' : 'btn-secondary'" t-on-click.stop="() =&gt; this.setDate('today')">   <span t-if="env.isSmall" class="position-relative pt-1"><t t-esc="today"/><i class="fa fa-calendar-o position-absolute top-50 start-50 translate-middle fs-1"/></span>
                            <t t-else="">Today</t>
                        </button>
                        <h5 class="d-inline-flex ms-lg-2 mb-0">
                            <t t-if="model.meta.scale === 'year'">
                                <t t-esc="currentYear"/>
                            </t>
                            <t t-elif="model.meta.scale === 'month'">
                                <t t-esc="currentMonth"/>
                            </t>
                            <t t-elif="model.meta.scale === 'week'">
                                <t t-esc="weekHeader"/> <span t-if="model.meta.scale === 'week'" class="badge bg-100 rounded px-1 ms-1">Week <t t-esc="currentWeek"/></span>
                            </t>
                            <t t-else="">
                                <t t-esc="dayHeader"/>
                            </t>
                        </h5>
                        <button class="btn btn-light d-none d-md-block order-4 oi oi-panel-right ms-lg-auto collapsed lh-base" t-on-click="toggleSideBar"/>
                    </div>
                    <MobileFilterPanel t-if="env.isSmall" t-props="mobileFilterPanelProps"/>
                    <t t-if="showCalendar" t-component="props.Renderer" t-props="rendererProps"/>
                    <div t-if="showSideBar" class="o_calendar_sidebar_container col-auto overflow-x-hidden overflow-y-auto">
                        <div class="o_calendar_sidebar">
                            <DatePicker t-if="!env.isSmall" t-props="datePickerProps"/>
                            <FilterPanel t-props="filterPanelProps"/>
                        </div>
                    </div>
                </div>
            </Layout>
        </div>
    </t>

    <t t-name="web.CalendarController.controlButtons"/>

<t t-name="web.CalendarRenderer">
        <div class="o_calendar_renderer h-100">
            <ActionSwiper t-props="actionSwiperProps">
                <t t-component="calendarComponent" t-props="props" t-key="calendarKey"/>
            </ActionSwiper>
        </div>
    </t>

<t t-name="web.CalendarYearPopover">
        <t t-if="env.isSmall">
            <Dialog title="dialogTitle">
                <t t-call="{{ constructor.subTemplates.body }}"/>
                <t t-set-slot="footer">
                    <t t-call="{{ constructor.subTemplates.footer }}"/>
                </t>
            </Dialog>
        </t>
        <t t-else="">
            <t t-call="{{ constructor.subTemplates.popover }}"/>
        </t>
    </t>

    <t t-name="web.CalendarYearPopover.popover">
        <div class="position-absolute" style="top: .75rem; right: 1rem;">
            <span class="o_cw_popover_close" t-on-click.stop="() =&gt; props.close()">
                <i class="fc-close fc-icon fc-icon-x"/>
            </span>
        </div>
        <div class="o_cw_body popover-body d-flex flex-column gap-2">
            <t t-call="{{ constructor.subTemplates.body }}"/>
            <t t-if="props.model.canCreate">
                <t t-call="{{ constructor.subTemplates.footer }}"/>
            </t>
        </div>
    </t>

    <t t-name="web.CalendarYearPopover.body">
        <div t-foreach="recordGroups" t-as="recordGroup" t-key="recordGroup.title">
            <h5 t-out="recordGroup.title"/>
            <t t-foreach="recordGroup.records" t-as="record" t-key="record.id">
                <t t-call="{{ constructor.subTemplates.record }}"/>
            </t>
        </div>
    </t>

    <t t-name="web.CalendarYearPopover.footer">
        <t t-if="props.model.canCreate">
            <a href="#" class="btn-link o_cw_popover_create" t-on-click.prevent="onCreateButtonClick">
                <i class="fa fa-plus"/>
                Create
            </a>
        </t>
        <t t-else="">
            <button class="btn btn-primary o-default-button" t-on-click="props.close">
                <t>Ok</t>
            </button>
        </t>
    </t>

    <t t-name="web.CalendarYearPopover.record">
        <a href="#" t-on-click.prevent="() =&gt; this.onRecordClick(record)" t-attf-style="{{ getRecordStyle(record) }}" t-attf-class="o_cw_popover_link d-flex align-items-center gap-1 {{ getRecordClass(record) }} {{record.startHour ? 'o_event_dot' : 'o_event_allday'}}" t-att-data-id="record.id" t-att-data-title="record.title">
            <span t-if="record.startHour"><t t-out="record.startHour"/></span>
            <span t-esc="record.title"/>
        </a>
    </t>

<t t-name="web.CalendarYearRenderer">
        <div class="o_calendar_widget overflow-y-auto" t-ref="root">
            <div class="fc-view-container">
                <div class="fc fc-dayGridYear-view d-flex flex-wrap justify-content-evenly gap-3 px-2 py-3">
                    <t t-foreach="months" t-as="month" t-key="month">
                        <div class="fc-month-container">
                            <div class="fc-month" t-ref="fullCalendar-{{ month }}"/>
                        </div>
                    </t>
                </div>
            </div>
        </div>
    </t>

<t t-name="web.CalendarFilterPanel">
        <t t-foreach="props.model.filterSections" t-as="section" t-key="section.fieldName">
            <t t-if="section.filters.length gt 0">
                <div class="o_calendar_filter d-flex flex-column gap-1 mt-4 mb-2" t-att-class="{'o-calendar-filter-panel--section-collapsed': isSectionCollapsed(section)}" t-att-data-name="section.fieldName">
                    <t t-if="section.label">
                        <div class="o_calendar_filter_items_checkall o-checkbox form-check" data-value="section">
                            <t t-set="filterId" t-value="nextFilterId"/>
                            <input type="checkbox" name="select-all" class="form-check-input" t-attf-id="o_calendar_filter_{{filterId}}" t-att-checked="isAllActive(section)" t-on-change="(ev) =&gt; this.onAllFilterInputChange(section, ev)"/>
                             <t t-if="section.canCollapse">
                                <label class="d-flex align-items-center" type="button" t-on-click.stop.prevent="() =&gt; this.toggleSection(section, ev)">
                                    <span class="o_cw_filter_label fw-bolder" t-esc="section.label"/>
                                    <i class="o_cw_filter_collapse_icon fa ms-1" t-attf-class="fa-caret-{{ isSectionCollapsed(section) ? 'left' : 'down' }}"/>
                                </label>
                            </t>
                            <t t-else="">
                                <label class="o_cw_filter_label fw-bolder" t-esc="section.label"/>
                            </t>
                        </div>
                    </t>
                    <Transition visible="!isSectionCollapsed(section)" name="'o-section-slide'" leaveDuration="350" t-slot-scope="transition">
                        <div class="o_calendar_filter_items d-flex flex-column gap-1" t-att-class="transition.className">
                            <t t-foreach="getSortedFilters(section)" t-as="filter" t-key="filter.value">
                                <t t-set="filterId" t-value="nextFilterId"/>
                                <t t-call="{{ constructor.subTemplates.filter }}"/>
                            </t>
                        </div>
                    </Transition>
                    <t t-if="section.canAddFilter">
                        <AutoComplete t-props="getAutoCompleteProps(section)"/>
                    </t>
                </div>
            </t>
        </t>
    </t>

    <t t-name="web.CalendarFilterPanel.filter">
        <div class="o_calendar_filter_item o-checkbox form-check position-relative w-100 overflow-hidden cursor-pointer" t-att-class="getFilterColor(filter)" t-att-data-value="filter.value">
            <input type="checkbox" name="selection" class="o_cw_filter_input_bg form-check-input" t-att-style="filter.colorIndex and typeof filter.colorIndex !== 'number' ? \`border-color: \${filter.colorIndex}; background-color: \${filter.colorIndex};\` : ''" t-attf-id="o_calendar_filter_item_{{filterId}}" t-att-checked="filter.active" t-on-change="(ev) =&gt; this.onFilterInputChange(section, filter, ev)"/>
            <label class="d-flex align-items-center gap-1" t-attf-for="o_calendar_filter_item_{{filterId}}">
                <t t-if="section.hasAvatar and filter.hasAvatar">
                    <img class="o_cw_filter_avatar o_avatar rounded" t-attf-src="/web/image/{{ section.avatar.model }}/{{ filter.value }}/{{ section.avatar.field }}" alt="Avatar"/>
                </t>
                <t t-elif="filter.type === 'all'">
                    <i class="o_cw_filter_avatar o_avatar fa fa-users fa-fw flex-shrink-0 me-1" role="img" aria-label="Avatar" title="Avatar"/>
                </t>
                <span class="o_cw_filter_title flex-grow-1 text-truncate lh-base" t-esc="filter.label"/>
            </label>
            <t t-if="filter.canRemove">
                <button class="o_remove btn position-absolute top-50 end-0 py-0 px-2 bg-view text-700 transition-base" role="img" title="Remove this favorite from the list" aria-label="Remove this favorite from the list" t-on-click="() =&gt; this.onFilterRemoveBtnClick(section, filter)">
                    <i class="oi oi-close"/>
                </button>
            </t>
        </div>
    </t>

<t t-name="web.CalendarMobileFilterPanel">
        <div class="o_other_calendar_panel d-flex align-items-center" t-on-click="props.toggleSideBar">
            <div class="o_filter me-auto d-flex overflow-auto">
                <t t-foreach="props.model.filterSections" t-as="section" t-key="section.fieldName">
                    <t t-if="section.filters.length gt 0">

                        <t t-foreach="getSortedFilters(section)" t-as="filter" t-key="filter.value">
                            <span t-if="filter.active" class="d-flex align-items-center text-nowrap ms-1 me-2">
                                <i class="fa fa-fw" t-att-class="getFilterColor(filter) !== 'o_color_false' ? 'fa-circle ' + getFilterColor(filter) : 'fa-circle-o'"/>
                                <span class="ms-1 fw-bold text-nowrap" t-esc="filter.label"/>
                            </span>
                        </t>
                    </t>
                </t>
            </div>
            <i t-attf-class="oi fa-fw oi-chevron-{{caretDirection}} ms-2"/>
        </div>
    </t>

<t t-name="web.CalendarQuickCreate">
        <Dialog size="'sm'" title="dialogTitle">
            <div class="o-calendar-quick-create mb-3">
                <label for="title" class="col-form-label o_form_label">
                    Name:
                </label>
                <input type="text" class="o_input o_required_modifier o-calendar-quick-create--input" name="title" t-ref="title" t-on-keyup="onInputKeyup" t-att-value="props.title"/>
            </div>
            <t t-set-slot="footer">
                <button class="btn btn-primary o-calendar-quick-create--create-btn" t-on-click="onCreateBtnClick">
                    Create
                </button>
                <button class="btn btn-secondary o-calendar-quick-create--edit-btn" t-on-click="onEditBtnClick">
                    Edit
                </button>
                <button class="btn btn-secondary o-calendar-quick-create--cancel-btn" t-on-click="onCancelBtnClick">
                    Cancel
                </button>
            </t>
        </Dialog>
    </t>

<t t-name="web.AceField">

        <div class="o_field_widget oe_form_field o_ace_view_editor oe_ace_open">
            <CodeEditor value="state.initialValue" mode="mode" readonly="props.readonly" onBlur.bind="commitChanges" onChange.bind="handleChange" class="'ace-view-editor'" theme="theme" maxLines="200"/>
        </div>
    </t>

<t t-name="web.AttachmentImageField">
        <div class="o_attachment_image">
            <img t-if="props.record.data[props.name]" t-attf-src="/web/image/{{ props.record.data[props.name][0] }}?unique=1" t-att-title="!!env.debug and props.record.data[props.name][1]" alt="Image"/>
        </div>
    </t>

<t t-name="web.BadgeField">
        <span t-if="props.record.data[props.name]" class="badge rounded-pill" t-att-class="classFromDecoration" t-esc="formattedValue"/>
    </t>

<div t-name="web.BadgeSelectionField" class="d-flex flex-wrap gap-1 mb-3">
        <t t-if="props.readonly">
            <span t-esc="string" t-att-raw-value="value"/>
        </t>
        <t t-else="">
            <t t-foreach="options" t-as="option" t-key="option[0]">
                <span class="o_selection_badge btn btn-secondary mb-1" t-att-class="{ 'active': value === option[0], 'btn-sm': props.size === 'sm', 'btn-lg': props.size === 'lg' }" t-att-value="stringify(option[0])" t-esc="option[1]" t-on-click="() =&gt; this.onChange(option[0])"/>
            </t>
        </t>
    </div>

<t t-name="web.BinaryField">
        <t t-if="!props.readonly">
            <t t-if="props.record.data[props.name]">
                <div class="w-100 d-inline-flex gap-1">
                    <FileUploader acceptedFileExtensions="props.acceptedFileExtensions" onUploaded.bind="update">
                        <t name="download" t-if="props.record.resId and !props.record.dirty">
                            <button class="btn btn-link btn-sm lh-1 fa fa-download o_download_file_button" data-tooltip="Download" aria-label="Download" t-on-click="onFileDownload">
                            </button>
                        </t>
                        <t t-set-slot="toggler">
                            <input type="text" class="o_input" t-att-value="fileName" readonly="readonly"/>
                            <button class="btn btn-link btn-sm lh-1 fa fa-pencil o_select_file_button" data-tooltip="Edit" aria-label="Edit">
                            </button>
                        </t>
                        <button class="btn btn-link btn-sm lh-1 fa fa-trash o_clear_file_button" data-tooltip="Clear" aria-label="Clear" t-on-click="() =&gt; this.update({})">
                        </button>
                    </FileUploader>
                </div>
            </t>
            <t t-else="">
                <label class="o_select_file_button btn btn-primary">
                    <FileUploader acceptedFileExtensions="props.acceptedFileExtensions" onUploaded.bind="update">
                        <t t-set-slot="toggler">
                            Upload your file
                        </t>
                    </FileUploader>
                </label>
            </t>
        </t>
        <t t-elif="props.record.resId and props.record.data[props.name]">
            <a class="o_form_uri" href="#" t-on-click.prevent="onFileDownload">
                <span class="fa fa-download me-2"/>
                <t t-if="fileName" t-esc="fileName"/>
            </a>
        </t>
    </t>

    <t t-name="web.ListBinaryField">
        <t t-if="!props.readonly">
            <t t-if="props.record.data[props.name]">
                <div class="w-100 d-inline-flex gap-1">
                    <FileUploader acceptedFileExtensions="props.acceptedFileExtensions" onUploaded.bind="update">
                        <t name="download" t-if="props.record.resId and !props.record.dirty">
                            <button class="btn btn-link btn-sm lh-1 fa fa-download o_download_file_button" data-tooltip="Download" aria-label="Download" t-on-click="onFileDownload">
                            </button>
                        </t>
                        <t t-set-slot="toggler">
                            <input type="text" class="o_input" t-att-value="fileName" readonly="readonly"/>
                            <button class="btn btn-link btn-sm lh-1 fa fa-pencil o_select_file_button" data-tooltip="Edit" aria-label="Edit">
                            </button>
                        </t>
                        <button class="btn btn-link btn-sm lh-1 fa fa-trash o_clear_file_button" data-tooltip="Clear" aria-label="Clear" t-on-click="() =&gt; this.update({})">
                        </button>
                    </FileUploader>
                </div>
            </t>
            <t t-else="">
                <label class="o_select_file_button btn btn-sm btn-link p-0">
                <FileUploader acceptedFileExtensions="props.acceptedFileExtensions" onUploaded.bind="update">
                    <t t-set-slot="toggler">
                        <i class="fa fa-upload fa-fw"/> Upload your file
                    </t>
                </FileUploader>
            </label>
        </t>
        </t>
        <t t-elif="props.record.resId and props.record.data[props.name]">
            <a class="o_form_uri" href="#" t-on-click.prevent="onFileDownload">
                <span class="fa fa-download me-2"/>
                <t t-if="fileName" t-esc="fileName"/>
            </a>
        </t>
    </t>

    <t t-name="web.BooleanField">
        <CheckBox id="props.id" value="state.value" className="'d-inline-block'" disabled="props.readonly" onChange.bind="onChange"/>
    </t>

<t t-name="web.BooleanFavoriteField">
        <div class="o_favorite" t-on-click.prevent.stop="update">
            <a href="#">
                <t t-if="props.record.data[props.name]">
                    <i class="fa fa-star me-1" role="img" title="Remove from Favorites" aria-label="Remove from Favorites"/>
                    <t t-if="!props.noLabel">Remove from Favorites</t>
                </t>
                <t t-else="">
                    <i class="fa fa-star-o me-1" role="img" title="Add to Favorites" aria-label="Add to Favorites"/>
                    <t t-if="!props.noLabel">Add to Favorites</t>
                </t>
            </a>
        </div>
    </t>

<t t-name="web.BooleanIconField">
        <button t-attf-class="btn btn-sm btn-{{props.record.data[props.name] ? 'primary' : 'outline-secondary'}} mx-2 py-1 fa {{props.icon}}" t-att-data-tooltip="props.label" t-on-click.prevent.stop="update"/>
    </t>

<t t-name="web.BooleanToggleField">
        <CheckBox id="props.id" value="state.value" className="'o_field_boolean o_boolean_toggle form-switch'" disabled="props.readonly" onChange.bind="onChange">
             
        </CheckBox>
    </t>

<t t-name="web.ListBooleanToggleField">
        <div t-on-click="onClick">
            <t t-call="web.BooleanToggleField"/>
        </div>
    </t>

<t t-name="web.CharField">
        <t t-if="props.readonly">
            <span t-esc="formattedValue"/>
        </t>
        <t t-else="">
            <input class="o_input" t-att-class="{'o_field_translate': isTranslatable}" t-att-id="props.id" t-att-type="props.isPassword ? 'password' : 'text'" t-att-autocomplete="props.autocomplete or (props.isPassword ? 'new-password' : 'off')" t-att-maxlength="maxLength &gt; 0 and maxLength" t-att-placeholder="props.placeholder" t-ref="input"/>
            <t t-if="isTranslatable">
                <TranslationButton fieldName="props.name" record="props.record"/>
            </t>
        </t>
    </t>

<t t-name="web.ColorField">
        <div class="o_field_color d-flex" t-att-class="{ 'o_field_cursor_disabled': props.readonly }" t-attf-style="background: #{color or 'url(/web/static/img/transparent.png)'}">
            <input t-on-click.stop="" class="w-100 h-100 opacity-0" type="color" t-att-value="color" t-att-disabled="props.readonly" t-on-input="(ev) =&gt; this.color = ev.target.value" t-on-change="(ev) =&gt; this.props.record.update({ [this.props.name]: ev.target.value })"/>
        </div>
    </t>

<t t-name="web.ColorPickerField">
        <ColorList canToggle="props.canToggle" colors="constructor.RECORD_COLORS" forceExpanded="isExpanded" onColorSelected.bind="switchColor" selectedColor="props.record.data[props.name] || 0"/>
    </t>

<t t-name="web.CopyButton">
        <button class="text-nowrap" t-ref="button" t-att-disabled="props.disabled" t-attf-class="btn btn-primary o_clipboard_button {{ props.className || '' }}" t-on-click.stop="onClick">
            <span class="fa fa-clipboard mx-1"/>
            <span t-esc="props.copyText"/>
        </button>
    </t>

<t t-name="web.CopyClipboardField">
        <div class="d-grid rounded-2 overflow-hidden">
            <Field t-props="fieldProps"/>
            <CopyButton className="copyButtonClassName" content="props.record.data[props.name]" copyText="copyText" successText="successText"/>
        </div>
    </t>

    <t t-name="web.CopyClipboardButtonField">
        <CopyButton t-if="props.record.data[props.name]" className="copyButtonClassName" content="props.record.data[props.name]" copyText="copyText" disabled="disabled" successText="successText"/>
    </t>

<t t-name="web.DateTimeField">
        <t t-set="showSeparator" t-value="shouldShowSeparator()"/>
        <div class="d-flex gap-2 align-items-center" t-ref="root">

            <t t-if="props.readonly">
                <span class="text-truncate" t-esc="getFormattedValue(0)"/>
            </t>
            <t t-elif="!props.required and !props.alwaysRange and isEmpty(startDateField) and !isEmpty(endDateField)">
                <button class="o_add_date o_add_start_date btn btn-secondary btn-sm w-100" t-on-click="() =&gt; this.addDate(0)">
                    <i class="fa fa-plus me-2"/>
                    Add start date
                </button>
            </t>
            <t t-elif="props.required or props.alwaysRange or !isEmpty(startDateField) or startDateField === props.name">
                <input t-ref="start-date" type="text" t-att-id="showSeparator ? props.endDateField and props.id : props.id" class="o_input cursor-pointer" autocomplete="off" t-att-placeholder="props.placeholder" t-att-data-field="startDateField" t-on-input="onInput"/>
                <span t-if="props.warnFuture and isDateInTheFuture(0)" class="fa fa-exclamation-triangle text-danger" title="This date is on the future. Make sure it is what you expected."/>
            </t>


            <t t-if="showSeparator">
                <i class="fa fa-long-arrow-right" aria-label="Arrow icon" title="Arrow"/>
            </t>


            <t t-if="endDateField">
                <t t-if="props.readonly">
                    <span class="text-truncate" t-esc="getFormattedValue(1)"/>
                </t>
                <t t-elif="!props.required and !props.alwaysRange and !isEmpty(startDateField) and isEmpty(endDateField)">
                    <button class="o_add_date o_add_end_date btn btn-secondary btn-sm w-100" t-on-click="() =&gt; this.addDate(1)">
                        <i class="fa fa-plus me-2"/>
                        Add end date
                    </button>
                </t>
                <t t-elif="props.required or props.alwaysRange or !isEmpty(endDateField) or endDateField === props.name">
                    <input t-ref="end-date" type="text" t-att-id="props.startDateField and props.id" class="o_input cursor-pointer" autocomplete="off" t-att-placeholder="props.placeholder" t-att-data-field="endDateField" t-on-input="onInput"/>
                    <span t-if="props.warnFuture and isDateInTheFuture(1)" class="fa fa-exclamation-triangle text-danger" title="This date is on the future. Make sure it is what you expected."/>
                </t>
            </t>
        </div>
    </t>
<t t-name="web.DomainField">
        <div t-att-class="{ o_inline_mode: !props.editInDialog }">
            <t t-set="resModel" t-value="getResModel()"/>
            <t t-if="resModel">
                <t t-if="props.isFoldable and state.folded and state.isValid">
                    <div class="d-flex align-items-center" t-on-click="() =&gt; state.folded = false">
                        <i data-tooltip="Modify filter" class="fa fa-lg fa-caret-right pe-2"/>
                        <div class="d-print-contents">
                            <t t-if="!state.facets.length">
                                <span>Match <strong>all records</strong></span>
                                <t t-if="!props.readonly">
                                    <button class="btn btn-sm btn-primary o_domain_add_first_node_button mx-2" t-on-click.stop="() =&gt; this.addCondition()">
                                        <i class="fa fa-plus"/> Add condition
                                    </button>
                                </t>
                            </t>
                            <t t-foreach="state.facets" t-as="facet" t-key="facet_index">
                                <div class="d-inline-flex align-items-stretch text-nowrap px-1 position-relative" role="listitem" tabindex="0">
                                    <div class="o_searchview_facet_label rounded-start-2 btn btn-primary rounded-end-0 p-0" role="button">
                                        <i class="px-1 small fa fa-filter" role="image"/>
                                    </div>
                                    <div class="o_facet_values d-flex align-items-center px-2 bg-200 rounded-end-2 text-wrap">
                                        <small class="o_facet_value" t-esc="facet"/>
                                    </div>
                                </div>
                            </t>
                            <t t-if="state.isValid">
                                <button class="btn btn-sm btn-link o_domain_show_selection_button" data-tooltip="Show matching records" type="button" t-on-click.stop="onButtonClick">
                                    <t t-esc="state.recordCount"/> record(s)
                                </button>
                            </t>
                        </div>
                    </div>
                </t>
                <t t-else="">
                    <div class="d-flex">
                        <a t-if="props.isFoldable and state.isValid" t-on-click="fold">
                            <i class="fa fa-lg fa-caret-down pe-2"/>
                        </a>
                        <DomainSelector resModel="resModel" domain="getDomain()" readonly="props.readonly or props.editInDialog" update.bind="update" isDebugMode="!!env.debug" className="props.readonly ? 'o_read_mode' : 'o_edit_mode'"/>
                    </div>
                    <div class="o_field_domain_panel d-flex align-items-center gap-2 mt-1">
                        <i class="oi oi-arrow-right" role="img" aria-label="Domain" title="Domain"/>
                        <t t-if="state.isValid === null and state.recordCount === null">
                            <i class="fa fa-circle-o-notch fa-spin ms-2" role="img" aria-label="Loading" title="Loading"/>
                        </t>
                        <t t-else="">
                            <t t-if="state.isValid">
                                <button class="btn btn-sm btn-link o_domain_show_selection_button" type="button" t-on-click.stop="onButtonClick">
                                    <t t-esc="state.recordCount"/> record(s)
                                </button>
                            </t>
                            <t t-else="">
                                <span class="text-warning" role="alert">
                                    <i class="fa fa-exclamation-triangle" role="img" aria-label="Warning" title="Warning"/> Invalid domain
                                </span>
                            </t>
                            <t t-if="!!env.debug and !props.readonly">
                                <button class="btn btn-sm btn-icon fa fa-refresh o_refresh_count" role="img" aria-label="Refresh" title="Refresh" t-on-click="() =&gt; this.checkProps()"/>
                            </t>
                        </t>
                        <t t-if="props.editInDialog and !props.readonly">
                            <button class="btn btn-sm btn-primary o_field_domain_dialog_button" t-on-click.prevent="onEditDialogBtnClick">Edit Domain</button>
                        </t>
                    </div>
                </t>
            </t>
            <t t-else="">
                <div>Select a model to add a filter.</div>
            </t>
        </div>
    </t>

<t t-name="web.DynamicPlaceholderPopover">
        <t t-if="state.isPathSelected">
            <div class="o_model_field_selector_popover" t-on-keydown="onInputKeydown">
                <div class="o_model_field_selector_popover_header text-center">
                    <div class="o_model_field_selector_popover_title">Default value</div>
                    <i class="fa fa-times o_model_field_selector_popover_option o_model_field_selector_popover_close" title="Close" role="img" aria-label="Close" t-on-click="props.close"/>
                    <div class="o_model_field_selector_default_value_input mt-2">
                        <input type="text" placeholder="Type a default text or press ENTER" class="o_input" t-att-value="state.defaultValue" t-on-input="(ev) =&gt; this.setDefaultValue(ev.target.value)" t-ref="autofocus"/>
                    </div>
                </div>
                <div class="o_model_field_selector_popover_body">
                    <ul class="o_model_field_selector_popover_page">
                        <li class="o_model_field_selector_popover_item">
                            <button class="o_model_field_selector_popover_item_name btn flex-fill text-start" t-on-click="() =&gt; this.validate()">
                                <t t-if="state.defaultValue === ''">
                                    <div class="text-muted o_model_field_selector_item_title">Default text is used when no values are set</div>
                                </t>
                                <t t-else="">
                                    <div class="text-muted o_model_field_selector_item_title">As a default text when no value are set</div>
                                </t>
                            </button>
                        </li>
                    </ul>
                </div>
                <div class="o_model_field_selector_popover_footer">
                    <input type="text" class="o_input o_model_field_selector_debug" disabled="disabled" t-att-value="state.path"/>
                </div>
            </div>
        </t>
        <t t-else="">
            <ModelFieldSelectorPopover close.bind="closeFieldSelector" filter.bind="filter" followRelations="true" isDebugMode="!!env.debug" path="state.path" resModel="props.resModel" showSearchInput="true" update.bind="setPath"/>
        </t>
    </t>

<t t-name="web.DynamicModelFieldSelectorChar">
            <DynamicModelFieldSelector t-props="getSelectorProps"/>
        <t t-if="props.readonly">
            <span t-esc="formattedValue" class="d-none"/>
        </t>
        <t t-else="">
            <input class="o_input d-none" t-att-class="{'o_field_translate': isTranslatable}" t-att-id="props.id" t-att-type="props.isPassword ? 'password' : 'text'" t-att-autocomplete="props.autocomplete or (props.isPassword ? 'new-password' : 'off')" t-att-maxlength="maxLength &gt; 0 and maxLength" t-att-placeholder="props.placeholder" t-ref="input"/>
            <t t-if="isTranslatable">
                <TranslationButton fieldName="props.name" record="props.record"/>
            </t>
        </t>
    </t>

<t t-name="web.EmailField">
        <t t-if="props.readonly">
            <div class="d-grid">
                <a class="o_form_uri o_text_overflow" t-on-click.stop="" t-att-href="props.record.data[props.name] ? 'mailto:'+props.record.data[props.name] : undefined" t-esc="props.record.data[props.name] || ''"/>
            </div>
        </t>
        <t t-else="">
            <div class="d-inline-flex w-100">
                <input class="o_input" t-att-id="props.id" type="email" autocomplete="off" t-att-placeholder="props.placeholder" t-att-required="props.required" t-ref="input"/>
            </div>
        </t>
    </t>

    <t t-name="web.FormEmailField">
        <t t-if="props.readonly">
            <div class="d-grid">
                <a class="o_form_uri o_text_overflow" t-on-click.stop="" t-att-href="props.record.data[props.name] ? 'mailto:'+props.record.data[props.name] : undefined" t-esc="props.record.data[props.name] || ''"/>
            </div>
        </t>
        <t t-else="">
            <div class="d-inline-flex w-100">
                <input class="o_input" t-att-id="props.id" type="email" autocomplete="off" t-att-placeholder="props.placeholder" t-att-required="props.required" t-ref="input"/>
            <a t-if="props.record.data[props.name]" t-att-href="'mailto:'+props.record.data[props.name]" class="ms-3 d-inline-flex align-items-center" target="_blank">
                <i class="fa fa-envelope" data-tooltip="Send Email" aria-label="Send Email"/>
            </a>
            </div>
        </t>
    </t>

    <t t-name="web.Field">
        <div t-att-name="props.name" t-att-class="classNames" t-att-style="props.style" t-att-data-tooltip-template="tooltip and 'web.FieldTooltip'" t-att-data-tooltip-info="tooltip">
            <t t-component="field.component" t-props="fieldComponentProps"/>
        </div>
    </t>

<t t-name="web.FieldTooltip">

        <p t-if="field.help" class="o-tooltip--help" role="tooltip">
            <t t-esc="field.help"/>
        </p>

        <ul class="o-tooltip--technical" t-if="debug" role="tooltip">
            <li data-item="field" t-if="field and field.label">
                <span class="o-tooltip--technical--title">Label:</span>
                <t t-esc="field.label"/>
            </li>
            <li data-item="field" t-if="field and field.name">
                <span class="o-tooltip--technical--title">Field:</span>
                <t t-esc="field.name"/>
            </li>
            <li data-item="object" t-if="resModel">
                <span class="o-tooltip--technical--title">Model:</span>
                <t t-esc="resModel"/>
            </li>
            <t t-if="field">
                <li t-if="field.type" data-item="type">
                    <span class="o-tooltip--technical--title">Type:</span>
                    <t t-esc="field.type"/>
                </li>
                <li t-if="field.widget" data-item="widget">
                    <span class="o-tooltip--technical--title">Widget:</span>
                    <t t-if="field.widgetDescription" t-esc="field.widgetDescription"/>
                    <t t-if="field.widget">
                        (<t t-esc="field.widget"/>)
                    </t>
                </li>
                <li t-if="field.context" data-item="context">
                    <span class="o-tooltip--technical--title">Context:</span>
                    <t t-esc="field.context"/>
                </li>
                <li t-if="field.domain" data-item="domain">
                    <span class="o-tooltip--technical--title">Domain:</span>
                    <t t-esc="field.domain.length === 0 ? '[]' : field.domain"/>
                </li>
                <li t-if="field.invisible" data-item="invisible">
                    <span class="o-tooltip--technical--title">Invisible:</span>
                    <t t-esc="field.invisible"/>
                </li>
                <li t-if="field.column_invisible" data-item="column_invisible">
                    <span class="o-tooltip--technical--title">Column invisible:</span>
                    <t t-esc="field.column_invisible"/>
                </li>
                <li t-if="field.required" data-item="required">
                    <span class="o-tooltip--technical--title">Required:</span>
                    <t t-esc="field.required"/>
                </li>
                <li t-if="field.readonly" data-item="readonly">
                    <span class="o-tooltip--technical--title">Readonly:</span>
                    <t t-esc="field.readonly"/>
                </li>
                <li t-if="field.default" data-item="default">
                    <span class="o-tooltip--technical--title">Default:</span>
                    <t t-esc="field.default"/>
                </li>
                <li t-if="field.changeDefault" data-item="changeDefault">
                    <span class="o-tooltip--technical--title">Change default:</span>
                    Yes
                </li>
                <li t-if="field.relation" data-item="relation">
                    <span class="o-tooltip--technical--title">Relation:</span>
                    <t t-esc="field.relation"/>
                </li>
                <li t-if="field.selection" data-item="selection">
                    <span class="o-tooltip--technical--title">Selection:</span>
                    <ul class="o-tooltip--technical">
                        <li t-foreach="field.selection" t-as="option" t-key="option_index">
                            [<t t-esc="option[0]"/>]
                            <t t-if="option[1]"> - </t>
                            <t t-esc="option[1]"/>
                        </li>
                    </ul>
                </li>
            </t>
        </ul>
    </t>

<t t-name="web.FileUploader">
        <t t-if="state.isUploading and props.showUploadingText">Uploading...</t>
        <span t-else="" t-on-click.prevent="onSelectFileButtonClick" style="display:contents">
            <t t-slot="toggler"/>
        </span>
        <t t-slot="default"/>
        <input type="file" t-att-name="props.inputName" t-ref="fileInput" t-attf-class="o_input_file d-none {{ props.fileUploadClass or '' }}" t-att-multiple="props.multiUpload ? 'multiple' : false" t-att-accept="props.acceptedFileExtensions or '*'" t-on-change="onFileChange"/>
    </t>

<t t-name="web.FloatField">
        <span t-if="props.readonly" t-esc="formattedValue"/>
        <input t-else="" t-on-focusin="onFocusIn" t-on-focusout="onFocusOut" t-att-id="props.id" t-ref="numpadDecimal" t-att-placeholder="props.placeholder" t-att-type="props.inputType" inputmode="decimal" class="o_input" autocomplete="off" t-att-step="props.step"/>
    </t>

<t t-name="web.FloatTimeField">
        <span t-if="props.readonly" t-esc="formattedValue"/>
        <input t-else="" t-att-id="props.id" t-att-type="props.inputType" t-ref="numpadDecimal" t-att-placeholder="props.placeholder" class="o_input" autocomplete="off"/>
    </t>

<t t-name="web.FloatToggleField">
        <span t-if="props.readonly and !props.disableReadOnly" t-esc="formattedValue"/>
        <button t-else="" class="o_field_float_toggle" t-on-click="onChange"><t t-esc="formattedValue"/></button>
    </t>

<t t-name="web.FontSelectionField">
        <t t-if="props.readonly">
            <span t-esc="string" t-att-raw-value="props.record.data[props.name]" t-attf-style="font-family:{{ props.record.data[props.name] }};"/>
        </t>
        <t t-else="">
            <select class="o_input" t-on-change="onChange" t-attf-style="font-family:{{ props.record.data[props.name] }};">
                <option t-att-selected="false === value" t-att-value="stringify(false)" t-esc="this.props.placeholder || ''" t-attf-style="{{ props.required ? 'display:none' : '' }}"/>
                <t t-foreach="options" t-as="option" t-key="option[0]">
                    <option t-att-selected="option[0] === value" t-att-value="stringify(option[0])" t-esc="option[1]" t-attf-style="font-family:{{ option[1] }};"/>
                </t>
            </select>
        </t>
    </t>

<t t-name="web.GaugeField">
        <div class="oe_gauge position-relative">
            <canvas t-ref="canvas"/>
            <span class="o_gauge_value position-absolute start-0 end-0 bottom-0 text-center" t-esc="props.record.data[props.name]"/>
        </div>
    </t>

<t t-name="web.HandleField">
        <span class="o_row_handle oi oi-draggable ui-sortable-handle" t-on-click.stop=""/>
    </t>

<t t-name="web.HtmlField">
        <t t-if="props.readonly">
            <span t-out="props.record.data[props.name] or ''"/>
        </t>
        <t t-else="" t-call="web.TextField"/>
    </t>

<t t-name="web.IframeWrapperField">
        <div class="o_preview_iframe_wrapper">
            <iframe src="about:blank" class="o_preview_iframe" t-ref="iframe"/>
        </div>
    </t>

<t t-name="web.ImageField">
        <div class="d-inline-block position-relative opacity-trigger-hover">
            <div t-attf-class="position-absolute d-flex justify-content-between w-100 bottom-0 opacity-0 opacity-100-hover {{isMobile ? 'o_mobile_controls' : ''}}" aria-atomic="true" t-att-style="sizeStyle">
                <t t-if="!props.readonly">
                    <FileUploader acceptedFileExtensions="props.acceptedFileExtensions" t-key="props.record.resId" onUploaded.bind="onFileUploaded">
                        <t t-set-slot="toggler">
                            <button class="o_select_file_button btn btn-light border-0 rounded-circle m-1 p-1" data-tooltip="Edit" aria-label="Edit">
                                <i class="fa fa-pencil fa-fw"/>
                            </button>
                        </t>
                        <button t-if="props.record.data[props.name] and state.isValid" class="o_clear_file_button btn btn-light border-0 rounded-circle m-1 p-1" data-tooltip="Clear" aria-label="Clear" t-on-click="onFileRemove">
                            <i class="fa fa-trash-o fa-fw"/>
                        </button>
                    </FileUploader>
                </t>
            </div>
            <img loading="lazy" class="img img-fluid" alt="Binary file" t-att-src="this.getUrl(props.previewImage or props.name)" t-att-name="props.name" t-att-height="props.height" t-att-width="props.width" t-att-style="sizeStyle" t-on-error.stop="onLoadFailed" t-att-data-tooltip-template="hasTooltip and tooltipAttributes.template" t-att-data-tooltip-info="hasTooltip and tooltipAttributes.info" t-att-data-tooltip-delay="hasTooltip and props.zoomDelay"/>
        </div>
    </t>

    <t t-name="web.ImageZoomTooltip">
        <div class="o_image_zoom">
            <img t-att-src="url"/>
        </div>
    </t>

<t t-name="web.ImageUrlField">
        <img t-if="props.record.data[props.name]" class="img img-fluid" alt="Image" t-att-src="state.src" t-att-border="props.readonly ? 0 : 1" t-att-name="props.name" t-att-height="props.height" t-att-width="props.width" t-att-style="sizeStyle" t-on-error="onLoadFailed"/>
    </t>

<t t-name="web.IntegerField">
        <span t-if="props.readonly" t-esc="formattedValue"/>
        <input t-else="" t-ref="numpadDecimal" t-on-focusin="onFocusIn" t-on-focusout="onFocusOut" t-att-id="props.id" t-att-type="props.inputType" t-att-placeholder="props.placeholder" inputmode="numeric" class="o_input" autocomplete="off" t-att-step="props.step"/>
    </t>

<t t-name="web.JournalDashboardGraphField">
        <div class="o_dashboard_graph" t-att-class="props.className" t-attf-class="o_graph_{{ props.graphType }}chart">
            <canvas t-ref="canvas"/>
        </div>
    </t>

<t t-name="web.JsonbField">
        <span t-esc="formattedValue"/>
    </t>

<t t-name="web.LabelSelectionField">
        <span t-attf-class="badge text-bg-{{className}} " t-esc="string" t-att-raw-value="props.record.data[props.name]"/>
    </t>

<t t-name="web.Many2ManyBinaryField">
        <div t-attf-class="oe_fileupload {{props.className ? props.className : ''}}" aria-atomic="true">
            <div class="o_attachments">
                <t t-foreach="files" t-as="file" t-key="file_index">
                   <t t-call="Many2ManyBinaryField.attachment_preview"/>
                </t>
            </div>
            <div t-if="!props.readonly &amp;&amp; (!props.numberOfFiles or files.length &lt; props.numberOfFiles)" class="oe_add">
                <FileInput acceptedFileExtensions="props.acceptedFileExtensions" multiUpload="true" onUpload.bind="onFileUploaded" resModel="props.record.resModel" resId="props.record.resId or 0">
                    <button class="btn btn-secondary o_attach" data-tooltip="Attach">
                        <span class="fa fa-paperclip" aria-label="Attach"/> <t t-esc="uploadText"/>
                    </button>
                </FileInput>
            </div>
        </div>
    </t>

<t t-name="Many2ManyBinaryField.attachment_preview">
    <t t-set="editable" t-value="!props.readonly"/>
    <div t-attf-class="o_attachment o_attachment_many2many #{ editable ? 'o_attachment_editable' : '' } #{upload ? 'o_attachment_uploading' : ''}" t-att-title="file.name">
        <div class="o_attachment_wrap">
            <t t-set="ext" t-value="getExtension(file)"/>
            <t t-set="url" t-value="getUrl(file.id)"/>
            <div class="o_image_box float-start" t-att-data-tooltip="'Download ' + file.name">
                <a t-att-href="url" aria-label="Download" download="">
                    <span class="o_image o_hover" t-att-data-mimetype="file.mimetype" t-att-data-ext="ext" role="img"/>
                </a>
            </div>

            <div class="caption">
                <a class="ml4" t-att-data-tooltip="'Download ' + file.name" t-att-href="url" download=""><t t-esc="file.name"/></a>
            </div>
            <div class="caption small">
                <a class="ml4 small text-uppercase" t-att-href="url" download=""><b><t t-esc="ext"/></b></a>
                <div t-if="editable" class="progress o_attachment_progress_bar">
                    <div class="progress-bar progress-bar-striped active" style="width: 100%">Uploading</div>
                </div>
            </div>

            <div class="o_attachment_uploaded"><i class="text-success fa fa-check" role="img" aria-label="Uploaded" title="Uploaded"/></div>
            <div t-if="editable" class="o_attachment_delete" t-on-click.stop="() =&gt; this.onFileRemove(file.id)"><span role="img" aria-label="Delete" title="Delete"></span></div>
        </div>
    </div>
</t>

<t t-name="web.Many2ManyCheckboxesField">
        <div aria-atomic="true">
            <t t-foreach="items" t-as="item" t-key="item[0]">
                <div>
                    <CheckBox value="isSelected(item)" disabled="props.readonly" onChange="(ev) =&gt; this.onChange(item[0], ev)">
                        <t t-esc="item[1]"/>
                    </CheckBox>
                </div>
            </t>
        </div>
    </t>

<t t-name="web.KanbanMany2ManyTagsField">
        <div class="d-flex flex-wrap gap-1">
            <TagsList tags="tags"/>
        </div>
    </t>
<t t-name="web.Many2ManyTagsField">
        <div class="o_field_tags d-inline-flex flex-wrap gap-1" t-att-class="{'o_tags_input o_input': !props.readonly}" t-ref="many2ManyTagsField">
            <TagsList tags="tags"/>
            <div t-if="showM2OSelectionField" class="o_field_many2many_selection d-inline-flex w-100" t-ref="autoComplete">
                <Many2XAutocomplete id="props.id" placeholder="tags.length ? '' : props.placeholder" resModel="relation" autoSelect="true" fieldString="string" activeActions="activeActions" update="update" quickCreate="activeActions.create ? quickCreate : null" context="props.context" getDomain.bind="getDomain" isToMany="true" nameCreateField="props.nameCreateField" noSearchMore="props.noSearchMore"/>
            </div>
        </div>
    </t>

    <t t-name="web.Many2ManyTagsFieldColorListPopover">
        <div class="o_tag_popover m-2">
            <ColorList colors="props.colors" forceExpanded="true" onColorSelected="(id) =&gt; props.switchTagColor(id, props.tag)"/>
            <CheckBox className="'pt-2'" value="props.tag.colorIndex === 0" onChange.alike="(isChecked) =&gt; props.onTagVisibilityChange(isChecked, props.tag)">Hide in kanban</CheckBox>
        </div>
    </t>

<t t-name="web.Many2ManyTagsAvatarField">
        <div class="many2many_tags_avatar_field_container o_field_tags d-inline-flex flex-wrap mw-100 gap-1" t-att-class="{'o_tags_input o_input': !props.readonly}" t-ref="many2ManyTagsField">
            <TagsList tags="tags" itemsVisible="itemsVisible"/>
            <div t-if="showM2OSelectionField" class="o_field_many2many_selection d-inline-flex w-100" t-ref="autoComplete">
                <Many2XAutocomplete id="props.id" placeholder="tags.length ? '' : props.placeholder" resModel="relation" autoSelect="true" fieldString="string" activeActions="activeActions" update="update" quickCreate="activeActions.create ? quickCreate : null" context="props.context" getDomain.bind="getDomain" isToMany="true"/>
            </div>
        </div>
    </t>

    <t t-name="web.KanbanMany2ManyTagsAvatarFieldTagsList">
            <t t-if="canDisplayQuickAssignAvatar">
                <a t-on-click.stop.prevent="openPopover" tabIndex="-1" href="#" title="Assign" aria-label="Assign" class="o_quick_assign fa fa-user-plus o_m2m_avatar btn-link d-flex align-items-center text-dark" role="button"/>
            </t>
        <t t-foreach="visibleTags" t-as="tag" t-key="tag.id or tag_index">
            <span class="o_tag position-relative d-inline-flex align-items-center user-select-none mw-100" t-att-class="{                     'o_avatar opacity-trigger-hover' : tag.img,                     'o_badge badge rounded-pill lh-1': !tag.img,                 }" t-attf-class="{{ !tag.img ? 'o_tag_color_' + (tag.colorIndex ? tag.colorIndex : '0') : '' }}" tabindex="-1" t-att-data-color="tag.colorIndex" t-att-title="tag.text" t-on-click="(ev) =&gt; tag.onClick and tag.onClick(ev)" t-on-keydown="tag.onKeydown">


                <span t-if="tag.img and props.displayText and tag.onDelete" class="o_avatar_backdrop position-absolute top-0 end-0 bottom-0 start-0 ms-n2 mt-n1 mb-n1 bg-view rounded border shadow opacity-0 opacity-100-hover"/>

                <img t-if="tag.img" t-att-src="tag.img" class="o_avatar o_m2m_avatar position-relative rounded" t-att-class="tag.imageClass"/>

                <i t-if="tag.icon" t-attf-class="p-1 fa {{ tag.icon }}" t-att-class="tag.className"/>

                <div t-if="props.displayText" class="o_tag_badge_text text-truncate" t-att-class="{'position-relative ms-1' : tag.img}" t-out="tag.text"/>

                <a t-if="tag.onDelete" t-on-click.stop.prevent="(ev) =&gt; tag.onDelete and tag.onDelete(ev)" class="o_delete d-flex align-items-center opacity-100-hover" t-att-class="{                             'btn btn-link position-relative py-0 px-1 text-danger opacity-0': tag.img,                             'ps-1 opacity-75': !tag.img                         }" title="Delete" aria-label="Delete" tabIndex="-1" href="#">
                        <i class="oi oi-close align-text-top"/>
                </a>
            </span>
        </t>
        <span t-if="props.tags and otherTags.length" class="o_m2m_avatar_empty rounded-circle text-center fw-bold" data-tooltip-template="web.TagsList.Tooltip" data-tooltip-position="right" t-att-data-tooltip-info="tooltipInfo" t-on-click.stop.prevent="openPopover">
            <span t-if="otherTags.length &gt; 9" t-esc="'9+'"/>
            <span t-else="" t-esc="'+' + otherTags.length"/>
        </span>
    </t>

    <t t-name="web.KanbanMany2ManyTagsAvatarField">
        <div class="many2many_tags_avatar_field_container o_field_tags d-inline-flex flex-wrap mw-100 gap-1" t-att-class="{'o_tags_input o_input': !props.readonly}" t-ref="many2ManyTagsField">
            <TagsList tags="tags" itemsVisible="itemsVisible" popoverProps="popoverProps" readonly="!props.isEditable"/>
            <div t-if="showM2OSelectionField" class="o_field_many2many_selection d-inline-flex w-100" t-ref="autoComplete">
                <Many2XAutocomplete id="props.id" placeholder="tags.length ? '' : props.placeholder" resModel="relation" autoSelect="true" fieldString="string" activeActions="activeActions" update="update" quickCreate="activeActions.create ? quickCreate : null" context="props.context" getDomain.bind="getDomain" isToMany="true"/>
            </div>
        </div>
    </t>

    <t t-name="web.Many2ManyTagsAvatarFieldPopover">
        <div class="many2many_tags_avatar_field_container o_field_tags flex-wrap gap-1 p-2 o_m2m_tags_avatar_field_popover o_field_widget o_field_many2many_tags_avatar" t-att-class="{'o_tags_input o_input': !props.readonly}" t-ref="many2ManyTagsField">
            <TagsList tags="tags" itemsVisible="itemsVisible"/>
            <div t-if="showM2OSelectionField" class="o_field_many2many_selection d-inline-flex w-100 w-100" t-ref="autoComplete">
                <Many2XAutocomplete id="props.id" placeholder="props.placeholder" resModel="relation" autoSelect="true" fieldString="string" activeActions="activeActions" update="update" quickCreate="activeActions.create ? quickCreate : null" context="props.context" getDomain.bind="getDomain" isToMany="true" dropdown="false" autofocus="true"/>
            </div>
        </div>
    </t>

    <t t-name="web.Many2OneField.CreateConfirmationDialog">
        <Dialog title="title" size="'md'">
            <div>
                <t t-out="dialogContent"/>
            </div>
            <t t-set-slot="footer">
                <button class="btn btn-primary" t-on-click="onCreate">Create</button>
                <button class="btn" t-on-click="() =&gt; props.close()">Discard</button>
            </t>
        </Dialog>
    </t>

    <t t-name="web.Many2OneField">
        <t t-if="props.readonly">
            <t t-if="!props.canOpen">
                <span>
                    <span t-esc="displayName"/>
                    <t t-foreach="extraLines" t-as="extraLine" t-key="extraLine_index">
                        <br/>
                        <span t-esc="extraLine"/>
                    </t>
                </span>
            </t>
            <t t-else="">
                <a t-if="value" t-attf-class="o_form_uri #{classFromDecoration}" t-att-href="value ? \`#id=\${value[0]}&amp;model=\${relation}\` : '#'" t-on-click.prevent="onClick">
                    <span t-esc="displayName"/>
                    <t t-foreach="extraLines" t-as="extraLine" t-key="extraLine_index">
                        <br/>
                        <span t-esc="extraLine"/>
                    </t>
                </a>
            </t>
        </t>
        <t t-else="">
            <div class="o_field_many2one_selection">
                <Many2XAutocomplete t-props="Many2XAutocompleteProps"/>
                <t t-if="hasExternalButton">
                    <button type="button" class="btn btn-link text-action oi o_external_button" t-att-class="env.inDialog ? 'oi-launch' : 'oi-arrow-right'" tabindex="-1" draggable="false" aria-label="Internal link" data-tooltip="Internal link" t-on-click="onExternalBtnClick"/>
                </t>
                <button t-if="hasBarcodeButton" t-on-click="onBarcodeBtnClick" type="button" class="btn ms-3 o_barcode" tabindex="-1" draggable="false" aria-label="Scan barcode" title="Scan barcode" data-tooltip="Scan barcode"/>
            </div>
            <div class="o_field_many2one_extra">
                <t t-foreach="extraLines" t-as="extraLine" t-key="extraLine_index">
                    <br t-if="!extraLine_first"/>
                    <span t-esc="extraLine"/>
                </t>
            </div>
        </t>
    </t>

<t t-name="web.Many2OneAvatarField">
        <div class="d-flex align-items-center gap-1" t-att-data-tooltip="props.record.data[props.name][1]">
            <span class="o_avatar o_m2o_avatar">
                <span t-if="props.record.data[props.name] === false and !props.readonly" class="o_avatar_empty o_m2o_avatar_empty"/>
                <img t-if="props.record.data[props.name] !== false" t-attf-src="/web/image/{{relation}}/{{props.record.data[props.name][0]}}/avatar_128" class="rounded"/>
            </span>
            <Many2OneField t-props="many2OneProps"/>
        </div>
    </t>

    <t t-name="web.KanbanMany2OneAvatarField">
        <div class="d-flex align-items-center gap-1" t-att-data-tooltip="props.record.data[props.name][1]">
            <span class="o_avatar o_m2o_avatar d-flex">
                <t t-if="props.record.data[props.name] === false and props.isEditable">
                <a t-on-click.stop.prevent="openPopover" tabIndex="-1" href="#" title="Assign" aria-label="Assign" class="o_quick_assign fa fa-user-plus btn-link d-flex align-items-center text-dark" role="button"/>
            </t>
        <img t-if="props.record.data[props.name] !== false" t-attf-src="/web/image/{{relation}}/{{props.record.data[props.name][0]}}/avatar_128" class="rounded"/>
            </span>
            <Many2OneField t-props="many2OneProps"/>
        </div>
    </t>

    <t t-name="web.MonetaryField">
        <span t-if="props.readonly" t-esc="formattedValue"/>
        <div class="text-nowrap d-inline-flex w-100 align-items-baseline" t-else="">
            <span t-if="!props.hideSymbol and currency" t-out="currencySymbol"/>
            <input t-ref="numpadDecimal" t-att-id="props.id" t-att-type="props.inputType" t-att-placeholder="props.placeholder" class="o_input flex-grow-1 flex-shrink-1" autocomplete="off"/>
        </div>
    </t>

<t t-name="web.PdfViewerField">
        <t t-if="!props.readonly">
            <div class="o_form_pdf_controls d-flex gap-1">
                <t t-if="props.record.data[props.name]">
                    <FileUploader acceptedFileExtensions="'.pdf'" onUploaded.bind="onFileUploaded">
                        <t t-set-slot="toggler">
                            <button class="btn btn-secondary fa fa-pencil o_select_file_button" data-tooltip="Edit" aria-label="Edit"/>
                        </t>
                        <button class="btn btn-secondary fa fa-trash o_clear_file_button" data-tooltip="Clear" aria-label="Clear" t-on-click="onFileRemove"/>
                    </FileUploader>
                </t>
                <t t-else="">
                    <label class="o_select_file_button btn btn-primary">
                        <FileUploader acceptedFileExtensions="'.pdf'" onUploaded.bind="onFileUploaded">
                            <t t-set-slot="toggler">
                                Upload your file
                            </t>
                        </FileUploader>
                    </label>
                </t>
            </div>
        </t>
        <t t-if="props.record.data[props.name]">
            <iframe class="o_pdfview_iframe" alt="PDF file" t-att-src="url" t-att-name="props.name" t-on-error="onLoadFailed"/>
        </t>
    </t>

<t t-name="web.PercentPieField">
        <figure class="o_pie mb-0 rounded-circle" t-attf-style="background: conic-gradient(                     var(--PercentPieField-color-active) 0% {{props.record.data[props.name]}}%,                     var(--PercentPieField-color-static) 0% 100%                 )"/>

        <div class="o_pie_info">
            <span class="o_pie_value" t-esc="formattedValue + '%'"/>
            <span class="o_pie_text" t-esc="props.string"/>
        </div>
    </t>

<t t-name="web.PercentageField">
        <t t-if="props.readonly">
            <span t-esc="formattedValue"/>
        </t>
        <t t-else="">
            <div class="d-flex">
                <input t-ref="numpadDecimal" t-attf-class="o_input" t-att-placeholder="props.placeholder" type="text" inputmode="decimal" autocomplete="off"/>
                <span>%</span>
            </div>
        </t>
    </t>

<t t-name="web.PhoneField">
        <div class="o_phone_content d-inline-flex w-100">
            <t t-if="props.readonly">
                <a t-if="props.record.data[props.name]" class="o_form_uri" t-att-href="phoneHref" t-esc="props.record.data[props.name]"/>
            </t>
            <t t-else="">
                <input class="o_input" t-att-id="props.id" type="tel" autocomplete="off" t-att-placeholder="props.placeholder" t-ref="input"/>
            </t>
        </div>
    </t>

    <t t-name="web.FormPhoneField">
        <div class="o_phone_content d-inline-flex w-100">
            <t t-if="props.readonly">
                <a t-if="props.record.data[props.name]" class="o_form_uri" t-att-href="phoneHref" t-esc="props.record.data[props.name]"/>
            </t>
            <t t-else="">
                <input class="o_input" t-att-id="props.id" type="tel" autocomplete="off" t-att-placeholder="props.placeholder" t-ref="input"/>
            <a t-if="props.record.data[props.name]" t-att-href="phoneHref" class="o_phone_form_link ms-3 d-inline-flex align-items-center">
                <i class="fa fa-phone"/><small class="fw-bold ms-1">Call</small>
            </a>
            </t>
        </div>
    </t>

    <t t-name="web.PriorityField">
        <div class="o_priority" role="radiogroup" name="priority" aria-label="Priority">
            <t t-foreach="options" t-as="value" t-key="value">
                <t t-if="!value_first">
                    <t t-if="props.readonly">
                        <span class="o_priority_star fa" role="radio" t-att-class="value_index lte index ? 'fa-star' : 'fa-star-o'" t-att-tabindex="value_index === state.index ? 0 : -1" t-att-data-tooltip="getTooltip(value[1])" t-att-aria-checked="value_index lte index" t-att-aria-label="value[1]"/>
                    </t>
                    <t t-else="">
                        <a href="#" class="o_priority_star fa" role="radio" t-att-class="value_index lte index ? 'fa-star' : 'fa-star-o'" t-att-tabindex="value_index === state.index ? 0 : -1" t-att-data-tooltip="getTooltip(value[1])" t-att-aria-checked="value_index lte index" t-att-aria-label="value[1]" t-on-click.prevent.stop="() =&gt; this.onStarClicked(value[0])" t-on-mouseenter="() =&gt; state.index = value_index" t-on-mouseleave="() =&gt; state.index = -1"/>
                    </t>
                </t>
            </t>
        </div>
    </t>

<t t-name="web.ProgressBarField">
        <div class="o_progressbar w-100 d-flex align-items-center" t-ref="numpadDecimal">
            <div t-if="props.title" class="o_progressbar_title text-nowrap pe-1"><t t-esc="props.title"/></div>
            <div class="o_progress align-middle overflow-hidden" aria-valuemin="0" t-att-aria-valuemax="this.maxValue" t-att-aria-valuenow="this.currentValue">
                <div t-attf-class="{{ progressBarColorClass }} h-100" t-att-style="'width: min(' + 100 * this.currentValue / this.maxValue + '%, 100%)'"/>
            </div>
            <div class="o_progressbar_value d-flex">
                <t t-if="isPercentage">
                    <input t-if="isEditable and props.isCurrentValueEditable" t-ref="currentValue" class="o_input h-100 text-center" type="text" inputmode="decimal" autocomplete="off" t-att-value="formatCurrentValue() or ''" t-att-required="props.required" t-on-change="onCurrentValueChange" t-on-focus="onInputFocus" t-on-blur="onInputBlur"/>
                    <span t-else="" class="mx-1" t-esc="formatCurrentValue(true)"/>
                    <span>%</span>
                </t>
                <t t-else="">
                    <input t-if="isEditable and props.isCurrentValueEditable" t-ref="currentValue" class="o_input h-100 text-center" type="text" inputmode="decimal" autocomplete="off" t-att-value="formatCurrentValue()" t-on-change="onCurrentValueChange" t-on-focus="onInputFocus" t-on-blur="onInputBlur"/>
                    <span t-else="" class="mx-1" t-esc="formatCurrentValue(true)"/>
                    /
                    <input t-if="isEditable and props.isMaxValueEditable" t-ref="maxValue" class="o_input h-100 text-center" type="text" inputmode="decimal" autocomplete="off" t-att-value="formatMaxValue()" t-on-change="onMaxValueChange" t-on-focus="onInputFocus" t-on-blur="onInputBlur"/>
                    <span t-else="" class="mx-1" t-esc="formatMaxValue(true)"/>
                </t>
            </div>
        </div>
    </t>

<t t-name="web.CardPropertiesField">
        <div t-ref="properties" class="w-100 fw-normal text-muted">
            <div class="o_card_property_field d-inline-flex flex-column justify-content-center align-items-start w-100 mb-1" t-foreach="propertiesList" t-as="propertyConfiguration" t-key="propertyConfiguration.name" t-if="propertyConfiguration.value and propertyConfiguration.view_in_cards">

                <div class="mw-100 text-truncate d-flex gap-2" t-att-class="{'border rounded-3 ps-2' : propertyConfiguration.type === 'boolean'}">
                    <label t-if="['integer', 'float', 'date', 'datetime', 'boolean'].includes(propertyConfiguration.type)" t-att-class="{'fw-bold' : propertyConfiguration.type !== 'boolean'}" t-out="propertyConfiguration.string"/>
                    <PropertyValue id="generateUniqueDomID()" canChangeDefinition="state.canChangeDefinition" comodel="propertyConfiguration.comodel || ''" context="props.context" domain="propertyConfiguration.domain || '[]'" readonly="props.readonly" selection="propertyConfiguration.selection" string="propertyConfiguration.string" tags="propertyConfiguration.tags" type="propertyConfiguration.type" value="propertyConfiguration.value" onChange.bind="() =&gt; {}" onTagsChange.bind="() =&gt; {}"/>
                </div>
            </div>
        </div>
    </t>
<t t-name="web.PropertiesField">
        <div t-ref="properties" class="row" t-att-class="{'d-none': propertiesList.length === 0 and !state.showAddButton}" t-att-columns="renderedColumnsCount">
            <t t-set="unfoldedSeparators" t-value="state.unfoldedSeparators"/>
            <t t-set="_groupedPropertiesList" t-value="groupedPropertiesList"/>
            <t t-foreach="groupedPropertiesList" t-as="propertiesListGroup" t-key="propertiesListGroup_index">
                <t t-set="foldable" t-value="propertiesListGroup.name and propertiesListGroup.title and propertiesListGroup.title.length"/>
                <t t-set="isFolded" t-value="propertiesListGroup.name and !unfoldedSeparators.includes(propertiesListGroup.name)"/>
                <div class="o_inner_group o_group col-lg-6 o_property_group" t-att-property-name="propertiesListGroup.name || ''">
                    <div t-if="!propertiesListGroup.invisibleLabel" class="o_field_property_label o_field_property_group_label d-flex flex-row w-100 mb-3 text-uppercase fw-bolder align-items-baseline pe-2" t-att-class="{'invisible': propertiesListGroup.columnSeparator}" t-on-click="() =&gt; this.onSeparatorClick(propertiesListGroup.name)">
                        <span t-if="propertiesListGroup.title" t-out="propertiesListGroup.title"/>
                        <i t-if="state.canChangeDefinition and !props.readonly and !propertiesListGroup.columnSeparator" class="o_field_property_open_popover fa fa-pencil ms-3" t-on-click.prevent.stop="(event) =&gt; this.onPropertyEdit(event, propertiesListGroup.name)"/>
                        <i t-if="state.canChangeDefinition and !props.readonly" class="oi oi-draggable ms-1 d-none d-sm-block"/>
                        <div t-if="foldable" class="ms-auto">
                            <i class="fa me-1" t-att-class="isFolded ? 'fa-caret-right' : 'fa-caret-down'"/>
                        </div>
                    </div>
                    <div t-foreach="propertiesListGroup.elements" t-as="propertyConfiguration" t-key="propertyConfiguration.name" class="o_property_field o_wrap_label" t-att-class="{                             'd-flex flex-row': !env.isSmall and !isFolded, 'o_property_folded': isFolded,                             'mb-4': renderedColumnsCount === 1, 'mb-3': renderedColumnsCount !== 1                         }" t-att-property-name="propertyConfiguration.name">
                        <t t-set="domId" t-value="generateUniqueDomID()"/>
                        <label class="o_field_property_label o_form_label text-break d-flex align-items-baseline mb-0" t-att-class="{'w-auto': env.isSmall}" t-att-for="domId">
                            <span t-if="propertyConfiguration.string and propertyConfiguration.string.length" t-out="propertyConfiguration.string" t-att-class="{'o_property_field_highlight': state.movedPropertyName === propertyConfiguration.name}"/>
                            <i t-else="" class="o_field_property_empty_label">
                                New Property
                            </i>
                            <i t-if="state.canChangeDefinition and !props.readonly" class="o_field_property_open_popover fa fa-pencil ms-2" t-on-click="(event) =&gt; this.onPropertyEdit(event, propertyConfiguration.name)"/>
                            <i t-if="state.canChangeDefinition and !props.readonly" class="oi oi-draggable ms-1 d-none d-sm-block"/>
                        </label>
                        <div class="o_property_field_value w-100">
                            <PropertyValue id="domId" canChangeDefinition="state.canChangeDefinition" checkDefinitionWriteAccess.bind="checkDefinitionWriteAccess ? checkDefinitionWriteAccess : () =&gt; {}" comodel="propertyConfiguration.comodel || ''" context="props.context" domain="propertyConfiguration.domain || '[]'" readonly="props.readonly" selection="propertyConfiguration.selection" string="propertyConfiguration.string" tags="propertyConfiguration.tags" type="propertyConfiguration.type" value="propertyConfiguration.value" onChange.bind="(value) =&gt; this.onPropertyValueChange(propertyConfiguration.name, value)" onTagsChange.bind="(newTags, newValue) =&gt; this.onTagsChange(propertyConfiguration.name, newTags, newValue)"/>
                        </div>
                    </div>
                    <div t-if="propertiesListGroup_index === _groupedPropertiesList.length - 1 and state.showAddButton" class="o_field_property_add d-none d-sm-block" t-att-class="{'g-col-2': props.columns !== 1}">
                        <button t-if="!props.readonly and state.canChangeDefinition and definitionRecordId" class="btn btn-light text-muted text-break m-0" t-on-click="onPropertyCreate">
                            <i class="fa fa-plus"/>
                            Add a Property
                        </button>
                    </div>
                </div>
            </t>
        </div>
    </t>
<t t-name="web.PropertyDefinition">
        <div class="o_field_property_definition o_field_widget o_form_view d-block" t-ref="propertyDefinition">
            <div class="d-flex justify-content-between px-3 border-bottom">
                <div t-if="!env.isSmall" class="border-end py-1">
                    <button t-attf-class="btn btn-link ps-0 {{this.isFirst ? 'disabled' : ''}}" t-on-click="() =&gt; this.onPropertyMove('up')" title="Move this Property up">
                        <i class="oi oi-chevron-up ms-2"/>
                    </button>
                    <button t-attf-class="btn btn-link pe-3 {{this.isLast ? 'disabled' : ''}}" t-on-click="() =&gt; this.onPropertyMove('down')" title="Move this Property down">
                        <i class="oi oi-chevron-down ms-2"/>
                    </button>
                </div>
                <button t-else="" class="btn oi oi-arrow-left my-2" t-on-click="() =&gt; this.props.close()"/>
                <button t-if="!props.readonly and props.canChangeDefinition" class="btn pe-0 text-danger float-end o_field_property_definition_delete" title="Remove Property" t-on-click="props.onDelete">
                    <i class="fa fa-trash"/> Delete
                </button>
            </div>
            <div class="o_modal_container p-3 o_inner_group grid">
                <div class="d-contents mb-3 mb-sm-0">
                    <label class="o_form_label align-self-center text-900">Label</label>
                    <h6 t-if="props.readonly" t-out="state.propertyDefinition.string" class="text-truncate"/>
                    <input class="o_input o_field_property_definition_header" type="text" required="" placeholder="Property Name" autocomplete="off" t-model="state.propertyDefinition.string" t-on-change="onPropertyLabelChange" t-on-keypress="onPropertyLabelKeypress"/>
                </div>
                <div class="d-contents mb-3 mb-sm-0">
                    <label t-att-for="getUniqueDomID('type')" class="o_form_label align-self-center text-900">
                        Field Type
                    </label>
                    <div class="o_field_property_definition_type">
                        <div t-if="props.readonly" class="d-flex align-items-center mb-2">
                            <img class="me-3" t-attf-src="/web/static/src/views/fields/properties/icons/{{state.propertyDefinition.type}}.png"/>
                            <span t-out="state.typeLabel"/>
                        </div>
                        <Dropdown t-else="" title="state.typeLabel" togglerClass="'btn btn-link d-flex p-0 w-100'">
                            <t t-set-slot="toggler">
                                <div class="o_input_dropdown w-100 o_field_property_dropdown">
                                    <img t-attf-src="/web/static/src/views/fields/properties/icons/{{state.propertyDefinition.type}}.png" class="position-relative z-index-1 me-n4"/>
                                    <input type="text" class="dropdown text-start w-100 o_input py-1 align-middle" t-att-id="getUniqueDomID('type')" t-att-value="state.typeLabel" readonly=""/>
                                    <span class="o_dropdown_button"/>
                                </div>
                            </t>
                            <t t-foreach="availablePropertyTypes" t-as="option" t-key="option[0]">
                                <DropdownItem onSelected.bind="() =&gt; this.onPropertyTypeChange(option[0])">
                                    <div class="d-flex align-items-center">
                                        <img class="me-2" t-attf-src="/web/static/src/views/fields/properties/icons/{{option[0]}}.png"/>
                                        <span t-out="option[1]"/>
                                    </div>
                                </DropdownItem>
                            </t>
                        </Dropdown>
                    </div>
                </div>

                <div t-if="state.propertyDefinition.type === 'selection'" class="d-contents mb-3 mb-sm-0">
                    <label class="o_form_label text-900">Values</label>
                    <PropertyDefinitionSelection readonly="props.readonly || !props.canChangeDefinition" canChangeDefinition="props.canChangeDefinition" default="state.propertyDefinition.default || ''" options="state.propertyDefinition.selection || []" onOptionsChange.bind="onSelectionOptionChange" onDefaultOptionChange.bind="onDefaultChange"/>
                </div>
                <div t-if="state.propertyDefinition.type === 'tags'" class="d-contents mb-3 mb-sm-0">
                    <label t-att-for="getUniqueDomID('tags')" class="o_form_label text-900">Tag</label>
                    <PropertyTags id="getUniqueDomID('tags')" selectedTags="propertyTagValues" tags="state.propertyDefinition.tags || []" readonly="props.readonly" canChangeTags="props.canChangeDefinition" checkDefinitionWriteAccess.bind="props.checkDefinitionWriteAccess ? props.checkDefinitionWriteAccess : () =&gt; {}" deleteAction="'tags'" onTagsChange.bind="onTagsChange"/>
                </div>
                <div t-if="state.propertyDefinition.type === 'many2one' || state.propertyDefinition.type === 'many2many'" class="o_field_property_definition_model d-contents mb-3 mb-sm-0">
                    <label t-att-for="getUniqueDomID('model')" class="o_form_label align-self-center text-900">Model</label>
                    <span t-if="props.readonly">
                        <t t-if="state.resModelDescription" t-out="state.resModelDescription"/>
                    </span>
                    <ModelSelector t-else="" id="getUniqueDomID('model')" value="state.resModelDescription" onModelSelected.bind="onModelChange"/>
                </div>
                <div t-if="(state.propertyDefinition.type === 'many2one' || state.propertyDefinition.type === 'many2many')                     and state.propertyDefinition.comodel and state.propertyDefinition.comodel.length" class="d-contents mb-3 mb-sm-0">
                    <label class="o_form_label text-900">Domain</label>
                    <div>
                        <DomainSelector resModel="state.propertyDefinition.comodel" domain="state.propertyDefinition.domain || '[]'" readonly="props.readonly" update.bind="onDomainChange" isDebugMode="!!env.debug" className="'d-inline-block me-2'"/>
                        <div t-if="state.matchingRecordsCount !== undefined" class="d-inline-block">
                            <i class="oi oi-arrow-right" role="img" title="Domain"/>
                            <button class="btn btn-sm btn-secondary" type="button" t-on-click.stop="onButtonDomainClick">
                                <t t-out="state.matchingRecordsCount"/> record(s)
                            </button>
                        </div>
                    </div>
                </div>
                <div t-if="!['tags', 'selection', 'separator'].includes(state.propertyDefinition.type)                     and (!['many2one', 'many2many'].includes(state.propertyDefinition.type)                     || (state.propertyDefinition.comodel and state.propertyDefinition.comodel.length))" class="o_field_property_definition_value d-contents mb-3 mb-sm-0">
                    <label t-att-for="getUniqueDomID('default')" class="o_form_label align-self-center text-900">
                        <t t-if="state.propertyDefinition.type === 'boolean'">Default State</t>
                        <t t-else="">Default Value</t>
                    </label>
                    <PropertyValue id="getUniqueDomID('default')" readonly="props.readonly" canChangeDefinition="props.canChangeDefinition" type="state.propertyDefinition.type" string="state.propertyDefinition.string" value="state.propertyDefinition.default" comodel="state.propertyDefinition.comodel || ''" domain="state.propertyDefinition.domain || '[]'" context="props.context" onChange.bind="onDefaultChange"/>
                </div>
                <div t-if="state.propertyDefinition.type !== 'separator'" class="o_field_property_definition_kanban d-contents mb-3 mb-sm-0">
                    <label t-att-for="getUniqueDomID('kanban')" class="o_form_label align-self-center text-900">
                        Display in Cards
                        <sup class="text-info" title="Whether or not this Property Field is displayed in the Calendar, Cards &amp; Kanban views">?</sup>
                    </label>
                    <CheckBox id="getUniqueDomID('kanban')" value="props.propertyDefinition.view_in_cards" disabled="props.readonly" onChange.bind="onViewInKanbanChange"/>
                </div>
            </div>
        </div>
    </t>
<t t-name="web.PropertyDefinitionSelection">
        <div class="o_field_property_selection d-flex" t-ref="propertyDefinitionSelection">
            <div class="w-100">
                <div t-foreach="optionsVisible" t-as="option" t-key="option[0]" class="o_field_property_selection_option d-flex flex-row align-items-center justify-content-between mb-2 rounded" t-att-option-name="option[0]">
                    <i t-if="!props.readonly and props.canChangeDefinition" class="o_field_property_selection_drag oi oi-draggable ui-sortable-handle me-2 text-center"/>
                    <span t-if="props.readonly" t-out="option[1]"/>
                    <input t-else="" class="o_input me-3" type="text" placeholder="Option Name" t-att-value="option[1]" t-on-change="(event) =&gt; this.onOptionChange(event, option_index)" t-on-blur="(event) =&gt; this.onOptionBlur(event, option_index)" t-on-keydown="(event) =&gt; this.onOptionKeyDown(event, option_index)"/>
                    <button class="btn btn-link m-0 p-0 text-muted fs-5" title="Select Default" t-on-click="() =&gt; this.onOptionSetDefault(option_index)">
                        <i t-att-class="option[0] === props.default ? 'fa fa-star align-bottom' : 'fa fa-star-o align-bottom'"/>
                    </button>
                    <button t-if="!props.readonly" class="btn btn-link link-danger ms-2 p-0 fs-5" title="Remove Property" t-on-click="() =&gt; this.onOptionDelete(option_index)">
                        <i class="fa fa-trash-o align-bottom"/>
                    </button>
                </div>
                <button t-if="!props.readonly" class="btn btn-link btn-sm" t-on-click="() =&gt; this.onOptionCreate(this.options.length)" t-ref="addButton">
                    <i class="fa fa-plus"/>
                    Add a Value
                </button>
            </div>
        </div>
    </t>
<t t-name="web.PropertyTags">

        <div t-attf-class="o_field_property_tag o_field_widget o_field_many2many_tags d-flex {{props.readonly ? 'readonly' : ''}}">
            <TagsList tags="tagListItems"/>
            <div t-if="!props.readonly" class="o_field_property_dropdown_menu o_input_dropdown">
                <AutoComplete id="props.id" value="''" sources="autocompleteSources" onSelect.bind="({value}) =&gt; this.onOptionSelected(value)" resetOnSelect="true"/>
                <span class="o_dropdown_button"/>
            </div>
        </div>
    </t>
    <t t-name="web.PropertyTagsColorListPopover">
        <div class="o_tag_popover m-2">
            <ColorList colors="props.colors" forceExpanded="true" onColorSelected.bind="(id) =&gt; props.switchTagColor(id, props.tag)"/>
        </div>
    </t>
    <t t-name="web.PropertyTagsField">
        <PropertyTags t-props="propertyTagsProps"/>
    </t>
<t t-name="web.PropertyValue">
        <t t-if="props.readonly and !['boolean', 'many2one', 'many2many', 'tags'].includes(props.type)">
            <span t-if="displayValue" t-out="displayValue"/>
        </t>
        <t t-else="">
            <t t-if="props.type === 'boolean'">
                <CheckBox id="props.id" value="propertyValue" disabled="props.readonly" onChange.bind="onValueChange"/>
            </t>
            <t t-elif="['date', 'datetime'].includes(props.type)">
                <DateTimeInput id="props.id" type="props.type" value="propertyValue" onChange.bind="onValueChange"/>
            </t>
            <t t-elif="props.type === 'integer'">
                <input t-att-id="props.id" class="o_input o_field_property_input" type="text" autocomplete="off" t-att-value="displayValue" t-on-change="(event) =&gt; this.onValueChange(event.target.value)"/>
            </t>
            <t t-elif="props.type === 'float'">
                <input t-att-id="props.id" class="o_input o_field_property_input" type="text" autocomplete="off" t-att-value="displayValue" t-on-change="(event) =&gt; this.onValueChange(event.target.value)"/>
            </t>
            <t t-elif="props.type === 'selection'">
                <select class="o_input" t-on-change="event =&gt; this.onValueChange(event.target.value)" t-att-id="props.id">
                    <option t-att-value="false"/>
                    <t t-foreach="props.selection || []" t-as="option" t-key="option[0]">
                        <option t-att-selected="option[0] === propertyValue" t-att-value="option[0]" t-out="option[1]"/>
                    </t>
                </select>
            </t>
            <t t-elif="props.type === 'tags'">
                <PropertyTags id="props.id" selectedTags="propertyValue" tags="props.tags || []" deleteAction="'value'" readonly="props.readonly" canChangeTags="props.canChangeDefinition" checkDefinitionWriteAccess.bind="props.checkDefinitionWriteAccess ? props.checkDefinitionWriteAccess : () =&gt; {}" onValueChange.bind="onValueChange" onTagsChange.bind="props.onTagsChange"/>
            </t>
            <div t-elif="props.type === 'many2one'" class="o_field_property_many2one_value d-flex flex-row align-items-center" t-att-class="{'avatar': showAvatar}">
                <t t-if="props.comodel">
                    <t t-set="hasAccess" t-value="!propertyValue || propertyValue[1]"/>
                    <img t-if="showAvatar and propertyValue[0] and hasAccess" t-attf-src="/web/image/{{props.comodel}}/{{propertyValue[0]}}/avatar_128" class="o_avatar rounded me-1"/>
                    <t t-if="props.readonly || !hasAccess">
                        <a t-if="clickableRelational || !hasAccess" t-attf-class="o_form_uri {{propertyValue and propertyValue[1] ? '' : 'disabled'}}" t-att-href="propertyValue[0] ? \`#id=\${propertyValue[0]}&amp;model=\${props.comodel}\` : '#'" t-on-click.prevent="onMany2oneClick">
                            <t t-if="hasAccess" t-out="propertyValue[1]"/>
                            <t t-else="">No Access</t>
                        </a>
                        <span t-else="" t-out="propertyValue and propertyValue[1] || ''"/>
                    </t>
                    <Many2XAutocomplete t-else="" t-key="props.id + '_' + props.comodel + '_' + props.string" value="propertyValue[1] || ''" id="props.id" resModel="props.comodel" autoSelect="true" fieldString="props.string" update.bind="onValueChange" context="props.context" getDomain.bind="() =&gt; propertyDomain" quickCreate.bind="onQuickCreate" activeActions="{ create: true, createEdit: true, write: true }"/>
                    <button t-if="!props.readonly and propertyValue and propertyValue[0] and hasAccess" type="button" class="btn btn-secondary oi oi-arrow-right o_external_button o_properties_external_button py-0" tabindex="-1" draggable="false" aria-label="Internal link" data-tooltip="Internal link" t-on-click="onExternalLinkClick"/>
                </t>
            </div>
            <t t-elif="props.type === 'many2many'">
                <div t-if="props.comodel" class="o_field_property_many2many_value d-flex flex-wrap flex-row gap-1 ms-0 pe-1 w-100 " t-attf-class="o_field_widget o_field_many2many_tags {{showAvatar ? 'avatar' : ''}} {{props.readonly ? 'readonly' : ''}}">

                    <TagsList tags="propertyValue"/>
                    <Many2XAutocomplete t-if="!props.readonly" t-key="props.id + '_' + props.comodel + '_' + props.string" id="props.id" resModel="props.comodel" autoSelect="true" fieldString="props.string" update.bind="onValueChange" context="props.context" getDomain.bind="() =&gt; propertyDomain" quickCreate.bind="onQuickCreate" activeActions="{ create: true, createEdit: true, write: true }" isToMany="true"/>
                </div>
            </t>
            <t t-else="">
                <input class="o_input" t-att-id="props.id" type="text" autocomplete="off" t-att-value="propertyValue || ''" t-on-change="(event) =&gt; this.onValueChange(event.target.value)"/>
            </t>
        </t>
    </t>
<t t-name="web.RadioField">
        <div role="radiogroup" t-attf-class="o_{{ props.orientation }}" t-att-aria-label="props.label">
            <t t-foreach="items" t-as="item" t-key="item[0]">
                <div class="form-check o_radio_item" aria-atomic="true">
                    <input type="radio" class="form-check-input o_radio_input" t-att-checked="item[0] === value" t-att-disabled="props.readonly" t-att-name="id" t-att-data-value="item[0]" t-att-data-index="item_index" t-att-id="\`\${id}_\${item[0]}\`" t-on-change="() =&gt; this.onChange(item)"/>
                    <label class="form-check-label o_form_label" t-att-for="\`\${id}_\${item[0]}\`" t-esc="item[1]"/>
                </div>
            </t>
        </div>
    </t>

<t t-name="web.ReferenceField">
        <div class="o_row">
            <t t-if="!props.readonly and !hideModelSelector">
                <select class="o_input" t-att-tabindex="relation ? '-1': 0" t-on-change="(ev) =&gt; this.updateModel(ev.target.value || false)">
                    <option/>
                    <t t-foreach="selection" t-as="option" t-key="option[0]">
                        <option t-att-value="option[0]" t-att-selected="option[0] === relation" t-esc="option[1]"/>
                    </t>
                </select>
            </t>
            <t t-if="relation">
                <Many2OneField t-key="m2oProps.relation" t-props="m2oProps"/>
            </t>
        </div>
    </t>

<t t-name="web.X2ManyFieldDialog">
    <Dialog title="title" withBodyPadding="false" modalRef="modalRef" contentClass="contentClass">
        <FormRenderer record="record" archInfo="archInfo"/>
        <t t-set-slot="footer">
            <t t-if="footerArchInfo">
                <FormRenderer record="record" archInfo="footerArchInfo"/>
            </t>
            <t t-else="">
                <t t-if="record.isInEdition">
                    <t t-if="canCreate">
                        <button class="btn btn-primary o_form_button_save" t-on-click="save" data-hotkey="c">Save &amp; Close</button>
                        <button class="btn btn-primary o_form_button_save_new" t-on-click="saveAndNew" data-hotkey="n">Save &amp; New</button>
                    </t>
                    <t t-else="">
                        <button class="btn btn-primary o_form_button_save" t-on-click="save" data-hotkey="c">Save</button>
                    </t>
                    <button class="btn btn-secondary o_form_button_cancel" t-on-click="discard" data-hotkey="j">Discard</button>

                    <t t-if="props.delete">
                        <button class="btn btn-secondary o_btn_remove" t-on-click="remove" data-hotkey="k">
                            <t t-if="props.deleteButtonLabel" t-out="props.deleteButtonLabel"/>
                            <t t-else="">Remove</t>
                        </button>
                    </t>
                </t>
                <t t-else="">
                    <button class="btn btn-primary o_form_button_cancel" t-on-click="() =&gt; this.props.close()" data-hotkey="j">Close</button>
                </t>
            </t>
        </t>
    </Dialog>
</t>

<t t-name="web.Many2XAutocomplete">
    <div class="o_input_dropdown" t-ref="autocomplete_container">
        <input t-if="env.isSmall and props.dropdown" type="text" t-att-id="props.id" class="o_input" readonly="" autocomplete="off" t-att-placeholder="props.placeholder" t-att-value="props.value" t-on-click="onSearchMore" t-on-barcode-search="onBarcodeSearch"/>
        <AutoComplete t-else="" value="props.value" id="props.id" placeholder="props.placeholder" sources="sources" autoSelect="props.autoSelect" onSelect.bind="onSelect" onInput.bind="onInput" onChange.bind="onChange" dropdown="props.dropdown" autofocus="props.autofocus" resetOnSelect="props.value === ''" onCancel.bind="onCancel"/>
        <span class="o_dropdown_button"/>
    </div>
</t>

<t t-name="web.AvatarMany2XAutocomplete">
    <span class="o_avatar_many2x_autocomplete o_avatar d-flex align-items-center">
        <img t-if="option.value" class="rounded me-1" t-attf-src="/web/image/{{option.resModel}}/{{option.value}}/avatar_128"/>
        <t t-esc="option.label"/>
    </span>
</t>

<t t-name="web.RemainingDaysField">
        <t t-if="props.readonly">
            <t t-set="days" t-value="diffDays"/>
            <t t-set="formatted" t-value="formattedValue"/>
            <div t-att-class="{                     'fw-bold': days !== null and days lte 0,                     'text-danger': days !== null and days lt 0,                     'text-warning': days !== null and days === 0,                 }" t-att-title="formatted">
                <t t-esc="diffString"/>
            </div>
        </t>
        <t t-else="">
            <DateTimeField t-props="props"/>
        </t>
    </t>
<t t-name="web.SelectionField">
        <t t-if="props.readonly">
            <span t-esc="string" t-att-raw-value="value"/>
        </t>
        <t t-else="">
            <select class="o_input pe-3" t-on-change="onChange" t-on-click.stop="() =&gt; {}" t-att-id="props.id">
                <option t-att-selected="false === value" t-att-value="stringify(false)" t-esc="this.props.placeholder || ''" t-attf-style="{{ props.required ? 'display:none' : '' }}"/>
                <t t-foreach="options" t-as="option" t-key="option[0]">
                    <option t-att-selected="option[0] === value" t-att-value="stringify(option[0])" t-esc="option[1]"/>
                </t>
            </select>
        </t>
    </t>

<t t-name="web.SignatureField">
        <t t-if="value">
            <img class="o_signature img img-fluid" alt="Binary file" t-att-src="getUrl" t-att-name="props.name" t-att-style="sizeStyle" t-on-click="onClickSignature" t-on-error.stop="onLoadFailed"/>
        </t>
        <t t-else="">
            <div class="o_signature o_signature_empty" t-att-style="sizeStyle" t-on-click="onClickSignature">
                <svg t-on-error.stop="onLoadFailed"/>
                <p>SIGNATURE</p>
            </div>
        </t>
    </t>

<t t-name="web.StatInfoField">
        <span class="o_stat_info o_stat_value" t-esc="formattedValue"/>
        <span t-if="!props.noLabel" class="o_stat_text" t-esc="label"/>
    </t>

<t t-name="web.StateSelectionField">
        <t t-if="props.readonly">
            <button class="d-flex align-items-center btn fw-normal p-0">
                <span t-attf-class="o_status {{ statusColor(currentValue) }} "/>
                <span t-if="props.showLabel" class="o_status_label ms-1" t-esc="label"/>
            </button>
        </t>
        <t t-else="">
            <Dropdown togglerClass="'btn btn-link d-flex p-0'">
                <t t-set-slot="toggler">
                    <div class="d-flex align-items-center" t-att-title="props.showLabel ? '' : label">
                        <span t-attf-class="o_status {{ statusColor(currentValue) }} "/>
                        <span t-if="props.showLabel" class="o_status_label ms-1" t-esc="label"/>
                    </div>
                </t>
                <t t-foreach="options" t-as="option" t-key="option[0]">
                    <DropdownItem class="\`d-flex align-items-center \${option[0] === currentValue ? 'active' : ''}\`" onSelected="() =&gt; this.updateRecord(option[0])">
                            <span t-attf-class="o_status ms-2 {{ statusColor(option[0]) }} "/>
                            <span t-esc="option[1]"/>
                    </DropdownItem>
                </t>
            </Dropdown>
        </t>
    </t>

<t t-name="web.StatusBarField.Dropdown">
        <Dropdown toggler="'parent'">
            <t t-foreach="items" t-as="item" t-key="item.value">
                <DropdownItem class="getDropdownItemClassNames(item)" onSelected="() =&gt; this.selectItem(item)">
                    <span t-esc="item.label"/>
                </DropdownItem>
            </t>
        </Dropdown>

        <t t-esc="label"/>
    </t>

    <t t-name="web.StatusBarField">
        <div class="o_statusbar_status" t-ref="root" role="radiogroup">
            <button t-ref="after" type="button" class="btn btn-secondary dropdown-toggle o_arrow_button o_first">
                <t t-call="web.StatusBarField.Dropdown">
                    <t t-set="label">...</t>
                    <t t-set="items" t-value="items.after"/>
                </t>
            </button>
            <t t-foreach="items.inline" t-as="item" t-key="item.value">
                <button type="button" class="btn btn-secondary o_arrow_button" t-att-class="{                         o_first: item_first,                         o_arrow_button_current: item.isSelected,                         o_last: item_last,                     }" t-att-disabled="props.isDisabled || item.isSelected" role="radio" t-att-aria-label="getItemTooltip(item)" t-att-aria-checked="item.isSelected.toString()" t-att-aria-current="item.isSelected and 'step'" t-att-data-value="item.value" t-esc="item.label" t-on-click="() =&gt; this.selectItem(item)"/>
            </t>
            <button t-ref="before" type="button" class="btn btn-secondary dropdown-toggle o_arrow_button o_last">
                <t t-call="web.StatusBarField.Dropdown">
                    <t t-set="label">...</t>
                    <t t-set="items" t-value="items.before"/>
                </t>
            </button>
            <button t-ref="dropdown" type="button" class="btn btn-secondary dropdown-toggle">
                <t t-call="web.StatusBarField.Dropdown">
                    <t t-set="label" t-value="getCurrentLabel()"/>
                    <t t-set="items" t-value="getAllItems()"/>
                </t>
            </button>
        </div>
    </t>
<t t-name="web.TextField">
        <t t-if="props.readonly">
            <span t-esc="props.record.data[props.name] or ''"/>
        </t>
        <t t-else="">
            <div t-ref="div">
                <textarea class="o_input" t-att-class="{'o_field_translate': isTranslatable}" t-att-id="props.id" t-att-placeholder="props.placeholder" t-att-rows="rowCount" t-ref="textarea"/>
                <t t-if="isTranslatable">
                    <TranslationButton fieldName="props.name" record="props.record"/>
                </t>
            </div>
        </t>
    </t>

<t t-name="web.TimezoneMismatchField">
        <t t-if="props.readonly">
            <span t-esc="string" t-att-raw-value="value"/>
        </t>
        <t t-else="">
            <select class="o_input pe-3" t-on-change="onChange" t-on-click.stop="() =&gt; {}" t-att-id="props.id">
                <option t-att-selected="false === value" t-att-value="stringify(false)" t-esc="this.props.placeholder || ''" t-attf-style="{{ props.required ? 'display:none' : '' }}"/>
                <t t-foreach="options" t-as="option" t-key="option[0]">
                    <option t-att-selected="option[0] === value" t-att-value="stringify(option[0])" t-esc="option[1]"/>
                </t>
            </select>
        </t>
            <span t-if="mismatch" class="o_tz_warning fa fa-exclamation-triangle position-static align-self-center m-0 ms-2" t-att-title="mismatchTitle"/>
    </t>

<t t-name="web.TranslationButton">
        <t t-if="isMultiLang">
            <span class="o_field_translate btn btn-link" t-on-click.prevent="onClick">
                <t t-esc="lang"/>
            </span>
        </t>
    </t>

<t t-name="web.TranslationDialog">
        <Dialog title="title">
            <div class="o_translation_dialog">
                <t t-foreach="terms" t-as="term" t-key="term.id">
                    <div class="row">
                        <div class="col-12" t-att-class="{ o_language_current: term.lang === user.lang }" t-attf-class="col-lg-{{ props.showSource ? 2 : 3 }}">
                            <t t-esc="term.langName"/>
                        </div>
                        <t t-if="props.showSource">
                            <div class="col-12 col-lg-3 source">
                                <t t-esc="term.source"/>
                            </div>
                        </t>
                        <div class="col-12 translation" t-attf-class="col-lg-{{ props.showSource ? 7 : 9 }}">
                            <t t-if="props.isText">
                                <textarea class="o_field_text o_field_translate o_field_widget o_input" t-att-value="term.value" t-att-data-id="term.id" t-att-rows="props.showSource ? 2 : 5" t-on-change="(ev) =&gt; this.updatedTerms[term.id] = ev.target.value"/>
                            </t>
                            <t t-else="">
                                <input type="text" class="o_field_char o_input" t-att-value="term.value" t-att-data-id="term.id" t-on-change="(ev) =&gt; this.updatedTerms[term.id] = ev.target.value"/>
                            </t>
                        </div>
                    </div>
                </t>
            </div>
            <t t-set-slot="footer">
                <button class="btn btn-primary" t-on-click="onSave">Save</button>
                <button class="btn" t-on-click="props.close">Discard</button>
            </t>
        </Dialog>
    </t>

<t t-name="web.UrlField">
        <t t-if="props.readonly">
            <a class="o_field_widget o_form_uri" t-on-click.stop="" t-att-href="formattedHref" t-esc="props.text || props.record.data[props.name] || ''" target="_blank"/>
        </t>
        <t t-else="">
            <div class="d-inline-flex w-100">
                <input class="o_input" t-att-id="props.id" type="text" autocomplete="off" t-att-placeholder="props.placeholder" t-att-required="props.required" t-ref="input"/>
            </div>
        </t>
    </t>

    <t t-name="web.FormUrlField">
        <t t-if="props.readonly">
            <a class="o_field_widget o_form_uri" t-on-click.stop="" t-att-href="formattedHref" t-esc="props.text || props.record.data[props.name] || ''" target="_blank"/>
        </t>
        <t t-else="">
            <div class="d-inline-flex w-100">
                <input class="o_input" t-att-id="props.id" type="text" autocomplete="off" t-att-placeholder="props.placeholder" t-att-required="props.required" t-ref="input"/>
            <a t-if="props.record.data[props.name]" t-att-href="formattedHref" class="ms-3 d-inline-flex align-items-center" target="_blank">
                <i class="fa fa-globe" data-tooltip="Go to URL" aria-label="Go to URL"/>
            </a>
            </div>
        </t>
    </t>

    <t t-name="web.ListX2ManyField">
       <t t-esc="formattedValue"/>
    </t>

<t t-name="web.X2ManyField">
        <div t-att-class="className">
            <div class="o_x2m_control_panel d-empty-none mb-4">
                <t t-if="displayControlPanelButtons">
                    <div class="o_cp_buttons gap-1" role="toolbar" aria-label="Control panel buttons" t-ref="buttons">
                        <t t-foreach="creates" t-as="create" t-key="create_index">
                            <button t-if="create.type === 'create'" type="button" class="btn btn-secondary" t-att-class="create.class" t-on-click.stop.prevent="() =&gt; this.onAdd({ context: create.context })">
                                <t t-esc="create.string"/>
                            </button>
                            <ViewButton t-if="create.type === 'button'" className="\`\${create.className}\`" clickParams="create.clickParams" icon="create.icon" record="props.record.data[props.name]" string="create.string" title="create.title"/>
                        </t>
                    </div>
                </t>
                <div t-if="props.record.data[props.name].count &gt; props.record.data[props.name].limit" class="o_cp_pager" role="search">
                    <Pager t-props="pagerProps"/>
                </div>
            </div>
            <ListRenderer t-if="props.viewMode === 'list'" t-props="rendererProps"/>
            <KanbanRenderer t-elif="props.viewMode" t-props="rendererProps"/>
        </div>
    </t>

<t t-name="web.Form.ButtonBox">
    <div class="o-form-buttonbox position-relative d-flex w-md-auto" t-attf-class="{{ isFull ? 'o_full w-100' : 'o_not_full'}} {{this.props.class}}">
        <t t-slot="{{ button_value }}" t-foreach="visibleButtons" t-as="button" t-key="button_value"/>
        <t t-if="additionalButtons.length">
            <Dropdown position="'bottom-end'" togglerClass="'o_button_more btn btn-outline-secondary d-flex justify-content-center align-items-center'" menuClass="'o_dropdown_more position-absolute top-100 p-0 border-0'" class="'oe_stat_button btn position-relative p-0 border-0'">
                <t t-set-slot="toggler"><span>More</span></t>
                <DropdownItem t-foreach="additionalButtons" t-as="button" t-key="button_value" class="'d-flex flex-column p-0'">
                    <t t-slot="{{ button_value }}"/>
                </DropdownItem>
            </Dropdown>
        </t>
    </div>
</t>

<t t-name="web.FormView">
        <div t-att-class="className" t-ref="root">
            <div class="o_form_view_container">
                <Layout className="model.useSampleModel ? 'o_view_sample_data' : ''" display="display">
                    <t t-set-slot="control-panel-create-button">
                        <t t-if="canCreate">
                            <button type="button" class="btn btn-secondary o_form_button_create" data-hotkey="c" t-on-click.stop="create">New</button>
                        </t>
                    </t>

                    <t t-set-slot="layout-buttons">
                        <t t-if="env.inDialog">
                            <t t-if="footerArchInfo">
                                <t t-component="props.Renderer" record="model.root" Compiler="props.Compiler" archInfo="footerArchInfo"/>
                            </t>
                            <t t-else="">
                                <t t-call="{{ props.buttonTemplate }}"/>
                            </t>
                        </t>
                    </t>

                    <t t-set-slot="layout-actions">
                        <t t-if="buttonBoxTemplate">
                            <t t-call="{{ buttonBoxTemplate }}" t-call-context="{ __comp__: Object.assign(Object.create(this), { this, props: { ...this.props, record: this.model.root } }) }"/>
                        </t>
                    </t>

                    <t t-set-slot="control-panel-additional-actions">
                        <CogMenu getActiveIds="() =&gt; model.root.isNew ? [] : [model.root.resId]" context="props.context" items="props.info.actionMenus ? this.actionMenuItems : {}" isDomainSelected="model.root.isDomainSelected" resModel="model.root.resModel" domain="props.domain" onActionExecuted="() =&gt; model.load({ resId: model.root.resId, resIds: model.root.resIds })" shouldExecuteAction.bind="shouldExecuteAction"/>
                    </t>

                    <t t-set-slot="control-panel-status-indicator">
                        <t t-if="canEdit">
                            <FormStatusIndicator model="model" discard.bind="discard" save.bind="saveButtonClicked"/>
                        </t>
                    </t>
                    <t t-set-slot="control-panel-create-button">
                        <t t-if="canCreate">
                            <button type="button" class="btn btn-outline-primary o_form_button_create" data-hotkey="c" t-on-click.stop="create">New</button>
                        </t>
                    </t>
                    <t t-component="props.Renderer" record="model.root" Compiler="props.Compiler" archInfo="archInfo" translateAlert="translateAlert" onNotebookPageChange.bind="onNotebookPageChange" activeNotebookPages="props.state and props.state.activeNotebookPages"/>
                </Layout>
            </div>
        </div>
    </t>

    <t t-name="web.FormView.Buttons">
        <div class="o_cp_buttons d-flex align-items-baseline w-100" role="toolbar" aria-label="Main actions" t-ref="cpButtons">
            <div t-if="model.root.isInEdition" class="o_form_buttons_edit d-flex gap-1">
                <button type="button" class="btn btn-primary o_form_button_save" data-hotkey="s" t-on-click.stop="() =&gt; this.saveButtonClicked({closable: true})">
                    Save
                </button>
                <button type="button" class="btn btn-secondary o_form_button_cancel" data-hotkey="j" t-on-click.stop="discard">
                    Discard
                </button>
                <button t-if="props.removeRecord" class="btn btn-secondary o_form_button_remove" t-on-click="props.removeRecord" data-hotkey="x">
                    Remove
                </button>
            </div>
            <div t-elif="canCreate" class="o_form_buttons_view">
                <button type="button" class="btn btn-secondary o_form_button_create" data-hotkey="c" t-on-click.stop="create">
                    New
                </button>
            </div>
        </div>
    </t>
<t t-name="web.FormErrorDialog">
        <Dialog header="false" size="'md'" contentClass="'o_error_dialog'">
            <div role="alert">
                <h1 class="text-danger">Oh snap!</h1>
                <p t-esc="props.message" class="text-prewrap"/>
            </div>
            <t t-set-slot="footer">
                <button class="btn btn-primary" t-on-click="stay">Stay here</button>
                <button class="btn btn-secondary" t-on-click="discard">Discard changes</button>
            </t>
        </Dialog>
    </t>

<t t-name="web.Form.OuterGroup">
    <div class="o_group row align-items-start" t-attf-class="{{ allClasses }}" t-att-style="props.style">
        <t t-slot="title" t-if="props.slots and props.slots.title"/>
        <t t-foreach="getItems()" t-as="item" t-key="item_index">
            <span class="o_newline" t-if="item.newline"/>
            <t t-slot="{{ item.name }}" className="item.colspan !== props.maxCols ? 'col-lg-' + item.size : ''"/>
        </t>
    </div>
</t>

<t t-name="web.Form.InnerGroup">
    <div t-attf-class="{{ allClasses }}" class="o_inner_group grid" t-att-style="props.style">
        <div t-if="props.slots and props.slots.title" t-attf-class="g-col-sm-{{ props.maxCols }}">
            <t t-slot="title"/>
        </div>
        <div t-foreach="getRows()" t-as="row" t-key="row_index" class="o_wrap_field d-flex d-sm-contents flex-column mb-3 mb-sm-0" t-if="row.isVisible">
            <t t-foreach="row" t-as="cell" t-key="cell_index">

                <t t-if="cell.subType === 'item_component'">
                    <t t-call="web.Form.InnerGroup.ItemComponent"><t t-set="cell" t-value="cell"/></t>
                </t>

                <t t-else="">
                    <div class="o_cell flex-grow-1 flex-sm-grow-0" t-attf-style="{{ cell.itemSpan &gt; 1 ? 'grid-column: span ' + cell.itemSpan + ';' : '' }}{{ cell.width ? 'width: ' + cell.width + '%' + ';' : '' }}" t-attf-class="{{ cell.subType === 'label' ? 'o_wrap_label w-100 text-break text-900' : null }}" t-if="cell.isVisible">
                        <t t-slot="{{ cell.name }}"/>
                    </div>
                </t>

            </t>
        </div>
    </div>
</t>

<t t-name="web.Form.InnerGroup.ItemComponent">
    <t t-if="cell.props.fieldInfo.field.component.name !== 'BooleanField'">
        <div class="o_cell o_wrap_label flex-grow-1 flex-sm-grow-0 w-100 text-break text-900">
            <t t-component="cell.Component" t-if="cell.isVisible" t-props="cell.props"/>
        </div>
        <div class="o_cell o_wrap_input flex-grow-1 flex-sm-grow-0 text-break" t-attf-style="{{ cell.itemSpan -1 &gt; 1 ? 'grid-column: span ' + (cell.itemSpan -1) + ';' : '' }}{{ cell.width ? 'width: ' + cell.width + '%' + ';' : '' }}">
            <t t-slot="{{ cell.name }}"/>
        </div>
    </t>
    <t t-else="">
        <div class="o_wrap_field_boolean d-flex flex-wrap d-sm-contents flex-sm-nowrap">
            <div class="o_cell o_wrap_label flex-sm-grow-0 text-break text-900">
                <t t-component="cell.Component" t-if="cell.isVisible" t-props="cell.props"/>
            </div>
            <div class="o_cell o_wrap_input order-first flex-sm-grow-0 order-sm-0" t-attf-style="{{ cell.itemSpan -1 &gt; 1 ? 'grid-column: span ' + (cell.itemSpan -1) + ';' : '' }}">
                <t t-slot="{{ cell.name }}"/>
            </div>
        </div>
    </t>
</t>

<t t-name="web.FormLabel">
        <label class="o_form_label" t-att-for="props.id" t-att-class="className">
            <t t-esc="props.string"/><sup class="text-info p-1" t-if="hasTooltip" t-att="{'data-tooltip-template': 'web.FieldTooltip', 'data-tooltip-info': tooltipInfo, 'data-tooltip-touch-tap-to-show': 'true'}">?</sup>
        </label>
    </t>

<t t-name="web.FormStatusIndicator">
        <div class="o_form_status_indicator d-md-flex align-items-center align-self-md-end me-auto" t-att-class="{ o_form_status_indicator_new_record: props.model.root.isNew }">
            <div class="o_form_status_indicator_buttons d-flex" t-att-class="{ invisible: !(props.model.root.isNew or displayButtons) }">
                <button type="button" class="o_form_button_save btn btn-light px-1 py-0 lh-sm" data-hotkey="s" t-on-click.stop="save" data-tooltip="Save manually" aria-label="Save manually" t-ref="save">
                    <i class="fa fa-cloud-upload fa-fw"/>
                </button>
                <button type="button" class="o_form_button_cancel btn btn-light px-1 py-0 lh-sm" data-hotkey="j" t-on-click.stop="discard" data-tooltip="Discard changes" aria-label="Discard changes">
                    <i class="fa fa-undo fa-fw"/>
                </button>
            </div>
            <span t-if="!props.model.root.isNew and indicatorMode === 'invalid'" class="text-danger small ms-2" data-tooltip="Unable to save. Correct the issue or discard changes">
                <i class="fa fa-warning"/>
            </span>
        </div>
    </t>
<t t-name="web.Setting">
        <div t-att-class="classNames">
            <div class="o_setting_left_pane" t-att-data-tooltip="props.title" data-tooltip-delay="800">
                <t t-if="props.fieldName and fieldType==='boolean'">
                    <t t-slot="fieldSlot"/>
                </t>
            </div>
            <div class="o_setting_right_pane" t-att-data-tooltip="props.title" data-tooltip-delay="800">
                <FormLabel t-if="props.fieldName and props.addLabel" notMuttedLabel="notMuttedLabel" fieldName="props.fieldName" id="props.fieldId" string="labelString" record="props.record" fieldInfo="props.fieldInfo"/>
                <t t-if="labelString and !props.fieldName and props.addLabel">
                    <span class="o_form_label"><t t-esc="labelString"/></span>
                </t>
                <t t-if="labelString and props.documentation">
                    <DocumentationLink path="props.documentation"/>
                </t>
                <t t-if="displayCompanyDependentIcon">
                    <span class="fa fa-lg fa-building-o" title="Values set here are company-specific."/>
                </t>
                <t t-if="labelString and props.help">
                    <div class="text-muted"><t t-esc="props.help"/></div>
                </t>
                <div class="mt16">
                    <t t-if="props.fieldName and fieldType!=='boolean'">
                        <t t-slot="fieldSlot"/>
                    </t>
                    <t t-slot="default"/>
                </div>
            </div>
        </div>
    </t>
<t t-name="web.StatusBarButtons">
        <div class="o_statusbar_buttons d-flex align-items-center align-content-around flex-wrap gap-1">
            <t t-set="slots" t-value="visibleSlotNames"/>
            <t t-if="env.isSmall and slots.length &gt; 1">
                <Dropdown togglerClass="'btn btn-primary'" showCaret="true">
                    <t t-set-slot="toggler">Action</t>
                    <t t-foreach="slots" t-as="slot" t-key="slot">
                        <DropdownItem class="'o_statusbar_button_dropdown_item'">
                            <t t-slot="{{ slot }}"/>
                        </DropdownItem>
                    </t>
                </Dropdown>
            </t>
            <t t-else="">
                <t t-foreach="slots" t-as="slot" t-key="slot">
                    <t t-slot="{{ slot }}"/>
                </t>
            </t>
        </div>
    </t>

<t t-name="web.GraphView.Buttons">
        <div class="btn-group" role="toolbar" aria-label="Main actions">
            <t t-call="web.ReportViewMeasures">
                <t t-set="measures" t-value="model.metaData.measures"/>
                <t t-set="activeMeasures" t-value="[model.metaData.measure]"/>
            </t>
        </div>
        <div class="btn-group" role="toolbar" aria-label="Change graph">
            <button class="btn btn-secondary fa fa-bar-chart o_graph_button" data-tooltip="Bar Chart" aria-label="Bar Chart" data-mode="bar" t-on-click="() =&gt; this.onModeSelected('bar')" t-att-class="{ active: model.metaData.mode === 'bar' }"/>
            <button class="btn btn-secondary fa fa-line-chart o_graph_button" data-tooltip="Line Chart" aria-label="Line Chart" data-mode="line" t-on-click="() =&gt; this.onModeSelected('line')" t-att-class="{ active: model.metaData.mode === 'line' }"/>
            <button class="btn btn-secondary fa fa-pie-chart o_graph_button" data-tooltip="Pie Chart" aria-label="Pie Chart" data-mode="pie" t-on-click="() =&gt; this.onModeSelected('pie')" t-att-class="{ active: model.metaData.mode === 'pie' }"/>
        </div>
        <div t-if="model.metaData.mode === 'bar'" class="btn-group" role="toolbar" aria-label="Change graph">
            <button class="btn btn-secondary fa fa-database o_graph_button" data-tooltip="Stacked" aria-label="Stacked" t-on-click="toggleStacked" t-att-class="{ active: model.metaData.stacked }"/>
        </div>
        <div t-if="model.metaData.mode === 'line'" class="btn-group" role="toolbar" aria-label="Change graph">
            <button class="btn btn-secondary fa fa-database o_graph_button" data-tooltip="Stacked" aria-label="Stacked" t-on-click="toggleStacked" t-att-class="{ active: model.metaData.stacked }"/>
            <button class="btn btn-secondary fa fa-signal o_graph_button" data-tooltip="Cumulative" aria-label="Cumulative" t-on-click="toggleCumulated" t-att-class="{ active: model.metaData.cumulated }"/>
        </div>
        <div t-if="model.metaData.mode !== 'pie' and model.metaData.domains.length === 1" class="btn-group" role="toolbar" aria-label="Sort graph" name="toggleOrderToolbar">
            <button class="btn btn-secondary fa fa-sort-amount-desc o_graph_button" data-tooltip="Descending" aria-label="Descending" t-on-click="() =&gt; this.toggleOrder('DESC')" t-att-class="{ active: model.metaData.order === 'DESC' }"/>
            <button class="btn btn-secondary fa fa-sort-amount-asc o_graph_button" data-tooltip="Ascending" aria-label="Ascending" t-on-click="() =&gt; this.toggleOrder('ASC')" t-att-class="{ active: model.metaData.order === 'ASC' }"/>
        </div>
    </t>

    <t t-name="web.GraphView">
        <div t-att-class="props.className" t-ref="root">
            <Layout className="model.useSampleModel ? 'o_view_sample_data' : ''" display="props.display">
                <t t-set-slot="control-panel-additional-actions">
                    <CogMenu/>
                </t>
                <t t-set-slot="layout-actions">
                    <SearchBar t-if="searchBarToggler.state.showSearchBar"/>
                </t>
                <t t-set-slot="control-panel-navigation-additional">
                    <t t-component="searchBarToggler.component" t-props="searchBarToggler.props"/>
                </t>
                <t t-if="model.data">
                    <t t-if="!model.hasData() or model.useSampleModel and props.info.noContentHelp" t-call="web.ActionHelper">
                        <t t-set="noContentHelp" t-value="props.info.noContentHelp"/>
                    </t>
                    <t t-component="props.Renderer" model="model" buttonTemplate="props.buttonTemplate"/>
                </t>
                <t t-else="" t-call="web.NoContentHelper">
                    <t t-set="title">Invalid data</t>
                    <t t-set="description">Pie chart cannot mix positive and negative numbers. Try to change your domain to only display positive results</t>
                </t>
            </Layout>
        </div>
    </t>

<t t-name="web.GraphRenderer.CustomTooltip">
        <div class="o_graph_custom_tooltip popover show p-2 pe-none mw-100">
            <table class="overflow-hidden m-0">
                <thead>
                    <tr>
                        <th class="o_measure align-baseline border-0" t-esc="measure"/>
                    </tr>
                </thead>
                <tbody>
                    <tr t-foreach="tooltipItems" t-as="tooltipItem" t-key="tooltipItem_index">
                        <td>
                            <span class="o_square badge p-2 rounded-0 align-middle me-2" t-attf-style="background-color: {{ tooltipItem.boxColor }}"> </span>
                            <span class="o_label text-truncate d-inline-block align-middle" t-attf-style="max-width: {{ maxWidth }}" t-esc="tooltipItem.label"/>
                        </td>
                        <td class="o_value ps-2 text-end fw-bolder">
                            <t t-esc="tooltipItem.value"/>
                            <t t-if="mode === 'pie' and tooltipItem.percentage">
                                (<t t-esc="tooltipItem.percentage"/>%)
                            </t>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </t>

    <t t-name="web.GraphRenderer">
        <div t-att-class="'o_graph_renderer o_renderer h-100 d-flex flex-column border-top ' + props.class" t-ref="root">
            <div class="d-flex gap-1 mt-2 mx-3 mb-3">
                <t t-call="{{ props.buttonTemplate }}"/>
            </div>
            <div class="o_graph_canvas_container flex-grow-1 position-relative" t-ref="container">
                <canvas t-ref="canvas"/>
            </div>
        </div>
    </t>

<t t-name="web.KanbanExamplesNotebookTemplate">
        <div t-if="props.description" class="o_kanban_examples_description" t-out="props.description"/>
        <div class="o_kanban_examples d-flex p-2">
            <t t-foreach="columns" t-as="column" t-key="column.title">
                <div class="o_kanban_examples_group flex-grow-1 m-3">
                    <h6><b t-esc="column.title"/></h6>
                    <div t-foreach="column.records" t-as="record" t-key="record.id" class="o_kanban_examples_ghost p-2 border bg-white" t-att-class="{ 'o_collapse': record_index &gt; 0 }">
                        <div class="o_ghost_content pb-3 bg-300"/>
                        <div class="o_ghost_content o_ghost_tag d-inline-block w-50 mt-3 pb-3 bg-300"/>
                        <span class="ms-2" t-if="record.bullet" t-out="record.bullet"/>
                    </div>
                </div>
            </t>
        </div>
    </t>


    <t t-name="web.KanbanColumnExamplesDialog">
        <Dialog contentClass="'o_kanban_examples_dialog'" title="this.constructor.title">
            <Notebook orientation="'vertical'" pages="pages" onPageUpdate.bind="onPageUpdate"/>
            <t t-set-slot="footer">
                <button class="btn btn-primary" t-on-click="applyExamples" t-esc="props.applyExamplesText"/>
                <button class="btn btn-secondary" t-on-click="props.close">Close</button>
            </t>
        </Dialog>
    </t>

<t t-name="web.KanbanColumnQuickCreate">
        <div class="o_column_quick_create flex-shrink-0 flex-grow-1 flex-md-grow-0" t-ref="root">
            <div t-if="props.folded" class="o_quick_create_folded position-sticky z-index-1 my-3 text-nowrap" t-on-click="unfold">
                <button class="o_kanban_add_column btn btn-light w-100" aria-label="Add column" data-tooltip="Add column">
                    <i class="fa fa-plus me-2" role="img"/><t t-out="relatedFieldName"/>
                </button>
            </div>
            <div t-else="" class="o_quick_create_unfolded pt-3 pb-2">
                <div class="o_kanban_header top-0 pb-3">
                    <div class="input-group mb-1">
                        <input type="text" class="form-control bg-view" t-attf-placeholder="{{ relatedFieldName }}..." t-ref="autofocus" t-on-focus="() =&gt; state.hasInputFocused = true" t-on-blur="() =&gt; state.hasInputFocused = false" t-on-keydown="onInputKeydown"/>
                        <button class="btn btn-primary o_kanban_add" type="button" t-on-click="validate">
                            Add
                        </button>
                    </div>
                    <small t-if="!env.isSmall and state.hasInputFocused" class="o_discard_msg text-muted float-end">
                        Press <kbd>Esc</kbd> to discard
                    </small>
                    <t t-if="canShowExamples and !env.isSmall">
                        <button type="button" class="btn btn-link o_kanban_examples p-0" t-on-click="showExamples">See examples</button>
                    </t>
                </div>
                <div t-foreach="[,,,]" t-as="i" t-key="i_index" class="o_kanban_muted_record mb-2 py-5 bg-300 opacity-50"/>
            </div>
        </div>
    </t>

<t t-name="web.KanbanView">
        <div t-att-class="className" t-ref="root">
            <Layout className="model.useSampleModel ? 'o_view_sample_data' : ''" display="props.display">
                <t t-set-slot="control-panel-create-button">
                    <t t-if="canCreate and props.showButtons">
                        <button type="button" class="btn btn-primary o-kanban-button-new" accesskey="c" t-on-click="() =&gt; this.createRecord()" data-bounce-button="">
                            New
                        </button>
                    </t>
                </t>
                <t t-set-slot="layout-buttons">
                    <t t-call="{{ props.buttonTemplate }}"/>
                </t>
                <t t-set-slot="control-panel-always-buttons">
                    <t t-foreach="headerButtons" t-as="button" t-key="button.id" t-if="!evalViewModifier(button.invisible)">
                        <MultiRecordViewButton t-if="button.display === 'always'" list="model.root" className="button.className" clickParams="button.clickParams" defaultRank="'btn-secondary'" domain="props.domain" icon="button.icon" string="button.string" title="button.title"/>
                    </t>
                </t>
                <t t-set-slot="control-panel-additional-actions">
                    <CogMenu/>
                </t>
                <t t-set-slot="layout-actions">
                    <SearchBar t-if="searchBarToggler.state.showSearchBar"/>
                </t>
                <t t-set-slot="control-panel-navigation-additional">
                    <t t-component="searchBarToggler.component" t-props="searchBarToggler.props"/>
                </t>
                <t t-component="props.Renderer" list="model.root" archInfo="props.archInfo" Compiler="props.Compiler" readonly="true" forceGlobalClick="props.forceGlobalClick" deleteRecord.bind="deleteRecord" openRecord.bind="openRecord" noContentHelp="props.info.noContentHelp" scrollTop.bind="scrollTop" canQuickCreate="canQuickCreate" quickCreateState="quickCreateState" progressBarState="progressBarState" evalViewModifier.bind="evalViewModifier"/>
            </Layout>
        </div>
    </t>

    <t t-name="web.KanbanView.Buttons">
        <div t-if="props.showButtons" class="o_cp_buttons d-empty-none d-flex align-items-baseline gap-1" role="toolbar" aria-label="Main actions"/>
    </t>

<t t-name="web.KanbanCoverImageDialog">
        <Dialog title="'Set a Cover Image'" size="'lg'">
            <div t-if="attachments.length" class="o_kanban_cover_container bg-100">
                <t t-foreach="attachments" t-as="attachment" t-key="attachment.id">
                    <div class="o_kanban_cover_image position-relative d-inline-block m-2 border bg-white o_cursor_pointer" t-att-class="{                         'o_selected border-primary': state.selectedAttachmentId === attachment.id,                     }">
                        <img t-attf-src="/web/image/{{attachment.id}}?unique=1" class="position-absolute start-0 end-0 top-0 bottom-0 mw-100 mh-100 m-auto" alt="Attachment" t-on-click="() =&gt; this.selectAttachment(attachment, false)" t-on-dblclick="() =&gt; this.selectAttachment(attachment, true)"/>
                    </div>
                </t>
            </div>
            <t t-else="">There is no available image to be set as cover.</t>
            <t t-set-slot="footer" t-slot-scope="dialog">
                <button t-if="attachments.length" class="btn btn-primary" t-on-click="setCover" t-att-disabled="!state.selectedAttachmentId">
                    Select
                </button>
                <FileInput acceptedFileExtensions="'image/*'" onUpload.bind="onUpload" resModel="props.record.resModel" resId="props.record.resId">
                        <button class="btn btn-primary" t-on-click="uploadImage">
                            Upload and Set
                        </button>
                </FileInput>
                <button t-if="hasCoverImage" class="btn btn-secondary" t-on-click="removeCover">
                    Remove Cover Image
                </button>
                <button class="btn btn-secondary" t-on-click="dialog.close">
                    Discard
                </button>
            </t>
        </Dialog>
    </t>

<t t-name="web.KanbanHeader">
        <div class="o_kanban_header position-sticky top-0 z-index-1" t-ref="root" t-attf-class="{{ !env.isSmall and group.isFolded ? 'pt-2' : 'py-2' }}">
            <div class="o_kanban_header_title position-relative d-flex lh-lg">
                <div t-if="group.isFolded" class="o_column_title d-flex align-items-center pt-1 fs-4 lh-1 text-nowrap opacity-50 opacity-100-hover flex-grow-1" t-on-mouseenter="onTitleMouseEnter" t-on-mouseleave="onTitleMouseLeave">
                    <t t-esc="groupName"/>
                    <span class="badge text-bg-500 rounded-pill lh-1 ms-2" t-esc="group.count"/>
                </div>
                <span t-if="!group.isFolded" t-esc="groupName" class="o_column_title flex-grow-1 d-inline-block mw-100 text-truncate fs-4 fw-bold align-top text-900" t-on-mouseenter="onTitleMouseEnter" t-on-mouseleave="onTitleMouseLeave"/>
                <t t-if="env.isSmall or !group.isFolded">
                    <Dropdown class="'o_kanban_config'" togglerClass="'btn px-2'" position="'bottom-end'" container="() =&gt; this._configDropdownContainer">
                        <t t-set-slot="toggler">
                            <i class="fa fa-gear opacity-50 opacity-100-hover" role="img" aria-label="Settings" title="Settings"/>
                        </t>
                        <t t-foreach="configItems" t-as="item" t-key="item.key">
                            <DropdownItem t-if="item.isVisible" class="item.class" onSelected="() =&gt; this[item.method]()">
                                <t t-esc="item.label"/>
                            </DropdownItem>
                        </t>
                    </Dropdown>
                    <button t-if="canQuickCreate()" class="o_kanban_quick_add btn pe-2 me-n2" t-on-click="() =&gt; this.quickCreate()">
                        <i class="fa fa-plus opacity-75 opacity-100-hover" role="img" aria-label="Quick add" title="Quick add"/>
                    </button>
                </t>
                <button t-else="" class="o_column_unfold btn d-flex align-items-center justify-content-between flex-nowrap pt-2 pb-3 transition-base">
                    <i class="fa fa-caret-left lh-lg transition-base" role="img" aria-label="Unfold" title="Unfold"/>
                    <i class="fa fa-caret-right lh-lg" role="img" aria-label="Unfold" title="Unfold"/>
                </button>
            </div>
            <div t-if="(env.isSmall or !group.isFolded) and progressBar" class="o_kanban_counter position-relative d-flex align-items-center justify-content-between" t-att-class="{ 'opacity-25': !group.count }">
                <ColumnProgress group="group" progressBar="progressBar" aggregate="groupAggregate" onBarClicked.bind="onBarClicked"/>
            </div>
        </div>
    </t>

    <t t-name="web.KanbanGroupTooltip">
        <div class="o-tooltip px-2 py-1">
            <t t-foreach="props.tooltip" t-as="entry" t-key="entry_index">
                <t t-esc="entry.title"/>
                <br/>
                <t t-esc="entry.value"/>
                <br t-if="!tooltip_last"/>
            </t>
        </div>
    </t>

<t t-name="web.KanbanRecord">
        <div role="article" t-att-class="getRecordClasses()" t-att-data-id="props.record.id" t-att-tabindex="props.record.model.useSampleModel ? -1 : 0" t-on-click="onGlobalClick" t-ref="root">
            <t t-call="{{ templates[this.constructor.KANBAN_BOX_ATTRIBUTE] }}" t-call-context="this.renderingContext"/>
            <t t-call="{{ this.constructor.menuTemplate }}"/>
        </div>
    </t>
    <t t-name="web.KanbanRecordMenu">
        <t t-if="showMenu">
            <Dropdown class="'o_dropdown_kanban bg-transparent position-absolute end-0'" menuClass="'dropdown-menu'" togglerClass="'btn o-no-caret rounded-0'" position="'bottom-end'" title="'Dropdown menu'">
                <t t-set-slot="toggler">
                    <span class="fa fa-ellipsis-v"/>
                </t>
                <KanbanDropdownMenuWrapper>
                    <t t-call="{{ templates[this.constructor.KANBAN_MENU_ATTRIBUTE] }}" t-call-context="renderingContext"/>
                </KanbanDropdownMenuWrapper>
            </Dropdown>
        </t>
    </t>
<t t-name="web.KanbanRecordQuickCreate">
        <KanbanQuickCreateController t-if="state.isLoaded" t-props="quickCreateProps"/>
    </t>

    <t t-name="web.KanbanQuickCreateController">
        <div class="o_kanban_quick_create o_field_highlight shadow" t-att-class="{ o_disabled: state.disabled, 'w-100 mx-0': props.listIsGrouped }" t-ref="root">
            <t t-component="props.Renderer" class="'o_form_view o_xxs_form_view p-0'" record="model.root" Compiler="props.Compiler" archInfo="props.archInfo"/>
            <div class="d-flex flex-wrap justify-content-end gap-1">
                <button class="btn btn-primary o_kanban_add me-1" t-on-click="() =&gt; this.validate('add')">
                    Add
                </button>
                <button class="btn btn-secondary o_kanban_edit me-1" t-on-click="() =&gt; this.validate('edit')">
                    Edit
                </button>
                <span class="flex-grow-1"/>
                <button class="btn btn-secondary o_kanban_cancel" t-on-click="() =&gt; this.cancel(true)">
                    <i class="fa fa-trash"/>
                </button>
            </div>
        </div>
    </t>

<t t-name="web.KanbanRenderer">
        <div class="o_kanban_renderer o_renderer d-flex" t-attf-class="{{ props.list.isGrouped ? 'o_kanban_grouped align-content-stretch' : 'o_kanban_ungrouped align-content-start flex-wrap justify-content-start' }}" t-ref="root">
            <t t-foreach="getGroupsOrRecords()" t-as="groupOrRecord" t-key="groupOrRecord.key">
                <t t-if="groupOrRecord.group">
                    <t t-set="group" t-value="groupOrRecord.group"/>
                    <t t-set="isGroupProcessing" t-value="isProcessing(group.id)"/>
                    <div class="o_kanban_group flex-shrink-0 flex-grow-1 flex-md-grow-0" t-att-class="getGroupClasses(group, isGroupProcessing)" t-attf-class="{{ !env.isSmall and group.isFolded ? 'opacity-trigger-hover' : '' }}" t-att-data-id="group.id" t-on-click="(ev) =&gt; this.onGroupClick(group, ev)">
                        <KanbanHeader activeActions="props.archInfo.activeActions" canQuickCreate="props.canQuickCreate" deleteGroup="(group) =&gt; this.deleteGroup(group)" dialogClose="dialogClose" group="group" list="props.list" quickCreateState="props.quickCreateState" scrollTop="props.scrollTop" tooltipInfo="props.archInfo.tooltipInfo" progressBarState="props.progressBarState"/>
                        <t t-if="!group.isFolded">
                            <t t-if="group.id === props.quickCreateState.groupId">
                                <KanbanRecordQuickCreate group="group" onCancel="force =&gt; this.cancelQuickCreate(force)" onValidate="(record, mode) =&gt; this.validateQuickCreate(record, mode, group)" quickCreateView="props.quickCreateState.view"/>
                            </t>
                            <t t-foreach="group.list.records" t-as="record" t-key="record.id">
                                <KanbanRecord archInfo="props.archInfo" Compiler="props.Compiler" canResequence="!isGroupProcessing and !isProcessing(record.id) and canResequenceRecords" forceGlobalClick="props.forceGlobalClick" group="group" list="props.list" deleteRecord="props.deleteRecord" openRecord="props.openRecord" readonly="props.readonly" record="record" templates="props.archInfo.templateDocs" progressBarState="props.progressBarState"/>
                            </t>
                            <t t-set="unloadedCount" t-value="getGroupUnloadedCount(group)"/>
                            <div t-if="unloadedCount &gt; 0" class="o_kanban_load_more">
                                <button class="btn btn-outline-primary w-100 mt-4" t-on-click="() =&gt; this.loadMore(group)">Load more... (<t t-out="unloadedCount"/> remaining)</button>
                            </div>
                        </t>
                        <t t-elif="env.isSmall">
                            <t t-set="unloadedCount" t-value="getGroupUnloadedCount(group)"/>
                            <div t-if="unloadedCount &gt; 0" class="o_kanban_load_more">
                                <button class="btn btn-outline-primary w-100 mt-4" t-on-click="() =&gt; this.toggleGroup(group)">Load more... (<t t-out="unloadedCount"/> remaining)</button>
                            </div>
                        </t>
                    </div>
                </t>
                <t t-else="">
                    <KanbanRecord archInfo="props.archInfo" Compiler="props.Compiler" canResequence="!isProcessing(groupOrRecord.record.id) and canResequenceRecords" forceGlobalClick="props.forceGlobalClick" list="props.list" deleteRecord="props.deleteRecord" openRecord="props.openRecord" readonly="props.readonly" record="groupOrRecord.record" templates="props.archInfo.templateDocs"/>
                </t>
            </t>
            <t t-if="props.list.isGrouped">
                <t t-if="canCreateGroup()">
                    <KanbanColumnQuickCreate folded="state.columnQuickCreateIsFolded" onFoldChange="folded =&gt; state.columnQuickCreateIsFolded = props.list.groups.length &gt; 0 and folded" onValidate="props.list.createGroup.bind(props.list)" exampleData="exampleData" groupByField="props.list.groupByField"/>

                    <div t-if="props.list.groups.length === 0" class="o_kanban_example_background_container d-flex opacity-50">
                        <div class="o_kanban_example_background flex-grow-1">
                            <div class="o_kanban_examples d-flex p-2">
                                <div t-foreach="ghostColumns" t-as="column" t-key="column.name" class="o_kanban_examples_group flex-grow-1 m-3">
                                    <h6><b t-esc="column.name"/></h6>
                                    <div t-foreach="column.cards" t-as="card" t-key="card_index" class="o_kanban_examples_ghost d-flex flex-wrap justify-content-between mb-3 p-2 border bg-light">
                                        <div class="o_ghost_content w-100 pb-3 bg-300"/>
                                        <div class="o_ghost_content o_ghost_tag d-inline-block w-50 mt-3 pb-3 bg-300"/>
                                        <span class="mt-2 rounded-circle bg-300">
                                            <img class="o_ghost_avatar" src="/base/static/img/avatar.png" alt="Avatar"/>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </t>
            </t>
            <t t-else="">

                <div t-foreach="[,,,,,,]" t-as="i" t-key="i_index" class="o_kanban_record o_kanban_ghost flex-grow-1 flex-md-shrink-1 flex-shrink-0 my-0"/>
            </t>
            <t t-if="showNoContentHelper">
                <t t-if="props.noContentHelp" t-call="web.ActionHelper">
                    <t t-set="noContentHelp" t-value="props.noContentHelp"/>
                </t>
                <t t-else="" t-call="web.NoContentHelper"/>
            </t>
        </div>
    </t>

    <t t-name="web.KanbanColorPicker">
        <ul t-if="this.dataState.widget.editable" class="oe_kanban_colorpicker mb-0 ms-2">

            <t t-foreach="this.props.colors" t-as="color" t-key="color_index">
                <li role="menuitem" t-on-click="() =&gt; this.selectColor(color_index)" t-att-title="color" t-att-aria-label="color">
                    <a href="#" t-attf-class="oe_kanban_color_{{ color_index }}"/>
                </li>
            </t>
        </ul>
    </t>

    <t t-name="web.KanbanDropdownMenuWrapper">
        <div t-on-click="onClick" style="display:contents">
            <t t-slot="default"/>
        </div>
    </t>

<t t-name="web.ExportAll">
        <DropdownItem class="'o_export_all_menu'" onSelected.bind="onDirectExportData">
            <i class="fa fa-fw fa-upload me-1"/>Export All
        </DropdownItem>
    </t>

<t t-name="web.ListView.ConfirmationModal">
        <Dialog size="'md'" title="props.title">
            <main role="alert">
                <p>
                    <t t-if="props.isDomainSelected">This update will only consider the records of the current page.<br/><br/></t>
                    <t t-if="props.nbRecords != props.nbValidRecords">
                        Among the <t t-esc="props.nbRecords"/> selected records,
                        <t t-esc="props.nbValidRecords"/> are valid for this update.<br/>
                    </t>
                    Are you sure you want to perform the following update on those <t t-esc="props.nbValidRecords"/> records?
                </p>
                <div class="table-responsive">
                    <table class="o_modal_changes">
                        <tbody>
                            <t t-foreach="props.fields" t-as="field" t-key="field_index">
                                <tr>
                                    <td>Field:</td>
                                    <td><t t-esc="field.label"/></td>
                                </tr>
                                <tr>
                                    <td>Update to:</td>
                                    <td style="pointer-events: none;">
                                        <Field name="field.name" record="props.record" type="field.widget" readonly="true" fieldInfo="field.fieldNode"/>
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                </div>
            </main>
            <t t-set-slot="footer">
                <button class="btn btn-primary" t-on-click="_confirm" t-ref="autofocus">
                Confirm
                </button>
                <button t-if="props.cancel" class="btn btn-secondary" t-on-click="_cancel">
                Cancel
                </button>
            </t>
        </Dialog>
    </t>

<t t-name="web.ListView">
        <div t-att-class="className" t-ref="root">
            <Layout className="model.useSampleModel ? 'o_view_sample_data' : ''" display="display">
                <t t-set-slot="control-panel-create-button">
                    <t t-if="!model.root.editedRecord and activeActions.create and props.showButtons">
                        <button type="button" class="btn btn-primary o_list_button_add" data-hotkey="c" t-on-click="onClickCreate" data-bounce-button="">
                            New
                        </button>
                    </t>
                </t>

                <t t-set-slot="layout-buttons">
                    <t t-call="{{ props.buttonTemplate }}"/>
                </t>
                <t t-set-slot="control-panel-always-buttons">
                    <t t-foreach="archInfo.headerButtons" t-as="button" t-key="button.id" t-if="!evalViewModifier(button.invisible)">
                        <MultiRecordViewButton t-if="button.display === 'always'" list="model.root" className="button.className" clickParams="button.clickParams" defaultRank="'btn-secondary'" domain="props.domain" icon="button.icon" string="button.string" title="button.title"/>
                    </t>
                </t>

                <t t-set-slot="layout-actions">
                    <SearchBar t-if="searchBarToggler.state.showSearchBar" autofocus="firstLoad"/>
                </t>
                <t t-set-slot="control-panel-navigation-additional">
                    <t t-component="searchBarToggler.component" t-props="searchBarToggler.props"/>
                </t>

                <t t-set-slot="control-panel-additional-actions">
                    <CogMenu t-if="!nbSelected"/>
                </t>
                <t t-set-slot="control-panel-selection-actions">
                    <div t-if="nbSelected" class="d-flex gap-1">
                        <t t-call="web.ListView.Selection"/>
                        <t t-foreach="archInfo.headerButtons" t-as="button" t-key="button.id" t-if="!evalViewModifier(button.invisible)">
                            <MultiRecordViewButton t-if="button.display !== 'always'" list="model.root" className="button.className" clickParams="button.clickParams" defaultRank="'btn-secondary'" domain="props.domain" icon="button.icon" string="button.string" title="button.title"/>
                        </t>
                        <t t-if="props.info.actionMenus">
                            <ActionMenus getActiveIds="() =&gt; model.root.selection.map((r) =&gt; r.resId)" context="props.context" domain="props.domain" items="actionMenuItems" isDomainSelected="model.root.isDomainSelected" resModel="model.root.resModel" onActionExecuted="() =&gt; model.load()"/>
                        </t>
                    </div>
                </t>
                <t t-component="props.Renderer" list="model.root" activeActions="activeActions" archInfo="archInfo" allowSelectors="props.allowSelectors" editable="editable" onOpenFormView="onOpenFormView" openRecord.bind="openRecord" noContentHelp="props.info.noContentHelp" onAdd.bind="createRecord" onOptionalFieldsChanged.bind="onOptionalFieldsChanged" evalViewModifier.bind="evalViewModifier"/>
            </Layout>
        </div>
    </t>

    <t t-name="web.ListView.Buttons">
        <div t-if="props.showButtons" class="o_list_buttons d-flex gap-1 d-empty-none align-items-baseline" role="toolbar" aria-label="Main actions">
            <t t-if="model.root.editedRecord">
                <button type="button" class="btn btn-primary o_list_button_save" data-hotkey="s" t-on-click.stop="onClickSave">
                    Save
                </button>
                <button type="button" class="btn btn-secondary o_list_button_discard" data-hotkey="j" t-on-click.stop="onClickDiscard" t-on-mousedown="onMouseDownDiscard">
                    Discard
                </button>
            </t>
        </div>
    </t>

    <t t-name="web.ListView.Selection">
        <div class="o_list_selection_box list-group flex-row" role="alert">
            <span class="list-group-item active d-flex align-items-center pe-0 py-0 rounded-1 lh-1">
                <span t-if="isDomainSelected">All <b t-esc="nbTotal"/> selected</span>
                <t t-else="">
                    <b class="me-1" t-esc="nbSelected"/> selected
                    <a t-if="isPageSelected and nbTotal &gt; nbSelected" href="#" class="o_list_select_domain ms-3 btn btn-sm btn-info p-1 me-n2 border-0 fw-normal" t-on-click="onSelectDomain">
                        <i class="oi oi-fw oi-arrow-right"/> Select all <span t-esc="nbTotal"/>
                    </a>
                </t>
                <a href="#" title="Unselect All" class="o_list_unselect_all btn btn-link py-0" t-on-click="onUnselectAll">
                    <i class="oi oi-close"/>
                </a>
            </span>
        </div>
    </t>

<t t-name="web.ListRenderer">
        <t t-set="_canSelectRecord" t-value="canSelectRecord"/>
        <div class="o_list_renderer o_renderer table-responsive" t-att-class="uniqueRendererClass" tabindex="-1" t-ref="root">
            <t t-if="showNoContentHelper" t-call="web.ActionHelper">
                <t t-set="noContentHelp" t-value="props.noContentHelp"/>
            </t>
            <table t-attf-class="o_list_table table table-sm table-hover position-relative mb-0 {{props.list.isGrouped ? 'o_list_table_grouped' : 'o_list_table_ungrouped table-striped'}}" t-ref="table">
                <thead>
                    <tr>
                        <th t-if="hasSelectors" class="o_list_record_selector o_list_controller align-middle pe-1 cursor-pointer" tabindex="-1" t-on-keydown="(ev) =&gt; this.onCellKeydown(ev)" t-on-click.stop="toggleSelection">
                            <CheckBox disabled="!_canSelectRecord" value="selectAll" className="'d-flex m-0'" onChange.bind="toggleSelection"/>
                        </th>
                        <t t-foreach="state.columns" t-as="column" t-key="column.id">
                            <th t-if="column.type === 'field'" t-att-data-name="column.name" t-att-class="getColumnClass(column) + ' opacity-trigger-hover'" t-on-pointerup="onColumnTitleMouseUp" t-on-click="() =&gt; this.onClickSortColumn(column)" t-on-keydown="(ev) =&gt; this.onCellKeydown(ev)" t-att-data-tooltip-template="isDebugMode ? 'web.FieldTooltip' : false" t-att-data-tooltip-info="isDebugMode ? makeTooltip(column) : false" data-tooltip-delay="1000" tabindex="-1">
                                <t t-if="column.hasLabel and column.widget !== 'handle'">
                                <t t-set="isNumeric" t-value="isNumericColumn(column)"/>
                                    <div t-att-class="{'d-flex': true, 'flex-row-reverse': shouldReverseHeader(column)}">
                                        <span class="d-block min-w-0 text-truncate flex-grow-1" t-att-class="isNumeric ? 'o_list_number_th' : ''" t-esc="column.label"/>
                                        <i t-att-class="getSortableIconClass(column)"/>
                                    </div>
                                    <span class="o_resize position-absolute top-0 end-0 bottom-0 ps-1 bg-black-25 opacity-0 opacity-50-hover z-index-1" t-on-pointerdown.stop.prevent="onStartResize"/>
                                </t>
                            </th>
                            <th t-else="" t-on-keydown="(ev) =&gt; this.onCellKeydown(ev)" t-att-class="{o_list_button: column.type === 'button_group'}"/>
                        </t>
                        <th t-if="props.onOpenFormView" t-on-keydown="(ev) =&gt; this.onCellKeydown(ev)" class="o_list_open_form_view"/>
                        <th t-if="displayOptionalFields or activeActions.onDelete" t-on-keydown="(ev) =&gt; this.onCellKeydown(ev)" class="o_list_controller o_list_actions_header position-sticky end-0">
                            <Dropdown t-if="displayOptionalFields" class="'o_optional_columns_dropdown text-center border-top-0'" togglerClass="'btn p-0'" skipTogglerTabbing="true" listRendererClass="uniqueRendererClass" position="'bottom-end'">
                                <t t-set-slot="toggler">
                                    <i class="o_optional_columns_dropdown_toggle oi oi-fw oi-settings-adjust"/>
                                </t>

                                <t t-foreach="optionalFieldGroups" t-as="group" t-key="group_index">
                                    <div t-if="!group_first" role="separator" class="dropdown-divider"/>
                                    <DropdownItem t-if="group.displayName" parentClosingMode="'none'" onSelected="() =&gt; this.toggleOptionalFieldGroup(group.id)">
                                        <div class="fw-bold" t-esc="group.displayName"/>
                                    </DropdownItem>
                                    <t t-foreach="group.optionalFields" t-as="field" t-key="field_index">
                                        <DropdownItem parentClosingMode="'none'" onSelected="() =&gt; this.toggleOptionalField(field.name)">
                                            <CheckBox onChange="() =&gt; this.toggleOptionalField(field.name)" value="field.value" name="field.name">
                                                <span class="d-flex align-items-center"><span class="text-truncate" t-esc="field.label"/><span class="ps-1" t-if="env.debug" t-esc="' (' + field.name + ')'"/></span>
                                            </CheckBox>
                                        </DropdownItem>
                                    </t>
                                </t>
                            </Dropdown>
                        </th>
                    </tr>
                </thead>
                <tbody class="ui-sortable">
                    <t t-call="{{ constructor.rowsTemplate }}">
                        <t t-set="list" t-value="props.list"/>
                    </t>
                </tbody>
                <tfoot t-on-click="() =&gt; props.list.leaveEditMode()" class="o_list_footer cursor-default" t-att-class="{o_sample_data_disabled: props.list.model.useSampleModel}">
                    <tr>
                        <td t-if="hasSelectors"/>
                        <t t-foreach="state.columns" t-as="column" t-key="column.id">
                            <t t-set="aggregate" t-value="aggregates[column.name]"/>
                            <td t-if="aggregate" class="o_list_number">
                                <span t-esc="aggregate.value" t-att-data-tooltip="aggregate.help"/>
                            </td>
                            <td t-else=""/>
                        </t>
                        <td t-if="props.onOpenFormView"/>
                        <td t-if="displayOptionalFields or activeActions.onDelete"/>
                    </tr>
                </tfoot>
            </table>
        </div>
    </t>

    <t t-name="web.ListRenderer.Rows">
        <t t-if="!list.isGrouped">
            <t t-foreach="list.records" t-as="record" t-key="record.id">
                <t t-call="{{ constructor.recordRowTemplate }}"/>
            </t>
            <tr t-if="displayRowCreates">
                <td t-if="withHandleColumn"/>
                <td t-att-colspan="withHandleColumn ? nbCols - 1 : nbCols" class="o_field_x2many_list_row_add" t-on-keydown="(ev) =&gt; this.onCellKeydown(ev, null)">
                    <t t-foreach="creates" t-as="create" t-key="create_index">
                        <a t-if="create.type === 'create'" href="#" role="button" t-att-class="create_index !== 0 ? 'ml16' : ''" t-att-tabindex="props.list.editedRecord ? '-1' : '0'" t-on-click.stop.prevent="() =&gt; this.add({ context: create.context })">
                            <t t-esc="create.string"/>
                        </a>
                        <ViewButton t-if="create.type === 'button'" className="\`\${create.className} \${create_index !== 0 ? 'ml16' : ''}\`" clickParams="create.clickParams" icon="create.icon" record="props.list" string="create.string" title="create.title" tabindex="props.list.editedRecord ? '-1' : '0'"/>
                    </t>
                </td>
            </tr>
            <t t-if="!props.list.isGrouped">
                <tr t-foreach="getEmptyRowIds" t-as="emptyRowId" t-key="emptyRowId">
                    <td t-att-colspan="nbCols"></td>
                </tr>
            </t>
        </t>
        <t t-else="">
            <t t-foreach="list.groups" t-as="group" t-key="group.id">
                <t t-call="{{ constructor.groupRowTemplate }}"/>
                <t t-if="!group.isFolded">
                    <t t-call="{{ constructor.rowsTemplate }}">
                        <t t-set="list" t-value="group.list"/>
                    </t>
                    <tr t-if="!group.list.isGrouped and props.editable and canCreate">
                        <td t-if="hasSelectors"/>
                        <td t-att-colspan="hasSelectors ?  nbCols - 1 : nbCols" class="o_group_field_row_add">
                            <a href="#" role="button" t-on-click.stop.prevent="() =&gt; group.addNewRecord({}, props.editable === 'top')" t-on-keydown="(ev) =&gt; this.onCellKeydown(ev)">
                                Add a line
                            </a>
                        </td>
                    </tr>
                </t>
            </t>
        </t>
    </t>

    <t t-name="web.ListRenderer.GroupRow">
        <tr t-attf-class="{{group.count &gt; 0 ? 'o_group_has_content' : ''}} o_group_header {{!group.isFolded ? 'o_group_open' : ''}} cursor-pointer" t-on-click="() =&gt; this.toggleGroup(group)">
            <th t-on-keydown="(ev) =&gt; this.onCellKeydown(ev, group)" tabindex="-1" t-attf-class="o_group_name fs-6 fw-bold {{!group.isFolded ? 'text-900' : 'text-700'}}" t-att-colspan="getGroupNameCellColSpan(group)">
                <div class="d-flex align-items-center">
                    <span t-attf-class="o_group_caret fa fa-fw {{group.isFolded ? 'fa-caret-right' : 'fa-caret-down' }} me-1" t-attf-style="--o-list-group-level: {{getGroupLevel(group)}}"/>
                    <t t-esc="getGroupDisplayName(group)"/> (<t t-esc="group.count"/>)
                    <div t-if="(groupByButtons[group.groupByField.name] and !group.isFolded and group.record.resId)" class="o_group_buttons">
                        <t t-foreach="groupByButtons[group.groupByField.name]" t-as="button" t-key="button.id">
                            <t t-if="!evalInvisible(button.invisible, group.record)">
                                <t t-if="button.clickParams.type === 'edit'">
                                    <button t-att-title="button.title" class="btn" t-on-click="() =&gt; this.editGroupRecord(group)" tabindex="-1">
                                        <i t-attf-class="fa fa-fw {{button.icon}} o_button_icon"/>
                                    </button>
                                </t>
                                <t t-else="">
                                    <ViewButton className="button.className" clickParams="button.clickParams" icon="button.icon" record="group.record" string="button.string" title="button.title" tabindex="'-1'"/>
                                </t>
                            </t>
                        </t>
                    </div>
                    <div t-if="showGroupPager(group)" class="ms-auto">
                        <Pager t-props="getGroupPagerProps(group)"/>
                    </div>
                </div>
            </th>
            <td t-on-keydown="(ev) =&gt; this.onCellKeydown(ev, group)" t-foreach="getAggregateColumns(group)" t-as="column" t-key="column.id" t-att-class="{'o_list_number': column.type === 'field'}">
                <t t-if="column.type === 'field'" t-esc="formatAggregateValue(group, column)"/>
            </td>
            <t t-set="groupPagerColspan" t-value="getGroupPagerCellColspan(group)"/>
            <th t-on-keydown="(ev) =&gt; this.onCellKeydown(ev, group)" t-if="groupPagerColspan &gt; 0" t-att-colspan="groupPagerColspan"/>
        </tr>
    </t>

    <t t-name="web.ListRenderer.RecordRow">
        <tr class="o_data_row" t-att-class="getRowClass(record)" t-att-data-id="record.id" t-on-click.capture="(ev) =&gt; this.onClickCapture(record, ev)" t-on-mouseover.capture="(ev) =&gt; this.ignoreEventInSelectionMode(ev)" t-on-mouseout.capture="(ev) =&gt; this.ignoreEventInSelectionMode(ev)" t-on-mouseenter.capture="(ev) =&gt; this.ignoreEventInSelectionMode(ev)" t-on-touchstart="(ev) =&gt; this.onRowTouchStart(record, ev)" t-on-touchend="() =&gt; this.onRowTouchEnd(record)" t-on-touchmove="() =&gt; this.onRowTouchMove(record)">
            <td t-on-keydown="(ev) =&gt; this.onCellKeydown(ev, group, record)" t-if="hasSelectors" class="o_list_record_selector user-select-none" t-on-click.stop="() =&gt; this.toggleRecordSelection(record)" tabindex="-1">
                <CheckBox disabled="!_canSelectRecord" value="record.selected" onChange.alike="() =&gt; this.toggleRecordSelection(record)"/>
            </td>
            <t t-foreach="getColumns(record)" t-as="column" t-key="column.id">
                <t t-if="column.type === 'field'">
                    <t t-set="isInvisible" t-value="evalInvisible(column.invisible, record) or !(column.name in record.data)"/>
                    <td t-on-keydown="(ev) =&gt; this.onCellKeydown(ev, group, record)" class="o_data_cell cursor-pointer" t-att-class="getCellClass(column, record)" t-att-name="column.name" t-att-colspan="column.colspan" t-att-data-tooltip="!isInvisible ? getCellTitle(column, record) : false" data-tooltip-delay="1000" t-on-click="(ev) =&gt; this.onCellClicked(record, column, ev)" tabindex="-1">
                        <t t-if="!isInvisible">
                            <t t-if="canUseFormatter(column, record)" t-out="getFormattedValue(column, record)"/>
                            <Field t-else="" name="column.name" record="record" type="column.widget" class="getFieldClass(column)" fieldInfo="column" t-props="getFieldProps(record, column)"/>
                        </t>
                    </td>
                </t>
                <t t-if="column.type === 'button_group'">
                    <td t-on-keydown="(ev) =&gt; this.onCellKeydown(ev, group, record)" class="o_data_cell cursor-pointer" t-att-class="getCellClass(column, record)" t-on-click="(ev) =&gt; this.onButtonCellClicked(record, column, ev)" tabindex="-1">
                        <t t-foreach="column.buttons" t-as="button" t-key="button.id">
                            <ViewButton t-if="!evalInvisible(button.invisible, record)" className="button.className" clickParams="button.clickParams" defaultRank="button.defaultRank" disabled="button.disabled" icon="button.icon" record="record" string="button.string" title="button.title" tabindex="props.list.editedRecord ? '-1' : '0'" onClick="isX2Many and record.isNew ? displaySaveNotification.bind(this) : ''"/>
                        </t>
                    </td>
                </t>
                <t t-if="column.type === 'widget'">
                    <td class="o_data_cell" t-att-class="getCellClass(column, record)">
                        <Widget t-props="column.props" record="record"/>
                    </td>
                </t>
            </t>

            <t t-if="props.onOpenFormView">
                <td class="o_list_record_open_form_view text-center" t-on-keydown="(ev) =&gt; this.onCellKeydown(ev, group, record)" t-on-click.stop="() =&gt; isX2Many and record.isNew ? this.displaySaveNotification() : props.onOpenFormView(record)" tabindex="-1">
                    <button class="btn btn-link align-top text-end" name="Open in form view" aria-label="Open in form view" tabindex="-1">View</button>
                </td>
            </t>

            <t t-set="useUnlink" t-value="'unlink' in activeActions"/>
            <t t-set="hasX2ManyAction" t-value="isX2Many and (useUnlink ? activeActions.unlink : activeActions.delete)"/>
            <t t-if="displayOptionalFields or hasX2ManyAction">
                <t t-if="hasX2ManyAction">
                    <td class="o_list_record_remove text-center" t-on-keydown="(ev) =&gt; this.onCellKeydown(ev, group, record)" t-on-click.stop="() =&gt; this.onDeleteRecord(record)" tabindex="-1">
                        <button class="fa" t-att-class="{                                 'fa-trash-o': !useUnlink and activeActions.delete,                                 'fa-times': useUnlink and activeActions.unlink,                             }" name="delete" aria-label="Delete row" tabindex="-1"/>
                    </td>
                </t>
                <td t-else="" tabindex="-1"/>
            </t>
        </tr>
    </t>

    <t t-name="web.ListRenderer.OptionalFieldsDropdown">
    <div class="o-dropdown dropdown" t-att-class="props.class" t-attf-class="         {{ state.directionCaretClass || ''}}         {{ state.open ? 'show' : ''}}         {{ !showCaret ? 'o-dropdown--no-caret' : '' }}       " t-ref="root">
      <button t-if="props.toggler !== 'parent'" type="button" class="dropdown-toggle" t-attf-class="           {{props.togglerClass || ''}}           {{parentDropdown ? 'dropdown-item' : ''}}         " t-att-disabled="props.disabled" t-on-click.stop="onTogglerClick" t-on-mouseenter="onTogglerMouseEnter" t-att-title="props.title" t-att-data-hotkey="props.hotkey" t-att-data-tooltip="props.tooltip" t-att-tabindex="props.skipTogglerTabbing ? -1 : 0" t-att-aria-expanded="state.open ? 'true' : 'false'" t-ref="togglerRef">
        <t t-slot="toggler" open="state.open"/>
      </button>
      <div t-if="state.open" t-attf-class="           o-dropdown--menu dropdown-menu           {{ parentDropdown ? 'o-dropdown--menu-submenu' : '' }}           {{ props.menuDisplay }}         " t-att-class="props.menuClass" role="menu" t-ref="menuRef" t-on-pointerenter="() =&gt; props.holdOnHover and position.lock()" t-on-pointerleave="() =&gt; props.holdOnHover and position.unlock()" t-on-scroll="props.onScroll" t-portal="\`.\${props.listRendererClass}\`" class="o_optional_columns_dropdown">
        <t t-slot="default"/>
      </div>
    </div>
  </t>

<t t-name="web.ActionHelper">
        <div class="o_view_nocontent">
            <div class="o_nocontent_help">
                <t t-out="noContentHelp"/>
            </div>
        </div>
    </t>

    <t t-name="web.NoContentHelper">
        <div class="o_view_nocontent" role="alert">
            <div class="o_nocontent_help">
                <p class="o_view_nocontent_empty_folder">
                    <t t-if="title" t-esc="title"/>
                    <t t-else="">No data to display</t>
                </p>
                <p>
                <t t-if="description" t-esc="description"/>
                <t t-else="">Try to add some records, or make sure that there is no
                    active filter in the search bar.</t>
                </p>
            </div>
        </div>
    </t>

<t t-name="web.PivotView.Buttons">
        <div class="o_pivot_buttons d-flex gap-1 mt-2 mx-3 mb-3">
            <div class="btn-group" role="toolbar" aria-label="Main actions">
                <t t-call="web.ReportViewMeasures">
                    <t t-set="measures" t-value="model.metaData.measures"/>
                    <t t-set="activeMeasures" t-value="model.metaData.activeMeasures"/>
                </t>
            </div>
            <div class="btn-group" role="toolbar" aria-label="Pivot settings">
                <t t-set="noDataDisplayed" t-value="!model.hasData() || !model.metaData.activeMeasures.length"/>
                <button class="btn btn-secondary fa fa-exchange o_pivot_flip_button" t-on-click="onFlipButtonClicked" data-tooltip="Flip axis" aria-label="Flip axis" t-attf-disabled="{{noDataDisplayed ? 'disabled' : false}}"/>
                <button class="btn btn-secondary fa fa-arrows o_pivot_expand_button" t-on-click="onExpandButtonClicked" data-tooltip="Expand all" aria-label="Expand all" t-attf-disabled="{{noDataDisplayed ? 'disabled' : false}}"/>
                <button class="btn btn-secondary fa fa-download o_pivot_download" t-on-click="onDownloadButtonClicked" data-tooltip="Download xlsx" aria-label="Download xlsx" t-attf-disabled="{{noDataDisplayed ? 'disabled' : false}}"/>
            </div>
        </div>
    </t>

    <t t-name="web.PivotView">
        <div t-att-class="props.className" t-ref="root">
            <Layout className="model.useSampleModel ? 'o_view_sample_data' : ''" display="props.display">
                <t t-set-slot="control-panel-additional-actions">
                    <CogMenu/>
                </t>
                <t t-set-slot="layout-actions">
                    <SearchBar t-if="searchBarToggler.state.showSearchBar"/>
                </t>
                <t t-set-slot="control-panel-navigation-additional">
                    <t t-component="searchBarToggler.component" t-props="searchBarToggler.props"/>
                </t>
                <t t-set="displayNoContent" t-value="                     props.info.noContentHelp !== false and (                         !(model.hasData() and model.metaData.activeMeasures.length) or                         model.useSampleModel                     )"/>
                <t t-if="displayNoContent">
                    <t t-if="props.info.noContentHelp" t-call="web.ActionHelper">
                        <t t-set="noContentHelp" t-value="props.info.noContentHelp"/>
                    </t>
                    <t t-else="" t-call="web.NoContentHelper"/>
                </t>
                <t t-component="props.Renderer" model="model" buttonTemplate="props.buttonTemplate"/>
            </Layout>
        </div>
    </t>

<t t-name="web.PivotGroupByMenu">
        <Dropdown class="'o_group_by_menu btn-group'" togglerClass="'btn btn-light'" t-props="dropdownProps">
            <t t-set-slot="toggler">
                <i class="me-1" t-att-class="icon"/>
                <span class="o_dropdown_title">Group By<t t-if="props.showCaretDown"> <i class="fa fa-caret-down ms-1"/></t></span>
            </t>
            <t t-set="currentGroup" t-value="null"/>
            <t t-foreach="items" t-as="item" t-key="item.id">
                <t t-if="currentGroup !== null and currentGroup !== item.groupNumber">
                    <div class="dropdown-divider" role="separator"/>
                </t>
                <t t-if="item.fieldType === 'properties'">
                    <PropertiesGroupByItem item="item" onGroup.bind="onGroupBySelected"/>
                </t>
                <t t-elif="item.options">
                    <Dropdown togglerClass="'o_menu_item' + (item.isActive ? ' selected' : '')">
                        <t t-set-slot="toggler">
                            <t t-esc="item.description"/>
                        </t>
                        <t t-set="subGroup" t-value="null"/>
                        <t t-foreach="item.options" t-as="option" t-key="option.id">
                            <t t-if="subGroup !== null and subGroup !== option.groupNumber">
                                <div class="dropdown-divider" role="separator"/>
                            </t>
                            <CheckboxItem class="{ o_item_option: true, selected: option.isActive }" checked="option.isActive ? true : false" parentClosingMode="'none'" t-esc="option.description" onSelected="() =&gt; this.onGroupBySelected({ itemId: item.id, optionId: option.id})"/>
                            <t t-set="subGroup" t-value="option.groupNumber"/>
                        </t>
                    </Dropdown>
                </t>
                <t t-else="">
                    <CheckboxItem class="{ o_menu_item: true, selected: item.isActive }" checked="item.isActive" parentClosingMode="'none'" t-esc="item.description" onSelected="() =&gt; this.onGroupBySelected({ itemId: item.id })"/>
                </t>
                <t t-set="currentGroup" t-value="item.groupNumber"/>
            </t>
            <t t-if="!hideCustomGroupBy and fields.length">
                <div t-if="items.length" role="separator" class="dropdown-divider"/>
                <CustomGroupByItem fields="fields" onAddCustomGroup.bind="onAddCustomGroup"/>
            </t>
        </Dropdown>
    </t>

<t t-name="web.PivotRenderer">
        <t t-call="{{ props.buttonTemplate }}"/>
        <div t-if="model.hasData() and model.metaData.activeMeasures.length" t-att-class="env.isSmall ? 'table-responsive' : ''" class="o_pivot mx-3">
            <table class="table-hover table table-sm table-bordered table-borderless" t-att-class="{ o_enable_linking: !model.metaData.disableLinking }" t-ref="table">
                <thead>
                    <tr t-foreach="table.headers" t-as="row" t-key="'header_' + row_index" class="border-top-0">
                        <t t-foreach="row" t-as="cell" t-key="'header_row_' + cell_index">
                            <t t-if="cell.measure" t-call="web.PivotMeasure"/>
                            <t t-elif="cell.isLeaf !== undefined" t-call="web.PivotHeader">
                                <t t-set="isXAxis" t-value="true"/>
                                <t t-set="isInHead" t-value="true"/>
                            </t>
                            <th t-else="" t-att-colspan="cell.width" t-att-rowspan="cell.height" class="border-0 bg-100 fw-normal" t-att-class="{ 'border-0': cell_index != 0 }"/>
                        </t>
                    </tr>
                </thead>
                <tbody>
                    <tr t-foreach="table.rows" t-as="row" t-key="'row_' + row_index">
                        <t t-call="web.PivotHeader">
                            <t t-set="isXAxis" t-value="false"/>
                            <t t-set="cell" t-value="row"/>
                        </t>
                        <t t-foreach="row.subGroupMeasurements" t-as="cell" t-key="'row_cell_' + cell_index">
                            <td class="o_pivot_cell_value bg-100" t-att-class="{                                     o_empty: cell.value === undefined,                                     'cursor-pointer': cell.value !== undefined,                                     'fw-bold': cell.isBold,                                 }" t-on-click="() =&gt; this.onOpenView(cell)" t-on-mouseover="onMouseEnter" t-on-mouseout="onMouseLeave">
                                <t t-if="cell.value !== undefined">
                                    <div t-if="cell.originIndexes.length &gt; 1" class="o_variation" t-att-class="{                                              'o_positive text-success': cell.value &gt; 0,                                              'o_negative text-danger': cell.value &lt; 0,                                              o_null: cell.value === 0,                                         }" t-esc="getFormattedVariation(cell)"/>
                                    <div t-elif="model.metaData.measures[cell.measure].type === 'boolean'" class="o_value">
                                        <CheckBox disabled="true" value="cell.value"/>
                                    </div>
                                    <div t-else="1" class="o_value" t-esc="getFormattedValue(cell)"/>
                                </t>
                            </td>
                        </t>
                    </tr>
                </tbody>
            </table>
        </div>
    </t>

    <t t-name="web.PivotHeader">
        <th class="bg-view text-nowrap cursor-pointer fw-normal user-select-none" t-att-colspan="isXAxis ? cell.width : undefined" t-att-rowspan="isXAxis ? cell.height : undefined" t-att-class="{                 o_pivot_header_cell_closed: cell.isLeaf,                 o_pivot_header_cell_opened: !cell.isLeaf,                 'border-top': isInHead,                             }" t-attf-style="{{                 isXAxis                     ? undefined                     : l10n.direction === 'ltr'                         ? 'padding-left: ' + getPadding(cell) + 'px;'                         : 'padding-right: ' + getPadding(cell) + 'px;'             }}" t-att-data-tooltip="cell.label" t-attf-data-tooltip-position="{{ l10n.direction === 'ltr' ? 'right' : 'left' }}" t-on-click.prevent="() =&gt; this.onHeaderClick(cell, isXAxis ? 'col' : 'row')">
            <t t-if="cell.isLeaf and !cell.isFolded">
                <PivotGroupByMenu toggler="'parent'" position="isXAxis ? 'bottom-start' : 'bottom-end'" cell="cell" customGroupBys="model.metaData.customGroupBys" onItemSelected="(payload) =&gt; this.onGroupBySelected(isXAxis ? 'col' : 'row', payload)" onAddCustomGroupBy="fieldName =&gt; this.onAddCustomGroupBy(isXAxis ? 'col' : 'row', cell.groupId, fieldName)"/>
            </t>
            <i t-attf-class="fa fa-{{ cell.isLeaf ? 'plus-square' : 'minus-square-o' }} me-1"/>
            <span t-esc="cell.title"/>
        </th>
    </t>

    <t t-name="web.PivotMeasure">
        <th class="bg-view text-muted text-center text-nowrap fw-normal" t-att-colspan="cell.width" t-att-rowspan="cell.height" t-att-class="{                 'o_pivot_origin_row cursor-pointer user-select-none': cell.originIndexes,                 'o_pivot_measure_row cursor-pointer user-select-none': !cell.originIndexes,                 o_pivot_sort_order_asc: cell.order === 'asc',                 o_pivot_sort_order_desc: cell.order === 'desc',             }" t-on-click.prevent="() =&gt; this.onMeasureClick(cell)" t-on-mouseover="onMouseEnter" t-on-mouseout="onMouseLeave">
            <t t-esc="cell.title"/>
            <i t-if="cell.order === 'asc' || cell.order ==='desc'" t-attf-class="fa fa-caret-{{ cell.order === 'asc' ? 'up' : 'down' }} ms-1"/>
        </th>
    </t>

<t t-name="web.View">
      <WithSearch t-props="withSearchProps" t-slot-scope="search">
        <t t-component="Controller" t-on-click="handleActionLinks" t-props="componentProps" context="search.context" domain="search.domain" groupBy="search.groupBy" orderBy="search.orderBy" comparison="search.comparison" display="search.display"/>
      </WithSearch>
  </t>

  <t t-name="web.ReportViewMeasures">
    <Dropdown togglerClass="'btn btn-primary'">
            <t t-set-slot="toggler">
                Measures <i class="fa fa-caret-down ms-1"/>
            </t>
            <t t-foreach="measures" t-as="measure" t-key="measure_value.name">
                <div t-if="!measure_first and measure == '__count'" role="separator" class="dropdown-divider"/>
                <DropdownItem class="{ o_menu_item: true, selected: activeMeasures.includes(measure) }" parentClosingMode="'none'" t-esc="measures[measure].string" onSelected="() =&gt; this.onMeasureSelected({ measure: measure_value.name })"/>
            </t>
        </Dropdown>
  </t>
<t t-name="views.ViewButton">
    <t t-tag="props.tag" t-att="props.attrs" t-att-id="props.id" t-att-class="getClassName()" t-att-disabled="disabled" t-att-name="props.clickParams.name" t-att-special="props.clickParams.special" t-att-href="props.tag === 'a' and '#'" t-att-style="props.style" t-att-type="clickParams.type" t-att-data-tooltip-template="hasBigTooltip ? 'views.ViewButtonTooltip' : false" t-att-data-tooltip-info="hasBigTooltip ? tooltip : false" t-att-data-tooltip="hasSmallToolTip ? props.title : false" t-att-tabindex="props.tabindex" t-on-click.stop="onClick">
      <t t-if="icon" t-tag="icon.tag" t-att-class="icon.class + (props.string ? ' me-1' : '')" t-att-src="icon.src"/>
      <t t-slot="contents"><span t-if="props.string" t-esc="props.string"/></t>
    </t>
  </t>

  <t t-name="views.ViewButtonTooltip">
      <t t-if="debug || button.help">
        <div class="o-tooltip--string" t-if="debug || button.string" role="tooltip">
            <t t-if="debug">
                Button
                <t t-if="button.string">: </t>
                <t t-if="!button.string"> (no string)</t>
            </t>
            <t t-esc="button.string"/>
        </div>
        <p t-if="button.title" class="o-tooltip--help" role="tooltip">
            <t t-esc="button.title"/>
        </p>
        <p t-if="button.help" class="o-tooltip--help" role="tooltip">
            <t t-esc="button.help"/>
        </p>
        <ul t-if="debug" class="o-tooltip--technical" role="tooltip">
            <li data-item="object">
                <span class="o-tooltip--technical--title">Object:</span>
                <t t-esc="model"/>
            </li>
            <li t-if="button.context" data-item="context">
                <span class="o-tooltip--technical--title">Context:</span>
                <t t-esc="button.context || context"/>
            </li>
            <li t-if="'invisible' in button" data-item="invisible">
                <span class="o-tooltip--technical--title">Invisible:</span>
                <t t-esc="button.invisible"/>
            </li>
            <li t-if="'column_invisible' in button" data-item="column_invisible">
                <span class="o-tooltip--technical--title">Column invisible:</span>
                <t t-esc="button.column_invisible"/>
            </li>
            <li t-if="'required' in button" data-item="required">
                <span class="o-tooltip--technical--title">Required:</span>
                <t t-esc="button.required"/>
            </li>
            <li t-if="'readonly' in button" data-item="readonly">
                <span class="o-tooltip--technical--title">Readonly:</span>
                <t t-esc="button.readonly"/>
            </li>
            <li t-if="button.special" data-item="special">
                <span class="o-tooltip--technical--title">Special:</span>
                <t t-esc="button.special"/>
            </li>
            <t t-set="button_type" t-value="button.type"/>
            <li t-if="button_type" data-item="button_type">
                <span class="o-tooltip--technical--title">Button Type:</span>
                <t t-esc="button_type"/>
            </li>
            <li t-if="button_type === 'object'" data-item="button_method">
                <span class="o-tooltip--technical--title">Method:</span>
                <t t-esc="button.name"/>
            </li>
            <li t-if="button_type === 'action'" data-item="button_action">
                <span class="o-tooltip--technical--title">Action ID:</span>
                <t t-esc="button.name"/>
            </li>
        </ul>
      </t>
  </t>
<t t-name="web.AnimatedNumber">
        <div class="o_animated_number ms-2 text-900 text-nowrap cursor-default" t-att-class="state.value !== props.value and props.animationClass" t-att-title="props.title">
            <t t-slot="prefix"/>
            <span t-if="props.currency and props.currency.position === 'before'" t-esc="props.currency.symbol" class="ms-1"/>
            <b t-esc="format(state.value)"/>
            <span t-if="props.currency and props.currency.position === 'after'" t-esc="props.currency.symbol" class="ms-1"/>
        </div>
    </t>

<t t-name="web.ColumnProgress">
        <div class="o_column_progress progress bg-300 w-75">
            <t t-set="maxWidth" t-value="100 - Math.max(0, props.progressBar.bars.filter(x =&gt; x.count &gt; 0).length - 1) * 5"/>
            <t t-foreach="props.progressBar.bars" t-as="bar" t-key="bar.value">
                <t t-set="progressWidth" t-value="Math.max(5, bar.count / (props.group.count or 1) * 100)"/>
                <div t-if="bar.count" role="progressbar" class="progress-bar o_bar_has_records cursor-pointer" t-att-class="{ 'progress-bar-animated progress-bar-striped': props.progressBar.activeBar === bar.value, 'border border-white': !props.group.isFolded and props.progressBar.activeBar }" t-attf-class="bg-{{ bar.color }}" t-attf-style="width: {{ Math.min(progressWidth, maxWidth) }}%;" aria-valuemin="0" t-att-aria-valuemax="props.group.count" t-att-aria-valuenow="bar.count" aria-label="Progress bar" t-attf-data-tooltip="{{ bar.count }} {{ bar.string }}" data-tooltip-delay="0" t-on-click="() =&gt; this.onBarClick(bar)"/>
            </t>
        </div>
        <AnimatedNumber value="props.aggregate.value" title="props.aggregate.title" duration="1000" currency="props.aggregate.currency" animationClass="props.aggregate.value &gt; 999 ? 'o_animated_grow' : 'o_animated_grow_huge'"/>
    </t>

<t t-name="web.ViewScaleSelector">
        <Dropdown t-if="Object.keys(props.scales).length &gt; 1" class="\`btn-group o_view_scale_selector \${props.dropdownClass || ''}\`" togglerClass="'btn btn-secondary scale_button_selection'" hotkey="'v'" showCaret="true">
            <t t-set-slot="toggler">
                <t t-esc="props.scales[props.currentScale].description"/>
            </t>
            <t t-foreach="scales" t-as="scale" t-key="scale.key">
                <DropdownItem class="\`o_scale_button_\${scale.key} \${scale.key === props.currentScale ? 'active' : ''}\`" hotkey="scale.hotkey or scale.key[0]" onSelected="() =&gt; this.props.setScale(scale.key)">
                    <t t-esc="scale.description"/>
                </DropdownItem>
            </t>
            <div t-if="this.props.isWeekendVisible !== undefined" class="dropdown-divider" role="separator"/>
            <DropdownItem t-if="this.props.isWeekendVisible !== undefined" class="\`\${props.isWeekendVisible ? 'active' : ''}\`" onSelected="props.toggleWeekendVisibility">
                Show weekends
            </DropdownItem>
        </Dropdown>
    </t>

<t t-name="web.DeleteExportListDialog">
        <Dialog title="'Confirmation'" size="'md'">
            <div t-esc="props.text"/>
            <t t-set-slot="footer">
                <button class="btn btn-primary" t-on-click="onDelete">Delete</button>
                <button class="btn btn-secondary" t-on-click="() =&gt; props.close()">Cancel</button>
            </t>
        </Dialog>
    </t>

    <t t-name="web.ExportDataItem">
        <div t-att-data-field_id="props.field.id" t-attf-class="o_export_tree_item cursor-pointer position-relative ps-4 {{ state.subfields.length ? 'o_expanded mb-2' : '' }} {{ props.field.parent ? '' : 'pe-3'}}" role="treeitem" t-on-click.stop="() =&gt; this.toggleItem(props.field.id, true)" t-on-dblclick="() =&gt; this.onDoubleClick(props.field.id)">
            <div t-attf-class="o_tree_column d-flex align-items-center {{ props.field.required ? 'fw-bolder' : ''}}">
                <span t-if="props.isFieldExpandable(props.field.id)" t-attf-class="ms-n3 float-start o_expand_parent small oi {{ state.subfields.length ? 'oi-chevron-down' : 'oi-chevron-right' }}" role="img" aria-label="Show sub-fields" title="Show sub-fields"/>
                <span t-if="props.isDebug and props.field.id" class="overflow-hidden w-100" t-esc="\`\${props.field.string} (\${props.field.id})\`"/>
                <span t-else="" class="overflow-hidden w-100" t-esc="props.field.string"/>
                <span title="Select field" t-attf-class="fa fa-plus float-end m-1 o_add_field {{ isFieldSelected(props.field.id) ? 'o_inactive opacity-25' : '' }}" t-on-click.stop="(ev) =&gt; !this.isFieldSelected(this.props.field.id) and this.props.onAdd(this.props.field.id)"/>
            </div>
                <t t-foreach="state.subfields" t-as="field" t-key="field.id">
                    <ExportDataItem t-props="props" field="field"/>
                </t>
        </div>
    </t>

    <t t-name="web.ExportDataDialog">
        <Dialog contentClass="'o_export_data_dialog'" title="title" size="'lg'">
            <div class="row w-100">
                <div class="o_left_panel col-12 col-md-6 h-100 d-flex flex-column flex-nowrap">
                    <div class="o_import_compat">
                        <CheckBox className="'o_import_compat'" id="'o-update-data'" value="state.isCompatible" onChange.bind="onToggleCompatibleExport">
                            I want to update data (import-compatible export)
                        </CheckBox>
                    </div>
                    <h4 class="mt-3">Available fields</h4>
                    <input t-ref="search" type="search" class="form-control mb-3 o_export_search_input" id="o-export-search-filter" placeholder="Search" t-on-input="onSearch"/>
                    <div class="o_left_field_panel h-100 overflow-auto border">
                        <div class="o_field_tree_structure">
                            <t t-if="fieldsAvailable">
                                <t t-foreach="rootFields" t-as="field" t-key="field.id + '_' + state.search.length + '_' + state.isCompatible">
                                    <ExportDataItem exportList="state.exportList" field="field" filterSubfields.bind="filterSubfields" isFieldExpandable.bind="isFieldExpandable" isDebug="isDebug" isExpanded="state.search.length &gt; 0" loadFields.bind="loadFields" onAdd.bind="onAddItemExportList"/>
                                </t>
                            </t>
                            <h3 t-else="" class="text-center text-muted mt-5 o_no_match">No match found.</h3>
                        </div>
                    </div>
                </div>
                <div t-attf-class="o_right_panel col-12 col-md-6 {{ state.isSmall ? 'h-50' : 'h-100' }} d-flex flex-column flex-nowrap mt-3 mt-md-0">
                    <div class="o_export_format">
                        <strong>Export Format:</strong>
                        <t t-foreach="availableFormats" t-as="format" t-key="format.tag">
                            <div class="radio form-check-inline ps-5">
                                <input t-att-id="'o_radio' + format.tag" type="radio" t-att-checked="format.tag === availableFormats[state.selectedFormat].tag" name="o_export_format_name" t-att-value="format.tag" class="form-check-input" t-on-change="setFormat"/>
                                <label class="form-check-label ms-1" t-att-for="'o_radio' + format.tag" t-esc="format.label"/>
                            </div>
                        </t>
                    </div>
                    <div class="mt-3">
                        <h4>Fields to export</h4>
                    </div>
                    <div class="o_exported_lists">
                        <div class="input-group mb-3">
                            <t t-if="state.templateId === 'new_template'">
                                <label class="pt-2 mb-0 fw-bold">Save as: </label>
                                <input t-ref="exportList" class="form-control ms-4 o_save_list_name" t-att-placeholder="newTemplateText"/>
                            </t>
                            <t t-else="">
                                <label class="pt-2 mb-0 fw-bold">Template: </label>
                                <select class="form-select ms-4 o_exported_lists_select" t-on-change="onChangeExportList">
                                    <option/>
                                    <t t-foreach="templates" t-as="template" t-key="template.id">
                                        <option t-att-value="template.id" t-esc="template.name or 'undefined'" t-att-selected="state.templateId === template.id"/>
                                    </t>
                                    <option class="fst-italic" value="new_template">New template </option>
                                </select>
                            </t>
                            <t t-if="state.isEditingTemplate">
                                <button t-if="state.templateId === 'new_template'" type="button" class="btn btn-secondary ms-1 o_save_list_btn" t-on-click.stop="onSaveExportTemplate">
                                    <i class="fa fa-floppy-o"/>
                                </button>
                                <button type="button" class="btn btn-secondary ms-1 o_cancel_list_btn" t-on-click.stop="onCancelExportTemplate">
                                    <i t-attf-class="fa {{ state.templateId === 'new_template' ? 'fa-times' : 'fa-undo' }}"/>
                                </button>
                            </t>
                            <t t-else="">
                                <button t-if="state.templateId" type="button" class="btn btn-secondary ms-1 o_delete_exported_list" t-on-click.stop="onDeleteExportTemplate">
                                    <i class="fa fa-trash"/>
                                </button>
                            </t>
                        </div>
                    </div>
                    <div class="o_right_field_panel h-100 px-2 overflow-auto border">
                        <ul class="o_fields_list list-unstyled" t-ref="draggable">
                            <t t-foreach="state.exportList" t-as="field" t-key="field.id">
                                <li t-attf-class="o_export_field d-inline-block w-100 {{ state.isSmall ? '' : 'o_export_field_sortable' }}" t-att-data-field_id="field.id">
                                    <span t-if="!state.isSmall" class="fa fa-sort o_sort_field mx-1" t-attf-style="opacity:{{ state.exportList.length === 1 ? 0 : 1 }}"/>
                                    <span t-esc="isDebug and field.id ? \`\${field.string} (\${field.id})\` : field.string"/>
                                    <span class="fa fa-trash m-1 pe-2 float-end o_remove_field cursor-pointer" t-att-title="removeFieldText" t-on-click.stop="() =&gt; this.onRemoveItemExportList(field.id)"/>
                                </li>
                            </t>
                        </ul>
                    </div>
                </div>
            </div>
            <t t-set-slot="footer">
                <button class="btn btn-primary o_select_button" data-hotkey="v" t-on-click.stop="onClickExportButton" t-att-disabled="state.disabled">Export</button>
                <button class="btn o_form_button_cancel" t-att-class="(props.disableMultipleSelection &amp;&amp; props.noCreate) ? 'btn-primary' : 'btn-secondary'" data-hotkey="z" t-on-click.stop="props.close">Close</button>
            </t>
        </Dialog>
    </t>

<t t-name="web.FormViewDialog">
    <Dialog size="props.size" title="props.title" withBodyPadding="false" modalRef="modalRef">
      <View t-props="viewProps"/>
      <t t-set-slot="footer">
        <t t-if="props.preventEdit and props.preventCreate">
          <button class="btn btn-primary" t-on-click="() =&gt; props.close()">Close</button>
        </t>
        <t t-else="">
          <button class="btn btn-primary o-default-button" t-on-click="() =&gt; props.close()">Ok</button>
        </t>
      </t>
    </Dialog>
  </t>

  <t t-name="web.FormViewDialog.ToMany.buttons">
        <div class="o_cp_buttons d-flex align-items-baseline w-100" role="toolbar" aria-label="Main actions" t-ref="cpButtons">
            <div t-if="model.root.isInEdition" class="o_form_buttons_edit d-flex gap-1">
                <button class="btn btn-primary o_form_button_save" t-on-click="saveButtonClicked" data-hotkey="c">Save &amp; Close</button>
      <button class="btn btn-primary o_form_button_save_new" t-on-click="() =&gt; this.saveButtonClicked({saveAndNew: true})" data-hotkey="n">Save &amp; New</button>
    <button type="button" class="btn btn-secondary o_form_button_cancel" data-hotkey="j" t-on-click.stop="discard">
                    Discard
                </button>
                <button t-if="props.removeRecord" class="btn btn-secondary o_form_button_remove" t-on-click="props.removeRecord" data-hotkey="x">
                    Remove
                </button>
            </div>
            <div t-elif="canCreate" class="o_form_buttons_view">
                <button type="button" class="btn btn-secondary o_form_button_create" data-hotkey="c" t-on-click.stop="create">
                    New
                </button>
            </div>
        </div>
    </t>
<t t-name="web.FormViewDialog.ToOne.buttons">
        <div class="o_cp_buttons d-flex align-items-baseline w-100" role="toolbar" aria-label="Main actions" t-ref="cpButtons">
            <div t-if="model.root.isInEdition" class="o_form_buttons_edit d-flex gap-1">
                <button class="btn btn-primary o_form_button_save" t-on-click="saveButtonClicked" data-hotkey="c">Save &amp; Close</button>
    <button type="button" class="btn btn-secondary o_form_button_cancel" data-hotkey="j" t-on-click.stop="discard">
                    Discard
                </button>
                <button t-if="props.removeRecord" class="btn btn-secondary o_form_button_remove" t-on-click="props.removeRecord" data-hotkey="x">
                    Remove
                </button>
            </div>
            <div t-elif="canCreate" class="o_form_buttons_view">
                <button type="button" class="btn btn-secondary o_form_button_create" data-hotkey="c" t-on-click.stop="create">
                    New
                </button>
            </div>
        </div>
    </t>
<t t-name="web.SelectCreateDialog">
        <Dialog title="props.title" withBodyPadding="false">
            <t t-set-slot="header" t-slot-scope="scope">
                <t t-call="web.Dialog.header">
                    <t t-set="dismiss" t-value="scope.close"/>
                    <t t-set="fullscreen" t-value="scope.isFullscreen"/>
                </t>
                <button t-if="this.canUnselect" class="btn o_clear_button" t-on-click="() =&gt; this.unselect()">Clear</button>
            </t>
            <View t-props="viewProps"/>
            <t t-set-slot="footer">
                <t t-if="props.multiSelect">
                    <button class="btn btn-primary o_select_button" t-att-disabled="state.resIds.length === 0" data-hotkey="v" t-on-click="() =&gt; this.select(state.resIds)">
                        Select
                    </button>
                </t>
                <t t-if="!props.noCreate">
                    <button class="btn btn-primary o_create_button" data-hotkey="c" t-on-click="createEditRecord">New</button>
                </t>
                <button class="btn o_form_button_cancel" t-att-class="(!props.multiSelect &amp;&amp; props.noCreate) ? 'btn-primary' : 'btn-secondary'" data-hotkey="z" t-on-click="() =&gt; this.props.close()">Close</button>
            </t>
        </Dialog>
    </t>

<t t-name="web.AttachDocument">
        <button t-attf-class="btn o_attachment_button #{props.highlight ? 'btn-primary' : 'btn-secondary'}" t-on-click="() =&gt; this.triggerUpload()">
            <span class="o_attach_document" t-esc="props.string"/>
        </button>
    </t>

<t t-name="web.DocumentationLink">
        <a t-att-href="url" title="Documentation" class="o_doc_link me-2" target="_blank"/>
    </t>
<t t-name="web.NotificationAlert">
        <div t-if="isNotificationBlocked" class="alert alert-primary text-center">
            Odoo Push notifications have been blocked. Go to your browser settings to allow them.
        </div>
    </t>
<t t-name="web.Ribbon">
        <div class="ribbon ribbon-top-right">
            <span t-att-class="classes" t-att-title="props.title">
                <t t-esc="props.text"/>
            </span>
        </div>
    </t>

<t t-name="web.SignatureWidget">
        <button t-attf-class="btn o_sign_button #{props.highlight ? 'btn-primary' : 'btn-secondary'}" t-on-click="onClickSignature">
            <span class="o_sign_label" t-esc="props.string"/>
        </button>
    </t>

<t t-name="web.WeekDays">
        <div class="o_recurrent_weekdays border mt-2 mb-2">
            <table class="table table-responsive mb-0">
                <tr>
                    <t t-foreach="weekdays" t-as="day" t-key="day">
                        <th class="text-center border fw-bold">
                            <div class="o_recurrent_weekday_label" t-att-data-tooltip="props.record.fields[day].string">
                                <t t-esc="props.record.fields[day].string"/>
                            </div>
                        </th>
                    </t>
                </tr>
                <tr>
                    <t t-foreach="weekdays" t-as="day" t-key="day">
                        <td>
                            <CheckBox disabled="props.readonly" value="data[day]" className="'o_recurrent_weekday_checkbox text-center'" onChange="(checked) =&gt; this.onChange(day, checked)"/>
                        </td>
                    </t>
                </tr>
            </table>
        </div>
    </t>

<t t-name="web.ActionMenus">
        <div class="o_cp_action_menus d-flex pe-2 gap-1">
            <Dropdown t-if="printItems.length" class="'d-inline-block'" togglerClass="'btn btn-secondary'" hotkey="'shift+u'">
                <t t-set-slot="toggler">
                    <i class="fa fa-print me-1"/>
                    <span class="o_dropdown_title">Print</span>
                </t>
                <t t-foreach="printItems" t-as="item" t-key="item.key">
                    <DropdownItem class="'o_menu_item'" onSelected="() =&gt; this.onItemSelected(item)">
                        <t t-esc="item.description"/>
                    </DropdownItem>
                </t>
            </Dropdown>

            <Dropdown t-if="actionItems.length" class="'d-inline-block'" togglerClass="'btn btn-secondary'" hotkey="'u'">
                <t t-set-slot="toggler">
                    <i class="fa fa-cog me-1"/>
                    <span class="o_dropdown_title">Actions</span>
                </t>
                <t t-foreach="actionItems" t-as="item" t-key="item.key">
                    <t t-if="item.Component" t-component="item.Component" t-props="item.props"/>
                    <DropdownItem t-else="" class="'o_menu_item'" onSelected="() =&gt; this.onItemSelected(item)">
                        <i t-if="item.icon" t-att-class="item.icon + ' me-1 fa-fw oi-fw'"/>
                        <t t-esc="item.description"/>
                    </DropdownItem>
                </t>
            </Dropdown>
        </div>
    </t>

<t t-name="web.CogMenu">
        <div t-if="hasItems" class="o_cp_action_menus d-flex align-items-center pe-2 gap-1">
            <Dropdown class="'lh-1'" togglerClass="'d-print-none btn p-0 ms-1 lh-sm border-0'" menuClass="'lh-base'">
                <t t-set-slot="toggler">
                    <i class="fa fa-cog" data-hotkey="u" data-tooltip="Actions"/>
                </t>

                <t t-if="printItems.length">
                    <Dropdown t-if="printItems.length &gt; 1">
                        <t t-set-slot="toggler">
                            <i class="fa fa-print me-1"/> Print
                        </t>
                        <DropdownItem t-foreach="printItems" t-as="item" t-key="item.key" class="'o_menu_item'" onSelected="() =&gt; this.onItemSelected(item)">
                            <t t-esc="item.description"/>
                        </DropdownItem>
                    </Dropdown>

                    <DropdownItem t-else="" class="'o_menu_item'" onSelected="() =&gt; this.onItemSelected(printItems[0])">
                        <i class="fa fa-print me-1"/> <t t-out="printItems[0].description"/>
                    </DropdownItem>
                </t>

                <t t-foreach="cogItems" t-as="item" t-key="item.key">
                    <t t-if="currentGroup !== null and currentGroup !== item.groupNumber">
                        <div role="separator" class="dropdown-divider"/>
                    </t>

                    <t t-if="item.Component" t-component="item.Component" t-props="item.props"/>

                    <DropdownItem t-else="" class="'o_menu_item'" onSelected="() =&gt; this.onItemSelected(item)">
                        <i t-if="item.icon" t-att-class="item.icon" class="fa-fw oi-fw me-1"/>
                        <t t-esc="item.description"/>
                    </DropdownItem>

                    <t t-set="currentGroup" t-value="item.groupNumber"/>
                </t>
            </Dropdown>
        </div>
    </t>

<t t-name="web.ControlPanel">
        <div class="o_control_panel d-flex flex-column gap-3 gap-lg-1 px-3 pt-2 pb-3" t-ref="root" data-command-category="actions">
            <div class="o_control_panel_main d-flex flex-wrap flex-lg-nowrap justify-content-between align-items-lg-start gap-3 flex-grow-1">
                <div class="o_control_panel_breadcrumbs d-flex align-items-center gap-1 order-0 h-lg-100">
                    <div class="o_control_panel_main_buttons d-flex gap-1 d-empty-none d-print-none" t-ref="mainButtons" t-on-keydown="onMainButtonsKeydown">
                        <div class="btn-group d-xl-none o_control_panel_collapsed_create">
                            <t t-slot="control-panel-create-button"/>
                            <button t-att-class="{invisible: display.disableDropdown}" type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split o_control_panel_collapsed_create" data-bs-toggle="dropdown" aria-expanded="false">
                                 <span class="visually-hidden">Toggle Dropdown</span>
                            </button>
                            <ul class="dropdown-menu o_control_panel_collapsed_create">
                                <t t-slot="layout-buttons"/>
                                <t t-slot="control-panel-always-buttons"/>
                            </ul>
                        </div>
                        <div class="d-none d-xl-inline-flex gap-1">
                            <t t-slot="control-panel-create-button"/>
                            <t t-slot="layout-buttons"/>
                            <t t-slot="control-panel-always-buttons"/>
                        </div>
                    </div>
                    <t t-if="env.config.noBreadcrumbs">
                        <section class="o_control_panel_breadcrumbs_actions d-contents">
                            <t t-slot="control-panel-additional-actions"/>
                            <t t-slot="control-panel-status-indicator"/>
                        </section>
                    </t>
                    <t t-else="">
                        <t t-slot="control-panel-breadcrumb">
                            <t t-call="web.Breadcrumbs"/>
                        </t>
                    </t>
                    <span class="d-none d-xl-block me-auto"/> 
                </div>

                <div class="o_control_panel_actions d-empty-none d-flex align-items-center justify-content-start justify-content-lg-around order-2 order-lg-1 w-100 w-lg-auto">
                    <t t-if="display.layoutActions" t-slot="layout-actions"/>
                    <t t-slot="control-panel-selection-actions"/>
                </div>

                <div class="o_control_panel_navigation d-flex flex-wrap flex-md-nowrap justify-content-end gap-3 gap-lg-1 gap-xl-3 order-1 order-lg-2 flex-grow-1">
                    <div t-if="pagerProps and pagerProps.total &gt; 0" class="o_cp_pager text-nowrap " role="search">
                        <Pager t-props="pagerProps"/>
                    </div>
                    <t t-if="env.config.viewSwitcherEntries?.length &gt; 1">
                        <Dropdown class="'o_cp_switch_buttons d-xl-none btn-group'" togglerClass="'btn btn-secondary'" showCaret="true">
                            <t t-set-slot="toggler">
                                <t t-set="activeView" t-value="env.config.viewSwitcherEntries.find((view) =&gt; view.active)"/>
                                <i class="oi-fw" t-att-class="activeView.icon"/>
                            </t>
                            <t t-foreach="env.config.viewSwitcherEntries" t-as="view" t-key="view.type">
                                <DropdownItem onSelected="() =&gt; this.onViewClicked(view.type)" class="view.active ? 'selected' : ''">
                                    <i class="oi-fw" t-att-class="view.icon"/>
                                    <span class="ms-1" t-out="view.name"/>
                                </DropdownItem>
                            </t>
                        </Dropdown>
                        <nav class="o_cp_switch_buttons d-print-none d-none d-xl-inline-flex btn-group">
                            <t t-foreach="env.config.viewSwitcherEntries" t-as="view" t-key="view.type">
                                <button class="btn btn-secondary o_switch_view " t-attf-class="o_{{view.type}} {{view.active ? 'active' : ''}}" t-att-data-tooltip="view.name" t-on-click="() =&gt; this.onViewClicked(view.type)">
                                    <i t-att-class="view.icon"/>
                                </button>
                            </t>
                        </nav>
                    </t>
                    <t t-slot="control-panel-navigation-additional"/>
                </div>
            </div>
        </div>
    </t>

    <t t-name="web.Breadcrumbs">
        <t t-set="currentBreadcrumbs" t-value="breadcrumbs.slice(-1)"/>
        <t t-set="visiblePathBreadcrumbs" t-value="breadcrumbs.slice(-3, -1)"/>
        <t t-set="collapsedBreadcrumbs" t-value="breadcrumbs.slice(0, -3).reverse()"/>
        <t t-set="breadcrumb" t-value="currentBreadcrumbs[0] || {}"/>

        <div t-if="collapsedBreadcrumbs.length || visiblePathBreadcrumbs.length" class="o_breadcrumb d-flex flex-row flex-md-column align-self-stretch justify-content-between min-w-0">
            <t t-if="env.isSmall">
                <t t-set="previousBreadcrumb" t-value="visiblePathBreadcrumbs.slice(-1)"/>
                <button class="o_back_button btn btn-link px-1" t-on-click.prevent="() =&gt; this.onBreadcrumbClicked(previousBreadcrumb.jsId)">
                    <i class="oi oi-fw oi-arrow-left"/>
                </button>
            </t>
            <t t-else="">
                <ol class="breadcrumb flex-nowrap text-nowrap small lh-sm">
                    <li t-if="collapsedBreadcrumbs.length" class="breadcrumb-item d-inline-flex min-w-0">
                        <Dropdown togglerClass="'btn btn-light btn-sm px-1 p-0'">
                            <t t-set-slot="toggler">
                                <i class="fa fa-ellipsis-h"/>
                            </t>
                            <t t-foreach="collapsedBreadcrumbs" t-as="breadcrumb" t-key="breadcrumb.jsId">
                                <DropdownItem onSelected="() =&gt; this.onBreadcrumbClicked(breadcrumb.jsId)">
                                    <t t-call="web.Breadcrumb.Name"/>
                                </DropdownItem>
                            </t>
                        </Dropdown>
                    </li>
                    <t t-foreach="visiblePathBreadcrumbs" t-as="breadcrumb" t-key="breadcrumb.jsId">
                        <li class="breadcrumb-item d-inline-flex min-w-0" t-att-class="{ o_back_button: breadcrumb_last }" t-att-data-hotkey="breadcrumb_last and 'b'" t-on-click.prevent="() =&gt; this.onBreadcrumbClicked(breadcrumb.jsId)">
                            <a href="#" class="fw-bold text-truncate" t-att-data-tooltip="'Back to &quot;' + breadcrumb.name + '&quot;'"><t t-call="web.Breadcrumb.Name"/></a>
                        </li>
                    </t>
                </ol>
            </t>
            <div class="d-flex gap-1 text-truncate">
                <div class="o_last_breadcrumb_item active d-flex gap-2 align-items-center min-w-0 lh-sm">
                    <span class="min-w-0 text-truncate" t-call="web.Breadcrumb.Name"/>
                </div>
                <t t-call="web.Breadcrumb.Actions"/>
            </div>
        </div>

        <div t-else="" class="o_breadcrumb d-flex gap-1 text-truncate">
            <div class="o_last_breadcrumb_item active d-flex fs-4 min-w-0 align-items-center">
                <span class="min-w-0 text-truncate" t-call="web.Breadcrumb.Name"/>
            </div>
            <t t-call="web.Breadcrumb.Actions"/>
        </div>

        <t t-slot="control-panel-status-indicator"/>
    </t>

    <t t-name="web.Breadcrumb.Actions">
        <div class="o_control_panel_breadcrumbs_actions d-inline-flex">
            <t t-slot="control-panel-additional-actions"/>
        </div>
    </t>

    <t t-name="web.Breadcrumb.Name">
        <t t-if="breadcrumb.name" t-out="breadcrumb.name"/>
        <em t-else="" class="text-warning">Unnamed</em>
        <t t-slot="control-panel-additional-breadcrums"/>
    </t>

<t t-name="web.CustomFavoriteItem">
        <t t-set="saveCurrentSearchDescription">Save current search</t>
        <AccordionItem class="'o_add_favorite text-truncate'" description="saveCurrentSearchDescription">
            <div class="px-3 py-2">
                <input type="text" class="o_input" t-ref="description" t-model.trim="state.description" t-on-keydown="onInputKeydown"/>
                <CheckBox value="state.isDefault" onChange.bind="onDefaultCheckboxChange">
                    <span data-tooltip="Use this filter by default when opening this view">Default filter</span>
                </CheckBox>
                <CheckBox value="state.isShared" onChange.bind="onShareCheckboxChange">
                    <span data-tooltip="Make this filter available to other users">Shared</span>
                </CheckBox>
            </div>
            <div class="px-3 py-2">
                <button class="o_save_favorite btn btn-primary w-100" t-on-click="saveFavorite">
                    Save
                </button>
            </div>
        </AccordionItem>
    </t>

<t t-name="web.CustomGroupByItem">
        <select class="o_add_custom_group_menu o_menu_item dropdown-item" t-on-change="(ev) =&gt; this.onSelected(ev)">
            <option value="" disabled="true" selected="true" hidden="true">Add Custom Group</option>
            <option t-foreach="props.fields" t-as="field" t-key="field.name" t-if="field.type !== 'properties' and !field.isProperty" t-att-value="field.name" t-esc="field.string"/>
        </select>
    </t>

<t t-name="web.Layout">
        <t t-if="env.inDialog" t-portal="'#' + env.dialogId + ' .modal-footer'">
            <t t-slot="layout-buttons"/>
        </t>
        <t t-component="components.ControlPanel" slots="controlPanelSlots" t-if="display.controlPanel" display="display.controlPanel"/>
        <t t-component="components.Banner" t-if="display.banner"/>
        <div t-ref="content" class="o_content" t-attf-class="{{props.className}}" t-att-class="{ 'o_component_with_search_panel': display.searchPanel }">
            <t t-component="components.SearchPanel" t-if="display.searchPanel"/>
            <t t-slot="default" contentRef="contentRef"/>
        </div>
    </t>

<t t-name="web.PropertiesGroupByItem">
        <AccordionItem class="'o_add_custom_group_menu text-truncate'" description="props.item.description" selected="isActive">
            <t t-set="items" t-value="state.groupByItems"/>
            <t t-if="items and items.length">
                <t t-foreach="items" t-as="item" t-key="item.name">
                    <t t-set="description" t-value="isSingleParent ? item.description : \`\${item.description} (\${item.definitionRecordName})\`"/>

                    <AccordionItem t-if="item.options" description="description" selected="item.isActive">
                        <t t-foreach="item.options" t-as="option" t-key="option.id">
                            <t t-set="optionName" t-value="\`\${item.name}:\${option.id}\`"/>
                            <CheckboxItem class="{ o_item_option: true, selected: option.isActive }" checked="option.isActive" parentClosingMode="'none'" t-esc="option.description" onSelected="() =&gt; this.onGroup({ itemId: item.id, optionId: option.id})"/>
                        </t>
                    </AccordionItem>

                    <CheckboxItem t-else="" class="{ o_menu_item: true, selected: item.isActive }" checked="item.isActive" parentClosingMode="'none'" t-esc="description" onSelected="() =&gt; this.onGroup({ itemId: item.id })"/>
                </t>
            </t>
            <DropdownItem t-else="" parentClosingMode="'none'" class="'fst-italic'">
                No Properties
            </DropdownItem>
        </AccordionItem>
    </t>
<t t-name="web.SearchBar.Facets">
        <t t-foreach="env.searchModel.facets" t-as="facet" t-key="facet_index">
            <div class="o_searchview_facet position-relative d-inline-flex align-items-stretch rounded-2 bg-200 text-nowrap opacity-trigger-hover" t-att-class="{o_facet_with_domain: facet.domain }" role="listitem" aria-label="search" tabindex="0" t-on-keydown="ev =&gt; this.onFacetKeydown(facet, facet_index, ev)">


                <div class="position-absolute start-0 top-0 bottom-0 end-0 bg-view border rounded-2 shadow opacity-0 opacity-100-hover"/>

                <div class="o_searchview_facet_label position-relative rounded-start-2 px-1" t-on-click="(ev) =&gt; this.onFacetLabelClick(ev.target, facet)" t-att-role="facet.domain ? 'button' : 'img'" t-att-class="{                         'text-bg-action d-flex align-items-center': facet.type == 'groupBy' || facet.type == 'comparison',                         'btn btn-primary rounded-end-0 p-0': facet.type == 'field' || facet.type == 'filter',                         'btn btn-favourite rounded-end-0 p-0': facet.type == 'favorite'                     }">
                    <i t-if="facet.icon" class="small fa-fw" t-att-class="facet.icon" role="image"/>
                    <small t-else="" class="px-1" t-esc="facet.title"/>


                    <span t-if="facet.domain" class="position-absolute start-0 top-0 bottom-0 end-0 bg-inherit opacity-0 opacity-100-hover" t-att-class="{'px-2 transition-base': !facet.icon}">
                        <i class="fa fa-fw fa-cog"/>
                    </span>
                </div>

                <div class="o_facet_values position-relative d-flex flex-wrap align-items-center ps-2 rounded-end-2 text-wrap">
                    <t t-foreach="facet.values" t-as="facetValue" t-key="facetValue_index">
                        <em t-if="!facetValue_first" class="o_facet_values_sep small fw-bold mx-1 opacity-50" t-esc="facet.separator"/>
                        <small class="o_facet_value" t-esc="facetValue"/>
                    </t>
                    <button class="o_facet_remove oi oi-close btn btn-link py-0 px-2 text-danger" role="button" aria-label="Remove" title="Remove" t-on-click="() =&gt; this.onFacetRemove(facet)"/>
                </div>
            </div>
        </t>
    </t>

    <t t-name="web.SearchBar.Input">
        <input type="text" class="o_searchview_input o_input d-print-none flex-grow-1 w-auto border-0" accesskey="Q" placeholder="Search..." role="searchbox" t-ref="autofocus" t-on-keydown="onSearchKeydown" t-on-input="onSearchInput"/>
    </t>

    <t t-name="web.SearchBar.Items">
        <ul class="o-dropdown--menu dropdown-menu o_searchview_autocomplete show" role="menu">
            <t t-foreach="items" t-as="item" t-key="item.id">
                <li class="o_menu_item dropdown-item" t-att-class="{ o_indent: item.isChild, focus: item_index === state.focusedIndex}" t-att-id="item.id" t-on-click="() =&gt; this.selectItem(item)" t-on-mousemove="() =&gt; this.onItemMousemove(item_index)">
                    <t t-if="item.isParent">
                        <a t-att-class="{ o_expand: true, 'ms-4': item.isFieldProperty}" href="#" t-on-click.stop.prevent="() =&gt; this.toggleItem(item, !item.isExpanded)">
                            <i t-attf-class="fa fa-caret-{{ item.isExpanded ? 'down' : 'right' }}"/>
                        </a>
                    </t>
                    <a href="#" t-on-click.prevent="" t-att-class="{'ps-3 pe-2 text-truncate': item.isFieldProperty }" t-att-title="item.title">
                        <t t-if="item.isChild">
                            <t t-esc="item.label"/>
                        </t>
                        <t t-elif="!item.isFieldProperty"> Search </t> <b t-esc="item.searchItemDescription"/> <t t-if="item.preposition"> <t t-esc="item.preposition"/>: <b class="fst-italic text-primary" t-esc="item.label"/> </t>
                    </a>
                </li>
            </t>
        </ul>
    </t>

    <t t-name="web.SearchBar">
        <div class="o_cp_searchview d-flex input-group" role="search" t-ref="root">
            <div class="o_searchview form-control d-print-contents d-flex align-items-center py-1" role="search" aria-autocomplete="list">
                <i class="o_searchview_icon d-print-none oi oi-search me-2" role="img" aria-label="Search..." title="Search..."/>
                <div class="o_searchview_input_container d-flex flex-grow-1 flex-wrap gap-1">
                    <t t-call="web.SearchBar.Facets"/>
                    <t t-call="web.SearchBar.Input"/>
                    <t t-if="items.length">
                        <t t-call="web.SearchBar.Items"/>
                    </t>
                </div>
            </div>
            <SearchBarMenu>
                <t t-slot="search-bar-additional-menu"/>
            </SearchBarMenu>
        </div>
    </t>

<t t-name="web.SearchBar.Toggler">
        <button t-if="props.isSmall" t-attf-class="btn btn-secondary {{ props.showSearchBar ? 'active' : '' }}" t-on-click="props.toggleSearchBar">
            <i class="fa fa-fw fa-search"/>
        </button>
    </t>

<t t-name="web.SearchBarMenu">
        <Dropdown togglerClass="'o_searchview_dropdown_toggler d-print-none btn btn-outline-secondary o-no-caret rounded-start-0 h-100'" menuClass="'o_search_bar_menu d-flex flex-wrap flex-lg-nowrap w-100 w-md-auto mx-md-auto mt-2 py-3'" position="'bottom-end'" holdOnHover="true" t-if="this.env.searchModel.searchMenuTypes.size">
            <t t-set-slot="toggler" t-slot-scope="scope">
                <i class="fa fa-caret-down" aria-hidden="true" data-hotkey="shift+q" title="Toggle Search Panel"/>
            </t>

            <t t-if="this.env.searchModel.searchMenuTypes.has('filter')">
                <div class="o_dropdown_container o_filter_menu w-100 h-100 w-lg-auto px-3 mb-4 mb-lg-0 border-end">
                    <div class="px-3 fs-5 mb-2">
                        <i class="me-2 text-primary" t-att-class="facet_icons.filter"/>
                        <h5 class="o_dropdown_title d-inline">Filters</h5>
                    </div>
                    <t t-set="currentGroup" t-value="null"/>
                    <t t-foreach="filterItems" t-as="item" t-key="item.id">
                        <t t-if="currentGroup !== null and currentGroup !== item.groupNumber">
                            <div class="dropdown-divider" role="separator"/>
                        </t>
                        <t t-if="item.options">
                            <AccordionItem class="'text-truncate'" description="item.description" selected="item.isActive">
                                <t t-set="subGroup" t-value="null"/>
                                <t t-foreach="item.options" t-as="option" t-key="option.id">
                                    <t t-if="subGroup !== null and subGroup !== option.groupNumber">
                                        <div class="dropdown-divider" role="separator"/>
                                    </t>
                                    <CheckboxItem class="{ o_item_option: true, selected: option.isActive }" t-esc="option.description" checked="option.isActive" parentClosingMode="'none'" onSelected="() =&gt; this.onFilterSelected({ itemId: item.id, optionId: option.id })"/>
                                    <t t-set="subGroup" t-value="option.groupNumber"/>
                                </t>
                            </AccordionItem>
                        </t>
                        <t t-else="">
                            <CheckboxItem class="{ 'o_menu_item text-truncate': true, selected: item.isActive }" checked="item.isActive" parentClosingMode="'none'" t-esc="item.description" title="item.description.length &gt; 15 ? item.description : ''" onSelected="() =&gt; this.onFilterSelected({ itemId: item.id })"/>
                        </t>
                        <t t-set="currentGroup" t-value="item.groupNumber"/>
                    </t>
                    <t t-if="filterItems.length">
                        <div role="separator" class="dropdown-divider"/>
                    </t>
                    <DropdownItem class="'o_menu_item o_add_custom_filter'" onSelected.bind="onAddCustomFilterClick">Add Custom Filter</DropdownItem>
                </div>
            </t>

            <t t-if="this.env.searchModel.searchMenuTypes.has('groupBy')">
                <div class="o_dropdown_container o_group_by_menu w-100 h-100 w-lg-auto px-3 mb-4 mb-lg-0 border-end">
                    <div class="px-3 fs-5 mb-2">
                        <i class="me-2 text-action" t-att-class="facet_icons.groupBy"/>
                        <h5 class="o_dropdown_title d-inline">Group By</h5>
                    </div>
                    <t t-set="currentGroup" t-value="null"/>
                    <t t-foreach="groupByItems" t-as="item" t-key="item.id">
                        <t t-if="currentGroup !== null and currentGroup !== item.groupNumber">
                            <div class="dropdown-divider" role="separator"/>
                        </t>
                        <t t-if="item.fieldType === 'properties'">
                            <PropertiesGroupByItem item="item" onGroup.bind="onGroupBySelected"/>
                        </t>
                        <t t-elif="item.options">
                            <AccordionItem class="'text-truncate'" description="item.description" selected="item.isActive">
                                <t t-set="subGroup" t-value="null"/>
                                <t t-foreach="item.options" t-as="option" t-key="option.id">
                                    <t t-if="subGroup !== null and subGroup !== option.groupNumber">
                                        <div class="dropdown-divider" role="separator"/>
                                    </t>
                                    <CheckboxItem class="{ o_item_option: true, selected: option.isActive }" checked="option.isActive ? true : false" parentClosingMode="'none'" t-esc="option.description" title="option.description.length &gt; 15 ? option.description : ''" onSelected="() =&gt; this.onGroupBySelected({ itemId: item.id, optionId: option.id})"/>
                                    <t t-set="subGroup" t-value="option.groupNumber"/>
                                </t>
                            </AccordionItem>
                        </t>
                        <t t-else="">
                            <CheckboxItem class="{ 'o_menu_item text-truncate': true, selected: item.isActive }" checked="item.isActive" parentClosingMode="'none'" t-esc="item.description" title="item.description.length &gt; 15 ? item.description : ''" onSelected="() =&gt; this.onGroupBySelected({ itemId: item.id })"/>
                        </t>
                        <t t-set="currentGroup" t-value="item.groupNumber"/>
                    </t>
                    <t t-if="!hideCustomGroupBy and fields.length">
                        <div t-if="groupByItems.length" role="separator" class="dropdown-divider"/>
                        <CustomGroupByItem fields="fields" onAddCustomGroup.bind="onAddCustomGroup"/>
                    </t>
                </div>
            </t>

            <t t-if="showComparisonMenu">
                <div class="o_dropdown_container o_comparison_menu w-100 h-100 w-lg-auto px-3 border-end">
                    <div class="px-3 fs-5 mb-2">
                        <i class="me-2 text-danger" t-att-class="facet_icons.comparison"/>
                        <h5 class="o_dropdown_title d-inline">Comparison</h5>
                    </div>
                    <t t-foreach="comparisonItems" t-as="item" t-key="item.id">
                        <CheckboxItem class="{ 'o_menu_item text-truncate': true, selected: item.isActive }" checked="item.isActive" parentClosingMode="'none'" t-esc="item.description" title="item.description.length &gt; 15 ? item.description : ''" onSelected="() =&gt; this.onComparisonSelected(item.id)"/>
                    </t>
                </div>
            </t>

            <t t-if="this.env.searchModel.searchMenuTypes.has('favorite')">
                <div class="o_dropdown_container o_favorite_menu w-100 h-100 w-lg-auto px-3">
                    <div class="px-3 fs-5 mb-2">
                        <i class="me-2 text-favourite" t-att-class="facet_icons.favorite"/>
                        <h5 class="o_dropdown_title d-inline">Favorites</h5>
                    </div>
                    <t t-set="currentGroup" t-value="null"/>
                    <t t-foreach="favoriteItems" t-as="item" t-key="item.id or item.key">
                        <t t-if="currentGroup !== null and currentGroup !== item.groupNumber">
                            <div role="separator" class="dropdown-divider"/>
                        </t>
                        <t t-if="item.type ==='favorite'">
                            <CheckboxItem class="{ 'o_menu_item text-truncate': true, selected: item.isActive }" checked="item.isActive" parentClosingMode="'none'" onSelected="() =&gt; this.onFavoriteSelected(item.id)">
                                <span class="d-flex p-0 align-items-center justify-content-between">
                                    <span t-out="item.description" t-att-title="item.description.length &gt; 15 ? item.description : ''" class="text-truncate"/>
                                    <i class="ms-1 o_icon_right fa fa-trash-o" title="Delete item" t-on-click.stop="() =&gt; this.openConfirmationDialog(item.id)"/>
                                </span>
                            </CheckboxItem>
                        </t>
                        <t t-else="">
                            <t t-component="item.Component"/>
                        </t>
                        <t t-set="currentGroup" t-value="item.groupNumber"/>
                    </t>
                </div>
            </t>
            <t t-slot="default"/>
        </Dropdown>
    </t>

<t t-name="web.SearchPanel">
    <t t-if="env.isSmall">
        <t t-call="web.SearchPanel.Small"/>
    </t>
    <t t-else="">
        <t t-call="web.SearchPanel.Regular"/>
    </t>
</t>

<t t-name="web.SearchPanelContent">
    <div class="o_search_panel flex-grow-0 flex-shrink-0 h-100 pb-5 bg-view overflow-auto" t-att-class="env.searchModel.searchPanelInfo.className" t-attf-class="#{env.isSmall ? 'px-3' : 'pe-1 ps-3'}" t-ref="root">
        <div t-if="!sections or sections.length === 0" class="o_search_panel_empty_state me-3">
            <button class="btn w-100 overflow-visible">
                <div class="d-flex align-items-center me-2 ms-auto">All</div>
            </button>
        </div>
        <section t-foreach="sections" t-as="section" t-key="section.id" t-attf-class="o_search_panel_section o_search_panel_{{ section.type }}">
            <header class="o_search_panel_section_header pt-4 pb-2 text-uppercase cursor-default">
                <i t-attf-class="fa {{ section.icon }} o_search_panel_section_icon {{!section.color &amp;&amp; section.type == 'filter' ? 'text-warning' : !section.color ? 'text-primary': ''}} me-2" t-att-style="section.color and ('color: ' + section.color)"/>
                <b t-esc="section.description"/>
            </header>
            <div t-if="section.errorMsg" class="alert alert-warning">
                <span><t t-esc="section.errorMsg"/></span>
            </div>
            <ul t-else="" class="list-group d-block o_search_panel_field">
                <t t-if="section.type === 'category'" t-call="{{ constructor.subTemplates.category }}">
                    <t t-set="values" t-value="section.rootIds"/>
                </t>
                <t t-elif="section.groups">
                    <li t-foreach="section.sortedGroupIds" t-as="groupId" t-key="groupId" class="o_search_panel_filter_group list-group-item p-0 border-0" t-att-class="groupId_last? 'mb-0' : 'mb-3'">

                        <t t-set="_section" t-value="section"/>
                        <t t-set="group" t-value="section.groups.get(groupId)"/>
                        <header class="o_search_panel_group_header pb-1">
                            <div class="form-check w-100">

                                <input type="checkbox" class="form-check-input" t-attf-id="{{ section.id }}_input_{{ groupId }})" t-on-click="() =&gt; this.toggleFilterGroup(section.id, group)"/>
                                <label t-attf-for="{{ section.id }}_input_{{ groupId }})" class="o_search_panel_label form-check-label d-flex align-items-center justify-content-between w-100 cursor-pointer" t-att-class="{ o_with_counters: group.enableCounters }" t-att-title="group.tooltip or false">
                                    <span class="o_search_panel_label_title text-truncate" t-attf-class="{{ group.color_index ? 'o_tag o_badge badge rounded-pill o_tag_color_' + group.color_index : ''}}">
                                        <t t-esc="group.name"/>
                                    </span>
                                </label>
                            </div>
                        </header>
                        <ul class="list-group d-block">
                            <t t-call="{{ constructor.subTemplates.filtersGroup }}">
                                <t t-set="values" t-value="group.values"/>
                                <t t-set="isChildList" t-value="true"/>

                                <t t-set="section" t-value="_section"/>
                            </t>
                        </ul>
                    </li>
                    <ul t-if="section.groups.get(false)" class="list-group d-block">
                        <t t-call="{{ constructor.subTemplates.filtersGroup }}">
                            <t t-set="group" t-value="section.groups.get(false)"/>
                            <t t-set="values" t-value="group.values"/>

                            <t t-set="section" t-value="section"/>
                        </t>
                    </ul>
                </t>
                <t t-else="" t-call="{{ constructor.subTemplates.filtersGroup }}">
                    <t t-set="values" t-value="section.values"/>
                </t>
            </ul>
        </section>
    </div>
</t>

<t t-name="web.SearchPanel.Regular">
    <div class="o_search_panel flex-grow-0 flex-shrink-0 h-100 pb-5 bg-view overflow-auto" t-att-class="env.searchModel.searchPanelInfo.className" t-attf-class="#{env.isSmall ? 'px-3' : 'pe-1 ps-3'}" t-ref="root">
        <div t-if="!sections or sections.length === 0" class="o_search_panel_empty_state me-3">
            <button class="btn w-100 overflow-visible">
                <div class="d-flex align-items-center me-2 ms-auto">All</div>
            </button>
        </div>
        <section t-foreach="sections" t-as="section" t-key="section.id" t-attf-class="o_search_panel_section o_search_panel_{{ section.type }}">
            <header class="o_search_panel_section_header pt-4 pb-2 text-uppercase cursor-default">
                <i t-attf-class="fa {{ section.icon }} o_search_panel_section_icon {{!section.color &amp;&amp; section.type == 'filter' ? 'text-warning' : !section.color ? 'text-primary': ''}} me-2" t-att-style="section.color and ('color: ' + section.color)"/>
                <b t-esc="section.description"/>
            </header>
            <div t-if="section.errorMsg" class="alert alert-warning">
                <span><t t-esc="section.errorMsg"/></span>
            </div>
            <ul t-else="" class="list-group d-block o_search_panel_field">
                <t t-if="section.type === 'category'" t-call="{{ constructor.subTemplates.category }}">
                    <t t-set="values" t-value="section.rootIds"/>
                </t>
                <t t-elif="section.groups">
                    <li t-foreach="section.sortedGroupIds" t-as="groupId" t-key="groupId" class="o_search_panel_filter_group list-group-item p-0 border-0" t-att-class="groupId_last? 'mb-0' : 'mb-3'">

                        <t t-set="_section" t-value="section"/>
                        <t t-set="group" t-value="section.groups.get(groupId)"/>
                        <header class="o_search_panel_group_header pb-1">
                            <div class="form-check w-100">

                                <input type="checkbox" class="form-check-input" t-attf-id="{{ section.id }}_input_{{ groupId }})" t-on-click="() =&gt; this.toggleFilterGroup(section.id, group)"/>
                                <label t-attf-for="{{ section.id }}_input_{{ groupId }})" class="o_search_panel_label form-check-label d-flex align-items-center justify-content-between w-100 cursor-pointer" t-att-class="{ o_with_counters: group.enableCounters }" t-att-title="group.tooltip or false">
                                    <span class="o_search_panel_label_title text-truncate" t-attf-class="{{ group.color_index ? 'o_tag o_badge badge rounded-pill o_tag_color_' + group.color_index : ''}}">
                                        <t t-esc="group.name"/>
                                    </span>
                                </label>
                            </div>
                        </header>
                        <ul class="list-group d-block">
                            <t t-call="{{ constructor.subTemplates.filtersGroup }}">
                                <t t-set="values" t-value="group.values"/>
                                <t t-set="isChildList" t-value="true"/>

                                <t t-set="section" t-value="_section"/>
                            </t>
                        </ul>
                    </li>
                    <ul t-if="section.groups.get(false)" class="list-group d-block">
                        <t t-call="{{ constructor.subTemplates.filtersGroup }}">
                            <t t-set="group" t-value="section.groups.get(false)"/>
                            <t t-set="values" t-value="group.values"/>

                            <t t-set="section" t-value="section"/>
                        </t>
                    </ul>
                </t>
                <t t-else="" t-call="{{ constructor.subTemplates.filtersGroup }}">
                    <t t-set="values" t-value="section.values"/>
                </t>
            </ul>
        </section>
    </div>
</t>

<t t-name="web.SearchPanel.Small">
    <t t-if="state.showMobileSearch">
        <t t-portal="'body'">
            <div class="o_search_panel o_searchview o_mobile_search" t-ref="root">
                <div class="o_mobile_search_header">
                    <button type="button" class="o_mobile_search_button btn" t-on-click="() =&gt; state.showMobileSearch = false">
                        <i class="oi oi-arrow-left"/>
                        <strong class="ms-2">FILTER</strong>
                    </button>
                </div>
                <div class="o_mobile_search_content">
                    <t t-call="web.SearchPanelContent"/>
                </div>
                <button type="button" class="btn btn-primary o_mobile_search_footer" t-on-click.stop="() =&gt; state.showMobileSearch = false">
                    <t>SEE RESULT</t>
                </button>
            </div>
        </t>
    </t>

    <t t-else="">
        <button class="o_search_panel o_search_panel_summary btn w-100 overflow-visible" t-on-click="() =&gt; state.showMobileSearch = true" t-ref="root">
            <t t-set="categories" t-value="getCategorySelection()"/>
            <t t-set="filters" t-value="getFilterSelection()"/>
            <div class="d-flex align-items-center">
                <i class="fa fa-fw fa-filter"/>
                <div class="o_search_panel_current_selection text-truncate ms-2 me-auto">
                    <t t-if="!categories.length and !filters.length">All</t>
                    <t t-else="">
                        <t t-foreach="categories" t-as="category" t-key="category.id">
                            <span class="o_search_panel_category me-1">
                                <i t-if="category.icon" t-attf-class="o_search_panel_section_icon fa {{ category.icon }} me-1" t-att-style="category.color and ('color: ' + category.color)"/>
                                <t t-esc="category.values.join('/')"/>
                            </span>
                        </t>
                        <t t-foreach="filters" t-as="filter" t-key="filter.id">
                            <span class="o_search_panel_filter me-1">
                                <i t-if="filter.icon" t-attf-class="o_search_panel_section_icon fa {{ filter.icon }} me-1" t-att-style="filter.color and ('color: ' + filter.color)"/>
                                <t t-esc="filter.values.join(', ')"/>
                            </span>
                        </t>
                    </t>
                </div>
            </div>
        </button>
    </t>
</t>

<t t-name="web.SearchPanel.Category">
    <t t-foreach="values" t-as="valueId" t-key="valueId">
        <t t-set="value" t-value="section.values.get(valueId)"/>
        <li class="o_search_panel_category_value list-group-item py-1 cursor-pointer border-0 pe-0" t-att-class="isChildList ? 'o_treeEntry' : 'ps-0'">
            <header class="list-group-item list-group-item-action d-flex align-items-center px-0 py-lg-0 border-0" t-att-class="{'active text-900 fw-bold': state.active[section.id] === valueId}" t-on-click="() =&gt; this.toggleCategory(section, value)">
                <div class="o_search_panel_label d-flex align-items-center overflow-hidden w-100 cursor-pointer mb-0" t-att-class="{'o_with_counters': section.enableCounters }">
                    <button class="o_toggle_fold btn p-0 flex-shrink-0 text-center">
                        <i t-if="value.childrenIds.length" class="fa" t-att-class="{                                 'fa-caret-down' : state.expanded[section.id][valueId],                                 'fa-caret-right':  !state.expanded[section.id][valueId]                             }"/>
                    </button>
                    <span class="o_search_panel_label_title text-truncate" t-att-class="{'fw-bold' : value.bold}" t-esc="value.display_name" t-att-data-tooltip="value.display_name"/>
                </div>
                <small t-if="section.enableCounters and value.__count gt 0" class="o_search_panel_counter text-muted mx-2 fw-bold" t-esc="value.__count"/>
            </header>
            <ul t-if="value.childrenIds.length and state.expanded[section.id][valueId]" class="list-group d-block">
                <t t-call="{{ constructor.subTemplates.category }}">
                    <t t-set="values" t-value="value.childrenIds"/>
                    <t t-set="isChildList" t-value="true"/>
                </t>
            </ul>
        </li>
    </t>
</t>

<t t-name="web.SearchPanel.FiltersGroup">
    <li t-foreach="[...values.keys()]" t-as="valueId" t-key="valueId" class="o_search_panel_filter_value list-group-item p-0 mb-1 border-0 cursor-pointer" t-att-class="{ 'ps-2' : isChildList }">
        <t t-set="value" t-value="values.get(valueId)"/>
        <div class="form-check w-100">
            <input type="checkbox" t-attf-id="{{ section.id }}_input_{{ valueId }}" t-att-checked="state.active[section.id][valueId]" class="form-check-input" t-on-click="ev =&gt; this.toggleFilterValue(section.id, valueId, ev)"/>
            <label class="o_search_panel_label form-check-label d-flex align-items-center justify-content-between w-100 cursor-pointer" t-attf-for="{{ section.id }}_input_{{ valueId }}" t-att-title="(group and group.tooltip) or false">
                <span class="o_search_panel_label_title text-truncate" t-esc="value.display_name"/>
                <span t-if="section.enableCounters and value.__count gt 0" class="o_search_panel_counter text-muted mx-2 small" t-esc="value.__count"/>
            </label>
        </div>
    </li>
</t>

<t t-name="web.WithSearch">
    <t t-slot="default" context="searchModel.context" domain="searchModel.domain" groupBy="searchModel.groupBy" orderBy="searchModel.orderBy" comparison="searchModel.comparison" display="searchModel.display"/>
  </t>

<t t-name="web.ActionDialog.header">
        <t t-if="fullscreen">
            <button class="btn oi oi-arrow-left" data-bs-dismiss="modal" aria-label="Close" t-on-click="dismiss"/>
        </t>
      <DebugMenu t-if="env.debug"/>
        <h4 class="modal-title text-break" t-att-class="{ 'me-auto': fullscreen }">
            <t t-esc="props.title"/>
        </h4>
        <t t-if="!fullscreen">
            <button type="button" class="btn-close" aria-label="Close" tabindex="-1" t-on-click="dismiss"/>
        </t>
    </t>
<t t-name="web.ActionDialog">
        <div class="o_dialog" t-att-id="id" t-att-class="{ o_inactive_modal: !data.isActive }">
            <div role="dialog" class="modal d-block" tabindex="-1" t-att-class="{ o_technical_modal: props.technical, o_modal_full: isFullscreen, o_inactive_modal: !data.isActive }" t-ref="modalRef">
                <div class="modal-dialog modal-dialog-centered" t-attf-class="modal-{{props.size}}">
                    <div class="modal-content" t-att-class="props.contentClass" t-att-style="contentStyle">
                        <header t-if="props.header" class="modal-header">
                            <t t-call="web.ActionDialog.header">
        <t t-set="fullscreen" t-value="props.isFullscreen"/>
      </t>
    </header>

                        <footer t-if="props.footer" class="modal-footer justify-content-around justify-content-md-start flex-wrap gap-1 w-100" style="order:2">
                            <t t-slot="footer" close="() =&gt; this.data.close()">
                                <button class="btn btn-primary o-default-button" t-on-click="() =&gt; this.data.close()">
                                    <t>Ok</t>
                                </button>
                            </t>
                        </footer>
                        <main class="modal-body" t-attf-class="{{ props.bodyClass }} {{ !props.withBodyPadding ? 'p-0': '' }}" t-att-class="&#10;        {&quot;o_act_window&quot;: props.actionType === &quot;ir.actions.act_window&quot;}&#10;      ">
                            <t t-if="props.ActionComponent" t-component="props.ActionComponent" t-props="props.actionProps"/>
    </main>
                    </div>
                </div>
            </div>
        </div>
    </t>

    <t t-name="web.ReportAction">
        <div class="o_action">
            <Layout display="{ controlPanel: { 'top-right' : false, 'bottom-right': false } }">
                <t t-set-slot="control-panel-create-button">
                    <button t-on-click="print" type="button" class="btn btn-primary" title="Print">Print</button>
                </t>
                <iframe t-ref="iframe" t-on-load="onIframeLoaded" class="h-100 w-100 d-block" t-att-src="reportUrl"/>
            </Layout>
        </div>
    </t>

<t t-name="point_of_sale.ErrorBarcodePopup">
        <div class="popup popup-barcode">
            <header class="title drag-handle modal-header">
                <h5 class="modal-title">Unknown Barcode: <span class="fst-italic" t-esc="props.code"/>
                </h5>
            </header>
            <main class="modal-body">
                <t t-esc="translatedMessage"/>
            </main>
            <footer class="footer modal-footer">
                <button type="button" class="btn btn-primary" t-on-click="confirm">Ok</button>
            </footer>
        </div>
    </t>

<t t-name="point_of_sale.CustomerFacingDisplayHead">
        <div class="resources">
            <base t-att-href="origin"/>
            <meta http-equiv="cache-control" content="no-cache"/>
            <meta http-equiv="pragma" content="no-cache"/>
            <link rel="stylesheet" type="text/css" t-att-href="origin + '/web/static/src/libs/fontawesome/css/font-awesome.css'"/>
            <link rel="stylesheet" type="text/css" t-att-href="origin + '/point_of_sale/static/src/css/customer_facing_display.css'"/>

            <script type="text/javascript" id="old_browser_fix_auto_scroll">
                function isCentered(el) {
                    const rect = el.getBoundingClientRect();
                    const elemHeight = (rect.top + rect.bottom) / 2;
                    const windowMiddleHeight = window.innerHeight / 2;
                    return (windowMiddleHeight * 0.9 &lt;= elemHeight) &amp;&amp; (elemHeight &lt;= windowMiddleHeight * 1.1);
                }

                function fixScrollingIfNecessary() {
                    const selectedOrderlineShouldBeScrolledTo = document.querySelector(".pos-customer_facing_display .pos_orderlines_list.backend_product_screen .selected_orderline");
                    if (selectedOrderlineShouldBeScrolledTo &amp;&amp; !isCentered(selectedOrderlineShouldBeScrolledTo)) {
                        selectedOrderlineShouldBeScrolledTo.scrollIntoView({ behavior: "instant", block: "center" });
                    }
                }
            </script>
            <link rel="stylesheet" type="text/css" href="/pos_online_payment/static/src/css/customer_facing_display.css"/>
        </div>
    </t>

    <t t-name="point_of_sale.CustomerFacingDisplayNoOrder">
        <t t-set="backgroundImageURL" t-value="pos.config.iface_customer_facing_display_background_image_1920 ? 'url(/web/image/pos.config/' + pos.config.id + '/iface_customer_facing_display_background_image_1920)' : 'none'"/>
        <t t-call="point_of_sale.CustomerFacingDisplayHead"/>

        <div class="pos-customer_facing_display pos-no-order pos-palette_01" t-attf-style="background-image: #{backgroundImageURL};">


            <div class="pos-no-order" t-attf-style="background-image: #{backgroundImageURL};">
                <div class="pos-company_logo" t-attf-style="background-image:url(/logo?company=#{pos.company.id})"/>
            </div>
        </div>
    </t>

    <t t-name="point_of_sale.CustomerFacingDisplayOrder">
        <t t-set="backgroundImageURL" t-value="pos.config.iface_customer_facing_display_background_image_1920 ? 'url(/web/image/pos.config/' + pos.config.id + '/iface_customer_facing_display_background_image_1920)' : 'none'"/>

        <t t-call="point_of_sale.CustomerFacingDisplayHead"/>

        <div class="pos-customer_facing_display pos-palette_01">

            <div class="pos-portrait-top">
                <div class="pos-header" t-attf-style="background-image: {{backgroundImageURL}};">
                    <div class="pos-company_logo" t-attf-style="background-image:url(/logo?company=#{pos.company.id})"/>
                </div>
            </div>


            <div class="pos-customer_products" name="Products list">
                <t t-call="point_of_sale.CustomerFacingDisplayMainContainer"/>
            </div>

            <div class="pos-payment_info" t-attf-style="background-image: {{backgroundImageURL}};">

                <div class="pos-company_logo" t-attf-style="background-image:url(/logo?company=#{pos.company.id})"/>

                <div class="pos-payment_info_details">

                    <div class="pos-total">
                        <div class="pos-amount-container pos-spaced-line-container">
                            <span class="name">Total:</span>
                            <div class="spacer"/>
                            <div class="pos-spaced-line-container">
                                <div class="spacer"/>
                                <span class="pos-total_amount amount" t-esc="pos.env.utils.formatCurrency(order and order.get_total_with_tax() || 0)"/>
                            </div>
                        </div>
                    </div>


                    <t t-call="point_of_sale.CustomerFacingDisplayPaymentLines"/>
                </div>


                <div class="pos-odoo_logo_container">
                    <span>Powered by </span>
                    <div class="logo"/>
                </div>
            </div>
        </div>
    </t>

    <t t-name="point_of_sale.CustomerFacingDisplayMainContainer">
        <div class="pos_orderlines">
            <t t-if="order">
                <t t-if="order.get_current_screen_data().name != 'ReceiptScreen'">
                    <t t-if="order.get_current_screen_data().name === 'PaymentScreen' and order.uiState.PaymentScreen?.onlinePaymentData">
                <div class="online-payment">
                    <div class="instructions">
                        <p>Please scan the QR code to open the payment page</p>
                        <div class="spacer"/>
                        <div class="qr-code" alt="QR Code to pay" t-attf-style="background-image: url('{{order.uiState.PaymentScreen.onlinePaymentData.qrCode}}');"/>
                        <div class="spacer"/>
                    </div>
                    <div class="info">
                        <div>
                            <span>Amount: </span>
                            <span class="amount" t-esc="pos.env.utils.formatCurrency(order.uiState.PaymentScreen.onlinePaymentData.amount)"/>
                        </div>
                        <div>
                            <span>Order reference: </span>
                            <span t-esc="order.name"/>
                        </div>
                        <div>
                            <span>Order id: </span>
                            <span t-esc="order.server_id"/>
                        </div>
                    </div>
                </div>
            </t>
            <t t-else="">
                <t t-call="point_of_sale.CustomerFacingDisplayOrderLines"/>
            </t>
        </t>
                <t t-else="">
                    <div class="pos-thank-you-message">
                        <span>Thank you for your purchase!</span>
                    </div>
                </t>
            </t>
        </div>
    </t>

    <t t-name="point_of_sale.CustomerFacingDisplayOrderLines">
        <t t-if="order.get_orderlines().length &gt; 0">
            <div class="pos-order_top_bar">
                <span>Your Order</span>
            </div>
            <div class="pos_orderlines_list" t-att-class="{ 'backend_product_screen': order.get_current_screen_data().name === 'ProductScreen' }">
                <table>
                    <thead>
                        <tr>
                            <th colspan="2" class="pos-product-th">
                                <span>Product</span>
                            </th>
                            <th>Quantity</th>
                            <th>Price</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr t-foreach="order.get_orderlines()" t-key="orderline.id" t-as="orderline" class="pos_orderlines_item" t-att-class="{ 'selected_orderline': orderline.id === order.get_selected_orderline().id }">
                            <td class="product_img">
                                <img t-attf-src="#{productImages[orderline.product.id]}"/>
                            </td>
                            <td class="product_text_info">
                                <ul>
                                    <li t-esc="orderline.get_full_product_name()"/>
                                    <t t-if="orderline.get_discount_str() !== '0'">
                                        <li class="product_details">
                                            <i class="fa fa-tag" role="img" aria-label="Discount" title="Discount"/>
                                        <t t-esc="orderline.get_discount_str()"/>% <span class="gray">discount</span>
                                        </li>
                                    </t>
                                    <t t-if="orderline.get_customer_note()">
                                        <li class="product_details">
                                            <i class="fa fa-sticky-note" role="img" aria-label="Customer Note" title="Customer Note"/>
                                            <span class="gray" t-esc="orderline.get_customer_note()"/>
                                        </li>
                                    </t>
                                </ul>
                            </td>
                            <td class="product_quantity gray">
                                <span t-esc="orderline.get_quantity_str()"/>
                                <span t-esc="orderline.get_unit().name"/>
                            </td>
                            <td>
                                <div t-esc="pos.env.utils.formatCurrency(orderline.get_display_price())"/>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <script type="text/javascript">
                document.addEventListener("DOMContentLoaded", function() {
                fixScrollingIfNecessary();
                });
            </script>
        </t>
        <t t-else="">
            <div class="order-empty">
                <i class="fa fa-shopping-cart" role="img" aria-label="Shopping cart" title="Shopping cart"/>
                <h1>This order is empty</h1>
            </div>
        </t>
    </t>

    <t t-name="point_of_sale.CustomerFacingDisplayPaymentLines">
        <div class="pos-paymentlines">
            <t t-if="order">
                <t t-foreach="order.get_paymentlines()" t-as="paymentline" t-key="paymentline_index">
                    <div class="pos-amount-container pos-spaced-line-container">
                        <span class="name"><t t-esc="paymentline.name"/>:</span>
                        <div class="spacer"/>
                        <div class="pos-spaced-line-container">
                            <div class="spacer"/>
                            <span class="amount" t-esc="pos.env.utils.formatCurrency(paymentline.get_amount())"/>
                        </div>
                    </div>
                </t>
            </t>

            <div class="pos-amount-container pos-spaced-line-container">
                <span class="name">Change:</span>
                <div class="spacer"/>
                <div class="pos-spaced-line-container">
                    <div class="spacer"/>
                    <span class="amount" t-esc="pos.env.utils.formatCurrency(order and order.get_change() || 0)"/>
                </div>
            </div>
        </div>
    </t>

<t t-name="point_of_sale.DebugWidget">
        <Transition visible="props.state.showWidget" name="'o-fade'" leaveDuration="200" t-slot-scope="transition">
            <div class="debug-widget bg-100 p-2 shadow-lg" t-att-class="transition.className" t-ref="root" t-att-style="style">
                <header class="drag-handle">
                    <h2>Debug Window</h2>
                </header>
                <div class="toggle position-absolute top-0 end-0 p-2" t-on-click="() =&gt; debug.toggleWidget()" title="Dismiss" role="img" aria-label="Dismiss"><i class="fa fa-fw fa-times"/></div>
                <div class="content overflow-hidden">

                    <div class="debug-electronic-scale">
                        <h5 class="category">Electronic Scale</h5>
                        <input t-model="state.weightInput" type="text" class="weight form-control"/>
                        <ul class="d-flex flex-column align-items-start mb-3">
                            <li class="set_weight btn btn-link" t-on-click="setWeight">Set Weight</li>
                            <li class="reset_weight btn btn-link" t-on-click="resetWeight">Reset</li>
                        </ul>
                    </div>

                    <div class="debug-barcode-scanner">
                        <h5 class="category">Barcode Scanner</h5>
                        <ul class="d-flex flex-column align-items-start mb-3">
                            <li>
                                <input t-model="state.barcodeInput" type="text" class="ean form-control" t-att-disabled="!barcodeReader" t-attf-placeholder="{{ !barcodeReader ? 'No nomenclature' : '' }}"/>
                            </li>
                            <li class="button btn btn-link barcode" t-on-click="barcodeScan">Scan</li>
                            <li class="button btn btn-link custom_ean" t-on-click="barcodeScanEAN">Scan EAN-13</li>
                        </ul>
                    </div>

                    <div class="debug-orders">
                        <h5 class="category">Orders</h5>
                        <ul class="mb-3">
                            <li class="button btn btn-link" t-on-click="deleteOrders">
                                Delete Paid Orders
                            </li>
                            <li class="button btn btn-link" t-on-click="deleteUnpaidOrders">
                                Delete Unpaid Orders
                            </li>
                            <li t-if="!state.isPaidOrdersReady" class="button btn btn-link" t-on-click="preparePaidOrders">
                                Export Paid Orders
                            </li>
                            <a t-else="" t-att-download="paidOrdersFilename" t-att-href="paidOrdersURL" t-on-click="() =&gt; { state.isPaidOrdersReady = !state.isPaidOrdersReady }">
                                <li class="button btn btn-link">
                                    Download Paid Orders
                                </li>
                            </a>
                            <li t-if="!state.isUnpaidOrdersReady" class="button btn btn-link" t-on-click="prepareUnpaidOrders">
                                Export Unpaid Orders
                            </li>
                            <a t-else="" t-att-download="unpaidOrdersFilename" t-att-href="unpaidOrdersURL" t-on-click="() =&gt; { state.isUnpaidOrdersReady = !state.isUnpaidOrdersReady }">
                                <li class="button btn btn-link">
                                    Download Unpaid Orders
                                </li>
                            </a>
                            <li class="button btn btn-link import_orders" style="position:relative">
                                Import Orders
                                <input t-on-change="importOrders" type="file" style="opacity:0;position:absolute;top:0;left:0;right:0;bottom:0;margin:0;cursor:pointer"/>
                            </li>
                        </ul>
                    </div>

                    <div class="debug-hardware-status d-flex flex-column">
                        <h5 class="category">Hardware Status</h5>
                        <ul class="mb-3">
                            <li class="status weighing">Weighing</li>
                            <li class="button btn btn-link display_refresh" t-on-click="refreshDisplay">
                                Refresh Display
                            </li>
                        </ul>
                    </div>

                    <div class="debug-hardware-events">
                        <h5 class="category">Hardware Events</h5>
                        <ul class="mb-3">
                            <li class="event" t-ref="open_cashbox">Open Cashbox</li>
                            <li class="event" t-ref="print_receipt">Print Receipt</li>
                            <li class="event" t-ref="scale_read">Read Weighing Scale</li>
                        </ul>
                    </div>

                    <div class="debug-others">
                        <h5 class="category">Others</h5>
                        <ul class="mb-3">
                            <li class="event">
                                <span>Buffer: </span>
                                <t t-esc="bufferRepr"/>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </Transition>
    </t>

<t t-name="point_of_sale.OrderImportPopup">
        <div class="popup popup-import">
            <div class="modal-header">
                <h4 class="modal-title title drag-handle">
                    Finished Importing Orders
                </h4>
            </div>
            <main class="body modal-body">
                <li>Successfully imported <b><t t-esc="props.report.paid or 0"/></b> paid orders</li>
                <li>Successfully imported <b><t t-esc="props.report.unpaid or 0"/></b> unpaid orders</li>
                <t t-if="unpaidSkipped">
                    <li><b><t t-esc="unpaidSkipped"/></b> unpaid orders could not be imported
                        <ul>
                            <li><b><t t-esc="props.report.unpaid_skipped_existing or 0"/></b> were duplicates of existing orders</li>
                            <li><b><t t-esc="props.report.unpaid_skipped_session or 0"/></b> belong to another session:
                                <t t-if="props.report.unpaid_skipped_sessions">
                                    <ul>
                                        <li>Session ids: <b><t t-esc="props.report.unpaid_skipped_sessions"/></b></li>
                                    </ul>
                                </t>
                            </li>
                        </ul>
                    </li>
                </t>
            </main>
            <footer class="footer modal-footer">
                <div class="button cancel btn btn-lg btn-primary" t-on-click="confirm">
                    <t t-esc="props.confirmText"/>
                </div>
            </footer>
        </div>
    </t>

<t t-name="point_of_sale.ErrorPopup">
            <div class="popup popup-error">
                <div class="modal-header">
                    <h4 class="modal-title title">
                        <t t-esc="props.title"/>
                    </h4>
                </div>
                <main class="modal-body">
                    <t t-esc="props.body"/>
                </main>
                <div class="footer modal-footer">
                    <div class="button cancel btn btn-lg btn-primary " t-on-click="confirm">
                        <t t-esc="props.confirmText"/>
                    </div>
                </div>
            </div>
    </t>

<t t-name="point_of_sale.ErrorTracebackPopup">
            <div class="popup popup-error">
                <div class="modal-header">
                    <h4 class="modal-title title">
                        <t t-esc="props.title"/>
                    </h4>
                </div>
                <main class="modal-body body traceback">
                    <t t-esc="props.body"/>
                </main>
                <footer class="footer modal-footer justify-content-between">
                    <div class="d-flex gap-1">
                        <a t-att-download="tracebackFilename" t-att-href="tracebackUrl">
                            <div class="button icon download btn btn-lg btn-secondary">
                                <i class="fa fa-download" role="img" aria-label="Download error traceback" title="Download error traceback"/>
                            </div>
                        </a>
                        <div class="button icon email btn btn-lg btn-secondary" t-on-click="emailTraceback">
                            <i class="fa fa-paper-plane" role="img" aria-label="Send by email" title="Send by email"/>
                        </div>
                    </div>
                    <div class="d-flex gap-1">
                        <div t-if="!props.exitButtonIsShown" class="button cancel btn btn-lg btn-primary" t-on-click="confirm">
                            <t t-esc="props.confirmText"/>
                        </div>
                        <div t-if="props.exitButtonIsShown" class="button cancel btn btn-lg btn-secondary" t-on-click="() =&gt; this.pos.closePos()">
                            <t t-esc="props.exitButtonText"/>
                        </div>
                    </div>
                </footer>
            </div>
    </t>

<t t-name="point_of_sale.OfflineErrorPopup">
        <div class="popup offline">
            <div class="modal-header">
                <h4 class="modal-title title">
                    <t t-esc="props.title"/>
                </h4>
            </div>
            <main class="modal-body">
                <t t-esc=" props.body"/>
            </main>
            <footer class="footer footer-flex modal-footer">
                <div class="button dont-show-again highlight btn btn-lg btn-primary w-auto" t-on-click="confirm">
                    <t t-esc="props.confirmText"/>
                </div>
            </footer>
        </div>
    </t>

<t t-name="point_of_sale.CategorySelector">
        <div t-attf-class="{{props.class}} d-flex overflow-auto w-100 flex-grow-1">
            <div class="d-flex p-1 bg-view">
                <div t-foreach="props.categories" t-as="category" t-key="category.id" class="d-flex align-items-center">
                    <i t-if="category_index != 0" t-attf-class="px-2 fa {{category.separator}}" t-att-style="\`opacity: \${category.showSeparator ? 1 : 0};\`" aria-hidden="true"/>
                    <button class="category-button btn btn-light d-flex flex-column align-items-center justify-content-center category-item p-1 h-100" style="max-width: 100px;" t-on-click="() =&gt; props.onClick(category.id)">
                        <t t-if="props.showImage">
                            <img t-if="category.imageUrl" class="rounded h-75" t-att-src="category.imageUrl" alt="Category"/>
                        </t>
                        <i t-if="category.icon" t-attf-class="fa {{category.icon}}" aria-hidden="true"/>
                        <span t-if="category.name" class="w-100 text-center fs-5 inline-block text-truncate" t-esc="category.name" style="min-height: 1.2rem"/>
                    </button>
                </div>
            </div>
        </div>
    </t>
<t t-name="point_of_sale.input">
        <div t-attf-class="{{props.class}} d-flex align-items-center gap-1">
            <button t-if="props.isSmall" class="p-2 rounded btn btn-secondary" t-on-click="() =&gt; state.isOpen = !state.isOpen">
                <i t-if="state.isOpen" class="fa fa-arrow-right"/>
                <t t-else="props.iconOnLeftSide" t-call="point_of_sale.inputIcon"/>
            </button>
            <div t-if="!props.isSmall || state.isOpen" class="input-group h-100">
                <div class="form-control input-container d-flex align-items-center py-1 bg-view" t-att-class="{'is-invalid': !props.isValid(getValue())}">
                    <t t-if="props.iconOnLeftSide" t-call="point_of_sale.inputIcon"/>
                    <input class="border-0 mx-2" type="text" style="min-width: 60px;" t-on-focus="ev=&gt;ev.target.select()" t-att-placeholder="props.placeholder" t-ref="input" t-att-value="getValue()" t-on-input="(event) =&gt; this.setValue(event.target.value)"/>
                    <t t-if="!props.iconOnLeftSide" t-call="point_of_sale.inputIcon"/>
                    <i t-if="getValue()" class="fa fa-times mx-2" t-on-click="() =&gt; this.setValue('')"/>
                </div>
            </div>
        </div>
    </t>
    <t t-name="point_of_sale.inputIcon">
        <i t-if="props.icon.type === 'fa'" t-attf-class="fa {{props.icon.value}} {{margin}}"/>
        <span t-if="props.icon.type === 'string'" t-attf-class="{{margin}}" t-esc="props.icon.value"/>
    </t>

<t t-name="point_of_sale.NumericInput">
        <div t-attf-class="{{props.class}} d-flex align-items-center input-group">
            <button class="btn btn-secondary border" t-on-click="() =&gt; this.setValue(this.getValue() - 1)" t-att-disabled="getValue() lte props.min">
                <i class="fa fa-minus center"/>
            </button>
            <input class="o_input form-control border text-center text-bg-light" type="number" t-on-focus="ev=&gt;ev.target.select()" t-att-value="getValue()" t-att-min="props.min" t-on-input="(event) =&gt; this.setValue(parseInt(event.target.value))"/>
            <button class="btn btn-secondary border" t-on-click="() =&gt; this.setValue(this.getValue() + 1)">
                <i class="fa fa-plus"/>
            </button>
        </div>
    </t>
<t t-name="point_of_sale.Numpad">
    <div t-attf-class="{{props.class}} numpad row row-cols-{{props.buttons.length / 4}} gx-0">
      <button t-foreach="props.buttons" t-as="button" t-key="button.value" t-attf-class="col btn btn-light py-3 border fw-bolder rounded-0 {{ button.class  or '' }}" t-on-click="() =&gt; this.onClick(button.value)" t-att-disabled="button.disabled" t-esc="button.text or button.value"/>
    </div>
  </t>
<t t-name="point_of_sale.OdooLogo">
        <div t-attf-class="{{ props.class }}" t-attf-style="{{ props.style }}">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 919 495">
                <path d="M695,346a75,75,0,1,1,75-75A75,75,0,0,1,695,346Zm0-31a44,44,0,1,0-44-44A44,44,0,0,0,695,315ZM538,346a75,75,0,1,1,75-75A75,75,0,0,1,538,346Zm0-31a44,44,0,1,0-44-44A44,44,0,0,0,538,315Zm-82-45c0,41.9-33.6,76-75,76s-75-34-75-75.9S336.5,196,381,196c16.4,0,31.6,3.5,44,12.6V165.1c0-8.3,7.3-15.1,15.5-15.1s15.5,6.8,15.5,15.1Zm-75,45a44,44,0,1,0-44-44A44,44,0,0,0,381,315Z" t-attf-style="fill:{{ props.monochrome ? '#FFF' : '#8f8f8f' }}"/>
                <path d="M224,346a75,75,0,1,1,75-75A75,75,0,0,1,224,346Zm0-31a44,44,0,1,0-44-44A44,44,0,0,0,224,315Z" t-attf-style="fill:{{ props.monochrome ? '#FFF' : '#714b67' }}"/>
            </svg>
        </div>
    </t>
<t t-name="point_of_sale.OrderWidget">
        <t t-if="props.lines?.length">
            <div t-ref="scrollable" class="order-container bg-view overflow-y-auto flex-grow-1 d-flex flex-column text-start">
                <t t-foreach="props.lines" t-as="line" t-key="line_index">
                    <t t-slot="default" line="line"/>
                </t>
            </div>
            <div t-if="props.total or props.tax" class="order-summary w-100 py-2 px-3 bg-100 text-end fw-bolder fs-2 lh-sm">
                Total:
                <span t-esc="props.total" class="total"/>
                <div t-if="props.tax" class="fs-6 text-muted subentry">
                    Taxes: <span t-esc="props.tax" class="tax"/>
                </div>
            </div>
            <t t-slot="details"/>
        </t>
        <t t-else="">
            <CenteredIcon icon="'fa-shopping-cart fa-4x'" text="emptyCartText()"/>
            <t t-slot="details"/>
        </t>
    </t>
<t t-name="point_of_sale.Orderline">
        <t t-set="line" t-value="props.line"/>
        <li class="orderline p-2 lh-sm cursor-pointer" t-attf-class="{{ line.comboParent ? 'border-start border-3 ms-4' : '' }}" t-att-class="props.class">
            <div class="d-flex justify-content-between">
                <div class="product-name d-inline-block flex-grow-1 fw-bolder pe-1 text-truncate">
                    <span class="text-wrap" t-esc="line.productName"/>
                    <t t-slot="product-name"/>
                </div>
                <div class="product-price d-inline-block text-end price fw-bolder">
                    <t t-esc="line.price"/>
                </div>
            </div>
            <ul class="info-list ms-2">
                <li class="price-per-unit">
                    <em t-esc="line.qty" class="qty fst-normal fw-bolder me-1"/> <t t-if="line.unit" t-esc="line.unit"/> 
                    <t t-if="line.price !== 0">
                        x <s t-esc="line.oldUnitPrice" t-if="line.oldUnitPrice"/> 
                        <t t-esc="line.unitPrice"/> <span t-if="line.unit"> / <t t-esc="line.unit"/></span>
                    </t>
                </li>
                <li t-if="line.price !== 0 and line.discount and line.discount !== '0'">
                    With a <em><t t-esc="line.discount"/>% </em> discount
                </li>
                <t t-slot="default"/>
                <li t-if="line.customerNote" class="customer-note w-100 p-2 my-1 rounded text-break text-bg-warning text-warning bg-opacity-25">
                    <i class="fa fa-sticky-note me-1" role="img" aria-label="Customer Note" title="Customer Note"/>
                    <t t-esc="line.customerNote"/>
                </li>
                <li t-if="line.internalNote" class="internal-note w-100 p-2 my-1 rounded text-bg-info text-info bg-opacity-25 text-break">
                    <i class="fa fa-tag me-1" role="img" aria-label="Note" title="Note"/>
                    <t t-esc="line.internalNote"/>
                </li>
                <li t-if="line.attributes">
                    <div t-foreach="line.attributes" t-as="attribute" t-key="attribute.id">
                        <t t-esc="attribute.name"/>:
                        <t t-foreach="attribute.valuesForOrderLine" t-as="value" t-key="value.id">
                            <t t-if="value_index !== 0" t-esc="' | '"/>
                            <t t-esc="value.name"/>
                            <t t-if="value.price_extra">
                                (<t t-esc="env.utils.formatCurrency(value.price_extra)"/>)
                            </t>

                        </t><br/>
                    </div>
                </li>
            </ul>
        </li>
    </t>
<t t-name="point_of_sale.ProductCard">
        <article tabindex="0" t-attf-class="{{props.class}} product position-relative btn btn-light d-flex align-items-stretch p-0 m-0 text-start cursor-pointer overflow-hidden transition-base" t-on-keypress="(event) =&gt; event.code === 'Space' ? props.onClick(event) : ()=&gt;{}" t-on-click="props.onClick" t-att-data-product-id="props.productId" t-attf-aria-labelledby="article_product_{{props.productId}}">
            <div t-if="props.productInfo" class="product-information-tag" t-on-click.stop="props.onProductInfoClick" t-att-class="{'red-tag' : !isSelfOrderAvailable(props.productId)}">
                <i class="product-information-tag-logo fa fa-info" role="img" aria-label="Product Information" title="Product Information"/>
            </div>
            <div t-if="props.imageUrl" class="product-img">
                <img class="w-100" t-att-src="props.imageUrl" t-att-alt="props.name"/>
            </div>
            <div class="product-content d-flex flex-column justify-content-between h-100 mx-2 py-1">
                <div class="overflow-hidden lh-sm fw-bolder product-name" t-att-class="{'no-image': !props.imageUrl}" t-attf-id="article_product_{{props.productId}}" t-esc="props.name"/>
                <span t-if="props.price" class="price-tag text-primary py-1 fw-bolder" t-esc="props.price"/>
            </div>
        </article>
    </t>
<t t-name="point_of_sale.Loader">
        <div class="pos-loader" t-att-style="props.loader.isShown ? '' : 'opacity: 0'">
            <div class="loader-feedback">

                <div class="lds-ellipsis"><div/><div/><div/><div/></div>


            </div>
        </div>
    </t>
<t t-name="point_of_sale.BackButton">
        <span class="order-button floor-button d-flex align-items-center gap-2 px-4 fw-bolder cursor-pointer" t-on-click="onClick">
            <i class="fa fa-2x fa-angle-left pb-1" role="img" aria-label="Go Back" title="Go Back"/>
            <t t-if="!ui.isSmall and pos.config.module_pos_restaurant">
                 <span>Change table</span>
             </t>
             <t t-else="">
                 <span t-if="!ui.isSmall">BACK</span>
             </t>
         </span>
    </t>

<t t-name="point_of_sale.CashMovePopup">
        <div class="popup cash-move-popup">
            <main class="modal-body">
                <div class="cash-move d-flex flex-column">
                    <div class="input-amount d-flex mb-2 gap-2">
                        <div class="input-group">
                            <button t-on-click="() =&gt; this.onClickButton('in')" class="input-type btn btn-secondary flex-fill py-2 fw-bolder" t-att-class="{ 'highlight btn-success': state.type === 'in' }">
                                Cash In
                            </button>
                            <button t-on-click="() =&gt; this.onClickButton('out')" class="input-type btn btn-secondary flex-fill py-2 fw-bolder" t-att-class="{ 'red-highlight btn-danger': state.type === 'out' }">
                                Cash Out
                            </button>
                        </div>
                        <Input tModel="[state, 'amount']" icon="{type: 'string', value: pos.currency.symbol}" iconOnLeftSide="pos.currency.position === 'before'" isValid.bind="env.utils.isValidFloat" autofocus="true" getRef="(ref) =&gt; this.inputRef = ref"/>
                    </div>
                    <div class="form-floating">
                        <textarea class="form-control" placeholder="Leave a reason here" name="reason" id="reason" t-model="state.reason" style="height:100px;"/>
                        <label for="reason">Reason</label>
                    </div>
                </div>
            </main>
            <footer class="footer cash-move modal-footer">
                <button class="button confirm btn btn-lg btn-primary" t-on-click="confirm" t-att-disabled="!env.utils.isValidFloat(state.amount)">
                    Confirm <span t-esc="format(state.amount)"/>
                </button>
                <button class="button cancel btn btn-lg btn-secondary" t-on-click="cancel">
                    Discard
                </button>
            </footer>
        </div>
    </t>

<t t-name="point_of_sale.CashMoveReceipt">
        <div class="pos-receipt">
            <ReceiptHeader data="props.headerData"/>
            <div class="pos-receipt-center-align">
                CASH
                <t t-esc="props.translatedType.toUpperCase()"/>
            </div>
            <br/>
            <div>
                AMOUNT
                <span t-esc="props.formattedAmount" class="pos-receipt-right-align"/>
            </div>
            <div>
                REASON
                <span t-esc="props.reason" class="pos-receipt-right-align"/>
            </div>
            <br/>
            <div class="pos-receipt-order-data">
                <div><t t-esc="props.date"/></div>
            </div>
        </div>
    </t>

<t t-name="point_of_sale.CashierName">
        <div t-att-class="cssClass" class="btn btn-light border-0 rounded-0">
            <span class="cashier-name d-flex align-items-center gap-1"><img t-att-src="avatar" t-att-alt="username" class="avatar rounded-3"/> <span t-if="!ui.isSmall" t-esc="username" class="username"/></span>
        </div>
    </t>

<t t-name="point_of_sale.ClosePosPopup">
        <div class="popup close-pos-popup">
            <div class="modal-header">
                <h4 class="modal-title">Closing Session</h4>
                <div class="total-orders fw-bolder">
                    Total <t t-esc="props.orders_details.quantity"/> orders:
                    <span class="amount" t-esc="env.utils.formatCurrency(props.orders_details.amount)"/>
                </div>
            </div>
            <main class="modal-body">
                <div class="payment-methods-overview overflow-auto">
                    <table class="text-start">
                        <thead>
                            <tr class="text-dark">
                                <th>Payment Method</th>
                                <th>Expected</th>
                                <th style="width:20%">Counted</th>
                                <th>Difference</th>
                            </tr>
                        </thead>
                        <t t-if="pos.config.cash_control">
                            <tbody>
                                <tr>
                                    <td t-esc="props.default_cash_details.name"/>
                                    <td t-esc="env.utils.formatCurrency(props.default_cash_details.amount)"/>
                                    <td class="d-flex">
                                        <Input tModel="[state.payments[props.default_cash_details.id], 'counted']" callback.bind="(value) =&gt;  this.setManualCashInput(value)" isValid.bind="env.utils.isValidFloat"/>
                                        <div class="button icon ClosePosPopup btn btn-secondary" t-on-click="openDetailsPopup">
                                            <i class="fa fa-money fa-2x" role="img" title="Open the money details popup"/>
                                        </div>
                                    </td>
                                    <td t-esc="env.utils.formatCurrency(getDifference(props.default_cash_details.id))" t-att-class="{'warning text-danger fw-bolder': !env.utils.floatIsZero(getDifference(props.default_cash_details.id))}"/>
                                </tr>
                            </tbody>
                            <tbody class="cash-overview border-start small text-muted">
                                <tr>
                                    <td>Opening</td>
                                    <td class="align-top" t-esc="env.utils.formatCurrency(props.default_cash_details.opening)"/>
                                </tr>
                                <tr t-foreach="props.default_cash_details.moves" t-as="move" t-key="move_index">
                                    <td>
                                        <div class="flex d-flex flex-row">
                                            <div class="cash-sign me-1" t-esc="move.amount &lt; 0 ? '-' : '+'"/>
                                            <t t-esc="move.name"/>
                                        </div>
                                    </td>
                                    <td class="align-top" t-esc="env.utils.formatCurrency(Math.abs(move.amount))"/>
                                </tr>
                                <tr t-if="props.default_cash_details.payment_amount">
                                    <td>
                                        <div class="flex d-flex flex-row">
                                            <div class="cash-sign me-1" t-esc="props.default_cash_details.payment_amount &lt; 0 ? '-' : '+'"/>
                                            Payments in <t t-esc="props.default_cash_details.name"/>
                                        </div>
                                    </td>
                                    <td class="align-top" t-esc="env.utils.formatCurrency(Math.abs(props.default_cash_details.payment_amount))"/>
                                </tr>
                            </tbody>
                        </t>
                        <tbody t-if="props.other_payment_methods.length &gt; 0">
                            <tr t-foreach="props.other_payment_methods" t-as="pm" t-key="pm.id">
                                <td t-esc="pm.name"/>
                                <td t-esc="env.utils.formatCurrency(pm.amount)"/>
                                <t t-set="_showDiff" t-value="pm.type === 'bank' and pm.number !== 0"/>
                                <td t-if="_showDiff">
                                    <Input tModel="[state.payments[pm.id], 'counted']" isValid.bind="env.utils.isValidFloat"/>
                                </td>
                                <td t-if="_showDiff" t-esc="env.utils.formatCurrency(getDifference(pm.id))" t-att-class="{'warning text-danger fw-bolder': getDifference(pm.id)}"/>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="notes-container d-flex flex-column flex-sm-row gap-3 border-top mt-3 pt-3">
                    <div class="opening-notes-container d-flex flex-column flex-grow-1 align-items-start" t-if="props.opening_notes">
                        <label class="form-label" for="props.opening_notes">Opening note</label>
                        <textarea class="opening-notes form-control" id="props.opening_notes">
                            <t t-esc="props.opening_notes"/>
                        </textarea>
                    </div>
                    <div class="closing-notes-container d-flex flex-column flex-grow-1 align-items-start">
                        <label class="form-label" for="closingNotes">Closing note</label>
                        <textarea class="closing-notes form-control" id="closingNotes" placeholder="Add a closing note..." t-model="state.notes"/>
                    </div>
                </div>
            </main>
            <footer class="footer modal-footer justify-content-between">
                <div class="modal-footer-left d-flex gap-2">
                    <button class="button highlight btn btn-lg btn-primary" t-att-disabled="!canConfirm()" t-on-click="confirm">Close Session</button>
                    <button class="button btn btn-lg btn-secondary" t-att-disabled="!canCancel()" t-on-click="cancel">Discard</button>
                </div>

                <div class="modal-footer-right d-flex gap-2">
                    <button class="button icon btn btn-lg btn-secondary" t-on-click="downloadSalesReport" title="Download a report with all the sales of the current PoS Session">
                            Daily Sale
                            <i class="fa fa-download" role="img"/>
                    </button>

                    <button t-if="hardwareProxy.printer" class="button icon btn btn-lg btn-secondary">
                        <SaleDetailsButton/>
                    </button>
                </div>
            </footer>
        </div>
    </t>

<t t-name="point_of_sale.CustomerFacingDisplayButton">
        <button class="menu-item navbar-button btn btn-light rounded-0 d-flex align-items-center px-3 cursor-pointer" t-on-click="() =&gt; {customerDisplay.connect(); this.displayMessage(message);}">
            <div t-if="customerDisplay.status === 'warning'" class="js_warning oe_icon oe_orange text-warning">
                <i class="fa fa-fw fa-desktop" role="img" t-attf-aria-label="Customer Screen Warning : {{message}}" t-attf-title="Customer Screen Warning : {{message}}"/>
            </div>
            <div t-if="customerDisplay.status === 'failure'" class="js_disconnected oe_icon oe_red text-danger">
                <i class="fa fa-fw fa-desktop" role="img" t-attf-aria-label="Customer Screen : {{message}}" t-attf-title="Customer Screen : {{message}}"/>
            </div>
            <div t-if="customerDisplay.status === 'not_found'" class="js_disconnected oe_icon oe_red text-danger">
                <i class="fa fa-fw fa-desktop" role="img" t-attf-aria-label="Customer Screen Not Found : {{message}}" t-attf-title="Customer Screen Not Found : {{message}}"/>
            </div>
            <div t-if="customerDisplay.status === 'success'" class="js_connected oe_icon oe_green text-success">
                <i class="fa fa-fw fa-desktop" role="img" aria-label="Customer Screen Connected" title="Customer Screen Connected"/>
            </div>
            <span class="ms-1">Customer Screen</span>
        </button>
    </t>

<t t-name="point_of_sale.Navbar">
        <div class="pos-topheader d-flex w-100 p-0 m-0 bg-white border-bottom">
            <div t-if="pos.tempScreen" class="block-top-header position-absolute top-0 start-0 bg-black opacity-50 w-100 h-inherit z-1000"/>
            <div t-if="!ui.isSmall" class="pos-branding d-flex justify-content-start flex-grow-1 h-100 p-0 my-0 text-start">
                <img class="pos-logo h-75 ms-3 me-auto align-self-center" t-on-click="() =&gt; debug.toggleWidget()" src="/web/static/img/logo.png" alt="Logo"/>
            </div>
            <div class="pos-rightheader d-flex flex-grow-1 h-100">
            <span t-if="pos.table?.name" t-esc="pos.table.name" t-attf-style="background-color: {{pos.table.color}};border-radius: 0.25rem;" class="table-name text-white fw-bolder my-2 px-3 d-flex align-items-center"/>
                <BackButton t-if="showBackButton()"/>
                <div class="status-buttons d-flex flex-grow-1 flex-basis-0 justify-content-end h-100">
                    <CashierName/>
                    <SaleDetailsButton t-if="hardwareProxy.printer" isHeaderButton="true"/>
                    <ProxyStatus t-if="pos.config.use_proxy"/>
                    <CustomerFacingDisplayButton t-if="customerFacingDisplayButtonIsShown"/>
                    <SyncNotification/>
                </div>
                <div t-if="isBurgerMenuClosed()" class="navbar-button menu-button btn btn-light rounded-0 d-flex align-items-center px-3 cursor-pointer" t-on-click="openMenu">
                    <i class="fa fa-bars" aria-hidden="true"/>
                </div>
                <div t-else="" class="navbar-button menu menu-button btn btn-light rounded-0 d-flex align-items-center px-3 cursor-pointer" t-on-click="closeMenu">
                    <ul>
                        <li class="menu-item position-relative d-flex">
                            <i class="fa fa-bars" aria-hidden="true"/>
                            <ul class="dropdown-menu sub-menu position-absolute d-flex flex-column align-items-stretch bg-white shadow-lg z-index-1">
                                <li class="ticket-button" t-on-click="onTicketButtonClick">
                                    <a class="dropdown-item with-badge py-2">
                                        Orders
                                        <span t-if="orderCount&gt;0" class="badge text-bg-info rounded-pill py-1 ms-2" t-esc="orderCount"/>
                                    </a>
                                </li>
                                <li t-if="showCashMoveButton" class="menu-item navbar-button" t-on-click="onCashMoveButtonClick">
                                    <a class="dropdown-item py-2">
                                        Cash In/Out
                                    </a>
                                </li>
                                <li class="menu-item navbar-button" t-on-click="() =&gt; pos.toggleImages('product')">
                                    <a class="dropdown-item py-2">
                                        <t t-if="pos.show_product_images">Hide Product Images</t>
                                        <t t-else="">Show Product Images</t>
                                    </a>
                                </li>
                                <li class="menu-item navbar-button" t-on-click="() =&gt; pos.toggleImages('category')">
                                    <a class="dropdown-item py-2">
                                        <t t-if="pos.show_category_images">Hide Category Images</t>
                                        <t t-else="">Show Category Images</t>
                                    </a>
                                </li>
                                <CustomerFacingDisplayButton t-if="CustomerFacingDisplayButtonIsShown"/>
                                <li t-if="showToggleProductView" class="menu-item navbar-button" t-on-click="toggleProductView">
                                    <a class="dropdown-item py-2">
                                        Switch Product View
                                    </a>
                                </li>
            <li t-if="pos.mainScreen.component.name == 'FloorScreen'" class="menu-item navbar-button edit-button" t-on-click="toggleEditMode">
                <a class="dropdown-item py-2">Edit Plan</a>
            </li>
            <li t-if="pos.mainScreen.component.name == 'FloorScreen'" class="menu-item navbar-button" t-on-click="onSwitchButtonClick">
                <a class="dropdown-item py-2">Switch Floor View</a>
            </li>
                                <li class="backend-button" t-on-click="() =&gt; pos.closePos()">
                                    <a class="dropdown-item py-2">
                                        Backend
                                    </a>
                                </li>
                                <li class="close-button" t-on-click="closeSession">
                                    <a class="dropdown-item py-2">
                                        Close Session
                                    </a>
                                </li>
                                <li t-if="this.env.debug" class="menu-item navbar-button" t-on-click="() =&gt; debug.toggleWidget()">
                                    <a class="dropdown-item py-2">
                                        Debug Window
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </t>

<t t-name="point_of_sale.ProxyStatus">
        <button class="oe_status js_proxy btn btn-light" t-on-click="() =&gt; this.pos.connectToProxy()">
            <span t-if="this.message and !ui.isSmall" class="js_msg">
                <t t-esc="this.message"/>
            </span>
            <span t-if="connectionInfo.status === 'connected' and !this.message" class="js_connected text-success">
                <i class="fa fa-fw fa-sitemap" role="img" aria-label="Proxy Connected" title="Proxy Connected"/>
            </span>
            <span t-if="connectionInfo.status === 'connecting'" class="js_connecting">
                <i class="fa fa-fw fa-spin fa-circle-o-notch" role="img" aria-label="Connecting to Proxy" title="Connecting to Proxy"/>
            </span>
            <span t-elif="connectionInfo.status === 'disconnected'" class="js_disconnected text-danger">
                <i class="fa fa-fw fa-sitemap" role="img" aria-label="Proxy Disconnected" title="Proxy Disconnected"/>
            </span>
            <span t-elif="connectionInfo.status === 'warning' or this.message" class="js_warning text-warning">
                <i class="fa fa-fw fa-sitemap" role="img" aria-label="Proxy Warning" title="Proxy Warning"/>
            </span>
        </button>
    </t>

<t t-name="point_of_sale.SaleDetailsButton">
        <div t-att-class="{'oe_status cursor-pointer': props.isHeaderButton }" t-on-click="onClick">
            <div class="js_connected oe_icon" title="Print a report with all the sales of the current PoS Session">
                <i class="fa fa-fw fa-print" role="img" aria-label="Print"/>
            </div>
        </div>
    </t>

<t t-name="point_of_sale.SaleDetailsReport">
        <div class="pos-receipt">
            <t t-if="pos.company_logo_base64">
                <img class="pos-receipt-logo" t-att-src="pos.company_logo_base64" alt="Logo"/>
                <br/>
            </t>
            <t t-if="!pos.company_logo_base64" class="pos-receipt-center-align">
                <h1 t-esc="pos.company.name"/>
                <br/>
            </t>
            <br/><br/>

            <div>
                SOLD:
            </div>

            <div class="orderlines">
                <t t-foreach="products" t-as="category" t-key="category['name']">
                    <t t-foreach="category['products']" t-as="line" t-key="line_index">
                        <div class="responsive-price">
                            <t t-esc="line['product_name'].substr(0,20)"/>
                            <span class="pos-receipt-right-align">
                                <t t-esc="Math.round(line.quantity * Math.pow(10, pos.dp['Product Unit of Measure'])) / Math.pow(10, pos.dp['Product Unit of Measure'])"/>
                                <t t-if="line.uom !== 'Units'">
                                    <t t-esc="line.uom"/>
                                </t>
                                x
                                <t t-esc="formatCurrency(line.price_unit, false)"/>
                            </span>
                        </div>
                        <t t-if="line.discount !== 0">
                            <div class="pos-receipt-left-padding">Discount: <t t-esc="line.discount"/>%</div>
                        </t>
                    </t>
                </t>
            </div>

            <br/>
            <div>------------------------</div>
            <br/>

            <div>
                REFUNDED:
            </div>

            <div class="orderlines">
                <t t-foreach="refund_products" t-as="category" t-key="category['name']">
                    <t t-foreach="category['products']" t-as="line" t-key="line_index">
                        <div class="responsive-price">
                            <t t-esc="line['product_name'].substr(0,20)"/>
                            <span class="pos-receipt-right-align">
                                <t t-esc="Math.round(line.quantity * Math.pow(10, pos.dp['Product Unit of Measure'])) / Math.pow(10, pos.dp['Product Unit of Measure'])"/>
                                <t t-if="line.uom !== 'Units'">
                                    <t t-esc="line.uom"/>
                                </t>
                                x
                                <t t-esc="formatCurrency(line.price_unit, false)"/>
                            </span>
                        </div>
                        <t t-if="line.discount !== 0">
                            <div class="pos-receipt-left-padding">Discount: <t t-esc="line.discount"/>%</div>
                        </t>
                    </t>
                </t>
            </div>

            <br/>
            <div>------------------------</div>
            <br/>

            <div>
                Payments:
            </div>
            <div t-foreach="payments" t-as="payment" t-key="payment_index">
                <t t-esc="payment['name']"/>
                <span t-esc="formatCurrency(payment['total'], false)" class="pos-receipt-right-align"/>
            </div>

            <br/>
            <div>------------------------</div>
            <br/>

            <div>
                Taxes:
            </div>
            <div t-foreach="taxes" t-as="tax" t-key="tax_index">
                <t t-esc="tax.name"/>
                <span t-esc="formatCurrency(tax.tax_amount, false)" class="pos-receipt-right-align"/>
            </div>

            <br/>
            <div>------------------------</div>
            <br/>

            <div>
                Total:
                <span t-esc="formatCurrency(currency.total_paid, false)" class="pos-receipt-right-align"/>
            </div>

            <br/>
            <div class="pos-receipt-order-data">
                <div><t t-esc="date"/></div>
            </div>
        </div>
    </t>

<t t-name="point_of_sale.SyncNotification">
        <div class="oe_status btn btn-light rounded-0" t-on-click="onClick">
            <span t-if="sync.pending" class="js_msg">
                <t t-esc="sync.pending"/>
                <span> </span>
            </span>
            <div t-if="sync.status === 'connected'" class="js_connected oe_icon text-success">
                <i class="fa fa-fw fa-wifi" role="img" aria-label="Synchronisation Connected" title="Synchronisation Connected"/>
            </div>
            <div t-if="sync.status === 'connecting'" class="js_connecting oe_icon text-white">
                <i class="fa fa-fw fa-spin fa-circle-o-notch" role="img" aria-label="Synchronisation Connecting" title="Synchronisation Connecting"/>
            </div>
            <div t-if="sync.status === 'disconnected'" class="js_disconnected oe_icon text-warning">
                <i class="fa fa-fw fa-wifi" role="img" aria-label="Synchronisation Disconnected" title="Synchronisation Disconnected"/>
            </div>
            <div t-if="sync.status === 'error'" class="js_error oe_icon text-danger">
                <i class="fa fa-fw fa-warning" role="img" aria-label="Synchronisation Error" title="Synchronisation Error"/>
            </div>
        </div>
    </t>

<t t-name="point_of_sale.Notification">
        <div class="o_notification o-fade o-fade-enter-active p-3 m-2 text-bg-dark bg-opacity-75 text-center pe-none" t-att-class="props.className" t-on-click="props.close">
            <span t-esc="props.message"/>
        </div>
    </t>

    <t t-name="point_of_sale.NotificationContainer">
        <div class="o_pos_notification_manager fixed-bottom d-flex flex-column align-items-center justify-content-end p-4 pe-none">
            <t t-foreach="props.notifications" t-as="notification" t-key="notification">
                <Transition name="'o-fade'" visible="notification_value.visible" leaveDuration="leaveDuration" t-slot-scope="transition" onLeave="notification_value.delete">
                    <Notification message="notification_value.message" close="notification_value.close" className="transition.className"/>
                </Transition>
            </t>
        </div>
    </t>

<t t-name="point_of_sale.PopupContainer">
        <div t-if="Object.keys(props.popups).length &gt; 0" class="popups">
            <t t-foreach="props.popups" t-as="popup" t-key="popup">
                <div role="dialog" class="modal-dialog position-absolute start-0 top-0 d-flex align-items-center justify-content-center h-100 w-100 mw-100 m-0 p-0 pe-auto bg-dark bg-opacity-50" t-att-style="\`z-index: \${popup_value.props.zIndex}\`">
                    <t t-component="popup_value.component" t-props="popup_value.props"/>
                </div>
            </t>
        </div>
    </t>

<t t-name="point_of_sale.Chrome">
        <div class="pos dvh-100 d-flex flex-column" t-att-class="{ 'big-scrollbars': pos.hasBigScrollBars }">
            <Navbar/>
            <div class="pos-content flex-grow-1 overflow-auto bg-200">

                <t isShown="!pos.tempScreen" t-component="pos.mainScreen.component" t-props="pos.mainScreen.props"/>
                <ErrorHandler onError.bind="onTempScreenError">
                    <t t-if="pos.tempScreen" t-component="pos.tempScreen.component" t-props="pos.tempScreen.props" t-key="pos.tempScreen.name"/>
                </ErrorHandler>
            </div>
        </div>
        <MainComponentsContainer/>
    </t>

<t t-name="point_of_sale.PartnerDetailsEdit">
        <section class="partner-details edit d-flex flex-column m-3">
            <div class="container">
                <div class="partner-details-header d-flex pe-2 gap-2">
                    <div class="partner-picture position-relative rounded text-center overflow-hidden">
                        <t t-if="partnerImageUrl">
                            <img class="rounded" t-att-src="partnerImageUrl" alt="Partner" style="width: 64px; height: 64px; object-fit: cover;"/>
                        </t>
                        <t t-else="">
                            <i class="fa fa-camera" role="img" aria-label="Picture" title="Picture"/>
                        </t>
                        <input type="file" class="image-uploader" t-on-change="uploadImage"/>
                    </div>
                    <input class="detail partner-name form-control form-control-lg" t-model="changes.name" name="name" placeholder="Name"/>
                </div>
                <div class="partner-details-box row row-cols-1 row-cols-sm-2 gy-3 mt-3">
                    <t t-foreach="['Street', 'City', 'Zip', 'Email', 'Phone', 'Mobile', 'Barcode' ]" t-as="item" t-key="item">
                        <div class="partner-detail col">
                            <label class="form-label label" t-attf-for="{{item}}" t-esc="partnerDetailsFields[item]"/>
                            <input class="detail form-control" t-attf-id="{{item}}" t-attf-name="{{item}}" t-model="changes[item.toLowerCase()]" t-attf-placeholder="{{partnerDetailsFields[item]}}" t-att="{'disabled': isFieldCommercialAndPartnerIsChild(item)}" t-att-class="{'border-danger': missingFields.includes(item.toLowerCase())}"/>
                        </div>
                    </t>

                    <div class="partner-detail col">
                        <label class="form-label label" for="state">State</label>
                        <select class="detail form-select" id="state" name="state_id" t-model="changes.state_id" t-att="{'disabled': isFieldCommercialAndPartnerIsChild('state_id')}" t-att-class="{'border-danger': missingFields.includes('state_id')}">
                            <option value="">None</option>
                            <t t-foreach="pos.states" t-as="state" t-key="state.id">
                                <option t-if="changes.country_id == state.country_id[0]" t-att-value="state.id">
                                    <t t-esc="state.name"/>
                                </option>
                            </t>
                        </select>
                    </div>
                    <div class="partner-detail col">
                        <label class="form-label label" for="country">Country</label>
                        <select class="detail form-select" id="country" name="country_id" t-model="changes.country_id" t-att="{'disabled': isFieldCommercialAndPartnerIsChild('country_id')}" t-att-class="{'border-danger': missingFields.includes('country_id')}">
                            <option value="">None</option>
                            <t t-foreach="pos.countries" t-as="country" t-key="country.id">
                                <option t-att-value="country.id">
                                    <t t-esc="country.name"/>
                                </option>
                            </t>
                        </select>
                    </div>
                    <div class="partner-detail col">
                        <label class="form-label label" for="language">Language</label>
                        <select class="detail form-select" id="language" name="lang" t-model="changes.lang" t-att="{'disabled': isFieldCommercialAndPartnerIsChild('lang')}" t-att-class="{'border-danger': missingFields.includes('lang')}">
                            <t t-foreach="pos.langs" t-as="lang" t-key="lang.id">
                                <option t-att-value="lang.code" t-att-selected="changes.lang ? ((lang.code === changes.lang) ? true : undefined) : lang.code === pos.user.lang? true : undefined">
                                    <t t-esc="lang.name"/>
                                </option>
                            </t>
                        </select>
                    </div>
                    <div t-if="pos.pricelists.length gt 1" class="partner-detail col">
                        <label class="form-label label" for="pricelist">Pricelist</label>
                        <select class="detail form-select" id="pricelist" name="property_product_pricelist" t-model="changes.property_product_pricelist" t-att="{'disabled': isFieldCommercialAndPartnerIsChild('property_product_pricelist')}" t-att-class="{'border-danger': missingFields.includes('property_product_pricelist')}">
                            <t t-foreach="pos.pricelists" t-as="pricelist" t-key="pricelist.id">
                                <option t-att-value="pricelist.id" t-att-selected="props.partner.property_product_pricelist ? (pricelist.id === props.partner.property_product_pricelist[0] ? true : undefined) : pricelist.id === pos.default_pricelist?.id ? true : undefined">
                                    <t t-esc="pricelist.display_name"/>
                                </option>
                            </t>
                        </select>
                    </div>
                    <div class="partner-detail col">                                                           
                        <label class="form-label label" for="vat">Tax ID</label>                           
                        <input class="detail vat form-control" id="vat" name="vat" t-model="changes.vat" t-att="{'disabled': isFieldCommercialAndPartnerIsChild('vat')}" t-att-class="{'border-danger': missingFields.includes('vat')}"/>
                    </div>      
                </div>
            </div>
        </section>
    </t>
<t t-name="point_of_sale.PartnerLine">
        <tr t-attf-class="partner-line gap-2 gap-lg-0 align-top {{highlight}}" t-att-data-id="props.partner.id" t-on-click="() =&gt; this.props.onClickPartner(props.partner)">
            <td>
                <b>
                    <t t-esc="props.partner.name or ''"/>
                </b>
                <div class="company-field text-bg-muted">
                    <t t-esc="props.partner.parent_name or ''"/>
                </div>
                <button t-if="_isPartnerSelected" class="unselect-tag d-lg-inline-block d-none btn btn-light mt-2">
                    <i class="fa fa-times me-1"/>
                    <span> Unselect </span>
                </button>
            </td>
            <td>
                <div class="partner-line-adress" t-if="props.partner.address">
                    <t t-esc="props.partner.address"/>
                </div>
            </td>
            <td class="partner-line-email ">
                <div class="mb-2" t-if="props.partner.phone">
                    <i class="fa fa-fw fa-phone me-2"/><t t-esc="props.partner.phone"/>
                </div>
                <div class="mb-2" t-if="props.partner.mobile">
                    <i class="fa fa-fw fa-mobile me-2"/><t t-esc="props.partner.mobile"/>
                </div>
                <div t-if="props.partner.email" class="email-field mb-2">
                    <i class="fa fa-fw fa-paper-plane-o me-2"/><t t-esc="props.partner.email"/>
                </div>
            </td>
            <td class="partner-line-balance" t-if="props.isBalanceDisplayed"/>
            <td class="edit-partner-button-cell">
                <button class="edit-partner-button btn btn-light border" t-on-click.stop="() =&gt; props.onClickEdit(props.partner)">DETAILS</button>
                <button t-if="_isPartnerSelected" class="unselect-tag-mobile d-inline-block d-lg-none btn btn-light border ms-2">
                    <i class="fa fa-times"/>
                    <span> UNSELECT </span>
                </button>
            </td>
            <td class="partner-line-last-column-placeholder oe_invisible"/>
        </tr>
    </t>

<t t-name="point_of_sale.PartnerListScreen">
        <div class="partnerlist-screen screen h-100 d-flex flex-column bg-100">
            <div class="top-content d-flex align-items-center p-2 border-bottom text-center">
                <div class="button highlight btn btn-lg btn-primary" t-if="state.detailIsShown" t-on-click="() =&gt; this.partnerEditor.save()">
                    <i t-if="ui.isSmall" class="fa fa-floppy-o"/>
                    <t t-else="">
                        <span> Save</span>
                    </t>
                </div>
                <button t-if="!state.detailIsShown" class="button new-customer highlight btn btn-lg btn-primary" role="img" aria-label="Add a customer" t-on-click="createPartner" title="Add a customer">
                    <i t-if="ui.isSmall" class="fa fa-plus"/>
                    <t t-else=""> Create</t>
                </button>
                <div class="button back btn btn-lg btn-secondary mx-2" t-on-click="back">
                    <i t-if="ui.isSmall" class="fa fa-angle-double-left"/>
                    <t t-else=""> Discard</t>
                </div>
                <div class="top-right-buttons d-flex gap-2 w-100 justify-content-end">
                    <div t-if="state.detailIsShown and state.editModeProps.partner.id" class="button more-info">
                        <a t-on-click="goToOrders" class="btn btn-lg btn-outline-secondary" target="_blank"> Orders </a>
                    </div>
                    <div t-if="state.detailIsShown &amp;&amp; state.editModeProps.partner.id" class="button more-info">
                        <a t-att-href="partnerLink" class="btn btn-lg btn-outline-secondary" target="_blank"> More info</a>
                    </div>
                    <div class="search-bar-container sb-partner d-flex align-items-center w-100 w-lg-50 h-100 h-100" t-if="!state.detailIsShown">
                        <div class="input-group h-100">
                            <div class="pos-search-bar form-control d-flex align-items-center bg-view">
                                <i class="oi oi-search me-2" t-on-click="_onPressEnterKey"/>
                                <input class="flex-grow-1 w-auto h-100 border-0 p-2 me-4" type="text" autofocus="autofocus" t-ref="search-word-input-partner" placeholder="Search Customers..." size="1" t-on-keyup="updatePartnerList"/>
                                <i class="fa fa-times position-absolute end-0 me-2 pe-1 cursor-pointer" t-on-click="_clearSearch"/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <section class="overflow-auto">
                <t t-if="state.detailIsShown">
                    <PartnerDetailsEdit t-props="state.editModeProps" saveChanges.bind="saveChanges" imperativeHandle="partnerEditor"/>
                </t>
                <t t-else="">
                    <table class="partner-list table table-striped w-100">
                        <thead>
                            <tr>
                                <th class="py-2">Name</th>
                                <th class="py-2">Address</th>
                                <th class="partner-line-email py-2">Contact</th>
                                <th class="pos-right-align py-2" t-if="isBalanceDisplayed">Balance</th>
                                <th class="partner-line-details py-2"/>
                                <th class="partner-line-last-column-placeholder oe_invisible py-2"/>
                            </tr>
                        </thead>
                        <tbody class="partner-list-contents">
                            <t t-foreach="partners" t-as="partner" t-key="partner.id">
                                <PartnerLine partner="partner" selectedPartner="state.selectedPartner" detailIsShown="state.detailIsShown" isBalanceDisplayed="isBalanceDisplayed" onClickEdit.bind="editPartner" onClickPartner.bind="clickPartner"/>
                            </t>
                        </tbody>
                    </table>
                    <div t-if="state.query" class="search-more-button d-flex justify-content-center my-2">
                        <button class="btn btn-lg btn-primary" t-on-click="_onPressEnterKey">Search more</button>
                    </div>
                </t>
            </section>
        </div>
    </t>

<t t-name="point_of_sale.PaymentScreenPaymentLines">
            <div class="paymentlines d-flex flex-column">
                <h4 class="title-category pt-3 pb-2 px-3 m-0 bg-view border-bottom border-2">Summary</h4>
                <t t-foreach="props.paymentLines" t-as="line" t-key="line.cid">
                    <t t-if="line.selected">
                        <div class="paymentline selected d-flex align-items-center bg-200" t-att-class="selectedLineClass(line)">
                            <div class="payment-infos d-flex align-items-center justify-content-between flex-grow-1 px-3 py-4 my-2 text-truncate cursor-pointer" t-on-click="() =&gt; this.selectLine(line)">
                                 <span class="payment-name"><t t-esc="line.payment_method.name"/></span>
                                 <div class="payment-amount px-3">
                                    <t t-if="line and line.payment_status and ['done', 'waitingCard', 'waiting', 'reversing', 'reversed'].includes(line.payment_status)">
                                            <t t-esc="env.utils.formatCurrency(line.get_amount(), false)"/>
                                    </t>
                                    <t t-else="">
                                            <t t-esc="formatLineAmount(line)"/>
                                    </t>
                                </div>
                            </div>

                            <t t-if="!line.payment_status or !['done', 'reversed', 'waitingCard', 'waitingCapture'].includes(line.payment_status)">
                                <button class="delete-button btn btn-link mx-2 px-3" t-on-click="() =&gt; this.props.deleteLine(line.cid)" aria-label="Delete" title="Delete">
                                    <i class="fa fa-2x fa-times-circle"/>
                                </button>
                            </t>
                        </div>
                        <t t-if="line and line.payment_status">
                            <div class="paymentline electronic_payment">
                                <t t-if="line.payment_status == 'pending'">
                                    <div class="electronic_status">
                                        Payment request pending
                                    </div>
                                    <div class="button send_payment_request highlight text-bg-primary" title="Send Payment Request" t-on-click="() =&gt; this.props.sendPaymentRequest(line)">
                                        Send
                                    </div>
                                </t>
                                <t t-elif="line.payment_status == 'retry'">
                                    <div class="electronic_status">
                                        Transaction cancelled
                                    </div>
                                    <div class="button send_payment_request highlight text-bg-primary" title="Send Payment Request" t-on-click="() =&gt; this.props.sendPaymentRequest(line)">
                                        Retry
                                    </div>
                                </t>
                                <t t-elif="line.payment_status == 'force_done'">
                                    <div class="electronic_status">
                                        Connection error
                                    </div>
                                    <div class="button send_force_done" title="Force Done" t-on-click="() =&gt; this.props.sendForceDone(line)">
                                        Force done
                                    </div>
                                </t>
                                <t t-elif="line.payment_status == 'waitingCard'">
                                    <div class="electronic_status">
                                        Waiting for card
                                    </div>
                                    <div class="button send_payment_cancel" title="Cancel Payment Request" t-on-click="() =&gt; this.props.sendPaymentCancel(line)">
                                        Cancel
                                    </div>
                                </t>
                                <t t-elif="['waiting', 'waitingCancel', 'waitingCapture'].includes(line.payment_status)">
                                    <div class="electronic_status">
                                        Request sent
                                    </div>
                                    <div>
                                        <i class="fa fa-circle-o-notch fa-spin" role="img"/>
                                    </div>
                                </t>
                                <t t-elif="line.payment_status == 'reversing'">
                                    <div class="electronic_status">
                                        Reversal request sent to terminal
                                    </div>
                                    <div>
                                        <i class="fa fa-circle-o-notch fa-spin" role="img"/>
                                    </div>
                                </t>
                                <t t-elif="line.payment_status == 'done'">
                                    <div class="electronic_status">
                                        Payment Successful
                                    </div>
                                    <t t-if="line.canBeAdjusted() &amp;&amp; line.order.get_total_paid() &lt; line.order.get_total_with_tax()">
                <div class="button send_adjust_amount" title="Adjust Amount" t-on-click="() =&gt; this.sendPaymentAdjust(line)">
                    Adjust Amount
                </div>
            </t>
            <t t-elif="line.can_be_reversed">
                <div class="button send_payment_reversal" title="Reverse Payment" t-on-click="() =&gt; this.props.sendPaymentReverse(line)">
                    Reverse
                </div>
            </t>
        <t t-else="">
                                        <div/>
                                    </t>
                                </t>
                                <t t-elif="line.payment_status == 'reversed'">
                                    <div class="electronic_status">
                                        Payment reversed
                                    </div>
                                    <div/>
                                </t>
                            </div>
                        </t>
                    </t>
                    <t t-else="">
                        <div class="paymentline d-flex align-items-center bg-view" t-att-class="unselectedLineClass(line)">
                             <div class="payment-infos d-flex align-items-center justify-content-between flex-grow-1 px-3 py-4 my-2 text-truncate cursor-pointer" t-on-click="() =&gt; this.selectLine(line)">
                                 <t t-esc="line.payment_method.name"/>
                                 <div class="payment-amount px-3">
                                    <t t-if="line and line.payment_status and ['done', 'waitingCard', 'waiting', 'reversing', 'reversed'].includes(line.payment_status)">
                                            <t t-esc="env.utils.formatCurrency(line.get_amount(), false)"/>
                                    </t>
                                    <t t-else="">
                                            <t t-esc="formatLineAmount(line)"/>
                                    </t>
                                </div>
                             </div>
                            <t t-if="!line.payment_status or !['done', 'reversed'].includes(line.payment_status)">
                                <div class="delete-button delete-button btn btn-link mx-2 px-3" t-on-click="() =&gt; this.props.deleteLine(line.cid)" aria-label="Delete" title="Delete">
                                    <i class="fa fa-2x fa-times-circle"/>
                                </div>
                            </t>
                        </div>
                    </t>
                </t>
            </div>
    </t>

<t t-name="point_of_sale.PaymentScreen">
        <t t-if="ui.isSmall">
            <div class="payment-screen screen d-flex flex-column h-100 bg-100" t-att-class="{ 'd-none': !props.isShown }">
                <PaymentScreenStatus order="currentOrder"/>
                <t t-call="point_of_sale.PaymentScreenMethods"/>
                <t t-call="point_of_sale.PaymentScreenButtons"/>
                <t t-call="point_of_sale.PaymentScreenValidate"/>
            </div>
        </t>
        <t t-else="">
            <div class="payment-screen screen d-flex flex-column h-100 bg-100" t-att-class="{ 'd-none': !props.isShown }">
                <t t-call="point_of_sale.PaymentScreenTop"/>
                <div class="main-content d-flex overflow-auto h-100">
                    <div class="left-content d-flex flex-column w-25 bg-400">
                        <t t-call="point_of_sale.PaymentScreenMethods"/>
                        <t t-call="point_of_sale.PaymentScreenValidate"/>
                    </div>
                    <div class="center-content d-flex flex-column w-50 p-1 border-start border-end bg-300">
                        <PaymentScreenStatus order="currentOrder"/>
                        <Numpad class="'flex-grow-1'" buttons="getNumpadButtons()"/>
                    </div>
                    <div class="right-content w-25 bg-400">
                        <t t-call="point_of_sale.PaymentScreenButtons"/>
                    </div>
                </div>
            </div>
        </t>
    </t>

    <t t-name="point_of_sale.PaymentScreenTop">
        <div class="top-content d-flex align-items-center p-2 border-bottom text-center">
            <div class="button back btn btn-lg btn-secondary" t-on-click="() =&gt; pos.showScreen('ProductScreen')">
                <i class="fa fa-angle-double-left me-2"/>
                <t t-if="pos.config.set_tip_after_payment and currentOrder.is_paid()">
                <span class="back_text">Keep Open</span>
            </t>
            <t t-else=""><span class="back_text">Back</span>
            </t>
        </div>
            <div class="top-content-center flex-grow-1">
                <h2 class="mb-0">Payment</h2>
            </div>
        </div>
    </t>

    <t t-name="point_of_sale.PaymentScreenValidate">
        <t t-if="ui.isSmall">
            <div class="switchpane d-flex h-12">
                <button class="btn-switchpane validation-button btn btn-primary flex-fill py-4 rounded-0 fw-bolder fs-1" t-att-class="{ secondary: !(currentOrder.is_paid() and currentOrder._isValidEmptyOrder()) }" t-on-click="() =&gt; this.validateOrder()">
                    <span>Validate</span>
                </button>
            </div>
        </t>
        <t t-else="">
            <div class="button next validation btn btn-primary btn-lg py-5 rounded-0 d-flex flex-column align-items-center justify-content-center fw-bolder" t-attf-class="{{currentOrder.is_paid() and currentOrder._isValidEmptyOrder() ? 'highlight' : 'disabled'}}" t-on-click="() =&gt; this.validateOrder()" t-att-hidden="pos.config.set_tip_after_payment and !currentOrder.is_paid()">
                <div class="pay-circle d-flex align-items-center justify-content-center mb-2">
                    <i class="oi oi-chevron-right" role="img" aria-label="Pay" title="Pay"/>
                </div>
                <t t-if="pos.config.set_tip_after_payment and currentOrder.is_paid()">
                <span class="back_text">Close Tab</span>
            </t>
            <t t-else=""><span class="next_text">Validate</span>
            </t>
        </div>
        </t>
    </t>

    <t t-name="point_of_sale.PaymentScreenButtons">
        <div class="payment-buttons d-flex flex-column flex-wrap">
            <button class="button partner-button btn btn-light py-3 text-start rounded-0 border-bottom" t-att-class="{ 'highlight text-bg-primary': currentOrder.get_partner() }" t-on-click="() =&gt; this.selectPartner(false, [])">
                <i class="fa fa-user me-2" role="img" title="Customer"/>
                <span class="partner-name">
                    <t t-if="currentOrder.get_partner()" t-esc="currentOrder.get_partner().name"/>
                    <t t-else="">Customer</t>
                </span> 
            </button>
            <button class="button js_invoice btn btn-light py-3 text-start rounded-0 border-bottom" t-att-class="{ 'highlight text-bg-primary': currentOrder.is_to_invoice() }" t-on-click="toggleIsToInvoice">
                <i class="fa fa-file-text-o me-2"/>Invoice 
            </button>
            <button t-if="pos.config.iface_tipproduct and pos.config.tip_product_id" class="button js_tip btn btn-light py-3 text-start rounded-0 border-bottom" t-att-class="{ 'highlight text-bg-primary': currentOrder.get_tip() }" t-on-click="addTip">
                <i class="fa fa-heart me-2"/>Tip 
                <t t-if="currentOrder.get_tip() != 0">
                    (<t t-esc="env.utils.formatCurrency(currentOrder.get_tip())"/>)
                </t>
            </button>
            <button t-if="pos.config.iface_cashdrawer" class="button js_cashdrawer btn btn-light py-3 text-start rounded-0 border-bottom" t-on-click="openCashbox">
                <i class="fa fa-archive me-2"/>Open Cashbox 
            </button>
            <button t-if="pos.config.ship_later" class="button btn btn-light py-3 text-start rounded-0 border-bottom" t-att-class="{ 'highlight text-bg-primary': currentOrder.getShippingDate() }" t-on-click="toggleShippingDatePicker">
                <i class="fa fa-clock-o me-2"/>Ship Later 
                <span t-if="currentOrder.getShippingDate()">
                    (<t t-esc="currentOrder.getShippingDate()"/>)
                </span>
            </button>
        </div>
    </t>


    <t t-name="point_of_sale.PaymentScreenMethods">
        <div class="paymentmethods-container overflow-y-auto flex-grow-1">
            <div class="paymentmethods d-flex flex-column">
                <h4 class="title-category pt-3 pb-2 px-3 m-0 bg-view border-bottom border-2">Payment method</h4>
                <t t-foreach="payment_methods_from_config" t-as="paymentMethod" t-key="paymentMethod.id">
                    <div class="button paymentmethod btn btn-light rounded-0 border-bottom" t-on-click="() =&gt; this.addNewPaymentLine(paymentMethod)">
                        <div class="payment-method-display d-flex align-items-center flex-grow-1">
                            <div>
                                <img class="payment-method-icon" t-att-src="paymentMethodImage(paymentMethod.id)"/>
                            </div>
                            <span class="payment-name" t-esc="paymentMethod.name"/>
                        </div>
                    </div>
                </t>
            </div>
            <PaymentScreenPaymentLines paymentLines="paymentLines" deleteLine.bind="deletePaymentLine" sendForceDone.bind="sendForceDone" sendPaymentReverse.bind="sendPaymentReverse" sendPaymentCancel.bind="sendPaymentCancel" sendPaymentRequest.bind="sendPaymentRequest" selectLine.bind="selectPaymentLine" updateSelectedPaymentline.bind="updateSelectedPaymentline"/>
        </div>
    </t>
<t t-name="point_of_sale.PaymentScreenStatus">
        <section class="paymentlines-container bg-view p-3 mb-1 border-bottom">
            <div t-if="props.order.get_paymentlines().length === 0" class="paymentlines-empty">
                <div class="total text-center py-2 text-success">
                    <t t-esc="totalDueText"/>
                </div>
                <div class="message text-center">
            Please select a payment method.
                </div>
            </div>

            <t t-else="">
                <div class="payment-status-container d-flex flex-column-reverse flex-lg-row justify-content-between fs-2">
                    <div>
                        <div class="payment-status-remaining">
                            <span class="label pe-2">Remaining</span>
                            <span class="amount" t-att-class="{ 'highlight text-primary fw-bolder': props.order.get_due() &gt; 0 }">
                                <t t-esc="remainingText"/>
                            </span>
                        </div>
                        <div class="payment-status-total-due py-2 fs-3 text-muted">
                            <span class="label pe-2">Total Due</span>
                            <span>
                                <t t-esc="totalDueText"/>
                            </span>
                        </div>
                    </div>
                    <div>
                        <div class="payment-status-change">
                            <span class="label pe-2">Change</span>
                            <span class="amount" t-att-class="{ 'highlight text-primary fw-bolder': props.order.get_change() &gt; 0 }">
                                <t t-esc="changeText"/>
                            </span>
                        </div>
                    </div>
                </div>
            </t>
        </section>
    </t>
<t t-name="point_of_sale.ActionpadWidget">
        <div class="actionpad d-flex flex-column flex-grow-1 mw-50 p-0 border-end" t-att-class="{'w-50' : this.swapButton}">
            <button class="button mobile-more-button btn btn-secondary flex-fill border-bottom" t-if="ui.isSmall and props.onClickMore" t-on-click="props.onClickMore">
                <span>More...</span>
            </button>
            <button class="button set-partner btn btn-light rounded-0 py-2 flex-shrink-1 fw-bolder" t-on-click="() =&gt; this.pos.selectPartner()" t-if="!this.swapButton">
                <div class="d-flex justify-content-center align-items-center ">
                    <span class="d-flex justify-content-center align-items-center rounded-circle me-2 text-bg-dark" t-if="!ui.isSmall">
                        <i class="fa fa-user" role="img" aria-label="Customer" title="Customer"/>
                    </span>
                    <div t-if="props.partner" class="text-truncate fw-bolder text-action">
                        <t t-esc="props.partner.name"/>
                    </div>
                    <div t-else="fw-bolder">
                        Customer
                    </div>
                </div>
            </button>
            <button t-if="this.swapButton" t-on-click="() =&gt; pos.get_order().pay()" class="button pay-order-button btn btn-lg rounded-0" t-attf-class="{{ this.highlightPay ? 'highlight btn-primary' : 'btn-secondary' }}">
                <i class="oi oi-chevron-right" role="img" aria-label="Pay" title="Pay"/>
                Payment
            </button>
            <button class="pay validation pay-order-button btn-primary" t-attf-class="{{getMainButtonClasses()}}" t-att-class="{ 'with-more-button': props.onClickMore and ui.isSmall }" t-on-click="props.actionToTrigger ? this.props.actionToTrigger : () =&gt; pos.get_order().pay()" t-if="!this.swapButton">
                <div class="pay-circle d-flex align-items-center justify-content-center py-2 mb-2">
                    <i class="oi oi-chevron-right" role="img" aria-label="Pay" title="Pay"/>
                </div>
                <t class="text-white" t-esc="props.actionName"/>
            </button>
            <button t-if="this.swapButton" t-attf-class="submit-order h-100 {{getMainButtonClasses()}}" t-att-class="swapButtonClasses" t-on-click="submitOrder" style="width: 170px;">
                <i class="fa fa-cutlery"/>
                Order
                <div t-if="displayCategoryCount.length" class="break-line fw-normal fs-6 w-100  border-top mt-1 pt-1">
                    <t t-foreach="displayCategoryCount" t-as="categoryCountLine" t-key="categoryCountLine_index">
                        <div class="d-flex justify-content-start g-0 my-1 w-100">
                            <label class="rounded px-2 py-0 me-1" style="background-color:rgba(0, 0, 0, 0.3);"><t t-esc="categoryCountLine.count"/></label>
                            <label class="text-truncate ps-0"><t t-esc="categoryCountLine.name"/></label>
                        </div>
                    </t>
                </div>
                <t t-if="isCategoryCountOverflow">
                    <div class="position-absolute bottom-0">...</div>
                </t>
            </button>
        </div>
    </t>

<t t-name="point_of_sale.ControlButtonPopup">
        <div class="popup popup-control-buttons d-flex flex-column">

            <div class="control-buttons d-flex flex-column p-2" t-on-click="cancel">
                <t t-foreach="controlButtons" t-as="cb" t-key="cb.name">
                    <t t-component="cb.component" t-key="cb.name"/>
                </t>
            </div>
            <footer class="footer modal-footer">
                <div class="button cancel btn btn-lg btn-primary" t-on-click="cancel">
                    <t t-esc="props.cancelText"/>
                </div>
            </footer>
        </div>
    </t>

<t t-name="point_of_sale.CustomerButton">
        <div class="control-button customer-button btn rounded-0 fw-bolder text-truncate" t-attf-class="{{this.partner ? 'btn-primary' : 'btn-light'}}" t-on-click="() =&gt; this.pos.selectPartner()">
            <i class="fa fa-user me-1" role="img" aria-label="Customer" title="Customer"/>
            <t t-esc="this.partner.name" t-if="this.partner"/>
            <t t-else="">
                Customer
            </t>
        </div>
    </t>
<t t-name="point_of_sale.OrderlineCustomerNoteButton">
        <button class="control-button btn btn-light rounded-0 fw-bolder" t-on-click="() =&gt; this.onClick()">
            <i class="fa fa-sticky-note me-1"/>
            <span> </span>
            <span>Customer Note</span>
        </button>
    </t>

<t t-name="point_of_sale.SetFiscalPositionButton">
        <div class="control-button o_fiscal_position_button btn btn-light rounded-0 fw-bolder" t-on-click="() =&gt; this.click()">
            <i class="fa fa-book me-1" role="img" aria-label="Set fiscal position" title="Set fiscal position"/>
            <t t-esc="currentFiscalPositionName"/>
        </div>
    </t>

<t t-name="point_of_sale.SetPricelistButton">
        <div class="control-button o_pricelist_button btn btn-light rounded-0 fw-bolder" t-on-click="() =&gt; this.click()">
            <i class="fa fa-th-list me-2" role="img" aria-label="Price list" title="Price list"/>
            <t t-esc="currentPricelistName"/>
        </div>
    </t>

<t t-name="point_of_sale.RefundButton">
        <button class="control-button btn btn-light rounded-0 fw-bolder" t-on-click="() =&gt; this.click()">
            <i class="fa fa-undo me-1" role="img" aria-label="Refund" title="Refund"/>
            Refund
        </button>
    </t>

<t t-name="point_of_sale.SaveButton">
        <div class="control-button btn btn-light rounded-0 fw-bolder" t-on-click="onClick">
            <i class="fa fa-upload" role="img" aria-label="Save" title="Save"/>
            Save
        </div>
    </t>

<t t-name="point_of_sale.ProductInfoPopup">
            <div class="popup product-info-popup">
                <div class="modal-header">
                    <h4 class="modal-title">Product information</h4>
                    <div class="btn" t-on-click="cancel">
                        <i class="fa fa-times" aria-hidden="true"/>
                    </div>
                </div>
                <main class="body modal-body overflow-auto">
                    <div class="section-product-info-title d-flex flex-column flex-sm-row text-start gap-3 text-info bg-opacity-25 mx-n3 mt-n3 p-3" t-attf-class="{{ props.product.self_order_available ? 'bg-success' : 'bg-danger' }}">
                        <div class="d-flex flex-column flex-grow-1 text-start w-100 w-sm-25">
                            <span t-esc="props.product.display_name" class="global-info-title fs-2 fw-bolder text-truncate"/>
                            <span class="fs-3"><t t-if="props.product.default_code" t-esc="props.product.default_code"/> <t t-if="props.product.default_code and props.product.barcode"> - </t> <t t-if="props.product.barcode" t-esc="props.product.barcode"/></span>
                        </div>
                        <div class="d-flex flex-column justify-content-center text-start text-sm-end w-100 w-sm-25">
                            <span t-esc="env.utils.formatCurrency(productInfo.all_prices.price_with_tax)" class="global-info-title fs-2 fw-bolder"/>
                            <span class="fs-3">
                                <t t-foreach="productInfo.all_prices.tax_details" t-as="tax" t-key="tax.name">
                                    <div><t t-esc="tax.name"/>: <t t-esc="env.utils.formatCurrency(tax.amount)"/></div>
                                </t>
                            </span>
                        </div>
                    </div>
            <div class="section-self-order-availability mt-3 mb-4 pb-4 border-bottom text-start">
                <h3 class="section-title">Self-ordering availability:</h3>
                <div class="section-self-order-availability-body">
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" t-att-checked="props.product.self_order_available" t-on-click="() =&gt; this.switchSelfAvailability()"/>
                    </div>
                    <span>
                        <t t-if="props.product.self_order_available">Available</t>
                        <t t-else="">Not available</t>
                    </span>
                </div>
            </div>
                    <div class="section-financials mt-3 mb-4 pb-4 border-bottom text-start">
                        <h3 class="section-title">Financials</h3>
                        <div class="section-financials-body d-flex flex-column flex-sm-row">
                            <table class="table table-borderless mb-0">
                                <tr>
                                    <td>Price excl. Tax:</td>
                                    <td><t t-esc="env.utils.formatCurrency(productInfo.all_prices.price_without_tax)"/></td>
                                </tr>
                                <tr t-if="_hasMarginsCostsAccessRights()">
                                    <td>Cost:</td>
                                    <td><t t-esc="costCurrency"/></td>
                                </tr>
                                <tr t-if="_hasMarginsCostsAccessRights()">
                                    <td>Margin:</td>
                                    <td><t t-esc="marginCurrency"/> (<t t-esc="marginPercent"/>%) </td>
                                </tr>
                            </table>
                            <table class="table table-borderless">
                                <t t-foreach="productInfo.pricelists" t-as="pricelist" t-key="pricelist.name">
                                    <tr>
                                        <td t-esc="pricelist.name"/>
                                        <td t-esc="env.utils.formatCurrency(pricelist.price)"/>
                                    </tr>
                                </t>
                            </table>
                        </div>
                    </div>
                    <div class="section-inventory mt-3 mb-4 pb-4 border-bottom text-start" t-if="productInfo.warehouses.length &gt; 0">
                        <h3 class="section-title">
                            Inventory 
                            <t t-if="pos.pos_session.update_stock_at_closing">(as of opening)</t>
                        </h3>
                        <div class="section-inventory-body">
                            <t t-foreach="productInfo.warehouses" t-as="warehouse" t-key="warehouse.name">
                                <div class="d-flex flex-column flex-md-row gap-2">
                                    <div>
                                        <t t-esc="warehouse.name" class="table-name"/>
                                        :
                                    </div>
                                    <div>
                                        <span class="me-1 fw-bolder"><t t-esc="warehouse.available_quantity" class="table-name"/></span>
                                        <t t-esc="warehouse.uom"/> available,
                                    </div>
                                    <div> 
                                        <span class="me-1 fw-bolder"><t t-esc="warehouse.forecasted_quantity"/></span>
                                        forecasted
                                    </div>
                                </div>
                            </t>
                        </div>
                    </div>
                    <div class="section-supplier mt-3 mb-4 pb-4 border-bottom text-start" t-if="productInfo.suppliers.length &gt; 0">
                        <h3 class="section-title">Replenishment</h3>
                        <div class="section-supplier-body">
                            <t t-foreach="productInfo.suppliers" t-as="supplier" t-key="supplier.name">
                                <div class="d-flex flex-column flex-md-row gap-2">
                                    <div>
                                        <span t-esc="supplier.name" class="table-name"/>:
                                    </div>
                                    <span class="me-1 fw-bolder">
                                        <t t-esc="supplier.delay"/> 
                                        Days
                                    </span>
                                    <span t-if="_hasMarginsCostsAccessRights()">
                                        <t t-esc="env.utils.formatCurrency(supplier.price)"/>
                                    </span>
                                </div>
                            </t>
                        </div>
                    </div>
                    <div class="extra mt-3 mb-4 pb-4 border-bottom text-start" t-if="productInfo.variants.length &gt; 0">
                        <div class="section-variants">
                            <h3 class="section-title">Attributes</h3>
                            <div class="section-variants-body">
                                <t t-foreach="productInfo.variants" t-as="variant" t-key="variant.name">
                                    <div class="d-flex flex-column align-items-start gap-2 mb-2">
                                        <div>
                                            <span t-esc="variant.name" class="table-name"/>:
                                        </div>
                                        <div class="d-flex flex-wrap gap-1">
                                            <t t-foreach="variant.values" t-as="attribute_value" t-key="attribute_value.name">
                                                <span class="searchable btn btn-secondary" t-on-click="() =&gt; this.searchProduct(attribute_value.search)">
                                                    <t t-esc="attribute_value.name"/>
                                                </span>
                                                <t t-if="attribute_value_index lt variant.values.length - 1"> </t>
                                            </t>
                                        </div>
                                    </div>
                                </t>
                            </div>
                        </div>
                    </div>
                    <div class="section-order mt-3 mb-4 pb-4 border-bottom text-start">
                        <h3 class="section-title">Order</h3>
                        <div class="section-order-body">
                            <table class="table table-borderless w-100 w-sm-50 mb-0">
                                <tr>
                                    <td>Total Price excl. Tax:</td>
                                    <td t-esc="orderPriceWithoutTaxCurrency" class="table-value"/>
                                </tr>
                                <tr t-if="_hasMarginsCostsAccessRights()">
                                    <td>Total Cost:</td>
                                    <td t-esc="orderCostCurrency" class="table-value"/>
                                </tr>
                                <tr t-if="_hasMarginsCostsAccessRights()">
                                    <td>Total Margin:</td>
                                    <td class="table-value"><t t-esc="orderMarginCurrency"/> (<t t-esc="orderMarginPercent"/>%)</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </main>
            </div>
    </t>
<t t-name="point_of_sale.ProductsWidget">
        <div class="products-widget d-flex flex-column flex-grow-1 overflow-auto" t-ref="products-widget">
            <t t-set="showCategoryImages" t-value="getShowCategoryImages()"/>
            <div class="products-widget-control d-flex bg-view shadow-sm justify-content-between" t-att-class="{ 'h-12': showCategoryImages }">
                <CategorySelector categories="getCategories()" onClick="(id) =&gt; this.pos.setSelectedCategoryId(id)" showImage="showCategoryImages" class="ui.isSmall ? 'scrollbar-hidden' : ''"/>
                <Input tModel="[pos, 'searchProductWord']" class="'p-2'" isSmall="ui.isSmall" placeholder="'Search products...'" icon="{type: 'fa', value: 'fa-search'}" debounceMillis="500"/>
            </div>
            <div class="product-list-container flex-grow-1 overflow-y-auto">
                <div t-if="productsToDisplay.length != 0 and pos.posHasValidProduct()" t-attf-class="product-list {{this.pos.productListViewMode}} p-1">
                    <t t-foreach="productsToDisplay" t-as="product" t-key="product.id">
                        <ProductCard class="pos.productViewMode" name="product.display_name" productId="product.id" price="product.getFormattedUnitPrice()" imageUrl="pos.show_product_images and product.getImageUrl()" onClick="() =&gt;this.pos.addProductToCurrentOrder(product)" productInfo="true" onProductInfoClick="() =&gt; this.onProductInfoClick(product)"/>
                    </t>
                </div>
                <div t-else="" class="product-list-empty no-results-message text-center mt-5">
                    <t t-if="searchWord">
                        <p>No products found for <b>"<t t-esc="searchWord"/>"</b> in this category.</p>
                    </t>
                    <t t-else="">
                        <t t-if="pos.posHasValidProduct()">
                            <p>There are no products in this category.</p>
                        </t>
                        <t t-else="">
                            <div t-if="!state.loadingDemo">
                                <p class="text-large">No products available. Explore <a role="button" class="button-no-demo fw-bolder" t-on-click="loadDemoDataProducts">demo data</a> or <a role="button" class="button-no-demo fw-bolder" t-on-click="createNewProducts">create your own</a>.</p>
                            </div>
                            <div t-else="" class="block-top-header position-absolute top-0 start-0 bg-black opacity-50 w-100 h-100 z-1000">
                                <div class="d-flex h-100 w-100 text-white flex-row align-items-center justify-content-center">
                                    <div class="o_spinner d-flex flex-column mb-4">
                                        <img src="/web/static/img/spin.svg" alt="Loading..."/>
                                        Loading...
                                    </div>
                                </div>
                            </div>
                        </t>
                    </t>
                </div>
                <div t-if="searchWord" class="search-more-button d-flex justify-content-center">
                    <button class="btn btn-primary btn-lg" t-on-click="onPressEnterKey">Search more</button>
                </div>
                <div class="portal search-database-button no-results-message" t-att-class="{ 'd-none':  !shouldShowButton }"/>
            </div>
        </div>
    </t>
<t t-name="point_of_sale.ProductScreen">
        <div class="product-screen d-flex h-100 bg-100" t-att-class="{ 'd-none': !props.isShown }">
            <div t-if="!ui.isSmall || pos.mobile_pane === 'left'" t-att-class="{'flex-grow-1': ui.isSmall}" class="leftpane d-flex flex-column border-end bg-200">
                <OrderWidget lines="currentOrder.orderlines" t-slot-scope="scope" total="env.utils.formatCurrency(currentOrder.get_total_with_tax())" tax="!env.utils.floatIsZero(currentOrder.get_total_tax()) and env.utils.formatCurrency(currentOrder.get_total_tax()) or ''" isConfigRestaurant="pos.config.module_pos_restaurant" isOrderBooked="currentOrder.isBooked">
                    <t t-set="line" t-value="scope.line"/>
                    <Orderline line="line.getDisplayData()" t-on-click="() =&gt; this.selectLine(line)" class="{ ...line.getDisplayClasses(), 'selected' : line.selected }" t-on-dblclick="&#10;                () =&gt; line.toggleSkipChange()&#10;            ">
                        <t t-set-slot="product-name">
                            <i t-if="line.get_product().isTracked()" t-on-click.stop="() =&gt; line.editPackLotLines()" role="img" t-attf-class="{{ line.has_valid_product_lot() ? 'text-success' : 'text-danger'}} fa fa-list line-lot-icon ms-1" t-attf-title="{{ line.has_valid_product_lot() ? 'Valid product lot' : 'Invalid product lot'}}"/>
                        </t>
                        <ul t-if="line.pack_lot_lines">
                            <li t-foreach="line.get_lot_lines()" t-as="lot" t-key="lot.cid">
                                SN <t t-esc="lot.lot_name"/>
                            </li>
                        </ul>
                    </Orderline>
                    <t t-set-slot="details">
            <button t-if="showBookButton()" class="btn btn-primary py-2 rounded-0 book-table" style="border:none; font-size: 20px;" t-on-click="bookTable">Book table</button></t>
                </OrderWidget>
                <div class="pads border-top">
                    <div class="control-buttons d-flex flex-wrap border-bottom overflow-hidden bg-300" t-if="!ui.isSmall">
                        <t t-foreach="controlButtons" t-as="cb" t-key="cb.name">
                            <t t-component="cb.component" t-key="cb.name"/>
                        </t>
                    </div>
                    <div class="subpads d-flex">
                        <ActionpadWidget partner="partner" actionName="constructor.numpadActionName" actionType="'payment'" onClickMore.bind="displayAllControlPopup"/>
                        <Numpad buttons="getNumpadButtons()" onClick.bind="onNumpadClick" class="'w-100'"/>
                    </div>
                </div>
            </div>
            <div class="rightpane overflow-auto d-flex flex-grow-1 flex-column bg-300 w-60" t-if="!ui.isSmall || pos.mobile_pane === 'right'">
                <ProductsWidget/>
                <t t-if="ui.isSmall">
                    <div class="product-reminder d-flex justify-content-center align-items-center py-1 text-bg-warning bg-opacity-50 fw-bolder" t-if="currentOrder.get_selected_orderline() and currentOrder.hasJustAddedProduct" t-key="animationKey">
                        <span><t t-esc="selectedOrderlineQuantity"/> <t t-esc="selectedOrderlineDisplayName"/> <t t-esc="selectedOrderlineTotal"/></span>
                    </div>
                    <div class="switchpane d-flex h-12">
                        <button t-if="this.swapButton" class="btn-switchpane btn flex-fill rounded-0 fw-bolder" t-on-click="submitOrder" t-attf-class="{{ primaryOrderButton ? 'btn-primary' : 'btn-secondary' }}">

                <span class="fs-1 d-block">Order</span>
                <span><t t-esc="nbrOfChanges"/> changes</span>
            </button>
            <t t-else="">
                <button class="btn-switchpane btn flex-fill rounded-0 fw-bolder" t-attf-class="{{ primaryPayButton ? 'btn-primary' : 'btn-secondary' }}" t-on-click="() =&gt; currentOrder.pay()">
                    <span class="fs-1 d-block">Pay</span>
                    <span><t t-esc="total"/></span>
                </button>
            </t>
        <button class="btn-switchpane btn w-50 rounded-0 fw-bolder review-button" t-attf-class="{{ primaryReviewButton ? 'btn-primary' : 'btn-secondary' }}" t-on-click="switchPane">
                <span class="fs-1 d-block">Payment</span>
                <span t-if="this.swapButton"><t t-esc="total"/></span>
                <span t-else=""><t t-esc="items"/> items</span>
            </button>
        </div>
                </t>
            </div>
        </div>
    </t>

<t t-name="point_of_sale.OrderReceipt">
        <div class="pos-receipt">
                <t t-if="isTrue">
                    <ReceiptHeader data="props.data.headerData"/>
                        <OrderWidget lines="props.data.orderlines" t-slot-scope="scope">
                        <t t-set="line" t-value="scope.line"/>
                            <Orderline line="omit(scope.line, 'customerNote')" class="{ 'pe-none': true }">
                                <li t-if="line.customerNote" class="customer-note w-100 p-2 my-1 rounded text-break">
                                    <i class="fa fa-sticky-note me-1" role="img" aria-label="Customer Note" title="Customer Note"/>
                                    <t t-esc="line.customerNote"/>
                                </li>
                                <ul t-if="line.pack_lot_lines">
                                <li t-foreach="line.pack_lot_lines" t-as="lot" t-key="lot.cid">
                                    <t t-if="lot.order_line.product.tracking == 'lot'">
                                        Lot Number <t t-esc="lot.lot_name"/>
                                    </t>
                                    <t t-else="">
                                        SN <t t-esc="lot.lot_name"/>
                                    </t>
                                </li>
                            </ul>
                        </Orderline>
                    </OrderWidget>


                    <div class="pos-receipt-right-align">--------</div>
                    <br/>
                    <div class="pos-receipt-amount">
                        TOTAL
                        <span t-esc="props.formatCurrency(props.data.amount_total)" class="pos-receipt-right-align"/>
                    </div>
                    <t t-if="props.data.rounding_applied">
                        <div class="pos-receipt-amount">
                          Rounding
                            <span t-esc="props.formatCurrency(props.data.rounding_applied)" class="pos-receipt-right-align"/>
                        </div>
                        <div class="pos-receipt-amount">To Pay
                            <span t-esc="props.formatCurrency(props.data.amount_total + props.data.rounding_applied)" class="pos-receipt-right-align"/>
                        </div>
                    </t>
                    <br/>
                    <br/>



                    <div class="paymentlines" t-foreach="props.data.paymentlines" t-as="line" t-key="line_index">
                        <t t-esc="line.name"/>
                            <span t-esc="props.formatCurrency(line.amount, false)" class="pos-receipt-right-align"/>
                    </div>
                    <div class="pos-receipt-amount receipt-change mt-2">
                        CHANGE
                        <span t-esc="props.formatCurrency(props.data.change)" class="pos-receipt-right-align"/>
                    </div>



                    <t t-if="props.data.total_discount">
                        <div>
                            Discounts
                            <span t-esc="props.formatCurrency(props.data.total_discount)" class="pos-receipt-right-align"/>
                        </div>
                    </t>
                    <div t-if="props.data.tax_details.length &gt; 0" class="pos-receipt-taxes">
                        <span/>
                            <span>TAX%</span>
                            <span>Tax</span>
                            <span>Base</span>
                            <span>Total</span>
                        <t t-foreach="props.data.tax_details" t-as="tax" t-key="tax.tax.id">
                            <span t-esc="tax.tax.letter || ''"/>
                                <span><t t-esc="tax.tax.amount"/>
                                    %</span>
                                <span t-esc="props.formatCurrency(tax.amount, false)"/>
                                <span t-esc="props.formatCurrency(tax.base, false)"/>
                                <span t-esc="props.formatCurrency(tax.amount + tax.base, false)"/>
                        </t>
                        <t t-if="props.data.tax_details.length &gt; 1">
                            <span/>
                                <span/>
                                <span t-esc="props.formatCurrency(props.data.amount_tax, false)"/>
                                <span t-esc="props.formatCurrency(props.data.total_without_tax, false)"/>
                                <span t-esc="props.formatCurrency(props.data.amount_total, false)"/>
                        </t>
                    </div>

                    <div class="before-footer"/>

                    <div t-if="props.data.pos_qr_code">
                        <br/>
                        <br/>
                        <div class="pos-receipt-order-data mb-2">
                            Scan me to request an invoice for your purchase.
                        </div>
                        <img id="posqrcode" t-att-src="props.data.pos_qr_code" class="pos-receipt-logo"/>
                    </div>
                    <div t-if="props.data.ticket_code">
                        <br/>
                        <br/>
                        <div class="pos-receipt-order-data">
                            You can go to <t t-out="props.data.base_url"/>/pos/ticket
                            and use the code below to request an invoice online
                        </div>
                        <div class="pos-receipt-order-data">
                            Unique Code: <t t-out="props.data.ticket_code"/>
                        </div>
                    </div>


                    <div t-if="props.data.footer" class="pos-receipt-center-align" style="white-space:pre-line">
                         <br/>
                         <t t-esc="props.data.footer"/>
                         <br/>
                         <br/>
                    </div>

                    <div class="after-footer">
                       <t t-foreach="props.data.paymentlines" t-as="line" t-key="line_index">
                           <t t-if="line.ticket">
                               <br/>
                               <div class="pos-payment-terminal-receipt">
                                   <pre t-esc="line.ticket"/>
                               </div>
                           </t>
                       </t>
                    </div>

                    <br/>
                    <t t-if="props.shippingDate">
                        <div class="pos-receipt-order-data">
                            Expected delivery:
                            <div><t t-esc="props.shippingDate"/></div>
                        </div>
                    </t>

                    <br/>
                    <div class="pos-receipt-order-data">
                        <p>Odoo Point of Sale</p>
                            <div t-esc="props.data.name"/>
                            <div t-esc="props.data.date"/>
                    </div>
                </t>
                <t t-else="">
                    <t t-component="templateComponent" t-props="templateProps"/>
                </t>
            </div>
        </t>
<t t-name="point_of_sale.ReceiptHeader">
        <img t-attf-src="/web/image?model=res.company&amp;id={{props.data.company.id}}&amp;field=logo" alt="Logo" class="pos-receipt-logo"/>
        <br/>
        <h1 class="tracking-number text-center" style="font-size: 100px" t-if="props.data.trackingNumber and props.data.bigTrackingNumber" t-esc="props.data.trackingNumber"/>
            <div t-if="props.data.pickingService" class="picking-service text-center">
                <span t-if="props.data.pickingService == 'table'">Service at Table</span>
                <span t-else="">Pickup At Counter</span>
                <br/>
                <br/>
            </div>
            <div t-if="props.data.tableTracker" class="table-tracker text-center">
                Table Tracker:
                <br/>
                <t t-esc="props.data.tableTracker"/>
                <br/>
                <br/>
            </div>
        <div class="pos-receipt-contact">

            <div t-if="props.data.company.partner_id?.[1]" t-esc="props.data.company.partner_id[1]"/>
            <t t-if="props.data.company.phone">
                <div>Tel:<t t-esc="props.data.company.phone"/></div>
            </t>
            <t t-if="props.data.company.vat">
                <div><t t-esc="props.data.company.country?.vat_label || 'Tax ID'"/>: <t t-esc="props.data.company.vat"/></div>
            </t>
            <div t-if="props.data.company.email" t-esc="props.data.company.email"/>
            <div t-if="props.data.company.website" t-esc="props.data.company.website"/>
            <div t-if="props.data.header" style="white-space:pre-line" t-esc="props.data.header"/>
            <div t-if="props.data.cashier" class="cashier">
                <div>--------------------------------</div>
                <div>Served by <t t-esc="props.data.cashier"/></div>
            </div>
            <t t-if="props.data.table">
                at table <t t-esc="props.data.table"/>
            </t>
            <t t-if="props.data.table and props.data.customer_count">
                <div>Guests: <t t-esc="props.data.customer_count"/></div>
            </t>
            <div class="fw-bolder" t-if="props.data.trackingNumber and !props.data.bigTrackingNumber">
                <span class="fs-2" t-esc="props.data.trackingNumber"/>
            </div>
        </div>
        <br/><br/>
    </t>
<t t-name="point_of_sale.ReceiptScreen">
        <div class="receipt-screen screen h-100 bg-100">
            <div class="screen-content d-flex flex-column h-100">
                <div class="top-content d-flex align-items-center py-3 border-bottom text-center" t-if="!ui.isSmall">
                    <div class="top-content-center flex-grow-1">
                        <h1 class="mb-0">
                            <t t-esc="orderAmountPlusTip"/>
                        </h1>
                    </div>
                </div>
                <div class="default-view d-flex flex-lg-row flex-column overflow-hidden flex-grow-1">
                    <div class="actions d-flex flex-column justify-content-between flex-lg-grow-1 flex-grow-0 flex-shrink-1 flex-basis-0">
                        <div class="d-flex flex-column m-4">
                            <h1>Payment Successful</h1>
                            <div class="buttons my-3">
                                <button class="button print btn btn-lg btn-secondary w-100 py-3" t-on-click="printReceipt">
                                    <i class="fa fa-print ms-2" t-ref="order-print-receipt-button"/> Print Receipt
                                </button>
                            </div>
                            <form t-on-submit.prevent="onSendEmail" class="send-email d-flex">
                                <div class="input-email input-group">
                                    <input type="email" class="form-control py-3 bg-view" t-attf-placeholder="Email: {{currentOrder.getEmailItems().join(', ')}}" t-model="orderUiState.inputEmail"/>
                                    <button class="send btn px-5" t-att-class="isValidEmail() ? 'highlight btn btn-primary' : 'btn-secondary disabled'" type="submit">
                                        <i class="fa fa-paper-plane" aria-hidden="true" t-ref="order-mail-receipt-button"/>
                                    </button>
                                </div>
                            </form>
                            <div class="notice mt-2">
                                <div t-if="orderUiState.emailSuccessful !== null" t-attf-class="{{ orderUiState.emailSuccessful ? 'successful text-success' : 'failed text-danger' }}">
                                    <t t-esc="orderUiState.emailNotice"/>
                                </div>
                            </div>
                        </div>
                        <t t-set="splittedOrder" t-value="this.currentOrder.originalSplittedOrder and !this.currentOrder.originalSplittedOrder.finalized"/>
                        <div t-if="!ui.isSmall" class="validation-buttons d-flex w-100 gap-1 sticky-bottom">
                            <button class="button next validation btn btn-primary w-100 py-5 rounded-0 fs-2" t-att-class="{ highlight: !locked }" t-if="!splittedOrder" t-on-click="orderDone" name="done">
                                <i class="oi oi-chevron-right" role="img" aria-label="Pay" title="Pay"/>
                                New Order
                            </button>
                            <button t-if="isResumeVisible() and !splittedOrder" class="button next validation btn btn-primary w-100 py-5 rounded-0 fs-2" t-att-class="{ highlight: !locked }" t-on-click="resumeOrder" name="resume">
                                <i class="oi oi-chevron-right" role="img" aria-label="Pay" title="Pay"/>
                                Resume Order
                            </button>
                            <button t-if="splittedOrder" class="button next validation btn btn-primary w-100 py-5 rounded-0 fs-2" t-att-class="{ highlight: !locked }" t-on-click="continueSplitting" name="resume">
                                <i class="fa fa-chevron-right" role="img" aria-label="Pay" title="Pay"/>
                                Continue
                            </button>
                        </div>
                    </div>
                    <div class="pos-receipt-container d-flex flex-grow-1 flex-lg-grow-0 user-select-none justify-content-center bg-200 text-center overflow-hidden">
                        <div class="d-inline-block m-3 p-3 border rounded bg-view text-start overflow-y-auto">
                            <OrderReceipt data="pos.get_order().export_for_printing()" formatCurrency="env.utils.formatCurrency"/>
                        </div>
                    </div>
                </div>
                <div t-if="ui.isSmall" class="switchpane d-flex h-12">
                    <div class="btn-switchpane validation-button btn btn-primary flex-fill d-flex justify-content-center align-items-center rounded-0 fw-bolder fs-1" t-att-class="{ highlight: !locked }" t-if="!splittedOrder" t-on-click="orderDone" name="done">
                                New Order
                    </div>
                    <div t-if="isResumeVisible() and !splittedOrder" class="btn-switchpane validation-button btn btn-primary flex-fill d-flex justify-content-center align-items-center rounded-0 fw-bolder fs-1" t-att-class="{ highlight: !locked }" t-on-click="resumeOrder" name="resume">
                                Resume Order
                    </div>
                    <div t-if="splittedOrder" class="btn-switchpane validation-button btn btn-primary flex-fill d-flex justify-content-center align-items-center rounded-0 fw-bolder fs-1" t-att-class="{ highlight: !locked }" t-on-click="continueSplitting" name="resume">
                                Continue
                    </div>
                </div>
            </div>
        </div>
    </t>

<t t-name="point_of_sale.ReprintReceiptScreen">
        <div class="receipt-screen screen h-100 bg-100">
            <div class="screen-content d-flex flex-column h-100">
                <div class="top-content d-flex align-items-center p-2 border-bottom text-center">
                    <button class="button back btn btn-lg btn-secondary" t-on-click="confirm">
                        <i class="fa fa-angle-double-left me-2"/>
                        <span> </span>
                        <span>Back</span>
                    </button>
                </div>
                <div class="centered-content d-grid mx-auto mt-3 border-0 overflow-hidden">
                    <button class="button print btn btn-lg btn-primary" t-on-click="tryReprint">
                        <i class="fa fa-print ms-2"/> Print Receipt
                    </button>
                    <div class="pos-receipt-container mt-2 bg-200 text-center overflow-y-auto">
                        <div class="d-inline-block m-3 p-3 border rounded bg-view text-start overflow-hidden">
                            <OrderReceipt data="props.order.export_for_printing()" formatCurrency="env.utils.formatCurrency"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </t>

<t t-name="point_of_sale.ScaleScreen">
        <div class="scale-screen screen">
            <div class="screen-content d-flex flex-column h-100">
                <div class="top-content d-flex align-items-center p-2 border-bottom text-center">
                    <button class="button back btn btn-lg btn-secondary" t-on-click="back">
                        <i class="fa fa-angle-double-left me-2"/>
                        Back
                    </button>
                    <h1 class="product-name flex-grow-1 m-0">
                        <t t-esc="productName"/>
                    </h1>
                </div>
                <div class="centered-content w-100 mx-auto mt-3 border-start border-end text-center overflow-x-hidden overflow-y-auto">
                    <div class="weight js-weight m-2 p-4 rounded bg-view text-center fs-1">
                        <t t-esc="productWeightString"/>
                    </div>
                    <div class="d-flex flex-row gap-2 m-2">
                        <div class="product-price d-flex align-items-center justify-content-center flex-grow-1 rounded text-bg-info bg-opacity-25 text-info fs-2">
                            <t t-esc="env.utils.formatCurrency(productPrice) + '/' + productUom"/>
                        </div>
                        <div class="computed-price flex-grow-1 p-3 bg-view rounded text-center fs-2 fw-bold">
                            <t t-esc="computedPriceString"/>
                        </div>
                    </div>
                    <div class="buy-product btn btn-lg btn-primary d-flex align-items-center justify-content-center mx-2 mb-2 cursor-pointer" t-on-click="confirm">
                        Order
                        <i class="fa fa-angle-double-right ms-2"/>
                    </div>
                </div>
            </div>
        </div>
    </t>

<t t-name="point_of_sale.InvoiceButton">
        <button class="control-button btn btn-light rounded-0 fw-bolder" t-on-click="() =&gt; this.click()" t-ref="invoice-button">
            <i class="fa fa-file-pdf-o me-1"/>
            <span> </span>
            <span><t t-esc="commandName"/></span>
        </button>
    </t>

<t t-name="point_of_sale.ReprintReceiptButton">
        <button class="control-button btn btn-light rounded-0 fw-bolder" t-on-click="() =&gt; this.click()">
            <i class="fa fa-print me-1"/>
            <span> </span>
            <span>Print Receipt</span>
        </button>
    </t>

<t t-name="point_of_sale.SearchBar">
        <div class="pos-search-bar d-flex align-items-center flex-grow-1 h-100 ms-3 rounded">
            <div class="search position-relative h-100 d-flex flex-grow-1">
                <div class="input-group">
                    <input class="form-control bg-view border-light ps-5" t-ref="autofocus" t-model="state.searchInput" t-on-keydown="onSearchInputKeydown" t-on-keyup="onSearchInputKeyup" type="text" t-att-placeholder="props.placeholder"/>
                    <div t-if="state.showSearchFields and state.searchInput" class="fields">
                        <ul class="py-1 bg-view small">
                            <t t-foreach="searchFieldsList" t-as="fieldName" t-key="fieldName">
                                <li class="ps-5 py-1 text-start" t-att-class="{ highlight: fieldName == searchFieldsList[state.selectedSearchFieldId] }" t-on-click="() =&gt; this._onClickSearchField(fieldName)">
                                    <span class="field">
                                        <t t-esc="props.config.searchFields.get(fieldName)"/>
                                    </span>
                                    <span>: </span>
                                    <span class="term text-primary fw-bolder">
                                        <t t-esc="state.searchInput"/>
                                    </span>
                                </li>
                            </t>
                        </ul>
                    </div>
                    <div t-if="props.config.filter.show" class="filter btn btn-secondary d-flex align-items-center dropdown-toggle" t-on-click.stop="() =&gt; { state.showFilterOptions = !state.showFilterOptions }">
                        <span>
                            <t t-esc="props.config.filter.options.get(state.selectedFilter).text"/>
                        </span>
                        <ul t-if="state.showFilterOptions" class="options dropdown-menu dropdown-menu-end py-1">
                            <t t-foreach="filterOptionsList" t-as="key" t-key="key">
                                <t t-set="_option" t-value="props.config.filter.options.get(key)"/>
                                <li class="dropdown-item" t-on-click="() =&gt; this._onSelectFilter(key)" t-att-class="{ 'indented': _option.indented }">
                                    <t t-esc="_option.text"/>
                                </li>
                            </t>
                        </ul>
                    </div>
                </div>
                <span class="search-icon position-absolute start-0 top-50 translate-middle ms-4 z-3" t-if="!ui.isSmall"><i class="oi oi-search"/></span>
            </div>
        </div>
    </t>

<t t-name="point_of_sale.TicketScreen">
        <div class="ticket-screen screen h-100 bg-100" t-att-class="{ 'd-none': !props.isShown }">
            <div class="screen-full-width d-flex w-100 h-100">
                <div t-if="!ui.isSmall || pos.ticket_screen_mobile_pane === 'left'" class="rightpane pane-border d-flex flex-column flex-grow-1 w-100 h-100 h-lg-100 bg-300 overflow-y-auto">
                    <div class="controls d-flex align-items-center justify-content-between mt-1 mt-lg-0 p-2 bg-400">
                        <t t-if="!ui.isSmall">
                            <div class="buttons d-flex gap-2">
                                <button t-if="!ui.isSmall" class="discard btn btn-lg btn-light" t-on-click="() =&gt; this.closeTicketScreen()">
                                    <span class="search-icon">
                                        <i class="fa fa-angle-double-left"/>
                                    </span>
                                    <t t-if="!ui.isSmall">
                                        Back
                                    </t>
                                </button>
                                <button t-if="allowNewOrders" class="highlight btn btn-lg btn-primary" t-on-click="() =&gt; this.onCreateNewOrder()">New Order</button>
            <button class="settle-tips btn btn-lg btn-primary" t-if="_state.ui.filter == 'TIPPING'" t-on-click="settleTips">Settle</button>
                            </div>
                        </t>
                        <t t-if="ui.isSmall and allowNewOrders">
                            <button class="highlight btn btn-lg btn-primary" t-on-click="() =&gt; this.onCreateNewOrder()">
                                <span class="search-icon">
                                    <i class="fa fa-plus" aria-hidden="true"/>
                                </span>
                            </button>
                        </t>
                        <SearchBar config="getSearchBarConfig()" placeholder="constructor.searchPlaceholder" onSearch.bind="onSearch" onFilterSelected.bind="onFilterSelected"/>
                        <div t-if="shouldShowPageControls()" class="item">
                            <div class="page-controls">
                                <div class="previous" t-on-click="() =&gt; this.onPrevPage()">
                                    <i class="fa fa-fw fa-caret-left" role="img" aria-label="Previous Order List" title="Previous Order List"/>
                                </div>
                                <div class="next" t-on-click="() =&gt; this.onNextPage()">
                                    <i class="fa fa-fw fa-caret-right" role="img" aria-label="Next Order List" title="Next Order List"/>
                                </div>
                            </div>
                            <div class="page">
                                <span><t t-esc="getPageNumber()"/></span>
                            </div>
                        </div>
                    </div>
                    <div class="orders overflow-y-auto flex-grow-1">
                        <t t-set="_filteredOrderList" t-value="getFilteredOrderList()"/>
                        <t t-if="_filteredOrderList.length !== 0">
                            <div class="header-row d-flex text-bg-700 fw-bolder" t-att-class="{ 'd-none': ui.isSmall }">
                                <div class="col wide p-2">Date</div>
                                <div class="col wide p-2">Receipt Number</div>
                                <div class="col wide p-2">Order number</div>
                                <div class="col p-2">Customer</div>
                                <div class="col wide p-2" t-if="showCardholderName()">Cardholder Name</div>
                                <div class="col p-2">Cashier</div>
                                <div class="col end p-2">Total</div>
                                <div class="col narrow p-2">Status</div>
            <div t-if="pos.config.module_pos_restaurant" class="col p-2" name="table">Table</div>
            <div t-if="_state.ui.filter == 'TIPPING'" class="col end narrow p-2" name="tip">Tip</div>
                                <div class="col very-narrow p-2" name="delete"/>
                            </div>
                            <t t-if="!ui.isSmall" t-foreach="_filteredOrderList" t-as="order" t-key="order.cid">
                                <div class="order-row" t-att-class="{ 'highlight bg-primary text-white': isHighlighted(order) }" t-on-click="() =&gt; this.onClickOrder(order)" t-on-dblclick="() =&gt; order.locked ? ()=&gt;{} : this._setOrder(order)">
                                    <div class="col wide p-2 ">
                                        <div><t t-esc="getDate(order)"/></div>
                                    </div>
                                    <div class="col wide p-2">
                                        <div><t t-esc="order.name"/></div>
                                    </div>
                                    <div class="col wide p-2">
                                        <div><t t-esc="order.trackingNumber"/></div>
                                    </div>
                                    <div class="col p-2">
                                        <div><t t-esc="getPartner(order)"/></div>
                                    </div>
                                    <div t-if="showCardholderName()" class="col p-2">
                                        <div><t t-esc="getCardholderName(order)"/></div>
                                    </div>
                                    <div class="col p-2">
                                        <t t-esc="getCashier(order)"/>
                                    </div>
                                    <div class="col end p-2">
                                        <div><t t-esc="getTotal(order)"/></div>
                                    </div>
                                    <div class="col narrow p-2">
                                        <div><t t-esc="getStatus(order)"/></div>
                                    </div>
            <div t-if="pos.config.module_pos_restaurant" class="col p-2" name="table">
                <t t-if="order.tableId">
                    <div t-if="ui.isSmall">Table</div>
                    <div><t t-esc="getTable(order)"/></div>
                </t>
            </div>
            <div t-if="_state.ui.filter == 'TIPPING'" class="col end narrow p-2" name="tip">
                <div t-if="ui.isSmall">Tip</div>
                <div><TipCell order="order"/></div>
            </div>
                                    <div t-if="!shouldHideDeleteButton(order)" class="col very-narrow delete-button p-2" name="delete" t-on-click.stop="() =&gt; this.onDeleteOrder(order)">
                                        <i class="fa fa-trash" aria-hidden="true"/>
                                    </div>
                                    <div t-else="" class="col very-narrow p-2"/>
                                </div>
                            </t>
                            <t t-if="ui.isSmall" t-foreach="_filteredOrderList" t-as="order" t-key="order.cid">
                                <div class="mobileOrderList order-row" t-att-class="{ 'highlight bg-primary text-white': isHighlighted(order) }" t-on-click="() =&gt; this.onClickOrder(order)" t-on-dblclick="() =&gt;  order.locked ? ()=&gt;{} : this._setOrder(order)">
                                    <div class="col p-2 d-flex justify-content-between align-items-center">
                                        <div><t t-esc="order.name"/> / <t t-esc="order.trackingNumber"/></div>
                                        <div><t t-esc="getTotal(order)"/></div>
                                    </div>
                                    <div class="col p-2 d-flex justify-content-between align-items-center">
                                        <div><t t-esc="getDate(order)"/></div>
            <t t-if="order.tableId">
                <div><t t-esc="getTable(order)"/></div>
            </t>
                                        <div class="orderStatus"><t t-esc="getStatus(order)"/></div>
                                    </div>
                                    <div class="col p-2">
                                        <div t-if="!shouldHideDeleteButton(order)" class="col very-narrow delete-button p-2 rounded-2" name="delete" t-on-click.stop="() =&gt; this.onDeleteOrder(order)">
                                            <i class="fa fa-trash" aria-hidden="true"/> Delete
                                        </div>
                                    </div>
                                </div>
                            </t>
                        </t>
                        <CenteredIcon t-else="" icon="'fa-shopping-cart fa-4x'" text="'No orders found'"/>
                    </div>
                    <div class="switchpane d-flex w-100" t-if="ui.isSmall">
                        <t t-set="_selectedSyncedOrder" t-value="getSelectedOrder()"/>
                        <button class="btn-switchpane load-order-button primary btn btn-primary rounded-0 w-50 fw-bolder py-3" t-if="!isOrderSynced" t-on-click="() =&gt; this._setOrder(_selectedSyncedOrder)">
                            <span class="fs-1 d-block">Load Order</span>
                        </button>
                        <button class="btn-switchpane flex-fill btn rounded-0 fw-bolder secondary review-button" t-att-class="{'btn-primary': isOrderSynced, 'btn-secondary': !isOrderSynced}" t-on-click="switchPane">
                            <span class="fs-1 d-block">Review</span>
                        </button>
                    </div>
                </div>
                <div class="leftpane d-flex flex-column flex-grow-1 w-100 h-100 h-lg-100 bg-200" t-if="!ui.isSmall || pos.ticket_screen_mobile_pane === 'right'">
                    <t t-set="_selectedSyncedOrder" t-value="getSelectedOrder()"/>
                    <t t-set="_selectedOrderlineId" t-value="getSelectedOrderlineId()"/>
                    <t t-if="_selectedSyncedOrder?.get_orderlines()?.length"> 
                        <div t-if="isOrderSynced" t-att-class="{ 'highlight text-danger': _state.ui.highlightHeaderNote }" class="text-bg-view py-2 px-3 border-bottom">
                            Select the product(s) to refund and set the quantity
                        </div>
                        <OrderWidget lines="_selectedSyncedOrder.orderlines" t-slot-scope="scope" total="env.utils.formatCurrency(_selectedSyncedOrder.get_total_with_tax())" tax="!env.utils.floatIsZero(_selectedSyncedOrder.get_total_tax()) and env.utils.formatCurrency(_selectedSyncedOrder.get_total_tax()) or ''">
                            <t t-set="line" t-value="scope.line"/>
                            <Orderline line="line.getDisplayData()" class="{'selected': line.id === getSelectedOrderlineId()}" t-on-click="() =&gt; this.onClickOrderline(line)">
                                <t t-set="toRefundDetail" t-value="line.pos.toRefundLines[line.id]"/>
                                <li t-if="!line.pos.isProductQtyZero(line.refunded_qty)" class="info refund-note mt-1">
                                    <strong t-esc="env.utils.formatProductQty(line.refunded_qty)"/>
                                    <span> Refunded</span>
                                </li>
                                <li t-if="!line.pos.isProductQtyZero(toRefundDetail?.qty)" class="info to-refund-highlight refund-note mt-1 fw-bold text-primary">
                                    <t t-set="_destinationOrderUid" t-value="toRefundDetail.destinationOrderUid"/>
                                    <t t-set="refundQty" t-value="env.utils.formatProductQty(toRefundDetail.qty)"/>
                                    <t t-if="_destinationOrderUid">
                                        Refunding <t t-esc="refundQty"/> in 
                                        <span t-esc="_destinationOrderUid" class="order-link ms-1 text-decoration-underline cursor-pointer" t-on-click.stop="() =&gt; this.onClickRefundOrderUid(_destinationOrderUid)"/>
                                    </t>
                                    <t t-else="">
                                        To Refund: <t t-esc="refundQty"/>
                                    </t>
                                </li>
                            </Orderline>
                        </OrderWidget>
                        <div class="pads border-top">
                            <t t-if="isOrderSynced">
                                <div class="control-buttons d-flex flex-wrap border-bottom overflow-hidden bg-300">
                                    <InvoiceButton onInvoiceOrder.bind="onInvoiceOrder" order="_selectedSyncedOrder"/>
                                    <ReprintReceiptButton order="_selectedSyncedOrder"/>
                                </div>
                                <div class="subpads d-flex">
                                    <ActionpadWidget partner="getSelectedPartner()" actionName="constructor.numpadActionName" actionType="'refund'" actionToTrigger.bind="onDoRefund" isActionButtonHighlighted="getHasItemsToRefund()"/>
                                    <Numpad buttons="getNumpadButtons()" class="'max-width-325px'"/>
                                </div>
                            </t>
                            <div t-else="" class="pads border-top">
                                <button class="button validation load-order-button w-100 btn btn-lg btn-primary rounded-0 fw-bolder py-3" t-on-click="() =&gt; this._setOrder(_selectedSyncedOrder)">
                                    <span class="fs-1 d-block">Load Order</span>
                                </button>
                            </div>
                        </div>
                    </t>
                    <CenteredIcon t-else="" icon="'fa-shopping-cart fa-4x'" text="'Select an order'" class="'bg-100'"/>
                </div>
            </div>
        </div>
    </t>

<t t-name="point_of_sale.CashOpeningPopup">
        <div class="popup opening-cash-control">
            <div class="modal-header drag-handle">
                <h4 class="modal-title">Opening Cash Control</h4>
            </div>
            <main class="modal-body">
                <div class="opening-cash-section mb-3">
                    <span class="info-title d-flex flex-grow-1 align-items-start">Opening cash</span>
                    <div class="cash-input-sub-section input-group">
                        <Input tModel="[state, 'openingCash']" isValid.bind="env.utils.isValidFloat" callback.bind="handleInputChange" autofocus="true"/>
                        <div class="button icon btn btn-secondary" t-on-click="openDetailsPopup">
                            <i class="fa fa-money fa-2x" role="img" title="Open the money details popup"/>
                        </div>
                    </div>
                </div>
                <div class="opening-notes-container d-flex flex-column align-items-start">
                    <label class="form-label" for="openingNotes">Opening note</label>
                    <textarea class="opening-notes form-control" id="openingNotes" rows="4" t-model="state.notes" placeholder="Add an opening note..."/>
                </div>
            </main>
            <footer class="footer modal-footer">
                <button class="button btn btn-lg btn-primary" t-on-click="confirm" t-att-disabled="!env.utils.isValidFloat(state.openingCash)">
                    Open session
                </button>
            </footer>
        </div>
    </t>
<t t-name="point_of_sale.ComboConfiguratorPopup">
        <div class="popup popup-text popup-med combo-configurator-popup">
            <header class="modal-header h2" t-esc="props.product.display_name"/>
            <main class="body">
                <div t-foreach="props.product.combo_ids" t-as="combo_id" t-key="combo_id" class="d-flex flex-column m-3 mb-4">
                    <t t-set="combo" t-value="pos.db.combo_by_id[combo_id]"/>
                    <h3 class="me-auto mb-3" t-esc="combo.name"/>
                    <div class="product-list d-grid gap-1">
                        <div t-foreach="combo.combo_line_ids" t-as="combo_line_id" t-key="combo_line_id">
                            <t t-set="combo_line" t-value="pos.db.combo_line_by_id[combo_line_id]"/>
                            <t t-set="product" t-value="pos.db.product_by_id[combo_line.product_id[0]]"/>
                            <input type="radio" t-attf-name="combo-{{combo_id}}" t-attf-id="combo-{{combo_id}}-combo_line-{{combo_line_id}}" t-attf-value="{{combo_line_id}}" t-model="state.combo[combo_id]" t-att-class="{ 'selected': state.combo[combo_id] == combo_line_id }"/>
                            <label t-attf-for="combo-{{combo_id}}-combo_line-{{combo_line_id}}" class="combo-line h-100 w-100 rounded cursor-pointer transition-base">
                                <ProductCard class="'flex-column h-100 border'" name="product.display_name" productId="product.id" price="formattedComboPrice(combo_line)" imageUrl="product.getImageUrl()" onClick="(ev) =&gt; this.onClickProduct({ product, combo_line }, ev)"/>
                            </label>
                        </div>
                    </div>
                </div>
            </main>
            <footer class="footer footer-flex modal-footer">
                <t t-set="_allSelected" t-value="areAllCombosSelected()"/>
                <button class="button highlight confirm btn btn-lg btn-primary" t-att-disabled="!_allSelected" t-on-click="confirm">
                        Add to order
                </button>
                <button class="button cancel btn btn-lg btn-secondary" t-on-click="cancel">
                        Discard
                </button>
                <div class="ms-auto">

                    <t t-if="!_allSelected">
                        Complete the selection to proceed
                    </t>
                </div>
            </footer>
        </div>
    </t>
<t t-name="point_of_sale.OrderChangeReceipt">
        <div class="pos-receipt">
            <div class="pos-receipt-order-data"><t t-esc="changes.name"/></div>
            <t t-if="changes.floor_name || changes.table_name">
                <br/>
                <div class="pos-receipt-title">
                    <t t-esc="changes.floor_name"/> / <t t-esc="changes.table_name"/>
                </div>
            </t>
            <br/>
            <br/>
            <t t-if="changes.cancelled.length &gt; 0">
                <div class="pos-order-receipt-cancel">
                    <div class="pos-receipt-title">
                        CANCELLED
                        <t t-esc="changes.time.hours"/>:<t t-esc="changes.time.minutes"/>
                    </div>
                    <br/>
                    <br/>
                    <t t-foreach="changes.cancelled" t-as="change" t-key="change_index">
                        <div class="multiprint-flex">
                            <span class="product-quantity" t-esc="change.quantity"/>
                            <span class="product-name" t-esc="change.name"/>
                        </div>
                        <t t-if="change.note">
                            <div>
                                NOTE
                                <span class="pos-receipt-right-align">...</span>
                            </div>
                            <div><span class="pos-receipt-left-padding">--- <t t-esc="change.note"/></span></div>
                            <br/>
                        </t>
                    </t>
                    <br/>
                    <br/>
                </div>
            </t>
            <t t-if="changes.new.length &gt; 0">
                <div class="pos-receipt-title">
                    NEW
                    <t t-esc="changes.time.hours"/>:<t t-esc="changes.time.minutes"/>
                </div>
                <br/>
                <br/>
                <t t-foreach="changes.new" t-as="change" t-key="change_index">
                    <div class="multiprint-flex">
                        <span class="product-quantity" t-esc="change.quantity"/>
                        <span class="product-name" t-esc="change.name"/>
                    </div>
                    <t t-if="change.note">
                        <div>
                            NOTE
                            <span class="pos-receipt-right-align">...</span>
                        </div>
                        <div><span class="pos-receipt-left-padding">--- <t t-esc="change.note"/></span></div>
                        <br/>
                    </t>
                </t>
                <br/>
                <br/>
            </t>
        </div>
    </t>

<t t-name="point_of_sale.RadioProductAttribute">
        <div class="configurator_radio" t-ref="root">
            <div class="d-flex flex-wrap gap-3">
                <t t-foreach="values" t-as="value" t-key="value.id">
                    <div class="attribute-name-cell form-check">
                        <input class="form-check-input radio-check" type="radio" t-model="state.attribute_value_ids" t-att-name="attribute.id" t-attf-id="{{ attribute.id }}_{{ value.id }}" t-att-value="value.id"/>
                        <span t-esc="value.name"/>
                        <div t-if="value.price_extra" class="price-extra-cell d-inline-block ms-2">
                            <span class="price_extra px-2 py-1 rounded-pill text-bg-info">
                                <t t-esc="getFormatPriceExtra(value.price_extra)"/>
                            </span>
                        </div>
                    </div>
                    <div t-if="value.id == state.attribute_value_ids and value.is_custom" class="custom-value-cell">
                        <input class="custom_value form-control form-control-lg mt-2" type="text" t-model="state.custom_value"/>
                    </div>
                </t>
            </div>
        </div>
    </t>

    <t t-name="point_of_sale.PillsProductAttribute">
        <div class="configurator_radio" t-ref="root">
            <div class="d-flex flex-wrap gap-2">
                <t t-foreach="values" t-as="value" t-key="value.id">
                    <div class="attribute-name-cell">
                        <input class="form-check-input d-none" type="radio" t-model="state.attribute_value_ids" t-att-name="attribute.id" t-attf-id="{{ attribute.id }}_{{ value.id }}" t-att-value="value.id"/>
                        <label t-attf-class="btn d-flex {{ value.id == state.attribute_value_ids ? 'btn-primary' : 'btn-secondary' }}" t-att-name="value.name" t-attf-for="{{ attribute.id }}_{{ value.id }}">
                            <span t-esc="value.name"/>
                            <div t-if="value.price_extra" class="price-extra-cell d-inline-block ms-2">
                                <span class="price_extra px-2 py-1 rounded-pill text-bg-info">
                                    <t t-esc="getFormatPriceExtra(value.price_extra)"/>
                                </span>
                            </div>
                        </label>
                    </div>
                    <div t-if="value.id == state.attribute_value_ids and value.is_custom" class="custom-value-cell">
                        <input class="custom_value form-control form-control-lg mt-2" type="text" t-model="state.custom_value"/>
                    </div>
                </t>
            </div>
        </div>
    </t>

    <t t-name="point_of_sale.SelectProductAttribute">
        <div>
            <t t-set="is_custom" t-value="false"/>

            <select class="configurator_select form-select form-select-md" t-model="state.attribute_value_ids">
                <option t-foreach="values" t-as="value" t-key="value.id" t-att-value="value.id">
                    <t t-set="is_custom" t-value="is_custom || (value.is_custom and value.id == state.attribute_value_ids)"/>
                    <t t-esc="value.name"/>
                    <t t-if="value.price_extra">
                        <t t-esc="getFormatPriceExtra(value.price_extra)"/>
                    </t>
                </option>
            </select>

            <input class="custom_value form-control form-control-lg mt-2" t-if="is_custom" type="text" t-model="state.custom_value"/>
        </div>
    </t>

    <t t-name="point_of_sale.ColorProductAttribute">
        <div>
            <t t-set="is_custom" t-value="false"/>

            <ul class="color_attribute_list d-flex gap-3">
                <li t-foreach="values" t-as="value" t-key="value.id" class="color_attribute_list_item">
                    <t t-set="is_custom" t-value="is_custom || (value.is_custom and value.id == state.attribute_value_ids)"/>
                    <t t-set="img_style" t-value="value.image ? 'background:url(/web/image/product.template.attribute.value/' + value.id + '/image); background-size:cover;' : ''"/>
                    <t t-set="color_style" t-value="value.is_custom ? '' : 'background-color: ' + value.html_color"/>
                    <span class="d-flex flex-row justify-content-center align-items-center">
                        <label t-attf-class="configurator_color rounded-circle border {{ value.id == state.attribute_value_ids ? 'active border-3 border-primary' : 'border-3 border-secondary' }}" t-attf-style="{{ img_style or color_style }}" t-att-data-color="value.name">
                            <input class="m-2 opacity-0" type="radio" t-model="state.attribute_value_ids" t-att-value="value.id" t-att-name="attribute.id"/>
                        </label>
                        <div t-if="value.price_extra" class="price-extra-cell d-inline-block ms-2">
                            <span class="price_extra px-2 py-1 rounded-pill text-bg-info">
                                <t t-esc="getFormatPriceExtra(value.price_extra)"/>
                            </span>
                        </div>
                    </span>
                </li>
            </ul>

            <input class="custom_value form-control form-control-lg mt-2" t-if="is_custom" type="text" t-model="state.custom_value"/>
        </div>
    </t>

    <t t-name="point_of_sale.MultiProductAttribute">
        <div class="d-flex gap-2 flex-wrap">
            <div t-foreach="values" t-as="value" t-key="value.id">
                <input class="form-check-input d-none" type="checkbox" t-attf-id="multi-{{value.id}}" t-attf-name="multi-{{value.id}}" t-model="state.attribute_value_ids[value.id]"/>
                <label t-attf-class="form-check-label btn d-flex {{ state.attribute_value_ids[value.id] === true ? 'btn-primary' : 'btn-secondary' }}" t-attf-name="multi-{{value.id}}" t-attf-for="multi-{{value.id}}">
                    <span t-esc="value.name"/>
                    <div t-if="value.price_extra" class="price-extra-cell d-inline-block ms-2">
                        <span class="price_extra px-2 py-1 rounded-pill text-bg-info">
                            <t t-esc="getFormatPriceExtra(value.price_extra)"/>
                        </span>
                    </div>
                </label>
            </div>
        </div>
    </t>

    <t t-name="point_of_sale.ProductConfiguratorPopup">
        <t t-if="!ui.isSmall">
            <div class="popup popup-text popup-med product-configurator-popup">
                <div class="modal-header drag-handle">
                    <h4 class="modal-title"><t t-esc="props.product.display_name"/></h4>
                </div>

                <main class="body modal-body product_configurator_attributes m-0 text-start">
                    <div t-foreach="props.attributes" t-as="attribute" t-key="attribute.id" class="attribute mb-4">
                        <div class="attribute_name mb-2 fw-bolder d-flex w-100 align-items-center gap-2">
                            <span t-esc="attribute.name"/>
                            <hr class="hr flex-grow-1"/>
                        </div>
                        <RadioProductAttribute t-if="attribute.display_type === 'radio'" attribute="attribute"/>
                        <PillsProductAttribute t-elif="attribute.display_type === 'pills'" attribute="attribute"/>
                        <SelectProductAttribute t-elif="attribute.display_type === 'select'" attribute="attribute"/>
                        <ColorProductAttribute t-elif="attribute.display_type === 'color'" attribute="attribute"/>
                        <MultiProductAttribute t-elif="attribute.display_type === 'multi'" attribute="attribute"/>
                    </div>
                </main>

                <footer class="footer footer-flex modal-footer">
                    <div class="button highlight confirm btn btn-lg btn-primary" t-on-click="confirm">
                        Add
                    </div>
                    <div class="button cancel btn btn-lg btn-secondary" t-on-click="cancel">
                        Cancel
                    </div>
                </footer>
            </div>
        </t>
        <t t-else="">
            <div class="popup mobile popup-text popup-med product-configurator-popup">
                <div class="modal-header">
                    <h4 class="modal-title"><t t-esc="props.product.display_name"/></h4>
                    <span><t t-esc="unitPrice"/></span>
                </div>
                <main class="body modal-body mobile product_configurator_attributes d-flex flex-column text-start">
                    <div class="product-img d-flex justify-content-center h-50 p-2">
                        <img class="h-100" t-att-src="imageUrl" t-att-alt="props.product.display_name"/>
                    </div>
                    <div t-foreach="props.attributes" t-as="attribute" t-key="attribute.id" class="attribute mb-3">
                        <div class="attribute_name mb-2 fw-bolder" t-esc="attribute.name"/>
                        <RadioProductAttribute t-if="attribute.display_type === 'radio' or attribute.display_type === 'pills'" attribute="attribute"/>
                        <SelectProductAttribute t-elif="attribute.display_type === 'select'" attribute="attribute"/>
                        <ColorProductAttribute t-elif="attribute.display_type === 'color'" attribute="attribute"/>
                        <MultiProductAttribute t-elif="attribute.display_type === 'multi'" attribute="attribute"/>
                    </div>
                </main>

                <footer class="footer footer-flex mobile modal-footer">
                    <div class="quantity-selector d-flex align-items-center justify-content-center w-100 py-2 fw-bolder">
                        <button class="btn btn-lg btn-secondary" t-on-click="removeOneQuantity">
                            <i class="fa fa-minus" aria-hidden="true"/>
                        </button>
                        <span class="quantity mx-3"><t t-esc="state.quantity"/></span>
                        <button class="btn btn-lg btn-secondary" t-on-click="addOneQuantity">
                            <i class="fa fa-plus" aria-hidden="true"/>
                        </button>
                    </div>
                    <div class="button highlight confirm btn btn-lg btn-primary" t-on-click="confirm">
                        Add
                    </div>
                    <div class="button cancel btn btn-lg btn-secondary" t-on-click="cancel">
                        Cancel
                    </div>
                </footer>
            </div>
        </t>
    </t>
<t t-name="point_of_sale.EditListInput">
        <div class="input-group mb-3">
            <input type="text" t-att-value="props.item.text" t-on-input="onInput" class="popup-input list-line-input form-control form-control-lg w-75 mx-auto" placeholder="Serial/Lot Number" t-on-keyup="onKeyup"/>
            <button t-if="props.deletable" class="btn btn-danger btn-lg" t-on-click="props.removeItem">
                <i class="oe_link_icon fa fa-trash-o" role="img" aria-label="Remove" title="Remove"/>
            </button>
        </div>
    </t>

<t t-name="point_of_sale.EditListPopup">
        <div class="popup popup-text edit-list-popup" t-ref="root">
            <div class="modal-header">
                <h4 class="modal-title title">
                    <t t-esc="props.title"/>
                </h4>
                <span class="sub-title" t-esc="props.name"/>
            </div>
            <main class="modal-body">
                <t t-foreach="state.array" t-as="item" t-key="item._id">
                    <EditListInput item="item" createNewItem.bind="createNewItem" removeItem="() =&gt; this.removeItem(item._id)" deletable="_hasMoreThanOneItem()" onInputChange.bind="onInputChange"/>
                </t>
            </main>
            <footer class="footer footer-flex modal-footer">
                <div class="button confirm highlight btn btn-lg btn-primary" t-on-click="confirm">
                    Ok
                </div>
                <div class="button cancel btn btn-lg btn-secondary" t-on-click="cancel">
                    Cancel
                </div>
            </footer>
        </div>
    </t>

<t t-name="point_of_sale.ConfirmPopup">
        <div class="popup popup-confirm">
            <div class="modal-header">
                <h4 class="modal-title title drag-handle">
                    <t t-esc="props.title"/>
                </h4>
            </div>
            <main class="modal-body">
                <t t-esc=" props.body"/>
            </main>
            <footer class="footer modal-footer">
                <div class="button confirm btn btn-lg btn-primary" t-on-click="confirm">
                    <t t-esc="props.confirmText"/>
                </div>
                <div class="button cancel btn btn-lg btn-secondary" t-on-click="cancel">
                    <t t-esc="props.cancelText"/>
                </div>
            </footer>
        </div>
    </t>

<t t-name="point_of_sale.DatePickerPopup">
            <div class="popup">
                <div class="modal-header">
                    <h4 class="modal-title title">
                        <t t-esc="props.title"/>
                    </h4>
                </div>
                <main class="modal-body">
                    <input class="form-control form-control-lg w-75 mx-auto" type="date" t-model="state.shippingDate" t-ref="input" t-att-min="_today()"/>
                </main>
                <div class="footer footer-flex modal-footer">
                    <div class="button confirm highlight btn btn-lg btn-primary" t-on-click="confirm">
                        <t t-esc="props.confirmText"/>
                    </div>
                    <div class="button cancel btn btn-lg btn-secondary" t-on-click="cancel">
                        <t t-esc="props.cancelText"/>
                    </div>
                </div>
            </div>
    </t>

<t t-name="point_of_sale.NumberPopup">
        <div class="popup popup-number w-auto" t-att-class="{ 'popup-password': props.isPassword }" t-if="!isMobile()">
            <div class="modal-header drag-handle">
                <h4 class="modal-title title"><t t-esc="props.title"/></h4>
                <span t-if="props.subtitle" class="subtitle p-1"><t t-esc="props.subtitle"/></span>
            </div>
            <div class="input-symbol pt-3">
                <div class="popup-input value active form-control form-control-lg w-75 mx-auto">
                    <span class="input-value" t-att-class="{ 'highlight': state.toStartOver }"><t t-esc="inputBuffer"/></span>
                    <span t-if="props.inputSuffix"><t t-esc="props.inputSuffix"/></span>
                </div>
            </div>
            <Numpad buttons="getNumpadButtons()" class="'mx-auto my-3 w-75 max-width-325px'"/>
            <footer class="footer centered modal-footer justify-content-center">
                <button class="button confirm highlight btn btn-lg btn-primary" t-on-mousedown.prevent="confirm">
                        <span><t t-esc="props.confirmText"/></span>
                        <span t-if="props.getInputBufferReminder(state.buffer)" class="input-buffer-reminder small">
                            (<t t-esc="props.getInputBufferReminder(state.buffer)"/>)
                        </span>
                </button>
                <button class="button cancel btn btn-lg btn-secondary" t-on-mousedown.prevent="cancel">
                    <t t-esc="props.cancelText"/>
                </button>
            </footer>
        </div>
        <div class="popup" t-att-class="{ 'popup-password': props.isPassword }" t-else="">
            <header class="title drag-handle">
                <t t-esc="props.title"/>
            </header>
            <main>
                <input type="text" t-model="state.payload" t-ref="input" class="value payment-input-number" inputmode="decimal"/>
            </main>
            <footer class="footer centered modal-footer">
                <button class="button confirm highlight btn btn-lg btn-primary" t-on-mousedown.prevent="confirm">
                    <t t-esc="props.confirmText"/>
                </button>
                <button class="button cancel btn btn-lg btn-secondary" t-on-mousedown.prevent="cancel">
                    <t t-esc="props.cancelText"/>
                </button>
            </footer>
        </div>
    </t>

<t t-name="point_of_sale.SelectionPopup">
        <div class="popup popup-selection">
            <div class="modal-header drag-handle">
                <h4 class="modal-title"><t t-esc="props.title"/></h4>
            </div>
            <div class="selection btn-group-vertical justify-content-start w-100 p-3 overflow-y-auto">
                <t t-foreach="props.list" t-as="item" t-key="item.id">
                    <button type="button" class="selection-item d-flex align-items-center justify-content-between btn btn-lg btn-outline-secondary w-100 p-3 text-start" t-att-class="{ 'selected active': item.isSelected }" t-on-click="() =&gt; this.selectItem(item.id)">
                        <div class="d-flex flex-column">
                            <span t-esc="item.label"/>
                            <span t-esc="item.description" t-if="item.description"/>
                        </div>
                        <i class="oi oi-chevron-right"/>
                    </button>
                </t>
            </div>
            <footer class="footer modal-footer">
                <div class="button cancel btn btn-lg btn-primary" t-on-click="cancel">
                    <t t-esc="props.cancelText"/>
                </div>
            </footer>
        </div>
    </t>

<t t-name="point_of_sale.TextInputPopup">
            <div class="popup popup-textinput">
                <div class="modal-header">
                    <h4 class="modal-title"><t t-esc="props.title"/></h4>
                </div>
                <div class="modal-body">
                    <input class="form-control form-control-lg w-75 mx-auto" type="text" t-model="state.inputValue" t-ref="input" t-att-placeholder="props.placeholder"/>
                </div>
                <div class="footer footer-flex modal-footer">
                    <div class="button confirm highlight btn btn-lg btn-primary" t-on-click="confirm">
                        <t t-esc="props.confirmText"/>
                    </div>
                    <div class="button cancel btn btn-lg btn-secondary" t-on-click="cancel">
                        <t t-esc="props.cancelText"/>
                    </div>
                </div>
            </div>
    </t>

<t t-name="point_of_sale.TextAreaPopup">
        <div class="popup popup-textarea">
            <div class="modal-header">
                <h4 class="modal-title"><t t-esc="props.title"/></h4>

            </div>

            <div class="modal-body">
                <textarea class="form-control" t-ref="input" placeholder="Add a note..." t-model="state.inputValue" rows="4"/>
            </div>

            <footer class="footer footer-flex modal-footer">
                <div class="button confirm highlight btn btn-lg btn-primary" t-on-click="confirm">
                    <t t-esc="props.confirmText"/>
                </div>
                <div class="button cancel btn btn-lg btn-secondary" t-on-click="cancel">
                    <t t-esc="props.cancelText"/>
                </div>
            </footer>
        </div>
    </t>

<t t-name="point_of_sale.MoneyDetailsPopup">
        <div class="popup money-details">
            <div class="modal-header">
                <h4 class="modal-title">Coins/Bills</h4>
            </div>
            <main class="modal-body">
                <t t-set="bills" t-value="Object.keys(state.moneyDetails).sort((a, b) =&gt; b - a)"/>
                <div t-attf-style="display: grid; grid-template-rows: repeat(calc({{bills.length}}/2) ,auto); grid-auto-flow: column;">
                    <div t-foreach="bills" t-as="moneyValue" t-key="moneyValue" class="d-flex align-items-center justify-content-center my-1 ">
                        <NumericInput class="'mx-2 w-50'" tModel="[state.moneyDetails, moneyValue]" min="0"/>
                        <label class="oe_link_icon w-25 text-end">
                            <span class="mx-1" t-esc="env.utils.formatCurrency(_parseFloat(moneyValue))"/>
                        </label>
                    </div>
                </div>
                <h4 class="total-section rounded py-2">
                    Total 
                    <t t-esc="env.utils.formatCurrency(computeTotal())"/>
                </h4>
            </main>
            <footer class="footer footer-flex modal-footer">
                <div class="button highlight btn btn-lg btn-primary" t-on-click="confirm">Confirm</div>
                <div class="button btn btn-lg btn-secondary" t-on-click="cancel">Discard</div>
            </footer>
        </div>
    </t>
<t t-name="web_tour.TourPointer">
        <div t-if="props.pointerState.isVisible" t-ref="pointer" t-attf-class="                 o_tour_pointer                 o_{{ position }}                 {{ isOpen ? 'o_open' : (props.bounce ? 'o_bouncing' : '') }}                 {{ props.pointerState.onClick ? 'cursor-pointer' : '' }}             " t-attf-style="                 --TourPointer__width: {{ constructor.width }}px;                 --TourPointer__height: {{ constructor.height }}px;             " t-on-mouseenter="props.pointerState.onMouseEnter or (() =&gt; {})" t-on-mouseleave="props.pointerState.onMouseLeave or (() =&gt; {})" t-on-click="props.pointerState.onClick or (() =&gt; {})">
            <div class="o_tour_pointer_tip position-absolute"/>
            <div class="o_tour_pointer_content rounded overflow-hidden px-3 py-2 w-100 h-100 position-relative" t-att-class="{ invisible: content and !isOpen }">
                <t t-out="content"/>
            </div>
        </div>
    </t>
<t t-name="pos_restaurant.BillScreen">
        <div class="receipt-screen screen h-100 bg-100">
            <div class="screen-content d-flex flex-column h-100">
                <div class="top-content d-flex align-items-center p-2 border-bottom text-center">
                    <div class="top-content-center flex-grow-1">
                        <h2 class="mb-0 text-start">Bill Printing</h2>
                    </div>
                    <button class="button next highlight btn btn-lg btn-outline-primary" t-on-click="confirm">
                        <span>Ok</span>
                        <i class="fa fa-angle-double-right ms-2"/>
                    </button>
                </div>
                <div class="centered-content mx-auto mt-3 border-start border-end text-center overflow-x-hidden overflow-y-auto">
                    <div class="button print btn btn-lg btn-primary" t-on-click="printReceipt">
                        <i class="fa fa-print" t-ref="order-print-receipt-button"/>
                        <span> </span>
                        <span>Print</span>
                    </div>
                    <div class="pos-receipt-container text-center">
                        <div class="d-inline-block m-3 p-3 border rounded bg-view text-start overflow-hidden">
                            <OrderReceipt data="{...pos.get_order().export_for_printing(), isBill: isBill}" formatCurrency="env.utils.formatCurrency"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </t>

<t t-name="pos_restaurant.OrderlineNoteButton">
        <button class="control-button btn btn-light rounded-0 fw-bolder" t-on-click="() =&gt; this.click()" t-att-disabled="!selectedOrderline">
            <i class="fa fa-tag me-1"/>
            <span> </span>
            <span>Internal Note</span>
        </button>
    </t>

<t t-name="pos_restaurant.PrintBillButton">
        <span class="control-button order-printbill btn btn-light rounded-0 fw-bolder" t-att-class="{'disabled': _isDisabled()}" t-on-click="() =&gt; this.click()">
            <i class="fa fa-print me-1"/>
            <span> </span>
            <span>Bill</span>
        </span>
    </t>

<t t-name="pos_restaurant.SplitBillButton">
        <span class="control-button order-split btn btn-light rounded-0 fw-bolder" t-att-class="{'disabled': _isDisabled()}" t-on-click="() =&gt; this.click()">
            <i class="fa fa-files-o me-1"/>
            <span> </span>
            <span>Split</span>
        </span>
    </t>

<t t-name="pos_restaurant.TableGuestsButton">
        <button class="control-button btn btn-light rounded-0 fw-bolder" t-on-click="() =&gt; this.click()">
            <span class="control-button-number px-2 py-1 rounded-circle text-bg-dark fw-bolder small me-1">
                <t t-esc="nGuests"/>
            </span>
            <span> </span>
            <span>Dine-in Guests</span>
        </button>
    </t>

<t t-name="pos_restaurant.TransferOrderButton">
        <button class="control-button btn btn-light rounded-0 fw-bolder" t-on-click="() =&gt; this.click()">
            <i class="oi oi-arrow-right me-1"/>
            <span> </span>
            <span>Transfer</span>
        </button>
    </t>

<t t-name="pos_restaurant.EditBar">
        <div class="edit-bar-top d-flex align-items-center justify-content-between px-3 border-bottom bg-view overflow-x-auto h-54 w-100">
            <div class="flex-fill d-flex justify-content-center">
                <span role="button" class="edit-button text-center d-flex flex-column btn btn-light text-uppercase" t-on-click.stop="props.createTable">
                    <i class="fa fa-plus icon-button" role="img" aria-label="Add" title="Add"/>
                    <span class="text-button d-block">Table</span>
                </span>
                <span role="button" class="edit-button text-center d-flex flex-column btn btn-light text-uppercase" t-att-class="{ 'disabled': props.selectedTables.length == 0 }" t-on-click.stop="props.changeSeatsNum">
                    <i class="fa fa-user icon-button" role="img" aria-label="Seats" title="Seats"/>
                    <span class="text-button d-block">Seats</span>
                </span>
                <span role="button" class="edit-button text-center d-flex flex-column btn btn-light text-uppercase button-option round" t-if="getSelectedTablesShape() == 'square'" t-att-class="{ disabled: props.selectedTables.length == 0 }" t-on-click.stop="props.changeToCircle">
                    <i class="fa fa-circle-o icon-button" role="img" aria-label="Round Shape" title="Round Shape"/>
                    <span class="text-button d-block">Shape</span>
                </span>
                <span role="button" class="edit-button text-center d-flex flex-column btn btn-light text-uppercase button-option square" t-else="" t-att-class="{ disabled: props.selectedTables.length == 0 }" t-on-click.stop="props.changeToSquare">
                    <i class="fa fa-square-o icon-button" role="img" aria-label="Square Shape" title="Square Shape"/>
                    <span class="text-button d-block">Shape</span>
                </span>
                <span t-if="!props.isColorPicker" role="button" class="edit-button text-center d-flex flex-column btn btn-light text-uppercase" t-on-click.stop="props.toggleColorPicker">
                    <i class="fa fa-paint-brush icon-button" role="img" aria-label="Tint" title="Tint"/>
                    <span class="text-button d-block">Fill</span>
                </span>
                <span t-else="" role="button" class="edit-button text-center d-flex flex-column is-active btn btn-secondary text-uppercase" t-on-click.stop="props.toggleColorPicker">
                    <i class="fa fa-paint-brush icon-button" role="img" aria-label="Tint" title="Tint"/>
                    <span class="text-button d-block">Fill</span>
                </span>
                <span role="button" class="edit-button text-center d-flex flex-column btn btn-light text-uppercase" t-att-class="{ disabled: props.selectedTables.length &gt; 1 }" t-on-click.stop="props.renameTable">
                    <i class="fa fa-pencil-square-o icon-button" role="img" aria-label="Rename" title="Rename"/>
                    <span class="text-button d-block">Rename</span>
                </span>
                <span role="button" class="edit-button text-center d-flex flex-column btn btn-light text-uppercase" t-on-click.stop="props.duplicateTableOrFloor">
                    <i class="fa fa-clone icon-button" role="img" aria-label="Copy" title="Copy"/>
                    <span class="text-button d-block">Copy</span>
                </span>
                <span role="button" class="edit-button text-center d-flex flex-column trash btn btn-light text-uppercase" t-on-click.stop="props.deleteFloorOrTable">
                    <i class="fa fa-trash icon-button" role="img" aria-label="Delete" title="Delete"/>
                    <span class="text-button d-block">Delete</span>
                </span>
            </div>
            <span class="edit-button d-flex flex-row-reverse border-0 flex-shrink-1 text-uppercase text-end last-edit-button">
                <div class="d-flex justify-content-end">
                    <div role="button" class="btn btn-light d-flex flex-column align-items-center close-edit-button" t-on-click.stop="props.toggleEditMode">
                        <i class="fa fa-times icon-button" role="img" aria-label="Close" title="Close"/>
                        <span class="text-button d-block">Close</span>
                    </div>
                </div>
            </span>
        </div>
        <div t-if="props.isColorPicker and props.selectedTables.length &gt; 0" class="color-picker d-flex justify-content-center align-items-center bg-200 h-54">
            <span class="color py-4 cursor-pointer float-start" style="background-color:#FFFFFF" role="img" aria-label="White" title="White" t-on-click.stop="() =&gt; props.setTableColor('#FFFFFF')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:#EB6D6D" role="img" aria-label="Red" title="Red" t-on-click.stop="() =&gt; props.setTableColor('#EB6D6D')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:#35D374" role="img" aria-label="Green" title="Green" t-on-click.stop="() =&gt; props.setTableColor('#35D374')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:#6C6DEC" role="img" aria-label="Blue" title="Blue" t-on-click.stop="() =&gt; props.setTableColor('#6C6DEC')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:#EBBF6D" role="img" aria-label="Orange" title="Orange" t-on-click.stop="() =&gt; props.setTableColor('#EBBF6D')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:#EBEC6D" role="img" aria-label="Yellow" title="Yellow" t-on-click.stop="() =&gt; props.setTableColor('#EBEC6D')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:#AC6DAD" role="img" aria-label="Purple" title="Purple" t-on-click.stop="() =&gt; props.setTableColor('#AC6DAD')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:#6C6D6D" role="img" aria-label="Grey" title="Grey" t-on-click.stop="() =&gt; props.setTableColor('#6C6D6D')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:#ACADAD" role="img" aria-label="Light grey" title="Light grey" t-on-click.stop="() =&gt; props.setTableColor('#ACADAD')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:#4ED2BE" role="img" aria-label="Turquoise" title="Turquoise" t-on-click.stop="() =&gt; props.setTableColor('#4ED2BE')"/>
        </div>
        <div t-if="props.isColorPicker and props.selectedTables.length == 0" class="color-picker d-flex justify-content-center align-items-center bg-200 h-54">    
            <span class="color py-4 cursor-pointer float-start" style="background-color:rgb(249, 250, 251)" role="img" aria-label="White" title="White" t-on-click.stop="() =&gt; props.setFloorColor('rgb(249, 250, 251)')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:rgb(244, 149, 149)" role="img" aria-label="Red" title="Red" t-on-click.stop="() =&gt; props.setFloorColor('rgb(244, 149, 149)')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:rgb(130, 233, 171)" role="img" aria-label="Green" title="Green" t-on-click.stop="() =&gt; props.setFloorColor('rgb(130, 233, 171)')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:rgb(136, 137, 242)" role="img" aria-label="Blue" title="Blue" t-on-click.stop="() =&gt; props.setFloorColor('rgb(136, 137, 242)')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:rgb(255, 214, 136)" role="img" aria-label="Orange" title="Orange" t-on-click.stop="() =&gt; props.setFloorColor('rgb(255, 214, 136)')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:rgb(254, 255, 154)" role="img" aria-label="Yellow" title="Yellow" t-on-click.stop="() =&gt; props.setFloorColor('rgb(254, 255, 154)')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:rgb(209, 171, 210)" role="img" aria-label="Purple" title="Purple" t-on-click.stop="() =&gt; props.setFloorColor('rgb(209, 171, 210)')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:rgb(75, 75, 75)" role="img" aria-label="Grey" title="Grey" t-on-click.stop="() =&gt; props.setFloorColor('rgb(75, 75, 75)')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:rgb(210, 210, 210)" role="img" aria-label="Light grey" title="Light grey" t-on-click.stop="() =&gt; props.setFloorColor('rgb(210, 210, 210)')"/>
            <span class="color py-4 cursor-pointer float-start" style="background-color:rgb(127, 221, 236)" role="img" aria-label="Turquoise" title="Turquoise" t-on-click.stop="() =&gt; props.setFloorColor('rgb(127, 221, 236)')"/>
        </div>
    </t>

<t t-name="pos_restaurant.EditableTable">
        <div class="table selected position-absolute d-flex flex-column align-items-center justify-content-between overflow-hidden" t-ref="root">
            <span class="label drag-handle d-flex align-items-center flex-grow-1 d fw-bolder fs-2">
                <t t-esc="props.table.name"/>
            </span>
            <t t-if="pos.floorPlanStyle != 'kanban'" t-foreach="handles" t-as="handle" t-key="handle">
                <span class="table-handle" t-ref="{{handle}}" t-att-style="computeHandleStyle(handle)"/>
            </t>
        </div>
    </t>

<t t-name="pos_restaurant.FloorScreen">
        <div class="floor-screen screen h-100 position-relative d-flex flex-column flex-nowrap m-0 bg-100 text-start overflow-hidden">
            <EditBar t-if="pos.isEditMode" selectedTables="selectedTables" nbrFloors="nbrFloors" floorMapScrollTop="state.floorMapScrollTop" isColorPicker="state.isColorPicker" toggleColorPicker.bind="toggleColorPicker" createTable.bind="createTable" duplicateTableOrFloor.bind="duplicateTableOrFloor" renameTable.bind="renameTable" changeSeatsNum.bind="changeSeatsNum" changeToCircle.bind="changeToCircle" changeToSquare.bind="changeToSquare" setTableColor.bind="setTableColor" setFloorColor.bind="setFloorColor" deleteFloorOrTable.bind="deleteFloorOrTable" toggleEditMode.bind="toggleEditMode"/>
            <div class="floor-selector d-flex text-center bg-100 fs-3 w-100 h-54">
                <t t-foreach="pos.floors" t-as="floor" t-key="floor.id">
                    <button class="button button-floor btn p-3 rounded-0 flex-fill border-start shadow-none d-flex align-items-center justify-content-center" t-attf-class="{{ floor.id === state.selectedFloorId ? 'btn-primary border-start-0' : 'btn-light' }}" t-on-click="() =&gt; this.selectFloor(floor)">
                        <t t-esc="floor.name"/>
                        <span t-if="activeFloor.id !== floor.id and floor.changes_count &gt; 0" class="mx-1 badge bg-danger text-white rounded-pill py-1 px-2 fs-5" t-esc="floor.changes_count"/>
                    </button>
                </t>
                <button class="button button-add btn btn-secondary p-3 ms-auto rounded-0" t-ref="add-floor-ref" t-on-click="addFloor">
                    <i class="fa fa-plus icon-button me-2" role="img" aria-label="Add" title="Add"/>
                    Add Floor
                </button>
            </div>

            <div t-on-click="_onDeselectTable" t-on-touchstart="_onPinchStart" t-on-touchmove="_onPinchMove" t-on-touchend="_onPinchEnd" class="floor-map position-relative flex-grow-1 flex-shrink-1 flex-basis-0 w-auto h-100 overflow-auto" t-ref="floor-map-ref">
                <t t-if="pos.floors.length &gt; 0">
                    <div t-if="isFloorEmpty" class="empty-floor d-flex align-items-center justify-content-center h-100 fs-3 text-center text-muted" t-ref="map">
                        <span>Oops! No tables available.<br/>Add a new table to get started.</span>
                    </div>
                    <div t-else="" t-ref="map">
                        <t t-foreach="activeTables" t-as="table" t-key="table.id">
                            <Table t-if="!state.selectedTableIds.includes(table.id)" onClick.bind="onSelectTable" table="table"/>
                            <EditableTable t-else="" table="table" selectedTables="selectedTables" onSaveTable.bind="onSaveTable" limit="floorMapRef"/>
                        </t>
                    </div>
                </t>
                <t t-else="">
                    <div class="empty-floor d-flex align-items-center justify-content-center h-100 fs-3 text-center text-muted" t-ref="map">
                        <span>Oops! No floors available.<br/>Add a new floor to get started.</span>
                    </div>
                </t>
            </div>
        </div>
    </t>
<t t-name="pos_restaurant.Table">
        <div class="table position-absolute d-flex flex-column align-items-center justify-content-between cursor-pointer" t-on-click.stop="(ev) =&gt; props.onClick(props.table, ev)" t-att-style="style">
            <div class="infos d-flex align-items-center flex-grow-1">
                <span class="label fw-bolder fs-4" t-esc="props.table.name"/>
                <span t-att-class="orderCountClass" class="badge d-flex align-items-center justify-content-center position-absolute rounded-pill" t-attf-class="{{ orderCount === 0 or pos.isEditMode ? 'd-none' : ''}}" t-att-style="badgeStyle" t-esc="orderCount"/>
            </div>
            <span class="table-seats position-absolute bottom-0 start-50 translate-middle-x mb-1 px-2 py-1 rounded text-bg-dark bg-opacity-25 fs-4">
                <div class="cover" t-att-style="\`width: \${Math.ceil(fill * 100)}%\`"/>
                <t t-esc="customerCountDisplay"/>
            </span>
        </div>
    </t>
<t t-name="pos_restaurant.SplitBillScreen">
        <div class="splitbill-screen screen h-100 bg-100">
            <div class="contents d-flex flex-column flex-nowrap h-100 my-0 mx-auto">
                <div class="top-content d-flex align-items-center p-2 border-bottom text-center">
                    <button class="button back btn btn-lg btn-outline-primary" t-on-click="back">
                        <i class="fa fa-angle-double-left me-2"/>
                        <span>Back</span>
                    </button>
                    <div class="top-content-center flex-grow-1">
                        <h2 class="mb-0">Bill Splitting</h2>
                    </div>
                </div>

                <div t-if="newOrder" class="main d-flex flex-nowrap flex-grow-1 overflow-hidden">
                    <div class="flex-grow-1 mw-50 m-3 bg-view border rounded w-50 overflow-auto">
                        <OrderWidget lines="orderlines" t-slot-scope="scope">
                            <t t-set="line" t-value="scope.line"/>
                            <Orderline line="getLineData(line)" t-on-click="() =&gt; this.onClickLine(line)" class="{'selected text-bg-primary': splitlines[line.id].quantity !== 0}"/>
                        </OrderWidget>
                    </div>
                    <div class="controls border-start flex-column flex-nowrap flex-grow-1 flex-shrink-1 flex-basis-0">
                        <div class="order-info py-4 border-bottom text-center text-success">
                            <span class="subtotal">
                                <t t-esc="env.utils.formatCurrency(newOrder.get_subtotal())"/>
                            </span>
                        </div>
                        <div class="pay-button m-3">
                            <div class="button btn btn-lg btn-secondary py-3 w-100" t-on-click="proceed">
                                <i class="oi oi-chevron-right me-2"/>
                                <span>Payment</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </t>

<t t-name="pos_restaurant.TipReceipt">
        <div class="pos-receipt">
            <ReceiptHeader data="props.headerData"/>
            <div class="pos-payment-terminal-receipt">
                <pre t-esc="data"/>
            </div>
            <br/>


            <div class="subtotal">
                <span>Subtotal</span>
                <div class="pos-receipt-right-align"><t t-esc="total"/></div>
            </div>
            <br/>

            <div class="tip">
                <span>Tip:</span>
                <div class="pos-receipt-right-align">________________________</div>
            </div>
            <br/>

            <div class="total">
                <span>Total:</span>
                <div class="pos-receipt-right-align">________________________</div>
            </div>
            <br/>
            <br/>

            <div class="signature">
                <div>______________________________________________</div>
                <div>Signature</div>
            </div>
        </div>
    </t>

<t t-name="pos_restaurant.TipScreen">
        <div class="tip-screen screen h-100 bg-100">
            <div class="pos-receipt-container text-center" t-ref="pos-receipt-container"/>
            <div class="screen-content d-flex flex-column h-100">
                <div class="top-content d-flex align-items-center p-2 border-bottom text-center">
                    <button class="button btn btn-lg btn-outline-primary" t-on-click="() =&gt; this.pos.showScreen('FloorScreen')">
                        <i class="fa fa-angle-double-left me-2"/>
                        <span>Back</span>
                    </button>
                    <button class="button btn btn-lg btn-outline-primary" t-if="printer.is()" t-on-click="printTipReceipt">
                        <i class="fa fa-print"/>
                        <span> </span>
                        <span>Reprint receipts</span>
                    </button>
                    <div class="top-content-center flex-grow-1">
                        <h2 class="mb-0">Add a tip</h2>
                    </div>
                    <div class="button highlight next btn btn-lg btn-primary" t-on-click="validateTip">
                        Settle <i class="fa fa-angle-double-right"/>
                    </div>
                </div>
                <div class="tip-options">
                    <div class="total-amount my-4 fs-2 text-center">
                        <t t-esc="overallAmountStr"/>
                    </div>
                    <div class="tip-amount-options d-flex flex-column gap-2 mx-4 p-3 rounded bg-view">
                        <div class="percentage-amounts d-flex gap-2">
                            <t t-foreach="percentageTips" t-as="tip" t-key="tip.percentage">
                                <button class="button btn btn-lg btn-secondary flex-fill py-5" t-on-click="() =&gt; { state.inputTipAmount = env.utils.formatCurrency(tip.amount,false); }">
                                    <div class="percentage fs-1 text-primary text-center">
                                        <t t-esc="tip.percentage"/>
                                    </div>
                                    <div class="amount text-muted">
                                        <t t-esc="env.utils.formatCurrency(tip.amount)"/>
                                    </div>
                                </button>
                            </t>
                        </div>
                        <div class="no-tip d-grid">
                            <button class="button btn btn-lg btn-secondary flex-fill py-5 fs-1 text-primary" t-on-click="() =&gt; { state.inputTipAmount = '0'; }">No Tip</button>
                        </div>
                        <div class="custom-amount-form d-flex">
                            <div class="input-group input-group-lg">
                                <span class="input-group-text bg-secondary">Tip Amount</span>
                                <input type="text" class="item form-control fs-1" aria-label="Username" t-model="state.inputTipAmount" t-att-data-amount="state.inputTipAmount"/>
                                <span class="input-group-text">
                                    <div class="currency">
                                        <t t-esc="pos.getCurrencySymbol()"/>
                                    </div>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </t>

<t t-name="pos_restaurant.TipCell">
        <div class="tip-cell" t-on-click.stop="editTip">
            <t t-if="state.isEditing">
                <input type="text" name="tip-amount" t-ref="autofocus" t-model="orderUiState.inputTipAmount" t-on-blur="onBlur" t-on-keydown="onKeydown"/>
            </t>
            <div t-else="">
                <t t-esc="tipAmountStr"/>
            </div>
        </div>
    </t>

<t t-name="pos_epson_printer.ePOSLayout">
        <s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
            <s:Body>
                <epos-print xmlns="http://www.epson-pos.com/schemas/2011/03/epos-print"/>
            </s:Body>
        </s:Envelope>
    </t>
<t t-name="pos_online_payment.OnlinePaymentPopup">
        <div class="popup online-payment-popup">
            <main class="body">
                <div class="title">
                    Scan to Pay
                </div>
                <div class="instructions">
                    <p>Invite your customer to scan the QR code to pay: </p>
                    <img class="qr-code" t-att-src="props.qrCode" alt="QR Code to pay"/>
                </div>
                <div class="info">
                    <div><span>Amount: </span><span class="amount" t-esc="env.utils.formatCurrency(props.amount)"/></div>
                    <div><span>Order reference: </span><span t-esc="props.order.name"/></div>
                    <div><span>Order id: </span><span t-esc="props.order.server_id"/></div>
                </div>
            </main>
            <footer class="footer modal-footer">
                <div class="button cancel btn btn-lg" t-on-click="cancel">Cancel</div>
            </footer>
        </div>
    </t>

</templates>`);
                    });